# Statistics

Total codebase size: 9096624

Code to analyze: 465354

Total size of duplicated fragments: 1115217

# Detected Duplicates

## Duplicated Code. Size: 3598

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DecorateDelete.cs

<pre>if (this.m_Type == typeofLocalizedStatic)
                {
                    int labelNumber = 0;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("LabelNumber"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                            {
                                labelNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                                break;
                            }
                        }
                    }

                    item = new LocalizedStatic(this.m_ItemID, labelNumber);
                }
                else if (this.m_Type == typeofLocalizedSign)
                {
                    int labelNumber = 0;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("LabelNumber"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                            {
                                labelNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                                break;
                            }
                        }
                    }

                    item = new LocalizedSign(this.m_ItemID, labelNumber);
                }
                else if (this.m_Type == typeofAnkhWest || this.m_Type == typeofAnkhNorth)
                {
                    bool bloodied = false;

                    for (int i = 0; !bloodied && i < this.m_Params.Length; ++i)
                        bloodied = (this.m_Params[i] == "Bloodied");

                    if (this.m_Type == typeofAnkhWest)
                        item = new AnkhWest(bloodied);
                    else
                        item = new AnkhNorth(bloodied);
                }
                else if (this.m_Type == typeofMarkContainer)
                {
                    bool bone = false;
                    bool locked = false;
                    Map map = Map.Malas;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i] == "Bone")
                        {
                            bone = true;
                        }
                        else if (this.m_Params[i] == "Locked")
                        {
                            locked = true;
                        }
                        else if (this.m_Params[i].StartsWith("TargetMap"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                map = Map.Parse(this.m_Params[i].Substring(++indexOf));
                        }
                    }

                    MarkContainer mc = new MarkContainer(bone, locked);

                    mc.TargetMap = map;
                    mc.Description = "strange location";

                    item = mc;
                }
                else if (this.m_Type == typeofHintItem)
                {
                    int range = 0;
                    int messageNumber = 0;
                    string messageString = null;
                    int hintNumber = 0;
                    string hintString = null;
                    TimeSpan resetDelay = TimeSpan.Zero;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("Range"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                range = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }
                        else if (this.m_Params[i].StartsWith("WarningString"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                messageString = this.m_Params[i].Substring(++indexOf);
                        }
                        else if (this.m_Params[i].StartsWith("WarningNumber"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                messageNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }
                        else if (this.m_Params[i].StartsWith("HintString"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                hintString = this.m_Params[i].Substring(++indexOf);
                        }
                        else if (this.m_Params[i].StartsWith("HintNumber"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                hintNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }
                        else if (this.m_Params[i].StartsWith("ResetDelay"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                resetDelay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                        }
                    }

                    HintItem hi = new HintItem(this.m_ItemID, range, messageNumber, hintNumber);

                    hi.WarningString = messageString;
                    hi.HintString = hintString;
                    hi.ResetDelay = resetDelay;

                    item = hi;
                }
                else if (this.m_Type == typeofWarningItem)
                {
                    int range = 0;
                    int messageNumber = 0;
                    string messageString = null;
                    TimeSpan resetDelay = TimeSpan.Zero;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("Range"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                range = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }
                        else if (this.m_Params[i].StartsWith("WarningString"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                messageString = this.m_Params[i].Substring(++indexOf);
                        }
                        else if (this.m_Params[i].StartsWith("WarningNumber"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                messageNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }
                        else if (this.m_Params[i].StartsWith("ResetDelay"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                resetDelay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                        }
                    }

                    WarningItem wi = new WarningItem(this.m_ItemID, range, messageNumber);

                    wi.WarningString = messageString;
                    wi.ResetDelay = resetDelay;

                    item = wi;
                }
                else if (this.m_Type == typeofCannon)
                {
                    CannonDirection direction = CannonDirection.North;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("CannonDirection"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                direction = (CannonDirection)Enum.Parse(typeof(CannonDirection), this.m_Params[i].Substring(++indexOf), true);
                        }
                    }

                    item = new Cannon(direction);
                }
                else if (this.m_Type == typeofSerpentPillar)
                {
                    string word = null;
                    Rectangle2D destination = new Rectangle2D();

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("Word"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                word = this.m_Params[i].Substring(++indexOf);
                        }
                        else if (this.m_Params[i].StartsWith("DestStart"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                destination.Start = Point2D.Parse(this.m_Params[i].Substring(++indexOf));
                        }
                        else if (this.m_Params[i].StartsWith("DestEnd"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                destination.End = Point2D.Parse(this.m_Params[i].Substring(++indexOf));
                        }
                    }

                    item = new SerpentPillar(word, destination);
                }
                else if (this.m_Type.IsSubclassOf(typeofBeverage))
                {
                    BeverageType content = BeverageType.Liquor;
                    bool fill = false;

                    for (int i = 0; !fill && i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("Content"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                            {
                                content = (BeverageType)Enum.Parse(typeof(BeverageType), this.m_Params[i].Substring(++indexOf), true);
                                fill = true;
                            }
                        }
                    }

                    if (fill)
                        item = (Item)Activator.CreateInstance(this.m_Type, new object[] { content });
                    else
                        item = (Item)Activator.CreateInstance(this.m_Type);
                }
                else if (this.m_Type.IsSubclassOf(typeofBaseDoor))
                {
                    DoorFacing facing = DoorFacing.WestCW;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("Facing"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                            {
                                facing = (DoorFacing)Enum.Parse(typeof(DoorFacing), this.m_Params[i].Substring(++indexOf), true);
                                break;
                            }
                        }
                    }

                    item = (Item)Activator.CreateInstance(this.m_Type, new object[] { facing });
                }
                else
                {
                    item = (Item)Activator.CreateInstance(this.m_Type);
                }</pre>

Fragment 2 in file Scripts\Commands\DecorateMag.cs

<pre>if (this.m_Type == typeofLocalizedStatic)
                {
                    int labelNumber = 0;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("LabelNumber"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                            {
                                labelNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                                break;
                            }
                        }
                    }

                    item = new LocalizedStatic(this.m_ItemID, labelNumber);
                }
                else if (this.m_Type == typeofLocalizedSign)
                {
                    int labelNumber = 0;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("LabelNumber"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                            {
                                labelNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                                break;
                            }
                        }
                    }

                    item = new LocalizedSign(this.m_ItemID, labelNumber);
                }
                else if (this.m_Type == typeofAnkhWest || this.m_Type == typeofAnkhNorth)
                {
                    bool bloodied = false;

                    for (int i = 0; !bloodied && i < this.m_Params.Length; ++i)
                        bloodied = (this.m_Params[i] == "Bloodied");

                    if (this.m_Type == typeofAnkhWest)
                        item = new AnkhWest(bloodied);
                    else
                        item = new AnkhNorth(bloodied);
                }
                else if (this.m_Type == typeofMarkContainer)
                {
                    bool bone = false;
                    bool locked = false;
                    Map map = Map.Malas;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i] == "Bone")
                        {
                            bone = true;
                        }
                        else if (this.m_Params[i] == "Locked")
                        {
                            locked = true;
                        }
                        else if (this.m_Params[i].StartsWith("TargetMap"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                map = Map.Parse(this.m_Params[i].Substring(++indexOf));
                        }
                    }

                    MarkContainer mc = new MarkContainer(bone, locked);

                    mc.TargetMap = map;
                    mc.Description = "strange location";

                    item = mc;
                }
                else if (this.m_Type == typeofHintItem)
                {
                    int range = 0;
                    int messageNumber = 0;
                    string messageString = null;
                    int hintNumber = 0;
                    string hintString = null;
                    TimeSpan resetDelay = TimeSpan.Zero;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("Range"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                range = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }
                        else if (this.m_Params[i].StartsWith("WarningString"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                messageString = this.m_Params[i].Substring(++indexOf);
                        }
                        else if (this.m_Params[i].StartsWith("WarningNumber"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                messageNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }
                        else if (this.m_Params[i].StartsWith("HintString"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                hintString = this.m_Params[i].Substring(++indexOf);
                        }
                        else if (this.m_Params[i].StartsWith("HintNumber"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                hintNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }
                        else if (this.m_Params[i].StartsWith("ResetDelay"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                resetDelay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                        }
                    }

                    HintItem hi = new HintItem(this.m_ItemID, range, messageNumber, hintNumber);

                    hi.WarningString = messageString;
                    hi.HintString = hintString;
                    hi.ResetDelay = resetDelay;

                    item = hi;
                }
                else if (this.m_Type == typeofWarningItem)
                {
                    int range = 0;
                    int messageNumber = 0;
                    string messageString = null;
                    TimeSpan resetDelay = TimeSpan.Zero;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("Range"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                range = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }
                        else if (this.m_Params[i].StartsWith("WarningString"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                messageString = this.m_Params[i].Substring(++indexOf);
                        }
                        else if (this.m_Params[i].StartsWith("WarningNumber"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                messageNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }
                        else if (this.m_Params[i].StartsWith("ResetDelay"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                resetDelay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                        }
                    }

                    WarningItem wi = new WarningItem(this.m_ItemID, range, messageNumber);

                    wi.WarningString = messageString;
                    wi.ResetDelay = resetDelay;

                    item = wi;
                }
                else if (this.m_Type == typeofCannon)
                {
                    CannonDirection direction = CannonDirection.North;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("CannonDirection"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                direction = (CannonDirection)Enum.Parse(typeof(CannonDirection), this.m_Params[i].Substring(++indexOf), true);
                        }
                    }

                    item = new Cannon(direction);
                }
                else if (this.m_Type == typeofSerpentPillar)
                {
                    string word = null;
                    Rectangle2D destination = new Rectangle2D();

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("Word"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                word = this.m_Params[i].Substring(++indexOf);
                        }
                        else if (this.m_Params[i].StartsWith("DestStart"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                destination.Start = Point2D.Parse(this.m_Params[i].Substring(++indexOf));
                        }
                        else if (this.m_Params[i].StartsWith("DestEnd"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                destination.End = Point2D.Parse(this.m_Params[i].Substring(++indexOf));
                        }
                    }

                    item = new SerpentPillar(word, destination);
                }
                else if (this.m_Type.IsSubclassOf(typeofBeverage))
                {
                    BeverageType content = BeverageType.Liquor;
                    bool fill = false;

                    for (int i = 0; !fill && i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("Content"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                            {
                                content = (BeverageType)Enum.Parse(typeof(BeverageType), this.m_Params[i].Substring(++indexOf), true);
                                fill = true;
                            }
                        }
                    }

                    if (fill)
                        item = (Item)Activator.CreateInstance(this.m_Type, new object[] { content });
                    else
                        item = (Item)Activator.CreateInstance(this.m_Type);
                }
                else if (this.m_Type.IsSubclassOf(typeofBaseDoor))
                {
                    DoorFacing facing = DoorFacing.WestCW;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("Facing"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                            {
                                facing = (DoorFacing)Enum.Parse(typeof(DoorFacing), this.m_Params[i].Substring(++indexOf), true);
                                break;
                            }
                        }
                    }

                    item = (Item)Activator.CreateInstance(this.m_Type, new object[] { facing });
                }
                else
                {
                    item = (Item)Activator.CreateInstance(this.m_Type);
                }</pre>

## Duplicated Code. Size: 2397

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DecorateDelete.cs

<pre>if (item is KeywordTeleporter)
            {
                KeywordTeleporter tp = (KeywordTeleporter)item;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("Substring"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Substring = this.m_Params[i].Substring(++indexOf);
                    }
                    else if (this.m_Params[i].StartsWith("Keyword"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Keyword = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Range"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Range = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("PointDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.PointDest = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MapDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.MapDest = Map.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Creatures"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Creatures = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SourceEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SourceEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("DestEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.DestEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SoundID"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SoundID = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Delay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Delay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                }

                if (this.m_ItemID > 0)
                    item.ItemID = this.m_ItemID;
            }
            else if (item is Teleporter)
            {
                Teleporter tp = (Teleporter)item;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("PointDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.PointDest = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MapDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.MapDest = Map.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Creatures"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Creatures = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SourceEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SourceEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("DestEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.DestEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SoundID"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SoundID = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Delay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Delay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                }

                if (this.m_ItemID > 0)
                    item.ItemID = this.m_ItemID;
            }
            else if (item is FillableContainer)
            {
                FillableContainer cont = (FillableContainer)item;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("ContentType"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            cont.ContentType = (FillableContentType)Enum.Parse(typeof(FillableContentType), this.m_Params[i].Substring(++indexOf), true);
                    }
                }

                if (this.m_ItemID > 0)
                    item.ItemID = this.m_ItemID;
            }
            else if (this.m_ItemID > 0)
            {
                item.ItemID = this.m_ItemID;
            }</pre>

Fragment 2 in file Scripts\Commands\DecorateMag.cs

<pre>if (item is KeywordTeleporter)
            {
                KeywordTeleporter tp = (KeywordTeleporter)item;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("Substring"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Substring = this.m_Params[i].Substring(++indexOf);
                    }
                    else if (this.m_Params[i].StartsWith("Keyword"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Keyword = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Range"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Range = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("PointDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.PointDest = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MapDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.MapDest = Map.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Creatures"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Creatures = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SourceEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SourceEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("DestEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.DestEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SoundID"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SoundID = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Delay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Delay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                }

                if (this.m_ItemID > 0)
                    item.ItemID = this.m_ItemID;
            }
            else if (item is Teleporter)
            {
                Teleporter tp = (Teleporter)item;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("PointDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.PointDest = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MapDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.MapDest = Map.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Creatures"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Creatures = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SourceEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SourceEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("DestEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.DestEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SoundID"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SoundID = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Delay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Delay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                }

                if (this.m_ItemID > 0)
                    item.ItemID = this.m_ItemID;
            }
            else if (item is FillableContainer)
            {
                FillableContainer cont = (FillableContainer)item;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("ContentType"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            cont.ContentType = (FillableContentType)Enum.Parse(typeof(FillableContentType), this.m_Params[i].Substring(++indexOf), true);
                    }
                }

                if (this.m_ItemID > 0)
                    item.ItemID = this.m_ItemID;
            }
            else if (this.m_ItemID > 0)
            {
                item.ItemID = this.m_ItemID;
            }</pre>

## Duplicated Code. Size: 1984

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>if (ds.Tables != null && ds.Tables.Count > 0)
				{
					if (ds.Tables[XmlTableName] != null && ds.Tables[XmlTableName].Rows.Count > 0)
					{
						foreach (DataRow dr in ds.Tables[XmlTableName].Rows)
						{
							bool valid_entry;
							string strEntry = null;
							bool boolEntry = true;
							double doubleEntry = 0;
							int intEntry = 0;
							TimeSpan timespanEntry = TimeSpan.Zero;

							valid_entry = true;
							try { strEntry = (string)dr["Name"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.Name = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Title"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.TitleString = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Note"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.NoteString = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Reward"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.RewardString = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Attachment"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.AttachmentString = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Objective1"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.Objective1 = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Objective2"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.Objective2 = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Objective3"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.Objective3 = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Objective4"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.Objective4 = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Objective5"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.Objective5 = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Description1"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.Description1 = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Description2"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.Description2 = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Description3"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.Description3 = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Description4"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.Description4 = strEntry;
							}

							valid_entry = true;
							strEntry = null;
							try { strEntry = (string)dr["Description5"]; }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.Description5 = strEntry;
							}

							valid_entry = true;
							boolEntry = false;
							try { boolEntry = bool.Parse((string)dr["PartyEnabled"]); }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.PartyEnabled = boolEntry;
							}

							valid_entry = true;
							boolEntry = false;
							try { boolEntry = bool.Parse((string)dr["AutoReward"]); }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.AutoReward = boolEntry;
							}

							valid_entry = true;
							boolEntry = true;
							try { boolEntry = bool.Parse((string)dr["CanSeeReward"]); }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.CanSeeReward = boolEntry;
							}

							valid_entry = true;
							boolEntry = true;
							try { boolEntry = bool.Parse((string)dr["Repeatable"]); }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.m_Repeatable = boolEntry;
							}

							valid_entry = true;
							timespanEntry = TimeSpan.Zero;
							try { timespanEntry = TimeSpan.Parse((string)dr["NextRepeatable"]); }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.m_NextRepeatable = timespanEntry;
							}

							valid_entry = true;
							boolEntry = false;
							try { boolEntry = bool.Parse((string)dr["PlayerMade"]); }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.PlayerMade = boolEntry;
							}

							valid_entry = true;
							intEntry = 0;
							try { intEntry = int.Parse((string)dr["PartyRange"]); }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.PartyRange = intEntry;
							}

							valid_entry = true;
							doubleEntry = 0;
							try { doubleEntry = double.Parse((string)dr["Expiration"]); }
							catch { valid_entry = false; }
							if (valid_entry)
							{
								this.Expiration = doubleEntry;
							}
						}
					}
				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>if (ds.Tables != null && ds.Tables.Count > 0)
                {
                    if (ds.Tables[XmlTableName] != null && ds.Tables[XmlTableName].Rows.Count > 0)
                    {
                        foreach (DataRow dr in ds.Tables[XmlTableName].Rows)
                        {
                            bool valid_entry;
                            string strEntry = null;
                            bool boolEntry = true;
                            double doubleEntry = 0;
                            int intEntry = 0;
                            TimeSpan timespanEntry = TimeSpan.Zero;

                            valid_entry = true;
                            try { strEntry = (string)dr["Name"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.Name = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Title"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.TitleString = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Note"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.NoteString = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Reward"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.RewardString = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Attachment"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.AttachmentString = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Objective1"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.Objective1 = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Objective2"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.Objective2 = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Objective3"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.Objective3 = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Objective4"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.Objective4 = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Objective5"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.Objective5 = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Description1"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.Description1 = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Description2"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.Description2 = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Description3"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.Description3 = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Description4"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.Description4 = strEntry;
                            }

                            valid_entry = true;
                            strEntry = null;
                            try { strEntry = (string)dr["Description5"]; }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.Description5 = strEntry;
                            }

                            valid_entry = true;
                            boolEntry = false;
                            try { boolEntry = bool.Parse((string)dr["PartyEnabled"]); }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.PartyEnabled = boolEntry;
                            }

                            valid_entry = true;
                            boolEntry = false;
                            try { boolEntry = bool.Parse((string)dr["AutoReward"]); }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.AutoReward = boolEntry;
                            }

                            valid_entry = true;
                            boolEntry = true;
                            try { boolEntry = bool.Parse((string)dr["CanSeeReward"]); }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.CanSeeReward = boolEntry;
                            }

                            valid_entry = true;
                            boolEntry = true;
                            try { boolEntry = bool.Parse((string)dr["Repeatable"]); }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.m_Repeatable = boolEntry;
                            }

                            valid_entry = true;
                            timespanEntry = TimeSpan.Zero;
                            try { timespanEntry = TimeSpan.Parse((string)dr["NextRepeatable"]); }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.m_NextRepeatable = timespanEntry;
                            }

                            valid_entry = true;
                            boolEntry = false;
                            try { boolEntry = bool.Parse((string)dr["PlayerMade"]); }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.PlayerMade = boolEntry;
                            }

                            valid_entry = true;
                            intEntry = 0;
                            try { intEntry = int.Parse((string)dr["PartyRange"]); }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.PartyRange = intEntry;
                            }

                            valid_entry = true;
                            doubleEntry = 0;
                            try { doubleEntry = double.Parse((string)dr["Expiration"]); }
                            catch { valid_entry = false; }
                            if (valid_entry)
                            {
                                this.Expiration = doubleEntry;
                            }
                        }
                    }
                }</pre>

## Duplicated Code. Size: 1552

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBlacksmith.cs

<pre>this.Add(new GenericBuyInfo(typeof(ExecutionersAxe), 30, 20, 0xF45, 0));
                this.Add(new GenericBuyInfo(typeof(Bardiche), 60, 20, 0xF4D, 0));
                this.Add(new GenericBuyInfo(typeof(BattleAxe), 26, 20, 0xF47, 0));
                this.Add(new GenericBuyInfo(typeof(TwoHandedAxe), 32, 20, 0x1443, 0));
                this.Add(new GenericBuyInfo(typeof(Bow), 35, 20, 0x13B2, 0));
                this.Add(new GenericBuyInfo(typeof(ButcherKnife), 14, 20, 0x13F6, 0));
                this.Add(new GenericBuyInfo(typeof(Crossbow), 46, 20, 0xF50, 0));
                this.Add(new GenericBuyInfo(typeof(HeavyCrossbow), 55, 20, 0x13FD, 0));
                this.Add(new GenericBuyInfo(typeof(Cutlass), 24, 20, 0x1441, 0));
                this.Add(new GenericBuyInfo(typeof(Dagger), 21, 20, 0xF52, 0));
                this.Add(new GenericBuyInfo(typeof(Halberd), 42, 20, 0x143E, 0));
                this.Add(new GenericBuyInfo(typeof(HammerPick), 26, 20, 0x143D, 0));
                this.Add(new GenericBuyInfo(typeof(Katana), 33, 20, 0x13FF, 0));
                this.Add(new GenericBuyInfo(typeof(Kryss), 32, 20, 0x1401, 0));
                this.Add(new GenericBuyInfo(typeof(Broadsword), 35, 20, 0xF5E, 0));
                this.Add(new GenericBuyInfo(typeof(Longsword), 55, 20, 0xF61, 0));
                this.Add(new GenericBuyInfo(typeof(ThinLongsword), 27, 20, 0x13B8, 0));
                this.Add(new GenericBuyInfo(typeof(VikingSword), 55, 20, 0x13B9, 0));
                this.Add(new GenericBuyInfo(typeof(Cleaver), 15, 20, 0xEC3, 0));
                this.Add(new GenericBuyInfo(typeof(Axe), 40, 20, 0xF49, 0));
                this.Add(new GenericBuyInfo(typeof(DoubleAxe), 52, 20, 0xF4B, 0));
                this.Add(new GenericBuyInfo(typeof(Pickaxe), 22, 20, 0xE86, 0));
                this.Add(new GenericBuyInfo(typeof(Pitchfork), 19, 20, 0xE87, 0));
                this.Add(new GenericBuyInfo(typeof(Scimitar), 36, 20, 0x13B6, 0));
                this.Add(new GenericBuyInfo(typeof(SkinningKnife), 14, 20, 0xEC4, 0));
                this.Add(new GenericBuyInfo(typeof(LargeBattleAxe), 33, 20, 0x13FB, 0));
                this.Add(new GenericBuyInfo(typeof(WarAxe), 29, 20, 0x13B0, 0));

                if (Core.AOS)
                {
                    this.Add(new GenericBuyInfo(typeof(BoneHarvester), 35, 20, 0x26BB, 0));
                    this.Add(new GenericBuyInfo(typeof(CrescentBlade), 37, 20, 0x26C1, 0));
                    this.Add(new GenericBuyInfo(typeof(DoubleBladedStaff), 35, 20, 0x26BF, 0));
                    this.Add(new GenericBuyInfo(typeof(Lance), 34, 20, 0x26C0, 0));
                    this.Add(new GenericBuyInfo(typeof(Pike), 39, 20, 0x26BE, 0));
                    this.Add(new GenericBuyInfo(typeof(Scythe), 39, 20, 0x26BA, 0));
                    this.Add(new GenericBuyInfo(typeof(CompositeBow), 50, 20, 0x26C2, 0));
                    this.Add(new GenericBuyInfo(typeof(RepeatingCrossbow), 57, 20, 0x26C3, 0));
                }</pre>

Fragment 2 in file Scripts\VendorInfo\SBWeaponSmith.cs

<pre>this.Add(new GenericBuyInfo(typeof(ExecutionersAxe), 30, 20, 0xF45, 0));
                            this.Add(new GenericBuyInfo(typeof(Bardiche), 60, 20, 0xF4D, 0));
                            this.Add(new GenericBuyInfo(typeof(BattleAxe), 26, 20, 0xF47, 0));
                            this.Add(new GenericBuyInfo(typeof(TwoHandedAxe), 32, 20, 0x1443, 0));

                            this.Add(new GenericBuyInfo(typeof(Bow), 35, 20, 0x13B2, 0));

                            this.Add(new GenericBuyInfo(typeof(ButcherKnife), 14, 20, 0x13F6, 0));

                            this.Add(new GenericBuyInfo(typeof(Crossbow), 46, 20, 0xF50, 0));
                            this.Add(new GenericBuyInfo(typeof(HeavyCrossbow), 55, 20, 0x13FD, 0));

                            this.Add(new GenericBuyInfo(typeof(Cutlass), 24, 20, 0x1441, 0));
                            this.Add(new GenericBuyInfo(typeof(Dagger), 21, 20, 0xF52, 0));
                            this.Add(new GenericBuyInfo(typeof(Halberd), 42, 20, 0x143E, 0));

                            this.Add(new GenericBuyInfo(typeof(HammerPick), 26, 20, 0x143D, 0));

                            this.Add(new GenericBuyInfo(typeof(Katana), 33, 20, 0x13FF, 0));
                            this.Add(new GenericBuyInfo(typeof(Kryss), 32, 20, 0x1401, 0));
                            this.Add(new GenericBuyInfo(typeof(Broadsword), 35, 20, 0xF5E, 0));
                            this.Add(new GenericBuyInfo(typeof(Longsword), 55, 20, 0xF61, 0));
                            this.Add(new GenericBuyInfo(typeof(ThinLongsword), 27, 20, 0x13B8, 0));
                            this.Add(new GenericBuyInfo(typeof(VikingSword), 55, 20, 0x13B9, 0));

                            this.Add(new GenericBuyInfo(typeof(Cleaver), 15, 20, 0xEC3, 0));
                            this.Add(new GenericBuyInfo(typeof(Axe), 40, 20, 0xF49, 0));
                            this.Add(new GenericBuyInfo(typeof(DoubleAxe), 52, 20, 0xF4B, 0));
                            this.Add(new GenericBuyInfo(typeof(Pickaxe), 22, 20, 0xE86, 0));

                            this.Add(new GenericBuyInfo(typeof(Pitchfork), 19, 20, 0xE87, 0));

                            this.Add(new GenericBuyInfo(typeof(Scimitar), 36, 20, 0x13B6, 0));

                            this.Add(new GenericBuyInfo(typeof(SkinningKnife), 14, 20, 0xEC4, 0));

                            this.Add(new GenericBuyInfo(typeof(LargeBattleAxe), 33, 20, 0x13FB, 0));
                            this.Add(new GenericBuyInfo(typeof(WarAxe), 29, 20, 0x13B0, 0));

                            if (Core.AOS)
                            {
                                this.Add(new GenericBuyInfo(typeof(BoneHarvester), 35, 20, 0x26BB, 0));
                                this.Add(new GenericBuyInfo(typeof(CrescentBlade), 37, 20, 0x26C1, 0));
                                this.Add(new GenericBuyInfo(typeof(DoubleBladedStaff), 35, 20, 0x26BF, 0));
                                this.Add(new GenericBuyInfo(typeof(Lance), 34, 20, 0x26C0, 0));
                                this.Add(new GenericBuyInfo(typeof(Pike), 39, 20, 0x26BE, 0));
                                this.Add(new GenericBuyInfo(typeof(Scythe), 39, 20, 0x26BA, 0));
                                this.Add(new GenericBuyInfo(typeof(CompositeBow), 50, 20, 0x26C2, 0));
                                this.Add(new GenericBuyInfo(typeof(RepeatingCrossbow), 57, 20, 0x26C3, 0));
                            }</pre>

## Duplicated Code. Size: 1550

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Thepem.cs

<pre>public override bool OnDragDrop(Mobile from, Item item1)
        {
            if (item1 is PotionKeg)
            {
                PotionKeg m_Pot1 = item1 as PotionKeg;

                if (m_Pot1.Type == PotionEffect.RefreshTotal)
                {
                    from.SendMessage("OHHHH YESSS !!!");

                    int toConsume = m_Pot1.Amount;

                    if ((m_Pot1.Amount < 2) && (m_Pot1.Amount > 0))
                    {
                        from.SendMessage("You have converted 1 Keg of Total Refreshment Potion in a Inspected Keg of Total Refreshment");
                        m_Pot1.Delete();
                        from.AddToBackpack(new InspectedKegofTotalRefreshment());

                        return true;
                    }
                    else
                    {
                        from.SendMessage("You can only convert 1 Keg of Total Refreshment Potion at a time !");
                    }
                }
                else if (m_Pot1.Type == PotionEffect.PoisonGreater)
                {
                    from.SendMessage("OHHHH YESSS !!!");

                    int toConsume = m_Pot1.Amount;

                    if ((m_Pot1.Amount < 2) && (m_Pot1.Amount > 0))
                    {
                        from.SendMessage("You have converted 1 Keg of Greater Poison Potion in a Inspected Keg of Greater Poison");
                        m_Pot1.Delete();
                        from.AddToBackpack(new InspectedKegofGreaterPoison());

                        return true;
                    }
                    else
                    {
                        from.SendMessage("You can only convert 1 Keg of Greater Poison Potion at a time !");
                    }
                }
            }

            if (item1 is GoldIngot)
            {
                BaseIngot m_Ing1 = item1 as BaseIngot;

                int toConsume = m_Ing1.Amount;

                if ((m_Ing1.Amount > 19) && (m_Ing1.Amount < 21))
                {
                    from.SendMessage("You have converted 20 Gold Ingot in a Pile of Inspected Gold Ingots");
                    m_Ing1.Delete();
                    from.AddToBackpack(new PileofInspectedGoldIngots());

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 Gold Ingot at a time !");
                }
            }

            if (item1 is DullCopperIngot)
            {
                BaseIngot m_Ing2 = item1 as BaseIngot;

                int toConsume = m_Ing2.Amount;

                if ((m_Ing2.Amount > 19) && (m_Ing2.Amount < 21))
                {
                    from.SendMessage("You have converted 20 DullCopper Ingot in a Pile of Inspected DullCopper Ingots");
                    m_Ing2.Delete();
                    from.AddToBackpack(new PileofInspectedDullCopperIngots());

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 DullCopper Ingot at a time !");
                }
            }

            if (item1 is ShadowIronIngot)
            {
                BaseIngot m_Ing3 = item1 as BaseIngot;

                int toConsume = m_Ing3.Amount;

                if ((m_Ing3.Amount > 19) && (m_Ing3.Amount < 21))
                {
                    from.SendMessage("You have converted 20 ShadowIron Ingot in a Pile of Inspected ShadowIron Ingots");
                    m_Ing3.Delete();
                    from.AddToBackpack(new PileofInspectedShadowIronIngots());

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 ShadowIron Ingot at a time !");
                }
            }

            if (item1 is CopperIngot)
            {
                BaseIngot m_Ing4 = item1 as BaseIngot;

                int toConsume = m_Ing4.Amount;

                if ((m_Ing4.Amount > 19) && (m_Ing4.Amount < 21))
                {
                    from.SendMessage("You have converted 20 Copper Ingot in a Pile of Inspected Copper Ingots");
                    m_Ing4.Delete();
                    from.AddToBackpack(new PileofInspectedCopperIngots());

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 Copper Ingot at a time !");
                }
            }

            if (item1 is BronzeIngot)
            {
                BaseIngot m_Ing5 = item1 as BaseIngot;

                int toConsume = m_Ing5.Amount;

                if ((m_Ing5.Amount > 19) && (m_Ing5.Amount < 21))
                {
                    from.SendMessage("You have converted 20 Bronze Ingot in a Pile of Inspected Bronze Ingots");
                    m_Ing5.Delete();
                    from.AddToBackpack(new PileofInspectedBronzeIngots());

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 Bronze Ingot at a time !");
                }
            }

            if (item1 is AgapiteIngot)
            {
                BaseIngot m_Ing6 = item1 as BaseIngot;

                int toConsume = m_Ing6.Amount;

                if ((m_Ing6.Amount > 19) && (m_Ing6.Amount < 21))
                {
                    from.SendMessage("You have converted 20 Agapite Ingot in a Pile of Inspected Bronze Ingots");
                    m_Ing6.Delete();
                    from.AddToBackpack(new PileofInspectedAgapiteIngots());

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 Agapite Ingot at a time !");
                }
            }

            if (item1 is VeriteIngot)
            {
                BaseIngot m_Ing7 = item1 as BaseIngot;

                int toConsume = m_Ing7.Amount;

                if ((m_Ing7.Amount > 19) && (m_Ing7.Amount < 21))
                {
                    from.SendMessage("You have converted 20 Verite Ingot in a Pile of Inspected Verite Ingots");
                    m_Ing7.Delete();
                    from.AddToBackpack(new PileofInspectedVeriteIngots());

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 Verite Ingot at a time !");
                }
            }

            if (item1 is ValoriteIngot)
            {
                BaseIngot m_Ing8 = item1 as BaseIngot;

                int toConsume = m_Ing8.Amount;

                if ((m_Ing8.Amount > 19) && (m_Ing8.Amount < 21))
                {
                    from.SendMessage("You have converted 20 Valorite Ingot in a Pile of Inspected Valorite Ingots");
                    m_Ing8.Delete();
                    from.AddToBackpack(new PileofInspectedValoriteIngots());

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 Verite Ingot at a time !");
                }
            }

            return base.OnDragDrop(from, item1);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Zosilem.cs

<pre>public override bool OnDragDrop(Mobile from, Item item1)
        {
            if (item1 is PotionKeg)
            {
                PotionKeg m_Pot1 = item1 as PotionKeg;

                if (m_Pot1.Type == PotionEffect.RefreshTotal)
                {
                    from.SendMessage("OHHHH YESSS !!!");

                    int toConsume = m_Pot1.Amount;

                    if ((m_Pot1.Amount < 2) && (m_Pot1.Amount > 0))
                    {
                        from.SendMessage("You have converted 1 Keg of Total Refreshment Potion in a Inspected Keg of Total Refreshment");
                        m_Pot1.Delete();
                        from.AddToBackpack(new InspectedKegofTotalRefreshment()); 

                        return true;
                    }
                    else
                    {
                        from.SendMessage("You can only convert 1 Keg of Total Refreshment Potion at a time !");
                    }
                }
                else if (m_Pot1.Type == PotionEffect.PoisonGreater)
                {
                    from.SendMessage("OHHHH YESSS !!!");

                    int toConsume = m_Pot1.Amount;

                    if ((m_Pot1.Amount < 2) && (m_Pot1.Amount > 0))
                    {
                        from.SendMessage("You have converted 1 Keg of Greater Poison Potion in a Inspected Keg of Greater Poison");
                        m_Pot1.Delete();
                        from.AddToBackpack(new InspectedKegofGreaterPoison()); 

                        return true;
                    }
                    else
                    {
                        from.SendMessage("You can only convert 1 Keg of Greater Poison Potion at a time !");
                    }
                }
            }

            if (item1 is GoldIngot)
            {
                BaseIngot m_Ing1 = item1 as BaseIngot;

                int toConsume = m_Ing1.Amount;

                if ((m_Ing1.Amount > 19) && (m_Ing1.Amount < 21)) 
                {
                    from.SendMessage("You have converted 20 Gold Ingot in a Pile of Inspected Gold Ingots");
                    m_Ing1.Delete();
                    from.AddToBackpack(new PileofInspectedGoldIngots()); 

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 Gold Ingot at a time !");
                }
            }

            if (item1 is DullCopperIngot)
            {
                BaseIngot m_Ing2 = item1 as BaseIngot;

                int toConsume = m_Ing2.Amount;

                if ((m_Ing2.Amount > 19) && (m_Ing2.Amount < 21)) 
                {
                    from.SendMessage("You have converted 20 DullCopper Ingot in a Pile of Inspected DullCopper Ingots");
                    m_Ing2.Delete();
                    from.AddToBackpack(new PileofInspectedDullCopperIngots()); 

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 DullCopper Ingot at a time !");
                }
            }

            if (item1 is ShadowIronIngot)
            {
                BaseIngot m_Ing3 = item1 as BaseIngot;

                int toConsume = m_Ing3.Amount;

                if ((m_Ing3.Amount > 19) && (m_Ing3.Amount < 21)) 
                {
                    from.SendMessage("You have converted 20 ShadowIron Ingot in a Pile of Inspected ShadowIron Ingots");
                    m_Ing3.Delete();
                    from.AddToBackpack(new PileofInspectedShadowIronIngots()); 

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 ShadowIron Ingot at a time !");
                }
            }

            if (item1 is CopperIngot)
            {
                BaseIngot m_Ing4 = item1 as BaseIngot;

                int toConsume = m_Ing4.Amount;

                if ((m_Ing4.Amount > 19) && (m_Ing4.Amount < 21)) 
                {
                    from.SendMessage("You have converted 20 Copper Ingot in a Pile of Inspected Copper Ingots");
                    m_Ing4.Delete();
                    from.AddToBackpack(new PileofInspectedCopperIngots()); 

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 Copper Ingot at a time !");
                }
            }

            if (item1 is BronzeIngot)
            {
                BaseIngot m_Ing5 = item1 as BaseIngot;

                int toConsume = m_Ing5.Amount;

                if ((m_Ing5.Amount > 19) && (m_Ing5.Amount < 21)) 
                {
                    from.SendMessage("You have converted 20 Bronze Ingot in a Pile of Inspected Bronze Ingots");
                    m_Ing5.Delete();
                    from.AddToBackpack(new PileofInspectedBronzeIngots()); 

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 Bronze Ingot at a time !");
                }
            }

            if (item1 is AgapiteIngot)
            {
                BaseIngot m_Ing6 = item1 as BaseIngot;

                int toConsume = m_Ing6.Amount;

                if ((m_Ing6.Amount > 19) && (m_Ing6.Amount < 21)) 
                {
                    from.SendMessage("You have converted 20 Agapite Ingot in a Pile of Inspected Bronze Ingots");
                    m_Ing6.Delete();
                    from.AddToBackpack(new PileofInspectedAgapiteIngots()); 

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 Agapite Ingot at a time !");
                }
            }

            if (item1 is VeriteIngot)
            {
                BaseIngot m_Ing7 = item1 as BaseIngot;

                int toConsume = m_Ing7.Amount;

                if ((m_Ing7.Amount > 19) && (m_Ing7.Amount < 21)) 
                {
                    from.SendMessage("You have converted 20 Verite Ingot in a Pile of Inspected Verite Ingots");
                    m_Ing7.Delete();
                    from.AddToBackpack(new PileofInspectedVeriteIngots()); 

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 Verite Ingot at a time !");
                }
            }

            if (item1 is ValoriteIngot)
            {
                BaseIngot m_Ing8 = item1 as BaseIngot;

                int toConsume = m_Ing8.Amount;

                if ((m_Ing8.Amount > 19) && (m_Ing8.Amount < 21)) 
                {
                    from.SendMessage("You have converted 20 Valorite Ingot in a Pile of Inspected Valorite Ingots");
                    m_Ing8.Delete();
                    from.AddToBackpack(new PileofInspectedValoriteIngots()); 

                    return true;
                }
                else
                {
                    from.SendMessage("You can only convert 20 Verite Ingot at a time !");
                }
            }

            return base.OnDragDrop(from, item1);
        }</pre>

## Duplicated Code. Size: 1536

### Duplicated Fragments:

Fragment 1 in file Ultima\TileData.cs

<pre>Tex.Write(";" + (((tile.Flags & TileFlag.Background) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Weapon) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Transparent) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Translucent) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Wall) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Damaging) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Impassable) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Wet) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Unknown1) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Surface) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Bridge) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Generic) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Window) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.NoShoot) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.ArticleA) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.ArticleAn) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Internal) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Foliage) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.PartialHue) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Unknown2) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Map) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Container) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Wearable) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.LightSource) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Animation) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.HoverOver) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Unknown3) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Armor) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Roof) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Door) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.StairBack) != 0) ? "1" : "0"));
					Tex.WriteLine(";" + (((tile.Flags & TileFlag.StairRight) != 0) ? "1" : "0"));</pre>

Fragment 2 in file Ultima\TileData.cs

<pre>Tex.Write(";" + (((tile.Flags & TileFlag.Background) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Weapon) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Transparent) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Translucent) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Wall) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Damaging) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Impassable) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Wet) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Unknown1) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Surface) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Bridge) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Generic) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Window) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.NoShoot) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.ArticleA) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.ArticleAn) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Internal) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Foliage) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.PartialHue) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Unknown2) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Map) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Container) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Wearable) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.LightSource) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Animation) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.HoverOver) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Unknown3) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Armor) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Roof) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.Door) != 0) ? "1" : "0"));
					Tex.Write(";" + (((tile.Flags & TileFlag.StairBack) != 0) ? "1" : "0"));
					Tex.WriteLine(";" + (((tile.Flags & TileFlag.StairRight) != 0) ? "1" : "0"));</pre>

## Duplicated Code. Size: 1507

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Generate.cs

<pre>sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(1482, 1754, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(1482, 1754, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Moonglow
            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(4406, 1049, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(4406, 1049, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Trinsic
            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(2061, 2855, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(2061, 2855, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Vesper
            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(3009, 826, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(3009, 826, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Jhelom
            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(1373, 3885, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(1373, 3885, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Skara Brae
            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(641, 2234, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.MoveToWorld(new Point3D(641, 2234, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Papua
            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(5827, 3258, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(5827, 3258, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Floating Eproriam
            sp = new XmlSpawner(toSpawn);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Generate.cs

<pre>sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(1482, 1754, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(1482, 1754, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Moonglow
            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(4406, 1049, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(4406, 1049, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Trinsic
            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(2061, 2855, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(2061, 2855, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Vesper
            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(3009, 826, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(3009, 826, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Jhelom
            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(1373, 3885, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(1373, 3885, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Skara Brae
            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(641, 2234, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.MoveToWorld(new Point3D(641, 2234, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Papua
            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(5827, 3258, -2), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(5827, 3258, -2), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            //Floating Eproriam
            sp = new XmlSpawner(toSpawn);</pre>

## Duplicated Code. Size: 1477

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>{
                SkillTeleporter tp = (SkillTeleporter)item;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("Skill"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Skill = (SkillName)Enum.Parse(typeof(SkillName), this.m_Params[i].Substring(++indexOf), true);
                    }
                    else if (this.m_Params[i].StartsWith("RequiredFixedPoint"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Required = Utility.ToInt32(this.m_Params[i].Substring(++indexOf)) * 0.1;
                    }
                    else if (this.m_Params[i].StartsWith("Required"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Required = Utility.ToDouble(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MessageString"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.MessageString = this.m_Params[i].Substring(++indexOf);
                    }
                    else if (this.m_Params[i].StartsWith("MessageNumber"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.MessageNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("PointDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.PointDest = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MapDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.MapDest = Map.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Creatures"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Creatures = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SourceEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SourceEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("DestEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.DestEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SoundID"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SoundID = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Delay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Delay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                }

                if (this.m_ItemID > 0)
                    item.ItemID = this.m_ItemID;
            }</pre>

Fragment 2 in file Scripts\Commands\DecorateMag.cs

<pre>{
                SkillTeleporter tp = (SkillTeleporter)item;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("Skill"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Skill = (SkillName)Enum.Parse(typeof(SkillName), this.m_Params[i].Substring(++indexOf), true);
                    }
                    else if (this.m_Params[i].StartsWith("RequiredFixedPoint"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Required = Utility.ToInt32(this.m_Params[i].Substring(++indexOf)) * 0.1;
                    }
                    else if (this.m_Params[i].StartsWith("Required"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Required = Utility.ToDouble(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MessageString"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.MessageString = this.m_Params[i].Substring(++indexOf);
                    }
                    else if (this.m_Params[i].StartsWith("MessageNumber"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.MessageNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("PointDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.PointDest = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MapDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.MapDest = Map.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Creatures"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Creatures = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SourceEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SourceEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("DestEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.DestEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SoundID"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SoundID = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Delay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Delay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                }

                if (this.m_ItemID > 0)
                    item.ItemID = this.m_ItemID;
            }</pre>

## Duplicated Code. Size: 1437

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>public override void Deserialize( GenericReader reader )
		{
			base.Deserialize( reader );

			int version = reader.ReadInt();

			if(version < 5)
			{
				// have to add the XmlDialog attachment
				m_DialogAttachment = new XmlDialog((string)null);
				XmlAttach.AttachTo(this, m_DialogAttachment);
			}

			switch ( version )
			{
				case 7:
					m_EItemID = reader.ReadInt();
					m_Duration = reader.ReadInt();
					m_Offset = reader.ReadPoint3D();
					m_EHue = reader.ReadInt();
					goto case 6;
				case 6:
					TalkText = reader.ReadString();
					break;
				case 5:
				{
					break;
				}
				case 4:
				{
					int count = reader.ReadInt();

					SpeechEntries = new ArrayList();
					for(int i = 0; i<count;i++)
					{
						XmlDialog.SpeechEntry newentry = new XmlDialog.SpeechEntry();

						newentry.Condition = reader.ReadString();

						SpeechEntries.Add(newentry);
					}

					goto case 3;
				}
				case 3:
				{
					TriggerOnCarried = reader.ReadString();
					NoTriggerOnCarried = reader.ReadString();
					goto case 2;
				}
				case 2:
				{
					SpeechPace = reader.ReadInt();

					int count = reader.ReadInt();
					if(version < 4)
					{
						SpeechEntries = new ArrayList();
					}
					for(int i = 0; i<count;i++)
					{
						if(version < 4)
						{
							XmlDialog.SpeechEntry newentry = new XmlDialog.SpeechEntry();

							newentry.PrePause = reader.ReadInt();
							newentry.LockConversation = reader.ReadBool();
							newentry.AllowNPCTrigger = reader.ReadBool();
							newentry.SpeechStyle = (MessageType)reader.ReadInt();

							SpeechEntries.Add(newentry);
						} 
						else 
						{
							XmlDialog.SpeechEntry newentry = (XmlDialog.SpeechEntry)SpeechEntries[i];

							newentry.PrePause = reader.ReadInt();
							newentry.LockConversation = reader.ReadBool();
							newentry.AllowNPCTrigger = reader.ReadBool();
							newentry.SpeechStyle = (MessageType)reader.ReadInt();
						}
					}
					goto case 1;
				}
				case 1:
				{
					ActivePlayer = reader.ReadMobile();
					goto case 0;
				}
				case 0:
				{
					IsActive = reader.ReadBool();
					ResetTime = reader.ReadTimeSpan();
					LastInteraction = reader.ReadDateTime();
					AllowGhostTrig = reader.ReadBool();
					ProximityRange = reader.ReadInt();
					Running = reader.ReadBool();
					ConfigFile = reader.ReadString();
					int count = reader.ReadInt();
					if(version < 2)
					{
						SpeechEntries = new ArrayList();
					}
					for(int i = 0; i<count;i++)
					{

						if(version < 2)
						{
							XmlDialog.SpeechEntry newentry = new XmlDialog.SpeechEntry();

							newentry.EntryNumber = reader.ReadInt();
							newentry.ID = reader.ReadInt();
							newentry.Text = reader.ReadString();
							newentry.Keywords = reader.ReadString();
							newentry.Action = reader.ReadString();
							newentry.DependsOn = reader.ReadInt().ToString();
							newentry.Pause = reader.ReadInt();

							SpeechEntries.Add(newentry);
						} 
						else
						{
							XmlDialog.SpeechEntry newentry = (XmlDialog.SpeechEntry)SpeechEntries[i];

							newentry.EntryNumber = reader.ReadInt();
							newentry.ID = reader.ReadInt();
							newentry.Text = reader.ReadString();
							newentry.Keywords = reader.ReadString();
							newentry.Action = reader.ReadString();
							newentry.DependsOn = reader.ReadInt().ToString();
							newentry.Pause = reader.ReadInt();
						}
					}
					// read in the current entry number. Note this will also set the current entry
					EntryNumber = reader.ReadInt();
					// restart the timer if it was active
					bool isrunning = reader.ReadBool();
					if(isrunning)
					{
						Mobile trigmob = reader.ReadMobile();
						TimeSpan delay = reader.ReadTimeSpan();
						if(DialogAttachment != null)
							DialogAttachment.DoTimer(delay,trigmob);
					}
					break;
				}
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>public override void Deserialize( GenericReader reader )
		{
			base.Deserialize( reader );

			int version = reader.ReadInt();

			if(version < 5)
			{
				// have to add the XmlDialog attachment
				m_DialogAttachment = new XmlDialog((string)null);
				XmlAttach.AttachTo(this, m_DialogAttachment);
			}

			switch ( version )
			{
				case 7:
					m_EItemID = reader.ReadInt();
					m_Duration = reader.ReadInt();
					m_Offset = reader.ReadPoint3D();
					m_EHue = reader.ReadInt();
					goto case 6;
				case 6:
					TalkText = reader.ReadString();
					break;
				case 5:
				{
					break;
				}
				case 4:
				{
					int count = reader.ReadInt();

					SpeechEntries = new ArrayList();
					for(int i = 0; i<count;i++)
					{
						XmlDialog.SpeechEntry newentry = new XmlDialog.SpeechEntry();

						newentry.Condition = reader.ReadString();

						SpeechEntries.Add(newentry);
					}

					goto case 3;
				}
				case 3:
				{
					TriggerOnCarried = reader.ReadString();
					NoTriggerOnCarried = reader.ReadString();
					goto case 2;
				}
				case 2:
				{
					SpeechPace = reader.ReadInt();

					int count = reader.ReadInt();
					if(version < 4)
					{
						SpeechEntries = new ArrayList();
					}
					for(int i = 0; i<count;i++)
					{
						if(version < 4)
						{
							XmlDialog.SpeechEntry newentry = new XmlDialog.SpeechEntry();

							newentry.PrePause = reader.ReadInt();
							newentry.LockConversation = reader.ReadBool();
							newentry.AllowNPCTrigger = reader.ReadBool();
							newentry.SpeechStyle = (MessageType)reader.ReadInt();

							SpeechEntries.Add(newentry);
						} 
						else 
						{
							XmlDialog.SpeechEntry newentry = (XmlDialog.SpeechEntry)SpeechEntries[i];

							newentry.PrePause = reader.ReadInt();
							newentry.LockConversation = reader.ReadBool();
							newentry.AllowNPCTrigger = reader.ReadBool();
							newentry.SpeechStyle = (MessageType)reader.ReadInt();
						}
					}
					goto case 1;
				}
				case 1:
				{
					ActivePlayer = reader.ReadMobile();
					goto case 0;
				}
				case 0:
				{
					IsActive = reader.ReadBool();
					ResetTime = reader.ReadTimeSpan();
					LastInteraction = reader.ReadDateTime();
					AllowGhostTrig = reader.ReadBool();
					ProximityRange = reader.ReadInt();
					Running = reader.ReadBool();
					ConfigFile = reader.ReadString();
					int count = reader.ReadInt();
					if(version < 2)
					{
						SpeechEntries = new ArrayList();
					}
					for(int i = 0; i<count;i++)
					{

						if(version < 2)
						{
							XmlDialog.SpeechEntry newentry = new XmlDialog.SpeechEntry();

							newentry.EntryNumber = reader.ReadInt();
							newentry.ID = reader.ReadInt();
							newentry.Text = reader.ReadString();
							newentry.Keywords = reader.ReadString();
							newentry.Action = reader.ReadString();
							newentry.DependsOn = reader.ReadInt().ToString();
							newentry.Pause = reader.ReadInt();

							SpeechEntries.Add(newentry);
						} 
						else
						{
							XmlDialog.SpeechEntry newentry = (XmlDialog.SpeechEntry)SpeechEntries[i];

							newentry.EntryNumber = reader.ReadInt();
							newentry.ID = reader.ReadInt();
							newentry.Text = reader.ReadString();
							newentry.Keywords = reader.ReadString();
							newentry.Action = reader.ReadString();
							newentry.DependsOn = reader.ReadInt().ToString();
							newentry.Pause = reader.ReadInt();
						}
					}
					// read in the current entry number. Note this will also set the current entry
					EntryNumber = reader.ReadInt();
					// restart the timer if it was active
					bool isrunning = reader.ReadBool();
					if(isrunning)
					{
						Mobile trigmob = reader.ReadMobile();
						TimeSpan delay = reader.ReadTimeSpan();
						if(DialogAttachment != null)
							DialogAttachment.DoTimer(delay,trigmob);
					}
					break;
				}
			}
		}</pre>

## Duplicated Code. Size: 1284

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Arabella.cs

<pre>int[] hues = new int[] { 0x1E0, 0x190, 0x151 };			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendBodySash), 0x1541, 1073346, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendFeatheredHat), 0x171A, 1073347, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSurcoat), 0x1FFD, 1073348, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendPants), 0x1539, 1073349, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendCloak), 0x1515, 1073350, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendDoublet), 0x1F7B, 1073351, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSkirt), 0x1537, 1073352, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionTitle(1073341, 1073859, 100000.0)); // Britain Public Library Contributor

            hues = new int[] { 0x0, 0x1C2, 0x320, 0x190, 0x1E0 };
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendLantern), 0xA25, 1073339, 0x1C2, 200000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendReadingChair), 0x2DEB, 1073340, 0x1C2, 200000.0, hues));			
            this.Rewards.Add(new CollectionTitle(1073342, 1073860, 200000.0)); // Distinguished Library Contributor
            this.Rewards.Add(new CollectionHuedItem(typeof(SherryTheMouseQuotes), 0xFBD, 1073300, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(WyrdBeastmasterQuotes), 0xFBD, 1073310, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(MercenaryJustinQuotes), 0xFBD, 1073317, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(HeigelOfMoonglowQuotes), 0xFBD, 1073327, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(TraderHoraceQuotes), 0xFBD, 1073338, 0x1C2, 350000.0, hues));				
            this.Rewards.Add(new CollectionTitle(1073343, 1073861, 350000.0)); // Honored Library Contributor			
            this.Rewards.Add(new CollectionItem(typeof(TreatiseonAlchemyTalisman), 0x2F58, 1073353, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(PrimerOnArmsTalisman), 0x2F59, 1073354, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(MyBookTalisman), 0x2F5A, 1073355, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(TalkingtoWispsTalisman), 0x2F5B, 1073356, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(GrammarOfOrchishTalisman), 0x2F59, 1073358, 0x0, 550000.0));
            this.Rewards.Add(new CollectionItem(typeof(BirdsofBritanniaTalisman), 0x2F5A, 1073359, 0x0, 550000.0));	
            this.Rewards.Add(new CollectionItem(typeof(TheLifeOfTravelingMinstrelTalisman), 0x2F5A, 1073360, 0x0, 550000.0));						
            this.Rewards.Add(new CollectionTitle(1073344, 1073862, 550000.0)); // Prominent Library Contributor
            this.Rewards.Add(new CollectionTitle(1073345, 1073863, 800000.0)); // Eminent Library Contributor</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Bonnie.cs

<pre>int[] hues = new int[] { 0x1E0, 0x190, 0x151 };			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendBodySash), 0x1541, 1073346, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendFeatheredHat), 0x171A, 1073347, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSurcoat), 0x1FFD, 1073348, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendPants), 0x1539, 1073349, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendCloak), 0x1515, 1073350, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendDoublet), 0x1F7B, 1073351, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSkirt), 0x1537, 1073352, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionTitle(1073341, 1073859, 100000.0)); // Britain Public Library Contributor

            hues = new int[] { 0x0, 0x1C2, 0x320, 0x190, 0x1E0 };
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendLantern), 0xA25, 1073339, 0x1C2, 200000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendReadingChair), 0x2DEB, 1073340, 0x1C2, 200000.0, hues));			
            this.Rewards.Add(new CollectionTitle(1073342, 1073860, 200000.0)); // Distinguished Library Contributor
            this.Rewards.Add(new CollectionHuedItem(typeof(SherryTheMouseQuotes), 0xFBD, 1073300, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(WyrdBeastmasterQuotes), 0xFBD, 1073310, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(MercenaryJustinQuotes), 0xFBD, 1073317, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(HeigelOfMoonglowQuotes), 0xFBD, 1073327, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(TraderHoraceQuotes), 0xFBD, 1073338, 0x1C2, 350000.0, hues));				
            this.Rewards.Add(new CollectionTitle(1073343, 1073861, 350000.0)); // Honored Library Contributor			
            this.Rewards.Add(new CollectionItem(typeof(TreatiseonAlchemyTalisman), 0x2F58, 1073353, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(PrimerOnArmsTalisman), 0x2F59, 1073354, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(MyBookTalisman), 0x2F5A, 1073355, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(TalkingtoWispsTalisman), 0x2F5B, 1073356, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(GrammarOfOrchishTalisman), 0x2F59, 1073358, 0x0, 550000.0));
            this.Rewards.Add(new CollectionItem(typeof(BirdsofBritanniaTalisman), 0x2F5A, 1073359, 0x0, 550000.0));	
            this.Rewards.Add(new CollectionItem(typeof(TheLifeOfTravelingMinstrelTalisman), 0x2F5A, 1073360, 0x0, 550000.0));						
            this.Rewards.Add(new CollectionTitle(1073344, 1073862, 550000.0)); // Prominent Library Contributor
            this.Rewards.Add(new CollectionTitle(1073345, 1073863, 800000.0)); // Eminent Library Contributor</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Corey.cs

<pre>int[] hues = new int[] { 0x1E0, 0x190, 0x151 };			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendBodySash), 0x1541, 1073346, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendFeatheredHat), 0x171A, 1073347, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSurcoat), 0x1FFD, 1073348, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendPants), 0x1539, 1073349, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendCloak), 0x1515, 1073350, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendDoublet), 0x1F7B, 1073351, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSkirt), 0x1537, 1073352, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionTitle(1073341, 1073859, 100000.0)); // Britain Public Library Contributor

            hues = new int[] { 0x0, 0x1C2, 0x320, 0x190, 0x1E0 };
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendLantern), 0xA25, 1073339, 0x1C2, 200000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendReadingChair), 0x2DEB, 1073340, 0x1C2, 200000.0, hues));			
            this.Rewards.Add(new CollectionTitle(1073342, 1073860, 200000.0)); // Distinguished Library Contributor
            this.Rewards.Add(new CollectionHuedItem(typeof(SherryTheMouseQuotes), 0xFBD, 1073300, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(WyrdBeastmasterQuotes), 0xFBD, 1073310, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(MercenaryJustinQuotes), 0xFBD, 1073317, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(HeigelOfMoonglowQuotes), 0xFBD, 1073327, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(TraderHoraceQuotes), 0xFBD, 1073338, 0x1C2, 350000.0, hues));				
            this.Rewards.Add(new CollectionTitle(1073343, 1073861, 350000.0)); // Honored Library Contributor			
            this.Rewards.Add(new CollectionItem(typeof(TreatiseonAlchemyTalisman), 0x2F58, 1073353, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(PrimerOnArmsTalisman), 0x2F59, 1073354, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(MyBookTalisman), 0x2F5A, 1073355, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(TalkingtoWispsTalisman), 0x2F5B, 1073356, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(GrammarOfOrchishTalisman), 0x2F59, 1073358, 0x0, 550000.0));
            this.Rewards.Add(new CollectionItem(typeof(BirdsofBritanniaTalisman), 0x2F5A, 1073359, 0x0, 550000.0));	
            this.Rewards.Add(new CollectionItem(typeof(TheLifeOfTravelingMinstrelTalisman), 0x2F5A, 1073360, 0x0, 550000.0));						
            this.Rewards.Add(new CollectionTitle(1073344, 1073862, 550000.0)); // Prominent Library Contributor
            this.Rewards.Add(new CollectionTitle(1073345, 1073863, 800000.0)); // Eminent Library Contributor</pre>

Fragment 4 in file Scripts\Mobiles\NPCs\Enrico.cs

<pre>int[] hues = new int[] { 0x1E0, 0x190, 0x151 };			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendBodySash), 0x1541, 1073346, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendFeatheredHat), 0x171A, 1073347, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSurcoat), 0x1FFD, 1073348, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendPants), 0x1539, 1073349, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendCloak), 0x1515, 1073350, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendDoublet), 0x1F7B, 1073351, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSkirt), 0x1537, 1073352, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionTitle(1073341, 1073859, 100000.0)); // Britain Public Library Contributor

            hues = new int[] { 0x0, 0x1C2, 0x320, 0x190, 0x1E0 };
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendLantern), 0xA25, 1073339, 0x1C2, 200000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendReadingChair), 0x2DEB, 1073340, 0x1C2, 200000.0, hues));			
            this.Rewards.Add(new CollectionTitle(1073342, 1073860, 200000.0)); // Distinguished Library Contributor
            this.Rewards.Add(new CollectionHuedItem(typeof(SherryTheMouseQuotes), 0xFBD, 1073300, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(WyrdBeastmasterQuotes), 0xFBD, 1073310, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(MercenaryJustinQuotes), 0xFBD, 1073317, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(HeigelOfMoonglowQuotes), 0xFBD, 1073327, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(TraderHoraceQuotes), 0xFBD, 1073338, 0x1C2, 350000.0, hues));				
            this.Rewards.Add(new CollectionTitle(1073343, 1073861, 350000.0)); // Honored Library Contributor			
            this.Rewards.Add(new CollectionItem(typeof(TreatiseonAlchemyTalisman), 0x2F58, 1073353, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(PrimerOnArmsTalisman), 0x2F59, 1073354, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(MyBookTalisman), 0x2F5A, 1073355, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(TalkingtoWispsTalisman), 0x2F5B, 1073356, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(GrammarOfOrchishTalisman), 0x2F59, 1073358, 0x0, 550000.0));
            this.Rewards.Add(new CollectionItem(typeof(BirdsofBritanniaTalisman), 0x2F5A, 1073359, 0x0, 550000.0));	
            this.Rewards.Add(new CollectionItem(typeof(TheLifeOfTravelingMinstrelTalisman), 0x2F5A, 1073360, 0x0, 550000.0));						
            this.Rewards.Add(new CollectionTitle(1073344, 1073862, 550000.0)); // Prominent Library Contributor
            this.Rewards.Add(new CollectionTitle(1073345, 1073863, 800000.0)); // Eminent Library Contributor</pre>

Fragment 5 in file Scripts\Mobiles\NPCs\Filbert.cs

<pre>int[] hues = new int[] { 0x1E0, 0x190, 0x151 };			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendBodySash), 0x1541, 1073346, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendFeatheredHat), 0x171A, 1073347, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSurcoat), 0x1FFD, 1073348, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendPants), 0x1539, 1073349, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendCloak), 0x1515, 1073350, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendDoublet), 0x1F7B, 1073351, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSkirt), 0x1537, 1073352, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionTitle(1073341, 1073859, 100000.0)); // Britain Public Library Contributor

            hues = new int[] { 0x0, 0x1C2, 0x320, 0x190, 0x1E0 };
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendLantern), 0xA25, 1073339, 0x1C2, 200000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendReadingChair), 0x2DEB, 1073340, 0x1C2, 200000.0, hues));			
            this.Rewards.Add(new CollectionTitle(1073342, 1073860, 200000.0)); // Distinguished Library Contributor
            this.Rewards.Add(new CollectionHuedItem(typeof(SherryTheMouseQuotes), 0xFBD, 1073300, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(WyrdBeastmasterQuotes), 0xFBD, 1073310, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(MercenaryJustinQuotes), 0xFBD, 1073317, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(HeigelOfMoonglowQuotes), 0xFBD, 1073327, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(TraderHoraceQuotes), 0xFBD, 1073338, 0x1C2, 350000.0, hues));				
            this.Rewards.Add(new CollectionTitle(1073343, 1073861, 350000.0)); // Honored Library Contributor			
            this.Rewards.Add(new CollectionItem(typeof(TreatiseonAlchemyTalisman), 0x2F58, 1073353, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(PrimerOnArmsTalisman), 0x2F59, 1073354, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(MyBookTalisman), 0x2F5A, 1073355, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(TalkingtoWispsTalisman), 0x2F5B, 1073356, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(GrammarOfOrchishTalisman), 0x2F59, 1073358, 0x0, 550000.0));
            this.Rewards.Add(new CollectionItem(typeof(BirdsofBritanniaTalisman), 0x2F5A, 1073359, 0x0, 550000.0));	
            this.Rewards.Add(new CollectionItem(typeof(TheLifeOfTravelingMinstrelTalisman), 0x2F5A, 1073360, 0x0, 550000.0));						
            this.Rewards.Add(new CollectionTitle(1073344, 1073862, 550000.0)); // Prominent Library Contributor
            this.Rewards.Add(new CollectionTitle(1073345, 1073863, 800000.0)); // Eminent Library Contributor</pre>

Fragment 6 in file Scripts\Mobiles\NPCs\Joy.cs

<pre>int[] hues = new int[] { 0x1E0, 0x190, 0x151 };			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendBodySash), 0x1541, 1073346, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendFeatheredHat), 0x171A, 1073347, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSurcoat), 0x1FFD, 1073348, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendPants), 0x1539, 1073349, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendCloak), 0x1515, 1073350, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendDoublet), 0x1F7B, 1073351, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSkirt), 0x1537, 1073352, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionTitle(1073341, 1073859, 100000.0)); // Britain Public Library Contributor

            hues = new int[] { 0x0, 0x1C2, 0x320, 0x190, 0x1E0 };
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendLantern), 0xA25, 1073339, 0x1C2, 200000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendReadingChair), 0x2DEB, 1073340, 0x1C2, 200000.0, hues));			
            this.Rewards.Add(new CollectionTitle(1073342, 1073860, 200000.0)); // Distinguished Library Contributor
            this.Rewards.Add(new CollectionHuedItem(typeof(SherryTheMouseQuotes), 0xFBD, 1073300, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(WyrdBeastmasterQuotes), 0xFBD, 1073310, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(MercenaryJustinQuotes), 0xFBD, 1073317, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(HeigelOfMoonglowQuotes), 0xFBD, 1073327, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(TraderHoraceQuotes), 0xFBD, 1073338, 0x1C2, 350000.0, hues));				
            this.Rewards.Add(new CollectionTitle(1073343, 1073861, 350000.0)); // Honored Library Contributor			
            this.Rewards.Add(new CollectionItem(typeof(TreatiseonAlchemyTalisman), 0x2F58, 1073353, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(PrimerOnArmsTalisman), 0x2F59, 1073354, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(MyBookTalisman), 0x2F5A, 1073355, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(TalkingtoWispsTalisman), 0x2F5B, 1073356, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(GrammarOfOrchishTalisman), 0x2F59, 1073358, 0x0, 550000.0));
            this.Rewards.Add(new CollectionItem(typeof(BirdsofBritanniaTalisman), 0x2F5A, 1073359, 0x0, 550000.0));	
            this.Rewards.Add(new CollectionItem(typeof(TheLifeOfTravelingMinstrelTalisman), 0x2F5A, 1073360, 0x0, 550000.0));						
            this.Rewards.Add(new CollectionTitle(1073344, 1073862, 550000.0)); // Prominent Library Contributor
            this.Rewards.Add(new CollectionTitle(1073345, 1073863, 800000.0)); // Eminent Library Contributor</pre>

Fragment 7 in file Scripts\Mobiles\NPCs\Margo.cs

<pre>int[] hues = new int[] { 0x1E0, 0x190, 0x151 };			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendBodySash), 0x1541, 1073346, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendFeatheredHat), 0x171A, 1073347, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSurcoat), 0x1FFD, 1073348, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendPants), 0x1539, 1073349, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendCloak), 0x1515, 1073350, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendDoublet), 0x1F7B, 1073351, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSkirt), 0x1537, 1073352, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionTitle(1073341, 1073859, 100000.0)); // Britain Public Library Contributor

            hues = new int[] { 0x0, 0x1C2, 0x320, 0x190, 0x1E0 };
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendLantern), 0xA25, 1073339, 0x1C2, 200000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendReadingChair), 0x2DEB, 1073340, 0x1C2, 200000.0, hues));			
            this.Rewards.Add(new CollectionTitle(1073342, 1073860, 200000.0)); // Distinguished Library Contributor
            this.Rewards.Add(new CollectionHuedItem(typeof(SherryTheMouseQuotes), 0xFBD, 1073300, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(WyrdBeastmasterQuotes), 0xFBD, 1073310, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(MercenaryJustinQuotes), 0xFBD, 1073317, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(HeigelOfMoonglowQuotes), 0xFBD, 1073327, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(TraderHoraceQuotes), 0xFBD, 1073338, 0x1C2, 350000.0, hues));				
            this.Rewards.Add(new CollectionTitle(1073343, 1073861, 350000.0)); // Honored Library Contributor			
            this.Rewards.Add(new CollectionItem(typeof(TreatiseonAlchemyTalisman), 0x2F58, 1073353, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(PrimerOnArmsTalisman), 0x2F59, 1073354, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(MyBookTalisman), 0x2F5A, 1073355, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(TalkingtoWispsTalisman), 0x2F5B, 1073356, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(GrammarOfOrchishTalisman), 0x2F59, 1073358, 0x0, 550000.0));
            this.Rewards.Add(new CollectionItem(typeof(BirdsofBritanniaTalisman), 0x2F5A, 1073359, 0x0, 550000.0));	
            this.Rewards.Add(new CollectionItem(typeof(TheLifeOfTravelingMinstrelTalisman), 0x2F5A, 1073360, 0x0, 550000.0));						
            this.Rewards.Add(new CollectionTitle(1073344, 1073862, 550000.0)); // Prominent Library Contributor
            this.Rewards.Add(new CollectionTitle(1073345, 1073863, 800000.0)); // Eminent Library Contributor</pre>

Fragment 8 in file Scripts\Mobiles\NPCs\Odell.cs

<pre>int[] hues = new int[] { 0x1E0, 0x190, 0x151 };			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendBodySash), 0x1541, 1073346, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendFeatheredHat), 0x171A, 1073347, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSurcoat), 0x1FFD, 1073348, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendPants), 0x1539, 1073349, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendCloak), 0x1515, 1073350, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendDoublet), 0x1F7B, 1073351, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSkirt), 0x1537, 1073352, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionTitle(1073341, 1073859, 100000.0)); // Britain Public Library Contributor

            hues = new int[] { 0x0, 0x1C2, 0x320, 0x190, 0x1E0 };
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendLantern), 0xA25, 1073339, 0x1C2, 200000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendReadingChair), 0x2DEB, 1073340, 0x1C2, 200000.0, hues));			
            this.Rewards.Add(new CollectionTitle(1073342, 1073860, 200000.0)); // Distinguished Library Contributor
            this.Rewards.Add(new CollectionHuedItem(typeof(SherryTheMouseQuotes), 0xFBD, 1073300, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(WyrdBeastmasterQuotes), 0xFBD, 1073310, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(MercenaryJustinQuotes), 0xFBD, 1073317, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(HeigelOfMoonglowQuotes), 0xFBD, 1073327, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(TraderHoraceQuotes), 0xFBD, 1073338, 0x1C2, 350000.0, hues));				
            this.Rewards.Add(new CollectionTitle(1073343, 1073861, 350000.0)); // Honored Library Contributor			
            this.Rewards.Add(new CollectionItem(typeof(TreatiseonAlchemyTalisman), 0x2F58, 1073353, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(PrimerOnArmsTalisman), 0x2F59, 1073354, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(MyBookTalisman), 0x2F5A, 1073355, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(TalkingtoWispsTalisman), 0x2F5B, 1073356, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(GrammarOfOrchishTalisman), 0x2F59, 1073358, 0x0, 550000.0));
            this.Rewards.Add(new CollectionItem(typeof(BirdsofBritanniaTalisman), 0x2F5A, 1073359, 0x0, 550000.0));	
            this.Rewards.Add(new CollectionItem(typeof(TheLifeOfTravelingMinstrelTalisman), 0x2F5A, 1073360, 0x0, 550000.0));						
            this.Rewards.Add(new CollectionTitle(1073344, 1073862, 550000.0)); // Prominent Library Contributor
            this.Rewards.Add(new CollectionTitle(1073345, 1073863, 800000.0)); // Eminent Library Contributor</pre>

Fragment 9 in file Scripts\Mobiles\NPCs\Sam.cs

<pre>int[] hues = new int[] { 0x1E0, 0x190, 0x151 };			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendBodySash), 0x1541, 1073346, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendFeatheredHat), 0x171A, 1073347, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSurcoat), 0x1FFD, 1073348, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendPants), 0x1539, 1073349, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendCloak), 0x1515, 1073350, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendDoublet), 0x1F7B, 1073351, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSkirt), 0x1537, 1073352, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionTitle(1073341, 1073859, 100000.0)); // Britain Public Library Contributor

            hues = new int[] { 0x0, 0x1C2, 0x320, 0x190, 0x1E0 };
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendLantern), 0xA25, 1073339, 0x1C2, 200000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendReadingChair), 0x2DEB, 1073340, 0x1C2, 200000.0, hues));			
            this.Rewards.Add(new CollectionTitle(1073342, 1073860, 200000.0)); // Distinguished Library Contributor
            this.Rewards.Add(new CollectionHuedItem(typeof(SherryTheMouseQuotes), 0xFBD, 1073300, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(WyrdBeastmasterQuotes), 0xFBD, 1073310, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(MercenaryJustinQuotes), 0xFBD, 1073317, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(HeigelOfMoonglowQuotes), 0xFBD, 1073327, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(TraderHoraceQuotes), 0xFBD, 1073338, 0x1C2, 350000.0, hues));				
            this.Rewards.Add(new CollectionTitle(1073343, 1073861, 350000.0)); // Honored Library Contributor			
            this.Rewards.Add(new CollectionItem(typeof(TreatiseonAlchemyTalisman), 0x2F58, 1073353, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(PrimerOnArmsTalisman), 0x2F59, 1073354, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(MyBookTalisman), 0x2F5A, 1073355, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(TalkingtoWispsTalisman), 0x2F5B, 1073356, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(GrammarOfOrchishTalisman), 0x2F59, 1073358, 0x0, 550000.0));
            this.Rewards.Add(new CollectionItem(typeof(BirdsofBritanniaTalisman), 0x2F5A, 1073359, 0x0, 550000.0));	
            this.Rewards.Add(new CollectionItem(typeof(TheLifeOfTravelingMinstrelTalisman), 0x2F5A, 1073360, 0x0, 550000.0));						
            this.Rewards.Add(new CollectionTitle(1073344, 1073862, 550000.0)); // Prominent Library Contributor
            this.Rewards.Add(new CollectionTitle(1073345, 1073863, 800000.0)); // Eminent Library Contributor</pre>

Fragment 10 in file Scripts\Mobiles\NPCs\Talbart.cs

<pre>int[] hues = new int[] { 0x1E0, 0x190, 0x151 };			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendBodySash), 0x1541, 1073346, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendFeatheredHat), 0x171A, 1073347, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSurcoat), 0x1FFD, 1073348, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendPants), 0x1539, 1073349, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendCloak), 0x1515, 1073350, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendDoublet), 0x1F7B, 1073351, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSkirt), 0x1537, 1073352, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionTitle(1073341, 1073859, 100000.0)); // Britain Public Library Contributor

            hues = new int[] { 0x0, 0x1C2, 0x320, 0x190, 0x1E0 };
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendLantern), 0xA25, 1073339, 0x1C2, 200000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendReadingChair), 0x2DEB, 1073340, 0x1C2, 200000.0, hues));			
            this.Rewards.Add(new CollectionTitle(1073342, 1073860, 200000.0)); // Distinguished Library Contributor
            this.Rewards.Add(new CollectionHuedItem(typeof(SherryTheMouseQuotes), 0xFBD, 1073300, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(WyrdBeastmasterQuotes), 0xFBD, 1073310, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(MercenaryJustinQuotes), 0xFBD, 1073317, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(HeigelOfMoonglowQuotes), 0xFBD, 1073327, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(TraderHoraceQuotes), 0xFBD, 1073338, 0x1C2, 350000.0, hues));				
            this.Rewards.Add(new CollectionTitle(1073343, 1073861, 350000.0)); // Honored Library Contributor			
            this.Rewards.Add(new CollectionItem(typeof(TreatiseonAlchemyTalisman), 0x2F58, 1073353, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(PrimerOnArmsTalisman), 0x2F59, 1073354, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(MyBookTalisman), 0x2F5A, 1073355, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(TalkingtoWispsTalisman), 0x2F5B, 1073356, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(GrammarOfOrchishTalisman), 0x2F59, 1073358, 0x0, 550000.0));
            this.Rewards.Add(new CollectionItem(typeof(BirdsofBritanniaTalisman), 0x2F5A, 1073359, 0x0, 550000.0));	
            this.Rewards.Add(new CollectionItem(typeof(TheLifeOfTravelingMinstrelTalisman), 0x2F5A, 1073360, 0x0, 550000.0));						
            this.Rewards.Add(new CollectionTitle(1073344, 1073862, 550000.0)); // Prominent Library Contributor
            this.Rewards.Add(new CollectionTitle(1073345, 1073863, 800000.0)); // Eminent Library Contributor</pre>

Fragment 11 in file Scripts\Mobiles\NPCs\Xanthe.cs

<pre>int[] hues = new int[] { 0x1E0, 0x190, 0x151 };			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendBodySash), 0x1541, 1073346, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendFeatheredHat), 0x171A, 1073347, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSurcoat), 0x1FFD, 1073348, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendPants), 0x1539, 1073349, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendCloak), 0x1515, 1073350, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendDoublet), 0x1F7B, 1073351, 0x190, 100000.0, hues));			
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendSkirt), 0x1537, 1073352, 0x190, 100000.0, hues));
            this.Rewards.Add(new CollectionTitle(1073341, 1073859, 100000.0)); // Britain Public Library Contributor

            hues = new int[] { 0x0, 0x1C2, 0x320, 0x190, 0x1E0 };
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendLantern), 0xA25, 1073339, 0x1C2, 200000.0, hues));
            this.Rewards.Add(new CollectionHuedItem(typeof(LibraryFriendReadingChair), 0x2DEB, 1073340, 0x1C2, 200000.0, hues));			
            this.Rewards.Add(new CollectionTitle(1073342, 1073860, 200000.0)); // Distinguished Library Contributor
            this.Rewards.Add(new CollectionHuedItem(typeof(SherryTheMouseQuotes), 0xFBD, 1073300, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(WyrdBeastmasterQuotes), 0xFBD, 1073310, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(MercenaryJustinQuotes), 0xFBD, 1073317, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(HeigelOfMoonglowQuotes), 0xFBD, 1073327, 0x1C2, 350000.0, hues));	
            this.Rewards.Add(new CollectionHuedItem(typeof(TraderHoraceQuotes), 0xFBD, 1073338, 0x1C2, 350000.0, hues));				
            this.Rewards.Add(new CollectionTitle(1073343, 1073861, 350000.0)); // Honored Library Contributor			
            this.Rewards.Add(new CollectionItem(typeof(TreatiseonAlchemyTalisman), 0x2F58, 1073353, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(PrimerOnArmsTalisman), 0x2F59, 1073354, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(MyBookTalisman), 0x2F5A, 1073355, 0x0, 550000.0));			
            this.Rewards.Add(new CollectionItem(typeof(TalkingtoWispsTalisman), 0x2F5B, 1073356, 0x0, 550000.0));		
            this.Rewards.Add(new CollectionItem(typeof(GrammarOfOrchishTalisman), 0x2F59, 1073358, 0x0, 550000.0));
            this.Rewards.Add(new CollectionItem(typeof(BirdsofBritanniaTalisman), 0x2F5A, 1073359, 0x0, 550000.0));	
            this.Rewards.Add(new CollectionItem(typeof(TheLifeOfTravelingMinstrelTalisman), 0x2F5A, 1073360, 0x0, 550000.0));						
            this.Rewards.Add(new CollectionTitle(1073344, 1073862, 550000.0)); // Prominent Library Contributor
            this.Rewards.Add(new CollectionTitle(1073345, 1073863, 800000.0)); // Eminent Library Contributor</pre>

## Duplicated Code. Size: 1258

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBInnKeeper.cs

<pre>this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Ale, 7, 20, 0x99F, 0));
                this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Wine, 7, 20, 0x9C7, 0));
                this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Liquor, 7, 20, 0x99B, 0));
                this.Add(new BeverageBuyInfo(typeof(Jug), BeverageType.Cider, 13, 20, 0x9C8, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Milk, 7, 20, 0x9F0, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Ale, 11, 20, 0x1F95, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Cider, 11, 20, 0x1F97, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Liquor, 11, 20, 0x1F99, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Wine, 11, 20, 0x1F9B, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Water, 11, 20, 0x1F9D, 0));

                this.Add(new GenericBuyInfo(typeof(BreadLoaf), 6, 10, 0x103B, 0));
                this.Add(new GenericBuyInfo(typeof(CheeseWheel), 21, 10, 0x97E, 0));
                this.Add(new GenericBuyInfo(typeof(CookedBird), 17, 20, 0x9B7, 0));
                this.Add(new GenericBuyInfo(typeof(LambLeg), 8, 20, 0x160A, 0));
                this.Add(new GenericBuyInfo(typeof(ChickenLeg), 5, 20, 0x1608, 0));
                this.Add(new GenericBuyInfo(typeof(Ribs), 7, 20, 0x9F2, 0));

                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfCarrots), 3, 20, 0x15F9, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfCorn), 3, 20, 0x15FA, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfLettuce), 3, 20, 0x15FB, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfPeas), 3, 20, 0x15FC, 0));
                this.Add(new GenericBuyInfo(typeof(EmptyPewterBowl), 2, 20, 0x15FD, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfCorn), 3, 20, 0x15FE, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfLettuce), 3, 20, 0x15FF, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfPeas), 3, 20, 0x1601, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfPotatos), 3, 20, 0x1601, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfStew), 3, 20, 0x1604, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfTomatoSoup), 3, 20, 0x1606, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBTavernKeeper.cs

<pre>this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Ale, 7, 20, 0x99F, 0));
                this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Wine, 7, 20, 0x9C7, 0));
                this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Liquor, 7, 20, 0x99B, 0));
                this.Add(new BeverageBuyInfo(typeof(Jug), BeverageType.Cider, 13, 20, 0x9C8, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Milk, 7, 20, 0x9F0, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Ale, 11, 20, 0x1F95, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Cider, 11, 20, 0x1F97, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Liquor, 11, 20, 0x1F99, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Wine, 11, 20, 0x1F9B, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Water, 11, 20, 0x1F9D, 0));

                this.Add(new GenericBuyInfo(typeof(BreadLoaf), 6, 10, 0x103B, 0));
                this.Add(new GenericBuyInfo(typeof(CheeseWheel), 21, 10, 0x97E, 0));
                this.Add(new GenericBuyInfo(typeof(CookedBird), 17, 20, 0x9B7, 0));
                this.Add(new GenericBuyInfo(typeof(LambLeg), 8, 20, 0x160A, 0));
                this.Add(new GenericBuyInfo(typeof(ChickenLeg), 5, 20, 0x1608, 0));
                this.Add(new GenericBuyInfo(typeof(Ribs), 7, 20, 0x9F2, 0));

                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfCarrots), 3, 20, 0x15F9, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfCorn), 3, 20, 0x15FA, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfLettuce), 3, 20, 0x15FB, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfPeas), 3, 20, 0x15FC, 0));
                this.Add(new GenericBuyInfo(typeof(EmptyPewterBowl), 2, 20, 0x15FD, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfCorn), 3, 20, 0x15FE, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfLettuce), 3, 20, 0x15FF, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfPeas), 3, 20, 0x1601, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfPotatos), 3, 20, 0x1601, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfStew), 3, 20, 0x1604, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfTomatoSoup), 3, 20, 0x1606, 0));</pre>

## Duplicated Code. Size: 1252

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>if (from == gauntlet.Challenger && !m_gauntlet.GameLocked)
			{
				AddImageTiled(15, height - 135, 320, 20, 0xdb3);

				AddButton(130, height - 35, 0xFA8, 0xFAA, 100, GumpButtonType.Reply, 0);
				AddLabel(170, height - 35, 0, XmlPoints.GetText(from, 200528));      // "Add"

				AddButton(230, height - 35, 0xFB7, 0xFB9, 300, GumpButtonType.Reply, 0);
				AddLabel(270, height - 35, 0, XmlPoints.GetText(from, 200529));     // "Start"

				// set entry fee
				AddButton(20, height - 110, 0xFAE, 0xFAF, 10, GumpButtonType.Reply, 0);
				AddImageTiled(120, height - 110, 60, 19, textentrybackground);
				AddTextEntry(120, height - 110, 60, 25, 0, 10, m_gauntlet.EntryFee.ToString());
				AddLabel(55, height - 110, 0, XmlPoints.GetText(from, 200572));  // "Entry Fee: "

				// set arena size
				AddButton(20, height - 85, 0xFAE, 0xFAF, 20, GumpButtonType.Reply, 0);
				AddImageTiled(130, height - 85, 30, 19, textentrybackground);
				AddTextEntry(130, height - 85, 30, 25, 0, 20, m_gauntlet.ArenaSize.ToString());
				AddLabel(55, height - 85, 0, XmlPoints.GetText(from, 200573));    //  "Arena Size: "

				// set target score
				AddButton(200, height - 110, 0xFAE, 0xFAF, 30, GumpButtonType.Reply, 0);
				AddImageTiled(275, height - 110, 30, 19, textentrybackground);
				AddTextEntry(275, height - 110, 30, 25, 0, 30, m_gauntlet.TargetScore.ToString());
				AddLabel(235, height - 110, 0, XmlPoints.GetText(from, 200566));    //  "Score: "

				// set match length
				AddButton(200, height - 85, 0xFAE, 0xFAF, 40, GumpButtonType.Reply, 0);
				AddImageTiled(310, height - 85, 25, 19, textentrybackground);
				AddTextEntry(310, height - 85, 25, 25, 0, 40, m_gauntlet.MatchLength.TotalMinutes.ToString());
				AddLabel(235, height - 85, 0, XmlPoints.GetText(from, 200567));  // "Length mins: "

				// set teams
				AddButton(200, height - 60, 0xFAE, 0xFAF, 11, GumpButtonType.Reply, 0);
				AddLabel(240, height - 60, 0, XmlPoints.GetText(from, 200592));   // "Set Teams"

			}
			else
			{
				AddImageTiled(15, height - 60, 320, 20, 0xdb3);
			}

			AddButton(20, height - 35, 0xFAB, 0xFAD, 1, GumpButtonType.Reply, 0);
			AddLabel(60, height - 35, 0, XmlPoints.GetText(from, 200532));  // "Refresh"

			if (gauntlet.GameInProgress)
			{
				AddLabel(150, height - 35, 68, XmlPoints.GetText(from, 200533));  // "Game is in progress!"
			}
			else
				if (gauntlet.Winner != 0)
				{
					AddLabel(130, height - 35, 68, String.Format(XmlPoints.GetText(from, 200593), gauntlet.Winner));   // "Team {0} is the winner!"
				}

			//AddButton( 30, height - 35, 0xFB7, 0xFB9, 0, GumpButtonType.Reply, 0 );
			//AddLabel( 70, height - 35, 0, "Close" );

			// display the teams gump
			from.CloseGump(typeof(TeamsGump));
			from.SendGump(new TeamsGump(m_gauntlet, from));</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>if(from == gauntlet.Challenger && !m_gauntlet.GameLocked)
			{
			    AddImageTiled( 15, height - 135, 320, 20, 0xdb3 );

                AddButton( 130, height - 35, 0xFA8, 0xFAA, 100, GumpButtonType.Reply, 0 );
                AddLabel( 170, height - 35, 0, XmlPoints.GetText(from, 200528) );      // "Add"

                AddButton( 230, height - 35, 0xFB7, 0xFB9, 300, GumpButtonType.Reply, 0 );
                AddLabel( 270, height - 35, 0, XmlPoints.GetText(from, 200529) );     // "Start"

                // set entry fee
                AddButton( 20, height - 110, 0xFAE, 0xFAF, 10, GumpButtonType.Reply, 0 );
                AddImageTiled(120, height - 110, 60, 19, textentrybackground );
                AddTextEntry( 120, height - 110, 60, 25, 0, 10 ,m_gauntlet.EntryFee.ToString() );
                AddLabel( 55, height - 110, 0, XmlPoints.GetText(from, 200572) );  // "Entry Fee: "

                // set arena size
                AddButton( 20, height - 85, 0xFAE, 0xFAF, 20, GumpButtonType.Reply, 0 );
                AddImageTiled(130, height - 85, 30, 19, textentrybackground );
                AddTextEntry( 130, height - 85, 30, 25, 0, 20 ,m_gauntlet.ArenaSize.ToString() );
                AddLabel( 55, height - 85, 0, XmlPoints.GetText(from, 200573) );    //  "Arena Size: "

                // set target score
                AddButton( 200, height - 110, 0xFAE, 0xFAF, 30, GumpButtonType.Reply, 0 );
                AddImageTiled( 275, height - 110, 30, 19, textentrybackground );
                AddTextEntry( 275, height - 110, 30, 25, 0, 30 ,m_gauntlet.TargetScore.ToString() );
                AddLabel( 235, height - 110, 0, XmlPoints.GetText(from, 200566) );    //  "Score: "

                // set match length
                AddButton( 200, height - 85, 0xFAE, 0xFAF, 40, GumpButtonType.Reply, 0 );
                AddImageTiled( 310, height - 85, 25, 19, textentrybackground );
                AddTextEntry( 310, height - 85, 25, 25, 0, 40 ,m_gauntlet.MatchLength.TotalMinutes.ToString() );
                AddLabel( 235, height - 85, 0,  XmlPoints.GetText(from, 200567) );  // "Length mins: "

                // set teams
                AddButton( 200, height - 60, 0xFAE, 0xFAF, 11, GumpButtonType.Reply, 0 );
                AddLabel( 240, height - 60, 0, XmlPoints.GetText(from, 200592));   // "Set Teams"

			} else
			{
                AddImageTiled( 15, height - 60, 320, 20, 0xdb3 );
			}

			AddButton( 20, height - 35, 0xFAB, 0xFAD, 1, GumpButtonType.Reply, 0 );
            AddLabel( 60, height - 35, 0, XmlPoints.GetText(from, 200532) );  // "Refresh"

            if(gauntlet.GameInProgress)
            {
                AddLabel( 150, height - 35, 68, XmlPoints.GetText(from, 200533));  // "Game is in progress!"
            } else
            if(gauntlet.Winner != 0)
            {
                AddLabel( 130, height - 35, 68, String.Format(XmlPoints.GetText(from, 200593), gauntlet.Winner) );   // "Team {0} is the winner!"
            }

			//AddButton( 30, height - 35, 0xFB7, 0xFB9, 0, GumpButtonType.Reply, 0 );
			//AddLabel( 70, height - 35, 0, "Close" );

			// display the teams gump
            from.CloseGump(typeof(TeamsGump));
			from.SendGump(new TeamsGump(m_gauntlet, from) );</pre>

## Duplicated Code. Size: 1194

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>this.AddImageTiled(32, 88, 264, 1, 9107);
            this.AddImageTiled(42, 90, 264, 1, 9157);

            #region Rules
            int y = 100;

            string groupText = null;

            switch ( tourny.GroupType )
            {
                case GroupingType.HighVsLow:
                    groupText = "High vs Low";
                    break;
                case GroupingType.Nearest:
                    groupText = "Closest opponent";
                    break;
                case GroupingType.Random:
                    groupText = "Random";
                    break;
            }

            this.AddBorderedText(35, y, 190, 20, String.Format("Grouping: {0}", groupText), LabelColor32, BlackColor32);
            y += 20;

            string tieText = null;

            switch ( tourny.TieType )
            {
                case TieType.Random:
                    tieText = "Random";
                    break;
                case TieType.Highest:
                    tieText = "Highest advances";
                    break;
                case TieType.Lowest:
                    tieText = "Lowest advances";
                    break;
                case TieType.FullAdvancement:
                    tieText = (tourny.ParticipantsPerMatch == 2 ? "Both advance" : "Everyone advances");
                    break;
                case TieType.FullElimination:
                    tieText = (tourny.ParticipantsPerMatch == 2 ? "Both eliminated" : "Everyone eliminated");
                    break;
            }

            this.AddBorderedText(35, y, 190, 20, String.Format("Tiebreaker: {0}", tieText), LabelColor32, BlackColor32);
            y += 20;

            string sdText = "Off";

            if (tourny.SuddenDeath > TimeSpan.Zero)
            {
                sdText = String.Format("{0}:{1:D2}", (int)tourny.SuddenDeath.TotalMinutes, tourny.SuddenDeath.Seconds);

                if (tourny.SuddenDeathRounds > 0)
                    sdText = String.Format("{0} (first {1} rounds)", sdText, tourny.SuddenDeathRounds);
                else
                    sdText = String.Format("{0} (all rounds)", sdText);
            }

            this.AddBorderedText(35, y, 240, 20, String.Format("Sudden Death: {0}", sdText), LabelColor32, BlackColor32);
            y += 20;

            y += 6;
            this.AddImageTiled(32, y - 1, 264, 1, 9107);
            this.AddImageTiled(42, y + 1, 264, 1, 9157);
            y += 6;

            this.AddBorderedText(35, y, 190, 20, String.Format("Ruleset: {0}", basedef.Title), LabelColor32, BlackColor32);
            y += 20;

            for (int i = 0; i < ruleset.Flavors.Count; ++i, y += 18)
                this.AddBorderedText(35, y, 190, 20, String.Format(" + {0}", ((Ruleset)ruleset.Flavors[i]).Title), LabelColor32, BlackColor32);

            y += 4;

            if (changes > 0)
            {
                this.AddBorderedText(35, y, 190, 20, "Modifications:", LabelColor32, BlackColor32);
                y += 20;

                for (int i = 0; i < opts.Length; ++i)
                {
                    if (defs[i] != opts[i])
                    {
                        string name = ruleset.Layout.FindByIndex(i);

                        if (name != null) // sanity
                        {
                            this.AddImage(35, y, opts[i] ? 0xD3 : 0xD2);
                            this.AddBorderedText(60, y, 165, 22, name, LabelColor32, BlackColor32);
                        }

                        y += 22;
                    }
                }
            }
            else
            {
                this.AddBorderedText(35, y, 190, 20, "Modifications: None", LabelColor32, BlackColor32);
                y += 20;
            }</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>this.AddImageTiled(32, 88, 264, 1, 9107);
            this.AddImageTiled(42, 90, 264, 1, 9157);

            #region Rules
            int y = 100;

            string groupText = null;

            switch ( tourny.GroupType )
            {
                case GroupingType.HighVsLow:
                    groupText = "High vs Low";
                    break;
                case GroupingType.Nearest:
                    groupText = "Closest opponent";
                    break;
                case GroupingType.Random:
                    groupText = "Random";
                    break;
            }

            this.AddBorderedText(35, y, 190, 20, String.Format("Grouping: {0}", groupText), LabelColor32, BlackColor32);
            y += 20;

            string tieText = null;

            switch ( tourny.TieType )
            {
                case TieType.Random:
                    tieText = "Random";
                    break;
                case TieType.Highest:
                    tieText = "Highest advances";
                    break;
                case TieType.Lowest:
                    tieText = "Lowest advances";
                    break;
                case TieType.FullAdvancement:
                    tieText = (tourny.ParticipantsPerMatch == 2 ? "Both advance" : "Everyone advances");
                    break;
                case TieType.FullElimination:
                    tieText = (tourny.ParticipantsPerMatch == 2 ? "Both eliminated" : "Everyone eliminated");
                    break;
            }

            this.AddBorderedText(35, y, 190, 20, String.Format("Tiebreaker: {0}", tieText), LabelColor32, BlackColor32);
            y += 20;

            string sdText = "Off";

            if (tourny.SuddenDeath > TimeSpan.Zero)
            {
                sdText = String.Format("{0}:{1:D2}", (int)tourny.SuddenDeath.TotalMinutes, tourny.SuddenDeath.Seconds);

                if (tourny.SuddenDeathRounds > 0)
                    sdText = String.Format("{0} (first {1} rounds)", sdText, tourny.SuddenDeathRounds);
                else
                    sdText = String.Format("{0} (all rounds)", sdText);
            }

            this.AddBorderedText(35, y, 240, 20, String.Format("Sudden Death: {0}", sdText), LabelColor32, BlackColor32);
            y += 20;

            y += 6;
            this.AddImageTiled(32, y - 1, 264, 1, 9107);
            this.AddImageTiled(42, y + 1, 264, 1, 9157);
            y += 6;

            this.AddBorderedText(35, y, 190, 20, String.Format("Ruleset: {0}", basedef.Title), LabelColor32, BlackColor32);
            y += 20;

            for (int i = 0; i < ruleset.Flavors.Count; ++i, y += 18)
                this.AddBorderedText(35, y, 190, 20, String.Format(" + {0}", ((Ruleset)ruleset.Flavors[i]).Title), LabelColor32, BlackColor32);

            y += 4;

            if (changes > 0)
            {
                this.AddBorderedText(35, y, 190, 20, "Modifications:", LabelColor32, BlackColor32);
                y += 20;

                for (int i = 0; i < opts.Length; ++i)
                {
                    if (defs[i] != opts[i])
                    {
                        string name = ruleset.Layout.FindByIndex(i);

                        if (name != null) // sanity
                        {
                            this.AddImage(35, y, opts[i] ? 0xD3 : 0xD2);
                            this.AddBorderedText(60, y, 165, 22, name, LabelColor32, BlackColor32);
                        }

                        y += 22;
                    }
                }
            }
            else
            {
                this.AddBorderedText(35, y, 190, 20, "Modifications: None", LabelColor32, BlackColor32);
                y += 20;
            }</pre>

## Duplicated Code. Size: 1185

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBlacksmith.cs

<pre>this.Add(typeof(BattleAxe), 13);
                this.Add(typeof(DoubleAxe), 26);
                this.Add(typeof(ExecutionersAxe), 15);
                this.Add(typeof(LargeBattleAxe), 16);
                this.Add(typeof(Pickaxe), 11);
                this.Add(typeof(TwoHandedAxe), 16);
                this.Add(typeof(WarAxe), 14);
                this.Add(typeof(Axe), 20);

                this.Add(typeof(Bardiche), 30);
                this.Add(typeof(Halberd), 21);

                this.Add(typeof(ButcherKnife), 7);
                this.Add(typeof(Cleaver), 7);
                this.Add(typeof(Dagger), 10);
                this.Add(typeof(SkinningKnife), 7);

                this.Add(typeof(Club), 8);
                this.Add(typeof(HammerPick), 13);
                this.Add(typeof(Mace), 14);
                this.Add(typeof(Maul), 10);
                this.Add(typeof(WarHammer), 12);
                this.Add(typeof(WarMace), 15);

                this.Add(typeof(HeavyCrossbow), 27);
                this.Add(typeof(Bow), 17);
                this.Add(typeof(Crossbow), 23); 

                if (Core.AOS)
                {
                    this.Add(typeof(CompositeBow), 25);
                    this.Add(typeof(RepeatingCrossbow), 28);
                    this.Add(typeof(Scepter), 20);
                    this.Add(typeof(BladedStaff), 20);
                    this.Add(typeof(Scythe), 19);
                    this.Add(typeof(BoneHarvester), 17);
                    this.Add(typeof(Scepter), 18);
                    this.Add(typeof(BladedStaff), 16);
                    this.Add(typeof(Pike), 19);
                    this.Add(typeof(DoubleBladedStaff), 17);
                    this.Add(typeof(Lance), 17);
                    this.Add(typeof(CrescentBlade), 18);
                }

                this.Add(typeof(Spear), 15);
                this.Add(typeof(Pitchfork), 9);
                this.Add(typeof(ShortSpear), 11);

                this.Add(typeof(BlackStaff), 11);
                this.Add(typeof(GnarledStaff), 8);
                this.Add(typeof(QuarterStaff), 9);
                this.Add(typeof(ShepherdsCrook), 10);

                this.Add(typeof(SmithHammer), 10);

                this.Add(typeof(Broadsword), 17);
                this.Add(typeof(Cutlass), 12);
                this.Add(typeof(Katana), 16);
                this.Add(typeof(Kryss), 16);
                this.Add(typeof(Longsword), 27);
                this.Add(typeof(Scimitar), 18);
                this.Add(typeof(ThinLongsword), 13);
                this.Add(typeof(VikingSword), 27);</pre>

Fragment 2 in file Scripts\VendorInfo\SBWeaponSmith.cs

<pre>this.Add(typeof(BattleAxe), 13);
                this.Add(typeof(DoubleAxe), 26);
                this.Add(typeof(ExecutionersAxe), 15);
                this.Add(typeof(LargeBattleAxe), 16);
                this.Add(typeof(Pickaxe), 11);
                this.Add(typeof(TwoHandedAxe), 16);
                this.Add(typeof(WarAxe), 14);
                this.Add(typeof(Axe), 20);

                this.Add(typeof(Bardiche), 30);
                this.Add(typeof(Halberd), 21);

                this.Add(typeof(ButcherKnife), 7);
                this.Add(typeof(Cleaver), 7);
                this.Add(typeof(Dagger), 10);
                this.Add(typeof(SkinningKnife), 7);

                this.Add(typeof(Club), 8);
                this.Add(typeof(HammerPick), 13);
                this.Add(typeof(Mace), 14);
                this.Add(typeof(Maul), 10);
                this.Add(typeof(WarHammer), 12);
                this.Add(typeof(WarMace), 15);

                this.Add(typeof(HeavyCrossbow), 27);
                this.Add(typeof(Bow), 17);
                this.Add(typeof(Crossbow), 23); 

                if (Core.AOS)
                {
                    this.Add(typeof(CompositeBow), 25);
                    this.Add(typeof(RepeatingCrossbow), 28);
                    this.Add(typeof(Scepter), 20);
                    this.Add(typeof(BladedStaff), 20);
                    this.Add(typeof(Scythe), 19);
                    this.Add(typeof(BoneHarvester), 17);
                    this.Add(typeof(Scepter), 18);
                    this.Add(typeof(BladedStaff), 16);
                    this.Add(typeof(Pike), 19);
                    this.Add(typeof(DoubleBladedStaff), 17);
                    this.Add(typeof(Lance), 17);
                    this.Add(typeof(CrescentBlade), 18);
                }

                this.Add(typeof(Spear), 15);
                this.Add(typeof(Pitchfork), 9);
                this.Add(typeof(ShortSpear), 11);

                this.Add(typeof(BlackStaff), 11);
                this.Add(typeof(GnarledStaff), 8);
                this.Add(typeof(QuarterStaff), 9);
                this.Add(typeof(ShepherdsCrook), 10);

                this.Add(typeof(SmithHammer), 10);

                this.Add(typeof(Broadsword), 17);
                this.Add(typeof(Cutlass), 12);
                this.Add(typeof(Katana), 16);
                this.Add(typeof(Kryss), 16);
                this.Add(typeof(Longsword), 27);
                this.Add(typeof(Scimitar), 18);
                this.Add(typeof(ThinLongsword), 13);
                this.Add(typeof(VikingSword), 27);</pre>

## Duplicated Code. Size: 1170

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBarkeeper.cs

<pre>this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Ale, 7, 20, 0x99F, 0));
                this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Wine, 7, 20, 0x9C7, 0));
                this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Liquor, 7, 20, 0x99B, 0));
                this.Add(new BeverageBuyInfo(typeof(Jug), BeverageType.Cider, 13, 20, 0x9C8, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Milk, 7, 20, 0x9F0, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Ale, 11, 20, 0x1F95, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Cider, 11, 20, 0x1F97, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Liquor, 11, 20, 0x1F99, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Wine, 11, 20, 0x1F9B, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Water, 11, 20, 0x1F9D, 0));

                this.Add(new GenericBuyInfo(typeof(BreadLoaf), 6, 10, 0x103B, 0));
                this.Add(new GenericBuyInfo(typeof(CheeseWheel), 21, 10, 0x97E, 0));
                this.Add(new GenericBuyInfo(typeof(CookedBird), 17, 20, 0x9B7, 0));
                this.Add(new GenericBuyInfo(typeof(LambLeg), 8, 20, 0x160A, 0));

                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfCarrots), 3, 20, 0x15F9, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfCorn), 3, 20, 0x15FA, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfLettuce), 3, 20, 0x15FB, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfPeas), 3, 20, 0x15FC, 0));
                this.Add(new GenericBuyInfo(typeof(EmptyPewterBowl), 2, 20, 0x15FD, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfCorn), 3, 20, 0x15FE, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfLettuce), 3, 20, 0x15FF, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfPeas), 3, 20, 0x1601, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfPotatos), 3, 20, 0x1601, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfStew), 3, 20, 0x1604, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfTomatoSoup), 3, 20, 0x1606, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBWaiter.cs

<pre>this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Ale, 7, 20, 0x99F, 0));
                this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Wine, 7, 20, 0x9C7, 0));
                this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Liquor, 7, 20, 0x99B, 0));
                this.Add(new BeverageBuyInfo(typeof(Jug), BeverageType.Cider, 13, 20, 0x9C8, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Milk, 7, 20, 0x9F0, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Ale, 11, 20, 0x1F95, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Cider, 11, 20, 0x1F97, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Liquor, 11, 20, 0x1F99, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Wine, 11, 20, 0x1F9B, 0));
                this.Add(new BeverageBuyInfo(typeof(Pitcher), BeverageType.Water, 11, 20, 0x1F9D, 0));

                this.Add(new GenericBuyInfo(typeof(BreadLoaf), 6, 10, 0x103B, 0));
                this.Add(new GenericBuyInfo(typeof(CheeseWheel), 21, 10, 0x97E, 0));
                this.Add(new GenericBuyInfo(typeof(CookedBird), 17, 20, 0x9B7, 0));
                this.Add(new GenericBuyInfo(typeof(LambLeg), 8, 20, 0x160A, 0));

                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfCarrots), 3, 20, 0x15F9, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfCorn), 3, 20, 0x15FA, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfLettuce), 3, 20, 0x15FB, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfPeas), 3, 20, 0x15FC, 0));
                this.Add(new GenericBuyInfo(typeof(EmptyPewterBowl), 2, 20, 0x15FD, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfCorn), 3, 20, 0x15FE, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfLettuce), 3, 20, 0x15FF, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfPeas), 3, 20, 0x1601, 0));
                this.Add(new GenericBuyInfo(typeof(PewterBowlOfPotatos), 3, 20, 0x1601, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfStew), 3, 20, 0x1604, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenBowlOfTomatoSoup), 3, 20, 0x1606, 0));</pre>

## Duplicated Code. Size: 1140

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>if (entry == null) continue;

					// display the entry with a color indicating whether they have accepted or not
					Mobile m = entry.Participant;

					string statusmsg = XmlPoints.GetText(from, 200509);   // "Waiting"
					int texthue = 0;

					// this section is available during game setup
					if (!m_gauntlet.GameLocked)
					{
						statusmsg = XmlPoints.GetText(from, 200509);  // "Waiting"
						if (entry.Accepted)
						{
							texthue = 68;
							statusmsg = XmlPoints.GetText(from, 200510);    // "Accepted"
						}

						// check to see if they have the Entry fee
						if (!m_gauntlet.HasEntryFee(m))
						{
							texthue = 33;
							statusmsg = XmlPoints.GetText(from, 200511);   // "Insufficient funds"
						}

						// if the game is still open then enable these buttons

						// if this is the participant then add the accept button to the entry
						if (m == from)
						{
							AddButton(15, yoffset, entry.Accepted ? 0xd1 : 0xd0, entry.Accepted ? 0xd0 : 0xd1, 1000 + i, GumpButtonType.Reply, 0);
						}
						// if this is the organizer then add the kick button and the team assignment to each entry
						if (from == m_gauntlet.Challenger)
						{
							AddImageTiled(223, yoffset, 20, 19, textentrybackground);
							AddTextEntry(225, yoffset, 20, 19, 0, 500 + i, entry.Team.ToString());
						}
						if (from == m_gauntlet.Challenger || from == entry.Participant)
						{
							AddButton(190, yoffset, 0xFB1, 0xFB3, 2000 + i, GumpButtonType.Reply, 0);

						}
					}
					else
					{

						// this section is active after the game has started

						// enable the forfeit button
						if (m == from && entry.Status == ChallengeStatus.Active && !m_gauntlet.GameCompleted)
						{
							AddButton(190, yoffset, 0xFB1, 0xFB3, 4000 + i, GumpButtonType.Reply, 0);
						}

						if (entry.Status == ChallengeStatus.Forfeit)
						{
							texthue = 33;
							statusmsg = XmlPoints.GetText(from, 200520);  // "Forfeit"
						}
						else
							if (entry.Caution == ChallengeStatus.Hidden && entry.Status == ChallengeStatus.Active)
							{
								texthue = 53;
								statusmsg = XmlPoints.GetText(from, 200521);   // "Hidden"
							}
							else
								if (entry.Caution == ChallengeStatus.OutOfBounds && entry.Status == ChallengeStatus.Active)
								{
									texthue = 53;
									statusmsg = XmlPoints.GetText(from, 200522);  // "Out of Bounds"
								}
								else
									if (entry.Caution == ChallengeStatus.Offline && entry.Status == ChallengeStatus.Active)
									{
										texthue = 53;
										statusmsg = XmlPoints.GetText(from, 200523);    // "Offline"
									}
									else
										if (entry.Status == ChallengeStatus.Active)
										{

											texthue = 68;
											if (entry.Winner)
												statusmsg = XmlPoints.GetText(from, 200524);      // "Winner"
											else
												statusmsg = XmlPoints.GetText(from, 200525);      // "Active"
										}
										else
											if (entry.Status == ChallengeStatus.Dead)
											{
												texthue = 33;
												statusmsg = XmlPoints.GetText(from, 200526);            // "Dead"
											}
											else
												if (entry.Status == ChallengeStatus.Disqualified)
												{
													texthue = 33;
													statusmsg = XmlPoints.GetText(from, 200527);     // "Disqualified"
												}

					}

					if (m != null)
					{
						int teamhue = 0;
						if (entry.Team > 0)
						{
							teamhue = BaseChallengeGame.TeamColor(entry.Team);
						}
						AddLabel(40, yoffset, teamhue, m.Name);
						AddLabel(165, yoffset, teamhue, entry.Team.ToString());
						AddLabel(255, yoffset, texthue, statusmsg);

						if (m_gauntlet.GameInProgress || m_gauntlet.GameCompleted)
						{
							AddLabel(13, yoffset, 0, entry.Score.ToString());
						}
					}

					yoffset += y_inc;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>if(entry == null) continue;

                    // display the entry with a color indicating whether they have accepted or not
                    Mobile m = entry.Participant;

                    string statusmsg = XmlPoints.GetText(from, 200509);   // "Waiting"
                    int texthue = 0;

                    // this section is available during game setup
                    if(!m_gauntlet.GameLocked)
                    {
                        statusmsg = XmlPoints.GetText(from, 200509);  // "Waiting"
                        if(entry.Accepted)
                        {
                            texthue = 68;
                            statusmsg = XmlPoints.GetText(from, 200510);    // "Accepted"
                        }

                        // check to see if they have the Entry fee
                        if(!m_gauntlet.HasEntryFee(m))
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200511);   // "Insufficient funds"
                        }

                    // if the game is still open then enable these buttons

                        // if this is the participant then add the accept button to the entry
                        if(m == from)
                        {
                            AddButton( 15, yoffset, entry.Accepted ? 0xd1 : 0xd0, entry.Accepted ? 0xd0 : 0xd1,  1000+i, GumpButtonType.Reply, 0 );
                        }
                        // if this is the organizer then add the kick button and the team assignment to each entry
                        if(from == m_gauntlet.Challenger)
                        {
                            AddImageTiled( 223, yoffset, 20, 19, textentrybackground );
                            AddTextEntry( 225, yoffset, 20, 19, 0, 500+i, entry.Team.ToString());
                        }
                        if(from == m_gauntlet.Challenger || from == entry.Participant)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  2000+i, GumpButtonType.Reply, 0 );

                        }
                    } else
                    {

                        // this section is active after the game has started

                        // enable the forfeit button
                        if(m == from && entry.Status == ChallengeStatus.Active && !m_gauntlet.GameCompleted)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  4000+i, GumpButtonType.Reply, 0 );
                        }

                        if(entry.Status == ChallengeStatus.Forfeit)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200520);  // "Forfeit"
                        } else
                        if(entry.Caution == ChallengeStatus.Hidden && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200521);   // "Hidden"
                        } else
                        if(entry.Caution == ChallengeStatus.OutOfBounds && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200522);  // "Out of Bounds"
                        } else
                        if(entry.Caution == ChallengeStatus.Offline && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200523);    // "Offline"
                        } else
                        if(entry.Status == ChallengeStatus.Active)
                        {

                            texthue = 68;
                            if(entry.Winner)
                                statusmsg = XmlPoints.GetText(from, 200524);      // "Winner"
                            else
                                statusmsg = XmlPoints.GetText(from, 200525);      // "Active"
                        } else
                        if(entry.Status == ChallengeStatus.Dead)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200526);            // "Dead"
                        } else
                        if(entry.Status == ChallengeStatus.Disqualified)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200527);     // "Disqualified"
                        }

                    }

                    if(m != null)
                    {
                        int teamhue = 0;
                        if(entry.Team > 0)
                        {
                            teamhue = BaseChallengeGame.TeamColor(entry.Team);
                        }
                        AddLabel( 40, yoffset, teamhue, m.Name);
                        AddLabel( 165, yoffset, teamhue, entry.Team.ToString());
                        AddLabel( 255, yoffset, texthue, statusmsg);

                        if(m_gauntlet.GameInProgress || m_gauntlet.GameCompleted )
                        {
                            AddLabel( 13, yoffset, 0, entry.Score.ToString());
                        }
                    }

                    yoffset += y_inc;</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>if(entry == null) continue;

                    // display the entry with a color indicating whether they have accepted or not
                    Mobile m = entry.Participant;

                    string statusmsg = XmlPoints.GetText(from, 200509);   // "Waiting"
                    int texthue = 0;

                    // this section is available during game setup
                    if(!m_gauntlet.GameLocked)
                    {
                        statusmsg = XmlPoints.GetText(from, 200509);  // "Waiting"
                        if(entry.Accepted)
                        {
                            texthue = 68;
                            statusmsg = XmlPoints.GetText(from, 200510);    // "Accepted"
                        }

                        // check to see if they have the Entry fee
                        if(!m_gauntlet.HasEntryFee(m))
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200511);   // "Insufficient funds"
                        }

                    // if the game is still open then enable these buttons

                        // if this is the participant then add the accept button to the entry
                        if(m == from)
                        {
                            AddButton( 15, yoffset, entry.Accepted ? 0xd1 : 0xd0, entry.Accepted ? 0xd0 : 0xd1,  1000+i, GumpButtonType.Reply, 0 );
                        }
                        // if this is the organizer then add the kick button and the team assignment to each entry
                        if(from == m_gauntlet.Challenger)
                        {
                            AddImageTiled( 223, yoffset, 20, 19, textentrybackground );
                            AddTextEntry( 225, yoffset, 20, 19, 0, 500+i, entry.Team.ToString());
                        }
                        if(from == m_gauntlet.Challenger || from == entry.Participant)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  2000+i, GumpButtonType.Reply, 0 );

                        }
                    } else
                    {

                        // this section is active after the game has started

                        // enable the forfeit button
                        if(m == from && entry.Status == ChallengeStatus.Active && !m_gauntlet.GameCompleted)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  4000+i, GumpButtonType.Reply, 0 );
                        }

                        if(entry.Status == ChallengeStatus.Forfeit)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200520);  // "Forfeit"
                        } else
                        if(entry.Caution == ChallengeStatus.Hidden && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200521);   // "Hidden"
                        } else
                        if(entry.Caution == ChallengeStatus.OutOfBounds && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200522);  // "Out of Bounds"
                        } else
                        if(entry.Caution == ChallengeStatus.Offline && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200523);    // "Offline"
                        } else
                        if(entry.Status == ChallengeStatus.Active)
                        {

                            texthue = 68;
                            if(entry.Winner)
                                statusmsg = XmlPoints.GetText(from, 200524);      // "Winner"
                            else
                                statusmsg = XmlPoints.GetText(from, 200525);      // "Active"
                        } else
                        if(entry.Status == ChallengeStatus.Dead)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200526);            // "Dead"
                        } else
                        if(entry.Status == ChallengeStatus.Disqualified)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200527);     // "Disqualified"
                        }

                    }

                    if(m != null)
                    {
                        int teamhue = 0;
                        if(entry.Team > 0)
                        {
                            teamhue = BaseChallengeGame.TeamColor(entry.Team);
                        }
                        AddLabel( 40, yoffset, teamhue, m.Name);
                        AddLabel( 165, yoffset, teamhue, entry.Team.ToString());
                        AddLabel( 255, yoffset, texthue, statusmsg);

                        if(m_gauntlet.GameInProgress || m_gauntlet.GameCompleted )
                        {
                            AddLabel( 13, yoffset, 0, entry.Score.ToString());
                        }
                    }

                    yoffset += y_inc;</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>if(entry == null) continue;

                    // display the entry with a color indicating whether they have accepted or not
                    Mobile m = entry.Participant;

                    string statusmsg = XmlPoints.GetText(from, 200509);   // "Waiting"
                    int texthue = 0;

                    // this section is available during game setup
                    if(!m_gauntlet.GameLocked)
                    {
                        statusmsg = XmlPoints.GetText(from, 200509);  // "Waiting"
                        if(entry.Accepted)
                        {
                            texthue = 68;
                            statusmsg = XmlPoints.GetText(from, 200510);    // "Accepted"
                        }

                        // check to see if they have the Entry fee
                        if(!m_gauntlet.HasEntryFee(m))
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200511);   // "Insufficient funds"
                        }

                    // if the game is still open then enable these buttons

                        // if this is the participant then add the accept button to the entry
                        if(m == from)
                        {
                            AddButton( 15, yoffset, entry.Accepted ? 0xd1 : 0xd0, entry.Accepted ? 0xd0 : 0xd1,  1000+i, GumpButtonType.Reply, 0 );
                        }
                        // if this is the organizer then add the kick button and the team assignment to each entry
                        if(from == m_gauntlet.Challenger)
                        {
                            AddImageTiled( 223, yoffset, 20, 19, textentrybackground );
                            AddTextEntry( 225, yoffset, 20, 19, 0, 500+i, entry.Team.ToString());
                        }
                        if(from == m_gauntlet.Challenger || from == entry.Participant)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  2000+i, GumpButtonType.Reply, 0 );

                        }
                    } else
                    {

                        // this section is active after the game has started

                        // enable the forfeit button
                        if(m == from && entry.Status == ChallengeStatus.Active && !m_gauntlet.GameCompleted)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  4000+i, GumpButtonType.Reply, 0 );
                        }

                        if(entry.Status == ChallengeStatus.Forfeit)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200520);  // "Forfeit"
                        } else
                        if(entry.Caution == ChallengeStatus.Hidden && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200521);   // "Hidden"
                        } else
                        if(entry.Caution == ChallengeStatus.OutOfBounds && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200522);  // "Out of Bounds"
                        } else
                        if(entry.Caution == ChallengeStatus.Offline && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200523);    // "Offline"
                        } else
                        if(entry.Status == ChallengeStatus.Active)
                        {

                            texthue = 68;
                            if(entry.Winner)
                                statusmsg = XmlPoints.GetText(from, 200524);      // "Winner"
                            else
                                statusmsg = XmlPoints.GetText(from, 200525);      // "Active"
                        } else
                        if(entry.Status == ChallengeStatus.Dead)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200526);            // "Dead"
                        } else
                        if(entry.Status == ChallengeStatus.Disqualified)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200527);     // "Disqualified"
                        }

                    }

                    if(m != null)
                    {
                        int teamhue = 0;
                        if(entry.Team > 0)
                        {
                            teamhue = BaseChallengeGame.TeamColor(entry.Team);
                        }
                        AddLabel( 40, yoffset, teamhue, m.Name);
                        AddLabel( 165, yoffset, teamhue, entry.Team.ToString());
                        AddLabel( 255, yoffset, texthue, statusmsg);

                        if(m_gauntlet.GameInProgress || m_gauntlet.GameCompleted )
                        {
                            AddLabel( 13, yoffset, 0, entry.Score.ToString());
                        }
                    }

                    yoffset += y_inc;</pre>

## Duplicated Code. Size: 1137

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>if ((prop = this.m_AosAttributes.WeaponDamage) != 0)
                list.Add(1060401, prop.ToString()); // damage increase ~1_val~%

            if ((prop = this.m_AosAttributes.DefendChance) != 0)
                list.Add(1060408, prop.ToString()); // defense chance increase ~1_val~%

            if ((prop = this.m_AosAttributes.BonusDex) != 0)
                list.Add(1060409, prop.ToString()); // dexterity bonus ~1_val~

            if ((prop = this.m_AosAttributes.EnhancePotions) != 0)
                list.Add(1060411, prop.ToString()); // enhance potions ~1_val~%

            if ((prop = this.m_AosAttributes.CastRecovery) != 0)
                list.Add(1060412, prop.ToString()); // faster cast recovery ~1_val~

            if ((prop = this.m_AosAttributes.CastSpeed) != 0)
                list.Add(1060413, prop.ToString()); // faster casting ~1_val~

            if ((prop = this.m_AosAttributes.AttackChance) != 0)
                list.Add(1060415, prop.ToString()); // hit chance increase ~1_val~%

            if ((prop = this.m_AosAttributes.BonusHits) != 0)
                list.Add(1060431, prop.ToString()); // hit point increase ~1_val~

            if ((prop = this.m_AosAttributes.BonusInt) != 0)
                list.Add(1060432, prop.ToString()); // intelligence bonus ~1_val~

            if ((prop = this.m_AosAttributes.LowerManaCost) != 0)
                list.Add(1060433, prop.ToString()); // lower mana cost ~1_val~%

            if ((prop = this.m_AosAttributes.LowerRegCost) != 0)
                list.Add(1060434, prop.ToString()); // lower reagent cost ~1_val~%

            if ((prop = this.m_AosAttributes.Luck) != 0)
                list.Add(1060436, prop.ToString()); // luck ~1_val~

            if ((prop = this.m_AosAttributes.BonusMana) != 0)
                list.Add(1060439, prop.ToString()); // mana increase ~1_val~

            if ((prop = this.m_AosAttributes.RegenMana) != 0)
                list.Add(1060440, prop.ToString()); // mana regeneration ~1_val~

            if ((prop = this.m_AosAttributes.NightSight) != 0)
                list.Add(1060441); // night sight

            if ((prop = this.m_AosAttributes.ReflectPhysical) != 0)
                list.Add(1060442, prop.ToString()); // reflect physical damage ~1_val~%

            if ((prop = this.m_AosAttributes.RegenStam) != 0)
                list.Add(1060443, prop.ToString()); // stamina regeneration ~1_val~

            if ((prop = this.m_AosAttributes.RegenHits) != 0)
                list.Add(1060444, prop.ToString()); // hit point regeneration ~1_val~

            if ((prop = this.m_AosAttributes.SpellChanneling) != 0)
                list.Add(1060482); // spell channeling

            if ((prop = this.m_AosAttributes.SpellDamage) != 0)
                list.Add(1060483, prop.ToString()); // spell damage increase ~1_val~%

            if ((prop = this.m_AosAttributes.BonusStam) != 0)
                list.Add(1060484, prop.ToString()); // stamina increase ~1_val~

            if ((prop = this.m_AosAttributes.BonusStr) != 0)
                list.Add(1060485, prop.ToString()); // strength bonus ~1_val~

            if ((prop = this.m_AosAttributes.WeaponSpeed) != 0)
                list.Add(1060486, prop.ToString()); // swing speed increase ~1_val~%

            if (Core.ML && (prop = this.m_AosAttributes.IncreasedKarmaLoss) != 0)
                list.Add(1075210, prop.ToString()); // Increased Karma Loss ~1val~%</pre>

Fragment 2 in file Scripts\Items\Equipment\Talismans\BaseTalisman.cs

<pre>if ((prop = this.m_AosAttributes.WeaponDamage) != 0)
                list.Add(1060401, prop.ToString()); // damage increase ~1_val~%

            if ((prop = this.m_AosAttributes.DefendChance) != 0)
                list.Add(1060408, prop.ToString()); // defense chance increase ~1_val~%

            if ((prop = this.m_AosAttributes.BonusDex) != 0)
                list.Add(1060409, prop.ToString()); // dexterity bonus ~1_val~

            if ((prop = this.m_AosAttributes.EnhancePotions) != 0)
                list.Add(1060411, prop.ToString()); // enhance potions ~1_val~%

            if ((prop = this.m_AosAttributes.CastRecovery) != 0)
                list.Add(1060412, prop.ToString()); // faster cast recovery ~1_val~

            if ((prop = this.m_AosAttributes.CastSpeed) != 0)
                list.Add(1060413, prop.ToString()); // faster casting ~1_val~

            if ((prop = this.m_AosAttributes.AttackChance) != 0)
                list.Add(1060415, prop.ToString()); // hit chance increase ~1_val~%

            if ((prop = this.m_AosAttributes.BonusHits) != 0)
                list.Add(1060431, prop.ToString()); // hit point increase ~1_val~

            if ((prop = this.m_AosAttributes.BonusInt) != 0)
                list.Add(1060432, prop.ToString()); // intelligence bonus ~1_val~

            if ((prop = this.m_AosAttributes.LowerManaCost) != 0)
                list.Add(1060433, prop.ToString()); // lower mana cost ~1_val~%

            if ((prop = this.m_AosAttributes.LowerRegCost) != 0)
                list.Add(1060434, prop.ToString()); // lower reagent cost ~1_val~%

            if ((prop = this.m_AosAttributes.Luck) != 0)
                list.Add(1060436, prop.ToString()); // luck ~1_val~

            if ((prop = this.m_AosAttributes.BonusMana) != 0)
                list.Add(1060439, prop.ToString()); // mana increase ~1_val~

            if ((prop = this.m_AosAttributes.RegenMana) != 0)
                list.Add(1060440, prop.ToString()); // mana regeneration ~1_val~

            if ((prop = this.m_AosAttributes.NightSight) != 0)
                list.Add(1060441); // night sight

            if ((prop = this.m_AosAttributes.ReflectPhysical) != 0)
                list.Add(1060442, prop.ToString()); // reflect physical damage ~1_val~%

            if ((prop = this.m_AosAttributes.RegenStam) != 0)
                list.Add(1060443, prop.ToString()); // stamina regeneration ~1_val~

            if ((prop = this.m_AosAttributes.RegenHits) != 0)
                list.Add(1060444, prop.ToString()); // hit point regeneration ~1_val~

            if ((prop = this.m_AosAttributes.SpellChanneling) != 0)
                list.Add(1060482); // spell channeling

            if ((prop = this.m_AosAttributes.SpellDamage) != 0)
                list.Add(1060483, prop.ToString()); // spell damage increase ~1_val~%

            if ((prop = this.m_AosAttributes.BonusStam) != 0)
                list.Add(1060484, prop.ToString()); // stamina increase ~1_val~

            if ((prop = this.m_AosAttributes.BonusStr) != 0)
                list.Add(1060485, prop.ToString()); // strength bonus ~1_val~

            if ((prop = this.m_AosAttributes.WeaponSpeed) != 0)
                list.Add(1060486, prop.ToString()); // swing speed increase ~1_val~%

            if (Core.ML && (prop = this.m_AosAttributes.IncreasedKarmaLoss) != 0)
                list.Add(1075210, prop.ToString()); // Increased Karma Loss ~1val~%</pre>

## Duplicated Code. Size: 1114

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>{
                Server.Mobiles.Spawner sp = (Server.Mobiles.Spawner)item;

                sp.NextSpawn = TimeSpan.Zero;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("Spawn"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.SpawnNames.Add(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MinDelay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.MinDelay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MaxDelay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.MaxDelay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("NextSpawn"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.NextSpawn = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Count"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.Count = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Team"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.Team = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("HomeRange"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.HomeRange = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Running"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.Running = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Group"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.Group = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                }
            }</pre>

Fragment 2 in file Scripts\Commands\DecorateDelete.cs

<pre>{
                Server.Mobiles.Spawner sp = (Server.Mobiles.Spawner)item;

                sp.NextSpawn = TimeSpan.Zero;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("Spawn"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.SpawnNames.Add(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MinDelay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.MinDelay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MaxDelay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.MaxDelay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("NextSpawn"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.NextSpawn = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Count"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.Count = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Team"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.Team = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("HomeRange"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.HomeRange = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Running"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.Running = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Group"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.Group = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                }
            }</pre>

Fragment 3 in file Scripts\Commands\DecorateMag.cs

<pre>{
                Server.Mobiles.Spawner sp = (Server.Mobiles.Spawner)item;

                sp.NextSpawn = TimeSpan.Zero;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("Spawn"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.SpawnNames.Add(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MinDelay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.MinDelay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MaxDelay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.MaxDelay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("NextSpawn"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.NextSpawn = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Count"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.Count = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Team"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.Team = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("HomeRange"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.HomeRange = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Running"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.Running = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Group"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            sp.Group = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                }
            }</pre>

## Duplicated Code. Size: 1086

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>if(from == gauntlet.Challenger && !m_gauntlet.GameLocked)
			{
			    AddImageTiled( 15, height - 110, 320, 20, 0xdb3 );

                AddButton( 130, height - 35, 0xFA8, 0xFAA, 100, GumpButtonType.Reply, 0 );
                AddLabel( 170, height - 35, 0, XmlPoints.GetText(from, 200528) );      // "Add"

                AddButton( 230, height - 35, 0xFB7, 0xFB9, 300, GumpButtonType.Reply, 0 );
                AddLabel( 270, height - 35, 0, XmlPoints.GetText(from, 200529) );     // "Start"

                // set entry fee
                AddButton( 20, height - 85, 0xFAE, 0xFAF, 10, GumpButtonType.Reply, 0 );
                AddImageTiled(120, height - 85, 60, 19, textentrybackground );
                AddTextEntry( 120, height - 85, 60, 25, 0, 10 ,m_gauntlet.EntryFee.ToString() );
                AddLabel( 55, height - 85, 0, XmlPoints.GetText(from, 200572) );  // "Entry Fee: "

                // set arena size
                AddButton( 20, height - 60, 0xFAE, 0xFAF, 20, GumpButtonType.Reply, 0 );
                AddImageTiled(130, height - 60, 30, 19, textentrybackground );
                AddTextEntry( 130, height - 60, 30, 25, 0, 20 ,m_gauntlet.ArenaSize.ToString() );
                AddLabel( 55, height - 60, 0, XmlPoints.GetText(from, 200573) );    //  "Arena Size: "

                // set target score
                AddButton( 200, height - 85, 0xFAE, 0xFAF, 30, GumpButtonType.Reply, 0 );
                AddImageTiled( 275, height - 85, 30, 19, textentrybackground );
                AddTextEntry( 275, height - 85, 30, 25, 0, 30 ,m_gauntlet.TargetScore.ToString() );
                AddLabel( 235, height - 85, 0, XmlPoints.GetText(from, 200566) );    //  "Score: "

                // set teams
                AddButton( 200, height - 60, 0xFAE, 0xFAF, 11, GumpButtonType.Reply, 0 );
                AddLabel( 240, height - 60, 0, XmlPoints.GetText(from, 200592));   // "Set Teams"

			} else
			{
                AddImageTiled( 15, height - 60, 320, 20, 0xdb3 );
			}

			AddButton( 20, height - 35, 0xFAB, 0xFAD, 1, GumpButtonType.Reply, 0 );
            AddLabel( 60, height - 35, 0, XmlPoints.GetText(from, 200532) );  // "Refresh"

            if(gauntlet.GameInProgress)
            {
                AddLabel( 150, height - 35, 68, XmlPoints.GetText(from, 200533));  // "Game is in progress!"
            } else
            if(gauntlet.Winner != 0)
            {
                AddLabel( 130, height - 35, 68, String.Format(XmlPoints.GetText(from, 200593), gauntlet.Winner) );   // "Team {0} is the winner!"
            }

			//AddButton( 30, height - 35, 0xFB7, 0xFB9, 0, GumpButtonType.Reply, 0 );
			//AddLabel( 70, height - 35, 0, "Close" );

			// display the teams gump
            from.CloseGump(typeof(TeamsGump));
			from.SendGump(new TeamsGump(m_gauntlet, from) );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>if(from == gauntlet.Challenger && !m_gauntlet.GameLocked)
			{
			    AddImageTiled( 15, height - 110, 320, 20, 0xdb3 );

                AddButton( 130, height - 35, 0xFA8, 0xFAA, 100, GumpButtonType.Reply, 0 );
                AddLabel( 170, height - 35, 0, XmlPoints.GetText(from, 200528) );      // "Add"

                AddButton( 230, height - 35, 0xFB7, 0xFB9, 300, GumpButtonType.Reply, 0 );
                AddLabel( 270, height - 35, 0, XmlPoints.GetText(from, 200529) );     // "Start"

                // set entry fee
                AddButton( 20, height - 85, 0xFAE, 0xFAF, 10, GumpButtonType.Reply, 0 );
                AddImageTiled(120, height - 85, 60, 19, textentrybackground );
                AddTextEntry( 120, height - 85, 60, 25, 0, 10 ,m_gauntlet.EntryFee.ToString() );
                AddLabel( 55, height - 85, 0, XmlPoints.GetText(from, 200572) );  // "Entry Fee: "

                // set arena size
                AddButton( 20, height - 60, 0xFAE, 0xFAF, 20, GumpButtonType.Reply, 0 );
                AddImageTiled(130, height - 60, 30, 19, textentrybackground );
                AddTextEntry( 130, height - 60, 30, 25, 0, 20 ,m_gauntlet.ArenaSize.ToString() );
                AddLabel( 55, height - 60, 0, XmlPoints.GetText(from, 200573) );    //  "Arena Size: "

                // set target score
                AddButton( 200, height - 85, 0xFAE, 0xFAF, 30, GumpButtonType.Reply, 0 );
                AddImageTiled( 275, height - 85, 30, 19, textentrybackground );
                AddTextEntry( 275, height - 85, 30, 25, 0, 30 ,m_gauntlet.TargetScore.ToString() );
                AddLabel( 235, height - 85, 0, XmlPoints.GetText(from, 200566) );    //  "Score: "

                // set teams
                AddButton( 200, height - 60, 0xFAE, 0xFAF, 11, GumpButtonType.Reply, 0 );
                AddLabel( 240, height - 60, 0, XmlPoints.GetText(from, 200592));   // "Set Teams"

			} else
			{
                AddImageTiled( 15, height - 60, 320, 20, 0xdb3 );
			}

			AddButton( 20, height - 35, 0xFAB, 0xFAD, 1, GumpButtonType.Reply, 0 );
            AddLabel( 60, height - 35, 0, XmlPoints.GetText(from, 200532) );  // "Refresh"

            if(gauntlet.GameInProgress)
            {
                AddLabel( 150, height - 35, 68, XmlPoints.GetText(from, 200533));  // "Game is in progress!"
            } else
            if(gauntlet.Winner != 0)
            {
                AddLabel( 130, height - 35, 68, String.Format(XmlPoints.GetText(from, 200593), gauntlet.Winner) );   // "Team {0} is the winner!"
            }

			//AddButton( 30, height - 35, 0xFB7, 0xFB9, 0, GumpButtonType.Reply, 0 );
			//AddLabel( 70, height - 35, 0, "Close" );

			// display the teams gump
            from.CloseGump(typeof(TeamsGump));
			from.SendGump(new TeamsGump(m_gauntlet, from) );</pre>

## Duplicated Code. Size: 1063

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddImageTiled(10, 20, 220, 232, 3004);

            //----------
            this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(172, 27, 200, "Unload");

            //colunas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 2, 222, 10003);
            this.AddImageTiled(163, 25, 2, 222, 10003);
            this.AddImageTiled(218, 25, 2, 222, 10003);

            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);
            this.AddImageTiled(20, 220, 200, 2, 10001);
            this.AddImageTiled(20, 245, 200, 2, 10001);

            //Map names
            this.AddLabel(35, 51, 200, "Blighted Grove");
            this.AddLabel(35, 76, 200, "Britain Sewer");
            this.AddLabel(35, 101, 200, "Covetous");
            this.AddLabel(35, 126, 200, "Deceit");
            this.AddLabel(35, 151, 200, "Despise");
            this.AddLabel(35, 176, 200, "Destard");
            this.AddLabel(35, 201, 200, "Fire");
            this.AddLabel(35, 226, 200, "Graveyards");

            //Check boxes
            this.AddCheck(182, 48, 210, 211, false, 101);
            this.AddCheck(182, 73, 210, 211, false, 102);
            this.AddCheck(182, 98, 210, 211, false, 103);
            this.AddCheck(182, 123, 210, 211, false, 104);
            this.AddCheck(182, 148, 210, 211, false, 105);
            this.AddCheck(182, 173, 210, 211, false, 106);
            this.AddCheck(182, 198, 210, 211, false, 107);
            this.AddCheck(182, 223, 210, 211, false, 108);

            this.AddLabel(110, 255, 200, "1/4");
            this.AddButton(200, 255, 0xFA5, 0xFA7, 0, GumpButtonType.Page, 2);

            this.AddPage(2);

            //grey background
            this.AddBackground(0, 0, 240, 310, 5054);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddImageTiled(10, 20, 220, 232, 3004);

            //----------
            this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(172, 27, 200, "Unload");

            //colunas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 2, 222, 10003);
            this.AddImageTiled(163, 25, 2, 222, 10003);
            this.AddImageTiled(218, 25, 2, 222, 10003);

            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);
            this.AddImageTiled(20, 220, 200, 2, 10001);
            this.AddImageTiled(20, 245, 200, 2, 10001);

            //Map names
            this.AddLabel(35, 51, 200, "Blighted Grove");
            this.AddLabel(35, 76, 200, "Britain Sewer");
            this.AddLabel(35, 101, 200, "Covetous");
            this.AddLabel(35, 126, 200, "Deceit");
            this.AddLabel(35, 151, 200, "Despise");
            this.AddLabel(35, 176, 200, "Destard");
            this.AddLabel(35, 201, 200, "Fire");
            this.AddLabel(35, 226, 200, "Graveyards");

            //Check boxes
            this.AddCheck(182, 48, 210, 211, false, 101);
            this.AddCheck(182, 73, 210, 211, false, 102);
            this.AddCheck(182, 98, 210, 211, false, 103);
            this.AddCheck(182, 123, 210, 211, false, 104);
            this.AddCheck(182, 148, 210, 211, false, 105);
            this.AddCheck(182, 173, 210, 211, false, 106);
            this.AddCheck(182, 198, 210, 211, false, 107);
            this.AddCheck(182, 223, 210, 211, false, 108);

            this.AddLabel(110, 255, 200, "1/4");
            this.AddButton(200, 255, 0xFA5, 0xFA7, 0, GumpButtonType.Page, 2);

            this.AddPage(2);

            //grey background
            this.AddBackground(0, 0, 240, 310, 5054);</pre>

## Duplicated Code. Size: 1024

### Duplicated Fragments:

Fragment 1 in file Server\Items\Container.cs

<pre>{
			if (types.Length != amounts.Length)
			{
				throw new ArgumentException();
			}
			else if (grouper == null)
			{
				throw new ArgumentNullException();
			}

			var items = new Item[types.Length][][];
			var totals = new int[types.Length][];

			for (int i = 0; i < types.Length; ++i)
			{
				var typedItems = FindItemsByType(types[i], recurse);

				var groups = new List<List<Item>>();
				int idx = 0;

				while (idx < typedItems.Length)
				{
					Item a = typedItems[idx++];
					var group = new List<Item>();

					group.Add(a);

					while (idx < typedItems.Length)
					{
						Item b = typedItems[idx];
						int v = grouper(a, b);

						if (v == 0)
						{
							group.Add(b);
						}
						else
						{
							break;
						}

						++idx;
					}

					groups.Add(group);
				}

				items[i] = new Item[groups.Count][];
				totals[i] = new int[groups.Count];

				bool hasEnough = false;

				for (int j = 0; j < groups.Count; ++j)
				{
					items[i][j] = groups[j].ToArray();
					//items[i][j] = (Item[])(((ArrayList)groups[j]).ToArray( typeof( Item ) ));

					for (int k = 0; k < items[i][j].Length; ++k)
					{
						totals[i][j] += items[i][j][k].Amount;
					}

					if (totals[i][j] >= amounts[i])
					{
						hasEnough = true;
					}
				}

				if (!hasEnough)
				{
					return i;
				}
			}

			for (int i = 0; i < items.Length; ++i)
			{
				for (int j = 0; j < items[i].Length; ++j)
				{
					if (totals[i][j] >= amounts[i])
					{
						int need = amounts[i];

						for (int k = 0; k < items[i][j].Length; ++k)
						{
							Item item = items[i][j][k];

							int theirAmount = item.Amount;

							if (theirAmount < need)
							{
								if (callback != null)
								{
									callback(item, theirAmount);
								}

								item.Delete();
								need -= theirAmount;
							}
							else
							{
								if (callback != null)
								{
									callback(item, need);
								}

								item.Consume(need);
								break;
							}
						}

						break;
					}
				}
			}

			return -1;
		}</pre>

Fragment 2 in file Server\Items\Container.cs

<pre>{
			if (types.Length != amounts.Length)
			{
				throw new ArgumentException();
			}
			else if (grouper == null)
			{
				throw new ArgumentNullException();
			}

			var items = new Item[types.Length][][];
			var totals = new int[types.Length][];

			for (int i = 0; i < types.Length; ++i)
			{
				var typedItems = FindItemsByType(types[i], recurse);

				var groups = new List<List<Item>>();
				int idx = 0;

				while (idx < typedItems.Length)
				{
					Item a = typedItems[idx++];
					var group = new List<Item>();

					group.Add(a);

					while (idx < typedItems.Length)
					{
						Item b = typedItems[idx];
						int v = grouper(a, b);

						if (v == 0)
						{
							group.Add(b);
						}
						else
						{
							break;
						}

						++idx;
					}

					groups.Add(group);
				}

				items[i] = new Item[groups.Count][];
				totals[i] = new int[groups.Count];

				bool hasEnough = false;

				for (int j = 0; j < groups.Count; ++j)
				{
					items[i][j] = groups[j].ToArray();

					for (int k = 0; k < items[i][j].Length; ++k)
					{
						totals[i][j] += items[i][j][k].Amount;
					}

					if (totals[i][j] >= amounts[i])
					{
						hasEnough = true;
					}
				}

				if (!hasEnough)
				{
					return i;
				}
			}

			for (int i = 0; i < items.Length; ++i)
			{
				for (int j = 0; j < items[i].Length; ++j)
				{
					if (totals[i][j] >= amounts[i])
					{
						int need = amounts[i];

						for (int k = 0; k < items[i][j].Length; ++k)
						{
							Item item = items[i][j][k];

							int theirAmount = item.Amount;

							if (theirAmount < need)
							{
								if (callback != null)
								{
									callback(item, theirAmount);
								}

								item.Delete();
								need -= theirAmount;
							}
							else
							{
								if (callback != null)
								{
									callback(item, need);
								}

								item.Consume(need);
								break;
							}
						}

						break;
					}
				}
			}

			return -1;
		}</pre>

## Duplicated Code. Size: 1012

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BasketWeaving\SBSATinker.cs

<pre>this.Add(new GenericBuyInfo(typeof(Board), 3, 20, 0x1BD7, 0));
                this.Add(new GenericBuyInfo(typeof(IronIngot), 5, 16, 0x1BF2, 0));
                this.Add(new GenericBuyInfo(typeof(SewingKit), 3, 20, 0xF9D, 0));

                this.Add(new GenericBuyInfo(typeof(DrawKnife), 10, 20, 0x10E4, 0));
                this.Add(new GenericBuyInfo(typeof(Froe), 10, 20, 0x10E5, 0));
                this.Add(new GenericBuyInfo(typeof(Scorp), 10, 20, 0x10E7, 0));
                this.Add(new GenericBuyInfo(typeof(Inshave), 10, 20, 0x10E6, 0));

                this.Add(new GenericBuyInfo(typeof(ButcherKnife), 13, 20, 0x13F6, 0));

                this.Add(new GenericBuyInfo(typeof(Scissors), 11, 20, 0xF9F, 0));

                this.Add(new GenericBuyInfo(typeof(Tongs), 13, 14, 0xFBB, 0));

                this.Add(new GenericBuyInfo(typeof(DovetailSaw), 12, 20, 0x1028, 0));
                this.Add(new GenericBuyInfo(typeof(Saw), 15, 20, 0x1034, 0));

                this.Add(new GenericBuyInfo(typeof(Hammer), 17, 20, 0x102A, 0));
                this.Add(new GenericBuyInfo(typeof(SmithHammer), 23, 20, 0x13E3, 0));
                // TODO: Sledgehammer

                this.Add(new GenericBuyInfo(typeof(Shovel), 12, 20, 0xF39, 0));

                this.Add(new GenericBuyInfo(typeof(MouldingPlane), 11, 20, 0x102C, 0));
                this.Add(new GenericBuyInfo(typeof(JointingPlane), 10, 20, 0x1030, 0));
                this.Add(new GenericBuyInfo(typeof(SmoothingPlane), 11, 20, 0x1032, 0));

                this.Add(new GenericBuyInfo(typeof(Pickaxe), 25, 20, 0xE86, 0));

                this.Add(new GenericBuyInfo(typeof(Drums), 21, 20, 0x0E9C, 0));
                this.Add(new GenericBuyInfo(typeof(Tambourine), 21, 20, 0x0E9E, 0));
                this.Add(new GenericBuyInfo(typeof(LapHarp), 21, 20, 0x0EB2, 0));
                this.Add(new GenericBuyInfo(typeof(Lute), 21, 20, 0x0EB3, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBTinker.cs

<pre>this.Add(new GenericBuyInfo(typeof(Board), 3, 20, 0x1BD7, 0));
                this.Add(new GenericBuyInfo(typeof(IronIngot), 5, 16, 0x1BF2, 0));
                this.Add(new GenericBuyInfo(typeof(SewingKit), 3, 20, 0xF9D, 0));

                this.Add(new GenericBuyInfo(typeof(DrawKnife), 10, 20, 0x10E4, 0));
                this.Add(new GenericBuyInfo(typeof(Froe), 10, 20, 0x10E5, 0));
                this.Add(new GenericBuyInfo(typeof(Scorp), 10, 20, 0x10E7, 0));
                this.Add(new GenericBuyInfo(typeof(Inshave), 10, 20, 0x10E6, 0));

                this.Add(new GenericBuyInfo(typeof(ButcherKnife), 13, 20, 0x13F6, 0));

                this.Add(new GenericBuyInfo(typeof(Scissors), 11, 20, 0xF9F, 0));

                this.Add(new GenericBuyInfo(typeof(Tongs), 13, 14, 0xFBB, 0));

                this.Add(new GenericBuyInfo(typeof(DovetailSaw), 12, 20, 0x1028, 0));
                this.Add(new GenericBuyInfo(typeof(Saw), 15, 20, 0x1034, 0));

                this.Add(new GenericBuyInfo(typeof(Hammer), 17, 20, 0x102A, 0));
                this.Add(new GenericBuyInfo(typeof(SmithHammer), 23, 20, 0x13E3, 0));
                // TODO: Sledgehammer

                this.Add(new GenericBuyInfo(typeof(Shovel), 12, 20, 0xF39, 0));

                this.Add(new GenericBuyInfo(typeof(MouldingPlane), 11, 20, 0x102C, 0));
                this.Add(new GenericBuyInfo(typeof(JointingPlane), 10, 20, 0x1030, 0));
                this.Add(new GenericBuyInfo(typeof(SmoothingPlane), 11, 20, 0x1032, 0));

                this.Add(new GenericBuyInfo(typeof(Pickaxe), 25, 20, 0xE86, 0));

                this.Add(new GenericBuyInfo(typeof(Drums), 21, 20, 0x0E9C, 0));
                this.Add(new GenericBuyInfo(typeof(Tambourine), 21, 20, 0x0E9E, 0));
                this.Add(new GenericBuyInfo(typeof(LapHarp), 21, 20, 0x0EB2, 0));
                this.Add(new GenericBuyInfo(typeof(Lute), 21, 20, 0x0EB3, 0));</pre>

## Duplicated Code. Size: 1001

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>private static bool FindItem(int x, int y, int z, Map map, Item srcItem)
        {
            int itemID = srcItem.ItemID;

            bool res = false;

            IPooledEnumerable eable;

            if (srcItem is BaseDoor)
            {
                eable = map.GetItemsInRange(new Point3D(x, y, z), 1);

                foreach (Item item in eable)
                {
                    if (!(item is BaseDoor))
                        continue;

                    BaseDoor bd = (BaseDoor)item;
                    Point3D p;
                    int bdItemID;

                    if (bd.Open)
                    {
                        p = new Point3D(bd.X - bd.Offset.X, bd.Y - bd.Offset.Y, bd.Z - bd.Offset.Z);
                        bdItemID = bd.ClosedID;
                    }
                    else
                    {
                        p = bd.Location;
                        bdItemID = bd.ItemID;
                    }

                    if (p.X != x || p.Y != y)
                        continue;

                    if (item.Z == z && bdItemID == itemID)
                        res = true;
                    else if (Math.Abs(item.Z - z) < 8)
                        m_DeleteQueue.Enqueue(item);
                }
            }
            else if ((TileData.ItemTable[itemID & TileData.MaxItemValue].Flags & TileFlag.LightSource) != 0)
            {
                eable = map.GetItemsInRange(new Point3D(x, y, z), 0);

                LightType lt = srcItem.Light;
                string srcName = srcItem.ItemData.Name;

                foreach (Item item in eable)
                {
                    if (item.Z == z)
                    {
                        if (item.ItemID == itemID)
                        {
                            if (item.Light != lt)
                                m_DeleteQueue.Enqueue(item);
                            else
                                res = true;
                        }
                        else if ((item.ItemData.Flags & TileFlag.LightSource) != 0 && item.ItemData.Name == srcName)
                        {
                            m_DeleteQueue.Enqueue(item);
                        }
                    }
                }
            }
            else if (srcItem is Teleporter || srcItem is FillableContainer || srcItem is BaseBook)
            {
                eable = map.GetItemsInRange(new Point3D(x, y, z), 0);

                Type type = srcItem.GetType();

                foreach (Item item in eable)
                {
                    if (item.Z == z && item.ItemID == itemID)
                    {
                        if (item.GetType() != type)
                            m_DeleteQueue.Enqueue(item);
                        else
                            res = true;
                    }
                }
            }
            else
            {
                eable = map.GetItemsInRange(new Point3D(x, y, z), 0);

                foreach (Item item in eable)
                {
                    if (item.Z == z && item.ItemID == itemID)
                    {
                        eable.Free();
                        return true;
                    }
                }
            }

            eable.Free();

            while (m_DeleteQueue.Count > 0)
                ((Item)m_DeleteQueue.Dequeue()).Delete();

            return res;
        }</pre>

Fragment 2 in file Scripts\Commands\DecorateMag.cs

<pre>private static bool FindItem(int x, int y, int z, Map map, Item srcItem)
        {
            int itemID = srcItem.ItemID;

            bool res = false;

            IPooledEnumerable eable;

            if (srcItem is BaseDoor)
            {
                eable = map.GetItemsInRange(new Point3D(x, y, z), 1);

                foreach (Item item in eable)
                {
                    if (!(item is BaseDoor))
                        continue;

                    BaseDoor bd = (BaseDoor)item;
                    Point3D p;
                    int bdItemID;

                    if (bd.Open)
                    {
                        p = new Point3D(bd.X - bd.Offset.X, bd.Y - bd.Offset.Y, bd.Z - bd.Offset.Z);
                        bdItemID = bd.ClosedID;
                    }
                    else
                    {
                        p = bd.Location;
                        bdItemID = bd.ItemID;
                    }

                    if (p.X != x || p.Y != y)
                        continue;

                    if (item.Z == z && bdItemID == itemID)
                        res = true;
                    else if (Math.Abs(item.Z - z) < 8)
                        m_DeleteQueue.Enqueue(item);
                }
            }
            else if ((TileData.ItemTable[itemID & TileData.MaxItemValue].Flags & TileFlag.LightSource) != 0)
            {
                eable = map.GetItemsInRange(new Point3D(x, y, z), 0);

                LightType lt = srcItem.Light;
                string srcName = srcItem.ItemData.Name;

                foreach (Item item in eable)
                {
                    if (item.Z == z)
                    {
                        if (item.ItemID == itemID)
                        {
                            if (item.Light != lt)
                                m_DeleteQueue.Enqueue(item);
                            else
                                res = true;
                        }
                        else if ((item.ItemData.Flags & TileFlag.LightSource) != 0 && item.ItemData.Name == srcName)
                        {
                            m_DeleteQueue.Enqueue(item);
                        }
                    }
                }
            }
            else if (srcItem is Teleporter || srcItem is FillableContainer || srcItem is BaseBook)
            {
                eable = map.GetItemsInRange(new Point3D(x, y, z), 0);

                Type type = srcItem.GetType();

                foreach (Item item in eable)
                {
                    if (item.Z == z && item.ItemID == itemID)
                    {
                        if (item.GetType() != type)
                            m_DeleteQueue.Enqueue(item);
                        else
                            res = true;
                    }
                }
            }
            else
            {
                eable = map.GetItemsInRange(new Point3D(x, y, z), 0);

                foreach (Item item in eable)
                {
                    if (item.Z == z && item.ItemID == itemID)
                    {
                        eable.Free();
                        return true;
                    }
                }
            }

            eable.Free();

            while (m_DeleteQueue.Count > 0)
                ((Item)m_DeleteQueue.Dequeue()).Delete();

            return res;
        }</pre>

## Duplicated Code. Size: 949

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetPoint2DGump.cs

<pre>this.AddPage(0);

            this.AddBackground(0, 0, BackWidth, BackHeight, BackGumpID);
            this.AddImageTiled(BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), TotalHeight, OffsetGumpID);

            int x = BorderSize + OffsetSize;
            int y = BorderSize + OffsetSize;

            this.AddImageTiled(x, y, EntryWidth, EntryHeight, EntryGumpID);
            this.AddLabelCropped(x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, prop.Name);
            x += EntryWidth + OffsetSize;

            if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);

            x = BorderSize + OffsetSize;
            y += EntryHeight + OffsetSize;

            this.AddImageTiled(x, y, EntryWidth, EntryHeight, EntryGumpID);
            this.AddLabelCropped(x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, "Use your location");
            x += EntryWidth + OffsetSize;

            if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);
            this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 1, GumpButtonType.Reply, 0);

            x = BorderSize + OffsetSize;
            y += EntryHeight + OffsetSize;

            this.AddImageTiled(x, y, EntryWidth, EntryHeight, EntryGumpID);
            this.AddLabelCropped(x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, "Target a location");
            x += EntryWidth + OffsetSize;

            if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);
            this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 2, GumpButtonType.Reply, 0);

            x = BorderSize + OffsetSize;
            y += EntryHeight + OffsetSize;

            this.AddImageTiled(x, y, CoordWidth, EntryHeight, EntryGumpID);
            this.AddLabelCropped(x + TextOffsetX, y, CoordWidth - TextOffsetX, EntryHeight, TextHue, "X:");
            this.AddTextEntry(x + 16, y, CoordWidth - 16, EntryHeight, TextHue, 0, p.X.ToString());
            x += CoordWidth + OffsetSize;

            this.AddImageTiled(x, y, CoordWidth, EntryHeight, EntryGumpID);
            this.AddLabelCropped(x + TextOffsetX, y, CoordWidth - TextOffsetX, EntryHeight, TextHue, "Y:");
            this.AddTextEntry(x + 16, y, CoordWidth - 16, EntryHeight, TextHue, 1, p.Y.ToString());
            x += CoordWidth + OffsetSize;</pre>

Fragment 2 in file Scripts\Gumps\Properties\SetPoint3DGump.cs

<pre>this.AddPage(0);

            this.AddBackground(0, 0, BackWidth, BackHeight, BackGumpID);
            this.AddImageTiled(BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), TotalHeight, OffsetGumpID);

            int x = BorderSize + OffsetSize;
            int y = BorderSize + OffsetSize;

            this.AddImageTiled(x, y, EntryWidth, EntryHeight, EntryGumpID);
            this.AddLabelCropped(x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, prop.Name);
            x += EntryWidth + OffsetSize;

            if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);

            x = BorderSize + OffsetSize;
            y += EntryHeight + OffsetSize;

            this.AddImageTiled(x, y, EntryWidth, EntryHeight, EntryGumpID);
            this.AddLabelCropped(x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, "Use your location");
            x += EntryWidth + OffsetSize;

            if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);
            this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 1, GumpButtonType.Reply, 0);

            x = BorderSize + OffsetSize;
            y += EntryHeight + OffsetSize;

            this.AddImageTiled(x, y, EntryWidth, EntryHeight, EntryGumpID);
            this.AddLabelCropped(x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, "Target a location");
            x += EntryWidth + OffsetSize;

            if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);
            this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 2, GumpButtonType.Reply, 0);

            x = BorderSize + OffsetSize;
            y += EntryHeight + OffsetSize;

            this.AddImageTiled(x, y, CoordWidth, EntryHeight, EntryGumpID);
            this.AddLabelCropped(x + TextOffsetX, y, CoordWidth - TextOffsetX, EntryHeight, TextHue, "X:");
            this.AddTextEntry(x + 16, y, CoordWidth - 16, EntryHeight, TextHue, 0, p.X.ToString());
            x += CoordWidth + OffsetSize;

            this.AddImageTiled(x, y, CoordWidth, EntryHeight, EntryGumpID);
            this.AddLabelCropped(x + TextOffsetX, y, CoordWidth - TextOffsetX, EntryHeight, TextHue, "Y:");
            this.AddTextEntry(x + 16, y, CoordWidth - 16, EntryHeight, TextHue, 1, p.Y.ToString());
            x += CoordWidth + OffsetSize;</pre>

## Duplicated Code. Size: 945

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\HireBard.cs

<pre>{
            this.SpeechHue = Utility.RandomDyedHue();
            this.Hue = Utility.RandomSkinHue();

            if (this.Female = Utility.RandomBool()) 
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");

                switch ( Utility.Random(2) )
                {
                    case 0:
                        this.AddItem(new Skirt(Utility.RandomDyedHue()));
                        break;
                    case 1:
                        this.AddItem(new Kilt(Utility.RandomNeutralHue()));
                        break;
                }
            }
            else 
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
                this.AddItem(new ShortPants(Utility.RandomNeutralHue()));
            }
            this.Title = "the bard";
            this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();
            this.Race.RandomFacialHair(this);

            this.SetStr(16, 16);
            this.SetDex(26, 26);
            this.SetInt(26, 26);

            this.SetDamage(5, 10);

            this.SetSkill(SkillName.Tactics, 35, 57);
            this.SetSkill(SkillName.Magery, 22, 22);
            this.SetSkill(SkillName.Swords, 45, 67);
            this.SetSkill(SkillName.Archery, 36, 67);
            this.SetSkill(SkillName.Parry, 45, 60);
            this.SetSkill(SkillName.Musicianship, 66.0, 97.5);
            this.SetSkill(SkillName.Peacemaking, 65.0, 87.5);

            this.Fame = 100;
            this.Karma = 100;

            this.AddItem(new Shoes(Utility.RandomNeutralHue()));

            switch ( Utility.Random(2) )
            {
                case 0:
                    this.AddItem(new Doublet(Utility.RandomDyedHue()));
                    break;
                case 1:
                    this.AddItem(new Shirt(Utility.RandomDyedHue()));
                    break;
            }
            switch ( Utility.Random(4) )
            {
                case 0:
                    this.PackItem(new Harp());
                    break;
                case 1:
                    this.PackItem(new Lute());
                    break;
                case 2:
                    this.PackItem(new Drums());
                    break;
                case 3:
                    this.PackItem(new Tambourine());
                    break;
            }

            this.AddItem(new Longsword());
            this.PackItem(new Bow());
            this.PackItem(new Arrow(100));
            this.PackGold(10, 50);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HireBardArcher.cs

<pre>{
            this.SpeechHue = Utility.RandomDyedHue();
            this.Hue = Utility.RandomSkinHue();

            if (this.Female = Utility.RandomBool()) 
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");

                switch ( Utility.Random(2) )
                {
                    case 0:
                        this.AddItem(new Skirt(Utility.RandomDyedHue()));
                        break;
                    case 1:
                        this.AddItem(new Kilt(Utility.RandomNeutralHue()));
                        break;
                }
            }
            else 
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
                this.AddItem(new ShortPants(Utility.RandomNeutralHue()));
            }
            this.Title = "the bard";
            this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();
            this.Race.RandomFacialHair(this);

            this.SetStr(16, 16);
            this.SetDex(26, 26);
            this.SetInt(26, 26);

            this.SetDamage(5, 10);

            this.SetSkill(SkillName.Tactics, 35, 57);
            this.SetSkill(SkillName.Magery, 22, 22);
            this.SetSkill(SkillName.Swords, 45, 67);
            this.SetSkill(SkillName.Archery, 36, 67);
            this.SetSkill(SkillName.Parry, 45, 60);
            this.SetSkill(SkillName.Musicianship, 66.0, 97.5);
            this.SetSkill(SkillName.Peacemaking, 65.0, 87.5);

            this.Fame = 100;
            this.Karma = 100;

            this.AddItem(new Shoes(Utility.RandomNeutralHue()));

            switch ( Utility.Random(2) )
            {
                case 0:
                    this.AddItem(new Doublet(Utility.RandomDyedHue()));
                    break;
                case 1:
                    this.AddItem(new Shirt(Utility.RandomDyedHue()));
                    break;
            }
            switch ( Utility.Random(4) )
            {
                case 0:
                    this.PackItem(new Harp());
                    break;
                case 1:
                    this.PackItem(new Lute());
                    break;
                case 2:
                    this.PackItem(new Drums());
                    break;
                case 3:
                    this.PackItem(new Tambourine());
                    break;
            }

            this.PackItem(new Longsword());
            this.AddItem(new Bow());
            this.PackItem(new Arrow(100));
            this.PackGold(10, 50);
        }</pre>

## Duplicated Code. Size: 899

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGauntlet.cs

<pre>if(Participants == null || !GameInProgress) return;

            bool statuschange = false;

            foreach(IChallengeEntry entry in Participants)
            {
                if(entry.Participant == null || entry.Status == ChallengeStatus.Forfeit || entry.Status == ChallengeStatus.Disqualified) continue;

                bool hadcaution = (entry.Caution != ChallengeStatus.None);

                // and a map check
                if(entry.Participant.Map != Map)
                {
                    // check to see if they are offline
                    if(entry.Participant.Map == Map.Internal)
                    {
                        // then give them a little time to return before disqualification
                        if(entry.Caution == ChallengeStatus.Offline)
                        {
                            // were previously out of bounds so check for disqualification
                            // check to see how long they have been out of bounds
                            if(DateTime.UtcNow - entry.LastCaution > MaximumOfflineDuration)
                            {
                                entry.Status = ChallengeStatus.Disqualified;
                                GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                                RefreshSymmetricNoto(entry.Participant);
                                statuschange = true;
                            }
                        } else
                        {
                            entry.LastCaution  = DateTime.UtcNow;
                            statuschange = true;
                        }

                        entry.Caution = ChallengeStatus.Offline;
                    } else
                    {
                        // changing to any other map is instant disqualification
                        entry.Status = ChallengeStatus.Disqualified;
                        GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                        RefreshSymmetricNoto(entry.Participant);
                        statuschange = true;
                    }

                } else
                // make a range check
                if(m_ArenaSize > 0 && !Utility.InRange(entry.Participant.Location, Location, m_ArenaSize)
                || (IsInChallengeGameRegion && !(Region.Find(entry.Participant.Location, entry.Participant.Map) is ChallengeGameRegion)))
                {
                    if(entry.Caution == ChallengeStatus.OutOfBounds)
                    {
                        // were previously out of bounds so check for disqualification
                        // check to see how long they have been out of bounds
                        if(DateTime.UtcNow - entry.LastCaution > MaximumOutOfBoundsDuration)
                        {
                            entry.Status = ChallengeStatus.Disqualified;
                            GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                            RefreshSymmetricNoto(entry.Participant);
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100309, MaximumOutOfBoundsDuration.TotalSeconds);  // "You are out of bounds!  You have {0} seconds to return"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.OutOfBounds;

                } else
                // make a hiding check
                if(entry.Participant.Hidden)
                {
                    if(entry.Caution == ChallengeStatus.Hidden)
                    {
                        // were previously hidden so check for disqualification
                        // check to see how long they have hidden
                        if(DateTime.UtcNow - entry.LastCaution > MaximumHiddenDuration)
                        {
                            entry.Status = ChallengeStatus.Disqualified;
                            GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                            RefreshSymmetricNoto(entry.Participant);
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100310, MaximumHiddenDuration.TotalSeconds); // "You have {0} seconds become unhidden"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.Hidden;

                } else
                {
                    entry.Caution = ChallengeStatus.None;
                }

                if(hadcaution && entry.Caution == ChallengeStatus.None)
                    statuschange = true;

                // if they were disqualified, then drop any ball they might have had and boot them from the game
                if(entry.Status == ChallengeStatus.Disqualified)
                {
                    ClearChallenge(entry.Participant);
                    DropBall(entry.Participant, Location, Map);
                }

            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGauntlet.cs

<pre>if(Participants == null || !GameInProgress) return;

            bool statuschange = false;

            foreach(IChallengeEntry entry in Participants)
            {
                if(entry.Participant == null || entry.Status == ChallengeStatus.Forfeit || entry.Status == ChallengeStatus.Disqualified) continue;

                bool hadcaution = (entry.Caution != ChallengeStatus.None);

                // and a map check
                if(entry.Participant.Map != Map)
                {
                    // check to see if they are offline
                    if(entry.Participant.Map == Map.Internal)
                    {
                        // then give them a little time to return before disqualification
                        if(entry.Caution == ChallengeStatus.Offline)
                        {
                            // were previously out of bounds so check for disqualification
                            // check to see how long they have been out of bounds
                            if(DateTime.UtcNow - entry.LastCaution > MaximumOfflineDuration)
                            {
                                entry.Status = ChallengeStatus.Disqualified;
                                GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                                RefreshSymmetricNoto(entry.Participant);
                                statuschange = true;
                            }
                        } else
                        {
                            entry.LastCaution  = DateTime.UtcNow;
                            statuschange = true;
                        }

                        entry.Caution = ChallengeStatus.Offline;
                    } else
                    {
                        // changing to any other map is instant disqualification
                        entry.Status = ChallengeStatus.Disqualified;
                        GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                        RefreshSymmetricNoto(entry.Participant);
                        statuschange = true;
                    }

                } else
                // make a range check
                if(m_ArenaSize > 0 && !Utility.InRange(entry.Participant.Location, Location, m_ArenaSize)
                || (IsInChallengeGameRegion && !(Region.Find(entry.Participant.Location, entry.Participant.Map) is ChallengeGameRegion)))
                {
                    if(entry.Caution == ChallengeStatus.OutOfBounds)
                    {
                        // were previously out of bounds so check for disqualification
                        // check to see how long they have been out of bounds
                        if(DateTime.UtcNow - entry.LastCaution > MaximumOutOfBoundsDuration)
                        {
                            entry.Status = ChallengeStatus.Disqualified;
                            GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                            RefreshSymmetricNoto(entry.Participant);
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100309, MaximumOutOfBoundsDuration.TotalSeconds);  // "You are out of bounds!  You have {0} seconds to return"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.OutOfBounds;

                } else
                // make a hiding check
                if(entry.Participant.Hidden)
                {
                    if(entry.Caution == ChallengeStatus.Hidden)
                    {
                        // were previously hidden so check for disqualification
                        // check to see how long they have hidden
                        if(DateTime.UtcNow - entry.LastCaution > MaximumHiddenDuration)
                        {
                            entry.Status = ChallengeStatus.Disqualified;
                            GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                            RefreshSymmetricNoto(entry.Participant);
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100310, MaximumHiddenDuration.TotalSeconds); // "You have {0} seconds become unhidden"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.Hidden;

                } else
                {
                    entry.Caution = ChallengeStatus.None;
                }

                if(hadcaution && entry.Caution == ChallengeStatus.None)
                    statuschange = true;

                // if they were disqualified, then drop any ball they might have had and boot them from the game
                if(entry.Status == ChallengeStatus.Disqualified)
                {
                    ClearChallenge(entry.Participant);
                    DropBall(entry.Participant, Location, Map);
                }

            }</pre>

## Duplicated Code. Size: 889

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetPoint2DGump.cs

<pre>AddPage( 0 );

			AddBackground( 0, 0, BackWidth, BackHeight, BackGumpID );
			AddImageTiled( BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), TotalHeight, OffsetGumpID );

			int x = BorderSize + OffsetSize;
			int y = BorderSize + OffsetSize;

			AddImageTiled( x, y, EntryWidth, EntryHeight, EntryGumpID );
			AddLabelCropped( x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, prop.Name );
			x += EntryWidth + OffsetSize;

			if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );

			x = BorderSize + OffsetSize;
			y += EntryHeight + OffsetSize;

			AddImageTiled( x, y, EntryWidth, EntryHeight, EntryGumpID );
			AddLabelCropped( x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, "Use your location" );
			x += EntryWidth + OffsetSize;

			if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );
			AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 1, GumpButtonType.Reply, 0 );

			x = BorderSize + OffsetSize;
			y += EntryHeight + OffsetSize;

			AddImageTiled( x, y, EntryWidth, EntryHeight, EntryGumpID );
			AddLabelCropped( x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, "Target a location" );
			x += EntryWidth + OffsetSize;

			if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );
			AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 2, GumpButtonType.Reply, 0 );

			x = BorderSize + OffsetSize;
			y += EntryHeight + OffsetSize;

			AddImageTiled( x, y, CoordWidth, EntryHeight, EntryGumpID );
			AddLabelCropped( x + TextOffsetX, y, CoordWidth - TextOffsetX, EntryHeight, TextHue, "X:" );
			AddTextEntry( x + 16, y, CoordWidth - 16, EntryHeight, TextHue, 0, p.X.ToString() );
			x += CoordWidth + OffsetSize;

			AddImageTiled( x, y, CoordWidth, EntryHeight, EntryGumpID );
			AddLabelCropped( x + TextOffsetX, y, CoordWidth - TextOffsetX, EntryHeight, TextHue, "Y:" );
			AddTextEntry( x + 16, y, CoordWidth - 16, EntryHeight, TextHue, 1, p.Y.ToString() );
			x += CoordWidth + OffsetSize;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetPoint3DGump.cs

<pre>AddPage( 0 );

			AddBackground( 0, 0, BackWidth, BackHeight, BackGumpID );
			AddImageTiled( BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), TotalHeight, OffsetGumpID );

			int x = BorderSize + OffsetSize;
			int y = BorderSize + OffsetSize;

			AddImageTiled( x, y, EntryWidth, EntryHeight, EntryGumpID );
			AddLabelCropped( x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, prop.Name );
			x += EntryWidth + OffsetSize;

			if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );

			x = BorderSize + OffsetSize;
			y += EntryHeight + OffsetSize;

			AddImageTiled( x, y, EntryWidth, EntryHeight, EntryGumpID );
			AddLabelCropped( x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, "Use your location" );
			x += EntryWidth + OffsetSize;

			if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );
			AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 1, GumpButtonType.Reply, 0 );

			x = BorderSize + OffsetSize;
			y += EntryHeight + OffsetSize;

			AddImageTiled( x, y, EntryWidth, EntryHeight, EntryGumpID );
			AddLabelCropped( x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, "Target a location" );
			x += EntryWidth + OffsetSize;

			if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );
			AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 2, GumpButtonType.Reply, 0 );

			x = BorderSize + OffsetSize;
			y += EntryHeight + OffsetSize;

			AddImageTiled( x, y, CoordWidth, EntryHeight, EntryGumpID );
			AddLabelCropped( x + TextOffsetX, y, CoordWidth - TextOffsetX, EntryHeight, TextHue, "X:" );
			AddTextEntry( x + 16, y, CoordWidth - 16, EntryHeight, TextHue, 0, p.X.ToString() );
			x += CoordWidth + OffsetSize;

			AddImageTiled( x, y, CoordWidth, EntryHeight, EntryGumpID );
			AddLabelCropped( x + TextOffsetX, y, CoordWidth - TextOffsetX, EntryHeight, TextHue, "Y:" );
			AddTextEntry( x + 16, y, CoordWidth - 16, EntryHeight, TextHue, 1, p.Y.ToString() );
			x += CoordWidth + OffsetSize;</pre>

## Duplicated Code. Size: 877

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGauntlet.cs

<pre>if(Participants == null || !GameInProgress) return;

            bool statuschange = false;

            foreach(IChallengeEntry entry in Participants)
            {
                if(entry.Participant == null || entry.Status == ChallengeStatus.Forfeit || entry.Status == ChallengeStatus.Disqualified) continue;

                bool hadcaution = (entry.Caution != ChallengeStatus.None);

                // and a map check
                if(entry.Participant.Map != Map)
                {
                    // check to see if they are offline
                    if(entry.Participant.Map == Map.Internal)
                    {
                        // then give them a little time to return before disqualification
                        if(entry.Caution == ChallengeStatus.Offline)
                        {
                            // were previously out of bounds so check for disqualification
                            // check to see how long they have been out of bounds
                            if(DateTime.UtcNow - entry.LastCaution > MaximumOfflineDuration)
                            {
                                entry.Status = ChallengeStatus.Disqualified;
                                GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                                RefreshSymmetricNoto(entry.Participant);
                                statuschange = true;
                            }
                        } else
                        {
                            entry.LastCaution  = DateTime.UtcNow;
                            statuschange = true;
                        }

                        entry.Caution = ChallengeStatus.Offline;
                    } else
                    {
                        // changing to any other map is instant disqualification
                        entry.Status = ChallengeStatus.Disqualified;
                        GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                        RefreshSymmetricNoto(entry.Participant);
                        statuschange = true;
                    }

                } else
                // make a range check
                if(m_ArenaSize > 0 && !Utility.InRange(entry.Participant.Location, Location, m_ArenaSize)
                || (IsInChallengeGameRegion && !(Region.Find(entry.Participant.Location, entry.Participant.Map) is ChallengeGameRegion)))
                {
                    if(entry.Caution == ChallengeStatus.OutOfBounds)
                    {
                        // were previously out of bounds so check for disqualification
                        // check to see how long they have been out of bounds
                        if(DateTime.UtcNow - entry.LastCaution > MaximumOutOfBoundsDuration)
                        {
                            entry.Status = ChallengeStatus.Disqualified;
                            GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                            RefreshSymmetricNoto(entry.Participant);
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100309, MaximumOutOfBoundsDuration.TotalSeconds);  // "You are out of bounds!  You have {0} seconds to return"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.OutOfBounds;

                } else
                // make a hiding check
                if(entry.Participant.Hidden)
                {
                    if(entry.Caution == ChallengeStatus.Hidden)
                    {
                        // were previously hidden so check for disqualification
                        // check to see how long they have hidden
                        if(DateTime.UtcNow - entry.LastCaution > MaximumHiddenDuration)
                        {
                            entry.Status = ChallengeStatus.Disqualified;
                            GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                            RefreshSymmetricNoto(entry.Participant);
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100310, MaximumHiddenDuration.TotalSeconds); // "You have {0} seconds become unhidden"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.Hidden;

                } else
                {
                    entry.Caution = ChallengeStatus.None;
                }

                if(hadcaution && entry.Caution == ChallengeStatus.None)
                    statuschange = true;

                // if they were disqualified, then drop them
                if(entry.Status == ChallengeStatus.Disqualified)
                {
                    ClearChallenge(entry.Participant);
                }

            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGauntlet.cs

<pre>if(Participants == null || !GameInProgress) return;

            bool statuschange = false;

            foreach(IChallengeEntry entry in Participants)
            {
                if(entry.Participant == null || entry.Status == ChallengeStatus.Forfeit || entry.Status == ChallengeStatus.Disqualified) continue;

                bool hadcaution = (entry.Caution != ChallengeStatus.None);

                // and a map check
                if(entry.Participant.Map != Map)
                {
                    // check to see if they are offline
                    if(entry.Participant.Map == Map.Internal)
                    {
                        // then give them a little time to return before disqualification
                        if(entry.Caution == ChallengeStatus.Offline)
                        {
                            // were previously out of bounds so check for disqualification
                            // check to see how long they have been out of bounds
                            if(DateTime.UtcNow - entry.LastCaution > MaximumOfflineDuration)
                            {
                                entry.Status = ChallengeStatus.Disqualified;
                                GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                                RefreshSymmetricNoto(entry.Participant);
                                statuschange = true;
                            }
                        } else
                        {
                            entry.LastCaution  = DateTime.UtcNow;
                            statuschange = true;
                        }

                        entry.Caution = ChallengeStatus.Offline;
                    } else
                    {
                        // changing to any other map is instant disqualification
                        entry.Status = ChallengeStatus.Disqualified;
                        GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                        RefreshSymmetricNoto(entry.Participant);
                        statuschange = true;
                    }

                } else
                // make a range check
                if(m_ArenaSize > 0 && !Utility.InRange(entry.Participant.Location, Location, m_ArenaSize)
                || (IsInChallengeGameRegion && !(Region.Find(entry.Participant.Location, entry.Participant.Map) is ChallengeGameRegion)))
                {
                    if(entry.Caution == ChallengeStatus.OutOfBounds)
                    {
                        // were previously out of bounds so check for disqualification
                        // check to see how long they have been out of bounds
                        if(DateTime.UtcNow - entry.LastCaution > MaximumOutOfBoundsDuration)
                        {
                            entry.Status = ChallengeStatus.Disqualified;
                            GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                            RefreshSymmetricNoto(entry.Participant);
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100309, MaximumOutOfBoundsDuration.TotalSeconds);  // "You are out of bounds!  You have {0} seconds to return"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.OutOfBounds;

                } else
                // make a hiding check
                if(entry.Participant.Hidden)
                {
                    if(entry.Caution == ChallengeStatus.Hidden)
                    {
                        // were previously hidden so check for disqualification
                        // check to see how long they have hidden
                        if(DateTime.UtcNow - entry.LastCaution > MaximumHiddenDuration)
                        {
                            entry.Status = ChallengeStatus.Disqualified;
                            GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                            RefreshSymmetricNoto(entry.Participant);
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100310, MaximumHiddenDuration.TotalSeconds); // "You have {0} seconds become unhidden"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.Hidden;

                } else
                {
                    entry.Caution = ChallengeStatus.None;
                }

                if(hadcaution && entry.Caution == ChallengeStatus.None)
                    statuschange = true;

                // if they were disqualified, then drop them
                if(entry.Status == ChallengeStatus.Disqualified)
                {
                    ClearChallenge(entry.Participant);
                }

            }</pre>

## Duplicated Code. Size: 870

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomAttacks.cs

<pre>{
            if(from == null || s == null) return false;

            // test for str, dex, int requirements
            if(from.Str < s.StrReq)
            {
                from.SendMessage("Need {0} Str to perform {1}", s.StrReq, s.Name);
                return false;
            }
            if(from.Dex < s.DexReq)
            {
                from.SendMessage("Need {0} Dex to perform {1}", s.DexReq, s.Name);
                return false;
            }
            if(from.Int < s.IntReq)
            {
                from.SendMessage("Need {0} Int to perform {1}", s.IntReq, s.Name);
                return false;
            }

            // test for skill requirements
            if(s.Skills != null && s.MinSkillLevel != null)
            {
                if(from.Skills == null) return false;

                for(int i = 0; i < s.Skills.Length; i++)
                {
                    // and check level
                    if(i < s.MinSkillLevel.Length)
                    {
                        Skill skill =  from.Skills[s.Skills[i]];
                        if(skill != null && s.MinSkillLevel[i] > skill.Base)
                        {
                            from.SendMessage("Need {0} {1} to perform {2}", s.MinSkillLevel[i], s.Skills[i].ToString(), s.Name);
                            return false;
                        }
                    } else
                    {
                        from.SendMessage(33,"Error in skill level specification for {0}", s.Name);
                        return false;
                    }
                }
            }

            // test for mana, stam, and hits requirements
            if(from.Mana < s.ManaReq)
            {
                from.SendMessage("Need {0} Mana to perform {1}", s.ManaReq, s.Name);
                return false;
            }
            if(from.Stam < s.StamReq)
            {
                from.SendMessage("Need {0} Stamina to perform {1}", s.StamReq, s.Name);
                return false;
            }
            if(from.Hits < s.HitsReq)
            {
                // clear the selected attack
                from.SendMessage("Need {0} Hits to perform {1}", s.HitsReq, s.Name);
                return false;
            }

            // check for any reagents that are specified
            if(s.Reagents != null && s.Quantity != null)
            {
                if(from.Backpack == null) return false;

                for(int i = 0; i < s.Reagents.Length; i++)
                {
                    // go through each reagent
                    Item ret = from.Backpack.FindItemByType(s.Reagents[i], true);

                    // and check quantity
                    if(i < s.Quantity.Length)
                    {
                        if(ret == null || s.Quantity[i] > ret.Amount)
                        {
                            from.SendMessage("Need {1} {0} to perform {2}", s.Reagents[i].Name, s.Quantity[i], s.Name);
                            return false;
                        }
                    } else
                    {
                        from.SendMessage(33,"Error in quantity specification for {0}", s.Name);
                        return false;
                    }
                }
            }
            return true;
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomDefenses.cs

<pre>{
            if(from == null || s == null) return false;

            // test for str, dex, int requirements
            if(from.Str < s.StrReq)
            {
                from.SendMessage("Need {0} Str to perform {1}", s.StrReq, s.Name);
                return false;
            }
            if(from.Dex < s.DexReq)
            {
                from.SendMessage("Need {0} Dex to perform {1}", s.DexReq, s.Name);
                return false;
            }
            if(from.Int < s.IntReq)
            {
                from.SendMessage("Need {0} Int to perform {1}", s.IntReq, s.Name);
                return false;
            }

            // test for skill requirements
            if(s.Skills != null && s.MinSkillLevel != null)
            {
                if(from.Skills == null) return false;

                for(int i = 0; i < s.Skills.Length; i++)
                {
                    // and check level
                    if(i < s.MinSkillLevel.Length)
                    {
                        Skill skill =  from.Skills[s.Skills[i]];
                        if(skill != null && s.MinSkillLevel[i] > skill.Base)
                        {
                            from.SendMessage("Need {0} {1} to perform {2}", s.MinSkillLevel[i], s.Skills[i].ToString(), s.Name);
                            return false;
                        }
                    } else
                    {
                        from.SendMessage(33,"Error in skill level specification for {0}", s.Name);
                        return false;
                    }
                }
            }

            // test for mana, stam, and hits requirements
            if(from.Mana < s.ManaReq)
            {
                from.SendMessage("Need {0} Mana to perform {1}", s.ManaReq, s.Name);
                return false;
            }
            if(from.Stam < s.StamReq)
            {
                from.SendMessage("Need {0} Stamina to perform {1}", s.StamReq, s.Name);
                return false;
            }
            if(from.Hits < s.HitsReq)
            {
                // clear the selected defense
                from.SendMessage("Need {0} Hits to perform {1}", s.HitsReq, s.Name);
                return false;
            }

            // check for any reagents that are specified
            if(s.Reagents != null && s.Quantity != null)
            {
                if(from.Backpack == null) return false;

                for(int i = 0; i < s.Reagents.Length; i++)
                {
                    // go through each reagent
                    Item ret = from.Backpack.FindItemByType(s.Reagents[i], true);

                    // and check quantity
                    if(i < s.Quantity.Length)
                    {
                        if(ret == null || s.Quantity[i] > ret.Amount)
                        {
                            from.SendMessage("Need {1} {0} to perform {2}", s.Reagents[i].Name, s.Quantity[i], s.Name);
                            return false;
                        }
                    } else
                    {
                        from.SendMessage(33,"Error in quantity specification for {0}", s.Name);
                        return false;
                    }
                }
            }
            return true;
        }</pre>

## Duplicated Code. Size: 869

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write((byte)Notoriety.Compute(beholder, beheld));

			for (int i = 0; i < eq.Count; ++i)
			{
				Item item = eq[i];

				byte layer = (byte)item.Layer;

				if (!item.Deleted && beholder.CanSee(item) && m_DupedLayers[layer] != m_Version)
				{
					m_DupedLayers[layer] = m_Version;

					hue = item.Hue;

					if (beheld.SolidHueOverride >= 0)
					{
						hue = beheld.SolidHueOverride;
					}

					int itemID = item.ItemID & 0x7FFF;
					bool writeHue = (hue != 0);

					if (writeHue)
					{
						itemID |= 0x8000;
					}

					m_Stream.Write(item.Serial);
					m_Stream.Write((ushort)itemID);
					m_Stream.Write(layer);

					if (writeHue)
					{
						m_Stream.Write((short)hue);
					}
				}
			}

			if (beheld.HairItemID > 0)
			{
				if (m_DupedLayers[(int)Layer.Hair] != m_Version)
				{
					m_DupedLayers[(int)Layer.Hair] = m_Version;
					hue = beheld.HairHue;

					if (beheld.SolidHueOverride >= 0)
					{
						hue = beheld.SolidHueOverride;
					}

					int itemID = beheld.HairItemID & 0x7FFF;

					bool writeHue = (hue != 0);

					if (writeHue)
					{
						itemID |= 0x8000;
					}

					m_Stream.Write(HairInfo.FakeSerial(beheld));
					m_Stream.Write((ushort)itemID);
					m_Stream.Write((byte)Layer.Hair);

					if (writeHue)
					{
						m_Stream.Write((short)hue);
					}
				}
			}

			if (beheld.FacialHairItemID > 0)
			{
				if (m_DupedLayers[(int)Layer.FacialHair] != m_Version)
				{
					m_DupedLayers[(int)Layer.FacialHair] = m_Version;
					hue = beheld.FacialHairHue;

					if (beheld.SolidHueOverride >= 0)
					{
						hue = beheld.SolidHueOverride;
					}

					int itemID = beheld.FacialHairItemID & 0x7FFF;

					bool writeHue = (hue != 0);

					if (writeHue)
					{
						itemID |= 0x8000;
					}

					m_Stream.Write(FacialHairInfo.FakeSerial(beheld));
					m_Stream.Write((ushort)itemID);
					m_Stream.Write((byte)Layer.FacialHair);

					if (writeHue)
					{
						m_Stream.Write((short)hue);
					}
				}
			}

			m_Stream.Write(0); // terminate</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write((byte)Notoriety.Compute(beholder, beheld));

			for (int i = 0; i < eq.Count; ++i)
			{
				Item item = eq[i];

				byte layer = (byte)item.Layer;

				if (!item.Deleted && beholder.CanSee(item) && m_DupedLayers[layer] != m_Version)
				{
					m_DupedLayers[layer] = m_Version;

					hue = item.Hue;

					if (beheld.SolidHueOverride >= 0)
					{
						hue = beheld.SolidHueOverride;
					}

					int itemID = item.ItemID & 0x7FFF;
					bool writeHue = (hue != 0);

					if (writeHue)
					{
						itemID |= 0x8000;
					}

					m_Stream.Write(item.Serial);
					m_Stream.Write((ushort)itemID);
					m_Stream.Write(layer);

					if (writeHue)
					{
						m_Stream.Write((short)hue);
					}
				}
			}

			if (beheld.HairItemID > 0)
			{
				if (m_DupedLayers[(int)Layer.Hair] != m_Version)
				{
					m_DupedLayers[(int)Layer.Hair] = m_Version;
					hue = beheld.HairHue;

					if (beheld.SolidHueOverride >= 0)
					{
						hue = beheld.SolidHueOverride;
					}

					int itemID = beheld.HairItemID & 0x7FFF;

					bool writeHue = (hue != 0);

					if (writeHue)
					{
						itemID |= 0x8000;
					}

					m_Stream.Write(HairInfo.FakeSerial(beheld));
					m_Stream.Write((ushort)itemID);
					m_Stream.Write((byte)Layer.Hair);

					if (writeHue)
					{
						m_Stream.Write((short)hue);
					}
				}
			}

			if (beheld.FacialHairItemID > 0)
			{
				if (m_DupedLayers[(int)Layer.FacialHair] != m_Version)
				{
					m_DupedLayers[(int)Layer.FacialHair] = m_Version;
					hue = beheld.FacialHairHue;

					if (beheld.SolidHueOverride >= 0)
					{
						hue = beheld.SolidHueOverride;
					}

					int itemID = beheld.FacialHairItemID & 0x7FFF;

					bool writeHue = (hue != 0);

					if (writeHue)
					{
						itemID |= 0x8000;
					}

					m_Stream.Write(FacialHairInfo.FakeSerial(beheld));
					m_Stream.Write((ushort)itemID);
					m_Stream.Write((byte)Layer.FacialHair);

					if (writeHue)
					{
						m_Stream.Write((short)hue);
					}
				}
			}

			m_Stream.Write(0); // terminate</pre>

## Duplicated Code. Size: 841

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BasketWeaving\SBSATinker.cs

<pre>public class InternalSellInfo : GenericSellInfo 
        { 
            public InternalSellInfo() 
            { 
                this.Add(typeof(Drums), 10);
                this.Add(typeof(Tambourine), 10);
                this.Add(typeof(LapHarp), 10);
                this.Add(typeof(Lute), 10);

                this.Add(typeof(Shovel), 6);
                this.Add(typeof(SewingKit), 1);
                this.Add(typeof(Scissors), 6);
                this.Add(typeof(Tongs), 7);
                this.Add(typeof(Key), 1);

                this.Add(typeof(DovetailSaw), 6);
                this.Add(typeof(MouldingPlane), 6);
                this.Add(typeof(Nails), 1);
                this.Add(typeof(JointingPlane), 6);
                this.Add(typeof(SmoothingPlane), 6);
                this.Add(typeof(Saw), 7);

                this.Add(typeof(Clock), 11);
                this.Add(typeof(ClockParts), 1);
                this.Add(typeof(AxleGears), 1);
                this.Add(typeof(Gears), 1);
                this.Add(typeof(Hinge), 1);
                this.Add(typeof(Sextant), 6);
                this.Add(typeof(SextantParts), 2);
                this.Add(typeof(Axle), 1);
                this.Add(typeof(Springs), 1);

                this.Add(typeof(DrawKnife), 5);
                this.Add(typeof(Froe), 5);
                this.Add(typeof(Inshave), 5);
                this.Add(typeof(Scorp), 5);

                this.Add(typeof(Lockpick), 6);
                this.Add(typeof(TinkerTools), 3);

                this.Add(typeof(Board), 1);
                this.Add(typeof(Log), 1);

                this.Add(typeof(Pickaxe), 16);
                this.Add(typeof(Hammer), 3);
                this.Add(typeof(SmithHammer), 11);
                this.Add(typeof(ButcherKnife), 6);
            }
        }</pre>

Fragment 2 in file Scripts\VendorInfo\SBTinker.cs

<pre>public class InternalSellInfo : GenericSellInfo 
        { 
            public InternalSellInfo() 
            { 
                this.Add(typeof(Drums), 10);
                this.Add(typeof(Tambourine), 10);
                this.Add(typeof(LapHarp), 10);
                this.Add(typeof(Lute), 10);

                this.Add(typeof(Shovel), 6);
                this.Add(typeof(SewingKit), 1);
                this.Add(typeof(Scissors), 6);
                this.Add(typeof(Tongs), 7);
                this.Add(typeof(Key), 1);

                this.Add(typeof(DovetailSaw), 6);
                this.Add(typeof(MouldingPlane), 6);
                this.Add(typeof(Nails), 1);
                this.Add(typeof(JointingPlane), 6);
                this.Add(typeof(SmoothingPlane), 6);
                this.Add(typeof(Saw), 7);

                this.Add(typeof(Clock), 11);
                this.Add(typeof(ClockParts), 1);
                this.Add(typeof(AxleGears), 1);
                this.Add(typeof(Gears), 1);
                this.Add(typeof(Hinge), 1);
                this.Add(typeof(Sextant), 6);
                this.Add(typeof(SextantParts), 2);
                this.Add(typeof(Axle), 1);
                this.Add(typeof(Springs), 1);

                this.Add(typeof(DrawKnife), 5);
                this.Add(typeof(Froe), 5);
                this.Add(typeof(Inshave), 5);
                this.Add(typeof(Scorp), 5);

                this.Add(typeof(Lockpick), 6);
                this.Add(typeof(TinkerTools), 3);

                this.Add(typeof(Board), 1);
                this.Add(typeof(Log), 1);

                this.Add(typeof(Pickaxe), 16);
                this.Add(typeof(Hammer), 3);
                this.Add(typeof(SmithHammer), 11);
                this.Add(typeof(ButcherKnife), 6);
            }
        }</pre>

## Duplicated Code. Size: 836

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBAlchemist.cs

<pre>this.Add(new GenericBuyInfo(typeof(RefreshPotion), 15, 10, 0xF0B, 0));
                this.Add(new GenericBuyInfo(typeof(AgilityPotion), 15, 10, 0xF08, 0));
                this.Add(new GenericBuyInfo(typeof(NightSightPotion), 15, 10, 0xF06, 0));
                this.Add(new GenericBuyInfo(typeof(LesserHealPotion), 15, 10, 0xF0C, 0));
                this.Add(new GenericBuyInfo(typeof(StrengthPotion), 15, 10, 0xF09, 0));
                this.Add(new GenericBuyInfo(typeof(LesserPoisonPotion), 15, 10, 0xF0A, 0));
                this.Add(new GenericBuyInfo(typeof(LesserCurePotion), 15, 10, 0xF07, 0));
                this.Add(new GenericBuyInfo(typeof(LesserExplosionPotion), 21, 10, 0xF0D, 0));
                this.Add(new GenericBuyInfo(typeof(MortarPestle), 8, 10, 0xE9B, 0));

                this.Add(new GenericBuyInfo(typeof(BlackPearl), 5, 20, 0xF7A, 0));
                this.Add(new GenericBuyInfo(typeof(Bloodmoss), 5, 20, 0xF7B, 0));
                this.Add(new GenericBuyInfo(typeof(Garlic), 3, 20, 0xF84, 0));
                this.Add(new GenericBuyInfo(typeof(Ginseng), 3, 20, 0xF85, 0));
                this.Add(new GenericBuyInfo(typeof(MandrakeRoot), 3, 20, 0xF86, 0));
                this.Add(new GenericBuyInfo(typeof(Nightshade), 3, 20, 0xF88, 0));
                this.Add(new GenericBuyInfo(typeof(SpidersSilk), 3, 20, 0xF8D, 0));
                this.Add(new GenericBuyInfo(typeof(SulfurousAsh), 3, 20, 0xF8C, 0));

                this.Add(new GenericBuyInfo(typeof(Bottle), 5, 100, 0xF0E, 0)); 
                this.Add(new GenericBuyInfo(typeof(HeatingStand), 2, 100, 0x1849, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBGlassblower.cs

<pre>this.Add(new GenericBuyInfo(typeof(RefreshPotion), 15, 10, 0xF0B, 0));
                this.Add(new GenericBuyInfo(typeof(AgilityPotion), 15, 10, 0xF08, 0));
                this.Add(new GenericBuyInfo(typeof(NightSightPotion), 15, 10, 0xF06, 0));
                this.Add(new GenericBuyInfo(typeof(LesserHealPotion), 15, 10, 0xF0C, 0));
                this.Add(new GenericBuyInfo(typeof(StrengthPotion), 15, 10, 0xF09, 0));
                this.Add(new GenericBuyInfo(typeof(LesserPoisonPotion), 15, 10, 0xF0A, 0));
                this.Add(new GenericBuyInfo(typeof(LesserCurePotion), 15, 10, 0xF07, 0));
                this.Add(new GenericBuyInfo(typeof(LesserExplosionPotion), 21, 10, 0xF0D, 0));

                this.Add(new GenericBuyInfo(typeof(MortarPestle), 8, 10, 0xE9B, 0));

                this.Add(new GenericBuyInfo(typeof(BlackPearl), 5, 20, 0xF7A, 0));
                this.Add(new GenericBuyInfo(typeof(Bloodmoss), 5, 20, 0xF7B, 0));
                this.Add(new GenericBuyInfo(typeof(Garlic), 3, 20, 0xF84, 0));
                this.Add(new GenericBuyInfo(typeof(Ginseng), 3, 20, 0xF85, 0));
                this.Add(new GenericBuyInfo(typeof(MandrakeRoot), 3, 20, 0xF86, 0));
                this.Add(new GenericBuyInfo(typeof(Nightshade), 3, 20, 0xF88, 0));
                this.Add(new GenericBuyInfo(typeof(SpidersSilk), 3, 20, 0xF8D, 0));
                this.Add(new GenericBuyInfo(typeof(SulfurousAsh), 3, 20, 0xF8C, 0));

                this.Add(new GenericBuyInfo(typeof(Bottle), 5, 100, 0xF0E, 0)); 

                this.Add(new GenericBuyInfo(typeof(HeatingStand), 2, 100, 0x1849, 0));</pre>

## Duplicated Code. Size: 804

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>if (this.m_Params[i].StartsWith("PointDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.PointDest = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MapDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.MapDest = Map.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Creatures"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Creatures = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SourceEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SourceEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("DestEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.DestEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SoundID"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SoundID = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Delay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Delay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }</pre>

Fragment 2 in file Scripts\Commands\Decorate.cs

<pre>if (this.m_Params[i].StartsWith("PointDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.PointDest = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MapDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.MapDest = Map.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Creatures"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Creatures = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SourceEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SourceEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("DestEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.DestEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SoundID"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SoundID = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Delay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Delay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }</pre>

Fragment 3 in file Scripts\Commands\DecorateDelete.cs

<pre>if (this.m_Params[i].StartsWith("PointDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.PointDest = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("MapDest"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.MapDest = Map.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Creatures"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Creatures = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SourceEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SourceEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("DestEffect"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.DestEffect = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("SoundID"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.SoundID = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Delay"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            tp.Delay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                    }</pre>

## Duplicated Code. Size: 802

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomAttacks.cs

<pre>{

                m_attachment = a;
                m_special = s;

                // prepare the page
                AddPage( 0 );

                AddBackground( 0, 0, 400, 300, 5054 );
                AddAlphaRegion( 0, 0, 400, 300 );
                AddLabel( 20, 2, 55, String.Format("{0}",s.Name) );

                StringBuilder text = new StringBuilder();

                text.AppendFormat("\n{0}", s.Description );

                text.AppendFormat("\n\nMinimum Stats/Skills:" );
                if(s.StrReq > 0)
                {
                    text.AppendFormat("\n     {0} Str", s.StrReq );
                }
                if(s.DexReq > 0)
                {
                    text.AppendFormat("\n     {0} Dex", s.DexReq );
                }
                if(s.IntReq > 0)
                {
                    text.AppendFormat("\n     {0} Int", s.IntReq );
                }

                if(s.Skills != null)
                for(int i = 0;i < s.Skills.Length;i++)
                {
                    if(i < s.MinSkillLevel.Length)
                    {
                        text.AppendFormat("\n     {1} {0}", s.Skills[i].ToString(), s.MinSkillLevel[i]  );
                    } else
                    {
                        text.AppendFormat("\n     {1} {0}", s.Skills[i].ToString(), "???"  );
                    }
                }

                text.AppendFormat("\n\nConsumes:" );

                // generate the text requirements
                if(s.ManaReq > 0)
                {
                    text.AppendFormat("\n     {0} Mana", s.ManaReq );
                }
                if(s.StamReq > 0)
                {
                    text.AppendFormat("\n     {0} Stamina", s.StamReq );
                }
                if(s.HitsReq > 0)
                {
                    text.AppendFormat("\n     {0} Hits", s.HitsReq );
                }
                if(s.KarmaReq > 0)
                {
                    text.AppendFormat("\n     {0} Karma", s.KarmaReq );
                }

                if(s.Reagents != null)
                for(int i = 0;i < s.Reagents.Length;i++)
                {
                    if(i < s.Quantity.Length)
                    {
                        text.AppendFormat("\n     {1} {0}", s.Reagents[i].Name, s.Quantity[i]  );
                    } else
                    {
                        text.AppendFormat("\n     {1} {0}", s.Reagents[i].Name, "???"  );
                    }
                }

                AddHtml( 20,20, 360, 260, text.ToString(), true , true );
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomDefenses.cs

<pre>{

                m_attachment = a;
                m_special = s;

                // prepare the page
                AddPage( 0 );

                AddBackground( 0, 0, 400, 300, 5054 );
                AddAlphaRegion( 0, 0, 400, 300 );
                AddLabel( 20, 2, 55, String.Format("{0}",s.Name) );

                StringBuilder text = new StringBuilder();

                text.AppendFormat("\n{0}", s.Description );

                text.AppendFormat("\n\nMinimum Stats/Skills:" );
                if(s.StrReq > 0)
                {
                    text.AppendFormat("\n     {0} Str", s.StrReq );
                }
                if(s.DexReq > 0)
                {
                    text.AppendFormat("\n     {0} Dex", s.DexReq );
                }
                if(s.IntReq > 0)
                {
                    text.AppendFormat("\n     {0} Int", s.IntReq );
                }

                if(s.Skills != null)
                for(int i = 0;i < s.Skills.Length;i++)
                {
                    if(i < s.MinSkillLevel.Length)
                    {
                        text.AppendFormat("\n     {1} {0}", s.Skills[i].ToString(), s.MinSkillLevel[i]  );
                    } else
                    {
                        text.AppendFormat("\n     {1} {0}", s.Skills[i].ToString(), "???"  );
                    }
                }

                text.AppendFormat("\n\nConsumes:" );

                // generate the text requirements
                if(s.ManaReq > 0)
                {
                    text.AppendFormat("\n     {0} Mana", s.ManaReq );
                }
                if(s.StamReq > 0)
                {
                    text.AppendFormat("\n     {0} Stamina", s.StamReq );
                }
                if(s.HitsReq > 0)
                {
                    text.AppendFormat("\n     {0} Hits", s.HitsReq );
                }
                if(s.KarmaReq > 0)
                {
                    text.AppendFormat("\n     {0} Karma", s.KarmaReq );
                }

                if(s.Reagents != null)
                for(int i = 0;i < s.Reagents.Length;i++)
                {
                    if(i < s.Quantity.Length)
                    {
                        text.AppendFormat("\n     {1} {0}", s.Reagents[i].Name, s.Quantity[i]  );
                    } else
                    {
                        text.AppendFormat("\n     {1} {0}", s.Reagents[i].Name, "???"  );
                    }
                }

                AddHtml( 20,20, 360, 260, text.ToString(), true , true );
            }</pre>

## Duplicated Code. Size: 800

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGauntlet.cs

<pre>{
                if(entry.Participant == null || entry.Status == ChallengeStatus.Forfeit || entry.Status == ChallengeStatus.Disqualified) continue;

                bool hadcaution = (entry.Caution != ChallengeStatus.None);

                // and a map check
                if(entry.Participant.Map != Map)
                {
                    // check to see if they are offline
                    if(entry.Participant.Map == Map.Internal)
                    {
                        // then give them a little time to return before disqualification
                        if(entry.Caution == ChallengeStatus.Offline)
                        {
                            // were previously out of bounds so check for disqualification
                            // check to see how long they have been out of bounds
                            if(DateTime.UtcNow - entry.LastCaution > MaximumOfflineDuration)
                            {
                                entry.Status = ChallengeStatus.Disqualified;
                                GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                                RefreshSymmetricNoto(entry.Participant);
                                statuschange = true;
                            }
                        } else
                        {
                            entry.LastCaution  = DateTime.UtcNow;
                            statuschange = true;
                        }

                        entry.Caution = ChallengeStatus.Offline;
                    } else
                    {
                        // changing to any other map is instant disqualification
                        entry.Status = ChallengeStatus.Disqualified;
                        GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                        RefreshSymmetricNoto(entry.Participant);
                        statuschange = true;
                    }

                } else
                // make a range check
                if(m_ArenaSize > 0 && !Utility.InRange(entry.Participant.Location, Location, m_ArenaSize)
                || (IsInChallengeGameRegion && !(Region.Find(entry.Participant.Location, entry.Participant.Map) is ChallengeGameRegion)))
                {
                    if(entry.Caution == ChallengeStatus.OutOfBounds)
                    {
                        // were previously out of bounds so check for disqualification
                        // check to see how long they have been out of bounds
                        if(DateTime.UtcNow - entry.LastCaution > MaximumOutOfBoundsDuration)
                        {
                            entry.Status = ChallengeStatus.Disqualified;
                            GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                            RefreshSymmetricNoto(entry.Participant);
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100309, MaximumOutOfBoundsDuration.TotalSeconds);  // "You are out of bounds!  You have {0} seconds to return"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.OutOfBounds;

                } else
                // make a hiding check
                if(entry.Participant.Hidden)
                {
                    if(entry.Caution == ChallengeStatus.Hidden)
                    {
                        // were previously hidden so check for disqualification
                        // check to see how long they have hidden
                        if(DateTime.UtcNow - entry.LastCaution > MaximumHiddenDuration)
                        {
                            entry.Status = ChallengeStatus.Disqualified;
                            GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                            RefreshSymmetricNoto(entry.Participant);
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100310, MaximumHiddenDuration.TotalSeconds); // "You have {0} seconds become unhidden"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.Hidden;

                } else
                {
                    entry.Caution = ChallengeStatus.None;
                }

                if(hadcaution && entry.Caution == ChallengeStatus.None)
                    statuschange = true;

            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGauntlet.cs

<pre>{
                if(entry.Participant == null || entry.Status == ChallengeStatus.Forfeit || entry.Status == ChallengeStatus.Disqualified) continue;

                bool hadcaution = (entry.Caution != ChallengeStatus.None);

                // and a map check
                if(entry.Participant.Map != Map)
                {
                    // check to see if they are offline
                    if(entry.Participant.Map == Map.Internal)
                    {
                        // then give them a little time to return before disqualification
                        if(entry.Caution == ChallengeStatus.Offline)
                        {
                            // were previously out of bounds so check for disqualification
                            // check to see how long they have been out of bounds
                            if(DateTime.UtcNow - entry.LastCaution > MaximumOfflineDuration)
                            {
                                entry.Status = ChallengeStatus.Disqualified;
                                GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                                RefreshSymmetricNoto(entry.Participant);
                                statuschange = true;
                            }
                        } else
                        {
                            entry.LastCaution  = DateTime.UtcNow;
                            statuschange = true;
                        }

                        entry.Caution = ChallengeStatus.Offline;
                    } else
                    {
                        // changing to any other map is instant disqualification
                        entry.Status = ChallengeStatus.Disqualified;
                        GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                        RefreshSymmetricNoto(entry.Participant);
                        statuschange = true;
                    }

                } else
                // make a range check
                if(m_ArenaSize > 0 && !Utility.InRange(entry.Participant.Location, Location, m_ArenaSize)
                || (IsInChallengeGameRegion && !(Region.Find(entry.Participant.Location, entry.Participant.Map) is ChallengeGameRegion)))
                {
                    if(entry.Caution == ChallengeStatus.OutOfBounds)
                    {
                        // were previously out of bounds so check for disqualification
                        // check to see how long they have been out of bounds
                        if(DateTime.UtcNow - entry.LastCaution > MaximumOutOfBoundsDuration)
                        {
                            entry.Status = ChallengeStatus.Disqualified;
                            GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                            RefreshSymmetricNoto(entry.Participant);
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100309, MaximumOutOfBoundsDuration.TotalSeconds);  // "You are out of bounds!  You have {0} seconds to return"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.OutOfBounds;

                } else
                // make a hiding check
                if(entry.Participant.Hidden)
                {
                    if(entry.Caution == ChallengeStatus.Hidden)
                    {
                        // were previously hidden so check for disqualification
                        // check to see how long they have hidden
                        if(DateTime.UtcNow - entry.LastCaution > MaximumHiddenDuration)
                        {
                            entry.Status = ChallengeStatus.Disqualified;
                            GameBroadcast(100308, entry.Participant.Name);  // "{0} has been disqualified"
                            RefreshSymmetricNoto(entry.Participant);
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100310, MaximumHiddenDuration.TotalSeconds); // "You have {0} seconds become unhidden"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.Hidden;

                } else
                {
                    entry.Caution = ChallengeStatus.None;
                }

                if(hadcaution && entry.Caution == ChallengeStatus.None)
                    statuschange = true;

            }</pre>

## Duplicated Code. Size: 774

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGauntlet.cs

<pre>if(Participants == null || !GameInProgress) return;

             bool statuschange = false;

            foreach(ChallengeEntry entry in Participants)
            {
                if(entry.Participant == null || entry.Status != ChallengeStatus.Active) continue;

                bool hadcaution = (entry.Caution != ChallengeStatus.None);

                // and a map check
                if(entry.Participant.Map != Map)
                {
                    // check to see if they are offline
                    if(entry.Participant.Map == Map.Internal)
                    {
                        // then give them a little time to return before disqualification
                        if(entry.Caution == ChallengeStatus.Offline)
                        {
                            // were previously out of bounds so check for disqualification
                            // check to see how long they have been out of bounds
                            if(DateTime.UtcNow - entry.LastCaution > MaximumOfflineDuration)
                            {
                                // penalize them
                                SubtractScore(entry);
                                entry.LastCaution  = DateTime.UtcNow;
                            }
                        } else
                        {
                            entry.LastCaution  = DateTime.UtcNow;
                            statuschange = true;
                        }

                        entry.Caution = ChallengeStatus.Offline;

                    } else
                    {
                        // changing to any other map results in instant
                        // teleport back to the gauntlet
                        // and point loss
                        RespawnWithPenalty(entry);
                        entry.Caution = ChallengeStatus.None;
                    }

                } else
                // make a range check
                if(m_ArenaSize > 0 && !Utility.InRange(entry.Participant.Location, Location, m_ArenaSize)
                || (IsInChallengeGameRegion && !(Region.Find(entry.Participant.Location, entry.Participant.Map) is ChallengeGameRegion)))
                {
                    if(entry.Caution == ChallengeStatus.OutOfBounds)
                    {
                        // were previously out of bounds so check for disqualification
                        // check to see how long they have been out of bounds
                        if(DateTime.UtcNow - entry.LastCaution > MaximumOutOfBoundsDuration)
                        {
                            // teleport them back to the gauntlet
                            RespawnWithPenalty(entry);
                            GameBroadcast(100401, entry.Participant.Name);  // "{0} was penalized."
                            entry.Caution = ChallengeStatus.None;
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100309, MaximumOutOfBoundsDuration.TotalSeconds);  // "You are out of bounds!  You have {0} seconds to return"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.OutOfBounds;

                } else
                // make a hiding check
                if(entry.Participant.Hidden)
                {
                    if(entry.Caution == ChallengeStatus.Hidden)
                    {
                        // were previously hidden so check for disqualification
                        // check to see how long they have hidden
                        if(DateTime.UtcNow - entry.LastCaution > MaximumHiddenDuration)
                        {
                            // penalize them
                            SubtractScore(entry);
                            entry.Participant.Hidden = false;
                            GameBroadcast(100401, entry.Participant.Name);  // "{0} was penalized."
                            entry.Caution = ChallengeStatus.None;
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100310, MaximumHiddenDuration.TotalSeconds); // "You have {0} seconds become unhidden"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.Hidden;

                } else
                {
                    entry.Caution = ChallengeStatus.None;
                }

                if(hadcaution && entry.Caution == ChallengeStatus.None)
                    statuschange = true;

            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGauntlet.cs

<pre>if(Participants == null || !GameInProgress) return;

             bool statuschange = false;

            foreach(ChallengeEntry entry in Participants)
            {
                if(entry.Participant == null || entry.Status != ChallengeStatus.Active) continue;

                bool hadcaution = (entry.Caution != ChallengeStatus.None);

                // and a map check
                if(entry.Participant.Map != Map)
                {
                    // check to see if they are offline
                    if(entry.Participant.Map == Map.Internal)
                    {
                        // then give them a little time to return before disqualification
                        if(entry.Caution == ChallengeStatus.Offline)
                        {
                            // were previously out of bounds so check for disqualification
                            // check to see how long they have been out of bounds
                            if(DateTime.UtcNow - entry.LastCaution > MaximumOfflineDuration)
                            {
                                // penalize them
                                SubtractScore(entry);
                                entry.LastCaution  = DateTime.UtcNow;
                            }
                        } else
                        {
                            entry.LastCaution  = DateTime.UtcNow;
                            statuschange = true;
                        }

                        entry.Caution = ChallengeStatus.Offline;

                    } else
                    {
                        // changing to any other map results in instant
                        // teleport back to the gauntlet
                        // and point loss
                        RespawnWithPenalty(entry);
                        entry.Caution = ChallengeStatus.None;
                    }

                } else
                // make a range check
                if(m_ArenaSize > 0 && !Utility.InRange(entry.Participant.Location, Location, m_ArenaSize)
                || (IsInChallengeGameRegion && !(Region.Find(entry.Participant.Location, entry.Participant.Map) is ChallengeGameRegion)))
                {
                    if(entry.Caution == ChallengeStatus.OutOfBounds)
                    {
                        // were previously out of bounds so check for disqualification
                        // check to see how long they have been out of bounds
                        if(DateTime.UtcNow - entry.LastCaution > MaximumOutOfBoundsDuration)
                        {
                            // teleport them back to the gauntlet
                            RespawnWithPenalty(entry);
                            GameBroadcast(100401, entry.Participant.Name);  // "{0} was penalized."
                            entry.Caution = ChallengeStatus.None;
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100309, MaximumOutOfBoundsDuration.TotalSeconds);  // "You are out of bounds!  You have {0} seconds to return"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.OutOfBounds;

                } else
                // make a hiding check
                if(entry.Participant.Hidden)
                {
                    if(entry.Caution == ChallengeStatus.Hidden)
                    {
                        // were previously hidden so check for disqualification
                        // check to see how long they have hidden
                        if(DateTime.UtcNow - entry.LastCaution > MaximumHiddenDuration)
                        {
                            // penalize them
                            SubtractScore(entry);
                            entry.Participant.Hidden = false;
                            GameBroadcast(100401, entry.Participant.Name);  // "{0} was penalized."
                            entry.Caution = ChallengeStatus.None;
                            statuschange = true;
                        }
                    } else
                    {
                        entry.LastCaution  = DateTime.UtcNow;
                        // inform the player
                        XmlPoints.SendText(entry.Participant, 100310, MaximumHiddenDuration.TotalSeconds); // "You have {0} seconds become unhidden"
                        statuschange = true;
                    }

                    entry.Caution = ChallengeStatus.Hidden;

                } else
                {
                    entry.Caution = ChallengeStatus.None;
                }

                if(hadcaution && entry.Caution == ChallengeStatus.None)
                    statuschange = true;

            }</pre>

## Duplicated Code. Size: 761

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z + 4), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z - 4), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z + 4), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z - 4), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z + 11), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z + 7), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z + 3), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x3728, 13, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x228);</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z + 4), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z - 4), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z + 4), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z - 4), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z + 11), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z + 7), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z + 3), m.Map, 0x3728, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x3728, 13, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x228);</pre>

## Duplicated Code. Size: 761

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z + 6), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z + 6), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z + 8), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z + 6), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z + 11), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z + 8), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z + 10), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x3709, 15, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x15E);</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z + 6), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z + 6), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z + 8), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z + 6), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z + 11), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z + 8), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z + 10), m.Map, 0x36D4, 13, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x3709, 15, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x15E);</pre>

## Duplicated Code. Size: 761

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Glasses\GargishGlasses.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Glasses\Glasses.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Glasses\ElvenGlasses.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\BandanaBearingTheCrestOfBlackthorn.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\BascinetBearingTheCrestOfBlackthorn.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\CircletBearingTheCrestOfBlackthorn.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 7 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\FeatheredHatBearingTheCrestOfBlackthorn.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 8 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\GargishEarringsBearingTheCrestOfBlackthorn.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 9 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\JesterHatBearingTheCrestOfBlackthorn.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 10 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\NorseHelmBearingTheCrestOfBlackthorn.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 11 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\PlateHelmBearingTheCrestOfBlackthorn.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 12 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\RoyalCircletBearingTheCrestOfBlackthorn.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 13 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\SkullcapBearingTheCrestOfBlackthorn.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 14 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\TricorneHatBearingTheCrestOfBlackthorn.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

Fragment 15 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\WizardsHatBearingTheCrestOfBlackthorn.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitColdArea) != 0)
                list.Add(1060416, prop.ToString()); // hit cold area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitDispel) != 0)
                list.Add(1060417, prop.ToString()); // hit dispel ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitEnergyArea) != 0)
                list.Add(1060418, prop.ToString()); // hit energy area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireArea) != 0)
                list.Add(1060419, prop.ToString()); // hit fire area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString()); // hit fireball ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitHarm) != 0)
                list.Add(1060421, prop.ToString()); // hit harm ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechHits) != 0)
                list.Add(1060422, prop.ToString()); // hit life leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLightning) != 0)
                list.Add(1060423, prop.ToString()); // hit lightning ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerAttack) != 0)
                list.Add(1060424, prop.ToString()); // hit lower attack ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLowerDefend) != 0)
                list.Add(1060425, prop.ToString()); // hit lower defense ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitMagicArrow) != 0)
                list.Add(1060426, prop.ToString()); // hit magic arrow ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechMana) != 0)
                list.Add(1060427, prop.ToString()); // hit mana leech ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPhysicalArea) != 0)
                list.Add(1060428, prop.ToString()); // hit physical area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitPoisonArea) != 0)
                list.Add(1060429, prop.ToString()); // hit poison area ~1_val~%

            if ((prop = this.m_AosWeaponAttributes.HitLeechStam) != 0)
                list.Add(1060430, prop.ToString()); // hit stamina leech ~1_val~%
        }</pre>

## Duplicated Code. Size: 748

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBMage.cs

<pre>this.Add(new GenericBuyInfo(typeof(RecallRune), 15, 10, 0x1F14, 0));

                this.Add(new GenericBuyInfo(typeof(RefreshPotion), 15, 10, 0xF0B, 0));
                this.Add(new GenericBuyInfo(typeof(AgilityPotion), 15, 10, 0xF08, 0));
                this.Add(new GenericBuyInfo(typeof(NightSightPotion), 15, 10, 0xF06, 0));
                this.Add(new GenericBuyInfo(typeof(LesserHealPotion), 15, 10, 0xF0C, 0));
                this.Add(new GenericBuyInfo(typeof(StrengthPotion), 15, 10, 0xF09, 0));
                this.Add(new GenericBuyInfo(typeof(LesserPoisonPotion), 15, 10, 0xF0A, 0));
                this.Add(new GenericBuyInfo(typeof(LesserCurePotion), 15, 10, 0xF07, 0));
                this.Add(new GenericBuyInfo(typeof(LesserExplosionPotion), 21, 10, 0xF0D, 0));

                this.Add(new GenericBuyInfo(typeof(BlackPearl), 5, 20, 0xF7A, 0));
                this.Add(new GenericBuyInfo(typeof(Bloodmoss), 5, 20, 0xF7B, 0));
                this.Add(new GenericBuyInfo(typeof(Garlic), 3, 20, 0xF84, 0));
                this.Add(new GenericBuyInfo(typeof(Ginseng), 3, 20, 0xF85, 0));
                this.Add(new GenericBuyInfo(typeof(MandrakeRoot), 3, 20, 0xF86, 0));
                this.Add(new GenericBuyInfo(typeof(Nightshade), 3, 20, 0xF88, 0));
                this.Add(new GenericBuyInfo(typeof(SpidersSilk), 3, 20, 0xF8D, 0));
                this.Add(new GenericBuyInfo(typeof(SulfurousAsh), 3, 20, 0xF8C, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBMystic.cs

<pre>this.Add(new GenericBuyInfo(typeof(RecallRune), 15, 10, 0x1F14, 0));

                this.Add(new GenericBuyInfo(typeof(RefreshPotion), 15, 10, 0xF0B, 0));
                this.Add(new GenericBuyInfo(typeof(AgilityPotion), 15, 10, 0xF08, 0));
                this.Add(new GenericBuyInfo(typeof(NightSightPotion), 15, 10, 0xF06, 0));
                this.Add(new GenericBuyInfo(typeof(LesserHealPotion), 15, 10, 0xF0C, 0));
                this.Add(new GenericBuyInfo(typeof(StrengthPotion), 15, 10, 0xF09, 0));
                this.Add(new GenericBuyInfo(typeof(LesserPoisonPotion), 15, 10, 0xF0A, 0));
                this.Add(new GenericBuyInfo(typeof(LesserCurePotion), 15, 10, 0xF07, 0));
                this.Add(new GenericBuyInfo(typeof(LesserExplosionPotion), 21, 10, 0xF0D, 0));

                this.Add(new GenericBuyInfo(typeof(BlackPearl), 5, 20, 0xF7A, 0));
                this.Add(new GenericBuyInfo(typeof(Bloodmoss), 5, 20, 0xF7B, 0));
                this.Add(new GenericBuyInfo(typeof(Garlic), 3, 20, 0xF84, 0));
                this.Add(new GenericBuyInfo(typeof(Ginseng), 3, 20, 0xF85, 0));
                this.Add(new GenericBuyInfo(typeof(MandrakeRoot), 3, 20, 0xF86, 0));
                this.Add(new GenericBuyInfo(typeof(Nightshade), 3, 20, 0xF88, 0));
                this.Add(new GenericBuyInfo(typeof(SulfurousAsh), 3, 20, 0xF8C, 0));
                this.Add(new GenericBuyInfo(typeof(SpidersSilk), 3, 20, 0xF8D, 0));</pre>

## Duplicated Code. Size: 744

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Artifacts.cs

<pre>{
			Hue = 2955;

            switch (Utility.Random(15))
            {
                case 0: SetProtection(typeof(BaseEodonTribesman), new TextDefinition(1156291), 40); break;
                case 1: SetProtection(typeof(MyrmidexLarvae), new TextDefinition(1156276), 40); break;
                case 2: SetProtection(typeof(SilverbackGorilla), new TextDefinition(1156292), 40); break;
                case 3: SetProtection(typeof(Infernus), new TextDefinition(1156278), 40); break;
                case 4: SetProtection(typeof(Dimetrosaur), new TextDefinition(1156279), 40); break;
                case 5: SetProtection(typeof(Allosaurus), new TextDefinition(1156280), 40); break;
                case 6: SetProtection(typeof(Gallusaurus), new TextDefinition(1156281), 40); break;
                case 7: SetProtection(typeof(Archaeosaurus), new TextDefinition(1156282), 40); break;
                case 8: SetProtection(typeof(Najasaurus), new TextDefinition(1156283), 40); break;
                case 9: SetProtection(typeof(Anchisaur), new TextDefinition(1156284), 40); break;
                case 10: SetProtection(typeof(DragonTurtleHatchling), new TextDefinition(1156285), 40); break;
                case 11: SetProtection(typeof(WildTiger), new TextDefinition(1156286), 40); break;
                case 12: SetProtection(typeof(Saurosaurus), new TextDefinition(1156289), 40); break;
                case 13: SetProtection(typeof(GreaterPhoenix), new TextDefinition(1156293), 40); break;
                case 14: SetProtection(typeof(DragonTurtle), new TextDefinition(1156238), 40); break;
                case 15: SetProtection(typeof(MyrmidexDrone), new TextDefinition(1156134), 40); break;
                case 16: SetProtection(typeof(MyrmidexWarrior), new TextDefinition(1156135), 40); break;
            }
		}</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Artifacts.cs

<pre>{
            Hue = 2955;

            switch (Utility.Random(15))
            {
                case 0: SetProtection(typeof(BaseEodonTribesman), new TextDefinition(1156291), 40); break;
                case 1: SetProtection(typeof(MyrmidexLarvae), new TextDefinition(1156276), 40); break;
                case 2: SetProtection(typeof(SilverbackGorilla), new TextDefinition(1156292), 40); break;
                case 3: SetProtection(typeof(Infernus), new TextDefinition(1156278), 40); break;
                case 4: SetProtection(typeof(Dimetrosaur), new TextDefinition(1156279), 40); break;
                case 5: SetProtection(typeof(Allosaurus), new TextDefinition(1156280), 40); break;
                case 6: SetProtection(typeof(Gallusaurus), new TextDefinition(1156281), 40); break;
                case 7: SetProtection(typeof(Archaeosaurus), new TextDefinition(1156282), 40); break;
                case 8: SetProtection(typeof(Najasaurus), new TextDefinition(1156283), 40); break;
                case 9: SetProtection(typeof(Anchisaur), new TextDefinition(1156284), 40); break;
                case 10: SetProtection(typeof(DragonTurtleHatchling), new TextDefinition(1156285), 40); break;
                case 11: SetProtection(typeof(WildTiger), new TextDefinition(1156286), 40); break;
                case 12: SetProtection(typeof(Saurosaurus), new TextDefinition(1156289), 40); break;
                case 13: SetProtection(typeof(GreaterPhoenix), new TextDefinition(1156293), 40); break;
                case 14: SetProtection(typeof(DragonTurtle), new TextDefinition(1156238), 40); break;
                case 15: SetProtection(typeof(MyrmidexDrone), new TextDefinition(1156134), 40); break;
                case 16: SetProtection(typeof(MyrmidexWarrior), new TextDefinition(1156135), 40); break;
            }
        }</pre>

## Duplicated Code. Size: 714

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DoorGenDelete.cs

<pre>private static readonly Rectangle2D[] m_BritRegions = new Rectangle2D[]
        {
            new Rectangle2D(new Point2D(250, 750), new Point2D(775, 1330)),
            new Rectangle2D(new Point2D(525, 2095), new Point2D(925, 2430)),
            new Rectangle2D(new Point2D(1025, 2155), new Point2D(1265, 2310)),
            new Rectangle2D(new Point2D(1635, 2430), new Point2D(1705, 2508)),
            new Rectangle2D(new Point2D(1775, 2605), new Point2D(2165, 2975)),
            new Rectangle2D(new Point2D(1055, 3520), new Point2D(1570, 4075)),
            new Rectangle2D(new Point2D(2860, 3310), new Point2D(3120, 3630)),
            new Rectangle2D(new Point2D(2470, 1855), new Point2D(3950, 3045)),
            new Rectangle2D(new Point2D(3425, 990), new Point2D(3900, 1455)),
            new Rectangle2D(new Point2D(4175, 735), new Point2D(4840, 1600)),
            new Rectangle2D(new Point2D(2375, 330), new Point2D(3100, 1045)),
            new Rectangle2D(new Point2D(2100, 1090), new Point2D(2310, 1450)),
            new Rectangle2D(new Point2D(1495, 1400), new Point2D(1550, 1475)),
            new Rectangle2D(new Point2D(1085, 1520), new Point2D(1415, 1910)),
            new Rectangle2D(new Point2D(1410, 1500), new Point2D(1745, 1795)),
            new Rectangle2D(new Point2D(5120, 2300), new Point2D(6143, 4095))
        };</pre>

Fragment 2 in file Scripts\Commands\DoorGenerator.cs

<pre>private static readonly Rectangle2D[] m_BritRegions = new Rectangle2D[]
        {
            new Rectangle2D(new Point2D(250, 750), new Point2D(775, 1330)),
            new Rectangle2D(new Point2D(525, 2095), new Point2D(925, 2430)),
            new Rectangle2D(new Point2D(1025, 2155), new Point2D(1265, 2310)),
            new Rectangle2D(new Point2D(1635, 2430), new Point2D(1705, 2508)),
            new Rectangle2D(new Point2D(1775, 2605), new Point2D(2165, 2975)),
            new Rectangle2D(new Point2D(1055, 3520), new Point2D(1570, 4075)),
            new Rectangle2D(new Point2D(2860, 3310), new Point2D(3120, 3630)),
            new Rectangle2D(new Point2D(2470, 1855), new Point2D(3950, 3045)),
            new Rectangle2D(new Point2D(3425, 990), new Point2D(3900, 1455)),
            new Rectangle2D(new Point2D(4175, 735), new Point2D(4840, 1600)),
            new Rectangle2D(new Point2D(2375, 330), new Point2D(3100, 1045)),
            new Rectangle2D(new Point2D(2100, 1090), new Point2D(2310, 1450)),
            new Rectangle2D(new Point2D(1495, 1400), new Point2D(1550, 1475)),
            new Rectangle2D(new Point2D(1085, 1520), new Point2D(1415, 1910)),
            new Rectangle2D(new Point2D(1410, 1500), new Point2D(1745, 1795)),
            new Rectangle2D(new Point2D(5120, 2300), new Point2D(6143, 4095))
        };</pre>

## Duplicated Code. Size: 697

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>public static void ExecuteAction(Mobile trigmob, object attachedto, string action)
		{
			Point3D loc = Point3D.Zero;
			Map map = null;
			if (attachedto is IEntity)
			{
				loc = ((IEntity)attachedto).Location;
				map = ((IEntity)attachedto).Map;
			}

			if (action == null || action.Length <= 0 || attachedto == null || map == null) return;

			string status_str = null;
			Server.Mobiles.XmlSpawner.SpawnObject TheSpawn = new Server.Mobiles.XmlSpawner.SpawnObject(null, 0);

			TheSpawn.TypeName = action;
			string substitutedtypeName = BaseXmlSpawner.ApplySubstitution(null, attachedto, trigmob, action);
			string typeName = BaseXmlSpawner.ParseObjectType(substitutedtypeName);

			if (BaseXmlSpawner.IsTypeOrItemKeyword(typeName))
			{
				BaseXmlSpawner.SpawnTypeKeyword(attachedto, TheSpawn, typeName, substitutedtypeName, true, trigmob, loc, map, out status_str);
			}
			else
			{
				// its a regular type descriptor so find out what it is
				Type type = SpawnerType.GetType(typeName);
				try
				{
					string[] arglist = BaseXmlSpawner.ParseString(substitutedtypeName, 3, "/");
					object o = Server.Mobiles.XmlSpawner.CreateObject(type, arglist[0]);

					if (o == null)
					{
						status_str = "invalid type specification: " + arglist[0];
					}
					else
						if (o is Mobile)
						{
							Mobile m = (Mobile)o;
							if (m is BaseCreature)
							{
								BaseCreature c = (BaseCreature)m;
								c.Home = loc; // Spawners location is the home point
							}

							m.Location = loc;
							m.Map = map;

							BaseXmlSpawner.ApplyObjectStringProperties(null, substitutedtypeName, m, trigmob, attachedto, out status_str);
						}
						else
							if (o is Item)
							{
								Item item = (Item)o;
								BaseXmlSpawner.AddSpawnItem(null, attachedto, TheSpawn, item, loc, map, trigmob, false, substitutedtypeName, out status_str);
							}
				}
				catch { }
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>public static void ExecuteAction(object attachedto, Mobile trigmob, string action)
		{
			Point3D loc = Point3D.Zero;
			Map map = null;
			if (attachedto is IEntity)
			{
				loc = ((IEntity)attachedto).Location;
				map = ((IEntity)attachedto).Map;
			}

			if (action == null || action.Length <= 0 || attachedto == null || map == null) return;

			string status_str = null;
			Server.Mobiles.XmlSpawner.SpawnObject TheSpawn = new Server.Mobiles.XmlSpawner.SpawnObject(null, 0);

			TheSpawn.TypeName = action;
			string substitutedtypeName = BaseXmlSpawner.ApplySubstitution(null, attachedto, trigmob, action);
			string typeName = BaseXmlSpawner.ParseObjectType(substitutedtypeName);

			if (BaseXmlSpawner.IsTypeOrItemKeyword(typeName))
			{
				BaseXmlSpawner.SpawnTypeKeyword(attachedto, TheSpawn, typeName, substitutedtypeName, true, trigmob, loc, map, out status_str);
			}
			else
			{
				// its a regular type descriptor so find out what it is
				Type type = SpawnerType.GetType(typeName);
				try
				{
					string[] arglist = BaseXmlSpawner.ParseString(substitutedtypeName, 3, "/");
					object o = Server.Mobiles.XmlSpawner.CreateObject(type, arglist[0]);

					if (o == null)
					{
						status_str = "invalid type specification: " + arglist[0];
					}
					else
						if (o is Mobile)
						{
							Mobile m = (Mobile)o;
							if (m is BaseCreature)
							{
								BaseCreature c = (BaseCreature)m;
								c.Home = loc; // Spawners location is the home point
							}

							m.Location = loc;
							m.Map = map;

							BaseXmlSpawner.ApplyObjectStringProperties(null, substitutedtypeName, m, trigmob, attachedto, out status_str);
						}
						else
							if (o is Item)
							{
								Item item = (Item)o;
								BaseXmlSpawner.AddSpawnItem(null, attachedto, TheSpawn, item, loc, map, trigmob, false, substitutedtypeName, out status_str);
							}
				}
				catch { }
			}
		}</pre>

## Duplicated Code. Size: 680

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBarkeeper.cs

<pre>public class InternalSellInfo : GenericSellInfo
        {
            public InternalSellInfo()
            {
                this.Add(typeof(WoodenBowlOfCarrots), 1);
                this.Add(typeof(WoodenBowlOfCorn), 1);
                this.Add(typeof(WoodenBowlOfLettuce), 1);
                this.Add(typeof(WoodenBowlOfPeas), 1);
                this.Add(typeof(EmptyPewterBowl), 1);
                this.Add(typeof(PewterBowlOfCorn), 1);
                this.Add(typeof(PewterBowlOfLettuce), 1);
                this.Add(typeof(PewterBowlOfPeas), 1);
                this.Add(typeof(PewterBowlOfPotatos), 1);
                this.Add(typeof(WoodenBowlOfStew), 1);
                this.Add(typeof(WoodenBowlOfTomatoSoup), 1);
                this.Add(typeof(BeverageBottle), 3);
                this.Add(typeof(Jug), 6);
                this.Add(typeof(Pitcher), 5);
                this.Add(typeof(GlassMug), 1);
                this.Add(typeof(BreadLoaf), 3);
                this.Add(typeof(CheeseWheel), 12);
                this.Add(typeof(Ribs), 6);
                this.Add(typeof(Peach), 1);
                this.Add(typeof(Pear), 1);
                this.Add(typeof(Grapes), 1);
                this.Add(typeof(Apple), 1);
                this.Add(typeof(Banana), 1);
                this.Add(typeof(Candle), 3);
                this.Add(typeof(Chessboard), 1);
                this.Add(typeof(CheckerBoard), 1);
                this.Add(typeof(Backgammon), 1);
                this.Add(typeof(Dices), 1);
                this.Add(typeof(ContractOfEmployment), 626);
            }
        }</pre>

Fragment 2 in file Scripts\VendorInfo\SBTavernKeeper.cs

<pre>public class InternalSellInfo : GenericSellInfo
        {
            public InternalSellInfo()
            {
                this.Add(typeof(WoodenBowlOfCarrots), 1);
                this.Add(typeof(WoodenBowlOfCorn), 1);
                this.Add(typeof(WoodenBowlOfLettuce), 1);
                this.Add(typeof(WoodenBowlOfPeas), 1);
                this.Add(typeof(EmptyPewterBowl), 1);
                this.Add(typeof(PewterBowlOfCorn), 1);
                this.Add(typeof(PewterBowlOfLettuce), 1);
                this.Add(typeof(PewterBowlOfPeas), 1);
                this.Add(typeof(PewterBowlOfPotatos), 1);
                this.Add(typeof(WoodenBowlOfStew), 1);
                this.Add(typeof(WoodenBowlOfTomatoSoup), 1);
                this.Add(typeof(BeverageBottle), 3);
                this.Add(typeof(Jug), 6);
                this.Add(typeof(Pitcher), 5);
                this.Add(typeof(GlassMug), 1);
                this.Add(typeof(BreadLoaf), 3);
                this.Add(typeof(CheeseWheel), 12);
                this.Add(typeof(Ribs), 6);
                this.Add(typeof(Peach), 1);
                this.Add(typeof(Pear), 1);
                this.Add(typeof(Grapes), 1);
                this.Add(typeof(Apple), 1);
                this.Add(typeof(Banana), 1);
                this.Add(typeof(Candle), 3);
                this.Add(typeof(Chessboard), 1);
                this.Add(typeof(CheckerBoard), 1);
                this.Add(typeof(Backgammon), 1);
                this.Add(typeof(Dices), 1);
                this.Add(typeof(ContractOfEmployment), 626);
            }
        }</pre>

## Duplicated Code. Size: 672

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BasketWeaving\SBSATinker.cs

<pre>this.Add(new GenericBuyInfo(typeof(Clock), 22, 20, 0x104B, 0));
                this.Add(new GenericBuyInfo(typeof(Nails), 3, 20, 0x102E, 0));
                this.Add(new GenericBuyInfo(typeof(ClockParts), 3, 20, 0x104F, 0));
                this.Add(new GenericBuyInfo(typeof(AxleGears), 3, 20, 0x1051, 0));
                this.Add(new GenericBuyInfo(typeof(Gears), 2, 20, 0x1053, 0));
                this.Add(new GenericBuyInfo(typeof(Hinge), 2, 20, 0x1055, 0));

                this.Add(new GenericBuyInfo(typeof(Sextant), 13, 20, 0x1057, 0));
                this.Add(new GenericBuyInfo(typeof(SextantParts), 5, 20, 0x1059, 0));
                this.Add(new GenericBuyInfo(typeof(Axle), 2, 20, 0x105B, 0));
                this.Add(new GenericBuyInfo(typeof(Springs), 3, 20, 0x105D, 0));

                this.Add(new GenericBuyInfo("1024111", typeof(Key), 8, 20, 0x100F, 0));
                this.Add(new GenericBuyInfo("1024112", typeof(Key), 8, 20, 0x1010, 0));
                this.Add(new GenericBuyInfo("1024115", typeof(Key), 8, 20, 0x1013, 0));
                this.Add(new GenericBuyInfo(typeof(KeyRing), 8, 20, 0x1010, 0));
                this.Add(new GenericBuyInfo(typeof(Lockpick), 12, 20, 0x14FC, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBTinker.cs

<pre>this.Add(new GenericBuyInfo(typeof(Clock), 22, 20, 0x104B, 0));
                this.Add(new GenericBuyInfo(typeof(Nails), 3, 20, 0x102E, 0));
                this.Add(new GenericBuyInfo(typeof(ClockParts), 3, 20, 0x104F, 0));
                this.Add(new GenericBuyInfo(typeof(AxleGears), 3, 20, 0x1051, 0));
                this.Add(new GenericBuyInfo(typeof(Gears), 2, 20, 0x1053, 0));
                this.Add(new GenericBuyInfo(typeof(Hinge), 2, 20, 0x1055, 0));

                this.Add(new GenericBuyInfo(typeof(Sextant), 13, 20, 0x1057, 0));
                this.Add(new GenericBuyInfo(typeof(SextantParts), 5, 20, 0x1059, 0));
                this.Add(new GenericBuyInfo(typeof(Axle), 2, 20, 0x105B, 0));
                this.Add(new GenericBuyInfo(typeof(Springs), 3, 20, 0x105D, 0));

                this.Add(new GenericBuyInfo("1024111", typeof(Key), 8, 20, 0x100F, 0));
                this.Add(new GenericBuyInfo("1024112", typeof(Key), 8, 20, 0x1010, 0));
                this.Add(new GenericBuyInfo("1024115", typeof(Key), 8, 20, 0x1013, 0));
                this.Add(new GenericBuyInfo(typeof(KeyRing), 8, 20, 0x1010, 0));
                this.Add(new GenericBuyInfo(typeof(Lockpick), 12, 20, 0x14FC, 0));</pre>

## Duplicated Code. Size: 667

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBCarpenter.cs

<pre>this.Add(typeof(WoodenBox), 7);
                this.Add(typeof(SmallCrate), 5);
                this.Add(typeof(MediumCrate), 6);
                this.Add(typeof(LargeCrate), 7);
                this.Add(typeof(WoodenChest), 15);

                this.Add(typeof(LargeTable), 10);
                this.Add(typeof(Nightstand), 7);
                this.Add(typeof(YewWoodTable), 10);

                this.Add(typeof(Throne), 24);
                this.Add(typeof(WoodenThrone), 6);
                this.Add(typeof(Stool), 6);
                this.Add(typeof(FootStool), 6);

                this.Add(typeof(FancyWoodenChairCushion), 12);
                this.Add(typeof(WoodenChairCushion), 10);
                this.Add(typeof(WoodenChair), 8);
                this.Add(typeof(BambooChair), 6);
                this.Add(typeof(WoodenBench), 6);

                this.Add(typeof(Saw), 9);
                this.Add(typeof(Scorp), 6);
                this.Add(typeof(SmoothingPlane), 6);
                this.Add(typeof(DrawKnife), 6);
                this.Add(typeof(Froe), 6);
                this.Add(typeof(Hammer), 14);
                this.Add(typeof(Inshave), 6);
                this.Add(typeof(JointingPlane), 6);
                this.Add(typeof(MouldingPlane), 6);
                this.Add(typeof(DovetailSaw), 7);
                this.Add(typeof(Board), 2);
                this.Add(typeof(Axle), 1);</pre>

Fragment 2 in file Scripts\VendorInfo\SBStoneCrafter.cs

<pre>this.Add(typeof(WoodenBox), 7);
                this.Add(typeof(SmallCrate), 5);
                this.Add(typeof(MediumCrate), 6);
                this.Add(typeof(LargeCrate), 7);
                this.Add(typeof(WoodenChest), 15);

                this.Add(typeof(LargeTable), 10);
                this.Add(typeof(Nightstand), 7);
                this.Add(typeof(YewWoodTable), 10);

                this.Add(typeof(Throne), 24);
                this.Add(typeof(WoodenThrone), 6);
                this.Add(typeof(Stool), 6);
                this.Add(typeof(FootStool), 6);

                this.Add(typeof(FancyWoodenChairCushion), 12);
                this.Add(typeof(WoodenChairCushion), 10);
                this.Add(typeof(WoodenChair), 8);
                this.Add(typeof(BambooChair), 6);
                this.Add(typeof(WoodenBench), 6);

                this.Add(typeof(Saw), 9);
                this.Add(typeof(Scorp), 6);
                this.Add(typeof(SmoothingPlane), 6);
                this.Add(typeof(DrawKnife), 6);
                this.Add(typeof(Froe), 6);
                this.Add(typeof(Hammer), 14);
                this.Add(typeof(Inshave), 6);
                this.Add(typeof(JointingPlane), 6);
                this.Add(typeof(MouldingPlane), 6);
                this.Add(typeof(DovetailSaw), 7);
                this.Add(typeof(Board), 2);
                this.Add(typeof(Axle), 1);</pre>

## Duplicated Code. Size: 657

### Duplicated Fragments:

Fragment 1 in file Ultima\AnimationEdit.cs

<pre>private static void GetFileIndex(
			int body, int fileType, int action, int direction, out FileIndex fileIndex, out int index)
		{
			switch (fileType)
			{
				default:
				case 1:
					fileIndex = m_FileIndex;
					if (body < 200)
					{
						index = body * 110;
					}
					else if (body < 400)
					{
						index = 22000 + ((body - 200) * 65);
					}
					else
					{
						index = 35000 + ((body - 400) * 175);
					}
					break;
				case 2:
					fileIndex = m_FileIndex2;
					if (body < 200)
					{
						index = body * 110;
					}
					else
					{
						index = 22000 + ((body - 200) * 65);
					}
					break;
				case 3:
					fileIndex = m_FileIndex3;
					if (body < 300)
					{
						index = body * 65;
					}
					else if (body < 400)
					{
						index = 33000 + ((body - 300) * 110);
					}
					else
					{
						index = 35000 + ((body - 400) * 175);
					}
					break;
				case 4:
					fileIndex = m_FileIndex4;
					if (body < 200)
					{
						index = body * 110;
					}
					else if (body < 400)
					{
						index = 22000 + ((body - 200) * 65);
					}
					else
					{
						index = 35000 + ((body - 400) * 175);
					}
					break;
				case 5:
					fileIndex = m_FileIndex5;
					if ((body < 200) && (body != 34)) // looks strange, though it works.
					{
						index = body * 110;
					}
					else if (body < 400)
					{
						index = 22000 + ((body - 200) * 65);
					}
					else
					{
						index = 35000 + ((body - 400) * 175);
					}
					break;
			}

			index += action * 5;

			if (direction <= 4)
			{
				index += direction;
			}
			else
			{
				index += direction - (direction - 4) * 2;
			}
		}</pre>

Fragment 2 in file Ultima\Animations.cs

<pre>/// <summary>
		///     Gets Fileseek index based on fileType,body,action,direction
		/// </summary>
		/// <param name="body"></param>
		/// <param name="action"></param>
		/// <param name="direction"></param>
		/// <param name="fileType">animX</param>
		/// <param name="fileIndex"></param>
		/// <param name="index"></param>
		private static void GetFileIndex(
			int body, int action, int direction, int fileType, out FileIndex fileIndex, out int index)
		{
			switch (fileType)
			{
				default:
				case 1:
					fileIndex = m_FileIndex;
					if (body < 200)
					{
						index = body * 110;
					}
					else if (body < 400)
					{
						index = 22000 + ((body - 200) * 65);
					}
					else
					{
						index = 35000 + ((body - 400) * 175);
					}

					break;
				case 2:
					fileIndex = m_FileIndex2;
					if (body < 200)
					{
						index = body * 110;
					}
					else
					{
						index = 22000 + ((body - 200) * 65);
					}

					break;
				case 3:
					fileIndex = m_FileIndex3;
					if (body < 300)
					{
						index = body * 65;
					}
					else if (body < 400)
					{
						index = 33000 + ((body - 300) * 110);
					}
					else
					{
						index = 35000 + ((body - 400) * 175);
					}

					break;
				case 4:
					fileIndex = m_FileIndex4;
					if (body < 200)
					{
						index = body * 110;
					}
					else if (body < 400)
					{
						index = 22000 + ((body - 200) * 65);
					}
					else
					{
						index = 35000 + ((body - 400) * 175);
					}

					break;
				case 5:
					fileIndex = m_FileIndex5;
					if ((body < 200) && (body != 34)) // looks strange, though it works.
					{
						index = body * 110;
					}
					else if (body < 400)
					{
						index = 22000 + ((body - 200) * 65);
					}
					else
					{
						index = 35000 + ((body - 400) * 175);
					}

					break;
			}

			index += action * 5;

			if (direction <= 4)
			{
				index += direction;
			}
			else
			{
				index += direction - (direction - 4) * 2;
			}
		}</pre>

## Duplicated Code. Size: 656

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\SandstoneFountainAddon.cs

<pre>this.AddComponent(new AddonComponent(itemID++), -2, +1, 0);
            this.AddComponent(new AddonComponent(itemID++), -1, +1, 0);
            this.AddComponent(new AddonComponent(itemID++), +0, +1, 0);
            this.AddComponent(new AddonComponent(itemID++), +1, +1, 0);

            this.AddComponent(new AddonComponent(itemID++), +1, +0, 0);
            this.AddComponent(new AddonComponent(itemID++), +1, -1, 0);
            this.AddComponent(new AddonComponent(itemID++), +1, -2, 0);

            this.AddComponent(new AddonComponent(itemID++), +0, -2, 0);
            this.AddComponent(new AddonComponent(itemID++), +0, -1, 0);
            this.AddComponent(new AddonComponent(itemID++), +0, +0, 0);

            this.AddComponent(new AddonComponent(itemID++), -1, +0, 0);
            this.AddComponent(new AddonComponent(itemID++), -2, +0, 0);

            this.AddComponent(new AddonComponent(itemID++), -2, -1, 0);
            this.AddComponent(new AddonComponent(itemID++), -1, -1, 0);

            this.AddComponent(new AddonComponent(itemID++), -1, -2, 0);
            this.AddComponent(new AddonComponent(++itemID), -2, -2, 0);</pre>

Fragment 2 in file Scripts\Items\Addons\StoneFountainAddon.cs

<pre>this.AddComponent(new AddonComponent(itemID++), -2, +1, 0);
            this.AddComponent(new AddonComponent(itemID++), -1, +1, 0);
            this.AddComponent(new AddonComponent(itemID++), +0, +1, 0);
            this.AddComponent(new AddonComponent(itemID++), +1, +1, 0);

            this.AddComponent(new AddonComponent(itemID++), +1, +0, 0);
            this.AddComponent(new AddonComponent(itemID++), +1, -1, 0);
            this.AddComponent(new AddonComponent(itemID++), +1, -2, 0);

            this.AddComponent(new AddonComponent(itemID++), +0, -2, 0);
            this.AddComponent(new AddonComponent(itemID++), +0, -1, 0);
            this.AddComponent(new AddonComponent(itemID++), +0, +0, 0);

            this.AddComponent(new AddonComponent(itemID++), -1, +0, 0);
            this.AddComponent(new AddonComponent(itemID++), -2, +0, 0);

            this.AddComponent(new AddonComponent(itemID++), -2, -1, 0);
            this.AddComponent(new AddonComponent(itemID++), -1, -1, 0);

            this.AddComponent(new AddonComponent(itemID++), -1, -2, 0);
            this.AddComponent(new AddonComponent(++itemID), -2, -2, 0);</pre>

## Duplicated Code. Size: 654

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ElfBrigand.cs

<pre>this.Title = "the brigand";
            this.Hue = this.Race.RandomSkinHue();

            this.SetStr(86, 100);
            this.SetDex(81, 95);
            this.SetInt(61, 75);

            this.SetDamage(10, 23);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 10, 15);
            this.SetResistance(ResistanceType.Fire, 10, 15);
            this.SetResistance(ResistanceType.Poison, 10, 15);
            this.SetResistance(ResistanceType.Energy, 10, 15);

            this.SetSkill(SkillName.MagicResist, 25.0, 47.5);
            this.SetSkill(SkillName.Tactics, 65.0, 87.5);
            this.SetSkill(SkillName.Wrestling, 15.0, 37.5);

            this.Fame = 1000;
            this.Karma = -1000;

            // outfit
            this.AddItem(new Shirt(Utility.RandomNeutralHue()));

            switch (Utility.Random(4))
            {
                case 0:
                    this.AddItem(new Sandals());
                    break;
                case 1:
                    this.AddItem(new Shoes());
                    break;
                case 2:
                    this.AddItem(new Boots());
                    break;
                case 3:
                    this.AddItem(new ThighBoots());
                    break;
            }

            if (this.Female)
            {
                if (Utility.RandomBool())
                    this.AddItem(new Skirt(Utility.RandomNeutralHue()));
                else
                    this.AddItem(new Kilt(Utility.RandomNeutralHue()));
            }
            else
                this.AddItem(new ShortPants(Utility.RandomNeutralHue()));

            // hair, facial hair			
            this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();</pre>

Fragment 2 in file Scripts\Mobiles\Normal\HumanBrigand.cs

<pre>this.Title = "the brigand";
            this.Hue = this.Race.RandomSkinHue();

            this.SetStr(86, 100);
            this.SetDex(81, 95);
            this.SetInt(61, 75);

            this.SetDamage(10, 23);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 10, 15);
            this.SetResistance(ResistanceType.Fire, 10, 15);
            this.SetResistance(ResistanceType.Poison, 10, 15);
            this.SetResistance(ResistanceType.Energy, 10, 15);

            this.SetSkill(SkillName.MagicResist, 25.0, 47.5);
            this.SetSkill(SkillName.Tactics, 65.0, 87.5);
            this.SetSkill(SkillName.Wrestling, 15.0, 37.5);

            this.Fame = 1000;
            this.Karma = -1000;

            // outfit
            this.AddItem(new Shirt(Utility.RandomNeutralHue()));

            switch (Utility.Random(4))
            {
                case 0:
                    this.AddItem(new Sandals());
                    break;
                case 1:
                    this.AddItem(new Shoes());
                    break;
                case 2:
                    this.AddItem(new Boots());
                    break;
                case 3:
                    this.AddItem(new ThighBoots());
                    break;
            }

            if (this.Female)
            {
                if (Utility.RandomBool())
                    this.AddItem(new Skirt(Utility.RandomNeutralHue()));
                else
                    this.AddItem(new Kilt(Utility.RandomNeutralHue()));
            }
            else
                this.AddItem(new ShortPants(Utility.RandomNeutralHue()));

            // hair, facial hair			
            this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();</pre>

## Duplicated Code. Size: 645

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>{
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10109, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075630, LabelColor, false, false);       //Hit Point Increase
                    yOffset += 1;
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10110, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075632, LabelColor, false, false);       //Stamina Increase
                    yOffset += 1;
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10111, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075631, LabelColor, false, false);       //Mana Increaase
                    yOffset += 1;
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10103, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075627, LabelColor, false, false);       //Hit Points Regeneration
                    yOffset += 1;
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10104, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1079411, LabelColor, false, false);       //Stamina Regeneration
                    yOffset += 1;
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10105, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1079410, LabelColor, false, false);       //Mana Regeneration
                    yOffset += 1;
                }</pre>

Fragment 2 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>{
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10109, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075630, LabelColor, false, false);       //Hit Point Increase
                    yOffset += 1;
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10110, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075632, LabelColor, false, false);       //Stamina Increase
                    yOffset += 1;
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10111, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075631, LabelColor, false, false);       //Mana Increaase
                    yOffset += 1;
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10103, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075627, LabelColor, false, false);                   //Hit Points Regeneration
                    yOffset += 1;
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10104, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1079411, LabelColor, false, false);       //Stamina Regeneration 
                    yOffset += 1;
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10105, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1079410, LabelColor, false, false);       //Mana Regeneration
                    yOffset += 1;
                }</pre>

## Duplicated Code. Size: 636

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\AOS.cs

<pre>uint mask = (uint)bitmask;

            if (value != 0)
            {
                if ((this.m_Names & mask) != 0)
                {
                    int index = this.GetIndex(mask);

                    if (index >= 0 && index < this.m_Values.Length)
                        this.m_Values[index] = value;
                }
                else
                {
                    int index = this.GetIndex(mask);

                    if (index >= 0 && index <= this.m_Values.Length)
                    {
                        int[] old = this.m_Values;
                        this.m_Values = new int[old.Length + 1];

                        for (int i = 0; i < index; ++i)
                            this.m_Values[i] = old[i];

                        this.m_Values[index] = value;

                        for (int i = index; i < old.Length; ++i)
                            this.m_Values[i + 1] = old[i];

                        this.m_Names |= mask;
                    }
                }
            }
            else if ((this.m_Names & mask) != 0)
            {
                int index = this.GetIndex(mask);

                if (index >= 0 && index < this.m_Values.Length)
                {
                    this.m_Names &= ~mask;

                    if (this.m_Values.Length == 1)
                    {
                        this.m_Values = m_Empty;
                    }
                    else
                    {
                        int[] old = this.m_Values;
                        this.m_Values = new int[old.Length - 1];

                        for (int i = 0; i < index; ++i)
                            this.m_Values[i] = old[i];

                        for (int i = index + 1; i < old.Length; ++i)
                            this.m_Values[i - 1] = old[i];
                    }
                }
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlAosAttributes.cs

<pre>uint mask = (uint)bitmask;

            if (value != 0)
            {
                if ((this.m_Names & mask) != 0)
                {
                    int index = this.GetIndex(mask);

                    if (index >= 0 && index < this.m_Values.Length)
                        this.m_Values[index] = value;
                }
                else
                {
                    int index = this.GetIndex(mask);

                    if (index >= 0 && index <= this.m_Values.Length)
                    {
                        int[] old = this.m_Values;
                        this.m_Values = new int[old.Length + 1];

                        for (int i = 0; i < index; ++i)
                            this.m_Values[i] = old[i];

                        this.m_Values[index] = value;

                        for (int i = index; i < old.Length; ++i)
                            this.m_Values[i + 1] = old[i];

                        this.m_Names |= mask;
                    }
                }
            }
            else if ((this.m_Names & mask) != 0)
            {
                int index = this.GetIndex(mask);

                if (index >= 0 && index < this.m_Values.Length)
                {
                    this.m_Names &= ~mask;

                    if (this.m_Values.Length == 1)
                    {
                        this.m_Values = m_Empty;
                    }
                    else
                    {
                        int[] old = this.m_Values;
                        this.m_Values = new int[old.Length - 1];

                        for (int i = 0; i < index; ++i)
                            this.m_Values[i] = old[i];

                        for (int i = index + 1; i < old.Length; ++i)
                            this.m_Values[i - 1] = old[i];
                    }
                }
            }</pre>

## Duplicated Code. Size: 631

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>{
            this.Title = "the wandering healer";

            this.AI = AIType.AI_Mage;
            this.ActiveSpeed = 0.2;
            this.PassiveSpeed = 0.8;
            this.RangePerception = BaseCreature.DefaultRangePerception;
            this.FightMode = FightMode.Aggressor;

            this.SpeechHue = 0;

            this.SetStr(304, 400);
            this.SetDex(102, 150);
            this.SetInt(204, 300);

            this.SetDamage(10, 23);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 40, 50);
            this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 40, 50);

            this.SetSkill(SkillName.Anatomy, 75.0, 97.5);
            this.SetSkill(SkillName.EvalInt, 82.0, 100.0);
            this.SetSkill(SkillName.Healing, 75.0, 97.5);
            this.SetSkill(SkillName.Magery, 82.0, 100.0);
            this.SetSkill(SkillName.MagicResist, 82.0, 100.0);
            this.SetSkill(SkillName.Tactics, 82.0, 100.0);
            this.SetSkill(SkillName.Camping, 80.0, 100.0);
            this.SetSkill(SkillName.Forensics, 80.0, 100.0);
            this.SetSkill(SkillName.SpiritSpeak, 80.0, 100.0);

            this.Fame = 1000;
            this.Karma = 10000;

            this.PackItem(new Bandage(Utility.RandomMinMax(5, 10)));
            this.PackItem(new HealPotion());
            this.PackItem(new CurePotion());
        }</pre>

Fragment 2 in file Scripts\Quests\Escortables.cs

<pre>{
            this.Title = "the wandering healer";

            this.AI = AIType.AI_Mage;
            this.ActiveSpeed = 0.2;
            this.PassiveSpeed = 0.8;
            this.RangePerception = BaseCreature.DefaultRangePerception;
            this.FightMode = FightMode.Aggressor;

            this.SpeechHue = 0;

            this.SetStr(304, 400);
            this.SetDex(102, 150);
            this.SetInt(204, 300);

            this.SetDamage(10, 23);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 40, 50);
            this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 40, 50);

            this.SetSkill(SkillName.Anatomy, 75.0, 97.5);
            this.SetSkill(SkillName.EvalInt, 82.0, 100.0);
            this.SetSkill(SkillName.Healing, 75.0, 97.5);
            this.SetSkill(SkillName.Magery, 82.0, 100.0);
            this.SetSkill(SkillName.MagicResist, 82.0, 100.0);
            this.SetSkill(SkillName.Tactics, 82.0, 100.0);
            this.SetSkill(SkillName.Camping, 80.0, 100.0);
            this.SetSkill(SkillName.Forensics, 80.0, 100.0);
            this.SetSkill(SkillName.SpiritSpeak, 80.0, 100.0);

            this.Fame = 1000;
            this.Karma = 10000;

            this.PackItem(new Bandage(Utility.RandomMinMax(5, 10)));
            this.PackItem(new HealPotion());
            this.PackItem(new CurePotion());
        }</pre>

## Duplicated Code. Size: 630

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 3, 0, 0, 1779, -1, "", 1);// 723
			AddComplexComponent( (BaseAddon) this, 2769, 3, -1, 0, 1779, -1, "", 1);// 724
			AddComplexComponent( (BaseAddon) this, 2769, 3, -2, 0, 1779, -1, "", 1);// 725
			AddComplexComponent( (BaseAddon) this, 2769, 3, -3, 0, 1779, -1, "", 1);// 726
			AddComplexComponent( (BaseAddon) this, 2769, 2, 0, 0, 1779, -1, "", 1);// 727
			AddComplexComponent( (BaseAddon) this, 2769, 2, -1, 0, 1779, -1, "", 1);// 728
			AddComplexComponent( (BaseAddon) this, 2769, 2, -2, 0, 1779, -1, "", 1);// 729
			AddComplexComponent( (BaseAddon) this, 2769, 2, -3, 0, 1779, -1, "", 1);// 730
			AddComplexComponent( (BaseAddon) this, 2769, 1, 0, 0, 1779, -1, "", 1);// 731
			AddComplexComponent( (BaseAddon) this, 2769, 1, -1, 0, 1779, -1, "", 1);// 732
			AddComplexComponent( (BaseAddon) this, 2769, 1, -2, 0, 1779, -1, "", 1);// 733
			AddComplexComponent( (BaseAddon) this, 2769, 1, -3, 0, 1779, -1, "", 1);// 734</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 0, 3, 0, 1779, -1, "", 1);// 1226
			AddComplexComponent( (BaseAddon) this, 2769, 0, 2, 0, 1779, -1, "", 1);// 1227
			AddComplexComponent( (BaseAddon) this, 2769, 0, 1, 0, 1779, -1, "", 1);// 1228
			AddComplexComponent( (BaseAddon) this, 2769, -1, 3, 0, 1779, -1, "", 1);// 1229
			AddComplexComponent( (BaseAddon) this, 2769, -1, 2, 0, 1779, -1, "", 1);// 1230
			AddComplexComponent( (BaseAddon) this, 2769, -1, 1, 0, 1779, -1, "", 1);// 1231
			AddComplexComponent( (BaseAddon) this, 2769, -2, 3, 0, 1779, -1, "", 1);// 1232
			AddComplexComponent( (BaseAddon) this, 2769, -2, 2, 0, 1779, -1, "", 1);// 1233
			AddComplexComponent( (BaseAddon) this, 2769, -2, 1, 0, 1779, -1, "", 1);// 1234
			AddComplexComponent( (BaseAddon) this, 2769, -3, 3, 0, 1779, -1, "", 1);// 1235
			AddComplexComponent( (BaseAddon) this, 2769, -3, 2, 0, 1779, -1, "", 1);// 1236
			AddComplexComponent( (BaseAddon) this, 2769, -3, 1, 0, 1779, -1, "", 1);// 1237</pre>

## Duplicated Code. Size: 629

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Ethics\Evil\Powers\UnholySense.cs

<pre>int enemyCount = 0;

            int maxRange = 18 + from.Power;

            Player primary = null;

            foreach (Player pl in opposition.Players)
            {
                Mobile mob = pl.Mobile;

                if (mob == null || mob.Map != from.Mobile.Map || !mob.Alive)
                    continue;

                if (!mob.InRange(from.Mobile, Math.Max(18, maxRange - pl.Power)))
                    continue;

                if (primary == null || pl.Power > primary.Power)
                    primary = pl;

                ++enemyCount;
            }

            StringBuilder sb = new StringBuilder();

            sb.Append("You sense ");
            sb.Append(enemyCount == 0 ? "no" : enemyCount.ToString());
            sb.Append(enemyCount == 1 ? " enemy" : " enemies");

            if (primary != null)
            {
                sb.Append(", and a strong presense");

                switch ( from.Mobile.GetDirectionTo(primary.Mobile) )
                {
                    case Direction.West:
                        sb.Append(" to the west.");
                        break;
                    case Direction.East:
                        sb.Append(" to the east.");
                        break;
                    case Direction.North:
                        sb.Append(" to the north.");
                        break;
                    case Direction.South:
                        sb.Append(" to the south.");
                        break;
                    case Direction.Up:
                        sb.Append(" to the north-west.");
                        break;
                    case Direction.Down:
                        sb.Append(" to the south-east.");
                        break;
                    case Direction.Left:
                        sb.Append(" to the south-west.");
                        break;
                    case Direction.Right:
                        sb.Append(" to the north-east.");
                        break;
                }
            }
            else
            {
                sb.Append('.');
            }

            from.Mobile.LocalOverheadMessage(Server.Network.MessageType.Regular, 0x59, false, sb.ToString());

            this.FinishInvoke(from);</pre>

Fragment 2 in file Scripts\Services\Ethics\Hero\Powers\HolySense.cs

<pre>int enemyCount = 0;

            int maxRange = 18 + from.Power;

            Player primary = null;

            foreach (Player pl in opposition.Players)
            {
                Mobile mob = pl.Mobile;

                if (mob == null || mob.Map != from.Mobile.Map || !mob.Alive)
                    continue;

                if (!mob.InRange(from.Mobile, Math.Max(18, maxRange - pl.Power)))
                    continue;

                if (primary == null || pl.Power > primary.Power)
                    primary = pl;

                ++enemyCount;
            }

            StringBuilder sb = new StringBuilder();

            sb.Append("You sense ");
            sb.Append(enemyCount == 0 ? "no" : enemyCount.ToString());
            sb.Append(enemyCount == 1 ? " enemy" : " enemies");

            if (primary != null)
            {
                sb.Append(", and a strong presense");

                switch ( from.Mobile.GetDirectionTo(primary.Mobile) )
                {
                    case Direction.West:
                        sb.Append(" to the west.");
                        break;
                    case Direction.East:
                        sb.Append(" to the east.");
                        break;
                    case Direction.North:
                        sb.Append(" to the north.");
                        break;
                    case Direction.South:
                        sb.Append(" to the south.");
                        break;
                    case Direction.Up:
                        sb.Append(" to the north-west.");
                        break;
                    case Direction.Down:
                        sb.Append(" to the south-east.");
                        break;
                    case Direction.Left:
                        sb.Append(" to the south-west.");
                        break;
                    case Direction.Right:
                        sb.Append(" to the north-east.");
                        break;
                }
            }
            else
            {
                sb.Append('.');
            }

            from.Mobile.LocalOverheadMessage(Server.Network.MessageType.Regular, 0x59, false, sb.ToString());

            this.FinishInvoke(from);</pre>

## Duplicated Code. Size: 628

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBlacksmith.cs

<pre>this.Add(new GenericBuyInfo(typeof(BlackStaff), 22, 20, 0xDF1, 0));
                this.Add(new GenericBuyInfo(typeof(Club), 16, 20, 0x13B4, 0));
                this.Add(new GenericBuyInfo(typeof(GnarledStaff), 16, 20, 0x13F8, 0));
                this.Add(new GenericBuyInfo(typeof(Mace), 28, 20, 0xF5C, 0));
                this.Add(new GenericBuyInfo(typeof(Maul), 21, 20, 0x143B, 0));
                this.Add(new GenericBuyInfo(typeof(QuarterStaff), 19, 20, 0xE89, 0));
                this.Add(new GenericBuyInfo(typeof(ShepherdsCrook), 20, 20, 0xE81, 0));
                this.Add(new GenericBuyInfo(typeof(SmithHammer), 21, 20, 0x13E3, 0));
                this.Add(new GenericBuyInfo(typeof(ShortSpear), 23, 20, 0x1403, 0));
                this.Add(new GenericBuyInfo(typeof(Spear), 31, 20, 0xF62, 0));
                this.Add(new GenericBuyInfo(typeof(WarHammer), 25, 20, 0x1439, 0));
                this.Add(new GenericBuyInfo(typeof(WarMace), 31, 20, 0x1407, 0));

                if (Core.AOS)
                {
                    this.Add(new GenericBuyInfo(typeof(Scepter), 39, 20, 0x26BC, 0));
                    this.Add(new GenericBuyInfo(typeof(BladedStaff), 40, 20, 0x26BD, 0));
                }</pre>

Fragment 2 in file Scripts\VendorInfo\SBWeaponSmith.cs

<pre>this.Add(new GenericBuyInfo(typeof(BlackStaff), 22, 20, 0xDF1, 0));
                this.Add(new GenericBuyInfo(typeof(Club), 16, 20, 0x13B4, 0));
                this.Add(new GenericBuyInfo(typeof(GnarledStaff), 16, 20, 0x13F8, 0));
                this.Add(new GenericBuyInfo(typeof(Mace), 28, 20, 0xF5C, 0));
                this.Add(new GenericBuyInfo(typeof(Maul), 21, 20, 0x143B, 0));
                this.Add(new GenericBuyInfo(typeof(QuarterStaff), 19, 20, 0xE89, 0));
                this.Add(new GenericBuyInfo(typeof(ShepherdsCrook), 20, 20, 0xE81, 0));
                this.Add(new GenericBuyInfo(typeof(SmithHammer), 21, 20, 0x13E3, 0));
                this.Add(new GenericBuyInfo(typeof(ShortSpear), 23, 20, 0x1403, 0));
                this.Add(new GenericBuyInfo(typeof(Spear), 31, 20, 0xF62, 0));
                this.Add(new GenericBuyInfo(typeof(WarHammer), 25, 20, 0x1439, 0));
                this.Add(new GenericBuyInfo(typeof(WarMace), 31, 20, 0x1407, 0));

                if (Core.AOS)
                {
                    this.Add(new GenericBuyInfo(typeof(Scepter), 39, 20, 0x26BC, 0));
                    this.Add(new GenericBuyInfo(typeof(BladedStaff), 40, 20, 0x26BD, 0));
                }</pre>

## Duplicated Code. Size: 622

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\ParagonChest.cs

<pre>if (item is BaseWeapon)
                {
                    BaseWeapon weapon = (BaseWeapon)item;

                    if (Core.AOS)
                    {
                        int attributeCount;
                        int min, max;

                        GetRandomAOSStats(out attributeCount, out min, out max);

                        BaseRunicTool.ApplyAttributesTo(weapon, attributeCount, min, max);
                    }
                    else
                    {
                        weapon.DamageLevel = (WeaponDamageLevel)Utility.Random(6);
                        weapon.AccuracyLevel = (WeaponAccuracyLevel)Utility.Random(6);
                        weapon.DurabilityLevel = (WeaponDurabilityLevel)Utility.Random(6);
                    }

                    this.DropItem(item);
                }
                else if (item is BaseArmor)
                {
                    BaseArmor armor = (BaseArmor)item;

                    if (Core.AOS)
                    {
                        int attributeCount;
                        int min, max;

                        GetRandomAOSStats(out attributeCount, out min, out max);

                        BaseRunicTool.ApplyAttributesTo(armor, attributeCount, min, max);
                    }
                    else
                    {
                        armor.ProtectionLevel = (ArmorProtectionLevel)Utility.Random(6);
                        armor.Durability = (ArmorDurabilityLevel)Utility.Random(6);
                    }

                    this.DropItem(item);
                }
                else if (item is BaseHat)
                {
                    BaseHat hat = (BaseHat)item;

                    if (Core.AOS)
                    {
                        int attributeCount;
                        int min, max;

                        GetRandomAOSStats(out attributeCount, out min, out max);

                        BaseRunicTool.ApplyAttributesTo(hat, attributeCount, min, max);
                    }

                    this.DropItem(item);
                }
                else if (item is BaseJewel)
                {
                    int attributeCount;
                    int min, max;

                    GetRandomAOSStats(out attributeCount, out min, out max);

                    BaseRunicTool.ApplyAttributesTo((BaseJewel)item, attributeCount, min, max);

                    this.DropItem(item);
                }</pre>

Fragment 2 in file Scripts\Services\Khaldun\PuzzleChest.cs

<pre>if (item is BaseWeapon)
                {
                    BaseWeapon weapon = (BaseWeapon)item;

                    if (Core.AOS)
                    {
                        int attributeCount;
                        int min, max;

                        GetRandomAOSStats(out attributeCount, out min, out max);

                        BaseRunicTool.ApplyAttributesTo(weapon, attributeCount, min, max);
                    }
                    else
                    {
                        weapon.DamageLevel = (WeaponDamageLevel)Utility.Random(6);
                        weapon.AccuracyLevel = (WeaponAccuracyLevel)Utility.Random(6);
                        weapon.DurabilityLevel = (WeaponDurabilityLevel)Utility.Random(6);
                    }

                    this.DropItem(item);
                }
                else if (item is BaseArmor)
                {
                    BaseArmor armor = (BaseArmor)item;

                    if (Core.AOS)
                    {
                        int attributeCount;
                        int min, max;

                        GetRandomAOSStats(out attributeCount, out min, out max);

                        BaseRunicTool.ApplyAttributesTo(armor, attributeCount, min, max);
                    }
                    else
                    {
                        armor.ProtectionLevel = (ArmorProtectionLevel)Utility.Random(6);
                        armor.Durability = (ArmorDurabilityLevel)Utility.Random(6);
                    }

                    this.DropItem(item);
                }
                else if (item is BaseHat)
                {
                    BaseHat hat = (BaseHat)item;

                    if (Core.AOS)
                    {
                        int attributeCount;
                        int min, max;

                        GetRandomAOSStats(out attributeCount, out min, out max);

                        BaseRunicTool.ApplyAttributesTo(hat, attributeCount, min, max);
                    }

                    this.DropItem(item);
                }
                else if (item is BaseJewel)
                {
                    int attributeCount;
                    int min, max;

                    GetRandomAOSStats(out attributeCount, out min, out max);

                    BaseRunicTool.ApplyAttributesTo((BaseJewel)item, attributeCount, min, max);

                    this.DropItem(item);
                }</pre>

## Duplicated Code. Size: 616

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
								int effect = -1;
								int duration = 1;
								// syntax is EFFECT,itemid,duration,[x,y,z]
								// try to get the effect argument
								if (keywordargs.Length < 2)
								{
									status_str = "Missing effect number";
									no_error = false;
								}
								else
								{
									if(!int.TryParse(keywordargs[1], out effect))
									{ status_str = "Improper effect number format"; no_error = false; }
								}
								if (keywordargs.Length > 2)
								{
									if(!int.TryParse(keywordargs[2], out duration))
									{ status_str = "Improper effect duration format"; no_error = false; }
								}
								// by default just use the spawn location
								Point3D eloc;
								Map emap = Map.Internal;
								if (o is Mobile)
								{
									eloc = ((Mobile)o).Location;
									emap = ((Mobile)o).Map;
								}
								else if (o is Item)
								{
									eloc = ((Item)o).Location;
									emap = ((Item)o).Map;
								}
								else
								{
									// should never get here
									eloc = new Point3D(0, 0, 0);
								}

								if (keywordargs.Length > 3)
								{
									// is this applied to the trig mob or to a location?
									if (keywordargs.Length > 5)
									{
										int x=0;
										int y=0;
										int z=0;
										if(!int.TryParse(keywordargs[3], out x) || !int.TryParse(keywordargs[4], out y) || !int.TryParse(keywordargs[5], out z))
										{ status_str = "Improper effect location format"; }
										eloc = new Point3D(x, y, z);
									}
								}
								if (effect >= 0 && emap != Map.Internal)
								{
									Effects.SendLocationEffect(eloc, emap, effect, duration);
								}
								if (arglist.Length < 2) break;
								remainder = singlearglist[1];
							}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
								int effect = -1;
								int duration = 1;
								// syntax is PEFFECT,itemid,duration,[x,y,z]
								// try to get the effect argument
								if (keywordargs.Length < 2)
								{
									status_str = "Missing effect number";
									no_error = false;
								}
								else
								{
									if(!int.TryParse(keywordargs[1], out effect))
									{ status_str = "Improper effect number format"; no_error = false; }
								}
								if (keywordargs.Length > 2)
								{
									if(!int.TryParse(keywordargs[2], out duration))
									{ status_str = "Improper effect duration format"; no_error = false; }
								}
								// by default just use the spawn location
								Point3D eloc;
								Map emap = Map.Internal;
								if (o is Mobile)
								{
									eloc = ((Mobile)o).Location;
									emap = ((Mobile)o).Map;
								}
								else if (o is Item)
								{
									eloc = ((Item)o).Location;
									emap = ((Item)o).Map;
								}
								else
								{
									// should never get here
									eloc = new Point3D(0, 0, 0);
								}

								if (keywordargs.Length > 3)
								{
									// is this applied to the trig mob or to a location?
									if (keywordargs.Length > 5)
									{
										int x = 0;
										int y = 0;
										int z = 0;
										if(!int.TryParse(keywordargs[3], out x) || !int.TryParse(keywordargs[4], out y) || !int.TryParse(keywordargs[5], out z))
										{ status_str = "Improper effect location format"; }
										eloc = new Point3D(x, y, z);
									}
								}
								if (effect >= 0 && emap != Map.Internal)
								{
									Effects.SendLocationEffect(eloc, emap, effect, duration);
								}
								if (arglist.Length < 2) break;
								remainder = singlearglist[1];
							}</pre>

## Duplicated Code. Size: 608

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>item.Movable = false;

            for (int i = 0; i < this.m_Params.Length; ++i)
            {
                if (this.m_Params[i].StartsWith("Light"))
                {
                    int indexOf = this.m_Params[i].IndexOf('=');

                    if (indexOf >= 0)
                        item.Light = (LightType)Enum.Parse(typeof(LightType), this.m_Params[i].Substring(++indexOf), true);
                }
                else if (this.m_Params[i].StartsWith("Hue"))
                {
                    int indexOf = this.m_Params[i].IndexOf('=');

                    if (indexOf >= 0)
                    {
                        int hue = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));

                        if (item is DyeTub)
                            ((DyeTub)item).DyedHue = hue;
                        else
                            item.Hue = hue;
                    }
                }
                else if (this.m_Params[i].StartsWith("Name"))
                {
                    int indexOf = this.m_Params[i].IndexOf('=');

                    if (indexOf >= 0)
                        item.Name = this.m_Params[i].Substring(++indexOf);
                }
                else if (this.m_Params[i].StartsWith("Amount"))
                {
                    int indexOf = this.m_Params[i].IndexOf('=');

                    if (indexOf >= 0)
                    {
                        // Must supress stackable warnings
                        bool wasStackable = item.Stackable;

                        item.Stackable = true;
                        item.Amount = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        item.Stackable = wasStackable;
                    }
                }
            }

            return item;</pre>

Fragment 2 in file Scripts\Commands\DecorateDelete.cs

<pre>item.Movable = false;

            for (int i = 0; i < this.m_Params.Length; ++i)
            {
                if (this.m_Params[i].StartsWith("Light"))
                {
                    int indexOf = this.m_Params[i].IndexOf('=');

                    if (indexOf >= 0)
                        item.Light = (LightType)Enum.Parse(typeof(LightType), this.m_Params[i].Substring(++indexOf), true);
                }
                else if (this.m_Params[i].StartsWith("Hue"))
                {
                    int indexOf = this.m_Params[i].IndexOf('=');

                    if (indexOf >= 0)
                    {
                        int hue = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));

                        if (item is DyeTub)
                            ((DyeTub)item).DyedHue = hue;
                        else
                            item.Hue = hue;
                    }
                }
                else if (this.m_Params[i].StartsWith("Name"))
                {
                    int indexOf = this.m_Params[i].IndexOf('=');

                    if (indexOf >= 0)
                        item.Name = this.m_Params[i].Substring(++indexOf);
                }
                else if (this.m_Params[i].StartsWith("Amount"))
                {
                    int indexOf = this.m_Params[i].IndexOf('=');

                    if (indexOf >= 0)
                    {
                        // Must supress stackable warnings
                        bool wasStackable = item.Stackable;

                        item.Stackable = true;
                        item.Amount = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        item.Stackable = wasStackable;
                    }
                }
            }

            return item;</pre>

Fragment 3 in file Scripts\Commands\DecorateMag.cs

<pre>item.Movable = false;

            for (int i = 0; i < this.m_Params.Length; ++i)
            {
                if (this.m_Params[i].StartsWith("Light"))
                {
                    int indexOf = this.m_Params[i].IndexOf('=');

                    if (indexOf >= 0)
                        item.Light = (LightType)Enum.Parse(typeof(LightType), this.m_Params[i].Substring(++indexOf), true);
                }
                else if (this.m_Params[i].StartsWith("Hue"))
                {
                    int indexOf = this.m_Params[i].IndexOf('=');

                    if (indexOf >= 0)
                    {
                        int hue = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));

                        if (item is DyeTub)
                            ((DyeTub)item).DyedHue = hue;
                        else
                            item.Hue = hue;
                    }
                }
                else if (this.m_Params[i].StartsWith("Name"))
                {
                    int indexOf = this.m_Params[i].IndexOf('=');

                    if (indexOf >= 0)
                        item.Name = this.m_Params[i].Substring(++indexOf);
                }
                else if (this.m_Params[i].StartsWith("Amount"))
                {
                    int indexOf = this.m_Params[i].IndexOf('=');

                    if (indexOf >= 0)
                    {
                        // Must supress stackable warnings
                        bool wasStackable = item.Stackable;

                        item.Stackable = true;
                        item.Amount = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        item.Stackable = wasStackable;
                    }
                }
            }

            return item;</pre>

## Duplicated Code. Size: 601

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Creatures.cs

<pre>private bool DoEffects(Direction d)
        {
            int x = this.X;
            int y = this.Y;
            int z = this.Z;
            int range = 10;
            int offset = 8;

            switch (d)
            {
                case Direction.North:
                    x = this.X + Utility.RandomMinMax(-offset, offset);
                    y = this.Y - range;
                    break;
                case Direction.West:
                    x = this.X - range;
                    y = this.Y + Utility.RandomMinMax(-offset, offset);
                    break;
                case Direction.South:
                    x = this.X + Utility.RandomMinMax(-offset, offset);
                    y = this.Y + range;
                    break;
                case Direction.East:
                    x = this.X + range;
                    y = this.Y + Utility.RandomMinMax(-offset, offset);
                    break;
            }

            for (int i = 0; i < range; i++)
            {
                switch (d)
                {
                    case Direction.North: y += i; break;
                    case Direction.West: x += i; break;
                    case Direction.South: y -= i; break;
                    case Direction.East: x -= i; break;
                }

                z = this.Map.GetAverageZ(x, y);
                Point3D p = new Point3D(x, y, z);

                if (Server.Spells.SpellHelper.AdjustField(ref p, this.Map, 12, false))/*this.Map.CanFit(x, y, z, 16, false, false, true))/*this.Map.CanSpawnMobile(x, y, z)*/
                {
                    MovementPath path = new MovementPath(this, p);

                    if (path.Success)
                    {
                        DropCrack(path);
                        return true;
                    }
                }
            }

            return false;
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Creatures\Cora.cs

<pre>private bool DoEffects(Direction d)
        {
            int x = this.X;
            int y = this.Y;
            int z = this.Z;
            int range = 10;
            int offset = 8;

            switch (d)
            {
                case Direction.North:
                    x = this.X + Utility.RandomMinMax(-offset, offset);
                    y = this.Y - range;
                    break;
                case Direction.West:
                    x = this.X - range;
                    y = this.Y + Utility.RandomMinMax(-offset, offset); 
                    break;
                case Direction.South:
                    x = this.X + Utility.RandomMinMax(-offset, offset);
                    y = this.Y + range;
                    break;
                case Direction.East:
                    x = this.X + range;
                    y = this.Y + Utility.RandomMinMax(-offset, offset); 
                    break;
            }

            for (int i = 0; i < range; i++)
            {
                switch (d)
                {
                    case Direction.North: y += i; break;
                    case Direction.West: x += i; break;
                    case Direction.South: y -= i; break;
                    case Direction.East: x -= i; break;
                }

                z = this.Map.GetAverageZ(x, y);
                Point3D p = new Point3D(x, y, z);

                if (Server.Spells.SpellHelper.AdjustField(ref p, this.Map, 12, false))/*this.Map.CanFit(x, y, z, 16, false, false, true))/*this.Map.CanSpawnMobile(x, y, z)*/
                {
                    MovementPath path = new MovementPath(this, p);

                    if (path.Success)
                    {
                        DropCrack(path);
                        return true;
                    }
                }
            }

            return false;
        }</pre>

## Duplicated Code. Size: 590

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if ((prop = this.m_SAAbsorptionAttributes.CastingFocus) != 0)
                list.Add(1113696, prop.ToString()); // Casting Focus ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterFire) != 0)
                list.Add(1113593, prop.ToString()); // Fire Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterCold) != 0)
                list.Add(1113594, prop.ToString()); // Cold Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterPoison) != 0)
                list.Add(1113595, prop.ToString()); // Poison Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterEnergy) != 0)
                list.Add(1113596, prop.ToString()); // Energy Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterKinetic) != 0)
                list.Add(1113597, prop.ToString()); // Kinetic Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterDamage) != 0)
                list.Add(1113598, prop.ToString()); // Damage Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonanceFire) != 0)
                list.Add(1113691, prop.ToString()); // Fire Resonance ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonanceCold) != 0)
                list.Add(1113692, prop.ToString()); // Cold Resonance ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonancePoison) != 0)
                list.Add(1113693, prop.ToString()); // Poison Resonance ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonanceEnergy) != 0)
                list.Add(1113694, prop.ToString()); // Energy Resonance ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonanceKinetic) != 0)
                list.Add(1113695, prop.ToString()); // Kinetic Resonance ~1_val~%
            #endregion

            base.AddResistanceProperties(list);</pre>

Fragment 2 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>if ((prop = this.m_SAAbsorptionAttributes.CastingFocus) != 0)
                list.Add(1113696, prop.ToString()); // Casting Focus ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterFire) != 0)
                list.Add(1113593, prop.ToString()); // Fire Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterCold) != 0)
                list.Add(1113594, prop.ToString()); // Cold Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterPoison) != 0)
                list.Add(1113595, prop.ToString()); // Poison Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterEnergy) != 0)
                list.Add(1113596, prop.ToString()); // Energy Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterKinetic) != 0)
                list.Add(1113597, prop.ToString()); // Kinetic Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterDamage) != 0)
                list.Add(1113598, prop.ToString()); // Damage Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonanceFire) != 0)
                list.Add(1113691, prop.ToString()); // Fire Resonance ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonanceCold) != 0)
                list.Add(1113692, prop.ToString()); // Cold Resonance ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonancePoison) != 0)
                list.Add(1113693, prop.ToString()); // Poison Resonance ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonanceEnergy) != 0)
                list.Add(1113694, prop.ToString()); // Energy Resonance ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonanceKinetic) != 0)
                list.Add(1113695, prop.ToString()); // Kinetic Resonance ~1_val~%
            #endregion

            base.AddResistanceProperties(list);</pre>

Fragment 3 in file Scripts\Items\Equipment\Talismans\BaseTalisman.cs

<pre>if ((prop = this.m_SAAbsorptionAttributes.CastingFocus) != 0)
                list.Add(1113696, prop.ToString()); // Casting Focus ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterFire) != 0)
                list.Add(1113593, prop.ToString()); // Fire Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterCold) != 0)
                list.Add(1113594, prop.ToString()); // Cold Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterPoison) != 0)
                list.Add(1113595, prop.ToString()); // Poison Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterEnergy) != 0)
                list.Add(1113596, prop.ToString()); // Energy Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterKinetic) != 0)
                list.Add(1113597, prop.ToString()); // Kinetic Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.EaterDamage) != 0)
                list.Add(1113598, prop.ToString()); // Damage Eater ~1_Val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonanceFire) != 0)
                list.Add(1113691, prop.ToString()); // Fire Resonance ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonanceCold) != 0)
                list.Add(1113692, prop.ToString()); // Cold Resonance ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonancePoison) != 0)
                list.Add(1113693, prop.ToString()); // Poison Resonance ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonanceEnergy) != 0)
                list.Add(1113694, prop.ToString()); // Energy Resonance ~1_val~%

            if ((prop = this.m_SAAbsorptionAttributes.ResonanceKinetic) != 0)
                list.Add(1113695, prop.ToString()); // Kinetic Resonance ~1_val~%
            #endregion

            base.AddResistanceProperties(list);</pre>

## Duplicated Code. Size: 572

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBCarpenter.cs

<pre>this.Add(new GenericBuyInfo(typeof(Nails), 3, 20, 0x102E, 0));
                this.Add(new GenericBuyInfo(typeof(Axle), 2, 20, 0x105B, 0));
                this.Add(new GenericBuyInfo(typeof(Board), 3, 20, 0x1BD7, 0));
                this.Add(new GenericBuyInfo(typeof(DrawKnife), 10, 20, 0x10E4, 0));
                this.Add(new GenericBuyInfo(typeof(Froe), 10, 20, 0x10E5, 0));
                this.Add(new GenericBuyInfo(typeof(Scorp), 10, 20, 0x10E7, 0));
                this.Add(new GenericBuyInfo(typeof(Inshave), 10, 20, 0x10E6, 0));
                this.Add(new GenericBuyInfo(typeof(DovetailSaw), 12, 20, 0x1028, 0));
                this.Add(new GenericBuyInfo(typeof(Saw), 15, 20, 0x1034, 0));
                this.Add(new GenericBuyInfo(typeof(Hammer), 17, 20, 0x102A, 0));
                this.Add(new GenericBuyInfo(typeof(MouldingPlane), 11, 20, 0x102C, 0));
                this.Add(new GenericBuyInfo(typeof(SmoothingPlane), 10, 20, 0x1032, 0));
                this.Add(new GenericBuyInfo(typeof(JointingPlane), 11, 20, 0x1030, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBStoneCrafter.cs

<pre>this.Add(new GenericBuyInfo(typeof(Nails), 3, 20, 0x102E, 0));
                this.Add(new GenericBuyInfo(typeof(Axle), 2, 20, 0x105B, 0));
                this.Add(new GenericBuyInfo(typeof(Board), 3, 20, 0x1BD7, 0));
                this.Add(new GenericBuyInfo(typeof(DrawKnife), 10, 20, 0x10E4, 0));
                this.Add(new GenericBuyInfo(typeof(Froe), 10, 20, 0x10E5, 0));
                this.Add(new GenericBuyInfo(typeof(Scorp), 10, 20, 0x10E7, 0));
                this.Add(new GenericBuyInfo(typeof(Inshave), 10, 20, 0x10E6, 0));
                this.Add(new GenericBuyInfo(typeof(DovetailSaw), 12, 20, 0x1028, 0));
                this.Add(new GenericBuyInfo(typeof(Saw), 15, 20, 0x1034, 0));
                this.Add(new GenericBuyInfo(typeof(Hammer), 17, 20, 0x102A, 0));
                this.Add(new GenericBuyInfo(typeof(MouldingPlane), 11, 20, 0x102C, 0));
                this.Add(new GenericBuyInfo(typeof(SmoothingPlane), 10, 20, 0x1032, 0));
                this.Add(new GenericBuyInfo(typeof(JointingPlane), 11, 20, 0x1030, 0));</pre>

## Duplicated Code. Size: 567

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Questers\ChampHuthwait.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            AddPage(0);
            this.AddImageTiled(50, 20, 400, 460, 0x1404);
            this.AddImageTiled(50, 29, 30, 450, 0x28DC);
            this.AddImageTiled(34, 140, 17, 339, 0x242F);
            this.AddImage(48, 135, 0x28AB);
            this.AddImage(-16, 285, 0x28A2);
            this.AddImage(0, 10, 0x28B5);
            this.AddImage(25, 0, 0x28B4);
            this.AddImageTiled(83, 15, 350, 15, 0x280A);
            this.AddImage(34, 479, 0x2842);
            this.AddImage(442, 479, 0x2840);
            this.AddImageTiled(51, 479, 392, 17, 0x2775);
            this.AddImageTiled(415, 29, 44, 450, 0xA2D);
            this.AddImageTiled(415, 29, 30, 450, 0x28DC);
            this.AddImage(370, 50, 0x589);

            this.AddImage(379, 60, 0x15A9);
            this.AddImage(425, 0, 0x28C9);
            this.AddImage(90, 33, 0x232D);
            this.AddImageTiled(130, 65, 175, 1, 0x238D);

            AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

            AddPage(1);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Questers\ChampHuthwait.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            AddPage(0);
            this.AddImageTiled(50, 20, 400, 460, 0x1404);
            this.AddImageTiled(50, 29, 30, 450, 0x28DC);
            this.AddImageTiled(34, 140, 17, 339, 0x242F);
            this.AddImage(48, 135, 0x28AB);
            this.AddImage(-16, 285, 0x28A2);
            this.AddImage(0, 10, 0x28B5);
            this.AddImage(25, 0, 0x28B4);
            this.AddImageTiled(83, 15, 350, 15, 0x280A);
            this.AddImage(34, 479, 0x2842);
            this.AddImage(442, 479, 0x2840);
            this.AddImageTiled(51, 479, 392, 17, 0x2775);
            this.AddImageTiled(415, 29, 44, 450, 0xA2D);
            this.AddImageTiled(415, 29, 30, 450, 0x28DC);
            this.AddImage(370, 50, 0x589);

            this.AddImage(379, 60, 0x15A9);
            this.AddImage(425, 0, 0x28C9);
            this.AddImage(90, 33, 0x232D);
            this.AddImageTiled(130, 65, 175, 1, 0x238D);

            AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

            AddPage(1);</pre>

Fragment 3 in file Scripts\Services\ExploringTheDeep\Questers\CusteauPerron.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            AddPage(0);
            this.AddImageTiled(50, 20, 400, 460, 0x1404);
            this.AddImageTiled(50, 29, 30, 450, 0x28DC);
            this.AddImageTiled(34, 140, 17, 339, 0x242F);
            this.AddImage(48, 135, 0x28AB);
            this.AddImage(-16, 285, 0x28A2);
            this.AddImage(0, 10, 0x28B5);
            this.AddImage(25, 0, 0x28B4);
            this.AddImageTiled(83, 15, 350, 15, 0x280A);
            this.AddImage(34, 479, 0x2842);
            this.AddImage(442, 479, 0x2840);
            this.AddImageTiled(51, 479, 392, 17, 0x2775);
            this.AddImageTiled(415, 29, 44, 450, 0xA2D);
            this.AddImageTiled(415, 29, 30, 450, 0x28DC);
            this.AddImage(370, 50, 0x589);

            this.AddImage(379, 60, 0x15A9);
            this.AddImage(425, 0, 0x28C9);
            this.AddImage(90, 33, 0x232D);
            this.AddImageTiled(130, 65, 175, 1, 0x238D);

            AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

            AddPage(1);</pre>

Fragment 4 in file Scripts\Services\ExploringTheDeep\Questers\CusteauPerron.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            AddPage(0);
            this.AddImageTiled(50, 20, 400, 460, 0x1404);
            this.AddImageTiled(50, 29, 30, 450, 0x28DC);
            this.AddImageTiled(34, 140, 17, 339, 0x242F);
            this.AddImage(48, 135, 0x28AB);
            this.AddImage(-16, 285, 0x28A2);
            this.AddImage(0, 10, 0x28B5);
            this.AddImage(25, 0, 0x28B4);
            this.AddImageTiled(83, 15, 350, 15, 0x280A);
            this.AddImage(34, 479, 0x2842);
            this.AddImage(442, 479, 0x2840);
            this.AddImageTiled(51, 479, 392, 17, 0x2775);
            this.AddImageTiled(415, 29, 44, 450, 0xA2D);
            this.AddImageTiled(415, 29, 30, 450, 0x28DC);
            this.AddImage(370, 50, 0x589);

            this.AddImage(379, 60, 0x15A9);
            this.AddImage(425, 0, 0x28C9);
            this.AddImage(90, 33, 0x232D);
            this.AddImageTiled(130, 65, 175, 1, 0x238D);

            AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

            AddPage(1);</pre>

Fragment 5 in file Scripts\Services\ExploringTheDeep\Questers\CusteauPerron.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            AddPage(0);
            this.AddImageTiled(50, 20, 400, 460, 0x1404);
            this.AddImageTiled(50, 29, 30, 450, 0x28DC);
            this.AddImageTiled(34, 140, 17, 339, 0x242F);
            this.AddImage(48, 135, 0x28AB);
            this.AddImage(-16, 285, 0x28A2);
            this.AddImage(0, 10, 0x28B5);
            this.AddImage(25, 0, 0x28B4);
            this.AddImageTiled(83, 15, 350, 15, 0x280A);
            this.AddImage(34, 479, 0x2842);
            this.AddImage(442, 479, 0x2840);
            this.AddImageTiled(51, 479, 392, 17, 0x2775);
            this.AddImageTiled(415, 29, 44, 450, 0xA2D);
            this.AddImageTiled(415, 29, 30, 450, 0x28DC);
            this.AddImage(370, 50, 0x589);

            this.AddImage(379, 60, 0x15A9);
            this.AddImage(425, 0, 0x28C9);
            this.AddImage(90, 33, 0x232D);
            this.AddImageTiled(130, 65, 175, 1, 0x238D);

            AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

            AddPage(1);</pre>

Fragment 6 in file Scripts\Services\ExploringTheDeep\Questers\GipsyGemologist.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            AddPage(0);
            this.AddImageTiled(50, 20, 400, 460, 0x1404);
            this.AddImageTiled(50, 29, 30, 450, 0x28DC);
            this.AddImageTiled(34, 140, 17, 339, 0x242F);
            this.AddImage(48, 135, 0x28AB);
            this.AddImage(-16, 285, 0x28A2);
            this.AddImage(0, 10, 0x28B5);
            this.AddImage(25, 0, 0x28B4);
            this.AddImageTiled(83, 15, 350, 15, 0x280A);
            this.AddImage(34, 479, 0x2842);
            this.AddImage(442, 479, 0x2840);
            this.AddImageTiled(51, 479, 392, 17, 0x2775);
            this.AddImageTiled(415, 29, 44, 450, 0xA2D);
            this.AddImageTiled(415, 29, 30, 450, 0x28DC);
            this.AddImage(370, 50, 0x589);

            this.AddImage(379, 60, 0x15A9);
            this.AddImage(425, 0, 0x28C9);
            this.AddImage(90, 33, 0x232D);
            this.AddImageTiled(130, 65, 175, 1, 0x238D);

            AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

            AddPage(1);</pre>

Fragment 7 in file Scripts\Services\ExploringTheDeep\Questers\GipsyGemologist.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            AddPage(0);
            this.AddImageTiled(50, 20, 400, 460, 0x1404);
            this.AddImageTiled(50, 29, 30, 450, 0x28DC);
            this.AddImageTiled(34, 140, 17, 339, 0x242F);
            this.AddImage(48, 135, 0x28AB);
            this.AddImage(-16, 285, 0x28A2);
            this.AddImage(0, 10, 0x28B5);
            this.AddImage(25, 0, 0x28B4);
            this.AddImageTiled(83, 15, 350, 15, 0x280A);
            this.AddImage(34, 479, 0x2842);
            this.AddImage(442, 479, 0x2840);
            this.AddImageTiled(51, 479, 392, 17, 0x2775);
            this.AddImageTiled(415, 29, 44, 450, 0xA2D);
            this.AddImageTiled(415, 29, 30, 450, 0x28DC);
            this.AddImage(370, 50, 0x589);

            this.AddImage(379, 60, 0x15A9);
            this.AddImage(425, 0, 0x28C9);
            this.AddImage(90, 33, 0x232D);
            this.AddImageTiled(130, 65, 175, 1, 0x238D);

            AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

            AddPage(1);</pre>

Fragment 8 in file Scripts\Services\ExploringTheDeep\Questers\HeplerPaulson.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            AddPage(0);
            this.AddImageTiled(50, 20, 400, 460, 0x1404);
            this.AddImageTiled(50, 29, 30, 450, 0x28DC);
            this.AddImageTiled(34, 140, 17, 339, 0x242F);
            this.AddImage(48, 135, 0x28AB);
            this.AddImage(-16, 285, 0x28A2);
            this.AddImage(0, 10, 0x28B5);
            this.AddImage(25, 0, 0x28B4);
            this.AddImageTiled(83, 15, 350, 15, 0x280A);
            this.AddImage(34, 479, 0x2842);
            this.AddImage(442, 479, 0x2840);
            this.AddImageTiled(51, 479, 392, 17, 0x2775);
            this.AddImageTiled(415, 29, 44, 450, 0xA2D);
            this.AddImageTiled(415, 29, 30, 450, 0x28DC);
            this.AddImage(370, 50, 0x589);

            this.AddImage(379, 60, 0x15A9);
            this.AddImage(425, 0, 0x28C9);
            this.AddImage(90, 33, 0x232D);
            this.AddImageTiled(130, 65, 175, 1, 0x238D);

            AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

            AddPage(1);</pre>

Fragment 9 in file Scripts\Services\ExploringTheDeep\Questers\HeplerPaulson.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            AddPage(0);
            this.AddImageTiled(50, 20, 400, 460, 0x1404);
            this.AddImageTiled(50, 29, 30, 450, 0x28DC);
            this.AddImageTiled(34, 140, 17, 339, 0x242F);
            this.AddImage(48, 135, 0x28AB);
            this.AddImage(-16, 285, 0x28A2);
            this.AddImage(0, 10, 0x28B5);
            this.AddImage(25, 0, 0x28B4);
            this.AddImageTiled(83, 15, 350, 15, 0x280A);
            this.AddImage(34, 479, 0x2842);
            this.AddImage(442, 479, 0x2840);
            this.AddImageTiled(51, 479, 392, 17, 0x2775);
            this.AddImageTiled(415, 29, 44, 450, 0xA2D);
            this.AddImageTiled(415, 29, 30, 450, 0x28DC);
            this.AddImage(370, 50, 0x589);

            this.AddImage(379, 60, 0x15A9);
            this.AddImage(425, 0, 0x28C9);
            this.AddImage(90, 33, 0x232D);
            this.AddImageTiled(130, 65, 175, 1, 0x238D);

            AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

            AddPage(1);</pre>

Fragment 10 in file Scripts\Services\ExploringTheDeep\Questers\HeplerPaulson.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            AddPage(0);
            this.AddImageTiled(50, 20, 400, 460, 0x1404);
            this.AddImageTiled(50, 29, 30, 450, 0x28DC);
            this.AddImageTiled(34, 140, 17, 339, 0x242F);
            this.AddImage(48, 135, 0x28AB);
            this.AddImage(-16, 285, 0x28A2);
            this.AddImage(0, 10, 0x28B5);
            this.AddImage(25, 0, 0x28B4);
            this.AddImageTiled(83, 15, 350, 15, 0x280A);
            this.AddImage(34, 479, 0x2842);
            this.AddImage(442, 479, 0x2840);
            this.AddImageTiled(51, 479, 392, 17, 0x2775);
            this.AddImageTiled(415, 29, 44, 450, 0xA2D);
            this.AddImageTiled(415, 29, 30, 450, 0x28DC);
            this.AddImage(370, 50, 0x589);

            this.AddImage(379, 60, 0x15A9);
            this.AddImage(425, 0, 0x28C9);
            this.AddImage(90, 33, 0x232D);
            this.AddImageTiled(130, 65, 175, 1, 0x238D);

            AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

            AddPage(1);</pre>

Fragment 11 in file Scripts\Services\ExploringTheDeep\Questers\JosefSkimmons.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            AddPage(0);
            this.AddImageTiled(50, 20, 400, 460, 0x1404);
            this.AddImageTiled(50, 29, 30, 450, 0x28DC);
            this.AddImageTiled(34, 140, 17, 339, 0x242F);
            this.AddImage(48, 135, 0x28AB);
            this.AddImage(-16, 285, 0x28A2);
            this.AddImage(0, 10, 0x28B5);
            this.AddImage(25, 0, 0x28B4);
            this.AddImageTiled(83, 15, 350, 15, 0x280A);
            this.AddImage(34, 479, 0x2842);
            this.AddImage(442, 479, 0x2840);
            this.AddImageTiled(51, 479, 392, 17, 0x2775);
            this.AddImageTiled(415, 29, 44, 450, 0xA2D);
            this.AddImageTiled(415, 29, 30, 450, 0x28DC);
            this.AddImage(370, 50, 0x589);

            this.AddImage(379, 60, 0x15A9);
            this.AddImage(425, 0, 0x28C9);
            this.AddImage(90, 33, 0x232D);
            this.AddImageTiled(130, 65, 175, 1, 0x238D);

            AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

            AddPage(1);</pre>

Fragment 12 in file Scripts\Services\ExploringTheDeep\Questers\JosefSkimmons.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            AddPage(0);
            this.AddImageTiled(50, 20, 400, 460, 0x1404);
            this.AddImageTiled(50, 29, 30, 450, 0x28DC);
            this.AddImageTiled(34, 140, 17, 339, 0x242F);
            this.AddImage(48, 135, 0x28AB);
            this.AddImage(-16, 285, 0x28A2);
            this.AddImage(0, 10, 0x28B5);
            this.AddImage(25, 0, 0x28B4);
            this.AddImageTiled(83, 15, 350, 15, 0x280A);
            this.AddImage(34, 479, 0x2842);
            this.AddImage(442, 479, 0x2840);
            this.AddImageTiled(51, 479, 392, 17, 0x2775);
            this.AddImageTiled(415, 29, 44, 450, 0xA2D);
            this.AddImageTiled(415, 29, 30, 450, 0x28DC);
            this.AddImage(370, 50, 0x589);

            this.AddImage(379, 60, 0x15A9);
            this.AddImage(425, 0, 0x28C9);
            this.AddImage(90, 33, 0x232D);
            this.AddImageTiled(130, 65, 175, 1, 0x238D);

            AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

            AddPage(1);</pre>

Fragment 13 in file Scripts\Services\ExploringTheDeep\Questers\MadelineHarte.cs

<pre>this.Closable = false;
        this.Disposable = true;
        this.Dragable = true;
        this.Resizable = false;

        AddPage(0);
        this.AddImageTiled(50, 20, 400, 460, 0x1404);
        this.AddImageTiled(50, 29, 30, 450, 0x28DC);
        this.AddImageTiled(34, 140, 17, 339, 0x242F);
        this.AddImage(48, 135, 0x28AB);
        this.AddImage(-16, 285, 0x28A2);
        this.AddImage(0, 10, 0x28B5);
        this.AddImage(25, 0, 0x28B4);
        this.AddImageTiled(83, 15, 350, 15, 0x280A);
        this.AddImage(34, 479, 0x2842);
        this.AddImage(442, 479, 0x2840);
        this.AddImageTiled(51, 479, 392, 17, 0x2775);
        this.AddImageTiled(415, 29, 44, 450, 0xA2D);
        this.AddImageTiled(415, 29, 30, 450, 0x28DC);
        this.AddImage(370, 50, 0x589);

        this.AddImage(379, 60, 0x15A9);
        this.AddImage(425, 0, 0x28C9);
        this.AddImage(90, 33, 0x232D);
        this.AddImageTiled(130, 65, 175, 1, 0x238D);

        AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

        AddPage(1);</pre>

Fragment 14 in file Scripts\Services\ExploringTheDeep\Questers\MadelineHarte.cs

<pre>this.Closable = false;
        this.Disposable = true;
        this.Dragable = true;
        this.Resizable = false;

        AddPage(0);
        this.AddImageTiled(50, 20, 400, 460, 0x1404);
        this.AddImageTiled(50, 29, 30, 450, 0x28DC);
        this.AddImageTiled(34, 140, 17, 339, 0x242F);
        this.AddImage(48, 135, 0x28AB);
        this.AddImage(-16, 285, 0x28A2);
        this.AddImage(0, 10, 0x28B5);
        this.AddImage(25, 0, 0x28B4);
        this.AddImageTiled(83, 15, 350, 15, 0x280A);
        this.AddImage(34, 479, 0x2842);
        this.AddImage(442, 479, 0x2840);
        this.AddImageTiled(51, 479, 392, 17, 0x2775);
        this.AddImageTiled(415, 29, 44, 450, 0xA2D);
        this.AddImageTiled(415, 29, 30, 450, 0x28DC);
        this.AddImage(370, 50, 0x589);

        this.AddImage(379, 60, 0x15A9);
        this.AddImage(425, 0, 0x28C9);
        this.AddImage(90, 33, 0x232D);
        this.AddImageTiled(130, 65, 175, 1, 0x238D);

        AddHtmlLocalized(140, 45, 250, 24, 1154327, 0x7FFF, false, false); // Exploring the Deep

        AddPage(1);</pre>

## Duplicated Code. Size: 565

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>AddImageTiled( 15, height - 110, 320, 20, 0xdb3 );

                AddButton( 130, height - 35, 0xFA8, 0xFAA, 100, GumpButtonType.Reply, 0 );
                AddLabel( 165, height - 35, 0, XmlPoints.GetText(from, 200528) );      // "Add"

                AddButton( 240, height - 35, 0xFB7, 0xFB9, 300, GumpButtonType.Reply, 0 );
                AddLabel( 275, height - 35, 0, XmlPoints.GetText(from, 200529) );     // "Start"

                // set entry fee
                AddButton( 20, height - 85, 0xFAE, 0xFAF, 10, GumpButtonType.Reply, 0 );
                AddImageTiled(120, height - 85, 60, 19, textentrybackground );
                AddTextEntry( 120, height - 85, 60, 25, 0, 10 ,m_gauntlet.EntryFee.ToString() );
                AddLabel( 55, height - 85, 0, XmlPoints.GetText(from, 200572) );  // "Entry Fee: "

                // set arena size
                AddButton( 20, height - 60, 0xFAE, 0xFAF, 20, GumpButtonType.Reply, 0 );
                AddImageTiled(130, height - 60, 30, 19, textentrybackground );
                AddTextEntry( 130, height - 60, 30, 25, 0, 20 ,m_gauntlet.ArenaSize.ToString() );
                AddLabel( 55, height - 60, 0, XmlPoints.GetText(from, 200573) );    //  "Arena Size: "

                // set target score
                AddButton( 200, height - 85, 0xFAE, 0xFAF, 30, GumpButtonType.Reply, 0 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>AddImageTiled( 15, height - 110, 320, 20, 0xdb3 );

                AddButton( 130, height - 35, 0xFA8, 0xFAA, 100, GumpButtonType.Reply, 0 );
                AddLabel( 165, height - 35, 0, XmlPoints.GetText(from, 200528) );      // "Add"

                AddButton( 240, height - 35, 0xFB7, 0xFB9, 300, GumpButtonType.Reply, 0 );
                AddLabel( 275, height - 35, 0, XmlPoints.GetText(from, 200529) );     // "Start"

                // set entry fee
                AddButton( 20, height - 85, 0xFAE, 0xFAF, 10, GumpButtonType.Reply, 0 );
                AddImageTiled(120, height - 85, 60, 19, textentrybackground );
                AddTextEntry( 120, height - 85, 60, 25, 0, 10 ,m_gauntlet.EntryFee.ToString() );
                AddLabel( 55, height - 85, 0, XmlPoints.GetText(from, 200572) );  // "Entry Fee: "

                // set arena size
                AddButton( 20, height - 60, 0xFAE, 0xFAF, 20, GumpButtonType.Reply, 0 );
                AddImageTiled(130, height - 60, 30, 19, textentrybackground );
                AddTextEntry( 130, height - 60, 30, 25, 0, 20 ,m_gauntlet.ArenaSize.ToString() );
                AddLabel( 55, height - 60, 0, XmlPoints.GetText(from, 200573) );    //  "Arena Size: "

                // set target score
                AddButton( 200, height - 85, 0xFAE, 0xFAF, 30, GumpButtonType.Reply, 0 );</pre>

## Duplicated Code. Size: 562

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>m_WorkingList = (ArrayList)gauntlet.Participants.Clone();

				AddLabel(150, 50, 0, String.Format(XmlPoints.GetText(from, 200504), m_WorkingList.Count * m_gauntlet.EntryFee)); // "Total Purse: {0}"

				AddLabel(150, 70, 0, String.Format(XmlPoints.GetText(from, 200505), m_gauntlet.Location, m_gauntlet.Map));  // "Loc: {0} {1}"

				AddLabel(20, 90, 0, String.Format(XmlPoints.GetText(from, 200506), gauntlet.Participants.Count));   // "Players: {0}"

				AddLabel(150, 90, 0, String.Format(XmlPoints.GetText(from, 200507), gauntlet.ActivePlayers()));  // "Active: {0}"

				if (gauntlet.TargetScore > 0)
					AddLabel(20, 110, 0, String.Format(XmlPoints.GetText(from, 200561), gauntlet.TargetScore));  // "Target Score: {0}"
				else
					AddLabel(20, 110, 0, XmlPoints.GetText(from, 200562)); // "Target Score: None"

				if (gauntlet.MatchLength > TimeSpan.Zero)
					AddLabel(150, 110, 0, String.Format(XmlPoints.GetText(from, 200563), gauntlet.MatchLength));  // "Match Length: {0}"
				else
					AddLabel(150, 110, 0, XmlPoints.GetText(from, 200564));   // "Match Length: Unlimited"

				int yoffset = 155;

				// page up and down buttons
				AddButton(300, 130, 0x15E0, 0x15E4, 13, GumpButtonType.Reply, 0);
				AddButton(320, 130, 0x15E2, 0x15E6, 12, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>m_WorkingList = (ArrayList)gauntlet.Participants.Clone();

                AddLabel( 150, 50, 0, String.Format(XmlPoints.GetText(from, 200504), m_WorkingList.Count*m_gauntlet.EntryFee)); // "Total Purse: {0}"

                AddLabel( 150, 70, 0, String.Format(XmlPoints.GetText(from, 200505), m_gauntlet.Location, m_gauntlet.Map));  // "Loc: {0} {1}"

                AddLabel( 20, 90, 0, String.Format(XmlPoints.GetText(from, 200506), gauntlet.Participants.Count));   // "Players: {0}"

                AddLabel( 150, 90, 0, String.Format(XmlPoints.GetText(from, 200507), gauntlet.ActivePlayers()));  // "Active: {0}"

                if(gauntlet.TargetScore > 0)
                    AddLabel( 20, 110, 0, String.Format(XmlPoints.GetText(from, 200561), gauntlet.TargetScore));  // "Target Score: {0}"
                else
                    AddLabel( 20, 110, 0, XmlPoints.GetText(from, 200562)); // "Target Score: None"

                if(gauntlet.MatchLength > TimeSpan.Zero)
                    AddLabel( 150, 110, 0, String.Format(XmlPoints.GetText(from, 200563), gauntlet.MatchLength));  // "Match Length: {0}"
                else
                    AddLabel( 150, 110, 0, XmlPoints.GetText(from, 200564));   // "Match Length: Unlimited"

                int yoffset = 155;

                // page up and down buttons
                AddButton( 300, 130, 0x15E0, 0x15E4, 13, GumpButtonType.Reply, 0 );
                AddButton( 320, 130, 0x15E2, 0x15E6, 12, GumpButtonType.Reply, 0 );</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>m_WorkingList = (ArrayList)gauntlet.Participants.Clone();

                AddLabel( 150, 50, 0, String.Format(XmlPoints.GetText(from, 200504), m_WorkingList.Count*m_gauntlet.EntryFee)); // "Total Purse: {0}"

                AddLabel( 150, 70, 0, String.Format(XmlPoints.GetText(from, 200505), m_gauntlet.Location, m_gauntlet.Map));  // "Loc: {0} {1}"

                AddLabel( 20, 90, 0, String.Format(XmlPoints.GetText(from, 200506), gauntlet.Participants.Count));   // "Players: {0}"

                AddLabel( 150, 90, 0, String.Format(XmlPoints.GetText(from, 200507), gauntlet.ActivePlayers()));  // "Active: {0}"

                if(gauntlet.TargetScore > 0)
                    AddLabel( 20, 110, 0, String.Format(XmlPoints.GetText(from, 200561), gauntlet.TargetScore));  // "Target Score: {0}"
                else
                    AddLabel( 20, 110, 0, XmlPoints.GetText(from, 200562)); // "Target Score: None"

                if(gauntlet.MatchLength > TimeSpan.Zero)
                    AddLabel( 150, 110, 0, String.Format(XmlPoints.GetText(from, 200563), gauntlet.MatchLength));  // "Match Length: {0}"
                else
                    AddLabel( 150, 110, 0, XmlPoints.GetText(from, 200564));   // "Match Length: Unlimited"

                int yoffset = 155;

                // page up and down buttons
                AddButton( 300, 130, 0x15E0, 0x15E4, 13, GumpButtonType.Reply, 0 );
                AddButton( 320, 130, 0x15E2, 0x15E6, 12, GumpButtonType.Reply, 0 );</pre>

## Duplicated Code. Size: 561

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBProvisioner.cs

<pre>this.Add(new GenericBuyInfo(typeof(FloppyHat), 7, 20, 0x1713, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(WideBrimHat), 8, 20, 0x1714, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(Cap), 10, 20, 0x1715, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(TallStrawHat), 8, 20, 0x1716, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(StrawHat), 7, 20, 0x1717, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(WizardsHat), 11, 20, 0x1718, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(LeatherCap), 10, 20, 0x1DB9, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(FeatheredHat), 10, 20, 0x171A, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(TricorneHat), 8, 20, 0x171B, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(Bandana), 6, 20, 0x1540, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(SkullCap), 7, 20, 0x1544, Utility.RandomDyedHue()));</pre>

Fragment 2 in file Scripts\VendorInfo\SBTailor.cs

<pre>this.Add(new GenericBuyInfo(typeof(FloppyHat), 7, 20, 0x1713, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(WideBrimHat), 8, 20, 0x1714, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(Cap), 10, 20, 0x1715, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(TallStrawHat), 8, 20, 0x1716, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(StrawHat), 7, 20, 0x1717, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(WizardsHat), 11, 20, 0x1718, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(LeatherCap), 10, 20, 0x1DB9, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(FeatheredHat), 10, 20, 0x171A, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(TricorneHat), 8, 20, 0x171B, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(Bandana), 6, 20, 0x1540, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(SkullCap), 7, 20, 0x1544, Utility.RandomDyedHue()));</pre>

## Duplicated Code. Size: 559

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\PowerScroll.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(from.Location, from.Map, EffectItem.DefaultDuration), 0, 0, 0, 0, 0, 5060, 0);
            Effects.PlaySound(from.Location, from.Map, 0x243);

            Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 6, from.Y - 6, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);
            Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 4, from.Y - 6, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);
            Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 6, from.Y - 4, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);

            Effects.SendTargetParticles(from, 0x375A, 35, 90, 0x00, 0x00, 9502, (EffectLayer)255, 0x100);

            this.Delete();</pre>

Fragment 2 in file Scripts\Items\Consumables\StatScroll.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(from.Location, from.Map, EffectItem.DefaultDuration), 0, 0, 0, 0, 0, 5060, 0);
            Effects.PlaySound(from.Location, from.Map, 0x243);

            Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 6, from.Y - 6, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);
            Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 4, from.Y - 6, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);
            Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 6, from.Y - 4, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);

            Effects.SendTargetParticles(from, 0x375A, 35, 90, 0x00, 0x00, 9502, (EffectLayer)255, 0x100);

            this.Delete();</pre>

## Duplicated Code. Size: 552

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\HireRanger.cs

<pre>this.SpeechHue = Utility.RandomDyedHue();
            this.Hue = Utility.RandomSkinHue();

            if (this.Female = Utility.RandomBool()) 
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");
            }
            else 
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
                this.AddItem(new ShortPants(Utility.RandomNeutralHue()));
            }
            this.Title = "the ranger";
            this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();
            this.Race.RandomFacialHair(this);

            this.SetStr(91, 91);
            this.SetDex(76, 76);
            this.SetInt(61, 61);

            this.SetDamage(13, 24);

            this.SetSkill(SkillName.Wrestling, 15, 37);
            this.SetSkill(SkillName.Parry, 45, 60);
            this.SetSkill(SkillName.Archery, 66, 97);
            this.SetSkill(SkillName.Magery, 62, 62);
            this.SetSkill(SkillName.Swords, 35, 57);
            this.SetSkill(SkillName.Fencing, 15, 37);
            this.SetSkill(SkillName.Tactics, 65, 87);

            this.Fame = 100;
            this.Karma = 125;

            this.AddItem(new Shoes(Utility.RandomNeutralHue()));
            this.AddItem(new Shirt());</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HireRangerArcher.cs

<pre>this.SpeechHue = Utility.RandomDyedHue();
            this.Hue = Utility.RandomSkinHue();

            if (this.Female = Utility.RandomBool()) 
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");
            }
            else 
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
                this.AddItem(new ShortPants(Utility.RandomNeutralHue()));
            }
            this.Title = "the ranger";
            this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();
            this.Race.RandomFacialHair(this);

            this.SetStr(91, 91);
            this.SetDex(76, 76);
            this.SetInt(61, 61);

            this.SetDamage(13, 24);

            this.SetSkill(SkillName.Wrestling, 15, 37);
            this.SetSkill(SkillName.Parry, 45, 60);
            this.SetSkill(SkillName.Archery, 66, 97);
            this.SetSkill(SkillName.Magery, 62, 62);
            this.SetSkill(SkillName.Swords, 35, 57);
            this.SetSkill(SkillName.Fencing, 15, 37);
            this.SetSkill(SkillName.Tactics, 65, 87);

            this.Fame = 100;
            this.Karma = 125;

            this.AddItem(new Shoes(Utility.RandomNeutralHue()));
            this.AddItem(new Shirt());</pre>

## Duplicated Code. Size: 548

### Duplicated Fragments:

Fragment 1 in file Scripts\Deprecated\FiveOvercapStatScroll.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(from.Location, from.Map, EffectItem.DefaultDuration), 0, 0, 0, 0, 0, 5060, 0);
                    Effects.PlaySound(from.Location, from.Map, 0x243);
                    Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 6, from.Y - 6, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);
                    Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 4, from.Y - 6, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);
                    Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 6, from.Y - 4, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);
                    Effects.SendTargetParticles(from, 0x375A, 35, 90, 0x00, 0x00, 9502, (EffectLayer)255, 0x100);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Loot\ScrollofValiantCommendation.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(from.Location, from.Map, EffectItem.DefaultDuration), 0, 0, 0, 0, 0, 5060, 0);
                    Effects.PlaySound(from.Location, from.Map, 0x243);

                    Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 6, from.Y - 6, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);
                    Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 4, from.Y - 6, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);
                    Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 6, from.Y - 4, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);

                    Effects.SendTargetParticles(from, 0x375A, 35, 90, 0x00, 0x00, 9502, (EffectLayer)255, 0x100);</pre>

## Duplicated Code. Size: 543

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Docs.cs

<pre>lbod.AmountMax = 10;

			if (showCloth)
			{
				lbod.Material = BulkMaterialType.None;

				if (expandCloth)
				{
					lbod.AmountMax = 10;
					DocumentTailorBOD(html, lbod.ComputeRewards(true), "10, 15", lbod.Material, type);
					lbod.AmountMax = 20;
					DocumentTailorBOD(html, lbod.ComputeRewards(true), "20", lbod.Material, type);
				}
				else
				{
					lbod.AmountMax = 10;
					DocumentTailorBOD(html, lbod.ComputeRewards(true), "10, 15, 20", lbod.Material, type);
				}
			}

			lbod.Material = BulkMaterialType.None;

			if (expandPlain)
			{
				lbod.AmountMax = 10;
				DocumentTailorBOD(html, lbod.ComputeRewards(true), "10, 15, 20", lbod.Material, typeof(LeatherCap));
				lbod.AmountMax = 20;
				DocumentTailorBOD(html, lbod.ComputeRewards(true), "20", lbod.Material, typeof(LeatherCap));
			}
			else
			{
				lbod.AmountMax = 10;
				DocumentTailorBOD(html, lbod.ComputeRewards(true), "10, 15, 20", lbod.Material, typeof(LeatherCap));
			}

			for (var mat = BulkMaterialType.Spined; mat <= BulkMaterialType.Barbed; ++mat)
			{
				lbod.Material = mat;
				lbod.AmountMax = 10;
				DocumentTailorBOD(html, lbod.ComputeRewards(true), "10, 15", lbod.Material, type);
				lbod.AmountMax = 20;
				DocumentTailorBOD(html, lbod.ComputeRewards(true), "20", lbod.Material, type);
			}</pre>

Fragment 2 in file Scripts\Commands\Docs.cs

<pre>lbod.AmountMax = 10;

			if (showCloth)
			{
				lbod.Material = BulkMaterialType.None;

				if (expandCloth)
				{
					lbod.AmountMax = 10;
					DocumentTailorBOD(html, lbod.ComputeRewards(true), "10, 15", lbod.Material, type);
					lbod.AmountMax = 20;
					DocumentTailorBOD(html, lbod.ComputeRewards(true), "20", lbod.Material, type);
				}
				else
				{
					lbod.AmountMax = 10;
					DocumentTailorBOD(html, lbod.ComputeRewards(true), "10, 15, 20", lbod.Material, type);
				}
			}

			lbod.Material = BulkMaterialType.None;

			if (expandPlain)
			{
				lbod.AmountMax = 10;
				DocumentTailorBOD(html, lbod.ComputeRewards(true), "10, 15, 20", lbod.Material, typeof(LeatherCap));
				lbod.AmountMax = 20;
				DocumentTailorBOD(html, lbod.ComputeRewards(true), "20", lbod.Material, typeof(LeatherCap));
			}
			else
			{
				lbod.AmountMax = 10;
				DocumentTailorBOD(html, lbod.ComputeRewards(true), "10, 15, 20", lbod.Material, typeof(LeatherCap));
			}

			for (var mat = BulkMaterialType.Spined; mat <= BulkMaterialType.Barbed; ++mat)
			{
				lbod.Material = mat;
				lbod.AmountMax = 10;
				DocumentTailorBOD(html, lbod.ComputeRewards(true), "10, 15", lbod.Material, type);
				lbod.AmountMax = 20;
				DocumentTailorBOD(html, lbod.ComputeRewards(true), "20", lbod.Material, type);
			}</pre>

## Duplicated Code. Size: 539

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>Spellbook book = new Spellbook();
            book.Movable = false;
            book.LootType = LootType.Newbied;
            book.Content = 0xFFFFFFFFFFFFFFFF;
            this.AddItem(book);

            LeatherArms lea = new LeatherArms();
            lea.Movable = false;
            lea.LootType = LootType.Newbied;
            lea.Crafter = this;
            lea.Quality = ArmorQuality.Regular;
            this.AddItem(lea);

            LeatherChest lec = new LeatherChest();
            lec.Movable = false;
            lec.LootType = LootType.Newbied;
            lec.Crafter = this;
            lec.Quality = ArmorQuality.Regular;
            this.AddItem(lec);

            LeatherGorget leg = new LeatherGorget();
            leg.Movable = false;
            leg.LootType = LootType.Newbied;
            leg.Crafter = this;
            leg.Quality = ArmorQuality.Regular;
            this.AddItem(leg);

            LeatherLegs lel = new LeatherLegs();
            lel.Movable = false;
            lel.LootType = LootType.Newbied;
            lel.Crafter = this;
            lel.Quality = ArmorQuality.Regular;
            this.AddItem(lel);

            Sandals snd = new Sandals();
            snd.Hue = iHue;
            snd.LootType = LootType.Newbied;
            this.AddItem(snd);

            Cap cap = new Cap();
            cap.Hue = iHue;
            this.AddItem(cap);

            Robe robe = new Robe();
            robe.Hue = iHue;
            this.AddItem(robe);</pre>

Fragment 2 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>Spellbook book = new Spellbook();
            book.Movable = false;
            book.LootType = LootType.Newbied;
            book.Content = 0xFFFFFFFFFFFFFFFF;
            this.AddItem(book);

            LeatherArms lea = new LeatherArms();
            lea.Movable = false;
            lea.LootType = LootType.Newbied;
            lea.Crafter = this;
            lea.Quality = ArmorQuality.Regular;
            this.AddItem(lea);

            LeatherChest lec = new LeatherChest();
            lec.Movable = false;
            lec.LootType = LootType.Newbied;
            lec.Crafter = this;
            lec.Quality = ArmorQuality.Regular;
            this.AddItem(lec);

            LeatherGorget leg = new LeatherGorget();
            leg.Movable = false;
            leg.LootType = LootType.Newbied;
            leg.Crafter = this;
            leg.Quality = ArmorQuality.Regular;
            this.AddItem(leg);

            LeatherLegs lel = new LeatherLegs();
            lel.Movable = false;
            lel.LootType = LootType.Newbied;
            lel.Crafter = this;
            lel.Quality = ArmorQuality.Regular;
            this.AddItem(lel);

            Sandals snd = new Sandals();
            snd.Hue = iHue;
            snd.LootType = LootType.Newbied;
            this.AddItem(snd);

            Cap cap = new Cap();
            cap.Hue = iHue;
            this.AddItem(cap);

            Robe robe = new Robe();
            robe.Hue = iHue;
            this.AddItem(robe);</pre>

## Duplicated Code. Size: 530

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BoneKnight.cs

<pre>BaseSoundID = 451;

            SetStr(196, 250);
            SetDex(76, 95);
            SetInt(36, 60);

            SetHits(118, 150);

            SetDamage(8, 18);

            SetDamageType(ResistanceType.Physical, 40);
            SetDamageType(ResistanceType.Cold, 60);

            SetResistance(ResistanceType.Physical, 35, 45);
            SetResistance(ResistanceType.Fire, 20, 30);
            SetResistance(ResistanceType.Cold, 50, 60);
            SetResistance(ResistanceType.Poison, 20, 30);
            SetResistance(ResistanceType.Energy, 30, 40);

            SetSkill(SkillName.MagicResist, 65.1, 80.0);
            SetSkill(SkillName.Tactics, 85.1, 100.0);
            SetSkill(SkillName.Wrestling, 85.1, 95.0);

            Fame = 3000;
            Karma = -3000;

            VirtualArmor = 40;

            switch ( Utility.Random(6) )
            {
                case 0:
                    PackItem(new PlateArms());
                    break;
                case 1:
                    PackItem(new PlateChest());
                    break;
                case 2:
                    PackItem(new PlateGloves());
                    break;
                case 3:
                    PackItem(new PlateGorget());
                    break;
                case 4:
                    PackItem(new PlateLegs());
                    break;
                case 5:
                    PackItem(new PlateHelm());
                    break;
            }

            PackItem(new Scimitar());
            PackItem(new WoodenShield());</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SkeletalKnight.cs

<pre>BaseSoundID = 451;

            SetStr(196, 250);
            SetDex(76, 95);
            SetInt(36, 60);

            SetHits(118, 150);

            SetDamage(8, 18);

            SetDamageType(ResistanceType.Physical, 40);
            SetDamageType(ResistanceType.Cold, 60);

            SetResistance(ResistanceType.Physical, 35, 45);
            SetResistance(ResistanceType.Fire, 20, 30);
            SetResistance(ResistanceType.Cold, 50, 60);
            SetResistance(ResistanceType.Poison, 20, 30);
            SetResistance(ResistanceType.Energy, 30, 40);

            SetSkill(SkillName.MagicResist, 65.1, 80.0);
            SetSkill(SkillName.Tactics, 85.1, 100.0);
            SetSkill(SkillName.Wrestling, 85.1, 95.0);

            Fame = 3000;
            Karma = -3000;

            VirtualArmor = 40;

            switch ( Utility.Random(6) )
            {
                case 0:
                    PackItem(new PlateArms());
                    break;
                case 1:
                    PackItem(new PlateChest());
                    break;
                case 2:
                    PackItem(new PlateGloves());
                    break;
                case 3:
                    PackItem(new PlateGorget());
                    break;
                case 4:
                    PackItem(new PlateLegs());
                    break;
                case 5:
                    PackItem(new PlateHelm());
                    break;
            }

            PackItem(new Scimitar());
            PackItem(new WoodenShield());</pre>

## Duplicated Code. Size: 529

### Duplicated Fragments:

Fragment 1 in file Ultima\Hues.cs

<pre>{
			BitmapData bd = bmp.LockBits(
				new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.ReadWrite, PixelFormat.Format16bppArgb1555);

			int stride = bd.Stride >> 1;
			int width = bd.Width;
			int height = bd.Height;
			int delta = stride - width;

			var pBuffer = (ushort*)bd.Scan0;
			ushort* pLineEnd = pBuffer + width;
			ushort* pImageEnd = pBuffer + (stride * height);

			if (onlyHueGrayPixels)
			{
				int c;
				int r;
				int g;
				int b;

				while (pBuffer < pImageEnd)
				{
					while (pBuffer < pLineEnd)
					{
						c = *pBuffer;
						if (c != 0)
						{
							r = (c >> 10) & 0x1F;
							g = (c >> 5) & 0x1F;
							b = c & 0x1F;
							if (r == g && r == b)
							{
								*pBuffer = (ushort)Colors[(c >> 10) & 0x1F];
							}
						}
						++pBuffer;
					}

					pBuffer += delta;
					pLineEnd += stride;
				}
			}
			else
			{
				while (pBuffer < pImageEnd)
				{
					while (pBuffer < pLineEnd)
					{
						if (*pBuffer != 0)
						{
							*pBuffer = (ushort)Colors[(*pBuffer >> 10) & 0x1F];
						}
						++pBuffer;
					}

					pBuffer += delta;
					pLineEnd += stride;
				}
			}

			bmp.UnlockBits(bd);
		}</pre>

Fragment 2 in file Ultima\Hues.cs

<pre>{
			BitmapData bd = bmp.LockBits(
				new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.ReadWrite, PixelFormat.Format16bppArgb1555);

			int stride = bd.Stride >> 1;
			int width = bd.Width;
			int height = bd.Height;
			int delta = stride - width;

			var pBuffer = (ushort*)bd.Scan0;
			ushort* pLineEnd = pBuffer + width;
			ushort* pImageEnd = pBuffer + (stride * height);

			if (onlyHueGrayPixels)
			{
				int c;
				int r;
				int g;
				int b;

				while (pBuffer < pImageEnd)
				{
					while (pBuffer < pLineEnd)
					{
						c = *pBuffer;
						if (c != 0)
						{
							r = (c >> 10) & 0x1F;
							g = (c >> 5) & 0x1F;
							b = c & 0x1F;
							if (r == g && r == b)
							{
								*pBuffer = (ushort)Colors[(c >> 10) & 0x1F];
							}
						}
						++pBuffer;
					}

					pBuffer += delta;
					pLineEnd += stride;
				}
			}
			else
			{
				while (pBuffer < pImageEnd)
				{
					while (pBuffer < pLineEnd)
					{
						if (*pBuffer != 0)
						{
							*pBuffer = (ushort)Colors[(*pBuffer >> 10) & 0x1F];
						}
						++pBuffer;
					}

					pBuffer += delta;
					pLineEnd += stride;
				}
			}

			bmp.UnlockBits(bd);
		}</pre>

## Duplicated Code. Size: 528

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if ((prop = this.m_AosAttributes.WeaponDamage) != 0)
                list.Add(1060401, prop.ToString()); // damage increase ~1_val~%

            if ((prop = this.m_AosAttributes.DefendChance) != 0)
                list.Add(1060408, prop.ToString()); // defense chance increase ~1_val~%

            if ((prop = this.m_AosAttributes.BonusDex) != 0)
                list.Add(1060409, prop.ToString()); // dexterity bonus ~1_val~

            if ((prop = this.m_AosAttributes.EnhancePotions) != 0)
                list.Add(1060411, prop.ToString()); // enhance potions ~1_val~%

            if ((prop = this.m_AosAttributes.CastRecovery) != 0)
                list.Add(1060412, prop.ToString()); // faster cast recovery ~1_val~

            if ((prop = this.m_AosAttributes.CastSpeed) != 0)
                list.Add(1060413, prop.ToString()); // faster casting ~1_val~

            if ((prop = this.m_AosAttributes.AttackChance) != 0)
                list.Add(1060415, prop.ToString()); // hit chance increase ~1_val~%

            if ((prop = this.m_AosAttributes.BonusHits) != 0)
                list.Add(1060431, prop.ToString()); // hit point increase ~1_val~

            if ((prop = this.m_AosAttributes.BonusInt) != 0)
                list.Add(1060432, prop.ToString()); // intelligence bonus ~1_val~

            if ((prop = this.m_AosAttributes.LowerManaCost) != 0)
                list.Add(1060433, prop.ToString()); // lower mana cost ~1_val~%

            if ((prop = this.m_AosAttributes.LowerRegCost) != 0)
                list.Add(1060434, prop.ToString()); // lower reagent cost ~1_val~%</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if ((prop = this.m_AosAttributes.WeaponDamage) != 0)
                list.Add(1060401, prop.ToString()); // damage increase ~1_val~%

            if ((prop = this.m_AosAttributes.DefendChance) != 0)
                list.Add(1060408, prop.ToString()); // defense chance increase ~1_val~%

            if ((prop = this.m_AosAttributes.BonusDex) != 0)
                list.Add(1060409, prop.ToString()); // dexterity bonus ~1_val~

            if ((prop = this.m_AosAttributes.EnhancePotions) != 0)
                list.Add(1060411, prop.ToString()); // enhance potions ~1_val~%

            if ((prop = this.m_AosAttributes.CastRecovery) != 0)
                list.Add(1060412, prop.ToString()); // faster cast recovery ~1_val~

            if ((prop = this.m_AosAttributes.CastSpeed) != 0)
                list.Add(1060413, prop.ToString()); // faster casting ~1_val~

            if ((prop = this.m_AosAttributes.AttackChance) != 0)
                list.Add(1060415, prop.ToString()); // hit chance increase ~1_val~%

            if ((prop = this.m_AosAttributes.BonusHits) != 0)
                list.Add(1060431, prop.ToString()); // hit point increase ~1_val~

            if ((prop = this.m_AosAttributes.BonusInt) != 0)
                list.Add(1060432, prop.ToString()); // intelligence bonus ~1_val~

            if ((prop = this.m_AosAttributes.LowerManaCost) != 0)
                list.Add(1060433, prop.ToString()); // lower mana cost ~1_val~%

            if ((prop = this.m_AosAttributes.LowerRegCost) != 0)
                list.Add(1060434, prop.ToString()); // lower reagent cost ~1_val~%</pre>

## Duplicated Code. Size: 528

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddBackground(0, 0, 240, 310, 5054);

            //----------
            this.AddLabel(95, 2, 200, "TER MUR");

            //white background
            //x, y, largura, altura, item
            this.AddImageTiled(10, 20, 220, 232, 3004);

            //----------
            this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(167, 27, 200, "Unload");

            //colunas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 2, 222, 10003);
            this.AddImageTiled(163, 25, 2, 222, 10003);
            this.AddImageTiled(218, 25, 2, 222, 10003);

            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);
            this.AddImageTiled(20, 220, 200, 2, 10001);
            this.AddImageTiled(20, 245, 200, 2, 10001);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddBackground(0, 0, 240, 310, 5054);

            //----------
            this.AddLabel(95, 2, 200, "TER MUR");

            //white background
            //x, y, largura, altura, item
            this.AddImageTiled(10, 20, 220, 232, 3004);

            //----------
            this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(167, 27, 200, "Unload");

            //colunas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 2, 222, 10003);
            this.AddImageTiled(163, 25, 2, 222, 10003);
            this.AddImageTiled(218, 25, 2, 222, 10003);

            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);
            this.AddImageTiled(20, 220, 200, 2, 10001);
            this.AddImageTiled(20, 245, 200, 2, 10001);</pre>

Fragment 3 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddBackground(0, 0, 240, 310, 5054);

            //----------
            this.AddLabel(95, 2, 200, "TER MUR");

            //white background
            //x, y, largura, altura, item
            this.AddImageTiled(10, 20, 220, 232, 3004);

            //----------
            this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(167, 27, 200, "Unload");

            //colunas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 2, 222, 10003);
            this.AddImageTiled(163, 25, 2, 222, 10003);
            this.AddImageTiled(218, 25, 2, 222, 10003);

            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);
            this.AddImageTiled(20, 220, 200, 2, 10001);
            this.AddImageTiled(20, 245, 200, 2, 10001);</pre>

Fragment 4 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddBackground(0, 0, 240, 310, 5054);

            //----------
            this.AddLabel(95, 2, 200, "TER MUR");

            //white background
            //x, y, largura, altura, item
            this.AddImageTiled(10, 20, 220, 232, 3004);

            //----------
            this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(167, 27, 200, "Unload");

            //colunas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 2, 222, 10003);
            this.AddImageTiled(163, 25, 2, 222, 10003);
            this.AddImageTiled(218, 25, 2, 222, 10003);

            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);
            this.AddImageTiled(20, 220, 200, 2, 10001);
            this.AddImageTiled(20, 245, 200, 2, 10001);</pre>

## Duplicated Code. Size: 524

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddImageTiled(10, 20, 220, 232, 3004);

            //----------
            this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(172, 27, 200, "Unload");

            //colunas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 2, 222, 10003);
            this.AddImageTiled(163, 25, 2, 222, 10003);
            this.AddImageTiled(218, 25, 2, 222, 10003);

            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);
            this.AddImageTiled(20, 220, 200, 2, 10001);
            this.AddImageTiled(20, 245, 200, 2, 10001);

            //Map names
            this.AddLabel(35, 51, 200, "Hythloth");
            this.AddLabel(35, 76, 200, "Ice");</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddImageTiled(10, 20, 220, 232, 3004);

            //----------
            this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(172, 27, 200, "Unload");

            //colunas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 2, 222, 10003);
            this.AddImageTiled(163, 25, 2, 222, 10003);
            this.AddImageTiled(218, 25, 2, 222, 10003);

            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);
            this.AddImageTiled(20, 220, 200, 2, 10001);
            this.AddImageTiled(20, 245, 200, 2, 10001);

            //Map names
            this.AddLabel(35, 51, 200, "Hythloth");
            this.AddLabel(35, 76, 200, "Ice");</pre>

## Duplicated Code. Size: 521

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\RewardBackpack.cs

<pre>switch (Utility.Random(4))
            {
                case 0:
                    this.AddItem(new GargishRing());
                    break;
                case 1:
                    this.AddItem(new GargishNecklace());
                    break;
                case 2:
                    this.AddItem(new GargishBracelet());
                    break;
                case 3:
                    this.AddItem(new GargishEarrings());
                    break;
            }

            switch (Utility.Random(6))
            {
                case 0:
                    this.AddItem(new GlassSword());
                    break;
                case 1:
                    this.AddItem(new Katana());
                    break;
                case 2:
                    this.AddItem(new Broadsword());
                    break;
                case 3:
                    this.AddItem(new Mace());
                    break;
                case 4:
                    this.AddItem(new Halberd());
                    break;
                case 5:
                    this.AddItem(new Shortblade());
                    break;
            }
            switch (Utility.Random(6))
            {
                case 0:
                    this.AddItem(new LeatherChest());
                    break;
                case 1:
                    this.AddItem(new LeatherArms());
                    break;
                case 2:
                    this.AddItem(new LeatherLegs());
                    break;
                case 3:
                    this.AddItem(new GargishLeatherChest());
                    break;
                case 4:
                    this.AddItem(new GargishLeatherArms());
                    break;
                case 5:
                    this.AddItem(new GargishLeatherLegs());
                    break;
            }</pre>

Fragment 2 in file Scripts\Items\Containers\RewardBackpack.cs

<pre>switch (Utility.Random(4))
            {
                case 0:
                    this.AddItem(new GargishRing());
                    break;
                case 1:
                    this.AddItem(new GargishNecklace());
                    break;
                case 2:
                    this.AddItem(new GargishBracelet());
                    break;
                case 3:
                    this.AddItem(new GargishEarrings());
                    break;
            }

            switch (Utility.Random(6))
            {
                case 0:
                    this.AddItem(new GlassSword());
                    break;
                case 1:
                    this.AddItem(new Katana());
                    break;
                case 2:
                    this.AddItem(new Broadsword());
                    break;
                case 3:
                    this.AddItem(new Mace());
                    break;
                case 4:
                    this.AddItem(new Halberd());
                    break;
                case 5:
                    this.AddItem(new Shortblade());
                    break;
            }
            switch (Utility.Random(6))
            {
                case 0:
                    this.AddItem(new LeatherChest());
                    break;
                case 1:
                    this.AddItem(new LeatherArms());
                    break;
                case 2:
                    this.AddItem(new LeatherLegs());
                    break;
                case 3:
                    this.AddItem(new GargishLeatherChest());
                    break;
                case 4:
                    this.AddItem(new GargishLeatherArms());
                    break;
                case 5:
                    this.AddItem(new GargishLeatherLegs());
                    break;
            }</pre>

## Duplicated Code. Size: 520

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BoneMagi.cs

<pre>this.Body = 148;
            this.BaseSoundID = 451;

            this.SetStr(76, 100);
            this.SetDex(56, 75);
            this.SetInt(186, 210);

            this.SetHits(46, 60);

            this.SetDamage(3, 7);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 35, 40);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 30, 40);

            this.SetSkill(SkillName.EvalInt, 60.1, 70.0);
            this.SetSkill(SkillName.Magery, 60.1, 70.0);
            this.SetSkill(SkillName.MagicResist, 55.1, 70.0);
            this.SetSkill(SkillName.Tactics, 45.1, 60.0);
            this.SetSkill(SkillName.Wrestling, 45.1, 55.0);
            this.SetSkill(SkillName.Necromancy, 89, 99.1);
            this.SetSkill(SkillName.SpiritSpeak, 90.0, 99.0);

            this.Fame = 3000;
            this.Karma = -3000;

            this.VirtualArmor = 38;

            this.PackReg(3);
            this.PackNecroReg(3, 10);
            this.PackItem(new Bone());</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SkeletalMage.cs

<pre>this.Body = 148;
            this.BaseSoundID = 451;

            this.SetStr(76, 100);
            this.SetDex(56, 75);
            this.SetInt(186, 210);

            this.SetHits(46, 60);

            this.SetDamage(3, 7);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 35, 40);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 30, 40);

            this.SetSkill(SkillName.EvalInt, 60.1, 70.0);
            this.SetSkill(SkillName.Magery, 60.1, 70.0);
            this.SetSkill(SkillName.MagicResist, 55.1, 70.0);
            this.SetSkill(SkillName.Tactics, 45.1, 60.0);
            this.SetSkill(SkillName.Wrestling, 45.1, 55.0);
            this.SetSkill(SkillName.Necromancy, 89, 99.1);
            this.SetSkill(SkillName.SpiritSpeak, 90.0, 99.0);

            this.Fame = 3000;
            this.Karma = -3000;

            this.VirtualArmor = 38;
            this.PackReg(3);
            this.PackNecroReg(3, 10);
            this.PackItem(new Bone());</pre>

## Duplicated Code. Size: 515

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ArchDaemon.cs

<pre>this.BaseSoundID = 357;

            this.SetStr(986, 1185);
            this.SetDex(177, 255);
            this.SetInt(151, 250);

            this.SetHits(592, 711);

            this.SetDamage(22, 29);

            this.SetDamageType(ResistanceType.Physical, 50);
            this.SetDamageType(ResistanceType.Fire, 25);
            this.SetDamageType(ResistanceType.Energy, 25);

            this.SetResistance(ResistanceType.Physical, 65, 80);
            this.SetResistance(ResistanceType.Fire, 60, 80);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 40, 50);

            this.SetSkill(SkillName.Anatomy, 25.1, 50.0);
            this.SetSkill(SkillName.EvalInt, 90.1, 100.0);
            this.SetSkill(SkillName.Magery, 95.5, 100.0);
            this.SetSkill(SkillName.Meditation, 25.1, 50.0);
            this.SetSkill(SkillName.MagicResist, 100.5, 150.0);
            this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 90.1, 100.0);

            this.Fame = 24000;
            this.Karma = -24000;

            this.VirtualArmor = 90;

            this.PackItem(new Longsword());</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Balron.cs

<pre>this.BaseSoundID = 357;

            this.SetStr(986, 1185);
            this.SetDex(177, 255);
            this.SetInt(151, 250);

            this.SetHits(592, 711);

            this.SetDamage(22, 29);

            this.SetDamageType(ResistanceType.Physical, 50);
            this.SetDamageType(ResistanceType.Fire, 25);
            this.SetDamageType(ResistanceType.Energy, 25);

            this.SetResistance(ResistanceType.Physical, 65, 80);
            this.SetResistance(ResistanceType.Fire, 60, 80);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 40, 50);

            this.SetSkill(SkillName.Anatomy, 25.1, 50.0);
            this.SetSkill(SkillName.EvalInt, 90.1, 100.0);
            this.SetSkill(SkillName.Magery, 95.5, 100.0);
            this.SetSkill(SkillName.Meditation, 25.1, 50.0);
            this.SetSkill(SkillName.MagicResist, 100.5, 150.0);
            this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 90.1, 100.0);

            this.Fame = 24000;
            this.Karma = -24000;

            this.VirtualArmor = 90;

            this.PackItem(new Longsword());</pre>

## Duplicated Code. Size: 512

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>int indexOf = line.IndexOf(' ');

            list.m_Type = ScriptCompiler.FindTypeByName(line.Substring(0, indexOf++), true);

            if (list.m_Type == null)
                throw new ArgumentException(String.Format("Type not found for header: '{0}'", line));

            line = line.Substring(indexOf);
            indexOf = line.IndexOf('(');
            if (indexOf >= 0)
            {
                list.m_ItemID = Utility.ToInt32(line.Substring(0, indexOf - 1));

                string parms = line.Substring(++indexOf);

                if (line.EndsWith(")"))
                    parms = parms.Substring(0, parms.Length - 1);

                list.m_Params = parms.Split(';');

                for (int i = 0; i < list.m_Params.Length; ++i)
                    list.m_Params[i] = list.m_Params[i].Trim();
            }
            else
            {
                list.m_ItemID = Utility.ToInt32(line);
                list.m_Params = m_EmptyParams;
            }

            list.m_Entries = new ArrayList();

            while ((line = ip.ReadLine()) != null)
            {
                line = line.Trim();

                if (line.Length == 0)
                    break;

                if (line.StartsWith("#"))
                    continue;

                list.m_Entries.Add(new DecorationEntry(line));
            }

            return list;</pre>

Fragment 2 in file Scripts\Commands\DecorateDelete.cs

<pre>int indexOf = line.IndexOf(' ');

            list.m_Type = ScriptCompiler.FindTypeByName(line.Substring(0, indexOf++), true);

            if (list.m_Type == null)
                throw new ArgumentException(String.Format("Type not found for header: '{0}'", line));

            line = line.Substring(indexOf);
            indexOf = line.IndexOf('(');
            if (indexOf >= 0)
            {
                list.m_ItemID = Utility.ToInt32(line.Substring(0, indexOf - 1));

                string parms = line.Substring(++indexOf);

                if (line.EndsWith(")"))
                    parms = parms.Substring(0, parms.Length - 1);

                list.m_Params = parms.Split(';');

                for (int i = 0; i < list.m_Params.Length; ++i)
                    list.m_Params[i] = list.m_Params[i].Trim();
            }
            else
            {
                list.m_ItemID = Utility.ToInt32(line);
                list.m_Params = m_EmptyParams;
            }

            list.m_Entries = new ArrayList();

            while ((line = ip.ReadLine()) != null)
            {
                line = line.Trim();

                if (line.Length == 0)
                    break;

                if (line.StartsWith("#"))
                    continue;

                list.m_Entries.Add(new DecorationEntry(line));
            }

            return list;</pre>

## Duplicated Code. Size: 511

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>{

                        // this section is active after the game has started

                        // enable the forfeit button
                        if(m == from && entry.Status == ChallengeStatus.Active && !m_gauntlet.GameCompleted)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  4000+i, GumpButtonType.Reply, 0 );
                        }

                        if(entry.Status == ChallengeStatus.Forfeit)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200520);  // "Forfeit"
                        } else
                        if(entry.Caution == ChallengeStatus.Hidden && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200521);   // "Hidden"
                        } else
                        if(entry.Caution == ChallengeStatus.OutOfBounds && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200522);  // "Out of Bounds"
                        } else
                        if(entry.Caution == ChallengeStatus.Offline && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200523);    // "Offline"
                        } else
                        if(entry.Status == ChallengeStatus.Active)
                        {

                            texthue = 68;
                            if(gauntlet.Winner == entry.Participant)
                                statusmsg = XmlPoints.GetText(from, 200524);      // "Winner"
                            else
                                statusmsg = XmlPoints.GetText(from, 200525);      // "Active"
                        } else
                        if(entry.Status == ChallengeStatus.Dead)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200526);            // "Dead"
                        } else
                        if(entry.Status == ChallengeStatus.Disqualified)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200527);     // "Disqualified"
                        }

                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>{

                        // this section is active after the game has started

                        // enable the forfeit button
                        if(m == from && entry.Status == ChallengeStatus.Active && !m_gauntlet.GameCompleted)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  4000+i, GumpButtonType.Reply, 0 );
                        }

                        if(entry.Status == ChallengeStatus.Forfeit)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200520);  // "Forfeit"
                        } else
                        if(entry.Caution == ChallengeStatus.Hidden && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200521);   // "Hidden"
                        } else
                        if(entry.Caution == ChallengeStatus.OutOfBounds && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200522);  // "Out of Bounds"
                        } else
                        if(entry.Caution == ChallengeStatus.Offline && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200523);    // "Offline"
                        } else
                        if(entry.Status == ChallengeStatus.Active)
                        {

                            texthue = 68;
                            if(gauntlet.Winner == entry.Participant)
                                statusmsg = XmlPoints.GetText(from, 200524);      // "Winner"
                            else
                                statusmsg = XmlPoints.GetText(from, 200525);      // "Active"
                        } else
                        if(entry.Status == ChallengeStatus.Dead)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200526);            // "Dead"
                        } else
                        if(entry.Status == ChallengeStatus.Disqualified)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200527);     // "Disqualified"
                        }

                    }</pre>

## Duplicated Code. Size: 508

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public void DoTeleport(Mobile m)
        {
            if (!InRange(m.Location, 1))
            {
                int x, y, z = 0;
                Point3D p = Point3D.Zero;

                for (int i = 0; i < 25; i++)
                {
                    x = Utility.RandomMinMax(this.X - 1, this.X + 1);
                    y = Utility.RandomMinMax(this.Y - 1, this.Y + 1);
                    z = this.Map.GetAverageZ(x, y);

                    if (this.Map.CanSpawnMobile(x, y, z) && (x != this.X || y != this.Y))
                    {
                        p = new Point3D(x, y, z);
                        break;
                    }
                }

                if (p == Point3D.Zero)
                    p = this.Location;

                Point3D from = m.Location;

                Effects.SendLocationParticles(EffectItem.Create(from, m.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 2023);
                Effects.SendLocationParticles(EffectItem.Create(p, m.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 5023);

                m.MoveToWorld(p, this.Map);

                m.PlaySound(0x1FE);
            }

            NextTeleport = DateTime.UtcNow + TimeSpan.FromSeconds(Utility.RandomMinMax(30, 60));
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public void DoTeleport(Mobile m)
        {
            if (!InRange(m.Location, 1))
            {
                int x, y, z = 0;
                Point3D p = Point3D.Zero;

                for (int i = 0; i < 25; i++)
                {
                    x = Utility.RandomMinMax(this.X - 1, this.X + 1);
                    y = Utility.RandomMinMax(this.Y - 1, this.Y + 1);
                    z = this.Map.GetAverageZ(x, y);

                    if (this.Map.CanSpawnMobile(x, y, z) && (x != this.X || y != this.Y))
                    {
                        p = new Point3D(x, y, z);
                        break;
                    }
                }

                if (p == Point3D.Zero)
                    p = this.Location;

                Point3D from = m.Location;

                Effects.SendLocationParticles(EffectItem.Create(from, m.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 2023);
                Effects.SendLocationParticles(EffectItem.Create(p, m.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 5023);

                m.MoveToWorld(p, this.Map);

                m.PlaySound(0x1FE);
            }

            NextTeleport = DateTime.UtcNow + TimeSpan.FromSeconds(Utility.RandomMinMax(30, 60));
        }</pre>

## Duplicated Code. Size: 507

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>{
                RecallRune rune = (RecallRune)item;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("Description"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            rune.Description = this.m_Params[i].Substring(++indexOf);
                    }
                    else if (this.m_Params[i].StartsWith("Marked"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            rune.Marked = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("TargetMap"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            rune.TargetMap = Map.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Target"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            rune.Target = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                }
            }</pre>

Fragment 2 in file Scripts\Commands\DecorateDelete.cs

<pre>{
                RecallRune rune = (RecallRune)item;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("Description"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            rune.Description = this.m_Params[i].Substring(++indexOf);
                    }
                    else if (this.m_Params[i].StartsWith("Marked"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            rune.Marked = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("TargetMap"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            rune.TargetMap = Map.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Target"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            rune.Target = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                }
            }</pre>

Fragment 3 in file Scripts\Commands\DecorateMag.cs

<pre>{
                RecallRune rune = (RecallRune)item;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("Description"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            rune.Description = this.m_Params[i].Substring(++indexOf);
                    }
                    else if (this.m_Params[i].StartsWith("Marked"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            rune.Marked = Utility.ToBoolean(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("TargetMap"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            rune.TargetMap = Map.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                    else if (this.m_Params[i].StartsWith("Target"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            rune.Target = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                    }
                }
            }</pre>

## Duplicated Code. Size: 504

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>{

                        // this section is active after the game has started

                        // enable the forfeit button
                        if(m == from && entry.Status == ChallengeStatus.Active && !m_gauntlet.GameCompleted)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  4000+i, GumpButtonType.Reply, 0 );
                        }

                        if(entry.Status == ChallengeStatus.Forfeit)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200520);  // "Forfeit"
                        } else
                        if(entry.Caution == ChallengeStatus.Hidden && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200521);   // "Hidden"
                        } else
                        if(entry.Caution == ChallengeStatus.OutOfBounds && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200522);  // "Out of Bounds"
                        } else
                        if(entry.Caution == ChallengeStatus.Offline && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200523);    // "Offline"
                        } else
                        if(entry.Status == ChallengeStatus.Active)
                        {

                            texthue = 68;
                            if(entry.Winner)
                                statusmsg = XmlPoints.GetText(from, 200524);      // "Winner"
                            else
                                statusmsg = XmlPoints.GetText(from, 200525);      // "Active"
                        } else
                        if(entry.Status == ChallengeStatus.Dead)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200526);            // "Dead"
                        } else
                        if(entry.Status == ChallengeStatus.Disqualified)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200527);     // "Disqualified"
                        }

                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>{

                        // this section is active after the game has started

                        // enable the forfeit button
                        if(m == from && entry.Status == ChallengeStatus.Active && !m_gauntlet.GameCompleted)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  4000+i, GumpButtonType.Reply, 0 );
                        }

                        if(entry.Status == ChallengeStatus.Forfeit)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200520);  // "Forfeit"
                        } else
                        if(entry.Caution == ChallengeStatus.Hidden && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200521);   // "Hidden"
                        } else
                        if(entry.Caution == ChallengeStatus.OutOfBounds && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200522);  // "Out of Bounds"
                        } else
                        if(entry.Caution == ChallengeStatus.Offline && entry.Status == ChallengeStatus.Active)
                        {
                            texthue = 53;
                            statusmsg = XmlPoints.GetText(from, 200523);    // "Offline"
                        } else
                        if(entry.Status == ChallengeStatus.Active)
                        {

                            texthue = 68;
                            if(entry.Winner)
                                statusmsg = XmlPoints.GetText(from, 200524);      // "Winner"
                            else
                                statusmsg = XmlPoints.GetText(from, 200525);      // "Active"
                        } else
                        if(entry.Status == ChallengeStatus.Dead)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200526);            // "Dead"
                        } else
                        if(entry.Status == ChallengeStatus.Disqualified)
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200527);     // "Disqualified"
                        }

                    }</pre>

## Duplicated Code. Size: 499

### Duplicated Fragments:

Fragment 1 in file Server\Items\Container.cs

<pre>{
			if (types.Length != amounts.Length)
			{
				throw new ArgumentException();
			}

			var items = new Item[types.Length][];
			var totals = new int[types.Length];

			for (int i = 0; i < types.Length; ++i)
			{
				items[i] = FindItemsByType(types[i], recurse);

				for (int j = 0; j < items[i].Length; ++j)
				{
					totals[i] += items[i][j].Amount;
				}

				if (totals[i] < amounts[i])
				{
					return i;
				}
			}

			for (int i = 0; i < types.Length; ++i)
			{
				int need = amounts[i];

				for (int j = 0; j < items[i].Length; ++j)
				{
					Item item = items[i][j];

					int theirAmount = item.Amount;

					if (theirAmount < need)
					{
						if (callback != null)
						{
							callback(item, theirAmount);
						}

						item.Delete();
						need -= theirAmount;
					}
					else
					{
						if (callback != null)
						{
							callback(item, need);
						}

						item.Consume(need);
						break;
					}
				}
			}

			return -1;
		}</pre>

Fragment 2 in file Server\Items\Container.cs

<pre>{
			if (types.Length != amounts.Length)
			{
				throw new ArgumentException();
			}

			var items = new Item[types.Length][];
			var totals = new int[types.Length];

			for (int i = 0; i < types.Length; ++i)
			{
				items[i] = FindItemsByType(types[i], recurse);

				for (int j = 0; j < items[i].Length; ++j)
				{
					totals[i] += items[i][j].Amount;
				}

				if (totals[i] < amounts[i])
				{
					return i;
				}
			}

			for (int i = 0; i < types.Length; ++i)
			{
				int need = amounts[i];

				for (int j = 0; j < items[i].Length; ++j)
				{
					Item item = items[i][j];

					int theirAmount = item.Amount;

					if (theirAmount < need)
					{
						if (callback != null)
						{
							callback(item, theirAmount);
						}

						item.Delete();
						need -= theirAmount;
					}
					else
					{
						if (callback != null)
						{
							callback(item, need);
						}

						item.Consume(need);
						break;
					}
				}
			}

			return -1;
		}</pre>

## Duplicated Code. Size: 497

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\NoticeGump.cs

<pre>this.Closable = false;

            this.AddPage(0);

            this.AddBackground(0, 0, width, height, 5054);

            this.AddImageTiled(10, 10, width - 20, 20, 2624);
            this.AddAlphaRegion(10, 10, width - 20, 20);
            this.AddHtmlLocalized(10, 10, width - 20, 20, header, headerColor, false, false);

            this.AddImageTiled(10, 40, width - 20, height - 80, 2624);
            this.AddAlphaRegion(10, 40, width - 20, height - 80);

            if (content is int)
                this.AddHtmlLocalized(10, 40, width - 20, height - 80, (int)content, contentColor, false, true);
            else if (content is string)
                this.AddHtml(10, 40, width - 20, height - 80, String.Format("<BASEFONT COLOR=#{0:X6}>{1}</BASEFONT>", contentColor, content), false, true);

            this.AddImageTiled(10, height - 30, width - 20, 20, 2624);
            this.AddAlphaRegion(10, height - 30, width - 20, 20);
            this.AddButton(10, height - 30, 4005, 4007, 1, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Gumps\WarningGump.cs

<pre>this.Closable = false;

            this.AddPage(0);

            this.AddBackground(0, 0, width, height, 5054);

            this.AddImageTiled(10, 10, width - 20, 20, 2624);
            this.AddAlphaRegion(10, 10, width - 20, 20);
            this.AddHtmlLocalized(10, 10, width - 20, 20, header, headerColor, false, false);

            this.AddImageTiled(10, 40, width - 20, height - 80, 2624);
            this.AddAlphaRegion(10, 40, width - 20, height - 80);

            if (content is int)
                this.AddHtmlLocalized(10, 40, width - 20, height - 80, (int)content, contentColor, false, true);
            else if (content is string)
                this.AddHtml(10, 40, width - 20, height - 80, String.Format("<BASEFONT COLOR=#{0:X6}>{1}</BASEFONT>", contentColor, content), false, true);

            this.AddImageTiled(10, height - 30, width - 20, 20, 2624);
            this.AddAlphaRegion(10, height - 30, width - 20, 20);

            this.AddButton(10, height - 30, 4005, 4007, 1, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 493

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>m.PlaySound(520);
                    m.PlaySound(525);
                    Effects.SendLocationEffect(new Point3D(m.X + 5, m.Y, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X - 5, m.Y, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 5, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y - 5, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 5, m.Y - 5, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X - 5, m.Y + 5, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    this.m_Timer = new FireStormTimer(DateTime.UtcNow, m, effHue, 5, -1);
                    this.m_Timer.Start();</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>m.PlaySound(520);
                    m.PlaySound(525);
                    Effects.SendLocationEffect(new Point3D(m.X + 5, m.Y, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X - 5, m.Y, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 5, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y - 5, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 5, m.Y - 5, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X - 5, m.Y + 5, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    this.m_Timer = new FireStormTimer(DateTime.UtcNow, m, effHue, 5, -1);
                    this.m_Timer.Start();</pre>

## Duplicated Code. Size: 487

### Duplicated Fragments:

Fragment 1 in file Server\MultiData.cs

<pre>var tiles = new TileList[m_Width][];
			m_Tiles = new StaticTile[m_Width][][];

			for (int x = 0; x < m_Width; ++x)
			{
				tiles[x] = new TileList[m_Height];
				m_Tiles[x] = new StaticTile[m_Height][];

				for (int y = 0; y < m_Height; ++y)
				{
					tiles[x][y] = new TileList();
				}
			}

			for (int i = 0; i < allTiles.Length; ++i)
			{
				if (i == 0 || allTiles[i].m_Flags != 0)
				{
					int xOffset = allTiles[i].m_OffsetX + m_Center.m_X;
					int yOffset = allTiles[i].m_OffsetY + m_Center.m_Y;

					#region Stygian Abyss
					//tiles[xOffset][yOffset].Add( (ushort)allTiles[i].m_ItemID, (sbyte)allTiles[i].m_OffsetZ );
					tiles[xOffset][yOffset].Add(
						(ushort)((allTiles[i].m_ItemID & TileData.MaxItemValue) | 0x10000), (sbyte)allTiles[i].m_OffsetZ);
					#endregion
				}
			}

			for (int x = 0; x < m_Width; ++x)
			{
				for (int y = 0; y < m_Height; ++y)
				{
					m_Tiles[x][y] = tiles[x][y].ToArray();
				}
			}</pre>

Fragment 2 in file Server\MultiData.cs

<pre>var tiles = new TileList[m_Width][];
			m_Tiles = new StaticTile[m_Width][][];

			for (int x = 0; x < m_Width; ++x)
			{
				tiles[x] = new TileList[m_Height];
				m_Tiles[x] = new StaticTile[m_Height][];

				for (int y = 0; y < m_Height; ++y)
				{
					tiles[x][y] = new TileList();
				}
			}

			for (int i = 0; i < allTiles.Length; ++i)
			{
				if (i == 0 || allTiles[i].m_Flags != 0)
				{
					int xOffset = allTiles[i].m_OffsetX + m_Center.m_X;
					int yOffset = allTiles[i].m_OffsetY + m_Center.m_Y;

					#region Stygian Abyss
					//tiles[xOffset][yOffset].Add( (ushort)allTiles[i].m_ItemID, (sbyte)allTiles[i].m_OffsetZ );
					tiles[xOffset][yOffset].Add(
						(ushort)((allTiles[i].m_ItemID & TileData.MaxItemValue) | 0x10000), (sbyte)allTiles[i].m_OffsetZ);
					#endregion
				}
			}

			for (int x = 0; x < m_Width; ++x)
			{
				for (int y = 0; y < m_Height; ++y)
				{
					m_Tiles[x][y] = tiles[x][y].ToArray();
				}
			}</pre>

## Duplicated Code. Size: 483

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBProvisioner.cs

<pre>this.Add(typeof(Amber), 25);
                this.Add(typeof(Amethyst), 50);
                this.Add(typeof(Citrine), 25);
                this.Add(typeof(Diamond), 100);
                this.Add(typeof(Emerald), 50);
                this.Add(typeof(Ruby), 37);
                this.Add(typeof(Sapphire), 50);
                this.Add(typeof(StarSapphire), 62);
                this.Add(typeof(Tourmaline), 47);
                this.Add(typeof(GoldRing), 13);
                this.Add(typeof(SilverRing), 10);
                this.Add(typeof(Necklace), 13);
                this.Add(typeof(GoldNecklace), 13);
                this.Add(typeof(GoldBeadNecklace), 13);
                this.Add(typeof(SilverNecklace), 10);
                this.Add(typeof(SilverBeadNecklace), 10);
                this.Add(typeof(Beads), 13);
                this.Add(typeof(GoldBracelet), 13);
                this.Add(typeof(SilverBracelet), 10);
                this.Add(typeof(GoldEarrings), 13);
                this.Add(typeof(SilverEarrings), 10);</pre>

Fragment 2 in file Scripts\VendorInfo\SBVagabond.cs

<pre>this.Add(typeof(Amber), 25);
                this.Add(typeof(Amethyst), 50);
                this.Add(typeof(Citrine), 25);
                this.Add(typeof(Diamond), 100);
                this.Add(typeof(Emerald), 50);
                this.Add(typeof(Ruby), 37);
                this.Add(typeof(Sapphire), 50);
                this.Add(typeof(StarSapphire), 62);
                this.Add(typeof(Tourmaline), 47);
                this.Add(typeof(GoldRing), 13);
                this.Add(typeof(SilverRing), 10);
                this.Add(typeof(Necklace), 13);
                this.Add(typeof(GoldNecklace), 13);
                this.Add(typeof(GoldBeadNecklace), 13);
                this.Add(typeof(SilverNecklace), 10);
                this.Add(typeof(SilverBeadNecklace), 10);
                this.Add(typeof(Beads), 13);
                this.Add(typeof(GoldBracelet), 13);
                this.Add(typeof(SilverBracelet), 10);
                this.Add(typeof(GoldEarrings), 13);
                this.Add(typeof(SilverEarrings), 10);</pre>

## Duplicated Code. Size: 480

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GiantSerpent.cs

<pre>{
            this.Name = "a giant serpent";
            this.Body = 0x15;
            this.Hue = Utility.RandomSnakeHue();
            this.BaseSoundID = 219;

            this.SetStr(186, 215);
            this.SetDex(56, 80);
            this.SetInt(66, 85);

            this.SetHits(112, 129);
            this.SetMana(0);

            this.SetDamage(7, 17);

            this.SetDamageType(ResistanceType.Physical, 40);
            this.SetDamageType(ResistanceType.Poison, 60);

            this.SetResistance(ResistanceType.Physical, 30, 35);
            this.SetResistance(ResistanceType.Fire, 5, 10);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 70, 90);
            this.SetResistance(ResistanceType.Energy, 10, 20);

            this.SetSkill(SkillName.Poisoning, 70.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 25.1, 40.0);
            this.SetSkill(SkillName.Tactics, 65.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 80.0);

            this.Fame = 2500;
            this.Karma = -2500;

            this.VirtualArmor = 32;

            this.PackItem(new Bone());
            // TODO: Body parts
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GiantSerpent.cs

<pre>{
            this.Name = "a giant serpent";
            this.Body = 0x15;
            this.Hue = Utility.RandomSnakeHue();
            this.BaseSoundID = 219;

            this.SetStr(186, 215);
            this.SetDex(56, 80);
            this.SetInt(66, 85);

            this.SetHits(112, 129);
            this.SetMana(0);

            this.SetDamage(7, 17);

            this.SetDamageType(ResistanceType.Physical, 40);
            this.SetDamageType(ResistanceType.Poison, 60);

            this.SetResistance(ResistanceType.Physical, 30, 35);
            this.SetResistance(ResistanceType.Fire, 5, 10);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 70, 90);
            this.SetResistance(ResistanceType.Energy, 10, 20);

            this.SetSkill(SkillName.Poisoning, 70.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 25.1, 40.0);
            this.SetSkill(SkillName.Tactics, 65.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 80.0);

            this.Fame = 2500;
            this.Karma = -2500;

            this.VirtualArmor = 32;

            this.PackItem(new Bone());
            // TODO: Body parts
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\GiantSerpent.cs

<pre>{
            this.Name = "a giant serpent";
            this.Body = 0x15;
            this.Hue = Utility.RandomSnakeHue();
            this.BaseSoundID = 219;

            this.SetStr(186, 215);
            this.SetDex(56, 80);
            this.SetInt(66, 85);

            this.SetHits(112, 129);
            this.SetMana(0);

            this.SetDamage(7, 17);

            this.SetDamageType(ResistanceType.Physical, 40);
            this.SetDamageType(ResistanceType.Poison, 60);

            this.SetResistance(ResistanceType.Physical, 30, 35);
            this.SetResistance(ResistanceType.Fire, 5, 10);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 70, 90);
            this.SetResistance(ResistanceType.Energy, 10, 20);

            this.SetSkill(SkillName.Poisoning, 70.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 25.1, 40.0);
            this.SetSkill(SkillName.Tactics, 65.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 80.0);

            this.Fame = 2500;
            this.Karma = -2500;

            this.VirtualArmor = 32;

            this.PackItem(new Bone());
            // TODO: Body parts
        }</pre>

Fragment 4 in file Scripts\Mobiles\Normal\GiantSerpent.cs

<pre>{
            this.Name = "a giant serpent";
            this.Body = 0x15;
            this.Hue = Utility.RandomSnakeHue();
            this.BaseSoundID = 219;

            this.SetStr(186, 215);
            this.SetDex(56, 80);
            this.SetInt(66, 85);

            this.SetHits(112, 129);
            this.SetMana(0);

            this.SetDamage(7, 17);

            this.SetDamageType(ResistanceType.Physical, 40);
            this.SetDamageType(ResistanceType.Poison, 60);

            this.SetResistance(ResistanceType.Physical, 30, 35);
            this.SetResistance(ResistanceType.Fire, 5, 10);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 70, 90);
            this.SetResistance(ResistanceType.Energy, 10, 20);

            this.SetSkill(SkillName.Poisoning, 70.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 25.1, 40.0);
            this.SetSkill(SkillName.Tactics, 65.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 80.0);

            this.Fame = 2500;
            this.Karma = -2500;

            this.VirtualArmor = 32;

            this.PackItem(new Bone());
            // TODO: Body parts
        }</pre>

Fragment 5 in file Scripts\Mobiles\Normal\GiantSerpent.cs

<pre>{
            this.Name = "a giant serpent";
            this.Body = 0x15;
            this.Hue = Utility.RandomSnakeHue();
            this.BaseSoundID = 219;

            this.SetStr(186, 215);
            this.SetDex(56, 80);
            this.SetInt(66, 85);

            this.SetHits(112, 129);
            this.SetMana(0);

            this.SetDamage(7, 17);

            this.SetDamageType(ResistanceType.Physical, 40);
            this.SetDamageType(ResistanceType.Poison, 60);

            this.SetResistance(ResistanceType.Physical, 30, 35);
            this.SetResistance(ResistanceType.Fire, 5, 10);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 70, 90);
            this.SetResistance(ResistanceType.Energy, 10, 20);

            this.SetSkill(SkillName.Poisoning, 70.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 25.1, 40.0);
            this.SetSkill(SkillName.Tactics, 65.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 80.0);

            this.Fame = 2500;
            this.Karma = -2500;

            this.VirtualArmor = 32;

            this.PackItem(new Bone());
            // TODO: Body parts
        }</pre>

## Duplicated Code. Size: 479

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>public override bool AcquireFocusMob(int iRange, FightMode acqType, bool bPlayerOnly, bool bFacFriend, bool bFacFoe)
        {
            bool found = base.AcquireFocusMob(iRange, acqType, bPlayerOnly, bFacFriend, bFacFoe);

            if (m_Creature.Orb == null || m_Creature.ControlMaster == null)
                return found;

            if (!found && Core.TickCount - m_Creature.NextReacquireTime < 0)
            {
                m_Creature.FocusMob = null;
                return false;
            }

            m_Creature.NextReacquireTime = Core.TickCount + (int)m_Creature.ReacquireDelay.TotalMilliseconds;

            if (!found && m_Creature.Map != null && m_Creature.Map != Map.Internal)
            {
                switch (m_Creature.Orb.Aggression)
                {
                    case Aggression.Following:
                        break;
                    case Aggression.Defensive:
                        {
                            Mobile focus = m_Creature.Combatant as Mobile;

                            if (focus == null)
                                focus = m_Creature.ControlMaster.Combatant as Mobile;

                            if (focus != null)
                            {
                                m_Creature.FocusMob = focus;
                                found = true;
                            }
                        }
                        break;
                    case Aggression.Aggressive:
                        {
                            int range = m_Creature.GetLeashLength();
                            IPoint3D p = m_Creature.Orb.Anchor as IPoint3D;

                            if (p == null)
                                p = m_Creature;

                            Mobile focus = GetFocus(p, range);

                            if (focus != null)
                            {
                                m_Creature.FocusMob = focus;
                                found = true;
                            }
                        }
                        break;
                }
            }

            return found;
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>public override bool AcquireFocusMob(int iRange, FightMode acqType, bool bPlayerOnly, bool bFacFriend, bool bFacFoe)
        {
            bool found = base.AcquireFocusMob(iRange, acqType, bPlayerOnly, bFacFriend, bFacFoe);

            if (m_Creature.Orb == null || m_Creature.ControlMaster == null)
                return found;

            if (!found && Core.TickCount - m_Creature.NextReacquireTime < 0)
            {
                m_Creature.FocusMob = null;
                return false;
            }

            m_Creature.NextReacquireTime = Core.TickCount + (int)m_Creature.ReacquireDelay.TotalMilliseconds;

            if (!found && m_Creature.Map != null && m_Creature.Map != Map.Internal)
            {
                switch (m_Creature.Orb.Aggression)
                {
                    case Aggression.Following:
                        break;
                    case Aggression.Defensive:
                        {
                            Mobile focus = m_Creature.Combatant as Mobile;

                            if (focus == null)
                                focus = m_Creature.ControlMaster.Combatant as Mobile;

                            if (focus != null)
                            {
                                m_Creature.FocusMob = focus;
                                found = true;
                            }
                        }
                        break;
                    case Aggression.Aggressive:
                        {
                            int range = m_Creature.GetLeashLength();
                            IPoint3D p = m_Creature.Orb.Anchor as IPoint3D;

                            if (p == null)
                                p = m_Creature;

                            Mobile focus = GetFocus(p, range);

                            if (focus != null)
                            {
                                m_Creature.FocusMob = focus;
                                found = true;
                            }
                        }
                        break;
                }
            }

            return found;
        }</pre>

## Duplicated Code. Size: 479

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>int nattach = 0;
					try
					{
						nattach = imareader.ReadInt();
					}
					catch (Exception e)
					{
						ErrorReporter.GenerateErrorReport(e.ToString());
						return;
					}

					for (int j = 0; j < nattach; j++)
					{
						// and serial
						ASerial serialno = null;
						try
						{
							serialno = new ASerial(imareader.ReadInt());
						}
						catch (Exception e)
						{
							ErrorReporter.GenerateErrorReport(e.ToString());
							return;
						}

						// read the attachment type
						string valuetype = null;
						try
						{
							valuetype = imareader.ReadString();
						}
						catch (Exception e)
						{
							ErrorReporter.GenerateErrorReport(e.ToString());
							return;
						}

						// read the position of the beginning of the next attachment deser within the .bin file
						long position = 0;
						try
						{
							position = fpireader.ReadLong();
						}
						catch (Exception e)
						{
							ErrorReporter.GenerateErrorReport(e.ToString());
							return;
						}

						XmlAttachment o = FindAttachmentBySerial(serialno.Value);

						if (o == null || imareader.Position != position)
						{
							if (!AlreadyReported(valuetype))
							{
								Console.WriteLine("\nError deserializing attachments of type {0}.\n", valuetype);
								ReportDeserError(valuetype, "save file corruption or incorrect Serialize/Deserialize methods?");
							}
							// position the .ima file at the next deser point
							try
							{
								imareader.Seek(position, SeekOrigin.Begin);
							}
							catch
							{
								ErrorReporter.GenerateErrorReport("Error deserializing. Attachments save file corrupted. Attachment load aborted.");
								return;
							}
							continue;
						}

						// attachment successfully deserialized so attach it
						AttachTo(key, o, false);
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>int nattach = 0;
					try
					{
						nattach = imareader.ReadInt();
					}
					catch (Exception e)
					{
						ErrorReporter.GenerateErrorReport(e.ToString());
						return;
					}

					for (int j = 0; j < nattach; j++)
					{
						// and serial
						ASerial serialno = null;
						try
						{
							serialno = new ASerial(imareader.ReadInt());
						}
						catch (Exception e)
						{
							ErrorReporter.GenerateErrorReport(e.ToString());
							return;
						}

						// read the attachment type
						string valuetype = null;
						try
						{
							valuetype = imareader.ReadString();
						}
						catch (Exception e)
						{
							ErrorReporter.GenerateErrorReport(e.ToString());
							return;
						}

						// read the position of the beginning of the next attachment deser within the .bin file
						long position = 0;
						try
						{
							position = fpireader.ReadLong();
						}
						catch (Exception e)
						{
							ErrorReporter.GenerateErrorReport(e.ToString());
							return;
						}

						XmlAttachment o = FindAttachmentBySerial(serialno.Value);

						if (o == null || imareader.Position != position)
						{
							if (!AlreadyReported(valuetype))
							{
								Console.WriteLine("\nError deserializing attachments of type {0}.\n", valuetype);
								ReportDeserError(valuetype, "save file corruption or incorrect Serialize/Deserialize methods?");
							}
							// position the .ima file at the next deser point
							try
							{
								imareader.Seek(position, SeekOrigin.Begin);
							}
							catch
							{
								ErrorReporter.GenerateErrorReport("Error deserializing. Attachments save file corrupted. Attachment load aborted.");
								return;
							}
							continue;
						}

						// attachment successfully deserialized so attach it
						AttachTo(key, o, false);
					}</pre>

## Duplicated Code. Size: 477

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>{
                case CraftResource.DullCopper:
                    oreType = 1053108;
                    break; // dull copper
                case CraftResource.ShadowIron:
                    oreType = 1053107;
                    break; // shadow iron
                case CraftResource.Copper:
                    oreType = 1053106;
                    break; // copper
                case CraftResource.Bronze:
                    oreType = 1053105;
                    break; // bronze
                case CraftResource.Gold:
                    oreType = 1053104;
                    break; // golden
                case CraftResource.Agapite:
                    oreType = 1053103;
                    break; // agapite
                case CraftResource.Verite:
                    oreType = 1053102;
                    break; // verite
                case CraftResource.Valorite:
                    oreType = 1053101;
                    break; // valorite
                case CraftResource.SpinedLeather:
                    oreType = 1061118;
                    break; // spined
                case CraftResource.HornedLeather:
                    oreType = 1061117;
                    break; // horned
                case CraftResource.BarbedLeather:
                    oreType = 1061116;
                    break; // barbed
                case CraftResource.RedScales:
                    oreType = 1060814;
                    break; // red
                case CraftResource.YellowScales:
                    oreType = 1060818;
                    break; // yellow
                case CraftResource.BlackScales:
                    oreType = 1060820;
                    break; // black
                case CraftResource.GreenScales:
                    oreType = 1060819;
                    break; // green
                case CraftResource.WhiteScales:
                    oreType = 1060821;
                    break; // white
                case CraftResource.BlueScales:
                    oreType = 1060815;
                    break; // blue
                case CraftResource.OakWood:
                    oreType = 1072533; 
                    break; // oak
                case CraftResource.AshWood:
                    oreType = 1072534;
                    break; // ash
                case CraftResource.YewWood:
                    oreType = 1072535;
                    break; // yew
                case CraftResource.Heartwood:
                    oreType = 1072536;
                    break; // heartwood
                case CraftResource.Bloodwood:
                    oreType = 1072538;
                    break; // bloodwood
                case CraftResource.Frostwood:
                    oreType = 1072539;
                    break; // frostwood
                default:
                    oreType = 0;
                    break;
            }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>{
				case CraftResource.DullCopper:
					oreType = 1053108;
					break; // dull copper
				case CraftResource.ShadowIron:
					oreType = 1053107;
					break; // shadow iron
				case CraftResource.Copper:
					oreType = 1053106;
					break; // copper
				case CraftResource.Bronze:
					oreType = 1053105;
					break; // bronze
				case CraftResource.Gold:
					oreType = 1053104;
					break; // golden
				case CraftResource.Agapite:
					oreType = 1053103;
					break; // agapite
				case CraftResource.Verite:
					oreType = 1053102;
					break; // verite
				case CraftResource.Valorite:
					oreType = 1053101;
					break; // valorite
				case CraftResource.SpinedLeather:
					oreType = 1061118;
					break; // spined
				case CraftResource.HornedLeather:
					oreType = 1061117;
					break; // horned
				case CraftResource.BarbedLeather:
					oreType = 1061116;
					break; // barbed
				case CraftResource.RedScales:
					oreType = 1060814;
					break; // red
				case CraftResource.YellowScales:
					oreType = 1060818;
					break; // yellow
				case CraftResource.BlackScales:
					oreType = 1060820;
					break; // black
				case CraftResource.GreenScales:
					oreType = 1060819;
					break; // green
				case CraftResource.WhiteScales:
					oreType = 1060821;
					break; // white
				case CraftResource.BlueScales:
					oreType = 1060815;
					break; // blue

					#region Mondain's Legacy
				case CraftResource.OakWood:
					oreType = 1072533;
					break; // oak
				case CraftResource.AshWood:
					oreType = 1072534;
					break; // ash
				case CraftResource.YewWood:
					oreType = 1072535;
					break; // yew
				case CraftResource.Heartwood:
					oreType = 1072536;
					break; // heartwood
				case CraftResource.Bloodwood:
					oreType = 1072538;
					break; // bloodwood
				case CraftResource.Frostwood:
					oreType = 1072539;
					break; // frostwood
					#endregion

				default:
					oreType = 0;
					break;
			}</pre>

## Duplicated Code. Size: 472

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddImageTiled(10, 20, 220, 232, 3004);

            //----------
            this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(172, 27, 200, "Unload");

            //colunas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 2, 222, 10003);
            this.AddImageTiled(163, 25, 2, 222, 10003);
            this.AddImageTiled(218, 25, 2, 222, 10003);

            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);
            this.AddImageTiled(20, 220, 200, 2, 10001);
            this.AddImageTiled(20, 245, 200, 2, 10001);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddImageTiled(10, 20, 220, 232, 3004);

            //----------
            this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(172, 27, 200, "Unload");

            //colunas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 2, 222, 10003);
            this.AddImageTiled(163, 25, 2, 222, 10003);
            this.AddImageTiled(218, 25, 2, 222, 10003);

            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);
            this.AddImageTiled(20, 220, 200, 2, 10001);
            this.AddImageTiled(20, 245, 200, 2, 10001);</pre>

## Duplicated Code. Size: 472

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\Blocker.cs

<pre>int amount = item.Amount;
                Point3D loc = item.Location;
                int x = loc.X;
                int y = loc.Y;
                int hue = item.Hue;
                int flags = item.GetPacketFlags();
                int direction = (int)item.Direction;

                if (amount != 0)
                    serial |= 0x80000000;
                else
                    serial &= 0x7FFFFFFF;

                this.m_Stream.Write((uint)serial);
				this.m_Stream.Write((short)(itemID & TileData.MaxItemValue));

                if (amount != 0)
                    this.m_Stream.Write((short)amount);

                x &= 0x7FFF;

                if (direction != 0)
                    x |= 0x8000;

                this.m_Stream.Write((short)x);

                y &= 0x3FFF;

                if (hue != 0)
                    y |= 0x8000;

                if (flags != 0)
                    y |= 0x4000;

                this.m_Stream.Write((short)y);

                if (direction != 0)
                    this.m_Stream.Write((byte)direction);

                this.m_Stream.Write((sbyte)loc.Z);

                if (hue != 0)
                    this.m_Stream.Write((ushort)hue);

                if (flags != 0)
                    this.m_Stream.Write((byte)flags);</pre>

Fragment 2 in file Scripts\Items\Internal\LOSBlocker.cs

<pre>int amount = item.Amount;
                Point3D loc = item.Location;
                int x = loc.X;
                int y = loc.Y;
                int hue = item.Hue;
                int flags = item.GetPacketFlags();
                int direction = (int)item.Direction;

                if (amount != 0)
                    serial |= 0x80000000;
                else
                    serial &= 0x7FFFFFFF;

                this.m_Stream.Write((uint)serial);
				this.m_Stream.Write((short)(itemID & TileData.MaxItemValue));

                if (amount != 0)
                    this.m_Stream.Write((short)amount);

                x &= 0x7FFF;

                if (direction != 0)
                    x |= 0x8000;

                this.m_Stream.Write((short)x);

                y &= 0x3FFF;

                if (hue != 0)
                    y |= 0x8000;

                if (flags != 0)
                    y |= 0x4000;

                this.m_Stream.Write((short)y);

                if (direction != 0)
                    this.m_Stream.Write((byte)direction);

                this.m_Stream.Write((sbyte)loc.Z);

                if (hue != 0)
                    this.m_Stream.Write((ushort)hue);

                if (flags != 0)
                    this.m_Stream.Write((byte)flags);</pre>

## Duplicated Code. Size: 470

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\GuillotineComponent.cs

<pre>int amount = Utility.RandomMinMax(3, 7);

            for (int i = 0; i < amount; i++)
            {
                int x = c.X + Utility.RandomMinMax(-1, 1);
                int y = c.Y + Utility.RandomMinMax(-1, 1);
                int z = c.Z;

                if (!c.Map.CanFit(x, y, z, 1, false, false, true))
                {
                    z = c.Map.GetAverageZ(x, y);

                    if (!c.Map.CanFit(x, y, z, 1, false, false, true))
                        continue;
                }

                Blood blood = new Blood(Utility.RandomMinMax(0x122C, 0x122F));
                blood.MoveToWorld(new Point3D(x, y, z), c.Map);
            }

            if (from.Female)
                from.PlaySound(Utility.RandomMinMax(0x150, 0x153));
            else
                from.PlaySound(Utility.RandomMinMax(0x15A, 0x15D));

            from.LocalOverheadMessage(MessageType.Regular, 0, 501777); // Hmm... you suspect that if you used this again, it might hurt.
            SpellHelper.Damage(TimeSpan.Zero, from, Utility.Dice(2, 10, 5));</pre>

Fragment 2 in file Scripts\Items\Addons\IronMaiden.cs

<pre>int amount = Utility.RandomMinMax(3, 7);

                for (int i = 0; i < amount; i++)
                {
                    int x = c.X + Utility.RandomMinMax(-1, 1);
                    int y = c.Y + Utility.RandomMinMax(-1, 1);
                    int z = c.Z;

                    if (!c.Map.CanFit(x, y, z, 1, false, false, true))
                    {
                        z = c.Map.GetAverageZ(x, y);

                        if (!c.Map.CanFit(x, y, z, 1, false, false, true))
                            continue;
                    }

                    Blood blood = new Blood(Utility.RandomMinMax(0x122C, 0x122F));
                    blood.MoveToWorld(new Point3D(x, y, z), c.Map);
                }

                if (from.Female)
                    from.PlaySound(Utility.RandomMinMax(0x150, 0x153));
                else
                    from.PlaySound(Utility.RandomMinMax(0x15A, 0x15D));

                from.LocalOverheadMessage(MessageType.Regular, 0, 501777); // Hmm... you suspect that if you used this again, it might hurt.
                SpellHelper.Damage(TimeSpan.Zero, from, Utility.Dice(2, 10, 5));</pre>

## Duplicated Code. Size: 462

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\HouseGump.cs

<pre>private ArrayList Wrap(string value)
        {
            if (value == null || (value = value.Trim()).Length <= 0)
                return null;

            string[] values = value.Split(' ');
            ArrayList list = new ArrayList();
            string current = "";

            for (int i = 0; i < values.Length; ++i)
            {
                string val = values[i];

                string v = current.Length == 0 ? val : current + ' ' + val;

                if (v.Length < 10)
                {
                    current = v;
                }
                else if (v.Length == 10)
                {
                    list.Add(v);

                    if (list.Count == 6)
                        return list;

                    current = "";
                }
                else if (val.Length <= 10)
                {
                    list.Add(current);

                    if (list.Count == 6)
                        return list;

                    current = val;
                }
                else
                {
                    while (v.Length >= 10)
                    {
                        list.Add(v.Substring(0, 10));

                        if (list.Count == 6)
                            return list;

                        v = v.Substring(10);
                    }

                    current = v;
                }
            }

            if (current.Length > 0)
                list.Add(current);

            return list;
        }</pre>

Fragment 2 in file Scripts\Gumps\HouseGumpAOS.cs

<pre>private ArrayList Wrap(string value)
        {
            if (value == null || (value = value.Trim()).Length <= 0)
                return null;

            string[] values = value.Split(' ');
            ArrayList list = new ArrayList();
            string current = "";

            for (int i = 0; i < values.Length; ++i)
            {
                string val = values[i];

                string v = current.Length == 0 ? val : current + ' ' + val;

                if (v.Length < 10)
                {
                    current = v;
                }
                else if (v.Length == 10)
                {
                    list.Add(v);

                    if (list.Count == 6)
                        return list;

                    current = "";
                }
                else if (val.Length <= 10)
                {
                    list.Add(current);

                    if (list.Count == 6)
                        return list;

                    current = val;
                }
                else
                {
                    while (v.Length >= 10)
                    {
                        list.Add(v.Substring(0, 10));

                        if (list.Count == 6)
                            return list;

                        v = v.Substring(10);
                    }

                    current = v;
                }
            }

            if (current.Length > 0)
                list.Add(current);

            return list;
        }</pre>

## Duplicated Code. Size: 455

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>case Direction.West:
                    if (x < this.X && y == this.Y)
                        return ShipPosition.Bow;
                    else if (x < this.X && y < this.Y)
                        return ShipPosition.BowStarboard;
                    else if (x < this.X && y > this.Y)
                        return ShipPosition.BowPort;
                    else if (x - 2 == this.X && y < this.Y)
                        return ShipPosition.AmidShipStarboard;
                    else if (x - 2 == this.X && y > this.Y)
                        return ShipPosition.AmidShipPort;
                    else if (x > this.X && y < this.Y)
                        return ShipPosition.AftStarboard;
                    else
                        return ShipPosition.AftPort;
                case Direction.South:
                    if (x == this.X && y > this.Y)
                        return ShipPosition.Bow;
                    else if (x < this.X && y > this.Y)
                        return ShipPosition.BowStarboard;
                    else if (x > this.X && y > this.Y)
                        return ShipPosition.BowPort;
                    else if (x < this.X && y + 2 == this.Y)
                        return ShipPosition.AmidShipStarboard;
                    else if (x > this.X && y + 2 == this.Y)
                        return ShipPosition.AmidShipPort;
                    else if (x < this.X && y < this.Y)
                        return ShipPosition.AftStarboard;
                    else
                        return ShipPosition.AftPort;
                case Direction.East:</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>case Direction.West:
                    if (x < this.X && y == this.Y)
                        return ShipPosition.Bow;
                    else if (x < this.X && y < this.Y)
                        return ShipPosition.BowStarboard;
                    else if (x < this.X && y > this.Y)
                        return ShipPosition.BowPort;
                    else if(x + 2 == this.X && y < this.Y)
                        return ShipPosition.AmidShipStarboard; 
                    else if (x + 2 == this.X && y > this.Y)
                        return ShipPosition.AmidShipPort; 
                    else if (x > this.X && y < this.Y)
                        return ShipPosition.AftStarboard;
                    else
                        return ShipPosition.AftPort;
                case Direction.South:
                    if (x == this.X && y > this.Y)
                        return ShipPosition.Bow;
                    else if (x < this.X && y > this.Y)
                        return ShipPosition.BowStarboard;
                    else if (x > this.X && y > this.Y)
                        return ShipPosition.BowPort;
                    else if (x < this.X && y - 2 == this.Y)
                        return ShipPosition.AmidShipStarboard;
                    else if (x > this.X && y - 2 == this.Y)
                        return ShipPosition.AmidShipPort;
                    else if (x < this.X && y < this.Y)
                        return ShipPosition.AftStarboard;
                    else
                        return ShipPosition.AftPort;
                case Direction.East:</pre>

## Duplicated Code. Size: 454

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionBerserker.cs

<pre>this.GenerateBody(false, false);

            this.SetStr(126, 150);
            this.SetDex(61, 85);
            this.SetInt(81, 95);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 30, 50);
            this.SetResistance(ResistanceType.Fire, 30, 50);
            this.SetResistance(ResistanceType.Cold, 30, 50);
            this.SetResistance(ResistanceType.Energy, 30, 50);
            this.SetResistance(ResistanceType.Poison, 30, 50);

            this.VirtualArmor = 24;

            this.SetSkill(SkillName.Swords, 100.0, 110.0);
            this.SetSkill(SkillName.Wrestling, 100.0, 110.0);
            this.SetSkill(SkillName.Tactics, 100.0, 110.0);
            this.SetSkill(SkillName.MagicResist, 100.0, 110.0);
            this.SetSkill(SkillName.Healing, 100.0, 110.0);
            this.SetSkill(SkillName.Anatomy, 100.0, 110.0);

            this.SetSkill(SkillName.Magery, 100.0, 110.0);
            this.SetSkill(SkillName.EvalInt, 100.0, 110.0);
            this.SetSkill(SkillName.Meditation, 100.0, 110.0);</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionKnight.cs

<pre>this.GenerateBody(false, false);

            this.SetStr(126, 150);
            this.SetDex(61, 85);
            this.SetInt(81, 95);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 30, 50);
            this.SetResistance(ResistanceType.Fire, 30, 50);
            this.SetResistance(ResistanceType.Cold, 30, 50);
            this.SetResistance(ResistanceType.Energy, 30, 50);
            this.SetResistance(ResistanceType.Poison, 30, 50);

            this.VirtualArmor = 24;

            this.SetSkill(SkillName.Swords, 100.0, 110.0);
            this.SetSkill(SkillName.Wrestling, 100.0, 110.0);
            this.SetSkill(SkillName.Tactics, 100.0, 110.0);
            this.SetSkill(SkillName.MagicResist, 100.0, 110.0);
            this.SetSkill(SkillName.Healing, 100.0, 110.0);
            this.SetSkill(SkillName.Anatomy, 100.0, 110.0);

            this.SetSkill(SkillName.Magery, 100.0, 110.0);
            this.SetSkill(SkillName.EvalInt, 100.0, 110.0);
            this.SetSkill(SkillName.Meditation, 100.0, 110.0);</pre>

## Duplicated Code. Size: 454

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>m_WorkingList = (ArrayList)gauntlet.Participants.Clone();

                AddLabel( 150, 50, 0, String.Format(XmlPoints.GetText(from, 200504), m_WorkingList.Count*m_gauntlet.EntryFee)); // "Total Purse: {0}"

                AddLabel( 150, 70, 0, String.Format(XmlPoints.GetText(from, 200505), m_gauntlet.Location, m_gauntlet.Map));  // "Loc: {0} {1}"

                AddLabel( 20, 90, 0, String.Format(XmlPoints.GetText(from, 200506), gauntlet.Participants.Count));   // "Players: {0}"

                AddLabel( 150, 90, 0, String.Format(XmlPoints.GetText(from, 200507), gauntlet.ActivePlayers()));  // "Active: {0}"

                if(gauntlet.TargetScore > 0)
                    AddLabel( 20, 110, 0, String.Format(XmlPoints.GetText(from, 200561), gauntlet.TargetScore));  // "Target Score: {0}"
                else
                    AddLabel( 20, 110, 0, XmlPoints.GetText(from, 200562)); // "Target Score: None"

                int yoffset = 155;

                // page up and down buttons
                AddButton( 300, 130, 0x15E0, 0x15E4, 13, GumpButtonType.Reply, 0 );
                AddButton( 320, 130, 0x15E2, 0x15E6, 12, GumpButtonType.Reply, 0 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>m_WorkingList = (ArrayList)gauntlet.Participants.Clone();

                AddLabel( 150, 50, 0, String.Format(XmlPoints.GetText(from, 200504), m_WorkingList.Count*m_gauntlet.EntryFee)); // "Total Purse: {0}"

                AddLabel( 150, 70, 0, String.Format(XmlPoints.GetText(from, 200505), m_gauntlet.Location, m_gauntlet.Map));  // "Loc: {0} {1}"

                AddLabel( 20, 90, 0, String.Format(XmlPoints.GetText(from, 200506), gauntlet.Participants.Count));   // "Players: {0}"

                AddLabel( 150, 90, 0, String.Format(XmlPoints.GetText(from, 200507), gauntlet.ActivePlayers()));  // "Active: {0}"

                if(gauntlet.TargetScore > 0)
                    AddLabel( 20, 110, 0, String.Format(XmlPoints.GetText(from, 200561), gauntlet.TargetScore));  // "Target Score: {0}"
                else
                    AddLabel( 20, 110, 0, XmlPoints.GetText(from, 200562)); // "Target Score: None"

                int yoffset = 155;

                // page up and down buttons
                AddButton( 300, 130, 0x15E0, 0x15E4, 13, GumpButtonType.Reply, 0 );
                AddButton( 320, 130, 0x15E2, 0x15E6, 12, GumpButtonType.Reply, 0 );</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>m_WorkingList = (ArrayList)gauntlet.Participants.Clone();

                AddLabel( 150, 50, 0, String.Format(XmlPoints.GetText(from, 200504), m_WorkingList.Count*m_gauntlet.EntryFee)); // "Total Purse: {0}"

                AddLabel( 150, 70, 0, String.Format(XmlPoints.GetText(from, 200505), m_gauntlet.Location, m_gauntlet.Map));  // "Loc: {0} {1}"

                AddLabel( 20, 90, 0, String.Format(XmlPoints.GetText(from, 200506), gauntlet.Participants.Count));   // "Players: {0}"

                AddLabel( 150, 90, 0, String.Format(XmlPoints.GetText(from, 200507), gauntlet.ActivePlayers()));  // "Active: {0}"

                if(gauntlet.TargetScore > 0)
                    AddLabel( 20, 110, 0, String.Format(XmlPoints.GetText(from, 200561), gauntlet.TargetScore));  // "Target Score: {0}"
                else
                    AddLabel( 20, 110, 0, XmlPoints.GetText(from, 200562)); // "Target Score: None"

                int yoffset = 155;

                // page up and down buttons
                AddButton( 300, 130, 0x15E0, 0x15E4, 13, GumpButtonType.Reply, 0 );
                AddButton( 320, 130, 0x15E2, 0x15E6, 12, GumpButtonType.Reply, 0 );</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>m_WorkingList = (ArrayList)gauntlet.Participants.Clone();

                AddLabel( 150, 50, 0, String.Format(XmlPoints.GetText(from, 200504), m_WorkingList.Count*m_gauntlet.EntryFee)); // "Total Purse: {0}"

                AddLabel( 150, 70, 0, String.Format(XmlPoints.GetText(from, 200505), m_gauntlet.Location, m_gauntlet.Map));  // "Loc: {0} {1}"

                AddLabel( 20, 90, 0, String.Format(XmlPoints.GetText(from, 200506), gauntlet.Participants.Count));   // "Players: {0}"

                AddLabel( 150, 90, 0, String.Format(XmlPoints.GetText(from, 200507), gauntlet.ActivePlayers()));  // "Active: {0}"

                if(gauntlet.TargetScore > 0)
                    AddLabel( 20, 110, 0, String.Format(XmlPoints.GetText(from, 200561), gauntlet.TargetScore));  // "Target Score: {0}"
                else
                    AddLabel( 20, 110, 0, XmlPoints.GetText(from, 200562)); // "Target Score: None"

                int yoffset = 155;

                // page up and down buttons
                AddButton( 300, 130, 0x15E0, 0x15E4, 13, GumpButtonType.Reply, 0 );
                AddButton( 320, 130, 0x15E2, 0x15E6, 12, GumpButtonType.Reply, 0 );</pre>

## Duplicated Code. Size: 453

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\BaseSiegeWeapon.cs

<pre>int staticid = ((StaticTarget)targeted).ItemID;
					int staticx = ((StaticTarget)targeted).Location.X;
					int staticy = ((StaticTarget)targeted).Location.Y;

					Item multiitem = null;
					Point3D tileloc = Point3D.Zero;

					// find the possible multi owner of the static tile
					foreach (Item item in from.Map.GetItemsInRange(((StaticTarget)targeted).Location, 50))
					{

						if (item is BaseMulti)
						{
							// search the component list for a match
							MultiComponentList mcl = ((BaseMulti)item).Components;
							bool found = false;
							if (mcl != null && mcl.List != null)
							{
								for (int i = 0; i < mcl.List.Length; i++)
								{
									MultiTileEntry t = mcl.List[i];

									int x = t.m_OffsetX + item.X;
									int y = t.m_OffsetY + item.Y;
									int z = t.m_OffsetZ + item.Z;
									int itemID = t.m_ItemID & 0x3FFF;

									if (itemID == staticid && x == staticx && y == staticy)
									{
										found = true;
										tileloc = new Point3D(x, y, z);
										break;
									}

								}
							}

							if (found)
							{
								multiitem = item;
								break;
							}
						}
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\HandSiegeAttack.cs

<pre>int staticid = ((StaticTarget)targeted).ItemID;
					int staticx = ((StaticTarget)targeted).Location.X;
					int staticy = ((StaticTarget)targeted).Location.Y;

					Item multiitem = null;
					Point3D tileloc = Point3D.Zero;

					// find the possible multi owner of the static tile
					foreach (Item item in from.Map.GetItemsInRange(((StaticTarget)targeted).Location, 50))
					{

						if (item is BaseMulti)
						{
							// search the component list for a match
							MultiComponentList mcl = ((BaseMulti)item).Components;
							bool found = false;
							if (mcl != null && mcl.List != null)
							{
								for (int i = 0; i < mcl.List.Length; i++)
								{
									MultiTileEntry t = mcl.List[i];

									int x = t.m_OffsetX + item.X;
									int y = t.m_OffsetY + item.Y;
									int z = t.m_OffsetZ + item.Z;
									int itemID = t.m_ItemID & 0x3FFF;

									if (itemID == staticid && x == staticx && y == staticy)
									{
										found = true;
										tileloc = new Point3D(x, y, z);
										break;
									}

								}
							}

							if (found)
							{
								multiitem = item;
								break;
							}
						}
					}</pre>

## Duplicated Code. Size: 451

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>writer.Write((int)m_ReforgedPrefix);
            writer.Write((int)m_ReforgedSuffix);
            writer.Write((int)m_ItemPower);
            writer.Write(m_BlockRepair);
            #endregion

            #region Stygian Abyss
            writer.Write(m_GorgonLenseCharges);
            writer.Write((int)m_GorgonLenseType);

            writer.Write(m_PhysImbuing);
            writer.Write(m_FireImbuing);
            writer.Write(m_ColdImbuing);
            writer.Write(m_PoisonImbuing);
            writer.Write(m_EnergyImbuing);

            // Version 8
            writer.Write((int)this.m_TimesImbued);

            #endregion

            writer.Write((Mobile)this.m_BlessedBy);

            SetFlag sflags = SetFlag.None;

            SetSaveFlag(ref sflags, SetFlag.Attributes, !this.m_SetAttributes.IsEmpty);
            SetSaveFlag(ref sflags, SetFlag.SkillBonuses, !this.m_SetSkillBonuses.IsEmpty);
            SetSaveFlag(ref sflags, SetFlag.PhysicalBonus, this.m_SetPhysicalBonus != 0);
            SetSaveFlag(ref sflags, SetFlag.FireBonus, this.m_SetFireBonus != 0);
            SetSaveFlag(ref sflags, SetFlag.ColdBonus, this.m_SetColdBonus != 0);
            SetSaveFlag(ref sflags, SetFlag.PoisonBonus, this.m_SetPoisonBonus != 0);
            SetSaveFlag(ref sflags, SetFlag.EnergyBonus, this.m_SetEnergyBonus != 0);</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>writer.Write((int)m_ReforgedPrefix);
            writer.Write((int)m_ReforgedSuffix);
            writer.Write((int)m_ItemPower);
            writer.Write(m_BlockRepair);
            #endregion

            #region Stygian Abyss
            writer.Write(m_GorgonLenseCharges);
            writer.Write((int)m_GorgonLenseType);

            writer.Write(m_PhysImbuing);
            writer.Write(m_FireImbuing);
            writer.Write(m_ColdImbuing);
            writer.Write(m_PoisonImbuing);
            writer.Write(m_EnergyImbuing);

            // Version 6
            writer.Write((int)this.m_TimesImbued);

            #endregion

            writer.Write(this.m_BlessedBy);

            #region Mondain's Legacy Sets
            SetFlag sflags = SetFlag.None;

            SetSaveFlag(ref sflags, SetFlag.Attributes, !this.m_SetAttributes.IsEmpty);
            SetSaveFlag(ref sflags, SetFlag.SkillBonuses, !this.m_SetSkillBonuses.IsEmpty);
            SetSaveFlag(ref sflags, SetFlag.PhysicalBonus, this.m_SetPhysicalBonus != 0);
            SetSaveFlag(ref sflags, SetFlag.FireBonus, this.m_SetFireBonus != 0);
            SetSaveFlag(ref sflags, SetFlag.ColdBonus, this.m_SetColdBonus != 0);
            SetSaveFlag(ref sflags, SetFlag.PoisonBonus, this.m_SetPoisonBonus != 0);
            SetSaveFlag(ref sflags, SetFlag.EnergyBonus, this.m_SetEnergyBonus != 0);</pre>

## Duplicated Code. Size: 451

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\GargishClothArmor.cs

<pre>public override bool Scissor(Mobile from, Scissors scissors)
        {
            if (!this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(502437); // Items you wish to cut must be in your backpack.
                return false;
            }

            if (Ethics.Ethic.IsImbued(this))
            {
                from.SendLocalizedMessage(502440); // Scissors can not be used on that to produce anything.
                return false;
            }

            CraftSystem system = DefTailoring.CraftSystem;

            CraftItem item = system.CraftItems.SearchFor(this.GetType());

            if (item != null && item.Resources.Count == 1 && item.Resources.GetAt(0).Amount >= 2)
            {
                try
                {
                    Type resourceType = null;

                    CraftResourceInfo info = CraftResources.GetInfo(this.Resource);

                    if (info != null && info.ResourceTypes.Length > 0)
                        resourceType = info.ResourceTypes[0];

                    if (resourceType == null)
                        resourceType = item.Resources.GetAt(0).ItemType;

                    Item res = (Item)Activator.CreateInstance(resourceType);

                    this.ScissorHelper(from, res, this.PlayerConstructed ? (item.Resources.GetAt(0).Amount / 2) : 1);

                    res.LootType = LootType.Regular;

                    return true;
                }
                catch
                {
                }
            }

            from.SendLocalizedMessage(502440); // Scissors can not be used on that to produce anything.
            return false;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\GargishClothArmor.cs

<pre>public override bool Scissor(Mobile from, Scissors scissors)
        {
            if (!this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(502437); // Items you wish to cut must be in your backpack.
                return false;
            }

            if (Ethics.Ethic.IsImbued(this))
            {
                from.SendLocalizedMessage(502440); // Scissors can not be used on that to produce anything.
                return false;
            }

            CraftSystem system = DefTailoring.CraftSystem;

            CraftItem item = system.CraftItems.SearchFor(this.GetType());

            if (item != null && item.Resources.Count == 1 && item.Resources.GetAt(0).Amount >= 2)
            {
                try
                {
                    Type resourceType = null;

                    CraftResourceInfo info = CraftResources.GetInfo(this.Resource);

                    if (info != null && info.ResourceTypes.Length > 0)
                        resourceType = info.ResourceTypes[0];

                    if (resourceType == null)
                        resourceType = item.Resources.GetAt(0).ItemType;

                    Item res = (Item)Activator.CreateInstance(resourceType);

                    this.ScissorHelper(from, res, this.PlayerConstructed ? (item.Resources.GetAt(0).Amount / 2) : 1);

                    res.LootType = LootType.Regular;

                    return true;
                }
                catch
                {
                }
            }

            from.SendLocalizedMessage(502440); // Scissors can not be used on that to produce anything.
            return false;
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Armor\GargishClothArmor.cs

<pre>public override bool Scissor(Mobile from, Scissors scissors)
        {
            if (!this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(502437); // Items you wish to cut must be in your backpack.
                return false;
            }

            if (Ethics.Ethic.IsImbued(this))
            {
                from.SendLocalizedMessage(502440); // Scissors can not be used on that to produce anything.
                return false;
            }

            CraftSystem system = DefTailoring.CraftSystem;

            CraftItem item = system.CraftItems.SearchFor(this.GetType());

            if (item != null && item.Resources.Count == 1 && item.Resources.GetAt(0).Amount >= 2)
            {
                try
                {
                    Type resourceType = null;

                    CraftResourceInfo info = CraftResources.GetInfo(this.Resource);

                    if (info != null && info.ResourceTypes.Length > 0)
                        resourceType = info.ResourceTypes[0];

                    if (resourceType == null)
                        resourceType = item.Resources.GetAt(0).ItemType;

                    Item res = (Item)Activator.CreateInstance(resourceType);

                    this.ScissorHelper(from, res, this.PlayerConstructed ? (item.Resources.GetAt(0).Amount / 2) : 1);

                    res.LootType = LootType.Regular;

                    return true;
                }
                catch
                {
                }
            }

            from.SendLocalizedMessage(502440); // Scissors can not be used on that to produce anything.
            return false;
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Armor\GargishClothArmor.cs

<pre>public override bool Scissor(Mobile from, Scissors scissors)
        {
            if (!this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(502437); // Items you wish to cut must be in your backpack.
                return false;
            }

            if (Ethics.Ethic.IsImbued(this))
            {
                from.SendLocalizedMessage(502440); // Scissors can not be used on that to produce anything.
                return false;
            }

            CraftSystem system = DefTailoring.CraftSystem;

            CraftItem item = system.CraftItems.SearchFor(this.GetType());

            if (item != null && item.Resources.Count == 1 && item.Resources.GetAt(0).Amount >= 2)
            {
                try
                {
                    Type resourceType = null;

                    CraftResourceInfo info = CraftResources.GetInfo(this.Resource);

                    if (info != null && info.ResourceTypes.Length > 0)
                        resourceType = info.ResourceTypes[0];

                    if (resourceType == null)
                        resourceType = item.Resources.GetAt(0).ItemType;

                    Item res = (Item)Activator.CreateInstance(resourceType);

                    this.ScissorHelper(from, res, this.PlayerConstructed ? (item.Resources.GetAt(0).Amount / 2) : 1);

                    res.LootType = LootType.Regular;

                    return true;
                }
                catch
                {
                }
            }

            from.SendLocalizedMessage(502440); // Scissors can not be used on that to produce anything.
            return false;
        }</pre>

## Duplicated Code. Size: 450

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\TreasureChestMod.cs

<pre>DropItem( new Gold( 200, 400 ) );
			DropItem( new BlankScroll( Utility.Random( 1, 4 ) ) );

			for( int i = Utility.Random( 1, 4 ); i > 1; i-- )
			{
				Item ReagentLoot = Loot.RandomReagent();
				ReagentLoot.Amount = Utility.Random( 6, 12 );
				DropItem( ReagentLoot );
			}

			for ( int i = Utility.Random( 1, 4 ); i > 1; i-- )
				DropItem( Loot.RandomPotion() );

			if ( 0.75 > Utility.RandomDouble() ) //75% chance = 3/4
				for (int i = Utility.RandomMinMax(8,16); i > 0; i--)
					DropItem(Loot.RandomScroll(0, 47, SpellbookType.Regular));

			if ( 0.75 > Utility.RandomDouble() ) //75% chance = 3/4
				for (int i = Utility.RandomMinMax(6,12) + 1; i > 0; i--)
					DropItem( Loot.RandomGem() );

			for( int i = Utility.Random( 1, 4 ); i > 1; i-- )
				DropItem( Loot.RandomWand() );</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\SorcerersRewardChest.cs

<pre>DropItem(new Gold(200, 400));
            DropItem(new BlankScroll(Utility.Random(1, 4)));

            for (int i = Utility.Random(1, 4); i > 1; i--)
            {
                Item ReagentLoot = Loot.RandomReagent();
                ReagentLoot.Amount = Utility.Random(6, 12);
                DropItem(ReagentLoot);
            }

            for (int i = Utility.Random(1, 4); i > 1; i--)
                DropItem(Loot.RandomPotion());

            if (0.75 > Utility.RandomDouble()) //75% chance = 3/4
                for (int i = Utility.RandomMinMax(8, 16); i > 0; i--)
                    DropItem(Loot.RandomScroll(0, 47, SpellbookType.Regular));

            if (0.75 > Utility.RandomDouble()) //75% chance = 3/4
                for (int i = Utility.RandomMinMax(6, 12) + 1; i > 0; i--)
                    DropItem(Loot.RandomGem());

            for (int i = Utility.Random(1, 4); i > 1; i--)
                DropItem(Loot.RandomWand());</pre>

## Duplicated Code. Size: 450

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BlackSolenQueen.cs

<pre>this.SetStr(296, 320);
            this.SetDex(121, 145);
            this.SetInt(76, 100);

            this.SetHits(151, 162);

            this.SetDamage(10, 15);

            this.SetDamageType(ResistanceType.Physical, 70);
            this.SetDamageType(ResistanceType.Poison, 30);

            this.SetResistance(ResistanceType.Physical, 30, 40);
            this.SetResistance(ResistanceType.Fire, 30, 35);
            this.SetResistance(ResistanceType.Cold, 25, 35);
            this.SetResistance(ResistanceType.Poison, 35, 40);
            this.SetResistance(ResistanceType.Energy, 25, 30);

            this.SetSkill(SkillName.MagicResist, 70.0);
            this.SetSkill(SkillName.Tactics, 90.0);
            this.SetSkill(SkillName.Wrestling, 90.0);

            this.Fame = 4500;
            this.Karma = -4500;

            this.VirtualArmor = 45;

            SolenHelper.PackPicnicBasket(this);

            this.PackItem(new ZoogiFungus((Utility.RandomDouble() > 0.05) ? 5 : 25));

            if (Utility.RandomDouble() < 0.05)
                this.PackItem(new BallOfSummoning());</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RedSolenQueen.cs

<pre>this.SetStr(296, 320);
            this.SetDex(121, 145);
            this.SetInt(76, 100);

            this.SetHits(151, 162);

            this.SetDamage(10, 15);

            this.SetDamageType(ResistanceType.Physical, 70);
            this.SetDamageType(ResistanceType.Poison, 30);

            this.SetResistance(ResistanceType.Physical, 30, 40);
            this.SetResistance(ResistanceType.Fire, 30, 35);
            this.SetResistance(ResistanceType.Cold, 25, 35);
            this.SetResistance(ResistanceType.Poison, 35, 40);
            this.SetResistance(ResistanceType.Energy, 25, 30);

            this.SetSkill(SkillName.MagicResist, 70.0);
            this.SetSkill(SkillName.Tactics, 90.0);
            this.SetSkill(SkillName.Wrestling, 90.0);

            this.Fame = 4500;
            this.Karma = -4500;

            this.VirtualArmor = 45;

            SolenHelper.PackPicnicBasket(this);

            this.PackItem(new ZoogiFungus((Utility.RandomDouble() > 0.05) ? 5 : 25));

            if (Utility.RandomDouble() < 0.05)
                this.PackItem(new BallOfSummoning());</pre>

## Duplicated Code. Size: 449

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBMage.cs

<pre>this.Add(typeof(BlackPearl), 3); 
                this.Add(typeof(Bloodmoss), 4); 
                this.Add(typeof(MandrakeRoot), 2); 
                this.Add(typeof(Garlic), 2); 
                this.Add(typeof(Ginseng), 2); 
                this.Add(typeof(Nightshade), 2); 
                this.Add(typeof(SpidersSilk), 2); 
                this.Add(typeof(SulfurousAsh), 2); 

                if (Core.AOS)
                {
                    this.Add(typeof(BatWing), 1);
                    this.Add(typeof(DaemonBlood), 3);
                    this.Add(typeof(PigIron), 2);
                    this.Add(typeof(NoxCrystal), 3);
                    this.Add(typeof(GraveDust), 1);
                }

                this.Add(typeof(RecallRune), 13);
                this.Add(typeof(Spellbook), 25);

                Type[] types = Loot.RegularScrollTypes;

                for (int i = 0; i < types.Length; ++i)
                    this.Add(types[i], ((i / 8) + 2) * 2);</pre>

Fragment 2 in file Scripts\VendorInfo\SBNecromancer.cs

<pre>this.Add( typeof( BlackPearl ), 3 ); 
				this.Add( typeof( Bloodmoss ),4 ); 
				this.Add( typeof( MandrakeRoot ), 2 ); 
				this.Add( typeof( Garlic ), 2 ); 
				this.Add( typeof( Ginseng ), 2 ); 
				this.Add( typeof( Nightshade ), 2 ); 
				this.Add( typeof( SpidersSilk ), 2 ); 
				this.Add( typeof( SulfurousAsh ), 2 );
				this.Add( typeof( RecallRune ), 13 );
				this.Add( typeof( Spellbook ), 25 );

				if ( Core.AOS )
				{
				this.Add( typeof( PigIron ), 2 );
				this.Add( typeof( DaemonBlood ), 3 );
				this.Add( typeof( NoxCrystal ), 3 );
				this.Add( typeof( BatWing ), 1 );
				this.Add( typeof( GraveDust ), 1 );
				}

				Type[] types = Loot.RegularScrollTypes;

				for (int i = 0; i < types.Length; ++i)
                    this.Add(types[i], ((i / 8) + 2) * 2);</pre>

## Duplicated Code. Size: 448

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\PropsGump.cs

<pre>if (o is CustomSerial)
			{
				var s = (CustomSerial)o;

				if (s.IsValid)
				{
					return String.Format("(O) 0x{0:X}", s.Value);
				}

				return String.Format("(?) 0x{0:X}", s.Value);
			}

			if (o is byte || o is sbyte || o is short || o is ushort || o is int || o is uint || o is long || o is ulong)
			{
				return String.Format("{0} (0x{0:X})", o);
			}

			if (o is Mobile)
			{
				return String.Format("(M) 0x{0:X} \"{1}\"", ((Mobile)o).Serial.Value, ((Mobile)o).Name);
			}

			if (o is Item)
			{
				return String.Format("(I) 0x{0:X} \"{1}\"", ((Item)o).Serial.Value, ((Item)o).Name);
			}

			if (o is Type)
			{
				return ((Type)o).Name;
			}

			if (o is IAccount)
			{
				return ((IAccount)o).Username;
			}

			if (o is Color)
			{
				var c = (Color)o;

				if (c.IsNamedColor)
				{
					return c.Name;
				}

				return String.Format("#{0:X6}", c.ToArgb());
			}</pre>

Fragment 2 in file Scripts\Gumps\Properties\PropsGump.cs

<pre>if (o is CustomSerial)
			{
				var s = (CustomSerial)o;

				if (s.IsValid)
				{
					return String.Format("(O) 0x{0:X}", s.Value);
				}

				return String.Format("(?) 0x{0:X}", s.Value);
			}

			if (o is byte || o is sbyte || o is short || o is ushort || o is int || o is uint || o is long || o is ulong)
			{
				return String.Format("{0} (0x{0:X})", o);
			}

			if (o is Mobile)
			{
				return String.Format("(M) 0x{0:X} \"{1}\"", ((Mobile)o).Serial.Value, ((Mobile)o).Name);
			}

			if (o is Item)
			{
				return String.Format("(I) 0x{0:X} \"{1}\"", ((Item)o).Serial.Value, ((Item)o).Name);
			}

			if (o is Type)
			{
				return ((Type)o).Name;
			}

			if (o is IAccount)
			{
				return ((IAccount)o).Username;
			}

			if (o is Color)
			{
				var c = (Color)o;

				if (c.IsNamedColor)
				{
					return c.Name;
				}

				return String.Format("#{0:X6}", c.ToArgb());
			}</pre>

## Duplicated Code. Size: 447

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Core\Faction.cs

<pre>List<BaseMonolith> monoliths = BaseMonolith.Monoliths;

            for (int i = 0; i < monoliths.Count; ++i)
                monoliths[i].Sigil = null;

            List<Town> towns = Town.Towns;

            for (int i = 0; i < towns.Count; ++i)
            {
                towns[i].Silver = 0;
                towns[i].Sheriff = null;
                towns[i].Finance = null;
                towns[i].Tax = 0;
                towns[i].Owner = null;
            }

            List<Sigil> sigils = Sigil.Sigils;

            for (int i = 0; i < sigils.Count; ++i)
            {
                sigils[i].Corrupted = null;
                sigils[i].Corrupting = null;
                sigils[i].LastStolen = DateTime.MinValue;
                sigils[i].GraceStart = DateTime.MinValue;
                sigils[i].CorruptionStart = DateTime.MinValue;
                sigils[i].PurificationStart = DateTime.MinValue;
                sigils[i].LastMonolith = null;
                sigils[i].ReturnHome();
            }

            List<Faction> factions = Faction.Factions;</pre>

Fragment 2 in file Scripts\Services\Factions\Core\Faction.cs

<pre>List<BaseMonolith> monoliths = BaseMonolith.Monoliths;

            for (int i = 0; i < monoliths.Count; ++i)
                monoliths[i].Sigil = null;

            List<Town> towns = Town.Towns;

            for (int i = 0; i < towns.Count; ++i)
            {
                towns[i].Silver = 0;
                towns[i].Sheriff = null;
                towns[i].Finance = null;
                towns[i].Tax = 0;
                towns[i].Owner = null;
            }

            List<Sigil> sigils = Sigil.Sigils;

            for (int i = 0; i < sigils.Count; ++i)
            {
                sigils[i].Corrupted = null;
                sigils[i].Corrupting = null;
                sigils[i].LastStolen = DateTime.MinValue;
                sigils[i].GraceStart = DateTime.MinValue;
                sigils[i].CorruptionStart = DateTime.MinValue;
                sigils[i].PurificationStart = DateTime.MinValue;
                sigils[i].LastMonolith = null;
                sigils[i].ReturnHome();
            }

            List<Faction> factions = Faction.Factions;</pre>

## Duplicated Code. Size: 445

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>public override object GetMasterySpell()
        {
            if (TribeType != EodonTribe.Urali)
            {
                BaseWeapon wep = Weapon as BaseWeapon;

                if (wep == null)
                    return null;

                switch (wep.DefSkill)
                {
                    case SkillName.Swords:
                        if (.5 > Utility.RandomDouble())
                            return new FocusedEyeSpell(this, null);
                        else
                            return SpellRegistry.GetSpecialMove(728);
                    case SkillName.Fencing:
                        if (.5 > Utility.RandomDouble())
                            return new ThrustSpell(this, null);
                        else
                            return SpellRegistry.GetSpecialMove(725);
                    case SkillName.Macing:
                        if (.5 > Utility.RandomDouble())
                            return new ToughnessSpell(this, null);
                        else
                            return SpellRegistry.GetSpecialMove(726);
                    case SkillName.Wrestling:
                        if (.5 > Utility.RandomDouble())
                            return new RampageSpell(this, null);
                        else
                            return SpellRegistry.GetSpecialMove(740);
                    case SkillName.Archery:
                        if (.5 > Utility.RandomDouble())
                            return new FlamingShotSpell(this, null);
                        else
                            return new PlayingTheOddsSpell(this, null);
                    case SkillName.Throwing:
                        if (.5 > Utility.RandomDouble())
                            return new ElementalFurySpell(this, null);
                        else
                            return new CalledShotSpell(this, null);
                }
            }   

            return null;
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>public override object GetMasterySpell()
        {
            if (TribeType != EodonTribe.Urali)
            {
                BaseWeapon wep = Weapon as BaseWeapon;

                if (wep == null)
                    return null;

                switch (wep.DefSkill)
                {
                    case SkillName.Swords:
                        if (.5 > Utility.RandomDouble())
                            return new FocusedEyeSpell(this, null);
                        else
                            return SpellRegistry.GetSpecialMove(728);
                    case SkillName.Fencing:
                        if (.5 > Utility.RandomDouble())
                            return new ThrustSpell(this, null);
                        else
                            return SpellRegistry.GetSpecialMove(725);
                    case SkillName.Macing:
                        if (.5 > Utility.RandomDouble())
                            return new ToughnessSpell(this, null);
                        else
                            return SpellRegistry.GetSpecialMove(726);
                    case SkillName.Wrestling:
                        if (.5 > Utility.RandomDouble())
                            return new RampageSpell(this, null);
                        else
                            return SpellRegistry.GetSpecialMove(740);
                    case SkillName.Archery:
                        if (.5 > Utility.RandomDouble())
                            return new FlamingShotSpell(this, null);
                        else
                            return new PlayingTheOddsSpell(this, null);
                    case SkillName.Throwing:
                        if (.5 > Utility.RandomDouble())
                            return new ElementalFurySpell(this, null);
                        else
                            return new CalledShotSpell(this, null);
                }
            }

            return null;
        }</pre>

## Duplicated Code. Size: 444

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseEvilCreatures.cs

<pre>public override void OnThink()
		{
			base.OnThink();

			if(m_NextHeal < DateTime.UtcNow && this.Map != null && this.Map != Map.Internal)
			{
				List<Mobile> eligables = new List<Mobile>();
				IPooledEnumerable eable = this.Map.GetMobilesInRange(this.Location, 8);

				foreach(Mobile m in eable)
				{
					if(m.Alive && m.Hits <= (int)((double)m.HitsMax * HealThreshold) && CanDoHeal(m))
						eligables.Add(m);
				}

				if(eligables.Count > 0)
				{
					Mobile m = eligables[Utility.Random(eligables.Count)];

					Direction = GetDirectionTo( m );

					SpellHelper.Heal( Utility.RandomMinMax(MinHeal, MaxHeal), m, this );
					m.FixedParticles( 0x376A, 9, 32, 5030, EffectLayer.Waist );
					m.PlaySound( 0x202 );

                    int nextHeal = Utility.RandomMinMax(20 - Power, 30 - Power);
					m_NextHeal = DateTime.UtcNow + TimeSpan.FromSeconds(nextHeal);
					return;
				}

				m_NextHeal = DateTime.UtcNow + TimeSpan.FromSeconds(5);
			}
		}</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DespiseGoodCreatures.cs

<pre>public override void OnThink()
        {
            base.OnThink();

            if (m_NextHeal < DateTime.UtcNow && this.Map != null && this.Map != Map.Internal)
            {
                List<Mobile> eligables = new List<Mobile>();
                IPooledEnumerable eable = this.Map.GetMobilesInRange(this.Location, 8);

                foreach (Mobile m in eable)
                {
                    if (m.Alive && m.Hits <= (int)((double)m.HitsMax * HealThreshold) && CanDoHeal(m))
                        eligables.Add(m);
                }

                if (eligables.Count > 0)
                {
                    Mobile m = eligables[Utility.Random(eligables.Count)];

                    Direction = GetDirectionTo(m);

                    SpellHelper.Heal(Utility.RandomMinMax(MinHeal, MaxHeal), m, this);
                    m.FixedParticles(0x376A, 9, 32, 5030, EffectLayer.Waist);
                    m.PlaySound(0x202);

                    int nextHeal = Utility.RandomMinMax(20 - Power, 30 - Power);
                    m_NextHeal = DateTime.UtcNow + TimeSpan.FromSeconds(nextHeal);
                    return;
                }

                m_NextHeal = DateTime.UtcNow + TimeSpan.FromSeconds(5);
            }
        }</pre>

## Duplicated Code. Size: 442

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(172, 27, 200, "Unload");
            //colunas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 2, 222, 10003);
            this.AddImageTiled(163, 25, 2, 222, 10003);
            this.AddImageTiled(220, 25, 2, 222, 10003);

            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);
            this.AddImageTiled(20, 220, 200, 2, 10001);
            this.AddImageTiled(20, 245, 200, 2, 10001);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(172, 27, 200, "Unload");
            //colunas
            //x, y, comprimento, ?, item
            //comp era 222
            this.AddImageTiled(20, 25, 2, 222, 10003);
            this.AddImageTiled(163, 25, 2, 222, 10003);
            this.AddImageTiled(220, 25, 2, 222, 10003);
            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);
            this.AddImageTiled(20, 220, 200, 2, 10001);
            this.AddImageTiled(20, 245, 200, 2, 10001);</pre>

## Duplicated Code. Size: 442

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
							// check for the literal char
							if (singlearglist[1] != null && singlearglist[1].Length > 0 && singlearglist[1][0] == '@')
							{
								//support for literal terminator
								singlearglist = ParseLiteralTerminator(singlearglist[1]);
								string lstr = singlearglist[0];
								if (terminated && lstr[lstr.Length - 1] == '/')
									lstr = lstr.Remove(lstr.Length - 1, 1);

								string result = SetPropertyValue(spawner, o, arglist[0], lstr.Remove(0, 1));

								// see if it was successful
								if (result != "Property has been set.")
								{
									status_str = arglist[0] + " : " + result;
									no_error = false;
								}
								if(singlearglist.Length>1 && singlearglist[1] != null)
								{
//                                	if(singlearglist[1].Length>0 && singlearglist[1][0]=='/')
//                                		singlearglist[1].Remove(0, 1);
									remainder = singlearglist[1];
								}
								else
								{
									remainder=null;
									break;
								}
							}
							else
							{

								string result = SetPropertyValue(spawner, o, arglist[0], arglist[1]);

								// see if it was successful
								if (result != "Property has been set.")
								{
									status_str = arglist[0] + " : " + result;
									no_error = false;
								}
								if (arglist.Length < 3) break;
								remainder = arglist[2];
							}
						}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
							// check for the literal char
							if (singlearglist[1] != null && singlearglist[1].Length > 0 && singlearglist[1][0] == '@')
							{
								//support for literal terminator
								singlearglist = ParseLiteralTerminator(singlearglist[1]);
								string lstr = singlearglist[0];
								if (terminated && lstr[lstr.Length - 1] == '/')
									lstr = lstr.Remove(lstr.Length - 1, 1);

								string result = SetPropertyValue(spawner, o, arglist[0], lstr.Remove(0, 1));
								// see if it was successful
								if (result != "Property has been set.")
								{
									status_str = arglist[0] + " : " + result;
									no_error = false;
								}
								if(singlearglist.Length>1 && singlearglist[1] != null)
								{
//                                	if(singlearglist[1].Length>0 && singlearglist[1][0]=='/')
//                                		singlearglist[1].Remove(0, 1);
									remainder = singlearglist[1];
								}
								else
								{
									remainder=null;
									break;
								}
							}
							else
							{
								string result = SetPropertyValue(spawner, o, arglist[0], arglist[1]);
								// see if it was successful
								if (result != "Property has been set.")
								{
									status_str = arglist[0] + " : " + result;
									no_error = false;
								}
								if (arglist.Length < 3) break;
								remainder = arglist[2];
							}
						}</pre>

## Duplicated Code. Size: 435

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>long pos = m_Stream.Position;

			int written = 0;

			m_Stream.Write((ushort)0);

			for (int i = 0; i < count; ++i)
			{
				Item child = items[i];

				if (!child.Deleted && beholder.CanSee(child))
				{
                    if (child.GridLocation == 0xFF)
                    {
                        child.GridLocation = (byte)(count - written);
                    }

                    Point3D loc = child.Location;

					m_Stream.Write(child.Serial);
					m_Stream.Write((ushort)child.ItemID);
					m_Stream.Write((byte)0); // signed, itemID offset
					m_Stream.Write((ushort)child.Amount);
					m_Stream.Write((short)loc.m_X);
					m_Stream.Write((short)loc.m_Y);
                    m_Stream.Write((byte)child.GridLocation);
                    m_Stream.Write(beheld.Serial);
					m_Stream.Write((ushort)(child.QuestItem ? Item.QuestItemHue : child.Hue));

					++written;
				}
			}

			m_Stream.Seek(pos, SeekOrigin.Begin);
			m_Stream.Write((ushort)written);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>long pos = m_Stream.Position;

			int written = 0;

			m_Stream.Write((ushort)0);

			for (int i = 0; i < count; ++i)
			{
				Item child = items[i];

				if (!child.Deleted && beholder.CanSee(child))
				{
                    Point3D loc = child.Location;

                    if (child.GridLocation == 0xFF)
                    {
                        child.GridLocation = (byte)(count - written);
                    }

                    m_Stream.Write(child.Serial);
					m_Stream.Write((ushort)child.ItemID);
					m_Stream.Write((byte)0); // signed, itemID offset
					m_Stream.Write((ushort)child.Amount);
					m_Stream.Write((short)loc.m_X);
					m_Stream.Write((short)loc.m_Y);
                    m_Stream.Write((byte)child.GridLocation);
                    m_Stream.Write(beheld.Serial);
					m_Stream.Write((ushort)(child.QuestItem ? Item.QuestItemHue : child.Hue));

					++written;
				}
			}

			m_Stream.Seek(pos, SeekOrigin.Begin);
			m_Stream.Write((ushort)written);</pre>

## Duplicated Code. Size: 435

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>tile2.Location = new Point3D(X - 2, Y - 2, Z);   //Left Front
                        tile3.Location = new Point3D(X + 2, Y - 2, Z);   //Right Front
                        tile4.Location = new Point3D(X - 2, Y + 2, Z);   //Left Center
                        tile5.Location = new Point3D(X + 2, Y + 2, Z);   //Right Center
                        tile6.Location = new Point3D(X - 2, Y + 6, Z);   //Left Rear
                        tile7.Location = new Point3D(X + 2, Y + 6, Z);   //Right Rear

                        fill1.Location = new Point3D(X - 2, Y - 3, Z);   //Left Front1
                        fill2.Location = new Point3D(X + 2, Y - 3, Z);   //Right Front1
                        fill3.Location = new Point3D(X + 2, Y - 1, Z);   //Right Front2
                        fill4.Location = new Point3D(X - 2, Y - 1, Z);   //Left Front2
                        fill5.Location = new Point3D(X + 2, Y + 5, Z);   //Left Back
                        fill6.Location = new Point3D(X - 2, Y + 5, Z);   //Right Back
                        break;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>tile2.Location = new Point3D(X + 2, Y + 2, Z);   //Left Front
                        tile3.Location = new Point3D(X - 2, Y + 2, Z);   //Right Front
                        tile4.Location = new Point3D(X + 2, Y - 2, Z);   //Left Center
                        tile5.Location = new Point3D(X - 2, Y - 2, Z);   //Right Center
                        tile6.Location = new Point3D(X + 2, Y - 6, Z);   //Left Rear
                        tile7.Location = new Point3D(X - 2, Y - 6, Z);   //Right Rear

                        fill1.Location = new Point3D(X + 2, Y + 3, Z);   //Left Front1
                        fill2.Location = new Point3D(X - 2, Y + 3, Z);   //Right Front1
                        fill3.Location = new Point3D(X - 2, Y + 1, Z);   //Right Front2
                        fill4.Location = new Point3D(X + 2, Y + 1, Z);   //Left Front2
                        fill5.Location = new Point3D(X - 2, Y - 5, Z);   //Left Back
                        fill6.Location = new Point3D(X + 2, Y - 5, Z);   //Right Back
                        break;</pre>

Fragment 3 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>tile2.Location = new Point3D(X + 2, Y - 2, Z);   //Left Front
                        tile3.Location = new Point3D(X + 2, Y + 2, Z);   //Right Front
                        tile4.Location = new Point3D(X - 2, Y - 2, Z);   //Left Center
                        tile5.Location = new Point3D(X - 2, Y + 2, Z);   //Right Center
                        tile6.Location = new Point3D(X - 6, Y - 2, Z);   //Left Rear
                        tile7.Location = new Point3D(X - 6, Y + 2, Z);   //Right Rear

                        fill1.Location = new Point3D(X + 3, Y - 2, Z);
                        fill2.Location = new Point3D(X + 3, Y + 2, Z);
                        fill3.Location = new Point3D(X + 1, Y + 2, Z);
                        fill4.Location = new Point3D(X + 1, Y - 2, Z);
                        fill5.Location = new Point3D(X - 5, Y + 2, Z);
                        fill6.Location = new Point3D(X - 5, Y - 2, Z);
                        break;</pre>

Fragment 4 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>tile2.Location = new Point3D(X - 2, Y + 2, Z);   //Left Front
                        tile3.Location = new Point3D(X - 2, Y - 2, Z);   //Right Front
                        tile4.Location = new Point3D(X + 2, Y + 2, Z);   //Left Center
                        tile5.Location = new Point3D(X + 2, Y - 2, Z);   //Right Center
                        tile6.Location = new Point3D(X + 6, Y + 2, Z);   //Left Rear
                        tile7.Location = new Point3D(X + 6, Y - 2, Z);   //Right Rear

                        fill1.Location = new Point3D(X - 3, Y + 2, Z);
                        fill2.Location = new Point3D(X - 3, Y - 2, Z);
                        fill3.Location = new Point3D(X - 1, Y - 2, Z);
                        fill4.Location = new Point3D(X - 1, Y + 2, Z);
                        fill5.Location = new Point3D(X + 5, Y - 2, Z);
                        fill6.Location = new Point3D(X + 5, Y + 2, Z);
                        break;</pre>

## Duplicated Code. Size: 433

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>int dir = GetValueForDirection(direction);

            GalleonHold gHold = AddGalleonHold(new GalleonHold(this, m_HoldItemIDs[dir][0]));

            HoldItem hold1 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][0]));
            HoldItem hold2 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][1]));
            HoldItem hold3 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][2]));
            HoldItem hold4 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][3]));
            HoldItem hold5 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][4]));
            HoldItem hold6 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][5]));
            HoldItem hold7 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][6]));
            HoldItem hold8 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][7]));</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>int dir = GetValueForDirection(direction);

            GalleonHold gHold = AddGalleonHold(new GalleonHold(this, m_HoldItemIDs[dir][0]));

            HoldItem hold1 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][0]));
            HoldItem hold2 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][1]));
            HoldItem hold3 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][2]));
            HoldItem hold4 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][3]));
            HoldItem hold5 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][4]));
            HoldItem hold6 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][5]));
            HoldItem hold7 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][6]));
            HoldItem hold8 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][7]));</pre>

## Duplicated Code. Size: 431

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>this.m_TimesImbued = reader.ReadInt();

                        #endregion

                        this.m_BlessedBy = reader.ReadMobile();

                        SetFlag sflags = (SetFlag)reader.ReadEncodedInt();

                        if (GetSaveFlag(sflags, SetFlag.Attributes))
                            this.m_SetAttributes = new AosAttributes(this, reader);
                        else
                            this.m_SetAttributes = new AosAttributes(this);

                        if (GetSaveFlag(sflags, SetFlag.ArmorAttributes))
                            this.m_SetSelfRepair = (new AosArmorAttributes(this, reader)).SelfRepair;

                        if (GetSaveFlag(sflags, SetFlag.SkillBonuses))
                            this.m_SetSkillBonuses = new AosSkillBonuses(this, reader);
                        else
                            this.m_SetSkillBonuses = new AosSkillBonuses(this);

                        if (GetSaveFlag(sflags, SetFlag.PhysicalBonus))
                            this.m_SetPhysicalBonus = reader.ReadEncodedInt();

                        if (GetSaveFlag(sflags, SetFlag.FireBonus))
                            this.m_SetFireBonus = reader.ReadEncodedInt();

                        if (GetSaveFlag(sflags, SetFlag.ColdBonus))
                            this.m_SetColdBonus = reader.ReadEncodedInt();

                        if (GetSaveFlag(sflags, SetFlag.PoisonBonus))
                            this.m_SetPoisonBonus = reader.ReadEncodedInt();

                        if (GetSaveFlag(sflags, SetFlag.EnergyBonus))
                            this.m_SetEnergyBonus = reader.ReadEncodedInt();</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>this.m_TimesImbued = reader.ReadInt();

                        #endregion

                        this.m_BlessedBy = reader.ReadMobile();

                        #region Mondain's Legacy Sets
                        SetFlag sflags = (SetFlag)reader.ReadEncodedInt();

                        if (GetSaveFlag(sflags, SetFlag.Attributes))
                            this.m_SetAttributes = new AosAttributes(this, reader);
                        else
                            this.m_SetAttributes = new AosAttributes(this);

                        if (GetSaveFlag(sflags, SetFlag.ArmorAttributes))
                            this.m_SetSelfRepair = (new AosArmorAttributes(this, reader)).SelfRepair;

                        if (GetSaveFlag(sflags, SetFlag.SkillBonuses))
                            this.m_SetSkillBonuses = new AosSkillBonuses(this, reader);
                        else
                            this.m_SetSkillBonuses = new AosSkillBonuses(this);

                        if (GetSaveFlag(sflags, SetFlag.PhysicalBonus))
                            this.m_SetPhysicalBonus = reader.ReadEncodedInt();

                        if (GetSaveFlag(sflags, SetFlag.FireBonus))
                            this.m_SetFireBonus = reader.ReadEncodedInt();

                        if (GetSaveFlag(sflags, SetFlag.ColdBonus))
                            this.m_SetColdBonus = reader.ReadEncodedInt();

                        if (GetSaveFlag(sflags, SetFlag.PoisonBonus))
                            this.m_SetPoisonBonus = reader.ReadEncodedInt();

                        if (GetSaveFlag(sflags, SetFlag.EnergyBonus))
                            this.m_SetEnergyBonus = reader.ReadEncodedInt();</pre>

## Duplicated Code. Size: 428

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>AddHtmlLocalized(120, 325, 150, 16, 1153383, Yellow, false, false); // Amount of Bet:

            AddHtml(275, 325, 100, 16, Color("#FFFF00", Game.Bet1.ToString(CultureInfo.GetCultureInfo("en-US"))), false, false);
            AddHtml(325, 325, 100, 16, Color("#FFFF00", Game.Bet2.ToString(CultureInfo.GetCultureInfo("en-US"))), false, false);
            AddHtml(375, 325, 100, 16, Color("#FFFF00", Game.Bet3.ToString(CultureInfo.GetCultureInfo("en-US"))), false, false);

            AddHtmlLocalized(100, 345, 100, 16, 1153635, Yellow, false, false); // Your Dice:

            if (Game.Roll != null)
            {
                for (int i = 0; i < Game.Roll.Count; i++)
                {
                    if (_DiceID[i] == 0)
                        _DiceID[i] = RandomDyeID(Game.GetRoll(i));

                    AddItem(180 + (i * 45), 345, _DiceID[i], _DiceHue);
                }
            }</pre>

Fragment 2 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>AddHtmlLocalized(120, 325, 150, 16, 1153383, Yellow, false, false); // Amount of Bet:

            AddHtml(275, 325, 100, 16, Color("#FFFF00", Game.Bet1.ToString(CultureInfo.GetCultureInfo("en-US"))), false, false);
            AddHtml(325, 325, 100, 16, Color("#FFFF00", Game.Bet2.ToString(CultureInfo.GetCultureInfo("en-US"))), false, false);
            AddHtml(375, 325, 100, 16, Color("#FFFF00", Game.Bet3.ToString(CultureInfo.GetCultureInfo("en-US"))), false, false);

            AddHtmlLocalized(100, 345, 100, 16, 1153635, Yellow, false, false); // Your Dice:

            if (Game.Roll != null)
            {
                for (int i = 0; i < Game.Roll.Count; i++)
                {
                    if (_DiceID[i] == 0)
                        _DiceID[i] = RandomDyeID(Game.GetRoll(i));

                    AddItem(180 + (i * 45), 345, _DiceID[i], _DiceHue);
                }
            }</pre>

## Duplicated Code. Size: 426

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\CleanupTrashBarrel.cs

<pre>public void Empty()
        {
            List<Item> items = this.Items;

            if (items.Count > 0)
            {
                for (int i = items.Count - 1; i >= 0; --i)
                {
                    if (i >= items.Count)
                        continue;

                    ConfirmCleanupItem(items[i]);
                    items[i].Delete();
                }

                if (this.m_Cleanup.Any(x => x.mobiles != null))
                {
                    foreach (var m in this.m_Cleanup.Select(x => x.mobiles).Distinct())
                    {
                        if (this.m_Cleanup.Find(x => x.mobiles == m && x.confirm) != null)
                        {
                            double point = this.m_Cleanup.Where(x => x.mobiles == m && x.confirm).Sum(x => x.points);
                            m.SendLocalizedMessage(1151280, String.Format("{0}\t{1}", point.ToString(), this.m_Cleanup.Count(r => r.mobiles == m))); // You have received approximately ~1_VALUE~points for turning in ~2_COUNT~items for Clean Up Britannia.
                            PointsSystem.CleanUpBritannia.AwardPoints(m, point);
                        }
                    }
                    this.m_Cleanup.Clear();
                }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Containers\TrashChest.cs

<pre>public void Empty()
        {
            List<Item> items = this.Items;

            if (items.Count > 0)
            {
                for (int i = items.Count - 1; i >= 0; --i)
                {
                    if (i >= items.Count)
                        continue;

                    ConfirmCleanupItem(items[i]);
                    items[i].Delete();
                }

                if (this.m_Cleanup.Any(x => x.mobiles != null))
                {
                    foreach (var m in this.m_Cleanup.Select(x => x.mobiles).Distinct())
                    {
                        if (this.m_Cleanup.Find(x => x.mobiles == m && x.confirm) != null)
                        {
                            double point = this.m_Cleanup.Where(x => x.mobiles == m && x.confirm).Sum(x => x.points);
                            m.SendLocalizedMessage(1151280, String.Format("{0}\t{1}", point.ToString(), this.m_Cleanup.Count(r => r.mobiles == m))); // You have received approximately ~1_VALUE~points for turning in ~2_COUNT~items for Clean Up Britannia.
                            PointsSystem.CleanUpBritannia.AwardPoints(m, point);
                        }
                    }
                    this.m_Cleanup.Clear();
                }
            }
        }</pre>

## Duplicated Code. Size: 424

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddCheck(182, 48, 210, 211, false, 109);
            this.AddCheck(182, 73, 210, 211, false, 110);
            this.AddCheck(182, 98, 210, 211, false, 111);
            this.AddCheck(182, 123, 210, 211, false, 112);
            this.AddCheck(182, 148, 210, 211, false, 113);
            this.AddCheck(182, 173, 210, 211, false, 114);
            this.AddCheck(182, 198, 210, 211, false, 115);
            this.AddCheck(182, 223, 210, 211, false, 116);

            this.AddLabel(110, 255, 200, "2/4");
            this.AddButton(200, 255, 0xFA5, 0xFA7, 0, GumpButtonType.Page, 3);
            this.AddButton(10, 255, 0xFAE, 0xFB0, 0, GumpButtonType.Page, 1);

            this.AddPage(3);

            //grey background
            this.AddBackground(0, 0, 240, 310, 5054);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddCheck(182, 48, 210, 211, false, 109);
            this.AddCheck(182, 73, 210, 211, false, 110);
            this.AddCheck(182, 98, 210, 211, false, 111);
            this.AddCheck(182, 123, 210, 211, false, 112);
            this.AddCheck(182, 148, 210, 211, false, 113);
            this.AddCheck(182, 173, 210, 211, false, 114);
            this.AddCheck(182, 198, 210, 211, false, 115);
            this.AddCheck(182, 223, 210, 211, false, 116);

            this.AddLabel(110, 255, 200, "2/4");
            this.AddButton(200, 255, 0xFA5, 0xFA7, 0, GumpButtonType.Page, 3);
            this.AddButton(10, 255, 0xFAE, 0xFB0, 0, GumpButtonType.Page, 1);

            this.AddPage(3);

            //grey background
            this.AddBackground(0, 0, 240, 310, 5054);</pre>

## Duplicated Code. Size: 424

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddCheck(182, 48, 210, 211, false, 117);
            this.AddCheck(182, 73, 210, 211, false, 118);
            this.AddCheck(182, 98, 210, 211, false, 119);
            this.AddCheck(182, 123, 210, 211, false, 120);
            this.AddCheck(182, 148, 210, 211, false, 121);
            this.AddCheck(182, 173, 210, 211, false, 122);
            this.AddCheck(182, 198, 210, 211, false, 123);
            this.AddCheck(182, 223, 210, 211, false, 124);

            this.AddLabel(110, 255, 200, "3/4");
            this.AddButton(200, 255, 0xFA5, 0xFA7, 0, GumpButtonType.Page, 4);
            this.AddButton(10, 255, 0xFAE, 0xFB0, 0, GumpButtonType.Page, 2);

            this.AddPage(4);

            //grey background
            this.AddBackground(0, 0, 240, 310, 5054);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddCheck(182, 48, 210, 211, false, 117);
            this.AddCheck(182, 73, 210, 211, false, 118);
            this.AddCheck(182, 98, 210, 211, false, 119);
            this.AddCheck(182, 123, 210, 211, false, 120);
            this.AddCheck(182, 148, 210, 211, false, 121);
            this.AddCheck(182, 173, 210, 211, false, 122);
            this.AddCheck(182, 198, 210, 211, false, 123);
            this.AddCheck(182, 223, 210, 211, false, 124);

            this.AddLabel(110, 255, 200, "3/4");
            this.AddButton(200, 255, 0xFA5, 0xFA7, 0, GumpButtonType.Page, 4);
            this.AddButton(10, 255, 0xFAE, 0xFB0, 0, GumpButtonType.Page, 2);

            this.AddPage(4);

            //grey background
            this.AddBackground(0, 0, 240, 310, 5054);</pre>

## Duplicated Code. Size: 423

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusArchZealot.cs

<pre>AddHtmlLocalized(155, 280, 250, 24, 1153674, White, false, false);
            AddButton(125, 280, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 3);//Summoning Altar?

            AddHtmlLocalized(155, 300, 250, 24, 1153676, White, false, false);
            AddButton(125, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 4);//Robe of Rite?

            AddHtmlLocalized(155, 320, 250, 24, 1153678, White, false, false);
            AddButton(125, 320, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 5);//Summoning Rite?

            AddHtmlLocalized(155, 340, 250, 24, 1153680, White, false, false);
            AddButton(125, 340, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 6);//Sacrifical Dagger?

            AddHtmlLocalized(155, 360, 250, 24, 1153682, White, false, false);
            AddButton(125, 360, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 7);//The Keys?

            AddButton(325, 390, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusArchZealot.cs

<pre>AddHtmlLocalized(155, 280, 250, 24, 1153674, White, false, false);
            AddButton(125, 280, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 3);//Summoning Altar?

            AddHtmlLocalized(155, 300, 250, 24, 1153676, White, false, false);
            AddButton(125, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 4);//Robe of Rite?

            AddHtmlLocalized(155, 320, 250, 24, 1153678, White, false, false);
            AddButton(125, 320, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 5);//Summoning Rite?

            AddHtmlLocalized(155, 340, 250, 24, 1153680, White, false, false);
            AddButton(125, 340, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 6);//Sacrifical Dagger?

            AddHtmlLocalized(155, 360, 250, 24, 1153682, White, false, false);
            AddButton(125, 360, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 7);//The Keys?

            AddButton(325, 390, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK</pre>

## Duplicated Code. Size: 422

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\GrayGoblinMageRenowned.cs

<pre>this.Fame = 1500;
            this.Karma = -1500;

            this.VirtualArmor = 28;
            this.QLPoints = 50;

            this.PackItem(new EssenceControl());

            switch ( Utility.Random(20) )
            {
                case 0:
                    this.PackItem(new Scimitar());
                    break;
                case 1:
                    this.PackItem(new Katana());
                    break;
                case 2:
                    this.PackItem(new WarMace());
                    break;
                case 3:
                    this.PackItem(new WarHammer());
                    break;
                case 4:
                    this.PackItem(new Kryss());
                    break;
                case 5:
                    this.PackItem(new Pitchfork());
                    break;
            }

            this.PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    this.PackItem(new Ribs());
                    break;
                case 1:
                    this.PackItem(new Shaft());
                    break;
                case 2:
                    this.PackItem(new Candle());
                    break;
            }

            if (0.2 > Utility.RandomDouble())
                this.PackItem(new BolaBall());</pre>

Fragment 2 in file Scripts\Mobiles\Named\GreenGoblinAlchemistRenowned.cs

<pre>this.Fame = 1500;
            this.Karma = -1500;

            this.VirtualArmor = 28;
            this.QLPoints = 50;

            this.PackItem(new EssenceControl());

            switch ( Utility.Random(20) )
            {
                case 0:
                    this.PackItem(new Scimitar());
                    break;
                case 1:
                    this.PackItem(new Katana());
                    break;
                case 2:
                    this.PackItem(new WarMace());
                    break;
                case 3:
                    this.PackItem(new WarHammer());
                    break;
                case 4:
                    this.PackItem(new Kryss());
                    break;
                case 5:
                    this.PackItem(new Pitchfork());
                    break;
            }

            this.PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    this.PackItem(new Ribs());
                    break;
                case 1:
                    this.PackItem(new Shaft());
                    break;
                case 2:
                    this.PackItem(new Candle());
                    break;
            }

            if (0.2 > Utility.RandomDouble())
                this.PackItem(new BolaBall());</pre>

## Duplicated Code. Size: 419

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\CloakOfHumility\Gumps\QuestInfoGump.cs

<pre>AddPage(0);

            AddImageTiled(50, 20, 400, 400, 0x1404);
            AddImageTiled(50, 29, 30, 390, 0x28DC);
            AddImageTiled(34, 140, 17, 279, 0x242F);
            AddImage(48, 135, 0x28AB);
            AddImage(-16, 285, 0x28A2);
            AddImage(0, 10, 0x28B5);
            AddImage(25, 0, 0x28B4);
            AddImageTiled(83, 15, 350, 15, 0x280A);
            AddImage(34, 419, 0x2842);
            AddImage(442, 419, 0x2840);
            AddImageTiled(51, 419, 392, 17, 0x2775);
            AddImageTiled(415, 29, 44, 390, 0xA2D);
            AddImageTiled(415, 29, 30, 390, 0x28DC);
            AddImage(370, 50, 0x589);
            AddImage(379, 60, 0x15A9);
            AddImage(425, 0, 0x28C9);
            AddImage(90, 33, 0x232D);
            AddImageTiled(130, 65, 175, 1, 0x238D);</pre>

Fragment 2 in file Scripts\Services\Armor Refinement\Gumps.cs

<pre>AddImageTiled(50, 20, 400, 400, 0x1404);
            AddImageTiled(50, 29, 30, 390, 0x28DC);
            AddImageTiled(34, 140, 17, 279, 0x242F);
            AddImage(48, 135, 0x28AB);
            AddImage(-16, 285, 0x28A2);
            AddImage(0, 10, 0x28B5);
            AddImage(25, 0, 0x28B4);
            AddImageTiled(83, 15, 350, 15, 0x280A);
            AddImage(34, 419, 0x2842);
            AddImage(442, 419, 0x2840);
            AddImageTiled(51, 419, 392, 17, 0x2775);
            AddImageTiled(415, 29, 44, 390, 0xA2D);
            AddImageTiled(415, 29, 30, 390, 0x28DC);
            AddImage(370, 50, 0x589);

            AddImage(379, 60, 0x15A9);
            AddImage(425, 0, 0x28C9);
            AddImage(90, 33, 0x232D);
            AddImageTiled(130, 65, 175, 1, 0x238D);

            AddPage(0);</pre>

## Duplicated Code. Size: 418

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>AddPage(0);

			AddBackground(30, 40, 585, 410, 5054);

			AddImage(30, 40, 9251);
			AddImage(180, 40, 9251);
			AddImage(30, 40, 9253);
			AddImage(30, 130, 9253);
			AddImage(598, 40, 9255);
			AddImage(598, 130, 9255);
			AddImage(30, 433, 9257);
			AddImage(180, 433, 9257);
			AddImage(30, 40, 9250);
			AddImage(598, 40, 9252);
			AddImage(598, 433, 9258);
			AddImage(30, 433, 9256);

			AddItem(30, 40, 6816);
			AddItem(30, 125, 6817);
			AddItem(30, 233, 6817);
			AddItem(30, 341, 6817);
			AddItem(580, 40, 6814);
			AddItem(588, 125, 6815);
			AddItem(588, 233, 6815);
			AddItem(588, 341, 6815);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>AddPage(0);

			AddBackground(30, 40, 585, 410, 5054);

			AddImage(30, 40, 9251);
			AddImage(180, 40, 9251);
			AddImage(30, 40, 9253);
			AddImage(30, 130, 9253);
			AddImage(598, 40, 9255);
			AddImage(598, 130, 9255);
			AddImage(30, 433, 9257);
			AddImage(180, 433, 9257);
			AddImage(30, 40, 9250);
			AddImage(598, 40, 9252);
			AddImage(598, 433, 9258);
			AddImage(30, 433, 9256);

			AddItem(30, 40, 6816);
			AddItem(30, 125, 6817);
			AddItem(30, 233, 6817);
			AddItem(30, 341, 6817);
			AddItem(580, 40, 6814);
			AddItem(588, 125, 6815);
			AddItem(588, 233, 6815);
			AddItem(588, 341, 6815);</pre>

## Duplicated Code. Size: 415

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionDragoon.cs

<pre>this.SetStr(151, 175);
            this.SetDex(61, 85);
            this.SetInt(151, 175);

            this.SetResistance(ResistanceType.Physical, 40, 60);
            this.SetResistance(ResistanceType.Fire, 40, 60);
            this.SetResistance(ResistanceType.Cold, 40, 60);
            this.SetResistance(ResistanceType.Energy, 40, 60);
            this.SetResistance(ResistanceType.Poison, 40, 60);

            this.VirtualArmor = 32;

            this.SetSkill(SkillName.Macing, 110.0, 120.0);
            this.SetSkill(SkillName.Wrestling, 110.0, 120.0);
            this.SetSkill(SkillName.Tactics, 110.0, 120.0);
            this.SetSkill(SkillName.MagicResist, 110.0, 120.0);
            this.SetSkill(SkillName.Healing, 110.0, 120.0);
            this.SetSkill(SkillName.Anatomy, 110.0, 120.0);

            this.SetSkill(SkillName.Magery, 110.0, 120.0);
            this.SetSkill(SkillName.EvalInt, 110.0, 120.0);
            this.SetSkill(SkillName.Meditation, 110.0, 120.0);</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionNecromancer.cs

<pre>this.SetStr(151, 175);
            this.SetDex(61, 85);
            this.SetInt(151, 175);

            this.SetResistance(ResistanceType.Physical, 40, 60);
            this.SetResistance(ResistanceType.Fire, 40, 60);
            this.SetResistance(ResistanceType.Cold, 40, 60);
            this.SetResistance(ResistanceType.Energy, 40, 60);
            this.SetResistance(ResistanceType.Poison, 40, 60);

            this.VirtualArmor = 32;

            this.SetSkill(SkillName.Macing, 110.0, 120.0);
            this.SetSkill(SkillName.Wrestling, 110.0, 120.0);
            this.SetSkill(SkillName.Tactics, 110.0, 120.0);
            this.SetSkill(SkillName.MagicResist, 110.0, 120.0);
            this.SetSkill(SkillName.Healing, 110.0, 120.0);
            this.SetSkill(SkillName.Anatomy, 110.0, 120.0);

            this.SetSkill(SkillName.Magery, 110.0, 120.0);
            this.SetSkill(SkillName.EvalInt, 110.0, 120.0);
            this.SetSkill(SkillName.Meditation, 110.0, 120.0);</pre>

## Duplicated Code. Size: 413

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\ReadyUpGump.cs

<pre>for (int i = 0; i < ruleset.Flavors.Count; ++i, y += 18)
                    this.AddHtml(35, y, 190, 20, String.Format(" + {0}", ((Ruleset)ruleset.Flavors[i]).Title), false, false);

                y += 4;

                if (changes > 0)
                {
                    this.AddHtml(35, y, 190, 20, "Modifications:", false, false);
                    y += 20;

                    for (int i = 0; i < opts.Length; ++i)
                    {
                        if (defs[i] != opts[i])
                        {
                            string name = ruleset.Layout.FindByIndex(i);

                            if (name != null) // sanity
                            {
                                this.AddImage(35, y, opts[i] ? 0xD3 : 0xD2);
                                this.AddHtml(60, y, 165, 22, name, false, false);
                            }

                            y += 22;
                        }
                    }
                }
                else
                {
                    this.AddHtml(35, y, 190, 20, "Modifications: None", false, false);
                    y += 20;
                }</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>for (int i = 0; i < ruleset.Flavors.Count; ++i, y += 18)
                            this.AddHtml(35, y, 190, 20, String.Format(" + {0}", ((Ruleset)ruleset.Flavors[i]).Title), false, false);

                        y += 4;

                        if (changes > 0)
                        {
                            this.AddHtml(35, y, 190, 20, "Modifications:", false, false);
                            y += 20;

                            for (int i = 0; i < opts.Length; ++i)
                            {
                                if (defs[i] != opts[i])
                                {
                                    string name = ruleset.Layout.FindByIndex(i);

                                    if (name != null) // sanity
                                    {
                                        this.AddImage(35, y, opts[i] ? 0xD3 : 0xD2);
                                        this.AddHtml(60, y, 165, 22, name, false, false);
                                    }

                                    y += 22;
                                }
                            }
                        }
                        else
                        {
                            this.AddHtml(35, y, 190, 20, "Modifications: None", false, false);
                            y += 20;
                        }</pre>

## Duplicated Code. Size: 412

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Kraken.cs

<pre>public override void OnActionCombat()
        {
            Mobile combatant = this.Combatant as Mobile;

            if (combatant == null || combatant.Deleted || combatant.Map != this.Map || !this.InRange(combatant, 12) || !this.CanBeHarmful(combatant) || !this.InLOS(combatant))
                return;

            if (DateTime.UtcNow >= this.m_NextWaterBall)
            {
                double damage = combatant.Hits * 0.3;

                if (damage < 10.0)
                    damage = 10.0;
                else if (damage > 40.0)
                    damage = 40.0;

                this.DoHarmful(combatant);
                this.MovingParticles(combatant, 0x36D4, 5, 0, false, false, 195, 0, 9502, 3006, 0, 0, 0);
                AOS.Damage(combatant, this, (int)damage, 100, 0, 0, 0, 0);

                if (combatant is PlayerMobile && combatant.Mount != null)
                {
                    (combatant as PlayerMobile).SetMountBlock(BlockMountType.DismountRecovery, TimeSpan.FromSeconds(10), true);
                }

                m_NextWaterBall = DateTime.UtcNow + TimeSpan.FromMinutes(1);
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Leviathan.cs

<pre>public override void OnActionCombat()
        {
            Mobile combatant = this.Combatant as Mobile;

            if (combatant == null || combatant.Deleted || combatant.Map != this.Map || !this.InRange(combatant, 12) || !this.CanBeHarmful(combatant) || !this.InLOS(combatant))
                return;

            if (DateTime.UtcNow >= this.m_NextWaterBall)
            {
                double damage = combatant.Hits * 0.3;

                if (damage < 10.0)
                    damage = 10.0;
                else if (damage > 40.0)
                    damage = 40.0;

                this.DoHarmful(combatant);
                this.MovingParticles(combatant, 0x36D4, 5, 0, false, false, 195, 0, 9502, 3006, 0, 0, 0);
                AOS.Damage(combatant, this, (int)damage, 100, 0, 0, 0, 0);

                if (combatant is PlayerMobile && combatant.Mount != null)
                {
                    (combatant as PlayerMobile).SetMountBlock(BlockMountType.DismountRecovery, TimeSpan.FromSeconds(10), true);
                }

                m_NextWaterBall = DateTime.UtcNow + TimeSpan.FromMinutes(1);
            }
        }</pre>

Fragment 3 in file Scripts\Services\Expansions\High Seas\Mobiles\OsiredonTheScalisEnforcer.cs

<pre>public override void OnActionCombat()
        {
            Mobile combatant = this.Combatant as Mobile;

            if (combatant == null || combatant.Deleted || combatant.Map != this.Map || !this.InRange(combatant, 12) || !this.CanBeHarmful(combatant) || !this.InLOS(combatant))
                return;

            if (DateTime.UtcNow >= this.m_NextWaterBall)
            {
                double damage = combatant.Hits * 0.3;

                if (damage < 10.0)
                    damage = 10.0;
                else if (damage > 40.0)
                    damage = 40.0;

                this.DoHarmful(combatant);
                this.MovingParticles(combatant, 0x36D4, 5, 0, false, false, 195, 0, 9502, 3006, 0, 0, 0);
                AOS.Damage(combatant, this, (int)damage, 100, 0, 0, 0, 0);

                if (combatant is PlayerMobile && combatant.Mount != null)
                {
                    (combatant as PlayerMobile).SetMountBlock(BlockMountType.DismountRecovery, TimeSpan.FromSeconds(10), true);
                }

                m_NextWaterBall = DateTime.UtcNow + TimeSpan.FromMinutes(1);
            }
        }</pre>

## Duplicated Code. Size: 410

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\StoneMonster.cs

<pre>this.BaseSoundID = 372;

                this.SetStr(250, 350);
                this.SetDex(120, 140);
                this.SetInt(250, 350);

                this.SetHits(200, 300);

                this.SetDamage(15, 27);

                this.SetDamageType(ResistanceType.Physical, 10);
                this.SetDamageType(ResistanceType.Cold, 50);
                this.SetDamageType(ResistanceType.Energy, 40);

                this.SetResistance(ResistanceType.Physical, 45, 55);
                this.SetResistance(ResistanceType.Fire, 30, 40);
                this.SetResistance(ResistanceType.Cold, 40, 55);
                this.SetResistance(ResistanceType.Poison, 55, 65);
                this.SetResistance(ResistanceType.Energy, 40, 50);

                this.SetSkill(SkillName.EvalInt, 90.1, 110.0);
                this.SetSkill(SkillName.Magery, 120);
                this.SetSkill(SkillName.MagicResist, 100.1, 120.0);
                this.SetSkill(SkillName.Tactics, 60.1, 70.0);
                this.SetSkill(SkillName.Wrestling, 60.1, 70.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\UndeadGargoyle.cs

<pre>this.BaseSoundID = 372;

            this.SetStr(250, 350);
            this.SetDex(120, 140);
            this.SetInt(250, 350);

            this.SetHits(200, 300);

            this.SetDamage(15, 27);

            this.SetDamageType(ResistanceType.Physical, 10);
            this.SetDamageType(ResistanceType.Cold, 50);
            this.SetDamageType(ResistanceType.Energy, 40);

            this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 40, 55);
            this.SetResistance(ResistanceType.Poison, 55, 65);
            this.SetResistance(ResistanceType.Energy, 40, 50);

            this.SetSkill(SkillName.EvalInt, 90.1, 110.0);
            this.SetSkill(SkillName.Magery, 120);
            this.SetSkill(SkillName.MagicResist, 100.1, 120.0);
            this.SetSkill(SkillName.Tactics, 60.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 70.0);</pre>

## Duplicated Code. Size: 410

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>public override bool DoOrderAttack()
        {
            if (m_Creature.IsDeadPet)
                return true;

            if (m_Creature.Orb == null)
                return base.DoOrderAttack();

            if (m_Creature.ControlTarget == null || m_Creature.ControlTarget.Deleted || m_Creature.ControlTarget.Map != m_Creature.Map || !m_Creature.ControlTarget.Alive || (m_Creature.ControlTarget is Mobile && ((Mobile)m_Creature.ControlTarget).IsDeadBondedPet))
            {
                m_Creature.DebugSay("I think he might be dead. He's not anywhere around here at least. That's cool. I'm glad he's dead.");

                if (m_Creature.Orb.Aggression == Aggression.Following)
                {
                    m_Creature.ControlTarget = m_Creature.ControlMaster;
                    m_Creature.ControlOrder = OrderType.Follow;

                    m_Creature.CurrentSpeed = 0.1;
                }
                else if (m_Creature.Orb.Anchor is Mobile && ((Mobile)m_Creature.Orb.Anchor).Alive)
                {
                    m_Creature.ControlTarget = (Mobile)m_Creature.Orb.Anchor;
                    m_Creature.ControlOrder = OrderType.Follow;

                    m_Creature.CurrentSpeed = 0.1;
                }
                else
                {
                    m_Creature.ControlTarget = null;
                    m_Creature.ControlOrder = OrderType.None;

                    m_Creature.CurrentSpeed = m_Creature.Orb.Anchor == null ? m_Creature.PassiveSpeed : m_Creature.ActiveSpeed;
                }

                Think();
            }
            else
            {
                m_Creature.DebugSay("Attacking target...");
                Think();
            }

            return true;
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>public override bool DoOrderAttack()
        {
            if (m_Creature.IsDeadPet)
                return true;

            if (m_Creature.Orb == null)
                return base.DoOrderAttack();

            if (m_Creature.ControlTarget == null || m_Creature.ControlTarget.Deleted || m_Creature.ControlTarget.Map != m_Creature.Map || !m_Creature.ControlTarget.Alive || (m_Creature.ControlTarget is Mobile && ((Mobile)m_Creature.ControlTarget).IsDeadBondedPet))
            {
                m_Creature.DebugSay("I think he might be dead. He's not anywhere around here at least. That's cool. I'm glad he's dead.");

                if (m_Creature.Orb.Aggression == Aggression.Following)
                {
                    m_Creature.ControlTarget = m_Creature.ControlMaster;
                    m_Creature.ControlOrder = OrderType.Follow;

                    m_Creature.CurrentSpeed = 0.1;
                }
                else if (m_Creature.Orb.Anchor is Mobile && ((Mobile)m_Creature.Orb.Anchor).Alive)
                {
                    m_Creature.ControlTarget = (Mobile)m_Creature.Orb.Anchor;
                    m_Creature.ControlOrder = OrderType.Follow;

                    m_Creature.CurrentSpeed = 0.1;
                }
                else
                {
                    m_Creature.ControlTarget = null;
                    m_Creature.ControlOrder = OrderType.None;

                    m_Creature.CurrentSpeed = m_Creature.Orb.Anchor == null ? m_Creature.PassiveSpeed : m_Creature.ActiveSpeed;
                }

                Think();
            }
            else
            {
                m_Creature.DebugSay("Attacking target...");
                Think();
            }

            return true;
        }</pre>

## Duplicated Code. Size: 408

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>public override bool Contains(int x, int y)
        {
            bool contains = base.Contains(x, y);

            if (contains)
            {
                int boatX = this.X;
                int boatY = this.Y;

                switch (Facing)
                {
                    case Direction.North:
                        if (x > boatX + PortAndStarboardOffset || x < boatX - PortAndStarboardOffset)
                            return false;
                        if (y > boatY + AftOffset || y < boatY - BowOffset)
                            return false;
                        return true;
                    case Direction.South:
                        if (x > boatX + PortAndStarboardOffset || x < boatX - PortAndStarboardOffset)
                            return false;
                        if (y > boatY + BowOffset || y < boatY - AftOffset)
                            return false;
                        return true;
                    case Direction.East:
                        if (x > boatX + BowOffset || x < boatX - AftOffset)
                            return false;
                        if (y > boatY + PortAndStarboardOffset || y < boatY - PortAndStarboardOffset)
                            return false;
                        return true;
                    case Direction.West:
                        if (x > boatX + AftOffset || x < boatX - BowOffset)
                            return false;
                        if (y > boatY + PortAndStarboardOffset || y < boatY - PortAndStarboardOffset)
                            return false;
                        return true;
                }
            }

            return contains;
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>public override bool Contains(int x, int y)
        {
            bool contains = base.Contains(x, y);

            if (contains)
            {
                int boatX = this.X;
                int boatY = this.Y;

                switch (Facing)
                {
                    case Direction.North:
                        if (x > boatX + PortAndStarboardOffset || x < boatX - PortAndStarboardOffset)
                            return false;
                        if (y > boatY + AftOffset || y < boatY - BowOffset)
                            return false;
                        return true;
                    case Direction.South:
                        if (x > boatX + PortAndStarboardOffset || x < boatX - PortAndStarboardOffset)
                            return false;
                        if (y > boatY + BowOffset || y < boatY - AftOffset)
                            return false;
                        return true;
                    case Direction.East:
                        if (x > boatX + BowOffset || x < boatX - AftOffset)
                            return false;
                        if (y > boatY + PortAndStarboardOffset || y < boatY - PortAndStarboardOffset)
                            return false;
                        return true;
                    case Direction.West:
                        if (x > boatX + AftOffset || x < boatX - BowOffset)
                            return false;
                        if (y > boatY + PortAndStarboardOffset || y < boatY - PortAndStarboardOffset)
                            return false;
                        return true;
                }
            }

            return contains;
        }</pre>

## Duplicated Code. Size: 407

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\LordOaks.cs

<pre>int newPixies = Utility.RandomMinMax(3, 6);

            for (int i = 0; i < newPixies; ++i)
            {
                Pixie pixie = new Pixie();

                pixie.Team = Team;
                pixie.FightMode = FightMode.Closest;

                bool validLocation = false;
                Point3D loc = Location;

                for (int j = 0; !validLocation && j < 10; ++j)
                {
                    int x = X + Utility.Random(3) - 1;
                    int y = Y + Utility.Random(3) - 1;
                    int z = map.GetAverageZ(x, y);

                    if (validLocation = map.CanFit(x, y, Z, 16, false, false))
                        loc = new Point3D(x, y, Z);
                    else if (validLocation = map.CanFit(x, y, z, 16, false, false))
                        loc = new Point3D(x, y, z);
                }

                pixie.MoveToWorld(loc, map);
                pixie.Combatant = target;
            }</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\Silvani.cs

<pre>int newPixies = Utility.RandomMinMax(3, 6);

            for (int i = 0; i < newPixies; ++i)
            {
                Pixie pixie = new Pixie();

                pixie.Team = Team;
                pixie.FightMode = FightMode.Closest;

                bool validLocation = false;
                Point3D loc = Location;

                for (int j = 0; !validLocation && j < 10; ++j)
                {
                    int x = X + Utility.Random(3) - 1;
                    int y = Y + Utility.Random(3) - 1;
                    int z = map.GetAverageZ(x, y);

                    if (validLocation = map.CanFit(x, y, Z, 16, false, false))
                        loc = new Point3D(x, y, Z);
                    else if (validLocation = map.CanFit(x, y, z, 16, false, false))
                        loc = new Point3D(x, y, z);
                }

                pixie.MoveToWorld(loc, map);
                pixie.Combatant = target;
            }</pre>

## Duplicated Code. Size: 407

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\ArcherGuard.cs

<pre>protected override void OnTick()
			{
				if (m_Owner.Deleted)
				{
					Stop();
					return;
				}

				m_Owner.Criminal = false;
				m_Owner.Kills = 0;
				m_Owner.Stam = m_Owner.StamMax;

				Mobile target = m_Owner.Focus;

				if (target != null && (target.Deleted || !target.Alive || !m_Owner.CanBeHarmful(target)))
				{
					m_Owner.Focus = null;
					Stop();
					return;
				}
				else if (m_Owner.Weapon is Fists)
				{
					m_Owner.Kill();
					Stop();
					return;
				}

				if (target != null && m_Owner.Combatant != target)
				{
					m_Owner.Combatant = target;
				}

				if (target == null)
				{
					Stop();
				}
				else
				{
					// <instakill>
					TeleportTo(target);
					target.BoltEffect(0);

					if (target is BaseCreature)
					{
						((BaseCreature)target).NoKillAwards = true;
					}

					target.Damage(target.HitsMax, m_Owner);
					target.Kill(); // just in case, maybe Damage is overriden on some shard

					if (target.Corpse != null && !target.Player)
					{
						target.Corpse.Delete();
					}

					m_Owner.Focus = null;
					Stop();
				} // </instakill>
				/*else if ( !m_Owner.InRange( target, 20 ) )
                {
                m_Shooting = false;
                m_Owner.Focus = null;
                }
                else if ( !m_Owner.InLOS( target ) )
                {
                m_Shooting = false;
                TeleportTo( target );
                }
                else if ( !m_Owner.CanSee( target ) )
                {
                m_Shooting = false;
                if ( !m_Owner.InRange( target, 2 ) )
                {
                if ( !m_Owner.Move( m_Owner.GetDirectionTo( target ) | Direction.Running ) && OutOfMaxDistance( target ) )
                TeleportTo( target );
                }
                else
                {
                if ( !m_Owner.UseSkill( SkillName.DetectHidden ) && Utility.Random( 50 ) == 0 )
                m_Owner.Say( "Reveal!" );
                }
                }
                else
                {
                if ( m_Shooting && (TimeToSpare() || OutOfMaxDistance( target )) )
                m_Shooting = false;
                else if ( !m_Shooting && InMinDistance( target ) )
                m_Shooting = true;
                if ( !m_Shooting )
                {
                if ( m_Owner.InRange( target, 1 ) )
                {
                if ( !m_Owner.Move( (Direction)(m_Owner.GetDirectionTo( target ) - 4) | Direction.Running ) && OutOfMaxDistance( target ) ) // Too close, move away
                TeleportTo( target );
                }
                else if ( !m_Owner.InRange( target, 2 ) )
                {
                if ( !m_Owner.Move( m_Owner.GetDirectionTo( target ) | Direction.Running ) && OutOfMaxDistance( target ) )
                TeleportTo( target );
                }
                }
                }*/
			}</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\WarriorGuard.cs

<pre>protected override void OnTick()
			{
				if (m_Owner.Deleted)
				{
					Stop();
					return;
				}

				m_Owner.Criminal = false;
				m_Owner.Kills = 0;
				m_Owner.Stam = m_Owner.StamMax;

				Mobile target = m_Owner.Focus;

				if (target != null && (target.Deleted || !target.Alive || !m_Owner.CanBeHarmful(target)))
				{
					m_Owner.Focus = null;
					Stop();
					return;
				}
				else if (m_Owner.Weapon is Fists)
				{
					m_Owner.Kill();
					Stop();
					return;
				}

				if (target != null && m_Owner.Combatant != target)
				{
					m_Owner.Combatant = target;
				}

				if (target == null)
				{
					Stop();
				}
				else
				{
					// <instakill>
					TeleportTo(target);
					target.BoltEffect(0);

					if (target is BaseCreature)
					{
						((BaseCreature)target).NoKillAwards = true;
					}

					target.Damage(target.HitsMax, m_Owner);
					target.Kill(); // just in case, maybe Damage is overriden on some shard

					if (target.Corpse != null && !target.Player)
					{
						target.Corpse.Delete();
					}

					m_Owner.Focus = null;
					Stop();
				} // </instakill>
				/*else if ( !m_Owner.InRange( target, 20 ) )
                {
                m_Owner.Focus = null;
                }
                else if ( !m_Owner.InRange( target, 10 ) || !m_Owner.InLOS( target ) )
                {
                TeleportTo( target );
                }
                else if ( !m_Owner.InRange( target, 1 ) )
                {
                if ( !m_Owner.Move( m_Owner.GetDirectionTo( target ) | Direction.Running ) )
                TeleportTo( target );
                }
                else if ( !m_Owner.CanSee( target ) )
                {
                if ( !m_Owner.UseSkill( SkillName.DetectHidden ) && Utility.Random( 50 ) == 0 )
                m_Owner.Say( "Reveal!" );
                }*/
			}</pre>

## Duplicated Code. Size: 407

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\MerchantCrew.cs

<pre>SetSkill(SkillName.Tactics, 100.0, 120.0);
            SetSkill(SkillName.Wrestling, 100.0, 120.0);
            SetSkill(SkillName.Anatomy, 100.0, 120.0);

            SetDamageType(ResistanceType.Physical, 70);
            SetResistance(ResistanceType.Physical, 45, 55);
            SetResistance(ResistanceType.Fire, 45, 55);
            SetResistance(ResistanceType.Cold, 45, 55);
            SetResistance(ResistanceType.Poison, 45, 55);
            SetResistance(ResistanceType.Energy, 45, 55);

            Item bow;

            switch (Utility.Random(4))
            {
                default:
                case 0: bow = new CompositeBow(); PackItem(new Arrow(25)); break;
                case 1: bow = new Crossbow(); PackItem(new Bolt(25)); break;
                case 2: bow = new Bow(); PackItem(new Arrow(25)); break;
                case 3: bow = new HeavyCrossbow(); PackItem(new Bolt(25)); break;
            }

            AddItem(bow);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\PirateCrew.cs

<pre>SetSkill(SkillName.Tactics, 100.0, 120.0);
            SetSkill(SkillName.Wrestling, 100.0, 120.0);
            SetSkill(SkillName.Anatomy, 100.0, 120.0);

            SetDamageType(ResistanceType.Physical, 70);
            SetResistance(ResistanceType.Physical, 45, 55);
            SetResistance(ResistanceType.Fire, 45, 55);
            SetResistance(ResistanceType.Cold, 45, 55);
            SetResistance(ResistanceType.Poison, 45, 55);
            SetResistance(ResistanceType.Energy, 45, 55);

            Item bow;

            switch (Utility.Random(4))
            {
                default:
                case 0: bow = new CompositeBow(); PackItem(new Arrow(25)); break;
                case 1: bow = new Crossbow(); PackItem(new Bolt(25)); break;
                case 2: bow = new Bow(); PackItem(new Arrow(25)); break;
                case 3: bow = new HeavyCrossbow(); PackItem(new Bolt(25)); break;
            }

            AddItem(bow);</pre>

## Duplicated Code. Size: 406

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketHandlers.cs

<pre>{
			Serial serial = pvSrc.ReadInt32(); // serial, ignored
			int x = pvSrc.ReadInt16();
			int y = pvSrc.ReadInt16();
			int z = pvSrc.ReadSByte();
            byte gridloc = pvSrc.ReadByte(); // grid location
            Serial dest = pvSrc.ReadInt32();

			Point3D loc = new Point3D(x, y, z);
			Mobile from = state.Mobile;

            if (serial.IsItem)
            {
                Item dropped = World.FindItem(serial);

                if (dropped != null)
                {
                    dropped.GridLocation = gridloc;
                }
            }

			if (dest.IsMobile)
			{
				from.Drop(World.FindMobile(dest), loc);
			}
			else if (dest.IsItem)
			{
				Item item = World.FindItem(dest);

				if (item is BaseMulti && ((BaseMulti)item).AllowsRelativeDrop)
				{
					loc.m_X += item.X;
					loc.m_Y += item.Y;
					from.Drop(loc);
				}
				else
				{
					from.Drop(item, loc);
				}
			}
			else
			{
				from.Drop(loc);
			}
		}</pre>

Fragment 2 in file Server\Network\PacketHandlers.cs

<pre>{
            Serial serial = pvSrc.ReadInt32();
            int x = pvSrc.ReadInt16();
			int y = pvSrc.ReadInt16();
			int z = pvSrc.ReadSByte();
            byte gridloc = pvSrc.ReadByte(); // grid location
            Serial dest = pvSrc.ReadInt32();

			Point3D loc = new Point3D(x, y, z);
			Mobile from = state.Mobile;

            if (serial.IsItem)
            {
                Item dropped = World.FindItem(serial);

                if (dropped != null)
                {
                    dropped.GridLocation = gridloc;
                }
            }

			if (dest.IsMobile)
			{
				from.Drop(World.FindMobile(dest), loc);
			}
			else if (dest.IsItem)
			{
				Item item = World.FindItem(dest);

				if (item is BaseMulti && ((BaseMulti)item).AllowsRelativeDrop)
				{
					loc.m_X += item.X;
					loc.m_Y += item.Y;
					from.Drop(loc);
				}
				else
				{
					from.Drop(item, loc);
				}
			}
			else
			{
				from.Drop(loc);
			}
		}</pre>

## Duplicated Code. Size: 404

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\SkeletalDragon.cs

<pre>this.Body = 104;
            this.BaseSoundID = 0x488;

            this.SetStr(898, 1030);
            this.SetDex(68, 200);
            this.SetInt(488, 620);

            this.SetHits(558, 599);

            this.SetDamage(29, 35);

            this.SetDamageType(ResistanceType.Physical, 75);
            this.SetDamageType(ResistanceType.Fire, 25);

            this.SetResistance(ResistanceType.Physical, 75, 80);
            this.SetResistance(ResistanceType.Fire, 40, 60);
            this.SetResistance(ResistanceType.Cold, 40, 60);
            this.SetResistance(ResistanceType.Poison, 70, 80);
            this.SetResistance(ResistanceType.Energy, 40, 60);

            this.SetSkill(SkillName.EvalInt, 80.1, 100.0);
            this.SetSkill(SkillName.Magery, 80.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 100.3, 130.0);
            this.SetSkill(SkillName.Tactics, 97.6, 100.0);
            this.SetSkill(SkillName.Wrestling, 97.6, 100.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SkeletalDrake.cs

<pre>this.Body = 104;
            this.BaseSoundID = 0x488;

            this.SetStr(898, 1030);
            this.SetDex(68, 200);
            this.SetInt(488, 620);

            this.SetHits(558, 599);

            this.SetDamage(29, 35);

            this.SetDamageType(ResistanceType.Physical, 75);
            this.SetDamageType(ResistanceType.Fire, 25);

            this.SetResistance(ResistanceType.Physical, 75, 80);
            this.SetResistance(ResistanceType.Fire, 40, 60);
            this.SetResistance(ResistanceType.Cold, 40, 60);
            this.SetResistance(ResistanceType.Poison, 70, 80);
            this.SetResistance(ResistanceType.Energy, 40, 60);

            this.SetSkill(SkillName.EvalInt, 80.1, 100.0);
            this.SetSkill(SkillName.Magery, 80.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 100.3, 130.0);
            this.SetSkill(SkillName.Tactics, 97.6, 100.0);
            this.SetSkill(SkillName.Wrestling, 97.6, 100.0);</pre>

## Duplicated Code. Size: 403

### Duplicated Fragments:

Fragment 1 in file Server\Network\Compression.cs

<pre>public sealed class Compressor32 : ICompressor
	{
		internal class SafeNativeMethods
		{
			[DllImport("zlibwapi32")]
			internal static extern string zlibVersion();

			[DllImport("zlibwapi32")]
			internal static extern ZLibError compress(byte[] dest, ref int destLength, byte[] source, int sourceLength);

			[DllImport("zlibwapi32")]
			internal static extern ZLibError compress2(
				byte[] dest, ref int destLength, byte[] source, int sourceLength, ZLibQuality quality);

			[DllImport("zlibwapi32")]
			internal static extern ZLibError uncompress(byte[] dest, ref int destLen, byte[] source, int sourceLen);
		}

		public string Version { get { return SafeNativeMethods.zlibVersion(); } }

		public ZLibError Compress(byte[] dest, ref int destLength, byte[] source, int sourceLength)
		{
			return SafeNativeMethods.compress(dest, ref destLength, source, sourceLength);
		}

		public ZLibError Compress(byte[] dest, ref int destLength, byte[] source, int sourceLength, ZLibQuality quality)
		{
			return SafeNativeMethods.compress2(dest, ref destLength, source, sourceLength, quality);
		}

		public ZLibError Decompress(byte[] dest, ref int destLength, byte[] source, int sourceLength)
		{
			return SafeNativeMethods.uncompress(dest, ref destLength, source, sourceLength);
		}
	}</pre>

Fragment 2 in file Server\Network\Compression.cs

<pre>public sealed class Compressor64 : ICompressor
	{
		internal class SafeNativeMethods
		{
			[DllImport("zlibwapi64")]
			internal static extern string zlibVersion();

			[DllImport("zlibwapi64")]
			internal static extern ZLibError compress(byte[] dest, ref int destLength, byte[] source, int sourceLength);

			[DllImport("zlibwapi64")]
			internal static extern ZLibError compress2(
				byte[] dest, ref int destLength, byte[] source, int sourceLength, ZLibQuality quality);

			[DllImport("zlibwapi64")]
			internal static extern ZLibError uncompress(byte[] dest, ref int destLen, byte[] source, int sourceLen);
		}

		public string Version { get { return SafeNativeMethods.zlibVersion(); } }

		public ZLibError Compress(byte[] dest, ref int destLength, byte[] source, int sourceLength)
		{
			return SafeNativeMethods.compress(dest, ref destLength, source, sourceLength);
		}

		public ZLibError Compress(byte[] dest, ref int destLength, byte[] source, int sourceLength, ZLibQuality quality)
		{
			return SafeNativeMethods.compress2(dest, ref destLength, source, sourceLength, quality);
		}

		public ZLibError Decompress(byte[] dest, ref int destLength, byte[] source, int sourceLength)
		{
			return SafeNativeMethods.uncompress(dest, ref destLength, source, sourceLength);
		}
	}</pre>

Fragment 3 in file Server\Network\Compression.cs

<pre>public sealed class CompressorUnix32 : ICompressor
	{
		internal class SafeNativeMethods
		{
			[DllImport("libz")]
			internal static extern string zlibVersion();

			[DllImport("libz")]
			internal static extern ZLibError compress(byte[] dest, ref int destLength, byte[] source, int sourceLength);

			[DllImport("libz")]
			internal static extern ZLibError compress2(
				byte[] dest, ref int destLength, byte[] source, int sourceLength, ZLibQuality quality);

			[DllImport("libz")]
			internal static extern ZLibError uncompress(byte[] dest, ref int destLen, byte[] source, int sourceLen);
		}

		public string Version { get { return SafeNativeMethods.zlibVersion(); } }

		public ZLibError Compress(byte[] dest, ref int destLength, byte[] source, int sourceLength)
		{
			return SafeNativeMethods.compress(dest, ref destLength, source, sourceLength);
		}

		public ZLibError Compress(byte[] dest, ref int destLength, byte[] source, int sourceLength, ZLibQuality quality)
		{
			return SafeNativeMethods.compress2(dest, ref destLength, source, sourceLength, quality);
		}

		public ZLibError Decompress(byte[] dest, ref int destLength, byte[] source, int sourceLength)
		{
			return SafeNativeMethods.uncompress(dest, ref destLength, source, sourceLength);
		}
	}</pre>

## Duplicated Code. Size: 402

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\EnslavedGoblinKeeper.cs

<pre>this.Fame = 1500;
            this.Karma = -1500;

            this.VirtualArmor = 28;
            this.QLPoints = 5;

            // Loot - 30-40gold, magicitem,gem,goblin blood, essence control
            switch ( Utility.Random(20) )
            {
                case 0:
                    this.PackItem(new Scimitar());
                    break;
                case 1:
                    this.PackItem(new Katana());
                    break;
                case 2:
                    this.PackItem(new WarMace());
                    break;
                case 3:
                    this.PackItem(new WarHammer());
                    break;
                case 4:
                    this.PackItem(new Kryss());
                    break;
                case 5:
                    this.PackItem(new Pitchfork());
                    break;
            }

            this.PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    this.PackItem(new Ribs());
                    break;
                case 1:
                    this.PackItem(new Shaft());
                    break;
                case 2:
                    this.PackItem(new Candle());
                    break;
            }

            if (0.2 > Utility.RandomDouble())
                this.PackItem(new BolaBall());</pre>

Fragment 2 in file Scripts\Mobiles\Normal\EnslavedGoblinScout.cs

<pre>this.Fame = 1500;
            this.Karma = -1500;

            this.VirtualArmor = 28;
            this.QLPoints = 5;

            // Loot - 30-40gold, magicitem,gem,goblin blood, essence control
            switch ( Utility.Random(20) )
            {
                case 0:
                    this.PackItem(new Scimitar());
                    break;
                case 1:
                    this.PackItem(new Katana());
                    break;
                case 2:
                    this.PackItem(new WarMace());
                    break;
                case 3:
                    this.PackItem(new WarHammer());
                    break;
                case 4:
                    this.PackItem(new Kryss());
                    break;
                case 5:
                    this.PackItem(new Pitchfork());
                    break;
            }

            this.PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    this.PackItem(new Ribs());
                    break;
                case 1:
                    this.PackItem(new Shaft());
                    break;
                case 2:
                    this.PackItem(new Candle());
                    break;
            }

            if (0.2 > Utility.RandomDouble())
                this.PackItem(new BolaBall());</pre>

## Duplicated Code. Size: 402

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\EnslavedGrayGoblin.cs

<pre>this.Fame = 1500;
            this.Karma = -1500;

            this.VirtualArmor = 28;
            this.QLPoints = 2;

            // Loot - 30-40gold, magicitem,gem,goblin blood, essence control
            switch ( Utility.Random(20) )
            {
                case 0:
                    this.PackItem(new Scimitar());
                    break;
                case 1:
                    this.PackItem(new Katana());
                    break;
                case 2:
                    this.PackItem(new WarMace());
                    break;
                case 3:
                    this.PackItem(new WarHammer());
                    break;
                case 4:
                    this.PackItem(new Kryss());
                    break;
                case 5:
                    this.PackItem(new Pitchfork());
                    break;
            }

            this.PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    this.PackItem(new Ribs());
                    break;
                case 1:
                    this.PackItem(new Shaft());
                    break;
                case 2:
                    this.PackItem(new Candle());
                    break;
            }

            if (0.2 > Utility.RandomDouble())
                this.PackItem(new BolaBall());</pre>

Fragment 2 in file Scripts\Mobiles\Normal\EnslavedGreenGoblin.cs

<pre>this.Fame = 1500;
            this.Karma = -1500;

            this.VirtualArmor = 28;
            this.QLPoints = 2;

            // Loot - 30-40gold, magicitem,gem,goblin blood, essence control
            switch ( Utility.Random(20) )
            {
                case 0:
                    this.PackItem(new Scimitar());
                    break;
                case 1:
                    this.PackItem(new Katana());
                    break;
                case 2:
                    this.PackItem(new WarMace());
                    break;
                case 3:
                    this.PackItem(new WarHammer());
                    break;
                case 4:
                    this.PackItem(new Kryss());
                    break;
                case 5:
                    this.PackItem(new Pitchfork());
                    break;
            }

            this.PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    this.PackItem(new Ribs());
                    break;
                case 1:
                    this.PackItem(new Shaft());
                    break;
                case 2:
                    this.PackItem(new Candle());
                    break;
            }

            if (0.2 > Utility.RandomDouble())
                this.PackItem(new BolaBall());</pre>

## Duplicated Code. Size: 402

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\EnslavedGoblinMage.cs

<pre>this.Fame = 1500;
            this.Karma = -1500;

            this.VirtualArmor = 28;
            this.QLPoints = 8;

            // Loot - 30-40gold, magicitem,gem,goblin blood, essence control
            switch ( Utility.Random(20) )
            {
                case 0:
                    this.PackItem(new Scimitar());
                    break;
                case 1:
                    this.PackItem(new Katana());
                    break;
                case 2:
                    this.PackItem(new WarMace());
                    break;
                case 3:
                    this.PackItem(new WarHammer());
                    break;
                case 4:
                    this.PackItem(new Kryss());
                    break;
                case 5:
                    this.PackItem(new Pitchfork());
                    break;
            }

            this.PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    this.PackItem(new Ribs());
                    break;
                case 1:
                    this.PackItem(new Shaft());
                    break;
                case 2:
                    this.PackItem(new Candle());
                    break;
            }

            if (0.2 > Utility.RandomDouble())
                this.PackItem(new BolaBall());</pre>

Fragment 2 in file Scripts\Mobiles\Normal\EnslavedGreenGoblinAlchemist.cs

<pre>this.Fame = 1500;
            this.Karma = -1500;

            this.VirtualArmor = 28;
            this.QLPoints = 8;

            // loot 30-40 gold, magic item, gem, essence control,gob blood
            switch ( Utility.Random(20) )
            {
                case 0:
                    this.PackItem(new Scimitar());
                    break;
                case 1:
                    this.PackItem(new Katana());
                    break;
                case 2:
                    this.PackItem(new WarMace());
                    break;
                case 3:
                    this.PackItem(new WarHammer());
                    break;
                case 4:
                    this.PackItem(new Kryss());
                    break;
                case 5:
                    this.PackItem(new Pitchfork());
                    break;
            }

            this.PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    this.PackItem(new Ribs());
                    break;
                case 1:
                    this.PackItem(new Shaft());
                    break;
                case 2:
                    this.PackItem(new Candle());
                    break;
            }

            if (0.2 > Utility.RandomDouble())
                this.PackItem(new BolaBall());</pre>

Fragment 3 in file Scripts\Mobiles\Normal\GrayGoblin.cs

<pre>this.Fame = 1500;
            this.Karma = -1500;

            this.VirtualArmor = 28;
            this.QLPoints = 8;

            switch ( Utility.Random(20) )
            {
                case 0:
                    this.PackItem(new Scimitar());
                    break;
                case 1:
                    this.PackItem(new Katana());
                    break;
                case 2:
                    this.PackItem(new WarMace());
                    break;
                case 3:
                    this.PackItem(new WarHammer());
                    break;
                case 4:
                    this.PackItem(new Kryss());
                    break;
                case 5:
                    this.PackItem(new Pitchfork());
                    break;
            }

            this.PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    this.PackItem(new Ribs());
                    break;
                case 1:
                    this.PackItem(new Shaft());
                    break;
                case 2:
                    this.PackItem(new Candle());
                    break;
            }

            if (0.2 > Utility.RandomDouble())
                this.PackItem(new BolaBall());</pre>

## Duplicated Code. Size: 400

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\Abilities.cs

<pre>Effects.SendLocationParticles(
                EffectItem.Create(new Point3D(from.X - 1, from.Y - 1, from.Z), from.Map, EffectItem.DefaultDuration),
                0x3709, 10, 30, 0, 4, 0, 0);
            Effects.SendLocationParticles(
                EffectItem.Create(new Point3D(from.X - 1, from.Y + 1, from.Z), from.Map, EffectItem.DefaultDuration),
                0x3709, 10, 30, 0, 4, 0, 0);
            Effects.SendLocationParticles(
                EffectItem.Create(new Point3D(from.X + 1, from.Y - 1, from.Z), from.Map, EffectItem.DefaultDuration),
                0x3709, 10, 30, 0, 4, 0, 0);
            Effects.SendLocationParticles(
                EffectItem.Create(new Point3D(from.X + 1, from.Y + 1, from.Z), from.Map, EffectItem.DefaultDuration),
                0x3709, 10, 30, 0, 4, 0, 0);</pre>

Fragment 2 in file Scripts\Abilities\AbilityTheSix.cs

<pre>Effects.SendLocationParticles(
                    EffectItem.Create(new Point3D(from.X - 1, from.Y - 1, from.Z), from.Map, EffectItem.DefaultDuration),
                    0x3709, 10, 30, 0, 4, 0, 0);
                Effects.SendLocationParticles(
                    EffectItem.Create(new Point3D(from.X - 1, from.Y + 1, from.Z), from.Map, EffectItem.DefaultDuration),
                    0x3709, 10, 30, 0, 4, 0, 0);
                Effects.SendLocationParticles(
                    EffectItem.Create(new Point3D(from.X + 1, from.Y - 1, from.Z), from.Map, EffectItem.DefaultDuration),
                    0x3709, 10, 30, 0, 4, 0, 0);
                Effects.SendLocationParticles(
                    EffectItem.Create(new Point3D(from.X + 1, from.Y + 1, from.Z), from.Map, EffectItem.DefaultDuration),
                    0x3709, 10, 30, 0, 4, 0, 0);</pre>

## Duplicated Code. Size: 396

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BlackSolenWorker.cs

<pre>this.SetStr(96, 120);
            this.SetDex(81, 105);
            this.SetInt(36, 60);

            this.SetHits(58, 72);

            this.SetDamage(5, 7);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 25, 30);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 10, 20);
            this.SetResistance(ResistanceType.Energy, 20, 30);

            this.SetSkill(SkillName.MagicResist, 60.0);
            this.SetSkill(SkillName.Tactics, 65.0);
            this.SetSkill(SkillName.Wrestling, 60.0);

            this.Fame = 1500;
            this.Karma = -1500;

            this.VirtualArmor = 28;

            this.PackGold(Utility.Random(100, 180));

            SolenHelper.PackPicnicBasket(this);

            this.PackItem(new ZoogiFungus());</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RedSolenWorker.cs

<pre>this.SetStr(96, 120);
            this.SetDex(81, 105);
            this.SetInt(36, 60);

            this.SetHits(58, 72);

            this.SetDamage(5, 7);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 25, 30);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 10, 20);
            this.SetResistance(ResistanceType.Energy, 20, 30);

            this.SetSkill(SkillName.MagicResist, 60.0);
            this.SetSkill(SkillName.Tactics, 65.0);
            this.SetSkill(SkillName.Wrestling, 60.0);

            this.Fame = 1500;
            this.Karma = -1500;

            this.VirtualArmor = 28;

            this.PackGold(Utility.Random(100, 180));

            SolenHelper.PackPicnicBasket(this);

            this.PackItem(new ZoogiFungus());</pre>

## Duplicated Code. Size: 396

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>Spellbook book = new Spellbook();
            book.Movable = false;
            book.LootType = LootType.Newbied;
            book.Content = 0xFFFFFFFFFFFFFFFF;
            this.AddItem(book);

            LeatherArms lea = new LeatherArms();
            lea.Movable = false;
            lea.LootType = LootType.Newbied;
            lea.Crafter = this;
            lea.Quality = ArmorQuality.Regular;
            this.AddItem(lea);

            LeatherChest lec = new LeatherChest();
            lec.Movable = false;
            lec.LootType = LootType.Newbied;
            lec.Crafter = this;
            lec.Quality = ArmorQuality.Regular;
            this.AddItem(lec);

            LeatherGorget leg = new LeatherGorget();
            leg.Movable = false;
            leg.LootType = LootType.Newbied;
            leg.Crafter = this;
            leg.Quality = ArmorQuality.Regular;
            this.AddItem(leg);

            LeatherLegs lel = new LeatherLegs();
            lel.Movable = false;
            lel.LootType = LootType.Newbied;
            lel.Crafter = this;
            lel.Quality = ArmorQuality.Regular;
            this.AddItem(lel);</pre>

Fragment 2 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>Spellbook book = new Spellbook();
            book.Movable = false;
            book.LootType = LootType.Newbied;
            book.Content = 0xFFFFFFFFFFFFFFFF;
            this.AddItem(book);

            LeatherArms lea = new LeatherArms();
            lea.Movable = false;
            lea.LootType = LootType.Newbied;
            lea.Crafter = this;
            lea.Quality = ArmorQuality.Regular;
            this.AddItem(lea);

            LeatherChest lec = new LeatherChest();
            lec.Movable = false;
            lec.LootType = LootType.Newbied;
            lec.Crafter = this;
            lec.Quality = ArmorQuality.Regular;
            this.AddItem(lec);

            LeatherGorget leg = new LeatherGorget();
            leg.Movable = false;
            leg.LootType = LootType.Newbied;
            leg.Crafter = this;
            leg.Quality = ArmorQuality.Regular;
            this.AddItem(leg);

            LeatherLegs lel = new LeatherLegs();
            lel.Movable = false;
            lel.LootType = LootType.Newbied;
            lel.Crafter = this;
            lel.Quality = ArmorQuality.Regular;
            this.AddItem(lel);</pre>

## Duplicated Code. Size: 396

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBJewel.cs

<pre>this.Add(new GenericBuyInfo(typeof(StarSapphire), 125, 20, 0xF21, 0));
                this.Add(new GenericBuyInfo(typeof(Emerald), 100, 20, 0xF10, 0));
                this.Add(new GenericBuyInfo(typeof(Sapphire), 100, 20, 0xF19, 0));
                this.Add(new GenericBuyInfo(typeof(Ruby), 75, 20, 0xF13, 0));
                this.Add(new GenericBuyInfo(typeof(Citrine), 50, 20, 0xF15, 0));
                this.Add(new GenericBuyInfo(typeof(Amethyst), 100, 20, 0xF16, 0));
                this.Add(new GenericBuyInfo(typeof(Tourmaline), 75, 20, 0xF2D, 0));
                this.Add(new GenericBuyInfo(typeof(Amber), 50, 20, 0xF25, 0));
                this.Add(new GenericBuyInfo(typeof(Diamond), 200, 20, 0xF26, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBVagabond.cs

<pre>this.Add(new GenericBuyInfo(typeof(StarSapphire), 125, 20, 0xF21, 0));
                this.Add(new GenericBuyInfo(typeof(Emerald), 100, 20, 0xF10, 0));
                this.Add(new GenericBuyInfo(typeof(Sapphire), 100, 20, 0xF19, 0));
                this.Add(new GenericBuyInfo(typeof(Ruby), 75, 20, 0xF13, 0));
                this.Add(new GenericBuyInfo(typeof(Citrine), 50, 20, 0xF15, 0));
                this.Add(new GenericBuyInfo(typeof(Amethyst), 100, 20, 0xF16, 0));
                this.Add(new GenericBuyInfo(typeof(Tourmaline), 75, 20, 0xF2D, 0));
                this.Add(new GenericBuyInfo(typeof(Amber), 50, 20, 0xF25, 0));
                this.Add(new GenericBuyInfo(typeof(Diamond), 200, 20, 0xF26, 0));</pre>

## Duplicated Code. Size: 396

### Duplicated Fragments:

Fragment 1 in file Ultima\Multis.cs

<pre>int centerx = m_Max.X - (int)(Math.Round((m_Max.X - m_Min.X) / 2.0));
						int centery = m_Max.Y - (int)(Math.Round((m_Max.Y - m_Min.Y) / 2.0));

						m_Min = m_Max = Point.Empty;
						int i = 0;
						for (; i < m_SortedTiles.Length; i++)
						{
							m_SortedTiles[i].m_OffsetX -= (short)centerx;
							m_SortedTiles[i].m_OffsetY -= (short)centery;
							if (m_SortedTiles[i].m_OffsetX < m_Min.X)
							{
								m_Min.X = m_SortedTiles[i].m_OffsetX;
							}
							if (m_SortedTiles[i].m_OffsetX > m_Max.X)
							{
								m_Max.X = m_SortedTiles[i].m_OffsetX;
							}

							if (m_SortedTiles[i].m_OffsetY < m_Min.Y)
							{
								m_Min.Y = m_SortedTiles[i].m_OffsetY;
							}
							if (m_SortedTiles[i].m_OffsetY > m_Max.Y)
							{
								m_Max.Y = m_SortedTiles[i].m_OffsetY;
							}
						}</pre>

Fragment 2 in file Ultima\Multis.cs

<pre>int centerx = m_Max.X - (int)(Math.Round((m_Max.X - m_Min.X) / 2.0));
						int centery = m_Max.Y - (int)(Math.Round((m_Max.Y - m_Min.Y) / 2.0));

						m_Min = m_Max = Point.Empty;
						int i = 0;
						for (; i < m_SortedTiles.Length; i++)
						{
							m_SortedTiles[i].m_OffsetX -= (short)centerx;
							m_SortedTiles[i].m_OffsetY -= (short)centery;
							if (m_SortedTiles[i].m_OffsetX < m_Min.X)
							{
								m_Min.X = m_SortedTiles[i].m_OffsetX;
							}
							if (m_SortedTiles[i].m_OffsetX > m_Max.X)
							{
								m_Max.X = m_SortedTiles[i].m_OffsetX;
							}

							if (m_SortedTiles[i].m_OffsetY < m_Min.Y)
							{
								m_Min.Y = m_SortedTiles[i].m_OffsetY;
							}
							if (m_SortedTiles[i].m_OffsetY > m_Max.Y)
							{
								m_Max.Y = m_SortedTiles[i].m_OffsetY;
							}
						}</pre>

Fragment 3 in file Ultima\Multis.cs

<pre>int centerx = m_Max.X - (int)(Math.Round((m_Max.X - m_Min.X) / 2.0));
			int centery = m_Max.Y - (int)(Math.Round((m_Max.Y - m_Min.Y) / 2.0));

			m_Min = m_Max = Point.Empty;
			int i = 0;
			for (; i < m_SortedTiles.Length; i++)
			{
				m_SortedTiles[i].m_OffsetX -= (short)centerx;
				m_SortedTiles[i].m_OffsetY -= (short)centery;
				if (m_SortedTiles[i].m_OffsetX < m_Min.X)
				{
					m_Min.X = m_SortedTiles[i].m_OffsetX;
				}
				if (m_SortedTiles[i].m_OffsetX > m_Max.X)
				{
					m_Max.X = m_SortedTiles[i].m_OffsetX;
				}

				if (m_SortedTiles[i].m_OffsetY < m_Min.Y)
				{
					m_Min.Y = m_SortedTiles[i].m_OffsetY;
				}
				if (m_SortedTiles[i].m_OffsetY > m_Max.Y)
				{
					m_Max.Y = m_SortedTiles[i].m_OffsetY;
				}
			}</pre>

## Duplicated Code. Size: 394

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\QuestLogGump.cs

<pre>AddButton( 60 - xoffset, y + 2, 0xFAB, 0xFAD, 2000 + i, GumpButtonType.Reply, 0 ); // open gump

					int color;

					if(!e.IsValid)
					{
						color = 33;
					} 
					else
						if(e.IsCompleted)
					{
						color = 67;
					} 
					else
					{
						color = 5;
					}

					AddLabel( 100 - xoffset, y, color, (string)e.Name );

					//AddHtmlLocalized( 315, y, 200, 32, e.IsCompleted ? 1049071 : 1049072, htmlcolor, false, false ); // Completed/Incomplete
					AddLabel( 315 - xoffset, y, color, e.IsCompleted ? "Completed" : "In Progress" );

					// indicate the expiration time
					if(e.IsValid)
					{

						// do a little parsing of the expiration string to fit it in the space
						string substring = e.ExpirationString;
						if(e.ExpirationString.IndexOf("Expires in") >= 0)
						{
							substring = e.ExpirationString.Substring(11);
						}
						AddLabel( 400 - xoffset, y, color, (string)substring );
					} 
					else
					{
						AddLabel( 400 - xoffset, y, color, "No longer valid" );
					}

					if(e.PartyEnabled)
					{

						AddLabel( 270 - xoffset, y, color, "Party" );
						//AddHtmlLocalized( 250, y, 200, 32, 3000332, htmlcolor, false, false ); // Party
					} 
					else 
					{

						AddLabel( 270 - xoffset, y, color, "Solo" );
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestBookGump.cs

<pre>AddButton( 60 - xoffset, y + 2, 0xFAB, 0xFAD, 2000 + i, GumpButtonType.Reply, 0 ); // open gump

                    int color;

                    if(!e.IsValid)
                    {
                        color = 33;
                    } else
                    if(e.IsCompleted)
                    {
                        color = 67;
                    } else
                    {
                        color = 5;
                    }

					AddLabel( 100 - xoffset, y, color, (string)e.Name );

					//AddHtmlLocalized( 315, y, 200, 32, e.IsCompleted ? 1049071 : 1049072, htmlcolor, false, false ); // Completed/Incomplete
					AddLabel( 315 - xoffset, y, color, e.IsCompleted ? "Completed" : "In Progress" );

					// indicate the expiration time
                    if(e.IsValid){

                        // do a little parsing of the expiration string to fit it in the space
                        string substring = e.ExpirationString;
                        if(e.ExpirationString.IndexOf("Expires in") >= 0)
                        {
                            substring = e.ExpirationString.Substring(11);
                        }
                        AddLabel( 400 - xoffset, y, color, (string)substring );
                    } else
                    {
                    	AddLabel( 400 - xoffset, y, color, "No longer valid" );
                    }

                    if(e.PartyEnabled){

                        AddLabel( 270 - xoffset, y, color, "Party" );
                        //AddHtmlLocalized( 250, y, 200, 32, 3000332, htmlcolor, false, false ); // Party
                    } else {

                        AddLabel( 270 - xoffset, y, color, "Solo" );
                    }</pre>

## Duplicated Code. Size: 394

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGauntlet.cs

<pre>ArrayList mlist = new ArrayList();
            ArrayList elist = new ArrayList();

            // who is currently on the hill
            foreach( Mobile p in this.GetMobilesInRange(0))
            {
                if(p == null) continue;

                IChallengeEntry entry = GetParticipant(p);

                // if this is not a current participant then move them
                if(entry == null)
                {
                    // prepare to move them off
                    mlist.Add(p);
                } else
                // dont let players who are in a caution state such as hidden to score
                if(entry.Caution == ChallengeStatus.None)
                {
                    // prepare to bump their score
                    elist.Add(entry);
                }
            }

            // move non-participants
            foreach( Mobile p in mlist)
            {
                for(int i = 10; i<20;i++)
                {
                    int x = p.Location.X + i*(Utility.RandomBool() ? 1 : -1);
                    int y = p.Location.Y + i*(Utility.RandomBool() ? 1 : -1);
                    int z = Map.GetAverageZ( x, y );
                    Point3D newloc = new Point3D(x,y,z);

                    if(XmlSpawner.IsValidMapLocation(newloc, p.Map))
                    {
                        p.MoveToWorld(newloc, p.Map);
                    }
                }
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGauntlet.cs

<pre>ArrayList mlist = new ArrayList();
            ArrayList elist = new ArrayList();

            // who is currently on the hill
            foreach( Mobile p in this.GetMobilesInRange(0))
            {
                if(p == null) continue;

                IChallengeEntry entry = GetParticipant(p);

                // if this is not a current participant then move them
                if(entry == null)
                {
                    // prepare to move them off
                    mlist.Add(p);
                } else
                // dont let players who are in a caution state such as hidden to score
                if(entry.Caution == ChallengeStatus.None)
                {
                    // prepare to bump their score
                    elist.Add(entry);
                }
            }

            // move non-participants
            foreach( Mobile p in mlist)
            {
                for(int i = 10; i<20;i++)
                {
                    int x = p.Location.X + i*(Utility.RandomBool() ? 1 : -1);
                    int y = p.Location.Y + i*(Utility.RandomBool() ? 1 : -1);
                    int z = Map.GetAverageZ( x, y );
                    Point3D newloc = new Point3D(x,y,z);

                    if(XmlSpawner.IsValidMapLocation(newloc, p.Map))
                    {
                        p.MoveToWorld(newloc, p.Map);
                    }
                }
            }</pre>

## Duplicated Code. Size: 391

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>SetSaveFlag(ref sflags, SetFlag.LastEquipped, this.m_LastEquipped);
            SetSaveFlag(ref sflags, SetFlag.SetEquipped, this.m_SetEquipped);
            SetSaveFlag(ref sflags, SetFlag.SetSelfRepair, this.m_SetSelfRepair != 0);

            writer.WriteEncodedInt((int)sflags);

            if (GetSaveFlag(sflags, SetFlag.Attributes))
                this.m_SetAttributes.Serialize(writer);

            if (GetSaveFlag(sflags, SetFlag.SkillBonuses))
                this.m_SetSkillBonuses.Serialize(writer);

            if (GetSaveFlag(sflags, SetFlag.PhysicalBonus))
                writer.WriteEncodedInt((int)this.m_SetPhysicalBonus);

            if (GetSaveFlag(sflags, SetFlag.FireBonus))
                writer.WriteEncodedInt((int)this.m_SetFireBonus);

            if (GetSaveFlag(sflags, SetFlag.ColdBonus))
                writer.WriteEncodedInt((int)this.m_SetColdBonus);

            if (GetSaveFlag(sflags, SetFlag.PoisonBonus))
                writer.WriteEncodedInt((int)this.m_SetPoisonBonus);

            if (GetSaveFlag(sflags, SetFlag.EnergyBonus))
                writer.WriteEncodedInt((int)this.m_SetEnergyBonus);</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>SetSaveFlag(ref sflags, SetFlag.LastEquipped, this.m_LastEquipped);
            SetSaveFlag(ref sflags, SetFlag.SetEquipped, this.m_SetEquipped);
            SetSaveFlag(ref sflags, SetFlag.SetSelfRepair, this.m_SetSelfRepair != 0);

            writer.WriteEncodedInt((int)sflags);

            if (GetSaveFlag(sflags, SetFlag.Attributes))
                this.m_SetAttributes.Serialize(writer);

            if (GetSaveFlag(sflags, SetFlag.SkillBonuses))
                this.m_SetSkillBonuses.Serialize(writer);

            if (GetSaveFlag(sflags, SetFlag.PhysicalBonus))
                writer.WriteEncodedInt((int)this.m_SetPhysicalBonus);

            if (GetSaveFlag(sflags, SetFlag.FireBonus))
                writer.WriteEncodedInt((int)this.m_SetFireBonus);

            if (GetSaveFlag(sflags, SetFlag.ColdBonus))
                writer.WriteEncodedInt((int)this.m_SetColdBonus);

            if (GetSaveFlag(sflags, SetFlag.PoisonBonus))
                writer.WriteEncodedInt((int)this.m_SetPoisonBonus);

            if (GetSaveFlag(sflags, SetFlag.EnergyBonus))
                writer.WriteEncodedInt((int)this.m_SetEnergyBonus);</pre>

## Duplicated Code. Size: 391

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\DevourerRenowned.cs

<pre>this.SetDamage(22, 26);

            this.SetDamageType(ResistanceType.Physical, 60);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Energy, 20);

            this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 25, 35);
            this.SetResistance(ResistanceType.Cold, 15, 25);
            this.SetResistance(ResistanceType.Poison, 60, 70);
            this.SetResistance(ResistanceType.Energy, 40, 50);

            this.SetSkill(SkillName.EvalInt, 90.1, 100.0);
            this.SetSkill(SkillName.Magery, 90.1, 100.0);
            this.SetSkill(SkillName.Meditation, 90.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 90.1, 105.0);
            this.SetSkill(SkillName.Tactics, 75.1, 85.0);
            this.SetSkill(SkillName.Wrestling, 80.1, 100.0);

            this.Fame = 9500;
            this.Karma = -9500;

            this.VirtualArmor = 44;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Devourer.cs

<pre>this.SetDamage(22, 26);

            this.SetDamageType(ResistanceType.Physical, 60);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Energy, 20);

            this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 25, 35);
            this.SetResistance(ResistanceType.Cold, 15, 25);
            this.SetResistance(ResistanceType.Poison, 60, 70);
            this.SetResistance(ResistanceType.Energy, 40, 50);

            this.SetSkill(SkillName.EvalInt, 90.1, 100.0);
            this.SetSkill(SkillName.Magery, 90.1, 100.0);
            this.SetSkill(SkillName.Meditation, 90.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 90.1, 105.0);
            this.SetSkill(SkillName.Tactics, 75.1, 85.0);
            this.SetSkill(SkillName.Wrestling, 80.1, 100.0);

            this.Fame = 9500;
            this.Karma = -9500;

            this.VirtualArmor = 44;</pre>

## Duplicated Code. Size: 391

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GreyWolf.cs

<pre>this.BaseSoundID = 0xE5;

            this.SetStr(56, 80);
            this.SetDex(56, 75);
            this.SetInt(31, 55);

            this.SetHits(34, 48);
            this.SetMana(0);

            this.SetDamage(3, 7);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 20);
            this.SetResistance(ResistanceType.Fire, 10, 15);
            this.SetResistance(ResistanceType.Cold, 20, 25);
            this.SetResistance(ResistanceType.Poison, 10, 15);
            this.SetResistance(ResistanceType.Energy, 10, 15);

            this.SetSkill(SkillName.MagicResist, 20.1, 35.0);
            this.SetSkill(SkillName.Tactics, 45.1, 60.0);
            this.SetSkill(SkillName.Wrestling, 45.1, 60.0);

            this.Fame = 450;
            this.Karma = 0;

            this.VirtualArmor = 16;

            this.Tamable = true;
            this.ControlSlots = 1;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\WhiteWolf.cs

<pre>this.BaseSoundID = 0xE5;

            this.SetStr(56, 80);
            this.SetDex(56, 75);
            this.SetInt(31, 55);

            this.SetHits(34, 48);
            this.SetMana(0);

            this.SetDamage(3, 7);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 20);
            this.SetResistance(ResistanceType.Fire, 10, 15);
            this.SetResistance(ResistanceType.Cold, 20, 25);
            this.SetResistance(ResistanceType.Poison, 10, 15);
            this.SetResistance(ResistanceType.Energy, 10, 15);

            this.SetSkill(SkillName.MagicResist, 20.1, 35.0);
            this.SetSkill(SkillName.Tactics, 45.1, 60.0);
            this.SetSkill(SkillName.Wrestling, 45.1, 60.0);

            this.Fame = 450;
            this.Karma = 0;

            this.VirtualArmor = 16;

            this.Tamable = true;
            this.ControlSlots = 1;</pre>

## Duplicated Code. Size: 391

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Ethics\Evil\Mobiles\UnholyFamiliar.cs

<pre>this.BaseSoundID = 0xE5;

            this.SetStr(96, 120);
            this.SetDex(81, 105);
            this.SetInt(36, 60);

            this.SetHits(58, 72);
            this.SetMana(0);

            this.SetDamage(11, 17);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 20, 25);
            this.SetResistance(ResistanceType.Fire, 10, 20);
            this.SetResistance(ResistanceType.Cold, 5, 10);
            this.SetResistance(ResistanceType.Poison, 5, 10);
            this.SetResistance(ResistanceType.Energy, 10, 15);

            this.SetSkill(SkillName.MagicResist, 57.6, 75.0);
            this.SetSkill(SkillName.Tactics, 50.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 80.0);

            this.Fame = 2500;
            this.Karma = 2500;

            this.VirtualArmor = 22;

            this.Tamable = false;
            this.ControlSlots = 1;</pre>

Fragment 2 in file Scripts\Services\Ethics\Hero\Mobiles\HolyFamiliar.cs

<pre>this.BaseSoundID = 0xE5;

            this.SetStr(96, 120);
            this.SetDex(81, 105);
            this.SetInt(36, 60);

            this.SetHits(58, 72);
            this.SetMana(0);

            this.SetDamage(11, 17);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 20, 25);
            this.SetResistance(ResistanceType.Fire, 10, 20);
            this.SetResistance(ResistanceType.Cold, 5, 10);
            this.SetResistance(ResistanceType.Poison, 5, 10);
            this.SetResistance(ResistanceType.Energy, 10, 15);

            this.SetSkill(SkillName.MagicResist, 57.6, 75.0);
            this.SetSkill(SkillName.Tactics, 50.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 80.0);

            this.Fame = 2500;
            this.Karma = 2500;

            this.VirtualArmor = 22;

            this.Tamable = false;
            this.ControlSlots = 1;</pre>

## Duplicated Code. Size: 388

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ClockworkScorpion.cs

<pre>this.SetStr(225, 245);
            this.SetDex(80, 100);
            this.SetInt(30, 40);

            this.SetHits(151, 210);

            this.SetDamage(5, 10);

            this.SetDamageType(ResistanceType.Physical, 60);
            this.SetDamageType(ResistanceType.Poison, 40);

            this.SetResistance(ResistanceType.Physical, 80, 100);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 60, 80);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 10, 25);

            this.SetSkill(SkillName.MagicResist, 30.1, 50.0);
            this.SetSkill(SkillName.Poisoning, 95.1, 100.0);
            this.SetSkill(SkillName.Tactics, 70.1, 90.0);
            this.SetSkill(SkillName.Wrestling, 50.1, 80.0);

            this.Fame = 3500;
            this.Karma = -3500;

            this.ControlSlots = 1;</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Vollem.cs

<pre>this.SetStr(225, 245);
            this.SetDex(80, 100);
            this.SetInt(30, 40);

            this.SetHits(151, 210);

            this.SetDamage(5, 10);

            this.SetDamageType(ResistanceType.Physical, 60);
            this.SetDamageType(ResistanceType.Poison, 40);

            this.SetResistance(ResistanceType.Physical, 80, 100);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 60, 80);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 10, 25);

            this.SetSkill(SkillName.MagicResist, 30.1, 50.0);
            this.SetSkill(SkillName.Poisoning, 95.1, 100.0);
            this.SetSkill(SkillName.Tactics, 70.1, 90.0);
            this.SetSkill(SkillName.Wrestling, 50.1, 80.0);

            this.Fame = 3500;
            this.Karma = -3500;

            this.ControlSlots = 1;</pre>

## Duplicated Code. Size: 387

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X - 1, m.Y, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y - 1, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    this.m_Timer = new FireStormTimer(DateTime.UtcNow, m, effHue, 0, 1);
                    this.m_Timer.Start();
                    break;</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X - 1, m.Y, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y - 1, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z), m.Map, 0x3709, 17, effHue, 0);
                    this.m_Timer = new FireStormTimer(DateTime.UtcNow, m, effHue, 0, 1);
                    this.m_Timer.Start();
                    break;</pre>

## Duplicated Code. Size: 387

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>base.State = state;

			// update the graphic
			SetSwitchStatic();

			// play the switching sound
			//if (from != null)
			//{
			//	from.PlaySound(m_SwitchSound);
			//}
			try
			{
				Effects.PlaySound(Location, Map, m_SwitchSound);
			}
			catch { }

			// if a target object has been specified then apply the property modification
			if (state == 0 && m_TargetItem0 != null && !m_TargetItem0.Deleted && m_TargetProperty0 != null && m_TargetProperty0.Length > 0)
			{
				BaseXmlSpawner.ApplyObjectStringProperties(null, m_TargetProperty0, m_TargetItem0, null, this, out status_str);
			}
			if (state == 1 && m_TargetItem1 != null && !m_TargetItem1.Deleted && m_TargetProperty1 != null && m_TargetProperty1.Length > 0)
			{
				BaseXmlSpawner.ApplyObjectStringProperties(null, m_TargetProperty1, m_TargetItem1, null, this, out status_str);
			}

			// if the switch is linked, then activate the link as well
			if (Link != null && Link is ILinkable)
			{
				if (links == null)
				{
					links = new ArrayList();
				}
				// activate other linked objects if they have not already been activated
				if (!links.Contains(this))
				{
					links.Add(this);

					((ILinkable)Link).Activate(from, state, links);
				}
			}

			// report any problems to staff
			if (status_str != null && from != null && from.AccessLevel > AccessLevel.Player)
			{
				from.SendMessage("{0}", status_str);
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>base.State = state;

			// update the graphic
			SetSwitchStatic();

			// play the switching sound
			//if (from != null)
			//{
			//	from.PlaySound(m_SwitchSound);
			//}
			try
			{
				Effects.PlaySound(Location, Map, m_SwitchSound);
			}
			catch { }

			// if a target object has been specified then apply the property modification
			if (state == 0 && m_TargetItem0 != null && !m_TargetItem0.Deleted && m_TargetProperty0 != null && m_TargetProperty0.Length > 0)
			{
				BaseXmlSpawner.ApplyObjectStringProperties(null, m_TargetProperty0, m_TargetItem0, null, this, out status_str);
			}
			if (state == 1 && m_TargetItem1 != null && !m_TargetItem1.Deleted && m_TargetProperty1 != null && m_TargetProperty1.Length > 0)
			{
				BaseXmlSpawner.ApplyObjectStringProperties(null, m_TargetProperty1, m_TargetItem1, null, this, out status_str);
			}

			// if the switch is linked, then activate the link as well
			if (Link != null && Link is ILinkable)
			{
				if (links == null)
				{
					links = new ArrayList();
				}
				// activate other linked objects if they have not already been activated
				if (!links.Contains(this))
				{
					links.Add(this);

					((ILinkable)Link).Activate(from, state, links);
				}
			}

			// report any problems to staff
			if (status_str != null && from != null && from.AccessLevel > AccessLevel.Player)
			{
				from.SendMessage("{0}", status_str);
			}</pre>

## Duplicated Code. Size: 386

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DungeonHitchingPost.cs

<pre>{
                this.m_Post = post;
                this.m_From = from;
                this.m_List = list;

                from.CloseGump(typeof(ClaimListGump));

                this.AddPage(0);

                this.AddBackground(0, 0, 325, 50 + (list.Count * 20), 9250);
                this.AddAlphaRegion(5, 5, 315, 40 + (list.Count * 20));

                this.AddHtml(15, 15, 275, 20, "<BASEFONT COLOR=#FFFFFF>Select a pet to retrieve from the stables:</BASEFONT>", false, false);

                for (int i = 0; i < list.Count; ++i)
                {
                    BaseCreature pet = list[i];

                    if (pet == null || pet.Deleted)
                        continue;

                    this.AddButton(15, 39 + (i * 20), 10006, 10006, i + 1, GumpButtonType.Reply, 0);
                    this.AddHtml(32, 35 + (i * 20), 275, 18, String.Format("<BASEFONT COLOR=#C0C0EE>{0}</BASEFONT>", pet.Name), false, false);
                }
            }</pre>

Fragment 2 in file Scripts\Items\Addons\HitchingPost.cs

<pre>{
                this.m_Post = post;
                this.m_From = from;
                this.m_List = list;

                from.CloseGump(typeof(ClaimListGump));

                this.AddPage(0);

                this.AddBackground(0, 0, 325, 50 + (list.Count * 20), 9250);
                this.AddAlphaRegion(5, 5, 315, 40 + (list.Count * 20));

                this.AddHtml(15, 15, 275, 20, "<BASEFONT COLOR=#FFFFFF>Select a pet to retrieve from the stables:</BASEFONT>", false, false);

                for (int i = 0; i < list.Count; ++i)
                {
                    BaseCreature pet = list[i];

                    if (pet == null || pet.Deleted)
                        continue;

                    this.AddButton(15, 39 + (i * 20), 10006, 10006, i + 1, GumpButtonType.Reply, 0);
                    this.AddHtml(32, 35 + (i * 20), 275, 18, String.Format("<BASEFONT COLOR=#C0C0EE>{0}</BASEFONT>", pet.Name), false, false);
                }
            }</pre>

## Duplicated Code. Size: 384

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTF.cs

<pre>if(Participants == null || !GameInProgress) return;

            ArrayList winner = new ArrayList();

            ArrayList teams = GetTeams();

            int leftstanding = 0;

            int maxscore = -99999;

            // has any team reached the target score
            TeamInfo lastt = null;

            foreach(TeamInfo t in teams)
            {

                if(!HasValidMembers(t)) continue;

                if(TargetScore > 0 && t.Score >= TargetScore)
                {
                        winner.Add(t);
                        t.Winner = true;
                }

                if(t.Score >= maxscore)
                {
                    maxscore = t.Score;
                }
                leftstanding++;
                lastt = t;
            }

            // check to make sure the team hasnt been disqualified

            // if only one is left then they are the winner
            if(leftstanding == 1 && winner.Count == 0)
            {
                winner.Add(lastt);
                lastt.Winner = true;
            }

            if(winner.Count == 0 && MatchLength > TimeSpan.Zero && (DateTime.UtcNow >= MatchStart + MatchLength))
            {
                // find the highest score
                // has anyone reached the target score

                foreach(TeamInfo t in teams)
                {

                    if(!HasValidMembers(t)) continue;

                    if(t.Score >= maxscore)
                    {
                        winner.Add(t);
                        t.Winner = true;
                    }
                }
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGauntlet.cs

<pre>if(Participants == null || !GameInProgress) return;

            ArrayList winner = new ArrayList();

            ArrayList teams = GetTeams();

            int leftstanding = 0;

            int maxscore = -99999;

            // has any team reached the target score
            TeamInfo lastt = null;

            foreach(TeamInfo t in teams)
            {

                if(!HasValidMembers(t)) continue;

                if(TargetScore > 0 && t.Score >= TargetScore)
                {
                        winner.Add(t);
                        t.Winner = true;
                }

                if(t.Score >= maxscore)
                {
                    maxscore = t.Score;
                }
                leftstanding++;
                lastt = t;
            }

            // check to make sure the team hasnt been disqualified

            // if only one is left then they are the winner
            if(leftstanding == 1 && winner.Count == 0)
            {
                winner.Add(lastt);
                lastt.Winner = true;
            }

            if(winner.Count == 0 && MatchLength > TimeSpan.Zero && (DateTime.UtcNow >= MatchStart + MatchLength))
            {
                // find the highest score
                // has anyone reached the target score

                foreach(TeamInfo t in teams)
                {

                    if(!HasValidMembers(t)) continue;

                    if(t.Score >= maxscore)
                    {
                        winner.Add(t);
                        t.Winner = true;
                    }
                }
            }</pre>

## Duplicated Code. Size: 382

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\Ingots.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 2: // Reset from Resource System
                    this.m_Resource = this.DefaultResource;
                    reader.ReadString();
                    break;
                case 1:
                    {
                        this.m_Resource = (CraftResource)reader.ReadInt();
                        break;
                    }
                case 0:
                    {
                        OreInfo info;

                        switch ( reader.ReadInt() )
                        {
                            case 0:
                                info = OreInfo.Iron;
                                break;
                            case 1:
                                info = OreInfo.DullCopper;
                                break;
                            case 2:
                                info = OreInfo.ShadowIron;
                                break;
                            case 3:
                                info = OreInfo.Copper;
                                break;
                            case 4:
                                info = OreInfo.Bronze;
                                break;
                            case 5:
                                info = OreInfo.Gold;
                                break;
                            case 6:
                                info = OreInfo.Agapite;
                                break;
                            case 7:
                                info = OreInfo.Verite;
                                break;
                            case 8:
                                info = OreInfo.Valorite;
                                break;
                            default:
                                info = null;
                                break;
                        }

                        this.m_Resource = CraftResources.GetFromOreInfo(info);
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Resource\Ore.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 2: // Reset from Resource System
                    this.m_Resource = this.DefaultResource;
                    reader.ReadString();
                    break;
                case 1:
                    {
                        this.m_Resource = (CraftResource)reader.ReadInt();
                        break;
                    }
                case 0:
                    {
                        OreInfo info;

                        switch ( reader.ReadInt() )
                        {
                            case 0:
                                info = OreInfo.Iron;
                                break;
                            case 1:
                                info = OreInfo.DullCopper;
                                break;
                            case 2:
                                info = OreInfo.ShadowIron;
                                break;
                            case 3:
                                info = OreInfo.Copper;
                                break;
                            case 4:
                                info = OreInfo.Bronze;
                                break;
                            case 5:
                                info = OreInfo.Gold;
                                break;
                            case 6:
                                info = OreInfo.Agapite;
                                break;
                            case 7:
                                info = OreInfo.Verite;
                                break;
                            case 8:
                                info = OreInfo.Valorite;
                                break;
                            default:
                                info = null;
                                break;
                        }

                        this.m_Resource = CraftResources.GetFromOreInfo(info);
                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 381

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ScaledSwampDragon.cs

<pre>this.SetStr(201, 300);
            this.SetDex(66, 85);
            this.SetInt(61, 100);

            this.SetHits(121, 180);

            this.SetDamage(3, 4);

            this.SetDamageType(ResistanceType.Physical, 75);
            this.SetDamageType(ResistanceType.Poison, 25);

            this.SetResistance(ResistanceType.Physical, 35, 40);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 20, 40);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 30, 40);

            this.SetSkill(SkillName.Anatomy, 45.1, 55.0);
            this.SetSkill(SkillName.MagicResist, 45.1, 55.0);
            this.SetSkill(SkillName.Tactics, 45.1, 55.0);
            this.SetSkill(SkillName.Wrestling, 45.1, 55.0);

            this.Fame = 2000;
            this.Karma = -2000;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SwampDragon.cs

<pre>this.SetStr(201, 300);
            this.SetDex(66, 85);
            this.SetInt(61, 100);

            this.SetHits(121, 180);

            this.SetDamage(3, 4);

            this.SetDamageType(ResistanceType.Physical, 75);
            this.SetDamageType(ResistanceType.Poison, 25);

            this.SetResistance(ResistanceType.Physical, 35, 40);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 20, 40);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 30, 40);

            this.SetSkill(SkillName.Anatomy, 45.1, 55.0);
            this.SetSkill(SkillName.MagicResist, 45.1, 55.0);
            this.SetSkill(SkillName.Tactics, 45.1, 55.0);
            this.SetSkill(SkillName.Wrestling, 45.1, 55.0);

            this.Fame = 2000;
            this.Karma = -2000;</pre>

## Duplicated Code. Size: 378

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x3709, 15, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x208);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x3709, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z + 6), m.Map, 0x3709, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z + 6), m.Map, 0x3709, 15, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x208);</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x3709, 15, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x208);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x3709, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z + 6), m.Map, 0x3709, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z + 6), m.Map, 0x3709, 15, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x208);</pre>

## Duplicated Code. Size: 377

### Duplicated Fragments:

Fragment 1 in file Ultima\Multis.cs

<pre>m_SortedTiles[itemcount].m_ItemID = Convert.ToUInt16(split[0]);
							m_SortedTiles[itemcount].m_OffsetX = Convert.ToInt16(split[1]);
							m_SortedTiles[itemcount].m_OffsetY = Convert.ToInt16(split[2]);
							m_SortedTiles[itemcount].m_OffsetZ = Convert.ToInt16(split[3]);
							m_SortedTiles[itemcount].m_Flags = Convert.ToInt32(split[4]);
							m_SortedTiles[itemcount].m_Unk1 = 0;

							MultiTileEntry e = m_SortedTiles[itemcount];

							if (e.m_OffsetX < m_Min.X)
							{
								m_Min.X = e.m_OffsetX;
							}

							if (e.m_OffsetY < m_Min.Y)
							{
								m_Min.Y = e.m_OffsetY;
							}

							if (e.m_OffsetX > m_Max.X)
							{
								m_Max.X = e.m_OffsetX;
							}

							if (e.m_OffsetY > m_Max.Y)
							{
								m_Max.Y = e.m_OffsetY;
							}

							if (e.m_OffsetZ > m_maxHeight)
							{
								m_maxHeight = e.m_OffsetZ;
							}

							++itemcount;</pre>

Fragment 2 in file Ultima\Multis.cs

<pre>m_SortedTiles[itemcount].m_ItemID = Convert.ToUInt16(split[0]);
				m_SortedTiles[itemcount].m_Flags = Convert.ToInt32(split[1]);
				m_SortedTiles[itemcount].m_OffsetX = Convert.ToInt16(split[2]);
				m_SortedTiles[itemcount].m_OffsetY = Convert.ToInt16(split[3]);
				m_SortedTiles[itemcount].m_OffsetZ = Convert.ToInt16(split[4]);
				m_SortedTiles[itemcount].m_Unk1 = 0;

				MultiTileEntry e = m_SortedTiles[itemcount];

				if (e.m_OffsetX < m_Min.X)
				{
					m_Min.X = e.m_OffsetX;
				}
				if (e.m_OffsetY < m_Min.Y)
				{
					m_Min.Y = e.m_OffsetY;
				}
				if (e.m_OffsetX > m_Max.X)
				{
					m_Max.X = e.m_OffsetX;
				}
				if (e.m_OffsetY > m_Max.Y)
				{
					m_Max.Y = e.m_OffsetY;
				}
				if (e.m_OffsetZ > m_maxHeight)
				{
					m_maxHeight = e.m_OffsetZ;
				}

				++itemcount;</pre>

## Duplicated Code. Size: 375

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Gumps\FinanceGump.cs

<pre>this.AddHtmlLocalized(20, 130, 300, 25, 1011520, false, false); // Finance Minister Upkeep : 
            this.AddLabel(20, 150, 0x44, financeUpkeep.ToString("N0")); // NOTE: Added 'N0'

            this.AddHtmlLocalized(20, 180, 300, 25, 1011521, false, false); // Sheriff Upkeep : 
            this.AddLabel(20, 200, 0x44, sheriffUpkeep.ToString("N0")); // NOTE: Added 'N0'

            this.AddHtmlLocalized(20, 230, 300, 25, 1011522, false, false); // Town Income : 
            this.AddLabel(20, 250, 0x44, dailyIncome.ToString("N0")); // NOTE: Added 'N0'

            this.AddHtmlLocalized(20, 280, 300, 25, 1011523, false, false); // Net Cash flow per day : 
            this.AddLabel(20, 300, 0x44, netCashFlow.ToString("N0")); // NOTE: Added 'N0'

            this.AddHtmlLocalized(55, 360, 200, 25, 1011067, false, false); // Previous page
            this.AddButton(20, 360, 4005, 4007, 0, GumpButtonType.Page, 1);</pre>

Fragment 2 in file Scripts\Services\Factions\Gumps\SheriffGump.cs

<pre>this.AddHtmlLocalized(20, 130, 300, 25, 1011520, false, false); // Finance Minister Upkeep : 
            this.AddLabel(20, 150, 0x44, financeUpkeep.ToString("N0")); // NOTE: Added 'N0'

            this.AddHtmlLocalized(20, 180, 300, 25, 1011521, false, false); // Sheriff Upkeep : 
            this.AddLabel(20, 200, 0x44, sheriffUpkeep.ToString("N0")); // NOTE: Added 'N0'

            this.AddHtmlLocalized(20, 230, 300, 25, 1011522, false, false); // Town Income : 
            this.AddLabel(20, 250, 0x44, dailyIncome.ToString("N0")); // NOTE: Added 'N0'

            this.AddHtmlLocalized(20, 280, 300, 25, 1011523, false, false); // Net Cash flow per day : 
            this.AddLabel(20, 300, 0x44, netCashFlow.ToString("N0")); // NOTE: Added 'N0'

            this.AddHtmlLocalized(55, 360, 200, 25, 1011067, false, false); // Previous page
            this.AddButton(20, 360, 4005, 4007, 0, GumpButtonType.Page, 1);</pre>

## Duplicated Code. Size: 374

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\DupresChampion.cs

<pre>Body = 0x190;
			Hue = Utility.RandomSkinHue();
            Female = false;

			SetStr( 190, 200 );
			SetDex( 50, 75 );
			SetInt( 150, 250  );
			SetHits( 3900, 4100 );
			SetDamage( 22, 28 );

			SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 50, 70 );
			SetResistance( ResistanceType.Fire, 50, 70 );
			SetResistance( ResistanceType.Cold, 50, 70 );
			SetResistance( ResistanceType.Poison, 50, 70 );
			SetResistance( ResistanceType.Energy, 50, 70 );

			SetSkill( SkillName.EvalInt, 195.0, 220.0 );
			SetSkill( SkillName.Magery, 195.0, 220.0 );
			SetSkill( SkillName.Meditation, 195.0, 200.0 );
			SetSkill( SkillName.MagicResist, 100.0, 120.0 );
			SetSkill( SkillName.Tactics, 195.0, 220.0 );
			SetSkill( SkillName.Wrestling, 195.0, 220.0 );

			VirtualArmor = 70;</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\DupresKnight.cs

<pre>Body = 0x190;
			Hue = Utility.RandomSkinHue();
            Female = false;

            SetStr( 190, 200 );
			SetDex( 50, 75 );
			SetInt( 150, 250  );
			SetHits( 3900, 4100 );
			SetDamage( 22, 28 );

			SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 50, 70 );
			SetResistance( ResistanceType.Fire, 50, 70 );
			SetResistance( ResistanceType.Cold, 50, 70 );
			SetResistance( ResistanceType.Poison, 50, 70 );
			SetResistance( ResistanceType.Energy, 50, 70 );

			SetSkill( SkillName.EvalInt, 195.0, 220.0 );
			SetSkill( SkillName.Magery, 195.0, 220.0 );
			SetSkill( SkillName.Meditation, 195.0, 200.0 );
			SetSkill( SkillName.MagicResist, 100.0, 120.0 );
			SetSkill( SkillName.Tactics, 195.0, 220.0 );
			SetSkill( SkillName.Wrestling, 195.0, 220.0 );

			VirtualArmor = 70;</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\DupresSquire.cs

<pre>Body = 0x190;
			Hue = Utility.RandomSkinHue();
            Female = false;

            SetStr( 190, 200 );
			SetDex( 50, 75 );
			SetInt( 150, 250  );
			SetHits( 3900, 4100 );
			SetDamage( 22, 28 );

			SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 50, 70 );
			SetResistance( ResistanceType.Fire, 50, 70 );
			SetResistance( ResistanceType.Cold, 50, 70 );
			SetResistance( ResistanceType.Poison, 50, 70 );
			SetResistance( ResistanceType.Energy, 50, 70 );

			SetSkill( SkillName.EvalInt, 195.0, 220.0 );
			SetSkill( SkillName.Magery, 195.0, 220.0 );
			SetSkill( SkillName.Meditation, 195.0, 200.0 );
			SetSkill( SkillName.MagicResist, 100.0, 120.0 );
			SetSkill( SkillName.Tactics, 195.0, 220.0 );
			SetSkill( SkillName.Wrestling, 195.0, 220.0 );

			VirtualArmor = 70;</pre>

## Duplicated Code. Size: 373

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\DespiseBosses.cs

<pre>SetStr( 900, 1200 );
			SetDex( 500, 600 );
			SetInt( 500, 600 );

			SetHits( 60000 );
			SetStam( 415 );
			SetMana( 22000 );

			SetDamage( 18, 28 );

			SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 40, 60 );
			SetResistance( ResistanceType.Fire, 40, 60 );
			SetResistance( ResistanceType.Cold, 40, 60 );
			SetResistance( ResistanceType.Poison, 40, 60 );
			SetResistance( ResistanceType.Energy, 40, 60 );

			SetSkill( SkillName.MagicResist, 120 );
			SetSkill( SkillName.Tactics, 120 );
			SetSkill( SkillName.Wrestling, 120 );
			SetSkill( SkillName.Anatomy, 120 );
			SetSkill( SkillName.Magery, 120 );
			SetSkill( SkillName.EvalInt, 120 );
			SetSkill( SkillName.Mysticism, 120 );
			SetSkill( SkillName.Focus, 160 );

			Fame = 22000;</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\DespiseBosses.cs

<pre>SetStr( 900, 1200 );
			SetDex( 500, 600 );
			SetInt( 500, 600 );

			SetHits( 60000 );
			SetStam( 415 );
			SetMana( 22000 );

			SetDamage( 18, 28 );

			SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 40, 60 );
			SetResistance( ResistanceType.Fire, 40, 60 );
			SetResistance( ResistanceType.Cold, 40, 60 );
			SetResistance( ResistanceType.Poison, 40, 60 );
			SetResistance( ResistanceType.Energy, 40, 60 );

			SetSkill( SkillName.MagicResist, 120 );
			SetSkill( SkillName.Tactics, 120 );
			SetSkill( SkillName.Wrestling, 120 );
			SetSkill( SkillName.Anatomy, 120 );
			SetSkill( SkillName.Magery, 120 );
			SetSkill( SkillName.EvalInt, 120 );
			SetSkill( SkillName.Mysticism, 120 );
			SetSkill( SkillName.Focus, 160 );

			Fame = 22000;</pre>

## Duplicated Code. Size: 372

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetTimeSpanGump.cs

<pre>case 3: // From H
                    {
                        if (h != null)
                        {
                            try
                            {
                                toSet = TimeSpan.FromHours(Utility.ToDouble(h.Text));
                                shouldSet = true;
                                shouldSend = true;

                                break;
                            }
                            catch
                            {
                            }
                        }

                        toSet = TimeSpan.Zero;
                        shouldSet = false;
                        shouldSend = false;

                        break;
                    }
                case 4: // From M
                    {
                        if (m != null)
                        {
                            try
                            {
                                toSet = TimeSpan.FromMinutes(Utility.ToDouble(m.Text));
                                shouldSet = true;
                                shouldSend = true;

                                break;
                            }
                            catch
                            {
                            }
                        }

                        toSet = TimeSpan.Zero;
                        shouldSet = false;
                        shouldSend = false;

                        break;
                    }
                case 5: // From S
                    {
                        if (s != null)
                        {
                            try
                            {
                                toSet = TimeSpan.FromSeconds(Utility.ToDouble(s.Text));
                                shouldSet = true;
                                shouldSend = true;

                                break;
                            }
                            catch
                            {
                            }
                        }

                        toSet = TimeSpan.Zero;
                        shouldSet = false;
                        shouldSend = false;

                        break;
                    }
                default:
                    {
                        toSet = TimeSpan.Zero;
                        shouldSet = false;
                        shouldSend = true;

                        break;
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetTimeSpanGump.cs

<pre>case 3: // From H
				{
					if ( h != null )
					{
						try
						{
							toSet = TimeSpan.FromHours( Utility.ToDouble( h.Text ) );
							shouldSet = true;
							shouldSend = true;

							break;
						}
						catch
						{
						}
					}

					toSet = TimeSpan.Zero;
					shouldSet = false;
					shouldSend = false;

					break;
				}
				case 4: // From M
				{
					if ( m != null )
					{
						try
						{
							toSet = TimeSpan.FromMinutes( Utility.ToDouble( m.Text ) );
							shouldSet = true;
							shouldSend = true;

							break;
						}
						catch
						{
						}
					}

					toSet = TimeSpan.Zero;
					shouldSet = false;
					shouldSend = false;

					break;
				}
				case 5: // From S
				{
					if ( s != null )
					{
						try
						{
							toSet = TimeSpan.FromSeconds( Utility.ToDouble( s.Text ) );
							shouldSet = true;
							shouldSend = true;

							break;
						}
						catch
						{
						}
					}

					toSet = TimeSpan.Zero;
					shouldSet = false;
					shouldSend = false;

					break;
				}
				default:
				{
					toSet = TimeSpan.Zero;
					shouldSet = false;
					shouldSend = true;

					break;
				}</pre>

## Duplicated Code. Size: 372

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Spellbooks\Spellbook.cs

<pre>if (Core.AOS && Parent is Mobile)
			{
				m_AosSkillBonuses.AddTo((Mobile)Parent);
			}

			int strBonus = m_AosAttributes.BonusStr;
			int dexBonus = m_AosAttributes.BonusDex;
			int intBonus = m_AosAttributes.BonusInt;

			if (Parent is Mobile && (strBonus != 0 || dexBonus != 0 || intBonus != 0))
			{
				Mobile m = (Mobile)Parent;

				string modName = Serial.ToString();

				if (strBonus != 0)
				{
					m.AddStatMod(new StatMod(StatType.Str, modName + "Str", strBonus, TimeSpan.Zero));
				}

				if (dexBonus != 0)
				{
					m.AddStatMod(new StatMod(StatType.Dex, modName + "Dex", dexBonus, TimeSpan.Zero));
				}

				if (intBonus != 0)
				{
					m.AddStatMod(new StatMod(StatType.Int, modName + "Int", intBonus, TimeSpan.Zero));
				}
			}

			if (Parent is Mobile)
			{
				((Mobile)Parent).CheckStatTimers();
			}</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if (Core.AOS && Parent is Mobile)
			{
				m_AosSkillBonuses.AddTo((Mobile)Parent);
			}

			int strBonus = m_AosAttributes.BonusStr;
			int dexBonus = m_AosAttributes.BonusDex;
			int intBonus = m_AosAttributes.BonusInt;

			if (Parent is Mobile && (strBonus != 0 || dexBonus != 0 || intBonus != 0))
			{
				Mobile m = (Mobile)Parent;

				string modName = Serial.ToString();

				if (strBonus != 0)
				{
					m.AddStatMod(new StatMod(StatType.Str, modName + "Str", strBonus, TimeSpan.Zero));
				}

				if (dexBonus != 0)
				{
					m.AddStatMod(new StatMod(StatType.Dex, modName + "Dex", dexBonus, TimeSpan.Zero));
				}

				if (intBonus != 0)
				{
					m.AddStatMod(new StatMod(StatType.Int, modName + "Int", intBonus, TimeSpan.Zero));
				}
			}

			if (Parent is Mobile)
			{
				((Mobile)Parent).CheckStatTimers();
			}</pre>

## Duplicated Code. Size: 369

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BlackSolenInfiltratorQueen.cs

<pre>this.SetStr(326, 350);
            this.SetDex(141, 165);
            this.SetInt(96, 120);

            this.SetHits(151, 162);

            this.SetDamage(10, 15);

            this.SetDamageType(ResistanceType.Physical, 70);
            this.SetDamageType(ResistanceType.Poison, 30);

            this.SetResistance(ResistanceType.Physical, 30, 40);
            this.SetResistance(ResistanceType.Fire, 30, 35);
            this.SetResistance(ResistanceType.Cold, 25, 35);
            this.SetResistance(ResistanceType.Poison, 35, 40);
            this.SetResistance(ResistanceType.Energy, 25, 30);

            this.SetSkill(SkillName.MagicResist, 90.0);
            this.SetSkill(SkillName.Tactics, 90.0);
            this.SetSkill(SkillName.Wrestling, 90.0);

            this.Fame = 6500;
            this.Karma = -6500;

            this.VirtualArmor = 50;

            SolenHelper.PackPicnicBasket(this);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RedSolenInfiltratorQueen.cs

<pre>this.SetStr(326, 350);
            this.SetDex(141, 165);
            this.SetInt(96, 120);

            this.SetHits(151, 162);

            this.SetDamage(10, 15);

            this.SetDamageType(ResistanceType.Physical, 70);
            this.SetDamageType(ResistanceType.Poison, 30);

            this.SetResistance(ResistanceType.Physical, 30, 40);
            this.SetResistance(ResistanceType.Fire, 30, 35);
            this.SetResistance(ResistanceType.Cold, 25, 35);
            this.SetResistance(ResistanceType.Poison, 35, 40);
            this.SetResistance(ResistanceType.Energy, 25, 30);

            this.SetSkill(SkillName.MagicResist, 90.0);
            this.SetSkill(SkillName.Tactics, 90.0);
            this.SetSkill(SkillName.Wrestling, 90.0);

            this.Fame = 6500;
            this.Karma = -6500;

            this.VirtualArmor = 50;

            SolenHelper.PackPicnicBasket(this);</pre>

## Duplicated Code. Size: 369

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BlackSolenInfiltratorWarrior.cs

<pre>this.SetStr(206, 230);
            this.SetDex(121, 145);
            this.SetInt(66, 90);

            this.SetHits(96, 107);

            this.SetDamage(5, 15);

            this.SetDamageType(ResistanceType.Physical, 80);
            this.SetDamageType(ResistanceType.Poison, 20);

            this.SetResistance(ResistanceType.Physical, 20, 35);
            this.SetResistance(ResistanceType.Fire, 20, 35);
            this.SetResistance(ResistanceType.Cold, 10, 25);
            this.SetResistance(ResistanceType.Poison, 20, 35);
            this.SetResistance(ResistanceType.Energy, 10, 25);

            this.SetSkill(SkillName.MagicResist, 80.0);
            this.SetSkill(SkillName.Tactics, 80.0);
            this.SetSkill(SkillName.Wrestling, 80.0);

            this.Fame = 3000;
            this.Karma = -3000;

            this.VirtualArmor = 40;

            SolenHelper.PackPicnicBasket(this);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RedSolenInfiltratorWarrior.cs

<pre>this.SetStr(206, 230);
            this.SetDex(121, 145);
            this.SetInt(66, 90);

            this.SetHits(96, 107);

            this.SetDamage(5, 15);

            this.SetDamageType(ResistanceType.Physical, 80);
            this.SetDamageType(ResistanceType.Poison, 20);

            this.SetResistance(ResistanceType.Physical, 20, 35);
            this.SetResistance(ResistanceType.Fire, 20, 35);
            this.SetResistance(ResistanceType.Cold, 10, 25);
            this.SetResistance(ResistanceType.Poison, 20, 35);
            this.SetResistance(ResistanceType.Energy, 10, 25);

            this.SetSkill(SkillName.MagicResist, 80.0);
            this.SetSkill(SkillName.Tactics, 80.0);
            this.SetSkill(SkillName.Wrestling, 80.0);

            this.Fame = 3000;
            this.Karma = -3000;

            this.VirtualArmor = 40;

            SolenHelper.PackPicnicBasket(this);</pre>

## Duplicated Code. Size: 369

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BlackSolenWarrior.cs

<pre>this.SetStr(196, 220);
            this.SetDex(101, 125);
            this.SetInt(36, 60);

            this.SetHits(96, 107);

            this.SetDamage(5, 15);

            this.SetDamageType(ResistanceType.Physical, 80);
            this.SetDamageType(ResistanceType.Poison, 20);

            this.SetResistance(ResistanceType.Physical, 20, 35);
            this.SetResistance(ResistanceType.Fire, 20, 35);
            this.SetResistance(ResistanceType.Cold, 10, 25);
            this.SetResistance(ResistanceType.Poison, 20, 35);
            this.SetResistance(ResistanceType.Energy, 10, 25);

            this.SetSkill(SkillName.MagicResist, 60.0);
            this.SetSkill(SkillName.Tactics, 80.0);
            this.SetSkill(SkillName.Wrestling, 80.0);

            this.Fame = 3000;
            this.Karma = -3000;

            this.VirtualArmor = 35;

            SolenHelper.PackPicnicBasket(this);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RedSolenWarrior.cs

<pre>this.SetStr(196, 220);
            this.SetDex(101, 125);
            this.SetInt(36, 60);

            this.SetHits(96, 107);

            this.SetDamage(5, 15);

            this.SetDamageType(ResistanceType.Physical, 80);
            this.SetDamageType(ResistanceType.Poison, 20);

            this.SetResistance(ResistanceType.Physical, 20, 35);
            this.SetResistance(ResistanceType.Fire, 20, 35);
            this.SetResistance(ResistanceType.Cold, 10, 25);
            this.SetResistance(ResistanceType.Poison, 20, 35);
            this.SetResistance(ResistanceType.Energy, 10, 25);

            this.SetSkill(SkillName.MagicResist, 60.0);
            this.SetSkill(SkillName.Tactics, 80.0);
            this.SetSkill(SkillName.Wrestling, 80.0);

            this.Fame = 3000;
            this.Karma = -3000;

            this.VirtualArmor = 35;

            SolenHelper.PackPicnicBasket(this);</pre>

## Duplicated Code. Size: 368

### Duplicated Fragments:

Fragment 1 in file Server\Items\Container.cs

<pre>var groups = new List<List<Item>>();
			int idx = 0;

			while (idx < typedItems.Length)
			{
				Item a = typedItems[idx++];
				var group = new List<Item>();

				group.Add(a);

				while (idx < typedItems.Length)
				{
					Item b = typedItems[idx];
					int v = grouper(a, b);

					if (v == 0)
					{
						group.Add(b);
					}
					else
					{
						break;
					}

					++idx;
				}

				groups.Add(group);
			}

			for (int j = 0; j < groups.Count; ++j)
			{
				var items = groups[j].ToArray();
				//Item[] items = (Item[])(((ArrayList)groups[j]).ToArray( typeof( Item ) ));
				int total = 0;

				for (int k = 0; k < items.Length; ++k)
				{
					total += items[k].Amount;
				}

				if (total >= best)
				{
					best = total;
				}
			}</pre>

Fragment 2 in file Server\Items\Container.cs

<pre>var groups = new List<List<Item>>();
				int idx = 0;

				while (idx < typedItems.Length)
				{
					Item a = typedItems[idx++];
					var group = new List<Item>();

					group.Add(a);

					while (idx < typedItems.Length)
					{
						Item b = typedItems[idx];
						int v = grouper(a, b);

						if (v == 0)
						{
							group.Add(b);
						}
						else
						{
							break;
						}

						++idx;
					}

					groups.Add(group);
				}

				for (int j = 0; j < groups.Count; ++j)
				{
					var items = groups[j].ToArray();
					//Item[] items = (Item[])(((ArrayList)groups[j]).ToArray( typeof( Item ) ));
					int total = 0;

					for (int k = 0; k < items.Length; ++k)
					{
						total += items[k].Amount;
					}

					if (total >= best)
					{
						best = total;
					}
				}</pre>

## Duplicated Code. Size: 368

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>AddLabel( 20, 40, 0, XmlPoints.GetText(from, 200591));    // "Team"
    			AddLabel( 75, 40, 0, XmlPoints.GetText(from, 200596));    // "Members"
    			AddLabel( 135, 40, 0, XmlPoints.GetText(from, 200597));    // "Active"
    			AddLabel( 185, 40, 0, XmlPoints.GetText(from, 200598));     // "Score"

    			int yoffset = 60;
    			// list all of the teams and their status
    			foreach(TeamInfo t in Teams)
    			{
                    int teamhue = 0;
                    if(t.ID > 0)
                    {
                        teamhue = BaseChallengeGame.TeamColor(t.ID);
                    }
        			AddLabel( 20, yoffset, teamhue, t.ID.ToString());
        			AddLabel( 75, yoffset, teamhue, t.Members.Count.ToString());
        			AddLabel( 135, yoffset, teamhue, t.NActive.ToString());
        			AddLabel( 185, yoffset, teamhue, t.Score.ToString());

        			yoffset += yinc;
    			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>AddLabel( 20, 40, 0, XmlPoints.GetText(from, 200591));    // "Team"
    			AddLabel( 75, 40, 0, XmlPoints.GetText(from, 200596));    // "Members"
    			AddLabel( 135, 40, 0, XmlPoints.GetText(from, 200597));    // "Active"
    			AddLabel( 185, 40, 0, XmlPoints.GetText(from, 200598));     // "Score"

    			int yoffset = 60;
    			// list all of the teams and their status
    			foreach(TeamInfo t in Teams)
    			{
                    int teamhue = 0;
                    if(t.ID > 0)
                    {
                        teamhue = BaseChallengeGame.TeamColor(t.ID);
                    }
        			AddLabel( 20, yoffset, teamhue, t.ID.ToString());
        			AddLabel( 75, yoffset, teamhue, t.Members.Count.ToString());
        			AddLabel( 135, yoffset, teamhue, t.NActive.ToString());
        			AddLabel( 185, yoffset, teamhue, t.Score.ToString());

        			yoffset += yinc;
    			}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>AddLabel( 20, 40, 0, XmlPoints.GetText(from, 200591));    // "Team"
    			AddLabel( 75, 40, 0, XmlPoints.GetText(from, 200596));    // "Members"
    			AddLabel( 135, 40, 0, XmlPoints.GetText(from, 200597));    // "Active"
    			AddLabel( 185, 40, 0, XmlPoints.GetText(from, 200598));     // "Score"

    			int yoffset = 60;
    			// list all of the teams and their status
    			foreach(TeamInfo t in Teams)
    			{
                    int teamhue = 0;
                    if(t.ID > 0)
                    {
                        teamhue = BaseChallengeGame.TeamColor(t.ID);
                    }
        			AddLabel( 20, yoffset, teamhue, t.ID.ToString());
        			AddLabel( 75, yoffset, teamhue, t.Members.Count.ToString());
        			AddLabel( 135, yoffset, teamhue, t.NActive.ToString());
        			AddLabel( 185, yoffset, teamhue, t.Score.ToString());

        			yoffset += yinc;
    			}</pre>

## Duplicated Code. Size: 367

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Seventh\ChainLightning.cs

<pre>SpellHelper.Turn(this.Caster, p);

                if (p is Item)
                    p = ((Item)p).GetWorldLocation();

                List<IDamageable> targets = new List<IDamageable>();

                Map map = this.Caster.Map;

                if (map != null)
                {
                    IPooledEnumerable eable = map.GetObjectsInRange(new Point3D(p), 2);

                    foreach (object o in eable)
                    {
                        IDamageable id = o as IDamageable;

                        if (id == null || (Core.AOS && id is Mobile && (Mobile)id == this.Caster))
                            continue;

                        if ((!(id is Mobile) || SpellHelper.ValidIndirectTarget(this.Caster, id as Mobile)) && this.Caster.CanBeHarmful(id, false))
                        {
                            if (Core.AOS && !this.Caster.InLOS(id))
                                continue;

                            targets.Add(id);
                        }
                    }

                    eable.Free();
                }

                double damage;</pre>

Fragment 2 in file Scripts\Spells\Seventh\MeteorSwarm.cs

<pre>SpellHelper.Turn(this.Caster, p);

                if (p is Item)
                    p = ((Item)p).GetWorldLocation();

                List<IDamageable> targets = new List<IDamageable>();

                Map map = this.Caster.Map;

                if (map != null)
                {
                    IPooledEnumerable eable = map.GetObjectsInRange(new Point3D(p), 2);

                    foreach (object o in eable)
                    {
                        IDamageable id = o as IDamageable;

                        if (id == null || (Core.AOS && id is Mobile && (Mobile)id == this.Caster))
                            continue;

                        if ((!(id is Mobile) || SpellHelper.ValidIndirectTarget(this.Caster, id as Mobile)) && this.Caster.CanBeHarmful(id, false))
                        {
                            if (Core.AOS && !this.Caster.InLOS(id))
                                continue;

                            targets.Add(id);
                        }
                    }

                    eable.Free();
                }

                double damage;</pre>

## Duplicated Code. Size: 366

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\ArcherGuard.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
		public override Mobile Focus
		{
			get { return m_Focus; }
			set
			{
				if (Deleted)
				{
					return;
				}

				Mobile oldFocus = m_Focus;

				if (oldFocus != value)
				{
					m_Focus = value;

					if (value != null)
					{
						AggressiveAction(value);
					}

					Combatant = value;

					if (oldFocus != null && !oldFocus.Alive)
					{
						Say("Thou hast suffered thy punishment, scoundrel.");
					}

					if (value != null)
					{
						Say(500131); // Thou wilt regret thine actions, swine!
					}

					if (m_AttackTimer != null)
					{
						m_AttackTimer.Stop();
						m_AttackTimer = null;
					}

					if (m_IdleTimer != null)
					{
						m_IdleTimer.Stop();
						m_IdleTimer = null;
					}

					if (m_Focus != null)
					{
						m_AttackTimer = new AttackTimer(this);
						m_AttackTimer.Start();
						((AttackTimer)m_AttackTimer).DoOnTick();
					}
					else
					{
						m_IdleTimer = new IdleTimer(this);
						m_IdleTimer.Start();
					}
				}
				else if (m_Focus == null && m_IdleTimer == null)
				{
					m_IdleTimer = new IdleTimer(this);
					m_IdleTimer.Start();
				}
			}
		}</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\WarriorGuard.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
		public override Mobile Focus
		{
			get { return m_Focus; }
			set
			{
				if (Deleted)
				{
					return;
				}

				Mobile oldFocus = m_Focus;

				if (oldFocus != value)
				{
					m_Focus = value;

					if (value != null)
					{
						AggressiveAction(value);
					}

					Combatant = value;

					if (oldFocus != null && !oldFocus.Alive)
					{
						Say("Thou hast suffered thy punishment, scoundrel.");
					}

					if (value != null)
					{
						Say(500131); // Thou wilt regret thine actions, swine!
					}

					if (m_AttackTimer != null)
					{
						m_AttackTimer.Stop();
						m_AttackTimer = null;
					}

					if (m_IdleTimer != null)
					{
						m_IdleTimer.Stop();
						m_IdleTimer = null;
					}

					if (m_Focus != null)
					{
						m_AttackTimer = new AttackTimer(this);
						m_AttackTimer.Start();
						((AttackTimer)m_AttackTimer).DoOnTick();
					}
					else
					{
						m_IdleTimer = new IdleTimer(this);
						m_IdleTimer.Start();
					}
				}
				else if (m_Focus == null && m_IdleTimer == null)
				{
					m_IdleTimer = new IdleTimer(this);
					m_IdleTimer.Start();
				}
			}
		}</pre>

## Duplicated Code. Size: 365

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\SkullRug.cs

<pre>public override void OnComponentUsed(AddonComponent component, Mobile from)
        {
            if (m_NextUse < DateTime.UtcNow)
            {
                Container cont = from.Backpack;
                Map facet;
                int level = Utility.RandomMinMax(1, 4);

                switch (Utility.Random(6))
                {
                    default:
                    case 0: facet = Map.Trammel; break;
                    case 1: facet = Map.Ilshenar; break;
                    case 2: facet = Map.Malas; break;
                    case 3: facet = Map.Felucca; break;
                    case 4: facet = Map.Tokuno; break;
                    case 5: facet = Map.TerMur; break;
                }

                TreasureMap map = new TreasureMap(level, facet);

                if (cont == null || !cont.TryDropItem(from, map, false))
                {
                    from.BankBox.DropItem(map);
                    from.SendLocalizedMessage(1072224); // An item has been placed in your bank box.
                }
                else
                    from.SendLocalizedMessage(1072223); // An item has been placed in your backpack.

                m_NextUse = DateTime.UtcNow + TimeSpan.FromDays(7);
            }
        }</pre>

Fragment 2 in file Scripts\Items\Addons\SkullRug.cs

<pre>public override void OnComponentUsed(AddonComponent component, Mobile from)
        {
            if (m_NextUse < DateTime.UtcNow)
            {
                Container cont = from.Backpack;
                Map facet;
                int level = Utility.RandomMinMax(1, 4);

                switch (Utility.Random(6))
                {
                    default:
                    case 0: facet = Map.Trammel; break;
                    case 1: facet = Map.Ilshenar; break;
                    case 2: facet = Map.Malas; break;
                    case 3: facet = Map.Felucca; break;
                    case 4: facet = Map.Tokuno; break;
                    case 5: facet = Map.TerMur; break;
                }

                TreasureMap map = new TreasureMap(level, facet);

                if (cont == null || !cont.TryDropItem(from, map, false))
                {
                    from.BankBox.DropItem(map);
                    from.SendLocalizedMessage(1072224); // An item has been placed in your bank box.
                }
                else
                    from.SendLocalizedMessage(1072223); // An item has been placed in your backpack.

                m_NextUse = DateTime.UtcNow + TimeSpan.FromDays(7);
            }
        }</pre>

## Duplicated Code. Size: 365

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>public override void InitOutfit()
        {
            if (this.Female)
                this.AddItem(new PlainDress());
            else
                this.AddItem(new Shirt(this.GetRandomHue()));

            int lowHue = this.GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new Boots(lowHue));
            else
                this.AddItem(new Shoes(lowHue));

            switch ( Utility.Random(4) )
            {
                case 0:
                    this.AddItem(new ShortHair(Utility.RandomHairHue()));
                    break;
                case 1:
                    this.AddItem(new TwoPigTails(Utility.RandomHairHue()));
                    break;
                case 2:
                    this.AddItem(new ReceedingHair(Utility.RandomHairHue()));
                    break;
                case 3:
                    this.AddItem(new KrisnaHair(Utility.RandomHairHue()));
                    break;
            }

            this.PackGold(200, 250);
        }</pre>

Fragment 2 in file Scripts\Quests\Escortables.cs

<pre>public override void InitOutfit()
        {
            if (this.Female)
                this.AddItem(new PlainDress());
            else
                this.AddItem(new Shirt(this.GetRandomHue()));

            int lowHue = this.GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new Boots(lowHue));
            else
                this.AddItem(new Shoes(lowHue));

            switch ( Utility.Random(4) )
            {
                case 0:
                    this.AddItem(new ShortHair(Utility.RandomHairHue()));
                    break;
                case 1:
                    this.AddItem(new TwoPigTails(Utility.RandomHairHue()));
                    break;
                case 2:
                    this.AddItem(new ReceedingHair(Utility.RandomHairHue()));
                    break;
                case 3:
                    this.AddItem(new KrisnaHair(Utility.RandomHairHue()));
                    break;
            }

            this.PackGold(200, 250);
        }</pre>

## Duplicated Code. Size: 364

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Ethics\Evil\Mobiles\UnholySteed.cs

<pre>this.SetStr(496, 525);
            this.SetDex(86, 105);
            this.SetInt(86, 125);

            this.SetHits(298, 315);

            this.SetDamage(16, 22);

            this.SetDamageType(ResistanceType.Physical, 40);
            this.SetDamageType(ResistanceType.Fire, 40);
            this.SetDamageType(ResistanceType.Energy, 20);

            this.SetResistance(ResistanceType.Physical, 55, 65);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 20, 30);

            this.SetSkill(SkillName.MagicResist, 25.1, 30.0);
            this.SetSkill(SkillName.Tactics, 97.6, 100.0);
            this.SetSkill(SkillName.Wrestling, 80.5, 92.5);

            this.Fame = 14000;</pre>

Fragment 2 in file Scripts\Services\Ethics\Hero\Mobiles\HolySteed.cs

<pre>this.SetStr(496, 525);
            this.SetDex(86, 105);
            this.SetInt(86, 125);

            this.SetHits(298, 315);

            this.SetDamage(16, 22);

            this.SetDamageType(ResistanceType.Physical, 40);
            this.SetDamageType(ResistanceType.Fire, 40);
            this.SetDamageType(ResistanceType.Energy, 20);

            this.SetResistance(ResistanceType.Physical, 55, 65);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 20, 30);

            this.SetSkill(SkillName.MagicResist, 25.1, 30.0);
            this.SetSkill(SkillName.Tactics, 97.6, 100.0);
            this.SetSkill(SkillName.Wrestling, 80.5, 92.5);

            this.Fame = 14000;</pre>

## Duplicated Code. Size: 363

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Reports\Rendering\BarGraphRenderer.cs

<pre>float startY = itemY - 2f - valFont.Height;					  // Positioned on top of each bar by 2 pixels
                                        RectangleF recVal = new RectangleF(startX - ((sectionWidth * this._interval) / 2), startY, sectionWidth * this._interval, valFont.Height);
                                        SizeF sz = graph.MeasureString(item.Value.ToString("#,###.##"), valFont, recVal.Size, sfFormat);
                                        //using ( SolidBrush brsh = new SolidBrush( Color.FromArgb( 180, 255, 255, 255 ) ) )
                                        //	graph.FillRectangle( brsh, new RectangleF(recVal.X+((recVal.Width-sz.Width)/2),recVal.Y+((recVal.Height-sz.Height)/2),sz.Width+4,sz.Height) );

                                        //graph.DrawString(item.Value.ToString("#,###.##"), valFont, brsFont, recVal, sfFormat);

                                        for (int box = -1; box <= 1; ++box)
                                        {
                                            for (int boy = -1; boy <= 1; ++boy)
                                            {
                                                if (box == 0 && boy == 0)
                                                    continue;

                                                RectangleF rco = new RectangleF(recVal.X + box, recVal.Y + boy, recVal.Width, recVal.Height);
                                                graph.DrawString(item.Value.ToString("#,###.##"), valFont, whiteBrsh, rco, sfFormat);
                                            }
                                        }

                                        graph.DrawString(item.Value.ToString("#,###.##"), valFont, brsFont, recVal, sfFormat);</pre>

Fragment 2 in file Scripts\Services\Reports\Rendering\BarGraphRenderer.cs

<pre>float startY = itemY - 2f - valFont.Height;					  // Positioned on top of each bar by 2 pixels
                                        RectangleF recVal = new RectangleF(startX - ((sectionWidth * this._interval) / 2), startY, sectionWidth * this._interval, valFont.Height);
                                        SizeF sz = graph.MeasureString(item.Value.ToString("#,###.##"), valFont, recVal.Size, sfFormat);
                                        //using ( SolidBrush brsh = new SolidBrush( Color.FromArgb( 48, 255, 255, 255 ) ) )
                                        //	graph.FillRectangle( brsh, new RectangleF(recVal.X+((recVal.Width-sz.Width)/2),recVal.Y+((recVal.Height-sz.Height)/2),sz.Width+4,sz.Height) );

                                        for (int box = -1; box <= 1; ++box)
                                        {
                                            for (int boy = -1; boy <= 1; ++boy)
                                            {
                                                if (box == 0 && boy == 0)
                                                    continue;

                                                RectangleF rco = new RectangleF(recVal.X + box, recVal.Y + boy, recVal.Width, recVal.Height);
                                                graph.DrawString(item.Value.ToString("#,###.##"), valFont, whiteBrsh, rco, sfFormat);
                                            }
                                        }

                                        graph.DrawString(item.Value.ToString("#,###.##"), valFont, brsFont, recVal, sfFormat);</pre>

## Duplicated Code. Size: 361

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Dragon.cs

<pre>this.SetStr(796, 825);
            this.SetDex(86, 105);
            this.SetInt(436, 475);

            this.SetHits(478, 495);

            this.SetDamage(16, 22);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 55, 65);
            this.SetResistance(ResistanceType.Fire, 60, 70);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 25, 35);
            this.SetResistance(ResistanceType.Energy, 35, 45);

            this.SetSkill(SkillName.EvalInt, 30.1, 40.0);
            this.SetSkill(SkillName.Magery, 30.1, 40.0);
            this.SetSkill(SkillName.MagicResist, 99.1, 100.0);
            this.SetSkill(SkillName.Tactics, 97.6, 100.0);
            this.SetSkill(SkillName.Wrestling, 90.1, 92.5);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\StoneMonster.cs

<pre>this.SetStr(796, 825);
                this.SetDex(86, 105);
                this.SetInt(436, 475);

                this.SetHits(478, 495);

                this.SetDamage(16, 22);

                this.SetDamageType(ResistanceType.Physical, 100);

                this.SetResistance(ResistanceType.Physical, 55, 65);
                this.SetResistance(ResistanceType.Fire, 60, 70);
                this.SetResistance(ResistanceType.Cold, 30, 40);
                this.SetResistance(ResistanceType.Poison, 25, 35);
                this.SetResistance(ResistanceType.Energy, 35, 45);

                this.SetSkill(SkillName.EvalInt, 30.1, 40.0);
                this.SetSkill(SkillName.Magery, 30.1, 40.0);
                this.SetSkill(SkillName.MagicResist, 99.1, 100.0);
                this.SetSkill(SkillName.Tactics, 97.6, 100.0);
                this.SetSkill(SkillName.Wrestling, 90.1, 92.5);</pre>

## Duplicated Code. Size: 360

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Serado.cs

<pre>foreach (Mobile m in target.GetMobilesInRange(8))
                {
                    if (m == this || !this.CanBeHarmful(m))
                        continue;

                    if (m is BaseCreature && (((BaseCreature)m).Controlled || ((BaseCreature)m).Summoned || ((BaseCreature)m).Team != this.Team))
                        targets.Add(m);
                    else if (m.Player)
                        targets.Add(m);
                }

                for (int i = 0; i < targets.Count; ++i)
                {
                    Mobile m = (Mobile)targets[i];

                    this.DoHarmful(m);

                    AOS.Damage(m, this, Utility.RandomMinMax(20, 25), true, 0, 0, 0, 100, 0);

                    m.FixedParticles(0x36BD, 1, 10, 0x1F78, 0xA6, 0, (EffectLayer)255);
                    m.ApplyPoison(this, Poison.Lethal);
                }</pre>

Fragment 2 in file Scripts\Mobiles\Named\Putrefier.cs

<pre>foreach (Mobile m in target.GetMobilesInRange(8))
                {
                    if (m == this || !this.CanBeHarmful(m))
                        continue;

                    if (m is BaseCreature && (((BaseCreature)m).Controlled || ((BaseCreature)m).Summoned || ((BaseCreature)m).Team != this.Team))
                        targets.Add(m);
                    else if (m.Player)
                        targets.Add(m);
                }

                for (int i = 0; i < targets.Count; ++i)
                {
                    Mobile m = (Mobile)targets[i];

                    this.DoHarmful(m);

                    AOS.Damage(m, this, Utility.RandomMinMax(20, 25), true, 0, 0, 0, 100, 0);

                    m.FixedParticles(0x36BD, 1, 10, 0x1F78, 0xA6, 0, (EffectLayer)255);
                    m.ApplyPoison(this, Poison.Lethal);
                }</pre>

## Duplicated Code. Size: 360

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\DuelContext.cs

<pre>dc.RejectReady(pm, null);
                            dc.m_Yielding = false;

                            if (init == pm)
                            {
                                dc.Unregister();
                            }
                            else if (dc.m_Registered)
                            {
                                p.Nullify(pl);
                                pm.DuelPlayer = null;

                                NetState ns = init.NetState;

                                if (ns != null)
                                {
                                    bool send = true;

                                    foreach (Gump g in ns.Gumps)
                                    {
                                        if (g is ParticipantGump)
                                        {
                                            ParticipantGump pg = (ParticipantGump)g;

                                            if (pg.Participant == p)
                                            {
                                                init.SendGump(new ParticipantGump(init, dc, p));
                                                send = false;
                                                break;
                                            }
                                        }
                                        else if (g is DuelContextGump)
                                        {
                                            DuelContextGump dcg = (DuelContextGump)g;

                                            if (dcg.Context == dc)
                                            {
                                                init.SendGump(new DuelContextGump(init, dc));
                                                send = false;
                                                break;
                                            }
                                        }
                                    }

                                    if (send)
                                        init.SendGump(new DuelContextGump(init, dc));
                                }
                            }</pre>

Fragment 2 in file Scripts\Services\ConPVP\DuelContext.cs

<pre>dc.RejectReady(pm, null);
                            dc.m_Yielding = false;

                            if (init == pm)
                            {
                                dc.Unregister();
                            }
                            else if (dc.m_Registered)
                            {
                                p.Nullify(pl);
                                pm.DuelPlayer = null;

                                NetState ns = init.NetState;

                                if (ns != null)
                                {
                                    bool send = true;

                                    foreach (Gump g in ns.Gumps)
                                    {
                                        if (g is ParticipantGump)
                                        {
                                            ParticipantGump pg = (ParticipantGump)g;

                                            if (pg.Participant == p)
                                            {
                                                init.SendGump(new ParticipantGump(init, dc, p));
                                                send = false;
                                                break;
                                            }
                                        }
                                        else if (g is DuelContextGump)
                                        {
                                            DuelContextGump dcg = (DuelContextGump)g;

                                            if (dcg.Context == dc)
                                            {
                                                init.SendGump(new DuelContextGump(init, dc));
                                                send = false;
                                                break;
                                            }
                                        }
                                    }

                                    if (send)
                                        init.SendGump(new DuelContextGump(init, dc));
                                }
                            }</pre>

## Duplicated Code. Size: 359

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>if (GetSaveFlag(flags, SaveFlag.Layer))
                        {
                            m_Layer = (Layer)reader.ReadByte();
                        }

                        if (GetSaveFlag(flags, SaveFlag.Name))
                        {
                            string name = reader.ReadString();

                            if (name != DefaultName)
                            {
                                AcquireCompactInfo().m_Name = name;
                            }
                        }

                        if (GetSaveFlag(flags, SaveFlag.Parent))
                        {
                            Serial parent = reader.ReadInt();

                            if (parent.IsMobile)
                            {
                                m_Parent = World.FindMobile(parent);
                            }
                            else if (parent.IsItem)
                            {
                                m_Parent = World.FindItem(parent);
                            }
                            else
                            {
                                m_Parent = null;
                            }

                            if (m_Parent == null && (parent.IsMobile || parent.IsItem))
                            {
                                Delete();
                            }
                        }

                        if (GetSaveFlag(flags, SaveFlag.Items))
                        {
                            var items = reader.ReadStrongItemList();

                            if (this is Container)
                            {
                                (this as Container).m_Items = items;
                            }
                            else
                            {
                                AcquireCompactInfo().m_Items = items;
                            }
                        }</pre>

Fragment 2 in file Server\Item.cs

<pre>if (GetSaveFlag(flags, SaveFlag.Layer))
                        {
                            m_Layer = (Layer)reader.ReadByte();
                        }

                        if (GetSaveFlag(flags, SaveFlag.Name))
                        {
                            string name = reader.ReadString();

                            if (name != DefaultName)
                            {
                                AcquireCompactInfo().m_Name = name;
                            }
                        }

                        if (GetSaveFlag(flags, SaveFlag.Parent))
                        {
                            Serial parent = reader.ReadInt();

                            if (parent.IsMobile)
                            {
                                m_Parent = World.FindMobile(parent);
                            }
                            else if (parent.IsItem)
                            {
                                m_Parent = World.FindItem(parent);
                            }
                            else
                            {
                                m_Parent = null;
                            }

                            if (m_Parent == null && (parent.IsMobile || parent.IsItem))
                            {
                                Delete();
                            }
                        }

                        if (GetSaveFlag(flags, SaveFlag.Items))
                        {
                            var items = reader.ReadStrongItemList();

                            if (this is Container)
                            {
                                (this as Container).m_Items = items;
                            }
                            else
                            {
                                AcquireCompactInfo().m_Items = items;
                            }
                        }</pre>

## Duplicated Code. Size: 358

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Reports\Rendering\HtmlRenderer.cs

<pre>html.RenderEndTag();

            html.Write(" -->");

            html.AddAttribute(HtmlAttr.Cellpadding, "0");
            html.AddAttribute(HtmlAttr.Cellspacing, "0");
            html.AddAttribute(HtmlAttr.Border, "0");
            html.RenderBeginTag(HtmlTag.Table);

            html.RenderBeginTag(HtmlTag.Tr);
            html.AddAttribute(HtmlAttr.Class, "tbl-border");
            html.RenderBeginTag(HtmlTag.Td);

            html.AddAttribute(HtmlAttr.Width, "100%");
            html.AddAttribute(HtmlAttr.Cellpadding, "4");
            html.AddAttribute(HtmlAttr.Cellspacing, "1");
            html.RenderBeginTag(HtmlTag.Table);

            html.RenderBeginTag(HtmlTag.Tr);

            html.AddAttribute(HtmlAttr.Colspan, "10");
            html.AddAttribute(HtmlAttr.Width, "100%");
            html.AddAttribute(HtmlAttr.Align, "center");
            html.AddAttribute(HtmlAttr.Class, "header");
            html.RenderBeginTag(HtmlTag.Td);</pre>

Fragment 2 in file Scripts\Services\Reports\Rendering\HtmlRenderer.cs

<pre>html.RenderEndTag();

            html.Write(" -->");

            html.AddAttribute(HtmlAttr.Cellpadding, "0");
            html.AddAttribute(HtmlAttr.Cellspacing, "0");
            html.AddAttribute(HtmlAttr.Border, "0");
            html.RenderBeginTag(HtmlTag.Table);

            html.RenderBeginTag(HtmlTag.Tr);
            html.AddAttribute(HtmlAttr.Class, "tbl-border");
            html.RenderBeginTag(HtmlTag.Td);

            html.AddAttribute(HtmlAttr.Width, "100%");
            html.AddAttribute(HtmlAttr.Cellpadding, "4");
            html.AddAttribute(HtmlAttr.Cellspacing, "1");
            html.RenderBeginTag(HtmlTag.Table);

            html.RenderBeginTag(HtmlTag.Tr);

            html.AddAttribute(HtmlAttr.Colspan, "10");
            html.AddAttribute(HtmlAttr.Width, "100%");
            html.AddAttribute(HtmlAttr.Align, "center");
            html.AddAttribute(HtmlAttr.Class, "header");
            html.RenderBeginTag(HtmlTag.Td);</pre>

## Duplicated Code. Size: 358

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>ThirdPartyFeature disabled = FeatureProtection.DisabledFeatures;

			if (disabled != 0)
			{
				if (m_MD5Provider == null)
				{
					m_MD5Provider = new MD5CryptoServiceProvider();
				}

				m_Stream.UnderlyingStream.Flush();

				var hashCode = m_MD5Provider.ComputeHash(
					m_Stream.UnderlyingStream.GetBuffer(), 0, (int)m_Stream.UnderlyingStream.Length);
				var buffer = new byte[28];

				for (int i = 0; i < count; ++i)
				{
					Utility.RandomBytes(buffer);

					m_Stream.Seek(35 + (i * 60), SeekOrigin.Begin);
					m_Stream.Write(buffer, 0, buffer.Length);
				}

				m_Stream.Seek(35, SeekOrigin.Begin);
				m_Stream.Write((int)((long)disabled >> 32));
				m_Stream.Write((int)disabled);

				m_Stream.Seek(95, SeekOrigin.Begin);
				m_Stream.Write(hashCode, 0, hashCode.Length);
			}</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>ThirdPartyFeature disabled = FeatureProtection.DisabledFeatures;

			if (disabled != 0)
			{
				if (m_MD5Provider == null)
				{
					m_MD5Provider = new MD5CryptoServiceProvider();
				}

				m_Stream.UnderlyingStream.Flush();

				var hashCode = m_MD5Provider.ComputeHash(
					m_Stream.UnderlyingStream.GetBuffer(), 0, (int)m_Stream.UnderlyingStream.Length);
				var buffer = new byte[28];

				for (int i = 0; i < count; ++i)
				{
					Utility.RandomBytes(buffer);

					m_Stream.Seek(35 + (i * 60), SeekOrigin.Begin);
					m_Stream.Write(buffer, 0, buffer.Length);
				}

				m_Stream.Seek(35, SeekOrigin.Begin);
				m_Stream.Write((int)((long)disabled >> 32));
				m_Stream.Write((int)disabled);

				m_Stream.Seek(95, SeekOrigin.Begin);
				m_Stream.Write(hashCode, 0, hashCode.Length);
			}</pre>

## Duplicated Code. Size: 357

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Factions\BaseWarHorse.cs

<pre>this.SetStr(400);
            this.SetDex(125);
            this.SetInt(51, 55);

            this.SetHits(240);
            this.SetMana(0);

            this.SetDamage(5, 8);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 40, 50);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);

            this.SetSkill(SkillName.MagicResist, 25.1, 30.0);
            this.SetSkill(SkillName.Tactics, 29.3, 44.0);
            this.SetSkill(SkillName.Wrestling, 29.3, 44.0);

            this.Fame = 300;
            this.Karma = 300;

            this.Tamable = true;
            this.ControlSlots = 1;</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\FactionWarHorse.cs

<pre>this.SetStr(400);
            this.SetDex(125);
            this.SetInt(51, 55);

            this.SetHits(240);
            this.SetMana(0);

            this.SetDamage(5, 8);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 40, 50);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);

            this.SetSkill(SkillName.MagicResist, 25.1, 30.0);
            this.SetSkill(SkillName.Tactics, 29.3, 44.0);
            this.SetSkill(SkillName.Wrestling, 29.3, 44.0);

            this.Fame = 300;
            this.Karma = 300;

            this.Tamable = true;
            this.ControlSlots = 1;</pre>

## Duplicated Code. Size: 357

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>if (string.Compare(XmlMapName, Map.Trammel.Name, true) == 0 || XmlMapName == "Trammel")
							{
								SpawnMap = Map.Trammel;
								TrammelCount++;
							}
							else if (string.Compare(XmlMapName, Map.Felucca.Name, true) == 0 || XmlMapName == "Felucca")
							{
								SpawnMap = Map.Felucca;
								FeluccaCount++;
							}
							else if (string.Compare(XmlMapName, Map.Ilshenar.Name, true) == 0 || XmlMapName == "Ilshenar")
							{
								SpawnMap = Map.Ilshenar;
								IlshenarCount++;
							}
                            else if (string.Compare(XmlMapName, Map.Malas.Name, true) == 0 || XmlMapName == "Malas")
							{
                                SpawnMap = Map.Malas;
                                MalasCount++;
							}
                            else if (string.Compare(XmlMapName, Map.Tokuno.Name, true) == 0 || XmlMapName == "Tokuno")
							{
                                SpawnMap = Map.Tokuno;
                                TokunoCount++;
							}
							else
							{
								try
								{
									SpawnMap = Map.Parse(XmlMapName);
								}
								catch { }
								OtherCount++;
							}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>if (string.Compare(XmlMapName, Map.Trammel.Name, true) == 0 || XmlMapName == "Trammel")
								{
									SpawnMap = Map.Trammel;
									TrammelCount++;
								}
								else if (string.Compare(XmlMapName, Map.Felucca.Name, true) == 0 || XmlMapName == "Felucca")
								{
									SpawnMap = Map.Felucca;
									FeluccaCount++;
								}
								else if (string.Compare(XmlMapName, Map.Ilshenar.Name, true) == 0 || XmlMapName == "Ilshenar")
								{
									SpawnMap = Map.Ilshenar;
									IlshenarCount++;
								}
                                else if (string.Compare(XmlMapName, Map.Malas.Name, true) == 0 || XmlMapName == "Malas")
								{
                                    SpawnMap = Map.Malas;
                                    MalasCount++;
								}
                                else if (string.Compare(XmlMapName, Map.Tokuno.Name, true) == 0 || XmlMapName == "Tokuno")
								{
                                    SpawnMap = Map.Tokuno;
                                    TokunoCount++;
								}
								else
								{
									try
									{
										SpawnMap = Map.Parse(XmlMapName);
									}
									catch { }
									OtherCount++;
								}</pre>

## Duplicated Code. Size: 356

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Beheld = beheld;

			int m_Version = ++(m_VersionTL.Value);
			var m_DupedLayers = m_DupedLayersTL.Value;

			var eq = beheld.Items;
			int count = eq.Count;

			if (beheld.HairItemID > 0)
			{
				count++;
			}
			if (beheld.FacialHairItemID > 0)
			{
				count++;
			}

			EnsureCapacity(23 + (count * 9));

			int hue = beheld.Hue;

			if (beheld.SolidHueOverride >= 0)
			{
				hue = beheld.SolidHueOverride;
			}

			m_Stream.Write(beheld.Serial);
			m_Stream.Write((short)beheld.Body);
			m_Stream.Write((short)beheld.X);
			m_Stream.Write((short)beheld.Y);
			m_Stream.Write((sbyte)beheld.Z);
			m_Stream.Write((byte)beheld.Direction);
			m_Stream.Write((short)hue);
			m_Stream.Write((byte)beheld.GetPacketFlags());</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Beheld = beheld;

			int m_Version = ++(m_VersionTL.Value);
			var m_DupedLayers = m_DupedLayersTL.Value;

			var eq = beheld.Items;
			int count = eq.Count;

			if (beheld.HairItemID > 0)
			{
				count++;
			}
			if (beheld.FacialHairItemID > 0)
			{
				count++;
			}

			EnsureCapacity(23 + (count * 9));

			int hue = beheld.Hue;

			if (beheld.SolidHueOverride >= 0)
			{
				hue = beheld.SolidHueOverride;
			}

			m_Stream.Write(beheld.Serial);
			m_Stream.Write((short)beheld.Body);
			m_Stream.Write((short)beheld.X);
			m_Stream.Write((short)beheld.Y);
			m_Stream.Write((sbyte)beheld.Z);
			m_Stream.Write((byte)beheld.Direction);
			m_Stream.Write((short)hue);
			m_Stream.Write((byte)beheld.GetPacketFlags());</pre>

## Duplicated Code. Size: 354

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\Abilities.cs

<pre>switch (d)
            {
                case (Direction)0x0:
                case (Direction)0x80:
                    point.Y--;
                    break; //North
                case (Direction)0x1:
                case (Direction)0x81:
                    {
                        point.X++;
                        point.Y--;
                        break;
                    }//Right
                case (Direction)0x2:
                case (Direction)0x82:
                    point.X++;
                    break; //East
                case (Direction)0x3:
                case (Direction)0x83:
                    {
                        point.X++;
                        point.Y++;
                        break;
                    }//Down
                case (Direction)0x4:
                case (Direction)0x84:
                    point.Y++;
                    break; //South
                case (Direction)0x5:
                case (Direction)0x85:
                    {
                        point.X--;
                        point.Y++;
                        break;
                    }//Left
                case (Direction)0x6:
                case (Direction)0x86:
                    point.X--;
                    break; //West
                case (Direction)0x7:
                case (Direction)0x87:
                    {
                        point.X--;
                        point.Y--;
                        break;
                    }//Up
                default:
                    {
                        break;
                    }
            }</pre>

Fragment 2 in file Scripts\Spells\Mysticism\SpellDefinitions\BombardSpell.cs

<pre>switch( d )
					{
						case (Direction)0x0: case (Direction)0x80: point.Y--; break; //North
						case (Direction)0x1: case (Direction)0x81: { point.X++; point.Y--; break; } //Right
						case (Direction)0x2: case (Direction)0x82: point.X++; break; //East
						case (Direction)0x3: case (Direction)0x83: { point.X++; point.Y++; break; } //Down
						case (Direction)0x4: case (Direction)0x84: point.Y++; break; //South
						case (Direction)0x5: case (Direction)0x85: { point.X--; point.Y++; break; } //Left
						case (Direction)0x6: case (Direction)0x86: point.X--; break; //West
						case (Direction)0x7: case (Direction)0x87: { point.X--; point.Y--; break; } //Up
						default: { break; }
					}</pre>

## Duplicated Code. Size: 354

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\AbysmalHorror.cs

<pre>this.SetDamage(13, 17);

            this.SetDamageType(ResistanceType.Physical, 50);
            this.SetDamageType(ResistanceType.Poison, 50);

            this.SetResistance(ResistanceType.Physical, 30, 35);
            this.SetResistance(ResistanceType.Fire, 100);
            this.SetResistance(ResistanceType.Cold, 50, 55);
            this.SetResistance(ResistanceType.Poison, 60, 65);
            this.SetResistance(ResistanceType.Energy, 77, 80);

            this.SetSkill(SkillName.EvalInt, 200.0);
            this.SetSkill(SkillName.Magery, 112.6, 117.5);
            this.SetSkill(SkillName.Meditation, 200.0);
            this.SetSkill(SkillName.MagicResist, 117.6, 120.0);
            this.SetSkill(SkillName.Tactics, 100.0);
            this.SetSkill(SkillName.Wrestling, 84.1, 88.0);

            this.Fame = 26000;
            this.Karma = -26000;

            this.VirtualArmor = 54;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\AbyssalAbomination.cs

<pre>this.SetDamage(13, 17);

            this.SetDamageType(ResistanceType.Physical, 50);
            this.SetDamageType(ResistanceType.Poison, 50);

            this.SetResistance(ResistanceType.Physical, 30, 35);
            this.SetResistance(ResistanceType.Fire, 100);
            this.SetResistance(ResistanceType.Cold, 50, 55);
            this.SetResistance(ResistanceType.Poison, 60, 65);
            this.SetResistance(ResistanceType.Energy, 77, 80);

            this.SetSkill(SkillName.EvalInt, 200.0);
            this.SetSkill(SkillName.Magery, 112.6, 117.5);
            this.SetSkill(SkillName.Meditation, 200.0);
            this.SetSkill(SkillName.MagicResist, 117.6, 120.0);
            this.SetSkill(SkillName.Tactics, 100.0);
            this.SetSkill(SkillName.Wrestling, 84.1, 88.0);

            this.Fame = 26000;
            this.Karma = -26000;

            this.VirtualArmor = 54;</pre>

## Duplicated Code. Size: 353

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\StoneMonster.cs

<pre>this.SetStr(126, 150);
                this.SetDex(76, 100);
                this.SetInt(86, 110);

                this.SetHits(76, 90);

                this.SetDamage(10, 14);

                this.SetDamageType(ResistanceType.Physical, 20);
                this.SetDamageType(ResistanceType.Cold, 60);
                this.SetDamageType(ResistanceType.Poison, 20);

                this.SetResistance(ResistanceType.Physical, 50, 60);
                this.SetResistance(ResistanceType.Fire, 25, 30);
                this.SetResistance(ResistanceType.Cold, 70, 80);
                this.SetResistance(ResistanceType.Poison, 30, 40);
                this.SetResistance(ResistanceType.Energy, 40, 50);

                this.SetSkill(SkillName.MagicResist, 70.1, 95.0);
                this.SetSkill(SkillName.Tactics, 45.1, 70.0);
                this.SetSkill(SkillName.Wrestling, 50.1, 70.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\WailingBanshee.cs

<pre>this.SetStr(126, 150);
            this.SetDex(76, 100);
            this.SetInt(86, 110);

            this.SetHits(76, 90);

            this.SetDamage(10, 14);

            this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Cold, 60);
            this.SetDamageType(ResistanceType.Poison, 20);

            this.SetResistance(ResistanceType.Physical, 50, 60);
            this.SetResistance(ResistanceType.Fire, 25, 30);
            this.SetResistance(ResistanceType.Cold, 70, 80);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 40, 50);

            this.SetSkill(SkillName.MagicResist, 70.1, 95.0);
            this.SetSkill(SkillName.Tactics, 45.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 50.1, 70.0);</pre>

## Duplicated Code. Size: 352

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBlacksmith.cs

<pre>this.Add(new GenericBuyInfo(typeof(PlateHelm), 21, 20, 0x1412, 0));
                this.Add(new GenericBuyInfo(typeof(CloseHelm), 18, 20, 0x1408, 0));
                this.Add(new GenericBuyInfo(typeof(CloseHelm), 18, 20, 0x1409, 0));
                this.Add(new GenericBuyInfo(typeof(Helmet), 31, 20, 0x140A, 0));
                this.Add(new GenericBuyInfo(typeof(Helmet), 18, 20, 0x140B, 0));
                this.Add(new GenericBuyInfo(typeof(NorseHelm), 18, 20, 0x140E, 0));
                this.Add(new GenericBuyInfo(typeof(NorseHelm), 18, 20, 0x140F, 0));
                this.Add(new GenericBuyInfo(typeof(Bascinet), 18, 20, 0x140C, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBHelmetArmor.cs

<pre>this.Add(new GenericBuyInfo(typeof(PlateHelm), 21, 20, 0x1412, 0));
                this.Add(new GenericBuyInfo(typeof(CloseHelm), 18, 20, 0x1408, 0));
                this.Add(new GenericBuyInfo(typeof(CloseHelm), 18, 20, 0x1409, 0));
                this.Add(new GenericBuyInfo(typeof(Helmet), 31, 20, 0x140A, 0));
                this.Add(new GenericBuyInfo(typeof(Helmet), 18, 20, 0x140B, 0));
                this.Add(new GenericBuyInfo(typeof(NorseHelm), 18, 20, 0x140E, 0));
                this.Add(new GenericBuyInfo(typeof(NorseHelm), 18, 20, 0x140F, 0));
                this.Add(new GenericBuyInfo(typeof(Bascinet), 18, 20, 0x140C, 0));</pre>

## Duplicated Code. Size: 350

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Docs.cs

<pre>html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><a href=\"http://www.runuo.com/images/bodreward_cloth_full.jpg\"><img src=\"http://www.runuo.com/images/bodreward_cloth_1.jpg\" alt=\"Colored Cloth (Level 1)\" border=\"0\"></a></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><a href=\"http://www.runuo.com/images/bodreward_cloth_full.jpg\"><img src=\"http://www.runuo.com/images/bodreward_cloth_2.jpg\" alt=\"Colored Cloth (Level 2)\" border=\"0\"></a></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><a href=\"http://www.runuo.com/images/bodreward_cloth_full.jpg\"><img src=\"http://www.runuo.com/images/bodreward_cloth_3.jpg\" alt=\"Colored Cloth (Level 3)\" border=\"0\"></a></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><a href=\"http://www.runuo.com/images/bodreward_cloth_full.jpg\"><img src=\"http://www.runuo.com/images/bodreward_cloth_4.jpg\" alt=\"Colored Cloth (Level 4)\" border=\"0\"></a></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><a href=\"http://www.runuo.com/images/bodreward_cloth_full.jpg\"><img src=\"http://www.runuo.com/images/bodreward_cloth_5.jpg\" alt=\"Colored Cloth (Level 5)\" border=\"0\"></a></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><a href=\"http://www.runuo.com/images/bodreward_sandals_full.jpg\"><img src=\"http://www.runuo.com/images/bodreward_sandals.jpg\" alt=\"Colored Sandals\" border=\"0\"></a></center></td>");
			html.WriteLine(
				"            <td style=\"width: 100px;\" colspan=\"4\" class=\"entry\"><center>Power Scrolls</center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_smallhides.jpg\" alt=\"Small Stretched Hide\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_mediumhides.jpg\" alt=\"Medium Stretched Hide\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_lighttapestry.jpg\" alt=\"Light Flower Tapestry\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_darktapestry.jpg\" alt=\"Dark Flower Tapestry\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_brownbearrug.jpg\" alt=\"Brown Bear Rug\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_polarbearrug.jpg\" alt=\"Polar Bear Rug\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_clothingbless.jpg\" alt=\"Clothing Bless Deed\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 75px;\" colspan=\"3\" class=\"entry\"><center>Runic Kits</center></td>");
			html.WriteLine("         </tr>");
			html.WriteLine("         <tr>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+5</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+10</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+15</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+20</small></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_runic_spined.jpg\" alt=\"Runic Sewing Kit: Spined\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_runic_horned.jpg\" alt=\"Runic Sewing Kit: Horned\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_runic_barbed.jpg\" alt=\"Runic Sewing Kit: Barbed\"></center></td>");
			html.WriteLine("         </tr>");</pre>

Fragment 2 in file Scripts\Commands\Docs.cs

<pre>html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><a href=\"http://www.runuo.com/images/bodreward_cloth_full.jpg\"><img src=\"http://www.runuo.com/images/bodreward_cloth_1.jpg\" alt=\"Colored Cloth (Level 1)\" border=\"0\"></a></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><a href=\"http://www.runuo.com/images/bodreward_cloth_full.jpg\"><img src=\"http://www.runuo.com/images/bodreward_cloth_2.jpg\" alt=\"Colored Cloth (Level 2)\" border=\"0\"></a></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><a href=\"http://www.runuo.com/images/bodreward_cloth_full.jpg\"><img src=\"http://www.runuo.com/images/bodreward_cloth_3.jpg\" alt=\"Colored Cloth (Level 3)\" border=\"0\"></a></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><a href=\"http://www.runuo.com/images/bodreward_cloth_full.jpg\"><img src=\"http://www.runuo.com/images/bodreward_cloth_4.jpg\" alt=\"Colored Cloth (Level 4)\" border=\"0\"></a></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><a href=\"http://www.runuo.com/images/bodreward_cloth_full.jpg\"><img src=\"http://www.runuo.com/images/bodreward_cloth_5.jpg\" alt=\"Colored Cloth (Level 5)\" border=\"0\"></a></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><a href=\"http://www.runuo.com/images/bodreward_sandals_full.jpg\"><img src=\"http://www.runuo.com/images/bodreward_sandals.jpg\" alt=\"Colored Sandals\" border=\"0\"></a></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+5</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+10</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+15</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+20</small></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_smallhides.jpg\" alt=\"Small Stretched Hide\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_mediumhides.jpg\" alt=\"Medium Stretched Hide\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_lighttapestry.jpg\" alt=\"Light Flower Tapestry\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_darktapestry.jpg\" alt=\"Dark Flower Tapestry\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_brownbearrug.jpg\" alt=\"Brown Bear Rug\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_polarbearrug.jpg\" alt=\"Polar Bear Rug\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" rowspan=\"2\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_clothingbless.jpg\" alt=\"Clothing Bless Deed\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_runic_spined.jpg\" alt=\"Runic Sewing Kit: Spined\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_runic_horned.jpg\" alt=\"Runic Sewing Kit: Horned\"></center></td>");
			html.WriteLine(
				"            <td style=\"width: 25px;\" class=\"entry\"><center><img src=\"http://www.runuo.com/images/bodreward_runic_barbed.jpg\" alt=\"Runic Sewing Kit: Barbed\"></center></td>");
			html.WriteLine("         </tr>");
			html.WriteLine("         <tr>");
			html.WriteLine(
				"            <td style=\"width: 100px;\" colspan=\"4\" class=\"entry\"><center>Power Scrolls</center></td>");
			html.WriteLine(
				"            <td style=\"width: 75px;\" colspan=\"3\" class=\"entry\"><center>Runic Kits</center></td>");
			html.WriteLine("         </tr>");</pre>

## Duplicated Code. Size: 350

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\MyrmidexThreat\Generate.cs

<pre>Item st = new Static(0xA1F);
            st.MoveToWorld(new Point3D(913, 1871, 0), Map.TerMur);

            st = new Static(0xA1F);
            st.MoveToWorld(new Point3D(914, 1871, 0), Map.TerMur);

            BattleFlag bflag = new BattleFlag(0x42CB, 0);
            bflag.MoveToWorld(new Point3D(914, 1872, 5), Map.TerMur);

            st = new Static(0xA1F);
            st.MoveToWorld(new Point3D(913, 1792, 0), Map.TerMur);

            bflag = new BattleFlag(0x42C, 2520);
            bflag.MoveToWorld(new Point3D(914, 1793, 6), Map.TerMur);

            bflag = new BattleFlag(0x42D, 2520);
            bflag.MoveToWorld(new Point3D(913, 1793, 6), Map.TerMur);</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Myrmidex Invasion\BattleSpawner.cs

<pre>Item st = new Static(0xA1F);
            st.MoveToWorld(new Point3D(913, 1871, 0), Map.TerMur);

            st = new Static(0xA1F);
            st.MoveToWorld(new Point3D(914, 1871, 0), Map.TerMur);

            BattleFlag bflag = new BattleFlag(0x42CB, 0);
            bflag.MoveToWorld(new Point3D(914, 1872, 5), Map.TerMur);

            st = new Static(0xA1F);
            st.MoveToWorld(new Point3D(913, 1792, 0), Map.TerMur);

            bflag = new BattleFlag(0x42C, 2520);
            bflag.MoveToWorld(new Point3D(914, 1793, 6), Map.TerMur);

            bflag = new BattleFlag(0x42D, 2520);
            bflag.MoveToWorld(new Point3D(913, 1793, 6), Map.TerMur);</pre>

## Duplicated Code. Size: 349

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>m_WorkingList = (ArrayList)gauntlet.Participants.Clone();

                AddLabel( 150, 50, 0, String.Format(XmlPoints.GetText(from, 200504), m_WorkingList.Count*m_gauntlet.EntryFee));  // "Total Purse: {0}"

                AddLabel( 150, 70, 0, String.Format(XmlPoints.GetText(from, 200505), m_gauntlet.Location, m_gauntlet.Map));    // "Loc: {0} {1}"

                AddLabel( 20, 90, 0, String.Format(XmlPoints.GetText(from, 200506), gauntlet.Participants.Count));    // "Players: {0}"

                AddLabel( 150, 90, 0, String.Format(XmlPoints.GetText(from, 200507), gauntlet.ActivePlayers()));   // "Active: {0}"

                int yoffset = 135;

                // page up and down buttons
                AddButton( 300, 110, 0x15E0, 0x15E4, 13, GumpButtonType.Reply, 0 );
                AddButton( 320, 110, 0x15E2, 0x15E6, 12, GumpButtonType.Reply, 0 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>m_WorkingList = (ArrayList)gauntlet.Participants.Clone();

                AddLabel( 150, 50, 0, String.Format(XmlPoints.GetText(from, 200504), m_WorkingList.Count*m_gauntlet.EntryFee)); // "Total Purse: {0}"

                AddLabel( 150, 70, 0, String.Format(XmlPoints.GetText(from, 200505), m_gauntlet.Location, m_gauntlet.Map));  // "Loc: {0} {1}"

                AddLabel( 20, 90, 0, String.Format(XmlPoints.GetText(from, 200506), gauntlet.Participants.Count));   // "Players: {0}"

                AddLabel( 150, 90, 0, String.Format(XmlPoints.GetText(from, 200507), gauntlet.ActivePlayers()));  // "Active: {0}"

                int yoffset = 135;

                // page up and down buttons
                AddButton( 300, 110, 0x15E0, 0x15E4, 13, GumpButtonType.Reply, 0 );
                AddButton( 320, 110, 0x15E2, 0x15E6, 12, GumpButtonType.Reply, 0 );</pre>

## Duplicated Code. Size: 348

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Shade.cs

<pre>Body = 26;
            Hue = 0x4001;
            BaseSoundID = 0x482;

            SetStr(76, 100);
            SetDex(76, 95);
            SetInt(36, 60);

            SetHits(46, 60);

            SetDamage(7, 11);

            SetDamageType(ResistanceType.Physical, 50);
            SetDamageType(ResistanceType.Cold, 50);

            SetResistance(ResistanceType.Physical, 25, 30);
            SetResistance(ResistanceType.Cold, 15, 25);
            SetResistance(ResistanceType.Poison, 10, 20);

            SetSkill(SkillName.EvalInt, 55.1, 70.0);
            SetSkill(SkillName.Magery, 55.1, 70.0);
            SetSkill(SkillName.MagicResist, 55.1, 70.0);
            SetSkill(SkillName.Tactics, 45.1, 60.0);
            SetSkill(SkillName.Wrestling, 45.1, 55.0);

            Fame = 4000;
            Karma = -4000;

            VirtualArmor = 28;

            PackReg(10);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Spectre.cs

<pre>Body = 26;
            Hue = 0x4001;
            BaseSoundID = 0x482;

            SetStr(76, 100);
            SetDex(76, 95);
            SetInt(36, 60);

            SetHits(46, 60);

            SetDamage(7, 11);

            SetDamageType(ResistanceType.Physical, 50);
            SetDamageType(ResistanceType.Cold, 50);

            SetResistance(ResistanceType.Physical, 25, 30);
            SetResistance(ResistanceType.Cold, 15, 25);
            SetResistance(ResistanceType.Poison, 10, 20);

            SetSkill(SkillName.EvalInt, 55.1, 70.0);
            SetSkill(SkillName.Magery, 55.1, 70.0);
            SetSkill(SkillName.MagicResist, 55.1, 70.0);
            SetSkill(SkillName.Tactics, 45.1, 60.0);
            SetSkill(SkillName.Wrestling, 45.1, 55.0);

            Fame = 4000;
            Karma = -4000;

            VirtualArmor = 28;

            PackReg(10);</pre>

Fragment 3 in file Scripts\Mobiles\Normal\Wraith.cs

<pre>Body = 26;
            Hue = 0x4001;
            BaseSoundID = 0x482;

            SetStr(76, 100);
            SetDex(76, 95);
            SetInt(36, 60);

            SetHits(46, 60);

            SetDamage(7, 11);

            SetDamageType(ResistanceType.Physical, 50);
            SetDamageType(ResistanceType.Cold, 50);

            SetResistance(ResistanceType.Physical, 25, 30);
            SetResistance(ResistanceType.Cold, 15, 25);
            SetResistance(ResistanceType.Poison, 10, 20);

            SetSkill(SkillName.EvalInt, 55.1, 70.0);
            SetSkill(SkillName.Magery, 55.1, 70.0);
            SetSkill(SkillName.MagicResist, 55.1, 70.0);
            SetSkill(SkillName.Tactics, 45.1, 60.0);
            SetSkill(SkillName.Wrestling, 45.1, 55.0);

            Fame = 4000;
            Karma = -4000;

            VirtualArmor = 28;

            PackReg(10);</pre>

## Duplicated Code. Size: 347

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\ParoxysmusTeleporters.cs

<pre>public override bool OnMoveOver(Mobile m)
        {
            if (m.NetState == null || !m.NetState.SupportsExpansion(Expansion.ML))
            {
                m.SendLocalizedMessage(1072608); // You must upgrade to the Mondain's Legacy expansion in order to enter here.				
                return true;
            }
            else if (!MondainsLegacy.PalaceOfParoxysmus && (int)m.AccessLevel < (int)AccessLevel.GameMaster)
            {
                m.SendLocalizedMessage(1042753, "Palace of Paroxysmus"); // ~1_SOMETHING~ has been temporarily disabled.
                return true;
            }

            if (m.Backpack != null)
            {
                Item rope = m.Backpack.FindItemByType(typeof(MagicalRope), true);

                if (rope == null)
                    rope = m.Backpack.FindItemByType(typeof(AcidProofRope), true);

                if (rope != null && !rope.Deleted)
                {
                    if (Utility.RandomDouble() < 0.3)
                    {
                        m.SendLocalizedMessage(1075097); // Your rope is severely damaged by the acidic environment.  You're lucky to have made it safely to the ground.
                        rope.Delete();
                    }
                    else
                        m.SendLocalizedMessage(1075098); // Your rope has been weakened by the acidic environment.

                    return base.OnMoveOver(m);					
                }
            }
            else
                m.SendLocalizedMessage(1074272); // You have no way to lower yourself safely into the enormous sinkhole.

            return true;	
        }</pre>

Fragment 2 in file Scripts\Items\Internal\ParoxysmusTeleporters.cs

<pre>public override bool OnMoveOver(Mobile m)
        {
            if (m.NetState == null || !m.NetState.SupportsExpansion(Expansion.ML))
            {
                m.SendLocalizedMessage(1072608); // You must upgrade to the Mondain's Legacy expansion in order to enter here.				
                return true;
            }
            else if (!MondainsLegacy.PalaceOfParoxysmus && (int)m.AccessLevel < (int)AccessLevel.GameMaster)
            {
                m.SendLocalizedMessage(1042753, "Palace of Paroxysmus"); // ~1_SOMETHING~ has been temporarily disabled.
                return true;
            }

            if (m.Backpack != null)
            {
                Item rope = m.Backpack.FindItemByType(typeof(MagicalRope), true);

                if (rope == null)
                    rope = m.Backpack.FindItemByType(typeof(AcidProofRope), true);

                if (rope != null && !rope.Deleted)
                {
                    if (Utility.RandomDouble() < 0.3)
                    {
                        m.SendLocalizedMessage(1075097); // Your rope is severely damaged by the acidic environment.  You're lucky to have made it safely to the ground.
                        rope.Delete();
                    }
                    else
                        m.SendLocalizedMessage(1075098); // Your rope has been weakened by the acidic environment.

                    return base.OnMoveOver(m);
                }
            }
            else
                m.SendLocalizedMessage(1074272); // You have no way to lower yourself safely into the enormous sinkhole.

            return true;
        }</pre>

## Duplicated Code. Size: 345

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendBoltEffect(m, true, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x307);</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendBoltEffect(m, true, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x307);</pre>

Fragment 3 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendBoltEffect(m, true, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x307);</pre>

Fragment 4 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x36BD, 15, effHue, 0);
                    Effects.SendBoltEffect(m, true, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x307);</pre>

## Duplicated Code. Size: 344

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Pathing\Movement.cs

<pre>int itemTop = itemZ;
                    int ourZ = itemZ + itemData.CalcHeight;
                    int ourTop = ourZ + PersonHeight;
                    int testTop = checkTop;

                    if (moveIsOk)
                    {
                        int cmp = Math.Abs(ourZ - p.Z) - Math.Abs(newZ - p.Z);

                        if (cmp > 0 || (cmp == 0 && ourZ > newZ))
                            continue;
                    }

                    if (ourZ + PersonHeight > testTop)
                        testTop = ourZ + PersonHeight;

                    if (!itemData.Bridge)
                        itemTop += itemData.Height;

                    if (stepTop >= itemTop)
                    {
                        int landCheck = itemZ;

                        if (itemData.Height >= StepHeight)
                            landCheck += StepHeight;
                        else
                            landCheck += itemData.Height;

                        if (considerLand && landCheck < landCenter && landCenter > ourZ && testTop > landZ)
                            continue;

                        if (this.IsOk(ignoreDoors, ignoreSpellFields, ourZ, testTop, tiles, items))
                        {
                            newZ = ourZ;
                            moveIsOk = true;
                        }
                    }</pre>

Fragment 2 in file Scripts\Services\Pathing\Movement.cs

<pre>int itemTop = itemZ;
                    int ourZ = itemZ + itemData.CalcHeight;
                    int ourTop = ourZ + PersonHeight;
                    int testTop = checkTop;

                    if (moveIsOk)
                    {
                        int cmp = Math.Abs(ourZ - p.Z) - Math.Abs(newZ - p.Z);

                        if (cmp > 0 || (cmp == 0 && ourZ > newZ))
                            continue;
                    }

                    if (ourZ + PersonHeight > testTop)
                        testTop = ourZ + PersonHeight;

                    if (!itemData.Bridge)
                        itemTop += itemData.Height;

                    if (stepTop >= itemTop)
                    {
                        int landCheck = itemZ;

                        if (itemData.Height >= StepHeight)
                            landCheck += StepHeight;
                        else
                            landCheck += itemData.Height;

                        if (considerLand && landCheck < landCenter && landCenter > ourZ && testTop > landZ)
                            continue;

                        if (this.IsOk(ignoreDoors, ignoreSpellFields, ourZ, testTop, tiles, items))
                        {
                            newZ = ourZ;
                            moveIsOk = true;
                        }
                    }</pre>

## Duplicated Code. Size: 343

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Hiryu.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (version == 0)
                Timer.DelayCall(TimeSpan.Zero, delegate { this.Hue = GetHue(); });

            if (version <= 1)
                Timer.DelayCall(TimeSpan.Zero, delegate
                {
                    if (this.InternalItem != null)
                    {
                        this.InternalItem.Hue = this.Hue;
                    }
                });

            if (version < 2)
            {
                for (int i = 0; i < this.Skills.Length; ++i)
                {
                    this.Skills[i].Cap = Math.Max(100.0, this.Skills[i].Cap * 0.9);

                    if (this.Skills[i].Base > this.Skills[i].Cap)
                    {
                        this.Skills[i].Base = this.Skills[i].Cap;
                    }
                }
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\LesserHiryu.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (version == 0)
                Timer.DelayCall(TimeSpan.Zero, delegate { this.Hue = GetHue(); });

            if (version <= 1)
                Timer.DelayCall(TimeSpan.Zero, delegate
                {
                    if (this.InternalItem != null)
                    {
                        this.InternalItem.Hue = this.Hue;
                    }
                });

            if (version < 2)
            {
                for (int i = 0; i < this.Skills.Length; ++i)
                {
                    this.Skills[i].Cap = Math.Max(100.0, this.Skills[i].Cap * 0.9);

                    if (this.Skills[i].Base > this.Skills[i].Cap)
                    {
                        this.Skills[i].Base = this.Skills[i].Cap;
                    }
                }
            }
        }</pre>

## Duplicated Code. Size: 339

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\DespiseBosses.cs

<pre>BaseSoundID = 466;

			SetStr( 600, 700 );
			SetDex( 500, 600 );
			SetInt( 500, 600 );

			SetHits( 7000, 8000 );

			SetDamage( 12, 19 );

			SetDamageType( ResistanceType.Physical, 40 );
			SetDamageType( ResistanceType.Fire, 30 );
			SetDamageType( ResistanceType.Energy, 30 );

			SetResistance( ResistanceType.Physical, 50 );
			SetResistance( ResistanceType.Fire, 60, 70 );
			SetResistance( ResistanceType.Cold, 60, 70 );
			SetResistance( ResistanceType.Poison, 50, 60 );
			SetResistance( ResistanceType.Energy, 60, 70 );

			SetSkill( SkillName.MagicResist, 110, 125 );
			SetSkill( SkillName.Tactics, 110, 125 );
			SetSkill( SkillName.Wrestling, 110, 125 );
			SetSkill( SkillName.Anatomy, 110, 125 );

			Fame = 8000;</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\DespiseBosses.cs

<pre>BaseSoundID = 466;

			SetStr( 600, 700 );
			SetDex( 500, 600 );
			SetInt( 500, 600 );

			SetHits( 7000, 8000 );

			SetDamage( 12, 19 );

			SetDamageType( ResistanceType.Physical, 40 );
			SetDamageType( ResistanceType.Fire, 30 );
			SetDamageType( ResistanceType.Energy, 30 );

			SetResistance( ResistanceType.Physical, 50 );
			SetResistance( ResistanceType.Fire, 60, 70 );
			SetResistance( ResistanceType.Cold, 60, 70 );
			SetResistance( ResistanceType.Poison, 50, 60 );
			SetResistance( ResistanceType.Energy, 60, 70 );

			SetSkill( SkillName.MagicResist, 110, 125 );
			SetSkill( SkillName.Tactics, 110, 125 );
			SetSkill( SkillName.Wrestling, 110, 125 );
			SetSkill( SkillName.Anatomy, 110, 125 );

			Fame = 8000;</pre>

## Duplicated Code. Size: 339

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Pathing\FastMovement.cs

<pre>itemTop = itemZ;
				ourZ = itemZ + itemData.CalcHeight;
				ourTop = ourZ + PersonHeight;
				testTop = checkTop;

				if (moveIsOk)
				{
					var cmp = Math.Abs(ourZ - p.Z) - Math.Abs(newZ - p.Z);

					if (cmp > 0 || (cmp == 0 && ourZ > newZ))
					{
						continue;
					}
				}

				if (ourTop > testTop)
				{
					testTop = ourTop;
				}

				if (!itemData.Bridge)
				{
					itemTop += itemData.Height;
				}

				if (stepTop < itemTop)
				{
					continue;
				}

				var landCheck = itemZ;

				if (itemData.Height >= StepHeight)
				{
					landCheck += StepHeight;
				}
				else
				{
					landCheck += itemData.Height;
				}

				if (considerLand && landCheck < landCenter && landCenter > ourZ && testTop > landZ)
				{
					continue;
				}

				if (!IsOk(ignoreDoors, ignoreSpellFields, ourZ, testTop, tiles, items))
				{
					continue;
				}

				newZ = ourZ;
				moveIsOk = true;</pre>

Fragment 2 in file Scripts\Services\Pathing\FastMovement.cs

<pre>itemTop = itemZ;
				ourZ = itemZ + itemData.CalcHeight;
				ourTop = ourZ + PersonHeight;
				testTop = checkTop;

				if (moveIsOk)
				{
					var cmp = Math.Abs(ourZ - p.Z) - Math.Abs(newZ - p.Z);

					if (cmp > 0 || (cmp == 0 && ourZ > newZ))
					{
						continue;
					}
				}

				if (ourTop > testTop)
				{
					testTop = ourTop;
				}

				if (!itemData.Bridge)
				{
					itemTop += itemData.Height;
				}

				if (stepTop < itemTop)
				{
					continue;
				}

				var landCheck = itemZ;

				if (itemData.Height >= StepHeight)
				{
					landCheck += StepHeight;
				}
				else
				{
					landCheck += itemData.Height;
				}

				if (considerLand && landCheck < landCenter && landCenter > ourZ && testTop > landZ)
				{
					continue;
				}

				if (!IsOk(ignoreDoors, ignoreSpellFields, ourZ, testTop, tiles, items))
				{
					continue;
				}

				newZ = ourZ;
				moveIsOk = true;</pre>

## Duplicated Code. Size: 339

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCatapult.cs

<pre>public override Point3D ProjectileLaunchPoint
		{
			get
			{
				if (Components != null && Components.Count > 0)
				{
					switch (Facing)
					{
						case 0:
							return new Point3D(CatapultWestXOffset[0] + Location.X - 2, CatapultWestYOffset[0] + Location.Y -1, Location.Z + 5);
						case 1:
							return new Point3D(CatapultNorthXOffset[0] + Location.X -1, CatapultNorthYOffset[0] + Location.Y - 1, Location.Z + 5);
						case 2:
							return new Point3D(CatapultEastXOffset[0] + Location.X - 2, CatapultEastYOffset[0] + Location.Y -1, Location.Z + 5);
						case 3:
							return new Point3D(CatapultSouthXOffset[0] + Location.X, CatapultSouthYOffset[0] + Location.Y - 1, Location.Z +5);
					}
				}

				return (this.Location);
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>public override Point3D ProjectileLaunchPoint
		{
			get
			{
				if (Components != null && Components.Count > 0)
				{
					switch (Facing)
					{
						case 0:
							return new Point3D(CatapultWestXOffset[0] + Location.X - 2, CatapultWestYOffset[0] + Location.Y - 1, Location.Z + 5);
						case 1:
							return new Point3D(CatapultNorthXOffset[0] + Location.X - 1, CatapultNorthYOffset[0] + Location.Y - 1, Location.Z + 5);
						case 2:
							return new Point3D(CatapultEastXOffset[0] + Location.X - 2, CatapultEastYOffset[0] + Location.Y - 1, Location.Z + 5);
						case 3:
							return new Point3D(CatapultSouthXOffset[0] + Location.X, CatapultSouthYOffset[0] + Location.Y - 1, Location.Z + 5);
					}
				}

				return (this.Location);
			}
		}</pre>

## Duplicated Code. Size: 335

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Guildstone.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.m_Guild != null && !this.m_Guild.Disbanded)
            {
                string name;
                string abbr;

                if ((name = this.m_Guild.Name) == null || (name = name.Trim()).Length <= 0)
                    name = "(unnamed)";

                if ((abbr = this.m_Guild.Abbreviation) == null || (abbr = abbr.Trim()).Length <= 0)
                    abbr = "";

                //list.Add( 1060802, Utility.FixHtml( name ) ); // Guild name: ~1_val~
                list.Add(1060802, String.Format("{0} [{1}]", Utility.FixHtml(name), Utility.FixHtml(abbr)));
            }
            else if (this.m_GuildName != null && this.m_GuildAbbrev != null)
            {
                list.Add(1060802, String.Format("{0} [{1}]", Utility.FixHtml(this.m_GuildName), Utility.FixHtml(this.m_GuildAbbrev)));
            }
        }</pre>

Fragment 2 in file Scripts\Items\Addons\Guildstone.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.m_Guild != null && !this.m_Guild.Disbanded)
            {
                string name;
                string abbr;

                if ((name = this.m_Guild.Name) == null || (name = name.Trim()).Length <= 0)
                    name = "(unnamed)";

                if ((abbr = this.m_Guild.Abbreviation) == null || (abbr = abbr.Trim()).Length <= 0)
                    abbr = "";

                //list.Add( 1060802, Utility.FixHtml( name ) ); // Guild name: ~1_val~
                list.Add(1060802, String.Format("{0} [{1}]", Utility.FixHtml(name), Utility.FixHtml(abbr)));
            }
            else if (this.m_GuildName != null && this.m_GuildAbbrev != null)
            {
                list.Add(1060802, String.Format("{0} [{1}]", Utility.FixHtml(this.m_GuildName), Utility.FixHtml(this.m_GuildAbbrev)));
            }
        }</pre>

## Duplicated Code. Size: 335

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\SerpentsFangAssassin.cs

<pre>this.SetResistance(ResistanceType.Cold, 55, 60);
            this.SetResistance(ResistanceType.Poison, 30, 50);
            this.SetResistance(ResistanceType.Energy, 30, 50);

            this.SetSkill(SkillName.MagicResist, 80.0, 100.0);
            this.SetSkill(SkillName.Tactics, 115.0, 130.0);
            this.SetSkill(SkillName.Wrestling, 95.0, 120.0);
            this.SetSkill(SkillName.Anatomy, 105.0, 120.0);
            this.SetSkill(SkillName.Fencing, 78.0, 100.0);
            this.SetSkill(SkillName.Swords, 90.1, 105.0);
            this.SetSkill(SkillName.Ninjitsu, 90.0, 120.0);
            this.SetSkill(SkillName.Hiding, 100.0, 120.0);
            this.SetSkill(SkillName.Stealth, 100.0, 120.0);

            this.Fame = 13000;
            this.Karma = -13000;

            this.VirtualArmor = 58;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\TigersClawThief.cs

<pre>this.SetResistance(ResistanceType.Cold, 55, 60);
            this.SetResistance(ResistanceType.Poison, 30, 50);
            this.SetResistance(ResistanceType.Energy, 30, 50);

            this.SetSkill(SkillName.MagicResist, 80.0, 100.0);
            this.SetSkill(SkillName.Tactics, 115.0, 130.0);
            this.SetSkill(SkillName.Wrestling, 95.0, 120.0);
            this.SetSkill(SkillName.Anatomy, 105.0, 120.0);
            this.SetSkill(SkillName.Fencing, 78.0, 100.0);
            this.SetSkill(SkillName.Swords, 90.1, 105.0);
            this.SetSkill(SkillName.Ninjitsu, 90.0, 120.0);
            this.SetSkill(SkillName.Hiding, 100.0, 120.0);
            this.SetSkill(SkillName.Stealth, 100.0, 120.0);

            this.Fame = 13000;
            this.Karma = -13000;

            this.VirtualArmor = 58;</pre>

## Duplicated Code. Size: 334

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseEvilCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 50 );
			SetDamageType( ResistanceType.Fire, 15 );
			SetDamageType( ResistanceType.Cold, 10 );
			SetDamageType( ResistanceType.Poison, 15 );
			SetDamageType( ResistanceType.Energy, 10 );

			SetResistance( ResistanceType.Physical, 30, 40 );
			SetResistance( ResistanceType.Fire, 25, 30 );
			SetResistance( ResistanceType.Cold, 25, 30 );
			SetResistance( ResistanceType.Poison, 30, 35 );
			SetResistance( ResistanceType.Energy, 20, 25 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );
			SetSkill( SkillName.Magery, SkillStart );
			SetSkill( SkillName.EvalInt, SkillStart );
			SetSkill( SkillName.Meditation, SkillStart );

			Fame = GetFame;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DespiseGoodCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 50 );
			SetDamageType( ResistanceType.Fire, 15 );
			SetDamageType( ResistanceType.Cold, 10 );
			SetDamageType( ResistanceType.Poison, 15 );
			SetDamageType( ResistanceType.Energy, 10 );

			SetResistance( ResistanceType.Physical, 30, 40 );
			SetResistance( ResistanceType.Fire, 25, 30 );
			SetResistance( ResistanceType.Cold, 25, 30 );
			SetResistance( ResistanceType.Poison, 30, 35 );
			SetResistance( ResistanceType.Energy, 20, 25 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );
			SetSkill( SkillName.Magery, SkillStart );
			SetSkill( SkillName.EvalInt, SkillStart );
			SetSkill( SkillName.Meditation, SkillStart );

			Fame = GetFame;</pre>

## Duplicated Code. Size: 334

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ViceVsVirtue\Gumps\GuildLeaderboardGump.cs

<pre>switch (Filter)
            {
                default:
                case Filter.Score: list = list.OrderBy(e => -e.Score).ToList(); break;
                case Filter.Kills: list = list.OrderBy(e => -e.Kills).ToList(); break;
                case Filter.ReturnedSigils: list = list.OrderBy(e => -e.ReturnedSigils).ToList(); break;
            }

            int pages = (int)Math.Ceiling((double)list.Count / PerPage);
            int y = 75;
            int page = 1;
            int pageindex = 0;

            if (pages < 1)
                pages = 1;

            AddPage(page);
            AddHtmlLocalized(60, 290, 150, 20, 1153561, String.Format("{0}\t{1}", page.ToString(), pages.ToString()), 0xFFFF, false, false); // Page ~1_CUR~ of ~2_MAX~</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\Gumps\LeaderboardGump.cs

<pre>switch (Filter)
            {
                default:
                case Filter.Score: list = list.OrderBy(e => -e.Score).ToList(); break;
                case Filter.Kills: list = list.OrderBy(e => -e.Kills).ToList(); break;
                case Filter.ReturnedSigils: list = list.OrderBy(e => -e.ReturnedSigils).ToList(); break;
            }

            int pages = (int)Math.Ceiling((double)list.Count / PerPage);
            int y = 75;
            int page = 1;
            int pageindex = 0;

            if (pages < 1)
                pages = 1;

            AddPage(page);
            AddHtmlLocalized(60, 290, 150, 20, 1153561, String.Format("{0}\t{1}", page.ToString(), pages.ToString()), 0xFFFF, false, false); // Page ~1_CUR~ of ~2_MAX~</pre>

## Duplicated Code. Size: 332

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GiantRat.cs

<pre>this.Body = 0xD7;
            this.BaseSoundID = 0x188;

            this.SetStr(32, 74);
            this.SetDex(46, 65);
            this.SetInt(16, 30);

            this.SetHits(26, 39);
            this.SetMana(0);

            this.SetDamage(4, 8);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 20);
            this.SetResistance(ResistanceType.Fire, 5, 10);
            this.SetResistance(ResistanceType.Poison, 25, 35);

            this.SetSkill(SkillName.MagicResist, 25.1, 30.0);
            this.SetSkill(SkillName.Tactics, 29.3, 44.0);
            this.SetSkill(SkillName.Wrestling, 29.3, 44.0);

            this.Fame = 300;
            this.Karma = -300;

            this.VirtualArmor = 18;</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\ShipRat.cs

<pre>this.Body = 0xD7;
            this.BaseSoundID = 0x188;

            this.SetStr(32, 74);
            this.SetDex(46, 65);
            this.SetInt(16, 30);

            this.SetHits(26, 39);
            this.SetMana(0);

            this.SetDamage(4, 8);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 20);
            this.SetResistance(ResistanceType.Fire, 5, 10);
            this.SetResistance(ResistanceType.Poison, 25, 35);

            this.SetSkill(SkillName.MagicResist, 25.1, 30.0);
            this.SetSkill(SkillName.Tactics, 29.3, 44.0);
            this.SetSkill(SkillName.Wrestling, 29.3, 44.0);

            this.Fame = 300;
            this.Karma = -300;

            this.VirtualArmor = 18;</pre>

## Duplicated Code. Size: 332

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\ScrollBox.cs

<pre>if (0.05 >= Utility.RandomDouble())
            {
                double runictype = Utility.RandomDouble();
                CraftResource res;
                int charges;

                if (runictype <= .25)
                {
                    res = CraftResource.DullCopper;
                    charges = 50;
                }
                else if (runictype <= .40)
                {
                    res = CraftResource.ShadowIron;
                    charges = 45;
                }
                else if (runictype <= .55)
                {
                    res = CraftResource.Copper;
                    charges = 40;
                }
                else if (runictype <= .65)
                {
                    res = CraftResource.Bronze;
                    charges = 35;
                }
                else if (runictype <= .75)
                {
                    res = CraftResource.Gold;
                    charges = 30;
                }
                else if (runictype <= .85)
                {
                    res = CraftResource.Agapite;
                    charges = 25;
                }
                else if (runictype <= .98)
                {
                    res = CraftResource.Verite;
                    charges = 20;
                }
                else
                {
                    res = CraftResource.Valorite;
                    charges = 15;
                }

                DropItem(new RunicMalletAndChisel(res, charges));
            }</pre>

Fragment 2 in file Scripts\Items\Containers\ScrollBox2.cs

<pre>if (0.05 >= Utility.RandomDouble())
            {
                double runictype = Utility.RandomDouble();
                CraftResource res;
                int charges;

                if (runictype <= .25)
                {
                    res = CraftResource.DullCopper;
                    charges = 50;
                }
                else if (runictype <= .40)
                {
                    res = CraftResource.ShadowIron;
                    charges = 45;
                }
                else if (runictype <= .55)
                {
                    res = CraftResource.Copper;
                    charges = 40;
                }
                else if (runictype <= .65)
                {
                    res = CraftResource.Bronze;
                    charges = 35;
                }
                else if (runictype <= .75)
                {
                    res = CraftResource.Gold;
                    charges = 30;
                }
                else if (runictype <= .85)
                {
                    res = CraftResource.Agapite;
                    charges = 25;
                }
                else if (runictype <= .98)
                {
                    res = CraftResource.Verite;
                    charges = 20;
                }
                else
                {
                    res = CraftResource.Valorite;
                    charges = 15;
                }

                DropItem(new RunicMalletAndChisel(res, charges));
            }</pre>

Fragment 3 in file Scripts\Items\Containers\ScrollBox3.cs

<pre>if (0.05 >= Utility.RandomDouble())
            {
                double runictype = Utility.RandomDouble();
                CraftResource res;
                int charges;

                if (runictype <= .25)
                {
                    res = CraftResource.DullCopper;
                    charges = 50;
                }
                else if (runictype <= .40)
                {
                    res = CraftResource.ShadowIron;
                    charges = 45;
                }
                else if (runictype <= .55)
                {
                    res = CraftResource.Copper;
                    charges = 40;
                }
                else if (runictype <= .65)
                {
                    res = CraftResource.Bronze;
                    charges = 35;
                }
                else if (runictype <= .75)
                {
                    res = CraftResource.Gold;
                    charges = 30;
                }
                else if (runictype <= .85)
                {
                    res = CraftResource.Agapite;
                    charges = 25;
                }
                else if (runictype <= .98)
                {
                    res = CraftResource.Verite;
                    charges = 20;
                }
                else
                {
                    res = CraftResource.Valorite;
                    charges = 15;
                }

                DropItem(new RunicMalletAndChisel(res, charges));
            }</pre>

## Duplicated Code. Size: 331

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SignGenDelete.cs

<pre>using (StreamReader ip = new StreamReader(cfg))
                {
                    string line;

                    while ((line = ip.ReadLine()) != null)
                    {
                        string[] split = line.Split(' ');

                        SignEntry e = new SignEntry(
                            line.Substring(split[0].Length + 1 + split[1].Length + 1 + split[2].Length + 1 + split[3].Length + 1 + split[4].Length + 1),
                            new Point3D(Utility.ToInt32(split[2]), Utility.ToInt32(split[3]), Utility.ToInt32(split[4])),
                            Utility.ToInt32(split[1]), Utility.ToInt32(split[0]));

                        list.Add(e);
                    }
                }</pre>

Fragment 2 in file Scripts\Commands\SignParser.cs

<pre>using (StreamReader ip = new StreamReader(cfg))
					{
						string line;

						while ((line = ip.ReadLine()) != null)
						{
							string[] split = line.Split(' ');

							SignEntry e = new SignEntry(
								line.Substring(split[0].Length + 1 + split[1].Length + 1 + split[2].Length + 1 + split[3].Length + 1 + split[4].Length + 1),
								new Point3D(Utility.ToInt32(split[2]), Utility.ToInt32(split[3]), Utility.ToInt32(split[4])),
								Utility.ToInt32(split[1]), Utility.ToInt32(split[0]));

							list.Add(e);
						}
					}</pre>

## Duplicated Code. Size: 331

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>private static void SapMana(object o)
        {
            object[] objs = o as object[];
            Mobile from = objs[0] as Mobile;
            Mobile mob = objs[1] as Mobile;

            if (IsUnderEffects(from))
            {
                if (mob.Alive && from.Alive)
                {
                    from.SendLocalizedMessage(1151484); // You feel extra mana being drawn from you.
                    from.SendLocalizedMessage(1151481); // Channeling the corrupted mana has damaged you!

                    int toSap = Math.Min(from.Mana, Utility.RandomMinMax(30, 40));
                    from.Mana -= toSap;

                    AOS.Damage(from, mob, Math.Max(1, toSap / 10), false, 0, 0, 0, 0, 0, 0, 100, false, false, false);

                    if (0.5 > Utility.RandomDouble())
                        EndEffects(from);
                }
                else
                    EndEffects(from);
            }
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>private static void SapMana(object o)
        {
            object[] objs = o as object[];
            Mobile from = objs[0] as Mobile;
            Mobile mob = objs[1] as Mobile;

            if (IsUnderEffects(from))
            {
                if (mob.Alive && from.Alive)
                {
                    from.SendLocalizedMessage(1151484); // You feel extra mana being drawn from you.
                    from.SendLocalizedMessage(1151481); // Channeling the corrupted mana has damaged you!

                    int toSap = Math.Min(from.Mana, Utility.RandomMinMax(30, 40));
                    from.Mana -= toSap;

                    AOS.Damage(from, mob, Math.Max(1, toSap / 10), false, 0, 0, 0, 0, 0, 0, 100, false, false, false);

                    if (0.5 > Utility.RandomDouble())
                        EndEffects(from);
                }
                else
                    EndEffects(from);
            }
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>private static void SapMana(object o)
        {
            object[] objs = o as object[];
            Mobile from = objs[0] as Mobile;
            Mobile mob = objs[1] as Mobile;

            if (IsUnderEffects(from))
            {
                if (mob.Alive && from.Alive)
                {
                    from.SendLocalizedMessage(1151484); // You feel extra mana being drawn from you.
                    from.SendLocalizedMessage(1151481); // Channeling the corrupted mana has damaged you!

                    int toSap = Math.Min(from.Mana, Utility.RandomMinMax(30, 40));
                    from.Mana -= toSap;

                    AOS.Damage(from, mob, Math.Max(1, toSap / 10), false, 0, 0, 0, 0, 0, 0, 100, false, false, false);

                    if (0.5 > Utility.RandomDouble())
                        EndEffects(from);
                }
                else
                    EndEffects(from);
            }
        }</pre>

## Duplicated Code. Size: 330

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GrayGoblinKeeper.cs

<pre>this.QLPoints = 10;

            switch ( Utility.Random(20) )
            {
                case 0:
                    this.PackItem(new Scimitar());
                    break;
                case 1:
                    this.PackItem(new Katana());
                    break;
                case 2:
                    this.PackItem(new WarMace());
                    break;
                case 3:
                    this.PackItem(new WarHammer());
                    break;
                case 4:
                    this.PackItem(new Kryss());
                    break;
                case 5:
                    this.PackItem(new Pitchfork());
                    break;
            }

            this.PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    this.PackItem(new Ribs());
                    break;
                case 1:
                    this.PackItem(new Shaft());
                    break;
                case 2:
                    this.PackItem(new Candle());
                    break;
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GrayGoblinMage.cs

<pre>this.QLPoints = 10;

            switch ( Utility.Random(20) )
            {
                case 0:
                    this.PackItem(new Scimitar());
                    break;
                case 1:
                    this.PackItem(new Katana());
                    break;
                case 2:
                    this.PackItem(new WarMace());
                    break;
                case 3:
                    this.PackItem(new WarHammer());
                    break;
                case 4:
                    this.PackItem(new Kryss());
                    break;
                case 5:
                    this.PackItem(new Pitchfork());
                    break;
            }

            this.PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    this.PackItem(new Ribs());
                    break;
                case 1:
                    this.PackItem(new Shaft());
                    break;
                case 2:
                    this.PackItem(new Candle());
                    break;
            }</pre>

## Duplicated Code. Size: 329

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if (m_GorgonLenseCharges > 0)
                list.Add(1112590, m_GorgonLenseCharges.ToString()); //Gorgon Lens Charges: ~1_val~
            #endregion

            if (this.m_Crafter != null)
				list.Add(1050043, m_Crafter.TitleName); // crafted by ~1_NAME~

            if (m_Altered)
                list.Add(1111880); // Altered

            #region Factions
            if (this.m_FactionState != null)
                list.Add(1041350); // faction item
            #endregion

            #region Mondain's Legacy Sets
            if (this.IsSetItem)
            {
                if (this.MixedSet)
                    list.Add(1073491, this.Pieces.ToString()); // Part of a Weapon/Armor Set (~1_val~ pieces)
                else
                    list.Add(1072376, this.Pieces.ToString()); // Part of an Armor Set (~1_val~ pieces)

                if (SetID == SetItem.Bestial)
                    list.Add(1151541, BestialSetHelper.GetTotalBerserk(this).ToString()); // Berserk ~1_VAL~

                if (this.BardMasteryBonus)
                    list.Add(1151553); // Activate: Bard Mastery Bonus x2<br>(Effect: 1 min. Cooldown: 30 min.)

                if (this.m_SetEquipped)
                {
                    if (this.MixedSet)
                        list.Add(1073492); // Full Weapon/Armor Set Present
                    else
                        list.Add(1072377); // Full Armor Set Present

                    this.GetSetProperties(list);
                }
            }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if (m_GorgonLenseCharges > 0)
                list.Add(1112590, m_GorgonLenseCharges.ToString()); //Gorgon Lens Charges: ~1_val~
            #endregion

            if (this.m_Crafter != null)
				list.Add(1050043, m_Crafter.TitleName); // crafted by ~1_NAME~

            if (m_Altered)
                list.Add(1111880); // Altered

            #region Factions
            if (this.m_FactionState != null)
                list.Add(1041350); // faction item
            #endregion

            #region Mondain's Legacy Sets
            if (this.IsSetItem)
            {
                if (this.MixedSet)
                    list.Add(1073491, this.Pieces.ToString()); // Part of a Weapon/Armor Set (~1_val~ pieces)
                else
                    list.Add(1072376, this.Pieces.ToString()); // Part of an Armor Set (~1_val~ pieces)

                if (SetID == SetItem.Bestial)
                    list.Add(1151541, BestialSetHelper.GetTotalBerserk(this).ToString()); // Berserk ~1_VAL~

                if (this.BardMasteryBonus)
                    list.Add(1151553); // Activate: Bard Mastery Bonus x2<br>(Effect: 1 min. Cooldown: 30 min.)

                if (this.m_SetEquipped)
                {
                    if (this.MixedSet)
                        list.Add(1073492); // Full Weapon/Armor Set Present
                    else
                        list.Add(1072377); // Full Armor Set Present

                    this.GetSetProperties(list);
                }
            }</pre>

## Duplicated Code. Size: 329

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\KhaldunSummoner.cs

<pre>rm.Team = this.Team;
            rm.Combatant = this.Combatant;
            rm.NoKillAwards = true;

            if (rm.Backpack == null)
            {
                Backpack pack = new Backpack();
                pack.Movable = false;
                rm.AddItem(pack);
            }

            for (int i = 0; i < 2; i++)
            {
                LootPack.FilthyRich.Generate(this, rm.Backpack, true, LootPack.GetLuckChanceForKiller(this));
                LootPack.FilthyRich.Generate(this, rm.Backpack, false, LootPack.GetLuckChanceForKiller(this));
            }

            Effects.PlaySound(this, this.Map, this.GetDeathSound());
            Effects.SendLocationEffect(this.Location, this.Map, 0x3709, 30, 10, 0x835, 0);
            rm.MoveToWorld(this.Location, this.Map);

            this.Delete();
            return false;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\KhaldunZealot.cs

<pre>rm.Team = this.Team;
            rm.Combatant = this.Combatant;
            rm.NoKillAwards = true;

            if (rm.Backpack == null)
            {
                Backpack pack = new Backpack();
                pack.Movable = false;
                rm.AddItem(pack);
            }

            for (int i = 0; i < 2; i++)
            {
                LootPack.FilthyRich.Generate(this, rm.Backpack, true, LootPack.GetLuckChanceForKiller(this));
                LootPack.FilthyRich.Generate(this, rm.Backpack, false, LootPack.GetLuckChanceForKiller(this));
            }

            Effects.PlaySound(this, this.Map, this.GetDeathSound());
            Effects.SendLocationEffect(this.Location, this.Map, 0x3709, 30, 10, 0x835, 0);
            rm.MoveToWorld(this.Location, this.Map);

            this.Delete();
            return false;</pre>

## Duplicated Code. Size: 329

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Zorda.cs

<pre>this.Donations.Add(new CollectionItem(typeof(Board), 0x1BD7, 1015101, 0, 1));
            this.Donations.Add(new CollectionItem(typeof(OakBoard), 0x1BD7, 1075052, 0x7DA, 3));
            this.Donations.Add(new CollectionItem(typeof(AshBoard), 0x1BD7, 1075053, 0x4A7, 6));
            this.Donations.Add(new CollectionItem(typeof(YewBoard), 0x1BD7, 1075054, 0x4A8, 9));
            this.Donations.Add(new CollectionItem(typeof(HeartwoodBoard), 0x1BD7, 1075062, 0x4A9, 12));
            this.Donations.Add(new CollectionItem(typeof(BloodwoodBoard), 0x1BD7, 1075055, 0x4AA, 24));
            this.Donations.Add(new CollectionItem(typeof(FrostwoodBoard), 0x1BD7, 1075056, 0x47F, 48));</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\MuseumDonationBox.cs

<pre>this.Donations.Add(new CollectionItem(typeof(Board), 0x1BD7, 1015101, 0, 1));
            this.Donations.Add(new CollectionItem(typeof(OakBoard), 0x1BD7, 1075052, 0x7DA, 3));
            this.Donations.Add(new CollectionItem(typeof(AshBoard), 0x1BD7, 1075053, 0x4A7, 6));
            this.Donations.Add(new CollectionItem(typeof(YewBoard), 0x1BD7, 1075054, 0x4A8, 9));
            this.Donations.Add(new CollectionItem(typeof(HeartwoodBoard), 0x1BD7, 1075062, 0x4A9, 12));
            this.Donations.Add(new CollectionItem(typeof(BloodwoodBoard), 0x1BD7, 1075055, 0x4AA, 24));
            this.Donations.Add(new CollectionItem(typeof(FrostwoodBoard), 0x1BD7, 1075056, 0x47F, 48));</pre>

## Duplicated Code. Size: 328

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\TrapableContainer.cs

<pre>Effects.PlaySound(loc, this.Map, 0x307);

                            Effects.SendLocationEffect(new Point3D(loc.X - 1, loc.Y, loc.Z), this.Map, 0x36BD, 15);
                            Effects.SendLocationEffect(new Point3D(loc.X + 1, loc.Y, loc.Z), this.Map, 0x36BD, 15);

                            Effects.SendLocationEffect(new Point3D(loc.X, loc.Y - 1, loc.Z), this.Map, 0x36BD, 15);
                            Effects.SendLocationEffect(new Point3D(loc.X, loc.Y + 1, loc.Z), this.Map, 0x36BD, 15);

                            Effects.SendLocationEffect(new Point3D(loc.X + 1, loc.Y + 1, loc.Z + 11), this.Map, 0x36BD, 15);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Items\WrongBedrolls.cs

<pre>Effects.PlaySound(loc, this.Map, 0x307);
                                Effects.SendLocationEffect(new Point3D(loc.X - 1, loc.Y, loc.Z), this.Map, 0x36BD, 15);
                                Effects.SendLocationEffect(new Point3D(loc.X + 1, loc.Y, loc.Z), this.Map, 0x36BD, 15);
                                Effects.SendLocationEffect(new Point3D(loc.X, loc.Y - 1, loc.Z), this.Map, 0x36BD, 15);
                                Effects.SendLocationEffect(new Point3D(loc.X, loc.Y + 1, loc.Z), this.Map, 0x36BD, 15);
                                Effects.SendLocationEffect(new Point3D(loc.X + 1, loc.Y + 1, loc.Z + 11), this.Map, 0x36BD, 15);</pre>

## Duplicated Code. Size: 328

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\CommodityBrokerGump.cs

<pre>return;
				case 2: // Set Shop Name
					TextRelay tr = info.TextEntries[0];
					string text = tr.Text;

					if(!m_Broker.Plot.TrySetShopName(from, text))
						from.SendLocalizedMessage(1150775); // Shop names are limited to 40 characters in length. Shop names must pass an obscenity filter check. The text you have entered is not valid.
					break;
				case 3: // Withdraw Funds
					TextRelay tr1 = info.TextEntries[1];
					string text1 = tr1.Text;
					int amount = 0;

					try
					{
						amount = Convert.ToInt32(text1);
					}
					catch{}

					if(amount > 0)
					{
						m_Broker.TryWithdrawFunds(from, amount);
					}
					break;
				case 4: // Deposit Funds
					TextRelay tr2 = info.TextEntries[2];
					string text2 = tr2.Text;
					int amount1 = 0;

					try
					{
						amount1 = Convert.ToInt32(text2);
					}
					catch{}

					if(amount1 > 0)
					{
						m_Broker.TryDepositFunds(from, amount1);
					}
                    break;
				case 5: // ADD TO INVENTORY</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>return;
				case 2: // Set Shop Name
					TextRelay tr = info.TextEntries[0];
					string text = tr.Text;

					if(!m_Broker.Plot.TrySetShopName(from, text))
						from.SendLocalizedMessage(1150775); // Shop names are limited to 40 characters in length. Shop names must pass an obscenity filter check. The text you have entered is not valid.
					break;
				case 3: // Withdraw Funds
					TextRelay tr1 = info.TextEntries[1];
					string text1 = tr1.Text;
					int amount = 0;

					try
					{
						amount = Convert.ToInt32(text1);
					}
					catch
					{}

					if(amount > 0)
					{
						m_Broker.TryWithdrawFunds(from, amount);
					}
					break;
				case 4: // Deposit Funds
					TextRelay tr2 = info.TextEntries[2];
					string text2 = tr2.Text;
					int amount1 = 0;

					try
					{
						amount1 = Convert.ToInt32(text2);
					}
					catch{}

					if(amount1 > 0)
					{
						m_Broker.TryDepositFunds(from, amount1);
					}
					break;
				case 5: // TRANSFER STABLED PET TO MERCHANT</pre>

## Duplicated Code. Size: 328

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Reports\Rendering\HtmlRenderer.cs

<pre>html.RenderEndTag();
            html.RenderEndTag();

            html.RenderBeginTag(HtmlTag.Tr);

            html.AddAttribute(HtmlAttr.Colspan, "10");
            html.AddAttribute(HtmlAttr.Width, "100%");
            html.AddAttribute(HtmlAttr.Align, "center");
            html.AddAttribute(HtmlAttr.Class, "entry");
            html.RenderBeginTag(HtmlTag.Td);

            html.AddAttribute(HtmlAttr.Width, bmp.Width.ToString());
            html.AddAttribute(HtmlAttr.Height, bmp.Height.ToString());
            html.AddAttribute(HtmlAttr.Src, fileName);
            html.RenderBeginTag(HtmlTag.Img);
            html.RenderEndTag();

            html.RenderEndTag();
            html.RenderEndTag();

            html.RenderEndTag();
            html.RenderEndTag();
            html.RenderEndTag();
            html.RenderEndTag();

            bmp.Dispose();</pre>

Fragment 2 in file Scripts\Services\Reports\Rendering\HtmlRenderer.cs

<pre>html.RenderEndTag();
            html.RenderEndTag();

            html.RenderBeginTag(HtmlTag.Tr);

            html.AddAttribute(HtmlAttr.Colspan, "10");
            html.AddAttribute(HtmlAttr.Width, "100%");
            html.AddAttribute(HtmlAttr.Align, "center");
            html.AddAttribute(HtmlAttr.Class, "entry");
            html.RenderBeginTag(HtmlTag.Td);

            html.AddAttribute(HtmlAttr.Width, bmp.Width.ToString());
            html.AddAttribute(HtmlAttr.Height, bmp.Height.ToString());
            html.AddAttribute(HtmlAttr.Src, fileName);
            html.RenderBeginTag(HtmlTag.Img);
            html.RenderEndTag();

            html.RenderEndTag();
            html.RenderEndTag();

            html.RenderEndTag();
            html.RenderEndTag();
            html.RenderEndTag();
            html.RenderEndTag();

            bmp.Dispose();</pre>

## Duplicated Code. Size: 327

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Wisp.cs

<pre>Body = 58;
            BaseSoundID = 466;

            SetStr(196, 225);
            SetDex(196, 225);
            SetInt(196, 225);

            SetHits(118, 135);

            SetDamage(17, 18);

            SetDamageType(ResistanceType.Physical, 50);
            SetDamageType(ResistanceType.Energy, 50);

            SetResistance(ResistanceType.Physical, 35, 45);
            SetResistance(ResistanceType.Fire, 20, 40);
            SetResistance(ResistanceType.Cold, 10, 30);
            SetResistance(ResistanceType.Poison, 5, 10);
            SetResistance(ResistanceType.Energy, 50, 70);

            SetSkill(SkillName.EvalInt, 80.0);
            SetSkill(SkillName.Magery, 80.0);
            SetSkill(SkillName.MagicResist, 80.0);
            SetSkill(SkillName.Tactics, 80.0);
            SetSkill(SkillName.Wrestling, 80.0);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\MysteriousWisp.cs

<pre>Body = 58;
            BaseSoundID = 466;

            SetStr(196, 225);
            SetDex(196, 225);
            SetInt(196, 225);

            SetHits(118, 135);

            SetDamage(17, 18);

            SetDamageType(ResistanceType.Physical, 50);
            SetDamageType(ResistanceType.Energy, 50);

            SetResistance(ResistanceType.Physical, 35, 45);
            SetResistance(ResistanceType.Fire, 20, 40);
            SetResistance(ResistanceType.Cold, 10, 30);
            SetResistance(ResistanceType.Poison, 5, 10);
            SetResistance(ResistanceType.Energy, 50, 70);

            SetSkill(SkillName.EvalInt, 80.0);
            SetSkill(SkillName.Magery, 80.0);
            SetSkill(SkillName.MagicResist, 80.0);
            SetSkill(SkillName.Tactics, 80.0);
            SetSkill(SkillName.Wrestling, 80.0);</pre>

## Duplicated Code. Size: 326

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\Mahjong\Packets.cs

<pre>if (tile.Flipped)
                {
                    int hand = tile.Dimensions.GetHandArea();

                    if (hand < 0 || players.IsPublic(hand) || players.GetPlayer(hand) == to || (game.SpectatorVision && players.IsSpectator(to)))
                        this.m_Stream.Write((byte)tile.Value);
                    else
                        this.m_Stream.Write((byte)0);
                }
                else
                {
                    this.m_Stream.Write((byte)0);
                }

                this.m_Stream.Write((short)tile.Position.Y);
                this.m_Stream.Write((short)tile.Position.X);
                this.m_Stream.Write((byte)tile.StackLevel);
                this.m_Stream.Write((byte)tile.Direction);

                this.m_Stream.Write(tile.Flipped ? (byte)0x10 : (byte)0x0);</pre>

Fragment 2 in file Scripts\Items\Containers\Mahjong\Packets.cs

<pre>if (tile.Flipped)
            {
                int hand = tile.Dimensions.GetHandArea();

                if (hand < 0 || players.IsPublic(hand) || players.GetPlayer(hand) == to || (game.SpectatorVision && players.IsSpectator(to)))
                    this.m_Stream.Write((byte)tile.Value);
                else
                    this.m_Stream.Write((byte)0);
            }
            else
            {
                this.m_Stream.Write((byte)0);
            }

            this.m_Stream.Write((short)tile.Position.Y);
            this.m_Stream.Write((short)tile.Position.X);
            this.m_Stream.Write((byte)tile.StackLevel);
            this.m_Stream.Write((byte)tile.Direction);

            this.m_Stream.Write(tile.Flipped ? (byte)0x10 : (byte)0x0);</pre>

## Duplicated Code. Size: 326

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>AddButton( 20, height - 85, 0xFAE, 0xFAF, 10, GumpButtonType.Reply, 0 );
                AddImageTiled(160, height - 85, 60, 19, textentrybackground );
                AddTextEntry( 160, height - 85, 60, 25, 0, 10 ,m_gauntlet.EntryFee.ToString() );
                AddLabel( 60, height - 85, 0, XmlPoints.GetText(from, 200530) );  // "Set Entry Fee: "

                // set arena size
                AddButton( 20, height - 60, 0xFAE, 0xFAF, 20, GumpButtonType.Reply, 0 );
                AddImageTiled(160, height - 60, 30, 19, textentrybackground );
                AddTextEntry( 160, height - 60, 30, 25, 0, 20 ,m_gauntlet.ArenaSize.ToString() );
                AddLabel( 60, height - 60, 0, XmlPoints.GetText(from, 200531) );    //  "Set Arena Size: "</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>AddButton( 20, height - 85, 0xFAE, 0xFAF, 10, GumpButtonType.Reply, 0 );
                AddImageTiled( 160, height - 85, 60, 19, textentrybackground );
                AddTextEntry( 160, height - 85, 60, 25, 0, 10 ,m_gauntlet.EntryFee.ToString() );
                AddLabel( 60, height - 85, 0, XmlPoints.GetText(from, 200530) );    // "Set Entry Fee: "

                // set arena size
                AddButton( 20, height - 60, 0xFAE, 0xFAF, 20, GumpButtonType.Reply, 0 );
                AddImageTiled( 160, height - 60, 30, 19, textentrybackground );
                AddTextEntry( 160, height - 60, 30, 25, 0, 20 ,m_gauntlet.ArenaSize.ToString() );
                AddLabel( 60, height - 60, 0, XmlPoints.GetText(from, 200531) );  // "Set Arena Size: "</pre>

## Duplicated Code. Size: 326

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>{
                        line1.Location = new Point3D(X + 3, Y - 6, Z + ZSurface);
                        line2.Location = new Point3D(X - 3, Y - 6, Z + ZSurface);
                        line3.Location = new Point3D(X + 3, Y - 2, Z + ZSurface);
                        line4.Location = new Point3D(X - 3, Y - 2, Z + ZSurface);
                        line5.Location = new Point3D(X + 3, Y + 2, Z + ZSurface);
                        line6.Location = new Point3D(X - 3, Y + 2, Z + ZSurface);
                        line7.Location = new Point3D(X + 3, Y + 6, Z + ZSurface);
                        line8.Location = new Point3D(X - 3, Y + 6, Z + ZSurface);
                        break;
                    }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>{
                        line1.Location = new Point3D(X + 3, Y + 6, Z + ZSurface);
                        line2.Location = new Point3D(X - 3, Y + 6, Z + ZSurface);
                        line3.Location = new Point3D(X + 3, Y + 2, Z + ZSurface);
                        line4.Location = new Point3D(X - 3, Y + 2, Z + ZSurface);
                        line5.Location = new Point3D(X + 3, Y - 2, Z + ZSurface);
                        line6.Location = new Point3D(X - 3, Y - 2, Z + ZSurface);
                        line7.Location = new Point3D(X + 3, Y - 6, Z + ZSurface);
                        line8.Location = new Point3D(X - 3, Y - 6, Z + ZSurface);
                        break;
                    }</pre>

Fragment 3 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>{
                        line1.Location = new Point3D(X + 6, Y - 3, Z + ZSurface);
                        line2.Location = new Point3D(X + 6, Y + 3, Z + ZSurface);
                        line3.Location = new Point3D(X + 2, Y - 3, Z + ZSurface);
                        line4.Location = new Point3D(X + 2, Y + 3, Z + ZSurface);
                        line5.Location = new Point3D(X - 2, Y - 3, Z + ZSurface);
                        line6.Location = new Point3D(X - 2, Y + 3, Z + ZSurface);
                        line7.Location = new Point3D(X - 6, Y - 3, Z + ZSurface);
                        line8.Location = new Point3D(X - 6, Y + 3, Z + ZSurface);
                        break;
                    }</pre>

Fragment 4 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>{
                        line1.Location = new Point3D(X - 6, Y - 3, Z + ZSurface);
                        line2.Location = new Point3D(X - 6, Y + 3, Z + ZSurface);
                        line3.Location = new Point3D(X - 2, Y - 3, Z + ZSurface);
                        line4.Location = new Point3D(X - 2, Y + 3, Z + ZSurface);
                        line5.Location = new Point3D(X + 2, Y - 3, Z + ZSurface);
                        line6.Location = new Point3D(X + 2, Y + 3, Z + ZSurface);
                        line7.Location = new Point3D(X + 6, Y - 3, Z + ZSurface);
                        line8.Location = new Point3D(X + 6, Y + 3, Z + ZSurface);
                        break;
                    }</pre>

## Duplicated Code. Size: 325

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetColorGump.cs

<pre>private void AddRect(int index, string str, int button, int text)
		{
			var x = BorderSize + OffsetSize;
			var y = BorderSize + OffsetSize + (index * (EntryHeight + OffsetSize));

			AddImageTiled(x, y, EntryWidth, EntryHeight, EntryGumpID);
			AddLabelCropped(x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, str);

			if (text != -1)
			{
				AddTextEntry(x + 40 + TextOffsetX, y, EntryWidth - TextOffsetX - 16, EntryHeight, TextHue, text, "");
			}

			x += EntryWidth + OffsetSize;

			if (SetGumpID != 0)
			{
				AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);
			}

			if (button != 0)
			{
				AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, button, GumpButtonType.Reply, 0);
			}
		}</pre>

Fragment 2 in file Scripts\Gumps\Properties\SetDateTimeGump.cs

<pre>private void AddRect(int index, string str, int button, int text)
		{
			var x = BorderSize + OffsetSize;
			var y = BorderSize + OffsetSize + (index * (EntryHeight + OffsetSize));

			AddImageTiled(x, y, EntryWidth, EntryHeight, EntryGumpID);
			AddLabelCropped(x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, str);

			if (text != -1)
			{
				AddTextEntry(x + 40 + TextOffsetX, y, EntryWidth - TextOffsetX - 16, EntryHeight, TextHue, text, "");
			}

			x += EntryWidth + OffsetSize;

			if (SetGumpID != 0)
			{
				AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);
			}

			if (button != 0)
			{
				AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, button, GumpButtonType.Reply, 0);
			}
		}</pre>

## Duplicated Code. Size: 325

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\TigerCubEnclosure.cs

<pre>AddBackground(50, 50, 550, 440, 2600);
                AddBackground(100, 75, 450, 90, 2600);
                AddBackground(90, 175, 270, 270, 2600);
                AddBackground(100, 185, 250, 250, 5120);
                AddBackground(370, 175, 178, 200, 5120);

                AddImage(145, 95, 10451);
                AddImage(435, 95, 10451);
                AddImage(0, 50, 10400);
                AddImage(0, 200, 10401);
                AddImage(0, 360, 10402);

                AddImage(565, 50, 10410);
                AddImage(565, 200, 10411);
                AddImage(565, 360, 10412);

                AddImage(370, 175, 10452);
                AddImage(370, 360, 10452);</pre>

Fragment 2 in file Scripts\Services\Underworld\PuzzleRoom\MazePuzzleGump.cs

<pre>AddBackground(50, 50, 550, 440, 2600);
			AddBackground(100, 75, 450, 90, 2600);
            AddBackground(90, 175, 270, 270, 2600);
            AddBackground(100, 185, 250, 250, 5120);
            AddBackground(370, 175, 178, 200, 5120);

            AddImage(145, 95, 10451);
            AddImage(435, 95, 10451);
            AddImage(0, 50, 10400);
            AddImage(0, 200, 10401);
            AddImage(0, 360, 10402);

            AddImage(565, 50, 10410);
            AddImage(565, 200, 10411);
            AddImage(565, 360, 10412);

            AddImage(370, 175, 10452);
            AddImage(370, 360, 10452);</pre>

## Duplicated Code. Size: 324

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>Boots bts = new Boots();
            bts.Hue = iHue;
            this.AddItem(bts);

            ChainChest cht = new ChainChest();
            cht.Movable = false;
            cht.LootType = LootType.Newbied;
            cht.Crafter = this;
            cht.Quality = ArmorQuality.Regular;
            this.AddItem(cht);

            ChainLegs chl = new ChainLegs();
            chl.Movable = false;
            chl.LootType = LootType.Newbied;
            chl.Crafter = this;
            chl.Quality = ArmorQuality.Regular;
            this.AddItem(chl);

            PlateArms pla = new PlateArms();
            pla.Movable = false;
            pla.LootType = LootType.Newbied;
            pla.Crafter = this;
            pla.Quality = ArmorQuality.Regular;
            this.AddItem(pla);

            Bandage band = new Bandage(50);
            this.AddToBackpack(band);</pre>

Fragment 2 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>Boots bts = new Boots();
            bts.Hue = iHue;
            this.AddItem(bts);

            ChainChest cht = new ChainChest();
            cht.Movable = false;
            cht.LootType = LootType.Newbied;
            cht.Crafter = this;
            cht.Quality = ArmorQuality.Regular;
            this.AddItem(cht);

            ChainLegs chl = new ChainLegs();
            chl.Movable = false;
            chl.LootType = LootType.Newbied;
            chl.Crafter = this;
            chl.Quality = ArmorQuality.Regular;
            this.AddItem(chl);

            PlateArms pla = new PlateArms();
            pla.Movable = false;
            pla.LootType = LootType.Newbied;
            pla.Crafter = this;
            pla.Quality = ArmorQuality.Regular;
            this.AddItem(pla);

            Bandage band = new Bandage(50);
            this.AddToBackpack(band);</pre>

## Duplicated Code. Size: 324

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>{
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10119, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075626, LabelColor, false, false);       //Reflect Physical Damage
                    yOffset += 1;

                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10121, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1061153, LabelColor, false, false);       //Luck
                    yOffset += 1;

                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10123, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1015168, LabelColor, false, false);       //Night Sight
                    yOffset += 1;
                }</pre>

Fragment 2 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>{
                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10119, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075626, LabelColor, false, false);       //Reflect Physical Damage
                    yOffset += 1;

                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10121, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1061153, LabelColor, false, false);       //Luck
                    yOffset += 1;

                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10123, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1015168, LabelColor, false, false);       //Night Sight
                    yOffset += 1;
                }</pre>

## Duplicated Code. Size: 323

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SpecialFishingNet.cs

<pre>int x = p.X, y = p.Y;

            for (int j = 0; j < 20; ++j)
            {
                int tx = p.X - 2 + Utility.Random(5);
                int ty = p.Y - 2 + Utility.Random(5);

                LandTile t = map.Tiles.GetLandTile(tx, ty);

                if (t.Z == p.Z && ((t.ID >= 0xA8 && t.ID <= 0xAB) || (t.ID >= 0x136 && t.ID <= 0x137)) && !Spells.SpellHelper.CheckMulti(new Point3D(tx, ty, p.Z), map))
                {
                    x = tx;
                    y = ty;
                    break;
                }
            }

            spawn.MoveToWorld(new Point3D(x, y, p.Z), map);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\SpecialSalvageHook.cs

<pre>int x = p.X, y = p.Y;

            for (int j = 0; j < 20; ++j)
            {
                int tx = p.X - 2 + Utility.Random(5);
                int ty = p.Y - 2 + Utility.Random(5);

                LandTile t = map.Tiles.GetLandTile(tx, ty);

                if (t.Z == p.Z && ((t.ID >= 0xA8 && t.ID <= 0xAB) || (t.ID >= 0x136 && t.ID <= 0x137)) && !Spells.SpellHelper.CheckMulti(new Point3D(tx, ty, p.Z), map))
                {
                    x = tx;
                    y = ty;
                    break;
                }
            }

            spawn.MoveToWorld(new Point3D(x, y, p.Z), map);</pre>

## Duplicated Code. Size: 323

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>{
			if (o == null || attachments == null || o.Deleted) return null;

			List<XmlAttachment> list;
			if(!attachments.TryGetValue(o, out list) || list==null)
				return null;

			if (type == null && name == null)
			{
				if(original)
					return list;
				else
					return list.GetRange(0, list.Count);
			}
			else
			{
				// just get those of a particular type and/or name
				List<XmlAttachment> newlist = new List<XmlAttachment>();

				foreach (XmlAttachment i in list)
				{
					// see if it is deleted
					if (i == null || i.Deleted)
						continue;

					Type itype = i.GetType();

					if ((type == null || (itype != null && (itype == type || itype.IsSubclassOf(type)))) && (name == null || (name == i.Name)))
					{
						newlist.Add(i);
					}
				}

				return newlist;
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>{
			if (o == null || attachments == null || o.Deleted) return null;

			List<XmlAttachment> list;
			if(!attachments.TryGetValue(o, out list) || list==null)
				return null;

			if (type == null && name == null)
			{
				if(original)
					return list;
				else
					return list.GetRange(0, list.Count);
			}
			else
			{
				// just get those of a particular type and/or name
				List<XmlAttachment> newlist = new List<XmlAttachment>();

				foreach (XmlAttachment i in list)
				{
					// see if it is deleted
					if (i == null || i.Deleted)
						continue;

					Type itype = i.GetType();

					if ((type == null || (itype != null && (itype == type || itype.IsSubclassOf(type)))) && (name == null || (name == i.Name)))
					{
						newlist.Add(i);
					}
				}

				return newlist;
			}
		}</pre>

## Duplicated Code. Size: 323

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GreenGoblin.cs

<pre>switch ( Utility.Random(20) )
            {
                case 0:
                    PackItem(new Scimitar());
                    break;
                case 1:
                    PackItem(new Katana());
                    break;
                case 2:
                    PackItem(new WarMace());
                    break;
                case 3:
                    PackItem(new WarHammer());
                    break;
                case 4:
                    PackItem(new Kryss());
                    break;
                case 5:
                    PackItem(new Pitchfork());
                    break;
            }

            PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    PackItem(new Ribs());
                    break;
                case 1:
                    PackItem(new Shaft());
                    break;
                case 2:
                    PackItem(new Candle());
                    break;
            }

            if (0.2 > Utility.RandomDouble())
                PackItem(new BolaBall());</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GreenGoblinAlchemist.cs

<pre>switch ( Utility.Random(20) )
            {
                case 0:
                    PackItem(new Scimitar());
                    break;
                case 1:
                    PackItem(new Katana());
                    break;
                case 2:
                    PackItem(new WarMace());
                    break;
                case 3:
                    PackItem(new WarHammer());
                    break;
                case 4:
                    PackItem(new Kryss());
                    break;
                case 5:
                    PackItem(new Pitchfork());
                    break;
            }

            PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    PackItem(new Ribs());
                    break;
                case 1:
                    PackItem(new Shaft());
                    break;
                case 2:
                    PackItem(new Candle());
                    break;
            }

            if (0.2 > Utility.RandomDouble())
                PackItem(new BolaBall());</pre>

Fragment 3 in file Scripts\Mobiles\Normal\Orc.cs

<pre>switch ( Utility.Random(20) )
            {
                case 0:
                    PackItem(new Scimitar());
                    break;
                case 1:
                    PackItem(new Katana());
                    break;
                case 2:
                    PackItem(new WarMace());
                    break;
                case 3:
                    PackItem(new WarHammer());
                    break;
                case 4:
                    PackItem(new Kryss());
                    break;
                case 5:
                    PackItem(new Pitchfork());
                    break;
            }

            PackItem(new ThighBoots());

            switch ( Utility.Random(3) )
            {
                case 0:
                    PackItem(new Ribs());
                    break;
                case 1:
                    PackItem(new Shaft());
                    break;
                case 2:
                    PackItem(new Candle());
                    break;
            }

            if (0.2 > Utility.RandomDouble())
                PackItem(new BolaBall());</pre>

## Duplicated Code. Size: 322

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\CopperElemental.cs

<pre>this.BaseSoundID = 268;

            this.SetStr(226, 255);
            this.SetDex(126, 145);
            this.SetInt(71, 92);

            this.SetHits(136, 153);

            this.SetDamage(9, 16);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 30, 40);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 10, 20);

            this.SetSkill(SkillName.MagicResist, 50.1, 95.0);
            this.SetSkill(SkillName.Tactics, 60.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 100.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ShadowIronElemental.cs

<pre>this.BaseSoundID = 268;

            this.SetStr(226, 255);
            this.SetDex(126, 145);
            this.SetInt(71, 92);

            this.SetHits(136, 153);

            this.SetDamage(9, 16);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 30, 40);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 10, 20);
            this.SetResistance(ResistanceType.Energy, 30, 40);

            this.SetSkill(SkillName.MagicResist, 50.1, 95.0);
            this.SetSkill(SkillName.Tactics, 60.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 100.0);</pre>

## Duplicated Code. Size: 322

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>{
                if (item is MaabusCoffin)
                {
                    MaabusCoffin coffin = (MaabusCoffin)item;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("SpawnLocation"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                coffin.SpawnLocation = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                        }
                    }
                }
                else if (this.m_ItemID > 0)
                {
                    List<AddonComponent> comps = ((BaseAddon)item).Components;

                    for (int i = 0; i < comps.Count; ++i)
                    {
                        AddonComponent comp = (AddonComponent)comps[i];

                        if (comp.Offset == Point3D.Zero)
                            comp.ItemID = this.m_ItemID;
                    }
                }
            }</pre>

Fragment 2 in file Scripts\Commands\DecorateDelete.cs

<pre>{
                if (item is MaabusCoffin)
                {
                    MaabusCoffin coffin = (MaabusCoffin)item;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("SpawnLocation"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                coffin.SpawnLocation = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                        }
                    }
                }
                else if (this.m_ItemID > 0)
                {
                    List<AddonComponent> comps = ((BaseAddon)item).Components;

                    for (int i = 0; i < comps.Count; ++i)
                    {
                        AddonComponent comp = (AddonComponent)comps[i];

                        if (comp.Offset == Point3D.Zero)
                            comp.ItemID = this.m_ItemID;
                    }
                }
            }</pre>

Fragment 3 in file Scripts\Commands\DecorateMag.cs

<pre>{
                if (item is MaabusCoffin)
                {
                    MaabusCoffin coffin = (MaabusCoffin)item;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("SpawnLocation"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                coffin.SpawnLocation = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                        }
                    }
                }
                else if (this.m_ItemID > 0)
                {
                    List<AddonComponent> comps = ((BaseAddon)item).Components;

                    for (int i = 0; i < comps.Count; ++i)
                    {
                        AddonComponent comp = (AddonComponent)comps[i];

                        if (comp.Offset == Point3D.Zero)
                            comp.ItemID = this.m_ItemID;
                    }
                }
            }</pre>

## Duplicated Code. Size: 321

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MeleeAI.cs

<pre>if (this.MoveTo(combatant, true, this.m_Mobile.RangeFight))
            {
                this.m_Mobile.Direction = this.m_Mobile.GetDirectionTo(combatant);
            }
            else if (this.AcquireFocusMob(this.m_Mobile.RangePerception, this.m_Mobile.FightMode, false, false, true))
            {
                if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("My move is blocked, so I am going to attack {0}", this.m_Mobile.FocusMob.Name);

                this.m_Mobile.Combatant = this.m_Mobile.FocusMob;
                this.Action = ActionType.Combat;

                return true;
            }
            else if (this.m_Mobile.GetDistanceToSqrt(combatant) > this.m_Mobile.RangePerception + 1)
            {
                if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("I cannot find {0}, so my guard is up", combatant.Name);

                this.Action = ActionType.Guard;

                return true;
            }
            else
            {
                if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("I should be closer to {0}", combatant.Name);
            }</pre>

Fragment 2 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>if (this.MoveTo(combatant, true, this.m_Mobile.RangeFight))
            {
                this.m_Mobile.Direction = this.m_Mobile.GetDirectionTo(combatant);
            }
            else if (this.AcquireFocusMob(this.m_Mobile.RangePerception, this.m_Mobile.FightMode, false, false, true))
            {
                if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("My move is blocked, so I am going to attack {0}", this.m_Mobile.FocusMob.Name);

                this.m_Mobile.Combatant = this.m_Mobile.FocusMob;
                this.Action = ActionType.Combat;

                return true;
            }
            else if (this.m_Mobile.GetDistanceToSqrt(combatant) > this.m_Mobile.RangePerception + 1)
            {
                if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("I cannot find {0}, so my guard is up", combatant.Name);

                this.Action = ActionType.Guard;

                return true;
            }
            else
            {
                if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("I should be closer to {0}", combatant.Name);
            }</pre>

## Duplicated Code. Size: 317

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\AcidSlime.cs

<pre>private void OnTick()
        {
            DateTime now = DateTime.UtcNow;
            TimeSpan age = now - this.m_Created;

            if (age > this.m_Duration)
            {
                this.Delete();
            }
            else
            {
                if (!this.m_Drying && age > (this.m_Duration - age))
                {
                    this.m_Drying = true;
                    this.ItemID = 0x122B;
                }

                List<Mobile> toDamage = new List<Mobile>();

                foreach (Mobile m in this.GetMobilesInRange(0))
                {
                    BaseCreature bc = m as BaseCreature;
                    if (m.Alive && !m.IsDeadBondedPet && (bc == null || bc.Controlled || bc.Summoned))
                    {
                        toDamage.Add(m);
                    }
                }

                for (int i = 0; i < toDamage.Count; i++)
                    this.Damage(toDamage[i]);
            }
        }</pre>

Fragment 2 in file Scripts\Items\Internal\PoolOfAcid.cs

<pre>private void OnTick()
        {
            DateTime now = DateTime.UtcNow;
            TimeSpan age = now - this.m_Created;

            if (age > this.m_Duration)
            {
                this.Delete();
            }
            else
            {
                if (!this.m_Drying && age > (this.m_Duration - age))
                {
                    this.m_Drying = true;
                    this.ItemID = 0x122B;
                }

                List<Mobile> toDamage = new List<Mobile>();

                foreach (Mobile m in this.GetMobilesInRange(0))
                {
                    BaseCreature bc = m as BaseCreature;

                    if (m.Alive && !m.IsDeadBondedPet && (bc == null || bc.Controlled || bc.Summoned))
                    {
                        toDamage.Add(m);
                    }
                }

                for (int i = 0; i < toDamage.Count; i++)
                    this.Damage(toDamage[i]);
            }
        }</pre>

## Duplicated Code. Size: 317

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>double drop_probability = 1;
								int hue = 0x3b2;
								int font = 3;
								if (keywordargs.Length > 1)
								{
									if(!double.TryParse(keywordargs[1], NumberStyles.Any, CultureInfo.InvariantCulture, out drop_probability))
									{ status_str = "Invalid msg probability : " + arglist[1]; no_error = false; }
								}
								if (keywordargs.Length > 2)
								{
									if(!int.TryParse(keywordargs[2], out hue))
									{ status_str = "Invalid MSG hue : " + arglist[1]; no_error = false; }
								}
								if (keywordargs.Length > 3)
								{
									if(!int.TryParse(keywordargs[3], out font))
									{ status_str = "Invalid MSG font : " + arglist[1]; no_error = false; }
								}
								if (hue < 0) hue = 0;
								if (font < 0) font = 0;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>double drop_probability = 1;
								int hue = 0x3b2;
								int font = 3;
								if (keywordargs.Length > 1)
								{
									if(!double.TryParse(keywordargs[1], NumberStyles.Any, CultureInfo.InvariantCulture, out drop_probability))
									{ status_str = "Invalid msg probability : " + arglist[1]; no_error = false; }
								}
								if (keywordargs.Length > 2)
								{
									if(!int.TryParse(keywordargs[2], out hue))
									{ status_str = "Invalid MSG hue : " + arglist[1]; no_error = false; }
								}
								if (keywordargs.Length > 3)
								{
									if(!int.TryParse(keywordargs[3], out font))
									{ status_str = "Invalid MSG font : " + arglist[1]; no_error = false; }
								}
								if (hue < 0) hue = 0;
								if (font < 0) font = 0;</pre>

## Duplicated Code. Size: 316

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>{
                if (m_ReforgedPrefix != ReforgedPrefix.None)
                {
                    int prefix = RunicReforging.GetPrefixName(m_ReforgedPrefix);

                    if (m_ReforgedSuffix == ReforgedSuffix.None)
                        list.Add(1151757, String.Format("#{0}\t{1}", prefix, GetNameString())); // ~1_PREFIX~ ~2_ITEM~
                    else
                        list.Add(1151756, String.Format("#{0}\t{1}\t#{2}", prefix, GetNameString(), RunicReforging.GetSuffixName(m_ReforgedSuffix))); // ~1_PREFIX~ ~2_ITEM~ of ~3_SUFFIX~
                }
                else if (m_ReforgedSuffix != ReforgedSuffix.None)
                {
                    if (m_ReforgedSuffix == ReforgedSuffix.Blackthorn)
                        list.Add(1154548, String.Format("{0}", GetNameString())); // ~1_TYPE~ bearing the crest of Blackthorn
                    else if (m_ReforgedSuffix == ReforgedSuffix.Minax)
                        list.Add(1154507, String.Format("{0}", GetNameString())); // ~1_ITEM~ bearing the crest of Minax
                    else
                        list.Add(1151758, String.Format("{0}\t#{1}", GetNameString(), RunicReforging.GetSuffixName(m_ReforgedSuffix))); // ~1_ITEM~ of ~2_SUFFIX~
                }
            }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>{
                if (m_ReforgedPrefix != ReforgedPrefix.None)
                {
                    int prefix = RunicReforging.GetPrefixName(m_ReforgedPrefix);

                    if (m_ReforgedSuffix == ReforgedSuffix.None)
                        list.Add(1151757, String.Format("#{0}\t{1}", prefix, GetNameString())); // ~1_PREFIX~ ~2_ITEM~
                    else
                        list.Add(1151756, String.Format("#{0}\t{1}\t#{2}", prefix, GetNameString(), RunicReforging.GetSuffixName(m_ReforgedSuffix))); // ~1_PREFIX~ ~2_ITEM~ of ~3_SUFFIX~
                }
                else if (m_ReforgedSuffix != ReforgedSuffix.None)
                {
                    if (m_ReforgedSuffix == ReforgedSuffix.Blackthorn)
                        list.Add(1154548, String.Format("{0}", GetNameString())); // ~1_TYPE~ bearing the crest of Blackthorn
                    else if (m_ReforgedSuffix == ReforgedSuffix.Minax)
                        list.Add(1154507, String.Format("{0}", GetNameString())); // ~1_ITEM~ bearing the crest of Minax
                    else
                        list.Add(1151758, String.Format("{0}\t#{1}", GetNameString(), RunicReforging.GetSuffixName(m_ReforgedSuffix))); // ~1_ITEM~ of ~2_SUFFIX~
                }
            }</pre>

## Duplicated Code. Size: 316

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\SilverSerpent.cs

<pre>this.SetDamage(5, 21);

            this.SetDamageType(ResistanceType.Physical, 50);
            this.SetDamageType(ResistanceType.Poison, 50);

            this.SetResistance(ResistanceType.Physical, 35, 45);
            this.SetResistance(ResistanceType.Fire, 5, 10);
            this.SetResistance(ResistanceType.Cold, 5, 10);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 5, 10);

            this.SetSkill(SkillName.Poisoning, 90.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 95.1, 100.0);
            this.SetSkill(SkillName.Tactics, 80.1, 95.0);
            this.SetSkill(SkillName.Wrestling, 85.1, 100.0);

            this.Fame = 7000;
            this.Karma = -7000;

            this.VirtualArmor = 40;</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\SeaSnake.cs

<pre>this.SetDamage(5, 21);

            this.SetDamageType(ResistanceType.Physical, 50);
            this.SetDamageType(ResistanceType.Poison, 50);

            this.SetResistance(ResistanceType.Physical, 35, 45);
            this.SetResistance(ResistanceType.Fire, 5, 10);
            this.SetResistance(ResistanceType.Cold, 5, 10);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 5, 10);

            this.SetSkill(SkillName.Poisoning, 90.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 95.1, 100.0);
            this.SetSkill(SkillName.Tactics, 80.1, 95.0);
            this.SetSkill(SkillName.Wrestling, 85.1, 100.0);

            this.Fame = 7000;
            this.Karma = -7000;

            this.VirtualArmor = 40;</pre>

## Duplicated Code. Size: 316

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\ExodusSummoningRite.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.Lifespan > 0)
            {
                TimeSpan t = TimeSpan.FromSeconds(this.m_Lifespan);

                int weeks = (int)t.Days / 7;
                int days = t.Days;
                int hours = t.Hours;
                int minutes = t.Minutes;

                if (weeks > 1)
                    list.Add(1153092, weeks.ToString()); // Lifespan: ~1_val~ weeks
                else if (days > 1)
                    list.Add(1153091, days.ToString()); // Lifespan: ~1_val~ days
                else if (hours > 1)
                    list.Add(1153090, hours.ToString()); // Lifespan: ~1_val~ hours
                else if (minutes > 1)
                    list.Add(1153089, minutes.ToString()); // Lifespan: ~1_val~ minutes
                else
                    list.Add(1072517, this.m_Lifespan.ToString()); // Lifespan: ~1_val~ seconds
            }
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\RobeofRite.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.Lifespan > 0)
            {
                TimeSpan t = TimeSpan.FromSeconds(this.m_Lifespan);

                int weeks = (int)t.Days / 7;
                int days = t.Days;
                int hours = t.Hours;
                int minutes = t.Minutes;

                if (weeks > 1)
                    list.Add(1153092, weeks.ToString()); // Lifespan: ~1_val~ weeks
                else if (days > 1)
                    list.Add(1153091, days.ToString()); // Lifespan: ~1_val~ days
                else if (hours > 1)
                    list.Add(1153090, hours.ToString()); // Lifespan: ~1_val~ hours
                else if (minutes > 1)
                    list.Add(1153089, minutes.ToString()); // Lifespan: ~1_val~ minutes
                else
                    list.Add(1072517, this.m_Lifespan.ToString()); // Lifespan: ~1_val~ seconds
            }
        }</pre>

## Duplicated Code. Size: 316

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\VeteranRewards\CrystalPortals\CorruptedCrystalPortal.cs

<pre>public virtual bool ValidateUse(Mobile m, bool message)
		{
			if (Movable)
			{
				if (message)
				{
					m.SendMessage("This must be locked down in a house to use!");
				}

				return false;
			}

			if (Sigil.ExistsOn(m))
			{
				if (message)
				{
					m.SendLocalizedMessage(1061632); // You can't do that while carrying the sigil.
				}

				return false;
			}

			if (WeightOverloading.IsOverloaded(m))
			{
				if (message)
				{
					m.SendLocalizedMessage(502359, "", 0x22); // Thou art too encumbered to move.
				}

				return false;
			}

			if (m.Criminal)
			{
				if (message)
				{
					m.SendLocalizedMessage(1005561, "", 0x22); // Thou'rt a criminal and cannot escape so easily.
				}

				return false;
			}

			if (SpellHelper.CheckCombat(m))
			{
				if (message)
				{
					m.SendLocalizedMessage(1005564, "", 0x22); // Wouldst thou flee during the heat of battle??
				}

				return false;
			}

			if (m.Spell != null)
			{
				if (message)
				{
					m.SendLocalizedMessage(1049616); // You are too busy to do that at the moment.
				}

				return false;
			}

			return true;
		}</pre>

Fragment 2 in file Scripts\Services\VeteranRewards\CrystalPortals\CrystalPortal.cs

<pre>public virtual bool ValidateUse(Mobile m, bool message)
		{
			if (Movable)
			{
				if (message)
				{
					m.SendMessage("This must be locked down in a house to use!");
				}

				return false;
			}

			if (Sigil.ExistsOn(m))
			{
				if (message)
				{
					m.SendLocalizedMessage(1061632); // You can't do that while carrying the sigil.
				}

				return false;
			}

			if (WeightOverloading.IsOverloaded(m))
			{
				if (message)
				{
					m.SendLocalizedMessage(502359, "", 0x22); // Thou art too encumbered to move.
				}

				return false;
			}

			if (m.Criminal)
			{
				if (message)
				{
					m.SendLocalizedMessage(1005561, "", 0x22); // Thou'rt a criminal and cannot escape so easily.
				}

				return false;
			}

			if (SpellHelper.CheckCombat(m))
			{
				if (message)
				{
					m.SendLocalizedMessage(1005564, "", 0x22); // Wouldst thou flee during the heat of battle??
				}

				return false;
			}

			if (m.Spell != null)
			{
				if (message)
				{
					m.SendLocalizedMessage(1049616); // You are too busy to do that at the moment.
				}

				return false;
			}

			return true;
		}</pre>

## Duplicated Code. Size: 315

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DungeonHitchingPost.cs

<pre>public static int GetMaxStabled(Mobile from)
        {
            double taming = from.Skills[SkillName.AnimalTaming].Value;
            double anlore = from.Skills[SkillName.AnimalLore].Value;
            double vetern = from.Skills[SkillName.Veterinary].Value;
            double sklsum = taming + anlore + vetern;

            int max;

            if (sklsum >= 240.0)
                max = 5;
            else if (sklsum >= 200.0)
                max = 4;
            else if (sklsum >= 160.0)
                max = 3;
            else
                max = 2;

            if (taming >= 100.0)
                max += (int)((taming - 90.0) / 10);

            if (anlore >= 100.0)
                max += (int)((anlore - 90.0) / 10);

            if (vetern >= 100.0)
                max += (int)((vetern - 90.0) / 10);

            return max;
        }</pre>

Fragment 2 in file Scripts\Items\Addons\HitchingPost.cs

<pre>public static int GetMaxStabled(Mobile from)
        {
            double taming = from.Skills[SkillName.AnimalTaming].Value;
            double anlore = from.Skills[SkillName.AnimalLore].Value;
            double vetern = from.Skills[SkillName.Veterinary].Value;
            double sklsum = taming + anlore + vetern;

            int max;

            if (sklsum >= 240.0)
                max = 5;
            else if (sklsum >= 200.0)
                max = 4;
            else if (sklsum >= 160.0)
                max = 3;
            else
                max = 2;

            if (taming >= 100.0)
                max += (int)((taming - 90.0) / 10);

            if (anlore >= 100.0)
                max += (int)((anlore - 90.0) / 10);

            if (vetern >= 100.0)
                max += (int)((vetern - 90.0) / 10);

            return max;
        }</pre>

## Duplicated Code. Size: 315

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\TreasuresOfTokuno\TreasuresOfTokuno.cs

<pre>new TypeTileButtonInfo[]
            {
                new TypeTileButtonInfo(typeof(SwordsOfProsperity), 0x27A9, 1070963, 1071002),
                new TypeTileButtonInfo(typeof(SwordOfTheStampede), 0x27A2, 1070964, 1070978),
                new TypeTileButtonInfo(typeof(WindsEdge), 0x27A3, 1070965, 1071003),
                new TypeTileButtonInfo(typeof(DarkenedSky), 0x27AD, 1070966, 1071004),
                new TypeTileButtonInfo(typeof(TheHorselord), 0x27A5, 1070967, 1071005),
                new TypeTileButtonInfo(typeof(RuneBeetleCarapace), 0x277D, 1070968, 1071006),
                new TypeTileButtonInfo(typeof(KasaOfTheRajin), 0x2798, 1070969, 1071007),
                new TypeTileButtonInfo(typeof(Stormgrip), 0x2792, 1070970, 1071008),
                new TypeTileButtonInfo(typeof(TomeOfLostKnowledge), 0x0EFA, 0x530, 1070971, 1071009),
                new TypeTileButtonInfo(typeof(PigmentsOfTokuno), 0x0EFF, 1070933, 1071011)
            }</pre>

Fragment 2 in file Scripts\Services\TreasuresOfTokuno\TreasuresOfTokuno.cs

<pre>new TypeTileButtonInfo[]
            {
                new TypeTileButtonInfo(typeof(SwordsOfProsperity), 0x27A9, 1070963, 1071002),
                new TypeTileButtonInfo(typeof(SwordOfTheStampede), 0x27A2, 1070964, 1070978),
                new TypeTileButtonInfo(typeof(WindsEdge), 0x27A3, 1070965, 1071003),
                new TypeTileButtonInfo(typeof(DarkenedSky), 0x27AD, 1070966, 1071004),
                new TypeTileButtonInfo(typeof(TheHorselord), 0x27A5, 1070967, 1071005),
                new TypeTileButtonInfo(typeof(RuneBeetleCarapace), 0x277D, 1070968, 1071006),
                new TypeTileButtonInfo(typeof(KasaOfTheRajin), 0x2798, 1070969, 1071007),
                new TypeTileButtonInfo(typeof(Stormgrip), 0x2792, 1070970, 1071008),
                new TypeTileButtonInfo(typeof(TomeOfLostKnowledge), 0x0EFA, 0x530, 1070971, 1071009),
                new TypeTileButtonInfo(typeof(PigmentsOfTokuno), 0x0EFF, 1070933, 1071011)
            }</pre>

## Duplicated Code. Size: 314

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Executioner.cs

<pre>this.SetStr(386, 400);
            this.SetDex(151, 165);
            this.SetInt(161, 175);

            this.SetDamage(8, 10);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 35, 45);
            this.SetResistance(ResistanceType.Fire, 25, 30);
            this.SetResistance(ResistanceType.Cold, 25, 30);
            this.SetResistance(ResistanceType.Poison, 10, 20);
            this.SetResistance(ResistanceType.Energy, 10, 20);

            this.SetSkill(SkillName.Anatomy, 125.0);
            this.SetSkill(SkillName.Fencing, 46.0, 77.5);
            this.SetSkill(SkillName.Macing, 35.0, 57.5);
            this.SetSkill(SkillName.Poisoning, 60.0, 82.5);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Mobile\DemonicJailor.cs

<pre>this.SetStr(386, 400);
            this.SetDex(151, 165);
            this.SetInt(161, 175);

            this.SetDamage(8, 10);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 35, 45);
            this.SetResistance(ResistanceType.Fire, 25, 30);
            this.SetResistance(ResistanceType.Cold, 25, 30);
            this.SetResistance(ResistanceType.Poison, 10, 20);
            this.SetResistance(ResistanceType.Energy, 10, 20);

            this.SetSkill(SkillName.Anatomy, 125.0);
            this.SetSkill(SkillName.Fencing, 46.0, 77.5);
            this.SetSkill(SkillName.Macing, 35.0, 57.5);
            this.SetSkill(SkillName.Poisoning, 60.0, 82.5);</pre>

## Duplicated Code. Size: 314

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>public virtual string ExpirationString
		{
			get
			{
				if (AlreadyDone)
				{
                    return "Already done";
				}
				else
					if (m_ExpirationDuration <= 0)
					{
                        return "Never expires";
					}
					else
						if (IsExpired)
						{
                            return "Expired";
						}
						else
						{
							TimeSpan ts = ExpiresIn;

							int days = (int)ts.TotalDays;
							int hours = (int)(ts - TimeSpan.FromDays(days)).TotalHours;
							int minutes = (int)(ts - TimeSpan.FromHours(hours)).TotalMinutes;
							int seconds = (int)(ts - TimeSpan.FromMinutes(minutes)).TotalSeconds;

							if (days > 0)
							{
                                return String.Format("Expires in {0} days {1} hrs", days, hours);
							}
							else
								if (hours > 0)
								{
                                    return String.Format("Expires in {0} hrs {1} mins", hours, minutes);
								}
								else
								{
                                    return String.Format("Expires in {0} mins {1} secs", minutes, seconds);
								}
						}
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>public virtual string ExpirationString
        {
            get
            {
                if (AlreadyDone)
                {
                    return "Already done";
                }
                else
                    if (m_ExpirationDuration <= 0)
                    {
                        return "Never expires";
                    }
                    else
                        if (IsExpired)
                        {
                            return "Expired";
                        }
                        else
                        {
                            TimeSpan ts = ExpiresIn;

                            int days = (int)ts.TotalDays;
                            int hours = (int)(ts - TimeSpan.FromDays(days)).TotalHours;
                            int minutes = (int)(ts - TimeSpan.FromHours(hours)).TotalMinutes;
                            int seconds = (int)(ts - TimeSpan.FromMinutes(minutes)).TotalSeconds;

                            if (days > 0)
                            {
                                return String.Format("Expires in {0} days {1} hrs", days, hours);
                            }
                            else
                                if (hours > 0)
                                {
                                    return String.Format("Expires in {0} hrs {1} mins", hours, minutes);
                                }
                                else
                                {
                                    return String.Format("Expires in {0} mins {1} secs", minutes, seconds);
                                }
                        }
            }
        }</pre>

## Duplicated Code. Size: 314

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\Attachments\XmlSockets.cs

<pre>int level = Utility.Random(1000);

				if(level < (int)(chance5*10))
					XmlAttach.AttachTo(target, new XmlSockets(5));
				else
					if(level < (int)(chance4 + chance5)*10)
					XmlAttach.AttachTo(target, new XmlSockets(4));
				else
					if(level < (int)(chance3 + chance4)*10)
					XmlAttach.AttachTo(target, new XmlSockets(3));
				else
					if(level < (int)(chance2 + chance3)*10)
					XmlAttach.AttachTo(target, new XmlSockets(2));
				else
					if(level < (int)(chance1 + chance2)*10)
					XmlAttach.AttachTo(target, new XmlSockets(1));

				// compute chance of being socketable
				int socklevel = Utility.Random(1000);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\Attachments\XmlSockets.cs

<pre>int level = Utility.Random(1000);

				if(level < (int)(chance5*10))
					XmlAttach.AttachTo(target, new XmlSockets(5));
				else
					if(level < (int)(chance4 + chance5)*10)
					XmlAttach.AttachTo(target, new XmlSockets(4));
				else
					if(level < (int)(chance3 + chance4)*10)
					XmlAttach.AttachTo(target, new XmlSockets(3));
				else
					if(level < (int)(chance2 + chance3)*10)
					XmlAttach.AttachTo(target, new XmlSockets(2));
				else
					if(level < (int)(chance1 + chance2)*10)
					XmlAttach.AttachTo(target, new XmlSockets(1));

				// compute chance of being socketable
				int socklevel = Utility.Random(1000);</pre>

## Duplicated Code. Size: 313

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10112, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075619, LabelColor, false, false);       //Weapon Damage Increase
                    yOffset += 1;

                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10101, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075620, LabelColor, false, false);       //Defense Chance Increase
                    yOffset += 1;

                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10102, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075616, LabelColor, false, false);       //Hit Chance Increase</pre>

Fragment 2 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10112, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075619, LabelColor, false, false);       //Weapon Damage Increase
                    yOffset += 1;

                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10101, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075620, LabelColor, false, false);       //Defense Chance Increase
                    yOffset += 1;

                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10102, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075616, LabelColor, false, false);       //Hit Chance Increase</pre>

## Duplicated Code. Size: 313

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>int dir = GetValueForDirection(direction);

            Static tile1 = AddCannonTile(new Static(m_CannonTileIDs[dir][0]));
            Static tile2 = AddCannonTile(new Static(m_CannonTileIDs[dir][1]));
            Static tile3 = AddCannonTile(new Static(m_CannonTileIDs[dir][2]));
            Static tile4 = AddCannonTile(new Static(m_CannonTileIDs[dir][3]));
            Static tile5 = AddCannonTile(new Static(m_CannonTileIDs[dir][4]));
            Static tile6 = AddCannonTile(new Static(m_CannonTileIDs[dir][5]));
            Static tile7 = AddCannonTile(new Static(m_CannonTileIDs[dir][6]));</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>int dir = GetValueForDirection(direction);

            Static tile1 = AddCannonTile(new Static(m_CannonTileIDs[dir][0]));
            Static tile2 = AddCannonTile(new Static(m_CannonTileIDs[dir][1]));
            Static tile3 = AddCannonTile(new Static(m_CannonTileIDs[dir][2]));
            Static tile4 = AddCannonTile(new Static(m_CannonTileIDs[dir][3]));
            Static tile5 = AddCannonTile(new Static(m_CannonTileIDs[dir][4]));
            Static tile6 = AddCannonTile(new Static(m_CannonTileIDs[dir][5]));
            Static tile7 = AddCannonTile(new Static(m_CannonTileIDs[dir][6]));</pre>

Fragment 3 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>int dir = GetValueForDirection(direction);

            Static tile1 = AddCannonTile(new Static(m_CannonTileIDs[dir][0]));
            Static tile2 = AddCannonTile(new Static(m_CannonTileIDs[dir][1]));
            Static tile3 = AddCannonTile(new Static(m_CannonTileIDs[dir][2]));
            Static tile4 = AddCannonTile(new Static(m_CannonTileIDs[dir][3]));
            Static tile5 = AddCannonTile(new Static(m_CannonTileIDs[dir][4]));
            Static tile6 = AddCannonTile(new Static(m_CannonTileIDs[dir][5]));
            Static tile7 = AddCannonTile(new Static(m_CannonTileIDs[dir][6]));</pre>

## Duplicated Code. Size: 311

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\OgreLord.cs

<pre>this.SetStr(767, 945);
            this.SetDex(66, 75);
            this.SetInt(46, 70);

            this.SetHits(476, 552);

            this.SetDamage(20, 25);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 40, 50);

            this.SetSkill(SkillName.MagicResist, 125.1, 140.0);
            this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 90.1, 100.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\StoneMonster.cs

<pre>this.SetStr(767, 945);
                this.SetDex(66, 75);
                this.SetInt(46, 70);

                this.SetHits(476, 552);

                this.SetDamage(20, 25);

                this.SetDamageType(ResistanceType.Physical, 100);

                this.SetResistance(ResistanceType.Physical, 45, 55);
                this.SetResistance(ResistanceType.Fire, 30, 40);
                this.SetResistance(ResistanceType.Cold, 30, 40);
                this.SetResistance(ResistanceType.Poison, 40, 50);
                this.SetResistance(ResistanceType.Energy, 40, 50);

                this.SetSkill(SkillName.MagicResist, 125.1, 140.0);
                this.SetSkill(SkillName.Tactics, 90.1, 100.0);
                this.SetSkill(SkillName.Wrestling, 90.1, 100.0);</pre>

## Duplicated Code. Size: 311

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Ratman.cs

<pre>this.SetStr(96, 120);
            this.SetDex(81, 100);
            this.SetInt(36, 60);

            this.SetHits(58, 72);

            this.SetDamage(4, 5);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 25, 30);
            this.SetResistance(ResistanceType.Fire, 10, 20);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 10, 20);
            this.SetResistance(ResistanceType.Energy, 10, 20);

            this.SetSkill(SkillName.MagicResist, 35.1, 60.0);
            this.SetSkill(SkillName.Tactics, 50.1, 75.0);
            this.SetSkill(SkillName.Wrestling, 50.1, 75.0);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Lenley.cs

<pre>this.SetStr(96, 120);
            this.SetDex(81, 100);
            this.SetInt(36, 60);

            this.SetHits(58, 72);

            this.SetDamage(4, 5);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 25, 30);
            this.SetResistance(ResistanceType.Fire, 10, 20);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 10, 20);
            this.SetResistance(ResistanceType.Energy, 10, 20);

            this.SetSkill(SkillName.MagicResist, 35.1, 60.0);
            this.SetSkill(SkillName.Tactics, 50.1, 75.0);
            this.SetSkill(SkillName.Wrestling, 50.1, 75.0);</pre>

## Duplicated Code. Size: 309

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\CursedSoul.cs

<pre>switch ( Utility.Random(10) )
            {
                case 0:
                    this.PackItem(new LeftArm());
                    break;
                case 1:
                    this.PackItem(new RightArm());
                    break;
                case 2:
                    this.PackItem(new Torso());
                    break;
                case 3:
                    this.PackItem(new Bone());
                    break;
                case 4:
                    this.PackItem(new RibCage());
                    break;
                case 5:
                    this.PackItem(new RibCage());
                    break;
                case 6:
                    this.PackItem(new BonePile());
                    break;
                case 7:
                    this.PackItem(new BonePile());
                    break;
                case 8:
                    this.PackItem(new BonePile());
                    break;
                case 9:
                    this.PackItem(new BonePile());
                    break;
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\IceSerpent.cs

<pre>switch (Utility.Random(10))
            {
                case 0:
                    this.PackItem(new LeftArm());
                    break;
                case 1:
                    this.PackItem(new RightArm());
                    break;
                case 2:
                    this.PackItem(new Torso());
                    break;
                case 3:
                    this.PackItem(new Bone());
                    break;
                case 4:
                    this.PackItem(new RibCage());
                    break;
                case 5:
                    this.PackItem(new RibCage());
                    break;
                case 6:
                    this.PackItem(new BonePile());
                    break;
                case 7:
                    this.PackItem(new BonePile());
                    break;
                case 8:
                    this.PackItem(new BonePile());
                    break;
                case 9:
                    this.PackItem(new BonePile());
                    break;
            }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\RevenantLion.cs

<pre>switch ( Utility.Random(10))
            {
                case 0:
                    this.PackItem(new LeftArm());
                    break;
                case 1:
                    this.PackItem(new RightArm());
                    break;
                case 2:
                    this.PackItem(new Torso());
                    break;
                case 3:
                    this.PackItem(new Bone());
                    break;
                case 4:
                    this.PackItem(new RibCage());
                    break;
                case 5:
                    this.PackItem(new RibCage());
                    break;
                case 6:
                    this.PackItem(new BonePile());
                    break;
                case 7:
                    this.PackItem(new BonePile());
                    break;
                case 8:
                    this.PackItem(new BonePile());
                    break;
                case 9:
                    this.PackItem(new BonePile());
                    break;
            }</pre>

Fragment 4 in file Scripts\Mobiles\Normal\RuneBeetle.cs

<pre>switch (Utility.Random(10))
            {
                case 0:
                    this.PackItem(new LeftArm());
                    break;
                case 1:
                    this.PackItem(new RightArm());
                    break;
                case 2:
                    this.PackItem(new Torso());
                    break;
                case 3:
                    this.PackItem(new Bone());
                    break;
                case 4:
                    this.PackItem(new RibCage());
                    break;
                case 5:
                    this.PackItem(new RibCage());
                    break;
                case 6:
                    this.PackItem(new BonePile());
                    break;
                case 7:
                    this.PackItem(new BonePile());
                    break;
                case 8:
                    this.PackItem(new BonePile());
                    break;
                case 9:
                    this.PackItem(new BonePile());
                    break;
            }</pre>

Fragment 5 in file Scripts\Mobiles\Normal\ShadowWisp.cs

<pre>switch ( Utility.Random(10))
            {
                case 0:
                    this.PackItem(new LeftArm());
                    break;
                case 1:
                    this.PackItem(new RightArm());
                    break;
                case 2:
                    this.PackItem(new Torso());
                    break;
                case 3:
                    this.PackItem(new Bone());
                    break;
                case 4:
                    this.PackItem(new RibCage());
                    break;
                case 5:
                    this.PackItem(new RibCage());
                    break;
                case 6:
                    this.PackItem(new BonePile());
                    break;
                case 7:
                    this.PackItem(new BonePile());
                    break;
                case 8:
                    this.PackItem(new BonePile());
                    break;
                case 9:
                    this.PackItem(new BonePile());
                    break;
            }</pre>

Fragment 6 in file Scripts\Mobiles\Normal\TsukiWolf.cs

<pre>switch( Utility.Random(10) )
            {
                case 0:
                    this.PackItem(new LeftArm());
                    break;
                case 1:
                    this.PackItem(new RightArm());
                    break;
                case 2:
                    this.PackItem(new Torso());
                    break;
                case 3:
                    this.PackItem(new Bone());
                    break;
                case 4:
                    this.PackItem(new RibCage());
                    break;
                case 5:
                    this.PackItem(new RibCage());
                    break;
                case 6:
                    this.PackItem(new BonePile());
                    break;
                case 7:
                    this.PackItem(new BonePile());
                    break;
                case 8:
                    this.PackItem(new BonePile());
                    break;
                case 9:
                    this.PackItem(new BonePile());
                    break;
            }</pre>

## Duplicated Code. Size: 308

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\Bedroll.cs

<pre>this.m_CloseTimer = Timer.DelayCall(TimeSpan.FromSeconds(10.0), new TimerCallback(CloseGump));

                this.AddBackground(0, 0, 400, 350, 0xA28);

                this.AddHtmlLocalized(100, 20, 200, 35, 1011015, false, false); // <center>Logging out via camping</center>

                /* Using a bedroll in the safety of a camp will log you out of the game safely.
                * If this is what you wish to do choose CONTINUE and you will be logged out.
                * Otherwise, select the CANCEL button to avoid logging out at this time.
                * The camp will remain secure for 10 seconds at which time this window will close
                * and you not be logged out.
                */
                this.AddHtmlLocalized(50, 55, 300, 140, 1011016, true, true);

                this.AddButton(45, 298, 0xFA5, 0xFA7, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(80, 300, 110, 35, 1011011, false, false); // CONTINUE

                this.AddButton(200, 298, 0xFA5, 0xFA7, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(235, 300, 110, 35, 1011012, false, false); // CANCEL</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Items\Artifacts\BlanketOfDarknessArtifact.cs

<pre>this.m_CloseTimer = Timer.DelayCall(TimeSpan.FromSeconds(10.0), new TimerCallback(CloseGump));

                this.AddBackground(0, 0, 400, 350, 0xA28);

                this.AddHtmlLocalized(100, 20, 200, 35, 1011015, false, false); // <center>Logging out via camping</center>

                /* Using a bedroll in the safety of a camp will log you out of the game safely.
                * If this is what you wish to do choose CONTINUE and you will be logged out.
                * Otherwise, select the CANCEL button to avoid logging out at this time.
                * The camp will remain secure for 10 seconds at which time this window will close
                * and you not be logged out.
                */
                this.AddHtmlLocalized(50, 55, 300, 140, 1011016, true, true);

                this.AddButton(45, 298, 0xFA5, 0xFA7, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(80, 300, 110, 35, 1011011, false, false); // CONTINUE

                this.AddButton(200, 298, 0xFA5, 0xFA7, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(235, 300, 110, 35, 1011012, false, false); // CANCEL</pre>

## Duplicated Code. Size: 308

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Mobiles\Vendors\FactionReagentVendor.cs

<pre>this.Add(new GenericBuyInfo(typeof(BlackPearl), 5, 20, 0xF7A, 0));
                    this.Add(new GenericBuyInfo(typeof(Bloodmoss), 5, 20, 0xF7B, 0));
                    this.Add(new GenericBuyInfo(typeof(MandrakeRoot), 3, 20, 0xF86, 0));
                    this.Add(new GenericBuyInfo(typeof(Garlic), 3, 20, 0xF84, 0));
                    this.Add(new GenericBuyInfo(typeof(Ginseng), 3, 20, 0xF85, 0));
                    this.Add(new GenericBuyInfo(typeof(Nightshade), 3, 20, 0xF88, 0));
                    this.Add(new GenericBuyInfo(typeof(SpidersSilk), 3, 20, 0xF8D, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBHolyMage.cs

<pre>this.Add(new GenericBuyInfo(typeof(BlackPearl), 5, 20, 0xF7A, 0));
                this.Add(new GenericBuyInfo(typeof(Bloodmoss), 5, 20, 0xF7B, 0));
                this.Add(new GenericBuyInfo(typeof(Garlic), 3, 20, 0xF84, 0));
                this.Add(new GenericBuyInfo(typeof(Ginseng), 3, 20, 0xF85, 0));
                this.Add(new GenericBuyInfo(typeof(MandrakeRoot), 3, 20, 0xF86, 0));
                this.Add(new GenericBuyInfo(typeof(Nightshade), 3, 20, 0xF88, 0));
                this.Add(new GenericBuyInfo(typeof(SpidersSilk), 3, 20, 0xF8D, 0));</pre>

## Duplicated Code. Size: 308

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBJewel.cs

<pre>this.Add(new GenericBuyInfo(typeof(GoldRing), 27, 20, 0x108A, 0));
                this.Add(new GenericBuyInfo(typeof(Necklace), 26, 20, 0x1085, 0));
                this.Add(new GenericBuyInfo(typeof(GoldNecklace), 27, 20, 0x1088, 0));
                this.Add(new GenericBuyInfo(typeof(GoldBeadNecklace), 27, 20, 0x1089, 0));
                this.Add(new GenericBuyInfo(typeof(Beads), 27, 20, 0x108B, 0));
                this.Add(new GenericBuyInfo(typeof(GoldBracelet), 27, 20, 0x1086, 0));
                this.Add(new GenericBuyInfo(typeof(GoldEarrings), 27, 20, 0x1087, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBVagabond.cs

<pre>this.Add(new GenericBuyInfo(typeof(GoldRing), 27, 20, 0x108A, 0));
                this.Add(new GenericBuyInfo(typeof(Necklace), 26, 20, 0x1085, 0));
                this.Add(new GenericBuyInfo(typeof(GoldNecklace), 27, 20, 0x1088, 0));
                this.Add(new GenericBuyInfo(typeof(GoldBeadNecklace), 27, 20, 0x1089, 0));
                this.Add(new GenericBuyInfo(typeof(Beads), 27, 20, 0x108B, 0));
                this.Add(new GenericBuyInfo(typeof(GoldBracelet), 27, 20, 0x1086, 0));
                this.Add(new GenericBuyInfo(typeof(GoldEarrings), 27, 20, 0x1087, 0));</pre>

## Duplicated Code. Size: 308

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Quest\AbyssKey.cs

<pre>public virtual void Decay()
        {
            if (this.RootParent is Mobile)
            {
                Mobile parent = (Mobile)this.RootParent;

                if (this.Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + this.LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, this.Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            this.StopTimer();
            this.Delete();
        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\QuestItems\WillemHartesHat.cs

<pre>public virtual void Decay()
        {
            if (this.RootParent is Mobile)
            {
                Mobile parent = (Mobile)this.RootParent;

                if (this.Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + this.LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, this.Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            this.StopTimer();
            this.Delete();
        }</pre>

Fragment 3 in file Scripts\Services\Peerless\PeerlessKey.cs

<pre>public virtual void Decay()
        {
            if (this.RootParent is Mobile)
            {
                Mobile parent = (Mobile)this.RootParent;

                if (this.Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + this.LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, this.Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            this.StopTimer();
            this.Delete();
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\ExodusSacrificalDagger.cs

<pre>public virtual void Decay()
        {
            if (this.RootParent is Mobile)
            {
                Mobile parent = (Mobile)this.RootParent;

                if (this.Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + this.LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, this.Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            this.StopTimer();
            this.Delete();
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\ExodusSummoningRite.cs

<pre>public virtual void Decay()
        {
            if (this.RootParent is Mobile)
            {
                Mobile parent = (Mobile)this.RootParent;

                if (this.Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + this.LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, this.Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            this.StopTimer();
            this.Delete();
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\RobeofRite.cs

<pre>public virtual void Decay()
        {
            if (this.RootParent is Mobile)
            {
                Mobile parent = (Mobile)this.RootParent;

                if (this.Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + this.LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, this.Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            this.StopTimer();
            this.Delete();
        }</pre>

## Duplicated Code. Size: 307

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\DustyMuseumBag.cs

<pre>switch (Utility.Random(9))
            {
                case 0:
                    this.AddItem(new Amber(5));
                    break;
                case 1:
                    this.AddItem(new Amethyst(5));
                    break;
                case 2:
                    this.AddItem(new Citrine(5));
                    break;
                case 3:
                    this.AddItem(new Ruby(5));
                    break;
                case 4:
                    this.AddItem(new Emerald(5));
                    break;
                case 5:
                    this.AddItem(new Diamond(5));
                    break;
                case 6:
                    this.AddItem(new Sapphire(5));
                    break;
                case 7:
                    this.AddItem(new StarSapphire(5));
                    break;
                case 8:
                    this.AddItem(new Tourmaline(5));
                    break;
            }</pre>

Fragment 2 in file Scripts\Items\Containers\MeagerMuseumBag.cs

<pre>switch (Utility.Random(9))
            {
                case 0:
                    this.AddItem(new Amber(5));
                    break;
                case 1:
                    this.AddItem(new Amethyst(5));
                    break;
                case 2:
                    this.AddItem(new Citrine(5));
                    break;
                case 3:
                    this.AddItem(new Ruby(5));
                    break;
                case 4:
                    this.AddItem(new Emerald(5));
                    break;
                case 5:
                    this.AddItem(new Diamond(5));
                    break;
                case 6:
                    this.AddItem(new Sapphire(5));
                    break;
                case 7:
                    this.AddItem(new StarSapphire(5));
                    break;
                case 8:
                    this.AddItem(new Tourmaline(5));
                    break;
            }</pre>

## Duplicated Code. Size: 307

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\BaseCollectionItem.cs

<pre>public virtual void DecreaseTier()
        { 
            this.m_Tier -= 1;

            if (this.m_Tiers != null && this.m_Tiers.Count > 0)
            {
                for (int i = 0; i < this.m_Tiers[this.m_Tiers.Count - 1].Count; i ++)
                {
                    if (this.m_Tiers[this.m_Tiers.Count - 1][i] is Item)
                        ((Item)this.m_Tiers[this.m_Tiers.Count - 1][i]).Delete();
                    else if (this.m_Tiers[this.m_Tiers.Count - 1][i] is Mobile)
                        ((Mobile)this.m_Tiers[this.m_Tiers.Count - 1][i]).Delete();
                }

                this.m_Tiers.RemoveAt(this.m_Tiers.Count - 1);
            }
        }</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\BaseCollectionMobile.cs

<pre>public virtual void DecreaseTier()
        { 
            this.m_Tier -= 1;

            if (this.m_Tiers != null && this.m_Tiers.Count > 0)
            {
                for (int i = 0; i < this.m_Tiers[this.m_Tiers.Count - 1].Count; i ++)
                {
                    if (this.m_Tiers[this.m_Tiers.Count - 1][i] is Item)
                        ((Item)this.m_Tiers[this.m_Tiers.Count - 1][i]).Delete();
                    else if (this.m_Tiers[this.m_Tiers.Count - 1][i] is Mobile)
                        ((Mobile)this.m_Tiers[this.m_Tiers.Count - 1][i]).Delete();
                }

                this.m_Tiers.RemoveAt(this.m_Tiers.Count - 1);
            }
        }</pre>

## Duplicated Code. Size: 307

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefBowFletching.cs

<pre>this.SetSubRes(typeof(Board), 1072643);

            // Add every material you want the player to be able to choose from
            // This will override the overridable material	TODO: Verify the required skill amount
            this.AddSubRes(typeof(Board), 1072643, 00.0, 1044041, 1072652);
            this.AddSubRes(typeof(OakBoard), 1072644, 65.0, 1044041, 1072652);
            this.AddSubRes(typeof(AshBoard), 1072645, 80.0, 1044041, 1072652);
            this.AddSubRes(typeof(YewBoard), 1072646, 95.0, 1044041, 1072652);
            this.AddSubRes(typeof(HeartwoodBoard), 1072647, 100.0, 1044041, 1072652);
            this.AddSubRes(typeof(BloodwoodBoard), 1072648, 100.0, 1044041, 1072652);
            this.AddSubRes(typeof(FrostwoodBoard), 1072649, 100.0, 1044041, 1072652);
            #endregion

            this.MarkOption = true;
            this.Repair = Core.AOS;
			this.CanEnhance = Core.ML;</pre>

Fragment 2 in file Scripts\Services\Craft\DefCarpentry.cs

<pre>this.MarkOption = true;
            this.Repair = Core.AOS;
            this.CanEnhance = Core.ML;

            this.SetSubRes(typeof(Board), 1072643);

            // Add every material you want the player to be able to choose from
            // This will override the overridable material	TODO: Verify the required skill amount
            this.AddSubRes(typeof(Board), 1072643, 00.0, 1044041, 1072652);
            this.AddSubRes(typeof(OakBoard), 1072644, 65.0, 1044041, 1072652);
            this.AddSubRes(typeof(AshBoard), 1072645, 80.0, 1044041, 1072652);
            this.AddSubRes(typeof(YewBoard), 1072646, 95.0, 1044041, 1072652);
            this.AddSubRes(typeof(HeartwoodBoard), 1072647, 100.0, 1044041, 1072652);
            this.AddSubRes(typeof(BloodwoodBoard), 1072648, 100.0, 1044041, 1072652);
            this.AddSubRes(typeof(FrostwoodBoard), 1072649, 100.0, 1044041, 1072652);</pre>

## Duplicated Code. Size: 307

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\BaseHealer.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (!m.Frozen && DateTime.UtcNow >= this.m_NextResurrect && this.InRange(m, 4) && !this.InRange(oldLocation, 4) && this.InLOS(m))
            {
                if (!m.Alive)
                {
                    this.m_NextResurrect = DateTime.UtcNow + ResurrectDelay;

                    if (m.Map == null || !m.Map.CanFit(m.Location, 16, false, false))
                    {
                        m.SendLocalizedMessage(502391); // Thou can not be resurrected there!
                    }
                    else if (this.CheckResurrect(m))
                    {
                        this.OfferResurrection(m);
                    }
                }
                else if (this.HealsYoungPlayers && m.Hits < m.HitsMax && m is PlayerMobile && ((PlayerMobile)m).Young)
                {
                    this.OfferHeal((PlayerMobile)m);
                }
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (!m.Frozen && DateTime.UtcNow >= this.m_NextResurrect && this.InRange(m, 4) && !this.InRange(oldLocation, 4) && this.InLOS(m))
            {
                if (!m.Alive)
                {
                    this.m_NextResurrect = DateTime.UtcNow + ResurrectDelay;

                    if (m.Map == null || !m.Map.CanFit(m.Location, 16, false, false))
                    {
                        m.SendLocalizedMessage(502391); // Thou can not be resurrected there!
                    }
                    else if (this.CheckResurrect(m))
                    {
                        this.OfferResurrection(m);
                    }
                }
                else if (this.HealsYoungPlayers && m.Hits < m.HitsMax && m is PlayerMobile && ((PlayerMobile)m).Young)
                {
                    this.OfferHeal((PlayerMobile)m);
                }
            }
        }</pre>

Fragment 3 in file Scripts\Quests\Escortables.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (!m.Frozen && DateTime.UtcNow >= this.m_NextResurrect && this.InRange(m, 4) && !this.InRange(oldLocation, 4) && this.InLOS(m))
            {
                if (!m.Alive)
                {
                    this.m_NextResurrect = DateTime.UtcNow + ResurrectDelay;

                    if (m.Map == null || !m.Map.CanFit(m.Location, 16, false, false))
                    {
                        m.SendLocalizedMessage(502391); // Thou can not be resurrected there!
                    }
                    else if (this.CheckResurrect(m))
                    {
                        this.OfferResurrection(m);
                    }
                }
                else if (this.HealsYoungPlayers && m.Hits < m.HitsMax && m is PlayerMobile && ((PlayerMobile)m).Young)
                {
                    this.OfferHeal((PlayerMobile)m);
                }
            }
        }</pre>

## Duplicated Code. Size: 306

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DoorGenDelete.cs

<pre>private static readonly int[] m_SouthFrames = new int[]
        {
            0x0006,
            0x0008,
            0x000B,
            0x001A,
            0x001B,
            0x001F,
            0x0038,
            0x0057,
            0x0059,
            0x005B,
            0x005D,
            0x0080,
            0x0081,
            0x0082,
            0x0084,
            0x0090,
            0x0091,
            0x0094,
            0x0096,
            0x0099,
            0x00A6,
            0x00A7,
            0x00AA,
            0x00AE,
            0x00B0,
            0x00B3,
            0x00C7,
            0x00C9,
            0x00F8,
            0x00FA,
            0x00FD,
            0x00FE,
            0x0100,
            0x0103,
            0x0104,
            0x0106,
            0x0109,
            0x0127,
            0x0129,
            0x012B,
            0x012D,
            0x012F,
            0x0131,
            0x0132,
            0x0134,
            0x0135,
            0x0137,
            0x0139,
            0x013B,
            0x014C,
            0x014E,
            0x014F,
            0x0151,
            0x0153,
            0x0155,
            0x0157,
            0x0158,
            0x015A,
            0x015D,
            0x015E,
            0x015F,
            0x0162,
            0x01CF,
            0x01D1,
            0x01D4,
            0x01FF,
            0x0204,
            0x0206,
            0x0208,
            0x020A
        };</pre>

Fragment 2 in file Scripts\Commands\DoorGenerator.cs

<pre>private static readonly int[] m_SouthFrames = new int[]
        {
            0x0006,
            0x0008,
            0x000B,
            0x001A,
            0x001B,
            0x001F,
            0x0038,
            0x0057,
            0x0059,
            0x005B,
            0x005D,
            0x0080,
            0x0081,
            0x0082,
            0x0084,
            0x0090,
            0x0091,
            0x0094,
            0x0096,
            0x0099,
            0x00A6,
            0x00A7,
            0x00AA,
            0x00AE,
            0x00B0,
            0x00B3,
            0x00C7,
            0x00C9,
            0x00F8,
            0x00FA,
            0x00FD,
            0x00FE,
            0x0100,
            0x0103,
            0x0104,
            0x0106,
            0x0109,
            0x0127,
            0x0129,
            0x012B,
            0x012D,
            0x012F,
            0x0131,
            0x0132,
            0x0134,
            0x0135,
            0x0137,
            0x0139,
            0x013B,
            0x014C,
            0x014E,
            0x014F,
            0x0151,
            0x0153,
            0x0155,
            0x0157,
            0x0158,
            0x015A,
            0x015D,
            0x015E,
            0x015F,
            0x0162,
            0x01CF,
            0x01D1,
            0x01D4,
            0x01FF,
            0x0204,
            0x0206,
            0x0208,
            0x020A
        };</pre>

## Duplicated Code. Size: 306

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DoorGenDelete.cs

<pre>private static readonly int[] m_EastFrames = new int[]
        {
            0x0007,
            0x000A,
            0x001A,
            0x001C,
            0x001E,
            0x0037,
            0x0058,
            0x0059,
            0x005C,
            0x005E,
            0x0080,
            0x0081,
            0x0082,
            0x0084,
            0x0090,
            0x0092,
            0x0095,
            0x0097,
            0x0098,
            0x00A6,
            0x00A8,
            0x00AB,
            0x00AE,
            0x00AF,
            0x00B2,
            0x00C7,
            0x00C8,
            0x00EA,
            0x00F8,
            0x00F9,
            0x00FC,
            0x00FE,
            0x00FF,
            0x0102,
            0x0104,
            0x0105,
            0x0108,
            0x0127,
            0x0128,
            0x012B,
            0x012C,
            0x012E,
            0x0130,
            0x0132,
            0x0133,
            0x0135,
            0x0136,
            0x0138,
            0x013A,
            0x014C,
            0x014D,
            0x014F,
            0x0150,
            0x0152,
            0x0154,
            0x0156,
            0x0158,
            0x0159,
            0x015C,
            0x015E,
            0x0160,
            0x0163,
            0x01CF,
            0x01D0,
            0x01D3,
            0x01FF,
            0x0203,
            0x0205,
            0x0207,
            0x0209
        };</pre>

Fragment 2 in file Scripts\Commands\DoorGenerator.cs

<pre>private static readonly int[] m_EastFrames = new int[]
        {
            0x0007,
            0x000A,
            0x001A,
            0x001C,
            0x001E,
            0x0037,
            0x0058,
            0x0059,
            0x005C,
            0x005E,
            0x0080,
            0x0081,
            0x0082,
            0x0084,
            0x0090,
            0x0092,
            0x0095,
            0x0097,
            0x0098,
            0x00A6,
            0x00A8,
            0x00AB,
            0x00AE,
            0x00AF,
            0x00B2,
            0x00C7,
            0x00C8,
            0x00EA,
            0x00F8,
            0x00F9,
            0x00FC,
            0x00FE,
            0x00FF,
            0x0102,
            0x0104,
            0x0105,
            0x0108,
            0x0127,
            0x0128,
            0x012B,
            0x012C,
            0x012E,
            0x0130,
            0x0132,
            0x0133,
            0x0135,
            0x0136,
            0x0138,
            0x013A,
            0x014C,
            0x014D,
            0x014F,
            0x0150,
            0x0152,
            0x0154,
            0x0156,
            0x0158,
            0x0159,
            0x015C,
            0x015E,
            0x0160,
            0x0163,
            0x01CF,
            0x01D0,
            0x01D3,
            0x01FF,
            0x0203,
            0x0205,
            0x0207,
            0x0209
        };</pre>

## Duplicated Code. Size: 306

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\Bedroll.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.Parent != null || !this.VerifyMove(from))
                return;

            if (!from.InRange(this, 2))
            {
                from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
                return;
            }

            if (this.ItemID == 0xA57) // rolled
            {
                Direction dir = PlayerMobile.GetDirection4(from.Location, this.Location);

                if (dir == Direction.North || dir == Direction.South)
                    this.ItemID = 0xA55;
                else
                    this.ItemID = 0xA56;
            }
            else // unrolled
            {
                this.ItemID = 0xA57;

                if (!from.HasGump(typeof(LogoutGump)))
                {
                    CampfireEntry entry = Campfire.GetEntry(from);

                    if (entry != null && entry.Safe)
                        from.SendGump(new LogoutGump(entry, this));
                }
            }
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Items\Artifacts\BlanketOfDarknessArtifact.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.Parent != null || !this.VerifyMove(from))
                return;

            if (!from.InRange(this, 2))
            {
                from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
                return;
            }

            if (this.ItemID == 0xA57) // rolled
            {
                Direction dir = PlayerMobile.GetDirection4(from.Location, this.Location);

                if (dir == Direction.North || dir == Direction.South)
                    this.ItemID = 0xA55;
                else
                    this.ItemID = 0xA56;
            }
            else // unrolled
            {
                this.ItemID = 0xA57;

                if (!from.HasGump(typeof(LogoutGump)))
                {
                    CampfireEntry entry = Campfire.GetEntry(from);

                    if (entry != null && entry.Safe)
                        from.SendGump(new LogoutGump(entry, this));
                }
            }
        }</pre>

## Duplicated Code. Size: 305

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\GuildListGump.cs

<pre>if ((i % 11) == 0)
                {
                    if (i != 0)
                    {
                        this.AddButton(300, 370, 4005, 4007, 0, GumpButtonType.Page, (i / 11) + 1);
                        this.AddHtmlLocalized(335, 370, 300, 35, 1011066, false, false); // Next page
                    }

                    this.AddPage((i / 11) + 1);

                    if (i != 0)
                    {
                        this.AddButton(20, 370, 4014, 4016, 0, GumpButtonType.Page, (i / 11));
                        this.AddHtmlLocalized(55, 370, 300, 35, 1011067, false, false); // Previous page
                    }
                }

                if (radio)
                    this.AddRadio(20, 35 + ((i % 11) * 30), 208, 209, false, i);</pre>

Fragment 2 in file Scripts\Gumps\Guilds\GuildMobileListGump.cs

<pre>if ((i % 11) == 0)
                {
                    if (i != 0)
                    {
                        this.AddButton(300, 370, 4005, 4007, 0, GumpButtonType.Page, (i / 11) + 1);
                        this.AddHtmlLocalized(335, 370, 300, 35, 1011066, false, false); // Next page
                    }

                    this.AddPage((i / 11) + 1);

                    if (i != 0)
                    {
                        this.AddButton(20, 370, 4014, 4016, 0, GumpButtonType.Page, (i / 11));
                        this.AddHtmlLocalized(55, 370, 300, 35, 1011067, false, false); // Previous page
                    }
                }

                if (radio)
                    this.AddRadio(20, 35 + ((i % 11) * 30), 208, 209, false, i);</pre>

## Duplicated Code. Size: 304

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>int team = int.Parse(GetText(node["team"], "0"));
			bool group = bool.Parse(GetText(node["group"], "False"));
			TimeSpan maxDelay = TimeSpan.Parse(GetText(node["maxdelay"], "10:00"));
			TimeSpan minDelay = TimeSpan.Parse(GetText(node["mindelay"], "05:00"));
			List<string> creaturesName = LoadCreaturesName(node["creaturesname"]);
			string name = GetText(node["name"], "Spawner");
			Point3D location = Point3D.Parse(GetText(node["location"], "Error"));
			Map map = Map.Parse(GetText(node["map"], "Error"));</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Support\SpawnerExporter.cs

<pre>int team = int.Parse( GetText( node["team"], "0" ) );

			bool group = bool.Parse( GetText( node["group"], "False" ) );
			TimeSpan maxDelay = TimeSpan.Parse( GetText( node["maxdelay"], "10:00" ) );
			TimeSpan minDelay = TimeSpan.Parse( GetText( node["mindelay"], "05:00" ) );
			List<string> creaturesName = LoadCreaturesName( node["creaturesname"] );

			string name = GetText( node["name"], "Spawner" );
			Point3D location = Point3D.Parse( GetText( node["location"], "Error" ) );
			Map map = Map.Parse( GetText( node["map"], "Error" ) );</pre>

## Duplicated Code. Size: 303

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Mobiles.cs

<pre>SetDamage( 15, 21 );

			SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 35, 45 );
			SetResistance( ResistanceType.Fire, 25, 30 );
			SetResistance( ResistanceType.Cold, 25, 30 );
			SetResistance( ResistanceType.Poison, 10, 20 );
			SetResistance( ResistanceType.Energy, 10, 20 );

			SetSkill( SkillName.Anatomy, 125.0 );
			SetSkill( SkillName.Fencing, 46.0, 77.5 );
			SetSkill( SkillName.Macing, 35.0, 57.5 );
			SetSkill( SkillName.Poisoning, 60.0, 82.5 );
			SetSkill( SkillName.MagicResist, 83.5, 92.5 );
			SetSkill( SkillName.Swords, 125.0 );
			SetSkill( SkillName.Tactics, 125.0 );
			SetSkill( SkillName.Lumberjacking, 125.0 );</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Mobiles.cs

<pre>SetDamage( 15, 21 );

			SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 35, 45 );
			SetResistance( ResistanceType.Fire, 25, 30 );
			SetResistance( ResistanceType.Cold, 25, 30 );
			SetResistance( ResistanceType.Poison, 10, 20 );
			SetResistance( ResistanceType.Energy, 10, 20 );

			SetSkill( SkillName.Anatomy, 125.0 );
			SetSkill( SkillName.Fencing, 46.0, 77.5 );
			SetSkill( SkillName.Macing, 35.0, 57.5 );
			SetSkill( SkillName.Poisoning, 60.0, 82.5 );
			SetSkill( SkillName.MagicResist, 83.5, 92.5 );
			SetSkill( SkillName.Swords, 125.0 );
			SetSkill( SkillName.Tactics, 125.0 );
			SetSkill( SkillName.Lumberjacking, 125.0 );</pre>

## Duplicated Code. Size: 302

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DoorGenDelete.cs

<pre>private static readonly int[] m_NorthFrames = new int[]
        {
            0x0006,
            0x0008,
            0x000D,
            0x001A,
            0x001B,
            0x0020,
            0x003A,
            0x0057,
            0x0059,
            0x005B,
            0x005D,
            0x0080,
            0x0081,
            0x0082,
            0x0084,
            0x0090,
            0x0091,
            0x0094,
            0x0096,
            0x0099,
            0x00A6,
            0x00A7,
            0x00AC,
            0x00AE,
            0x00B0,
            0x00C7,
            0x00C9,
            0x00F8,
            0x00FA,
            0x00FD,
            0x00FE,
            0x0100,
            0x0103,
            0x0104,
            0x0106,
            0x0109,
            0x0127,
            0x0129,
            0x012B,
            0x012D,
            0x012F,
            0x0131,
            0x0132,
            0x0134,
            0x0135,
            0x0137,
            0x0139,
            0x013B,
            0x014C,
            0x014E,
            0x014F,
            0x0151,
            0x0153,
            0x0155,
            0x0157,
            0x0158,
            0x015A,
            0x015D,
            0x015E,
            0x015F,
            0x0162,
            0x01CF,
            0x01D1,
            0x01D4,
            0x01FF,
            0x0201,
            0x0204,
            0x0208,
            0x020A
        };</pre>

Fragment 2 in file Scripts\Commands\DoorGenerator.cs

<pre>private static readonly int[] m_NorthFrames = new int[]
        {
            0x0006,
            0x0008,
            0x000D,
            0x001A,
            0x001B,
            0x0020,
            0x003A,
            0x0057,
            0x0059,
            0x005B,
            0x005D,
            0x0080,
            0x0081,
            0x0082,
            0x0084,
            0x0090,
            0x0091,
            0x0094,
            0x0096,
            0x0099,
            0x00A6,
            0x00A7,
            0x00AC,
            0x00AE,
            0x00B0,
            0x00C7,
            0x00C9,
            0x00F8,
            0x00FA,
            0x00FD,
            0x00FE,
            0x0100,
            0x0103,
            0x0104,
            0x0106,
            0x0109,
            0x0127,
            0x0129,
            0x012B,
            0x012D,
            0x012F,
            0x0131,
            0x0132,
            0x0134,
            0x0135,
            0x0137,
            0x0139,
            0x013B,
            0x014C,
            0x014E,
            0x014F,
            0x0151,
            0x0153,
            0x0155,
            0x0157,
            0x0158,
            0x015A,
            0x015D,
            0x015E,
            0x015F,
            0x0162,
            0x01CF,
            0x01D1,
            0x01D4,
            0x01FF,
            0x0201,
            0x0204,
            0x0208,
            0x020A
        };</pre>

## Duplicated Code. Size: 302

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DoorGenDelete.cs

<pre>private static readonly int[] m_WestFrames = new int[]
        {
            0x0007,
            0x000C,
            0x001A,
            0x001C,
            0x0021,
            0x0039,
            0x0058,
            0x0059,
            0x005C,
            0x005E,
            0x0080,
            0x0081,
            0x0082,
            0x0084,
            0x0090,
            0x0092,
            0x0095,
            0x0097,
            0x0098,
            0x00A6,
            0x00A8,
            0x00AD,
            0x00AE,
            0x00AF,
            0x00B5,
            0x00C7,
            0x00C8,
            0x00EA,
            0x00F8,
            0x00F9,
            0x00FC,
            0x00FE,
            0x00FF,
            0x0102,
            0x0104,
            0x0105,
            0x0108,
            0x0127,
            0x0128,
            0x012C,
            0x012E,
            0x0130,
            0x0132,
            0x0133,
            0x0135,
            0x0136,
            0x0138,
            0x013A,
            0x014C,
            0x014D,
            0x014F,
            0x0150,
            0x0152,
            0x0154,
            0x0156,
            0x0158,
            0x0159,
            0x015C,
            0x015E,
            0x0160,
            0x0163,
            0x01CF,
            0x01D0,
            0x01D3,
            0x01FF,
            0x0200,
            0x0203,
            0x0207,
            0x0209
        };</pre>

Fragment 2 in file Scripts\Commands\DoorGenerator.cs

<pre>private static readonly int[] m_WestFrames = new int[]
        {
            0x0007,
            0x000C,
            0x001A,
            0x001C,
            0x0021,
            0x0039,
            0x0058,
            0x0059,
            0x005C,
            0x005E,
            0x0080,
            0x0081,
            0x0082,
            0x0084,
            0x0090,
            0x0092,
            0x0095,
            0x0097,
            0x0098,
            0x00A6,
            0x00A8,
            0x00AD,
            0x00AE,
            0x00AF,
            0x00B5,
            0x00C7,
            0x00C8,
            0x00EA,
            0x00F8,
            0x00F9,
            0x00FC,
            0x00FE,
            0x00FF,
            0x0102,
            0x0104,
            0x0105,
            0x0108,
            0x0127,
            0x0128,
            0x012C,
            0x012E,
            0x0130,
            0x0132,
            0x0133,
            0x0135,
            0x0136,
            0x0138,
            0x013A,
            0x014C,
            0x014D,
            0x014F,
            0x0150,
            0x0152,
            0x0154,
            0x0156,
            0x0158,
            0x0159,
            0x015C,
            0x015E,
            0x0160,
            0x0163,
            0x01CF,
            0x01D0,
            0x01D3,
            0x01FF,
            0x0200,
            0x0203,
            0x0207,
            0x0209
        };</pre>

## Duplicated Code. Size: 302

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SoulStone.cs

<pre>this.m_Stone.LastUserName = from.Name;

                Effects.SendLocationParticles(EffectItem.Create(from.Location, from.Map, EffectItem.DefaultDuration), 0, 0, 0, 0, 0, 5060, 0);
                Effects.PlaySound(from.Location, from.Map, 0x243);

                Effects.SendMovingParticles(new Entity(Server.Serial.Zero, new Point3D(from.X - 6, from.Y - 6, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);

                Effects.SendTargetParticles(from, 0x375A, 35, 90, 0x00, 0x00, 9502, (EffectLayer)255, 0x100);</pre>

Fragment 2 in file Scripts\Items\Consumables\SoulStone.cs

<pre>this.m_Stone.LastUserName = from.Name;

                Effects.SendLocationParticles(EffectItem.Create(from.Location, from.Map, EffectItem.DefaultDuration), 0, 0, 0, 0, 0, 5060, 0);
                Effects.PlaySound(from.Location, from.Map, 0x243);

                Effects.SendMovingParticles(new Entity(Server.Serial.Zero, new Point3D(from.X - 6, from.Y - 6, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0x497, 0, 9502, 1, 0, (EffectLayer)255, 0x100);

                Effects.SendTargetParticles(from, 0x375A, 35, 90, 0x00, 0x00, 9502, (EffectLayer)255, 0x100);</pre>

## Duplicated Code. Size: 302

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Camps\BrigandCamp.cs

<pre>BaseCreature bc;
            //BaseEscortable be;

            this.Visible = false;
            this.DecayDelay = TimeSpan.FromMinutes(5.0);

            this.AddItem(new Static(0x10ee), 0, 0, 0);
            this.AddItem(new Static(0xfac), 0, 7, 0);

            switch ( Utility.Random(3) )
            {
                case 0:
                    {
                        this.AddItem(new Item(0xDE3), 0, 7, 0); // Campfire
                        this.AddItem(new Item(0x974), 0, 7, 1); // Cauldron
                        break;
                    }
                case 1:
                    {
                        this.AddItem(new Item(0x1E95), 0, 7, 1); // Rabbit on a spit
                        break;
                    }
                default:
                    {
                        this.AddItem(new Item(0x1E94), 0, 7, 1); // Chicken on a spit
                        break;
                    }
            }</pre>

Fragment 2 in file Scripts\Multis\Camps\LizardmenCamp.cs

<pre>BaseCreature bc;
            //BaseEscortable be;

            this.Visible = false;
            this.DecayDelay = TimeSpan.FromMinutes(5.0);
            this.AddItem(new Static(0x10ee), 0, 0, 0);
            this.AddItem(new Static(0xfac), 0, 7, 0);

            switch ( Utility.Random(3) )
            {
                case 0:
                    {
                        this.AddItem(new Item(0xDE3), 0, 7, 0); // Campfire
                        this.AddItem(new Item(0x974), 0, 7, 1); // Cauldron
                        break;
                    }
                case 1:
                    {
                        this.AddItem(new Item(0x1E95), 0, 7, 1); // Rabbit on a spit
                        break;
                    }
                default:
                    {
                        this.AddItem(new Item(0x1E94), 0, 7, 1); // Chicken on a spit
                        break;
                    }
            }</pre>

Fragment 3 in file Scripts\Multis\Camps\OrcCamp.cs

<pre>BaseCreature bc;
            //BaseEscortable be;

            this.Visible = false;
            this.DecayDelay = TimeSpan.FromMinutes(5.0);
            this.AddItem(new Static(0x10ee), 0, 0, 0);
            this.AddItem(new Static(0xfac), 0, 7, 0);

            switch ( Utility.Random(3) )
            {
                case 0:
                    {
                        this.AddItem(new Item(0xDE3), 0, 7, 0); // Campfire
                        this.AddItem(new Item(0x974), 0, 7, 1); // Cauldron
                        break;
                    }
                case 1:
                    {
                        this.AddItem(new Item(0x1E95), 0, 7, 1); // Rabbit on a spit
                        break;
                    }
                default:
                    {
                        this.AddItem(new Item(0x1E94), 0, 7, 1); // Chicken on a spit
                        break;
                    }
            }</pre>

## Duplicated Code. Size: 301

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AdminGump.cs

<pre>this.AddImageTiled(15, 219, 206, 156, 0xBBC);
                        this.AddBlackAlpha(16, 220, 204, 154);

                        this.AddHtml(18, 221, 114, 20, this.Color("IP Address", LabelColor32), false, false);

                        if (listPage > 0)
                            this.AddButton(184, 223, 0x15E3, 0x15E7, this.GetButtonID(1, 0), GumpButtonType.Reply, 0);
                        else
                            this.AddImage(184, 223, 0x25EA);

                        if ((listPage + 1) * 6 < this.m_List.Count)
                            this.AddButton(201, 223, 0x15E1, 0x15E5, this.GetButtonID(1, 1), GumpButtonType.Reply, 0);
                        else
                            this.AddImage(201, 223, 0x25E6);</pre>

Fragment 2 in file Scripts\Gumps\AdminGump.cs

<pre>this.AddImageTiled(15, 219, 206, 156, 0xBBC);
                        this.AddBlackAlpha(16, 220, 204, 154);

                        this.AddHtml(18, 221, 114, 20, this.Color("IP Address", LabelColor32), false, false);

                        if (listPage > 0)
                            this.AddButton(184, 223, 0x15E3, 0x15E7, this.GetButtonID(1, 0), GumpButtonType.Reply, 0);
                        else
                            this.AddImage(184, 223, 0x25EA);

                        if ((listPage + 1) * 6 < this.m_List.Count)
                            this.AddButton(201, 223, 0x15E1, 0x15E5, this.GetButtonID(1, 1), GumpButtonType.Reply, 0);
                        else
                            this.AddImage(201, 223, 0x25E6);</pre>

## Duplicated Code. Size: 301

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Mardoth.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            base.OnMovement(m, oldLocation);

            if (m is PlayerMobile && !m.Frozen && !m.Alive && this.InRange(m, 4) && !this.InRange(oldLocation, 4) && this.InLOS(m))
            {
                if (m.Map == null || !m.Map.CanFit(m.Location, 16, false, false))
                {
                    m.SendLocalizedMessage(502391); // Thou can not be resurrected there!
                }
                else
                {
                    this.Direction = this.GetDirectionTo(m);

                    m.PlaySound(0x214);
                    m.FixedEffect(0x376A, 10, 16);

                    m.CloseGump(typeof(ResurrectGump));
                    m.SendGump(new ResurrectGump(m, ResurrectMessage.Healer));
                }
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Schmendrick.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            base.OnMovement(m, oldLocation);

            if (m is PlayerMobile && !m.Frozen && !m.Alive && this.InRange(m, 4) && !this.InRange(oldLocation, 4) && this.InLOS(m))
            {
                if (m.Map == null || !m.Map.CanFit(m.Location, 16, false, false))
                {
                    m.SendLocalizedMessage(502391); // Thou can not be resurrected there!
                }
                else
                {
                    this.Direction = this.GetDirectionTo(m);

                    m.PlaySound(0x214);
                    m.FixedEffect(0x376A, 10, 16);

                    m.CloseGump(typeof(ResurrectGump));
                    m.SendGump(new ResurrectGump(m, ResurrectMessage.Healer));
                }
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Uzeraan.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            base.OnMovement(m, oldLocation);

            if (m is PlayerMobile && !m.Frozen && !m.Alive && this.InRange(m, 4) && !this.InRange(oldLocation, 4) && this.InLOS(m))
            {
                if (m.Map == null || !m.Map.CanFit(m.Location, 16, false, false))
                {
                    m.SendLocalizedMessage(502391); // Thou can not be resurrected there!
                }
                else
                {
                    this.Direction = this.GetDirectionTo(m);

                    m.PlaySound(0x214);
                    m.FixedEffect(0x376A, 10, 16);

                    m.CloseGump(typeof(ResurrectGump));
                    m.SendGump(new ResurrectGump(m, ResurrectMessage.Healer));
                }
            }
        }</pre>

## Duplicated Code. Size: 300

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\BankCheck.cs

<pre>base.OnAdded(parent);

			if (!AccountGold.Enabled)
			{
				return;
			}

			Mobile owner = null;
			SecureTradeInfo tradeInfo = null;

			Container root = parent as Container;

			while (root != null && root.Parent is Container)
			{
				root = (Container)root.Parent;
			}

			parent = root ?? parent;

			if (parent is SecureTradeContainer && AccountGold.ConvertOnTrade)
			{
				var trade = (SecureTradeContainer)parent;

				if (trade.Trade.From.Container == trade)
				{
					tradeInfo = trade.Trade.From;
					owner = tradeInfo.Mobile;
				}
				else if (trade.Trade.To.Container == trade)
				{
					tradeInfo = trade.Trade.To;
					owner = tradeInfo.Mobile;
				}
			}
			else if (parent is BankBox && AccountGold.ConvertOnBank)
			{
				owner = ((BankBox)parent).Owner;
			}</pre>

Fragment 2 in file Scripts\Items\Consumables\Gold.cs

<pre>base.OnAdded(parent);

			if (!AccountGold.Enabled)
			{
				return;
			}

			Mobile owner = null;
			SecureTradeInfo tradeInfo = null;

			Container root = parent as Container;

			while (root != null && root.Parent is Container)
			{
				root = (Container)root.Parent;
			}

			parent = root ?? parent;

			if (parent is SecureTradeContainer && AccountGold.ConvertOnTrade)
			{
				var trade = (SecureTradeContainer)parent;

				if (trade.Trade.From.Container == trade)
				{
					tradeInfo = trade.Trade.From;
					owner = tradeInfo.Mobile;
				}
				else if (trade.Trade.To.Container == trade)
				{
					tradeInfo = trade.Trade.To;
					owner = tradeInfo.Mobile;
				}
			}
			else if (parent is BankBox && AccountGold.ConvertOnBank)
			{
				owner = ((BankBox)parent).Owner;
			}</pre>

## Duplicated Code. Size: 300

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GargoyleDestroyer.cs

<pre>this.SetResistance(ResistanceType.Physical, 40, 60);
            this.SetResistance(ResistanceType.Fire, 60, 70);
            this.SetResistance(ResistanceType.Cold, 15, 25);
            this.SetResistance(ResistanceType.Poison, 15, 25);
            this.SetResistance(ResistanceType.Energy, 15, 25);

            this.SetSkill(SkillName.Wrestling, 90.1, 100.0);
            this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 120.4, 160.0);
            this.SetSkill(SkillName.Anatomy, 50.5, 100.0);
            this.SetSkill(SkillName.Swords, 90.1, 100.0);
            this.SetSkill(SkillName.Macing, 90.1, 100.0);
            this.SetSkill(SkillName.Fencing, 90.1, 100.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GargoyleGuardian.cs

<pre>this.SetResistance(ResistanceType.Physical, 40, 60);
            this.SetResistance(ResistanceType.Fire, 60, 70);
            this.SetResistance(ResistanceType.Cold, 15, 25);
            this.SetResistance(ResistanceType.Poison, 15, 25);
            this.SetResistance(ResistanceType.Energy, 15, 25);

            this.SetSkill(SkillName.Wrestling, 90.1, 100.0);
            this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 120.4, 160.0);
            this.SetSkill(SkillName.Anatomy, 50.5, 100.0);
            this.SetSkill(SkillName.Swords, 90.1, 100.0);
            this.SetSkill(SkillName.Macing, 90.1, 100.0);
            this.SetSkill(SkillName.Fencing, 90.1, 100.0);</pre>

## Duplicated Code. Size: 298

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\OrcCaptain.cs

<pre>switch ( Utility.Random(7) )
            {
                case 0:
                    this.PackItem(new Arrow());
                    break;
                case 1:
                    this.PackItem(new Lockpick());
                    break;
                case 2:
                    this.PackItem(new Shaft());
                    break;
                case 3:
                    this.PackItem(new Ribs());
                    break;
                case 4:
                    this.PackItem(new Bandage());
                    break;
                case 5:
                    this.PackItem(new BeverageBottle(BeverageType.Wine));
                    break;
                case 6:
                    this.PackItem(new Jug(BeverageType.Cider));
                    break;
            }

            if (Core.AOS)
                this.PackItem(Loot.RandomNecromancyReagent());

            if (0.5 > Utility.RandomDouble())
                PackItem(new Yeast());</pre>

Fragment 2 in file Scripts\Mobiles\Normal\OrcChopper.cs

<pre>switch (Utility.Random(7))
            {
                case 0:
                    this.PackItem(new Arrow());
                    break;
                case 1:
                    this.PackItem(new Lockpick());
                    break;
                case 2:
                    this.PackItem(new Shaft());
                    break;
                case 3:
                    this.PackItem(new Ribs());
                    break;
                case 4:
                    this.PackItem(new Bandage());
                    break;
                case 5:
                    this.PackItem(new BeverageBottle(BeverageType.Wine));
                    break;
                case 6:
                    this.PackItem(new Jug(BeverageType.Cider));
                    break;
            }

            if (Core.AOS)
                this.PackItem(Loot.RandomNecromancyReagent());

            if (0.5 > Utility.RandomDouble())
                PackItem(new Yeast());</pre>

## Duplicated Code. Size: 298

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>if (this.m_TournyType == TournyType.RandomTeam)
                            this.Alert("The tournament has completed!", String.Format("Team {0} has won!", ((TournyMatch)((PyramidLevel)this.m_Pyramid.Levels[0]).Matches[0]).Participants.IndexOf(winner) + 1));
                        else if (this.m_TournyType == TournyType.RedVsBlue)
                            this.Alert("The tournament has completed!", String.Format("Team {0} has won!", ((TournyMatch)((PyramidLevel)this.m_Pyramid.Levels[0]).Matches[0]).Participants.IndexOf(winner) == 0 ? "Red" : "Blue"));
                        else
                            this.Alert("The tournament has completed!", String.Format("{0} {1} the champion{2}.", winner.NameList, winner.Players.Count > 1 ? "are" : "is", winner.Players.Count == 1 ? "" : "s"));</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>if (this.m_TournyType == TournyType.RandomTeam)
                                            this.Alert("The tournament has completed!", String.Format("Team {0} has won!", ((TournyMatch)((PyramidLevel)this.m_Pyramid.Levels[0]).Matches[0]).Participants.IndexOf(winner) + 1));
                                        else if (this.m_TournyType == TournyType.RedVsBlue)
                                            this.Alert("The tournament has completed!", String.Format("Team {0} has won!", ((TournyMatch)((PyramidLevel)this.m_Pyramid.Levels[0]).Matches[0]).Participants.IndexOf(winner) == 0 ? "Red" : "Blue"));
                                        else
                                            this.Alert("The tournament has completed!", String.Format("{0} {1} the champion{2}.", winner.NameList, winner.Players.Count > 1 ? "are" : "is", winner.Players.Count == 1 ? "" : "s"));</pre>

## Duplicated Code. Size: 298

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write((int)to);
            m_Stream.Write((short)itemID);
            m_Stream.Write((short)fromPoint.X);
            m_Stream.Write((short)fromPoint.Y);
            m_Stream.Write((sbyte)fromPoint.Z);
            m_Stream.Write((short)toPoint.X);
            m_Stream.Write((short)toPoint.Y);
            m_Stream.Write((sbyte)toPoint.Z);
            m_Stream.Write((byte)speed);
            m_Stream.Write((byte)duration);
            m_Stream.Write((byte)0);
            m_Stream.Write((byte)0);
            m_Stream.Write((bool)fixedDirection);
            m_Stream.Write((byte)explode);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write(to);
			m_Stream.Write((short)itemID);
			m_Stream.Write((short)fromPoint.X);
			m_Stream.Write((short)fromPoint.Y);
			m_Stream.Write((sbyte)fromPoint.Z);
			m_Stream.Write((short)toPoint.X);
			m_Stream.Write((short)toPoint.Y);
			m_Stream.Write((sbyte)toPoint.Z);
			m_Stream.Write((byte)speed);
			m_Stream.Write((byte)duration);
			m_Stream.Write((byte)0);
			m_Stream.Write((byte)0);
			m_Stream.Write(fixedDirection);
			m_Stream.Write(explode);</pre>

## Duplicated Code. Size: 297

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\ResurrectGump.cs

<pre>this.Closable = false;

            this.AddPage(0);

            this.AddImage(0, 0, 3600);

            this.AddImageTiled(0, 14, 15, 200, 3603);
            this.AddImageTiled(380, 14, 14, 200, 3605);

            this.AddImage(0, 201, 3606);

            this.AddImageTiled(15, 201, 370, 16, 3607);
            this.AddImageTiled(15, 0, 370, 16, 3601);

            this.AddImage(380, 0, 3602);

            this.AddImage(380, 201, 3608);

            this.AddImageTiled(15, 15, 365, 190, 2624);

            this.AddRadio(30, 140, 9727, 9730, true, 1);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Chyloth.cs

<pre>this.Closable = false;

            this.AddPage(0);

            this.AddImage(0, 0, 3600);

            this.AddImageTiled(0, 14, 15, 200, 3603);
            this.AddImageTiled(380, 14, 14, 200, 3605);
            this.AddImage(0, 201, 3606);
            this.AddImageTiled(15, 201, 370, 16, 3607);
            this.AddImageTiled(15, 0, 370, 16, 3601);
            this.AddImage(380, 0, 3602);
            this.AddImage(380, 201, 3608);
            this.AddImageTiled(15, 15, 365, 190, 2624);

            this.AddRadio(30, 140, 9727, 9730, true, 1);</pre>

## Duplicated Code. Size: 296

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\CrimsonDragon.cs

<pre>if (0.5 >= Utility.RandomDouble())
                {
                    switch (Utility.Random(3))
                    {
                        case 0: // Fire column
                            {
                                Effects.SendLocationParticles(EffectItem.Create(g.Location, g.Map, EffectItem.DefaultDuration), 0x3709, 10, 30, 5052);
                                Effects.PlaySound(g, g.Map, 0x208);

                                break;
                            }
                        case 1: // Explosion
                            {
                                Effects.SendLocationParticles(EffectItem.Create(g.Location, g.Map, EffectItem.DefaultDuration), 0x36BD, 20, 10, 5044);
                                Effects.PlaySound(g, g.Map, 0x307);

                                break;
                            }
                        case 2: // Ball of fire
                            {
                                Effects.SendLocationParticles(EffectItem.Create(g.Location, g.Map, EffectItem.DefaultDuration), 0x36FE, 10, 10, 5052);

                                break;
                            }
                    }
                }</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Bosses.cs

<pre>if (0.5 >= Utility.RandomDouble())
                {
                    switch (Utility.Random(3))
                    {
                        case 0: // Fire column
                            {
                                Effects.SendLocationParticles(EffectItem.Create(g.Location, g.Map, EffectItem.DefaultDuration), 0x3709, 10, 30, 5052);
                                Effects.PlaySound(g, g.Map, 0x208);

                                break;
                            }
                        case 1: // Explosion
                            {
                                Effects.SendLocationParticles(EffectItem.Create(g.Location, g.Map, EffectItem.DefaultDuration), 0x36BD, 20, 10, 5044);
                                Effects.PlaySound(g, g.Map, 0x307);

                                break;
                            }
                        case 2: // Ball of fire
                            {
                                Effects.SendLocationParticles(EffectItem.Create(g.Location, g.Map, EffectItem.DefaultDuration), 0x36FE, 10, 10, 5052);

                                break;
                            }
                    }
                }</pre>

## Duplicated Code. Size: 296

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\YomotsuElder.cs

<pre>this.PackItem(new GreenGourd());
            this.PackItem(new ExecutionersAxe());

            switch ( Utility.Random(3) )
            {
                case 0:
                    this.PackItem(new LongPants());
                    break;
                case 1:
                    this.PackItem(new ShortPants());
                    break;
            }

            switch ( Utility.Random(6) )
            {
                case 0:
                    this.PackItem(new Shoes());
                    break;
                case 1:
                    this.PackItem(new Sandals());
                    break;
                case 2:
                    this.PackItem(new Boots());
                    break;
                case 3:
                    this.PackItem(new ThighBoots());
                    break;
            }

            if (Utility.RandomDouble() < .25)
                this.PackItem(Engines.Plants.Seed.RandomBonsaiSeed());</pre>

Fragment 2 in file Scripts\Mobiles\Normal\YomotsuPriest.cs

<pre>this.PackItem(new GreenGourd());
            this.PackItem(new ExecutionersAxe());

            switch ( Utility.Random(3) )
            {
                case 0:
                    this.PackItem(new LongPants());
                    break;
                case 1:
                    this.PackItem(new ShortPants());
                    break;
            }

            switch ( Utility.Random(6) )
            {
                case 0:
                    this.PackItem(new Shoes());
                    break;
                case 1:
                    this.PackItem(new Sandals());
                    break;
                case 2:
                    this.PackItem(new Boots());
                    break;
                case 3:
                    this.PackItem(new ThighBoots());
                    break;
            }

            if (Utility.RandomDouble() < .25)
                this.PackItem(Engines.Plants.Seed.RandomBonsaiSeed());</pre>

## Duplicated Code. Size: 295

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Wreath.cs

<pre>{
                this.m_From = from;
                this.m_Addon = addon;

                this.AddPage(0);

                this.AddBackground(0, 0, 220, 170, 0x13BE);
                this.AddBackground(10, 10, 200, 150, 0xBB8);
                this.AddHtmlLocalized(20, 30, 180, 60, 1062839, false, false); // Do you wish to re-deed this decoration?
                this.AddHtmlLocalized(55, 100, 160, 25, 1011011, false, false); // CONTINUE
                this.AddButton(20, 100, 0xFA5, 0xFA7, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(55, 125, 160, 25, 1011012, false, false); // CANCEL
                this.AddButton(20, 125, 0xFA5, 0xFA7, 0, GumpButtonType.Reply, 0);
            }</pre>

Fragment 2 in file Scripts\Items\Decorative\Mistletoe.cs

<pre>{
                this.m_From = from;
                this.m_Addon = addon;

                this.AddPage(0);

                this.AddBackground(0, 0, 220, 170, 0x13BE);
                this.AddBackground(10, 10, 200, 150, 0xBB8);
                this.AddHtmlLocalized(20, 30, 180, 60, 1062839, false, false); // Do you wish to re-deed this decoration?
                this.AddHtmlLocalized(55, 100, 160, 25, 1011011, false, false); // CONTINUE
                this.AddButton(20, 100, 0xFA5, 0xFA7, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(55, 125, 160, 25, 1011012, false, false); // CANCEL
                this.AddButton(20, 125, 0xFA5, 0xFA7, 0, GumpButtonType.Reply, 0);
            }</pre>

## Duplicated Code. Size: 295

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BakeKitsune.cs

<pre>private class ExpireTimer : Timer
        {
            private readonly Mobile m_Mobile;
            private readonly Mobile m_From;
            private int m_Count;

            public ExpireTimer(Mobile m, Mobile from)
                : base(TimeSpan.FromSeconds(1.0), TimeSpan.FromSeconds(1.0))
            {
                this.m_Mobile = m;
                this.m_From = from;
                this.Priority = TimerPriority.TwoFiftyMS;
            }

            public void DoExpire()
            {
                this.Stop();
                m_Table.Remove(this.m_Mobile);
            }

            public void DrainLife()
            {
                if (this.m_Mobile.Alive)
                    this.m_Mobile.Damage(2, this.m_From);
                else
                    this.DoExpire();
            }

            protected override void OnTick()
            {
                this.DrainLife();

                if (++this.m_Count >= 5)
                {
                    this.DoExpire();
                    this.m_Mobile.SendLocalizedMessage(1070824); // The creature's rage subsides.
                }
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\TsukiWolf.cs

<pre>private class ExpireTimer : Timer
        {
            private readonly Mobile m_Mobile;
            private readonly Mobile m_From;
            private int m_Count;
            public ExpireTimer(Mobile m, Mobile from)
                : base(TimeSpan.FromSeconds(1.0), TimeSpan.FromSeconds(1.0))
            {
                this.m_Mobile = m;
                this.m_From = from;
                this.Priority = TimerPriority.TwoFiftyMS;
            }

            public void DoExpire()
            {
                this.Stop();
                m_Table.Remove(this.m_Mobile);
            }

            public void DrainLife()
            {
                if (this.m_Mobile.Alive)
                    this.m_Mobile.Damage(2, this.m_From);
                else
                    this.DoExpire();
            }

            protected override void OnTick()
            {
                this.DrainLife();

                if (++this.m_Count >= 5)
                {
                    this.DoExpire();
                    this.m_Mobile.SendLocalizedMessage(1070824); // The creature's rage subsides.
                }
            }
        }</pre>

## Duplicated Code. Size: 294

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Underworld\Maze of Death\UnderworldPuzzle.cs

<pre>int movingAmount = GetTotalPieces(movingPiece);
			int moveToAmount = GetTotalPieces(movingToPiece);

            if (movingToPiece == PuzzlePiece.None)
            {
                if ((movingAmount == 2 || movingAmount == 4))
                {
                    switch (movingPiece)
                    {
                        case PuzzlePiece.RedDouble:
                            movingToPiece = PuzzlePiece.BlueSingle;
                            movingPiece = PuzzlePiece.GreenSingle;
                            break;
                        case PuzzlePiece.BlueDouble:
                            movingToPiece = PuzzlePiece.GreenSingle;
                            movingPiece = PuzzlePiece.RedSingle;
                            break;
                        case PuzzlePiece.GreenDouble:
                            movingToPiece = PuzzlePiece.RedSingle;
                            movingPiece = PuzzlePiece.BlueSingle;
                            break;
                        case PuzzlePiece.RedBar:
                            movingToPiece = PuzzlePiece.BlueDouble;
                            movingPiece = PuzzlePiece.GreenDouble;
                            break;
                        case PuzzlePiece.BlueBar:
                            movingToPiece = PuzzlePiece.GreenDouble;
                            movingPiece = PuzzlePiece.RedDouble;
                            break;
                        case PuzzlePiece.GreenBar:
                            movingToPiece = PuzzlePiece.RedDouble;
                            movingPiece = PuzzlePiece.BlueDouble;
                            break;
                    }
                }

                return;
            }</pre>

Fragment 2 in file Scripts\Services\Underworld\Maze of Death\UnderworldPuzzle.cs

<pre>int movingAmount = GetTotalPieces(movingPiece);
			int moveToAmount = GetTotalPieces(movingToPiece);

            if (movingToPiece == PuzzlePiece.None)
            {
                if ((movingAmount == 2 || movingAmount == 4))
                {
                    switch (movingPiece)
                    {
                        case PuzzlePiece.RedDouble:
                            movingToPiece = PuzzlePiece.BlueSingle;
                            movingPiece = PuzzlePiece.GreenSingle;
                            break;
                        case PuzzlePiece.BlueDouble:
                            movingToPiece = PuzzlePiece.GreenSingle;
                            movingPiece = PuzzlePiece.RedSingle;
                            break;
                        case PuzzlePiece.GreenDouble:
                            movingToPiece = PuzzlePiece.RedSingle;
                            movingPiece = PuzzlePiece.BlueSingle;
                            break;
                        case PuzzlePiece.RedBar:
                            movingToPiece = PuzzlePiece.BlueDouble;
                            movingPiece = PuzzlePiece.GreenDouble;
                            break;
                        case PuzzlePiece.BlueBar:
                            movingToPiece = PuzzlePiece.GreenDouble;
                            movingPiece = PuzzlePiece.RedDouble;
                            break;
                        case PuzzlePiece.GreenBar:
                            movingToPiece = PuzzlePiece.RedDouble;
                            movingPiece = PuzzlePiece.BlueDouble;
                            break;
                    }
                }

                return;
            }</pre>

## Duplicated Code. Size: 293

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Barracoon.cs

<pre>bool validLocation = false;
                    Point3D loc = this.Location;

                    for (int j = 0; !validLocation && j < 10; ++j)
                    {
                        int x = this.X + Utility.Random(3) - 1;
                        int y = this.Y + Utility.Random(3) - 1;
                        int z = map.GetAverageZ(x, y);

                        if (validLocation = map.CanFit(x, y, this.Z, 16, false, false))
                            loc = new Point3D(x, y, this.Z);
                        else if (validLocation = map.CanFit(x, y, z, 16, false, false))
                            loc = new Point3D(x, y, z);
                    }</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\PrimevalLich.cs

<pre>bool validLocation = false;
                Point3D loc = this.Location;

                for (int j = 0; !validLocation && j < 10; ++j)
                {
                    int x = this.X + Utility.Random(3) - 1;
                    int y = this.Y + Utility.Random(3) - 1;
                    int z = map.GetAverageZ(x, y);

                    if (validLocation = map.CanFit(x, y, this.Z, 16, false, false))
                        loc = new Point3D(x, y, this.Z);
                    else if (validLocation = map.CanFit(x, y, z, 16, false, false))
                        loc = new Point3D(x, y, z);
                }</pre>

Fragment 3 in file Scripts\Mobiles\Named\Twaulo.cs

<pre>bool validLocation = false;
                Point3D loc = this.Location;

                for (int j = 0; !validLocation && j < 10; ++j)
                {
                    int x = this.X + Utility.Random(3) - 1;
                    int y = this.Y + Utility.Random(3) - 1;
                    int z = map.GetAverageZ(x, y);

                    if (validLocation = map.CanFit(x, y, this.Z, 16, false, false))
                        loc = new Point3D(x, y, this.Z);
                    else if (validLocation = map.CanFit(x, y, z, 16, false, false))
                        loc = new Point3D(x, y, z);
                }</pre>

Fragment 4 in file Scripts\Mobiles\Normal\BogThing.cs

<pre>bool validLocation = false;
            Point3D loc = this.Location;

            for (int j = 0; !validLocation && j < 10; ++j)
            {
                int x = this.X + Utility.Random(3) - 1;
                int y = this.Y + Utility.Random(3) - 1;
                int z = map.GetAverageZ(x, y);

                if (validLocation = map.CanFit(x, y, this.Z, 16, false, false))
                    loc = new Point3D(x, y, this.Z);
                else if (validLocation = map.CanFit(x, y, z, 16, false, false))
                    loc = new Point3D(x, y, z);
            }</pre>

Fragment 5 in file Scripts\Services\ExploringTheDeep\Mobiles\MercutioTheUnsavory.cs

<pre>bool validLocation = false;
                    Point3D loc = this.Location;

                    for (int j = 0; !validLocation && j < 10; ++j)
                    {
                        int x = this.X + Utility.Random(3) - 1;
                        int y = this.Y + Utility.Random(3) - 1;
                        int z = map.GetAverageZ(x, y);

                        if (validLocation = map.CanFit(x, y, this.Z, 16, false, false))
                            loc = new Point3D(x, y, this.Z);
                        else if (validLocation = map.CanFit(x, y, z, 16, false, false))
                            loc = new Point3D(x, y, z);
                    }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Mobile\Fezzik.cs

<pre>bool validLocation = false;
                Point3D loc = this.Location;

                for (int j = 0; !validLocation && j < 10; ++j)
                {
                    int x = this.X + Utility.Random(3) - 1;
                    int y = this.Y + Utility.Random(3) - 1;
                    int z = map.GetAverageZ(x, y);

                    if (validLocation = map.CanFit(x, y, this.Z, 16, false, false))
                        loc = new Point3D(x, y, this.Z);
                    else if (validLocation = map.CanFit(x, y, z, 16, false, false))
                        loc = new Point3D(x, y, z);
                }</pre>

## Duplicated Code. Size: 292

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\EliteNinja.cs

<pre>private void ChangeWeapon()
        {
            if (Backpack == null)
                return;

            Item item = FindItemOnLayer(Layer.OneHanded);

            if (item == null)
                item = FindItemOnLayer(Layer.TwoHanded);

            System.Collections.Generic.List<BaseWeapon> weapons = new System.Collections.Generic.List<BaseWeapon>();

            foreach (Item i in Backpack.Items)
            {
                if (i is BaseWeapon && i != item)
                    weapons.Add((BaseWeapon)i);
            }

            if (weapons.Count > 0)
            {
                if (item != null)
                    Backpack.DropItem(item);

                AddItem(weapons[Utility.Random(weapons.Count)]);

                m_NextWeaponChange = DateTime.UtcNow + TimeSpan.FromSeconds(Utility.RandomMinMax(30, 60));
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Ronin.cs

<pre>private void ChangeWeapon()
        {
            if (Backpack == null)
                return;

            Item item = FindItemOnLayer(Layer.OneHanded);

            if (item == null)
                item = FindItemOnLayer(Layer.TwoHanded);

            System.Collections.Generic.List<BaseWeapon> weapons = new System.Collections.Generic.List<BaseWeapon>();

            foreach (Item i in Backpack.Items)
            {
                if (i is BaseWeapon && i != item)
                    weapons.Add((BaseWeapon)i);
            }

            if (weapons.Count > 0)
            {
                if (item != null)
                    Backpack.DropItem(item);

                AddItem(weapons[Utility.Random(weapons.Count)]);

                m_NextWeaponChange = DateTime.UtcNow + TimeSpan.FromSeconds(Utility.RandomMinMax(30, 60));
            }
        }</pre>

## Duplicated Code. Size: 292

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Emino.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            base.OnMovement(m, oldLocation);

            if (!m.Frozen && !m.Alive && this.InRange(m, 4) && !this.InRange(oldLocation, 4) && this.InLOS(m))
            {
                if (m.Map == null || !m.Map.CanFit(m.Location, 16, false, false))
                {
                    m.SendLocalizedMessage(502391); // Thou can not be resurrected there!
                }
                else
                {
                    this.Direction = this.GetDirectionTo(m);

                    m.PlaySound(0x214);
                    m.FixedEffect(0x376A, 10, 16);

                    m.CloseGump(typeof(ResurrectGump));
                    m.SendGump(new ResurrectGump(m, ResurrectMessage.Healer));
                }
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Zoel.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            base.OnMovement(m, oldLocation);

            if (!m.Frozen && !m.Alive && this.InRange(m, 4) && !this.InRange(oldLocation, 4) && this.InLOS(m))
            {
                if (m.Map == null || !m.Map.CanFit(m.Location, 16, false, false))
                {
                    m.SendLocalizedMessage(502391); // Thou can not be resurrected there!
                }
                else
                {
                    this.Direction = this.GetDirectionTo(m);

                    m.PlaySound(0x214);
                    m.FixedEffect(0x376A, 10, 16);

                    m.CloseGump(typeof(ResurrectGump));
                    m.SendGump(new ResurrectGump(m, ResurrectMessage.Healer));
                }
            }
        }</pre>

## Duplicated Code. Size: 292

### Duplicated Fragments:

Fragment 1 in file Ultima\AnimationEdit.cs

<pre>for (int i = 0; i < 0x100; ++i)
			{
				bin.Write((ushort)(Palette[i] ^ 0x8000));
			}
			long startpos = (int)bin.BaseStream.Position;
			bin.Write(Frames.Count);
			long seek = (int)bin.BaseStream.Position;
			long curr = bin.BaseStream.Position + 4 * Frames.Count;
			foreach (FrameEdit frame in Frames)
			{
				bin.BaseStream.Seek(seek, SeekOrigin.Begin);
				bin.Write((int)(curr - startpos));
				seek = bin.BaseStream.Position;
				bin.BaseStream.Seek(curr, SeekOrigin.Begin);
				frame.Save(bin);
				curr = bin.BaseStream.Position;
			}</pre>

Fragment 2 in file Ultima\AnimationEdit.cs

<pre>for (int i = 0; i < 0x100; ++i)
			{
				bin.Write((ushort)(Palette[i] ^ 0x8000));
			}
			long startpos = bin.BaseStream.Position;
			bin.Write(Frames.Count);
			long seek = bin.BaseStream.Position;
			long curr = bin.BaseStream.Position + 4 * Frames.Count;
			foreach (FrameEdit frame in Frames)
			{
				bin.BaseStream.Seek(seek, SeekOrigin.Begin);
				bin.Write((int)(curr - startpos));
				seek = bin.BaseStream.Position;
				bin.BaseStream.Seek(curr, SeekOrigin.Begin);
				frame.Save(bin);
				curr = bin.BaseStream.Position;
			}</pre>

## Duplicated Code. Size: 291

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\ParagonChest.cs

<pre>private static void GetRandomAOSStats(out int attributeCount, out int min, out int max)
        {
            int rnd = Utility.Random(15);

            if (rnd < 1)
            {
                attributeCount = Utility.RandomMinMax(2, 6);
                min = 20;
                max = 70;
            }
            else if (rnd < 3)
            {
                attributeCount = Utility.RandomMinMax(2, 4);
                min = 20;
                max = 50;
            }
            else if (rnd < 6)
            {
                attributeCount = Utility.RandomMinMax(2, 3);
                min = 20;
                max = 40;
            }
            else if (rnd < 10)
            {
                attributeCount = Utility.RandomMinMax(1, 2);
                min = 10;
                max = 30;
            }
            else
            {
                attributeCount = 1;
                min = 10;
                max = 20;
            }
        }</pre>

Fragment 2 in file Scripts\Services\Khaldun\PuzzleChest.cs

<pre>private static void GetRandomAOSStats(out int attributeCount, out int min, out int max)
        {
            int rnd = Utility.Random(15);

            if (rnd < 1)
            {
                attributeCount = Utility.RandomMinMax(2, 6);
                min = 20;
                max = 70;
            }
            else if (rnd < 3)
            {
                attributeCount = Utility.RandomMinMax(2, 4);
                min = 20;
                max = 50;
            }
            else if (rnd < 6)
            {
                attributeCount = Utility.RandomMinMax(2, 3);
                min = 20;
                max = 40;
            }
            else if (rnd < 10)
            {
                attributeCount = Utility.RandomMinMax(1, 2);
                min = 10;
                max = 30;
            }
            else
            {
                attributeCount = 1;
                min = 10;
                max = 20;
            }
        }</pre>

## Duplicated Code. Size: 291

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x374A, 15);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x374A, 15);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z), m.Map, 0x374A, 15);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x374A, 15);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x1E0);</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x374A, 15);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x374A, 15);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y + 1, m.Z), m.Map, 0x374A, 15);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x374A, 15);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x1E0);</pre>

## Duplicated Code. Size: 291

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>tile2.Location = new Point3D(X + 3, Y - 5, Z);   
                        tile3.Location = new Point3D(X - 3, Y - 5, Z);   
                        tile4.Location = new Point3D(X + 3, Y - 1, Z);  
                        tile5.Location = new Point3D(X - 3, Y - 1, Z);   
                        tile6.Location = new Point3D(X + 3, Y + 3, Z);   
                        tile7.Location = new Point3D(X - 3, Y + 3, Z);
                        tile8.Location = new Point3D(X + 3, Y + 7, Z);
                        tile9.Location = new Point3D(X - 3, Y + 7, Z); 
                        break;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>tile2.Location = new Point3D(X + 3, Y + 5, Z);  
                        tile3.Location = new Point3D(X - 3, Y + 5, Z);   
                        tile4.Location = new Point3D(X + 3, Y + 1, Z);   
                        tile5.Location = new Point3D(X - 3, Y + 1, Z);   
                        tile6.Location = new Point3D(X + 3, Y - 3, Z);  
                        tile7.Location = new Point3D(X - 3, Y - 3, Z);
                        tile8.Location = new Point3D(X + 3, Y - 7, Z);
                        tile9.Location = new Point3D(X - 3, Y - 7, Z); 
                        break;</pre>

Fragment 3 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>tile2.Location = new Point3D(X + 5, Y + 3, Z);   
                        tile3.Location = new Point3D(X + 5, Y - 3, Z);   
                        tile4.Location = new Point3D(X + 1, Y + 3, Z);   
                        tile5.Location = new Point3D(X + 1, Y - 3, Z);   
                        tile6.Location = new Point3D(X - 3, Y + 3, Z);  
                        tile7.Location = new Point3D(X - 3, Y - 3, Z);
                        tile8.Location = new Point3D(X - 7, Y + 3, Z);
                        tile9.Location = new Point3D(X - 7, Y - 3, Z); 
                        break;</pre>

Fragment 4 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>tile2.Location = new Point3D(X - 5, Y - 3, Z);   
                        tile3.Location = new Point3D(X - 5, Y + 3, Z);  
                        tile4.Location = new Point3D(X - 1, Y - 3, Z);   
                        tile5.Location = new Point3D(X - 1, Y + 3, Z);  
                        tile6.Location = new Point3D(X + 3, Y - 3, Z);  
                        tile7.Location = new Point3D(X + 3, Y + 3, Z);
                        tile8.Location = new Point3D(X + 7, Y - 3, Z);
                        tile9.Location = new Point3D(X + 7, Y + 3, Z);  
                        break;</pre>

## Duplicated Code. Size: 290

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Extensions\Compilers\DistinctCompiler.cs

<pre>MethodEmitter emitter = new MethodEmitter(typeBuilder);

                emitter.Define(
                    /*  name  */ "Compare",
                    /*  attr  */ MethodAttributes.Public | MethodAttributes.Virtual,
                    /* return */ typeof(int),
                    /* params */ new Type[] { typeof(object), typeof(object) });

                LocalBuilder a = emitter.CreateLocal(objectType);
                LocalBuilder b = emitter.CreateLocal(objectType);

                LocalBuilder v = emitter.CreateLocal(typeof(int));

                emitter.LoadArgument(1);
                emitter.CastAs(objectType);
                emitter.StoreLocal(a);

                emitter.LoadArgument(2);
                emitter.CastAs(objectType);
                emitter.StoreLocal(b);

                emitter.Load(0);
                emitter.StoreLocal(v);

                Label end = emitter.CreateLabel();</pre>

Fragment 2 in file Scripts\Commands\Generic\Extensions\Compilers\SortCompiler.cs

<pre>MethodEmitter emitter = new MethodEmitter(typeBuilder);

                emitter.Define(
                    /*  name  */ "Compare",
                    /*  attr  */ MethodAttributes.Public | MethodAttributes.Virtual,
                    /* return */ typeof(int),
                    /* params */ new Type[] { typeof(object), typeof(object) });

                LocalBuilder a = emitter.CreateLocal(objectType);
                LocalBuilder b = emitter.CreateLocal(objectType);

                LocalBuilder v = emitter.CreateLocal(typeof(int));

                emitter.LoadArgument(1);
                emitter.CastAs(objectType);
                emitter.StoreLocal(a);

                emitter.LoadArgument(2);
                emitter.CastAs(objectType);
                emitter.StoreLocal(b);

                emitter.Load(0);
                emitter.StoreLocal(v);

                Label end = emitter.CreateLabel();</pre>

## Duplicated Code. Size: 290

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Harrower\Harrower.cs

<pre>public void AwardArtifact(Item artifact)
        {
            if (artifact == null)
                return;

            int totalDamage = 0;

            Dictionary<Mobile, int> validEntries = new Dictionary<Mobile, int>();

            foreach (KeyValuePair<Mobile, int> kvp in this.m_DamageEntries)
            {
                if (this.IsEligible(kvp.Key, artifact))
                {
                    validEntries.Add(kvp.Key, kvp.Value);
                    totalDamage += kvp.Value;
                }
            }

            int randomDamage = Utility.RandomMinMax(1, totalDamage);

            totalDamage = 0;

            foreach (KeyValuePair<Mobile, int> kvp in validEntries)
            {
                totalDamage += kvp.Value;

                if (totalDamage >= randomDamage)
                {
                    this.GiveArtifact(kvp.Key, artifact);
                    return;
                }
            }

            artifact.Delete();
        }</pre>

Fragment 2 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>public void AwardArtifact(Item artifact)
        {
            if (artifact == null)
                return;

            int totalDamage = 0;

            Dictionary<Mobile, int> validEntries = new Dictionary<Mobile, int>();

            foreach (KeyValuePair<Mobile, int> kvp in this.m_DamageEntries)
            {
                if (this.IsEligible(kvp.Key, artifact))
                {
                    validEntries.Add(kvp.Key, kvp.Value);
                    totalDamage += kvp.Value;
                }
            }

            int randomDamage = Utility.RandomMinMax(1, totalDamage);

            totalDamage = 0;

            foreach (KeyValuePair<Mobile, int> kvp in validEntries)
            {
                totalDamage += kvp.Value;

                if (totalDamage >= randomDamage)
                {
                    this.GiveArtifact(kvp.Key, artifact);
                    return;
                }
            }

            artifact.Delete();
        }</pre>

## Duplicated Code. Size: 290

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\HireSailor.cs

<pre>this.SetDamage(10, 23);

            this.SetSkill(SkillName.Stealing, 66.0, 97.5);
            this.SetSkill(SkillName.Peacemaking, 65.0, 87.5);
            this.SetSkill(SkillName.MagicResist, 25.0, 47.5);
            this.SetSkill(SkillName.Healing, 65.0, 87.5);
            this.SetSkill(SkillName.Tactics, 65.0, 87.5);
            this.SetSkill(SkillName.Fencing, 65.0, 87.5);
            this.SetSkill(SkillName.Parry, 45.0, 60.5);
            this.SetSkill(SkillName.Lockpicking, 65, 87);
            this.SetSkill(SkillName.Hiding, 65, 87);
            this.SetSkill(SkillName.Snooping, 65, 87);	
            this.Fame = 100;
            this.Karma = 0;</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HireThief.cs

<pre>this.SetDamage(10, 23);

            this.SetSkill(SkillName.Stealing, 66.0, 97.5);
            this.SetSkill(SkillName.Peacemaking, 65.0, 87.5);
            this.SetSkill(SkillName.MagicResist, 25.0, 47.5);
            this.SetSkill(SkillName.Healing, 65.0, 87.5);
            this.SetSkill(SkillName.Tactics, 65.0, 87.5);
            this.SetSkill(SkillName.Fencing, 65.0, 87.5);
            this.SetSkill(SkillName.Parry, 45.0, 60.5);
            this.SetSkill(SkillName.Lockpicking, 65, 87);
            this.SetSkill(SkillName.Hiding, 65, 87);
            this.SetSkill(SkillName.Snooping, 65, 87);	
            this.Fame = 100;
            this.Karma = 0;</pre>

## Duplicated Code. Size: 289

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DungeonHitchingPost.cs

<pre>public void EndClaimList(Mobile from, BaseCreature pet)
        {
            if (pet == null || pet.Deleted || from.Map != this.Map || !from.InRange(this, 14) || !from.Stabled.Contains(pet) || !from.CheckAlive())
                return;

            if ((from.Followers + pet.ControlSlots) <= from.FollowersMax)
            {
                pet.SetControlMaster(from);

                if (pet.Summoned)
                    pet.SummonMaster = from;

                pet.ControlTarget = from;
                pet.ControlOrder = OrderType.Follow;

                pet.MoveToWorld(from.Location, from.Map);

                pet.IsStabled = false;
                from.Stabled.Remove(pet);

                from.SendLocalizedMessage(1042559); // Here you go... and good day to you!
            }
            else
            {
                from.SendLocalizedMessage(1049612, pet.Name); // ~1_NAME~ remained in the stables because you have too many followers.
            }
        }</pre>

Fragment 2 in file Scripts\Items\Addons\HitchingPost.cs

<pre>public void EndClaimList(Mobile from, BaseCreature pet)
        {
            if (pet == null || pet.Deleted || from.Map != this.Map || !from.InRange(this, 14) || !from.Stabled.Contains(pet) || !from.CheckAlive())
                return;

            if ((from.Followers + pet.ControlSlots) <= from.FollowersMax)
            {
                pet.SetControlMaster(from);

                if (pet.Summoned)
                    pet.SummonMaster = from;

                pet.ControlTarget = from;
                pet.ControlOrder = OrderType.Follow;

                pet.MoveToWorld(from.Location, from.Map);

                pet.IsStabled = false;
                from.Stabled.Remove(pet);

                from.SendLocalizedMessage(1042559); // Here you go... and good day to you!
            }
            else
            {
                from.SendLocalizedMessage(1049612, pet.Name); // ~1_NAME~ remained in the stables because you have too many followers.
            }
        }</pre>

## Duplicated Code. Size: 289

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if (this.Parent is Mobile && (strBonus != 0 || dexBonus != 0 || intBonus != 0))
            {
                Mobile m = (Mobile)this.Parent;

                string modName = this.Serial.ToString();

                if (strBonus != 0)
                    m.AddStatMod(new StatMod(StatType.Str, modName + "Str", strBonus, TimeSpan.Zero));

                if (dexBonus != 0)
                    m.AddStatMod(new StatMod(StatType.Dex, modName + "Dex", dexBonus, TimeSpan.Zero));

                if (intBonus != 0)
                    m.AddStatMod(new StatMod(StatType.Int, modName + "Int", intBonus, TimeSpan.Zero));
            }

            if (this.Parent is Mobile)
                ((Mobile)this.Parent).CheckStatTimers();</pre>

Fragment 2 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>if (this.Parent is Mobile && (strBonus != 0 || dexBonus != 0 || intBonus != 0))
                        {
                            Mobile m = (Mobile)this.Parent;

                            string modName = this.Serial.ToString();

                            if (strBonus != 0)
                                m.AddStatMod(new StatMod(StatType.Str, modName + "Str", strBonus, TimeSpan.Zero));

                            if (dexBonus != 0)
                                m.AddStatMod(new StatMod(StatType.Dex, modName + "Dex", dexBonus, TimeSpan.Zero));

                            if (intBonus != 0)
                                m.AddStatMod(new StatMod(StatType.Int, modName + "Int", intBonus, TimeSpan.Zero));
                        }

                        if (this.Parent is Mobile)
                            ((Mobile)this.Parent).CheckStatTimers();</pre>

## Duplicated Code. Size: 289

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\LargeSmithBOD.cs

<pre>public override List<Item> ComputeRewards(bool full)
        {
            List<Item> list = new List<Item>();

            RewardGroup rewardGroup = SmithRewardCalculator.Instance.LookupRewards(SmithRewardCalculator.Instance.ComputePoints(this));

            if (rewardGroup != null)
            {
                if (full)
                {
                    for (int i = 0; i < rewardGroup.Items.Length; ++i)
                    {
                        Item item = rewardGroup.Items[i].Construct();

                        if (item != null)
                            list.Add(item);
                    }
                }
                else
                {
                    RewardItem rewardItem = rewardGroup.AcquireItem();

                    if (rewardItem != null)
                    {
                        Item item = rewardItem.Construct();

                        if (item != null)
                            list.Add(item);
                    }
                }
            }

            return list;
        }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallSmithBOD.cs

<pre>public override List<Item> ComputeRewards(bool full)
        {
            List<Item> list = new List<Item>();

            RewardGroup rewardGroup = SmithRewardCalculator.Instance.LookupRewards(SmithRewardCalculator.Instance.ComputePoints(this));

            if (rewardGroup != null)
            {
                if (full)
                {
                    for (int i = 0; i < rewardGroup.Items.Length; ++i)
                    {
                        Item item = rewardGroup.Items[i].Construct();

                        if (item != null)
                            list.Add(item);
                    }
                }
                else
                {
                    RewardItem rewardItem = rewardGroup.AcquireItem();

                    if (rewardItem != null)
                    {
                        Item item = rewardItem.Construct();

                        if (item != null)
                            list.Add(item);
                    }
                }
            }

            return list;
        }</pre>

## Duplicated Code. Size: 289

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\LargeTailorBOD.cs

<pre>public override List<Item> ComputeRewards(bool full)
        {
            List<Item> list = new List<Item>();

            RewardGroup rewardGroup = TailorRewardCalculator.Instance.LookupRewards(TailorRewardCalculator.Instance.ComputePoints(this));

            if (rewardGroup != null)
            {
                if (full)
                {
                    for (int i = 0; i < rewardGroup.Items.Length; ++i)
                    {
                        Item item = rewardGroup.Items[i].Construct();

                        if (item != null)
                            list.Add(item);
                    }
                }
                else
                {
                    RewardItem rewardItem = rewardGroup.AcquireItem();

                    if (rewardItem != null)
                    {
                        Item item = rewardItem.Construct();

                        if (item != null)
                            list.Add(item);
                    }
                }
            }

            return list;
        }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallTailorBOD.cs

<pre>public override List<Item> ComputeRewards(bool full)
        {
            List<Item> list = new List<Item>();

            RewardGroup rewardGroup = TailorRewardCalculator.Instance.LookupRewards(TailorRewardCalculator.Instance.ComputePoints(this));

            if (rewardGroup != null)
            {
                if (full)
                {
                    for (int i = 0; i < rewardGroup.Items.Length; ++i)
                    {
                        Item item = rewardGroup.Items[i].Construct();

                        if (item != null)
                            list.Add(item);
                    }
                }
                else
                {
                    RewardItem rewardItem = rewardGroup.AcquireItem();

                    if (rewardItem != null)
                    {
                        Item item = rewardItem.Construct();

                        if (item != null)
                            list.Add(item);
                    }
                }
            }

            return list;
        }</pre>

## Duplicated Code. Size: 289

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>Type targetType = SpawnerType.GetType(typestr);

									if (targetType != null && trigmob != null && trigmob.Backpack != null)
									{
										Item[] items = trigmob.Backpack.FindItemsByType( targetType, true );

										for ( int i = 0; i < items.Length; ++i )
										{
											if(CheckNameMatch(namestr, items[i].Name))
												amount += items[i].Amount;
										}
										if(banksearch && trigmob.BankBox!=null)
										{
											items = trigmob.BankBox.FindItemsByType( targetType, true );
											for ( int i = 0; i < items.Length; ++i )
											{
												if(CheckNameMatch(namestr, items[i].Name))
													amount += items[i].Amount;
											}
										}
									}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>Type targetType = SpawnerType.GetType(typestr);

								if (targetType != null && trigmob != null && trigmob.Backpack != null)
								{
									Item[] items = trigmob.Backpack.FindItemsByType( targetType, true );

									for ( int i = 0; i < items.Length; ++i )
									{
										if(CheckNameMatch(namestr, items[i].Name))
											amount += items[i].Amount;
									}
									if(banksearch && trigmob.BankBox!=null)
									{
										items = trigmob.BankBox.FindItemsByType( targetType, true );
										for ( int i = 0; i < items.Length; ++i )
										{
											if(CheckNameMatch(namestr, items[i].Name))
												amount += items[i].Amount;
										}
									}
								}</pre>

## Duplicated Code. Size: 288

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\BaseCollectionItem.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (from.Alive)
            {
                if (from.NetState == null || !from.NetState.SupportsExpansion(Expansion.ML))
                {
                    from.SendLocalizedMessage(1073651); // You must have Mondain's Legacy before proceeding...			
                    return;
                }
                else if (!MondainsLegacy.PublicDonations && (int)from.AccessLevel < (int)AccessLevel.GameMaster)
                {
                    from.SendLocalizedMessage(1042753, "Public donations"); // ~1_SOMETHING~ has been temporarily disabled.
                    return;
                }

                if (from.InRange(this.Location, 2) && from is PlayerMobile && this.CanDonate((PlayerMobile)from))
                {
                    from.CloseGump(typeof(ComunityCollectionGump));
                    from.SendGump(new ComunityCollectionGump((PlayerMobile)from, this, this.Location));
                }
                else
                    from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
            }
        }</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\BaseCollectionMobile.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (from.Alive)
            {
                if (from.NetState == null || !from.NetState.SupportsExpansion(Expansion.ML))
                {
                    from.SendLocalizedMessage(1073651); // You must have Mondain's Legacy before proceeding...			
                    return;
                }
                else if (!MondainsLegacy.PublicDonations && (int)from.AccessLevel < (int)AccessLevel.GameMaster)
                {
                    from.SendLocalizedMessage(1042753, "Public donations"); // ~1_SOMETHING~ has been temporarily disabled.
                    return;
                }

                if (from.InRange(this.Location, 2) && from is PlayerMobile && this.CanDonate((PlayerMobile)from))
                {
                    from.CloseGump(typeof(ComunityCollectionGump));
                    from.SendGump(new ComunityCollectionGump((PlayerMobile)from, this, this.Location));
                }
                else
                    from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
            }
        }</pre>

## Duplicated Code. Size: 287

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\FireworksWand.cs

<pre>if (hue < 8)
                hue = 0x66D;
            else if (hue < 10)
                hue = 0x482;
            else if (hue < 12)
                hue = 0x47E;
            else if (hue < 16)
                hue = 0x480;
            else if (hue < 20)
                hue = 0x47F;
            else
                hue = 0;

            if (Utility.RandomBool())
                hue = Utility.RandomList(0x47E, 0x47F, 0x480, 0x482, 0x66D);

            int renderMode = Utility.RandomList(0, 2, 3, 4, 5, 7);

            Effects.PlaySound(endLoc, map, Utility.Random(0x11B, 4));
            Effects.SendLocationEffect(endLoc, map, 0x373A + (0x10 * Utility.Random(4)), 16, 10, hue, renderMode);</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\Items\VvVAltar.cs

<pre>if (hue < 8)
                        hue = 0x66D;
                    else if (hue < 10)
                        hue = 0x482;
                    else if (hue < 12)
                        hue = 0x47E;
                    else if (hue < 16)
                        hue = 0x480;
                    else if (hue < 20)
                        hue = 0x47F;
                    else
                        hue = 0;

                    if (Utility.RandomBool())
                        hue = Utility.RandomList(0x47E, 0x47F, 0x480, 0x482, 0x66D);

                    int renderMode = Utility.RandomList(0, 2, 3, 4, 5, 7);

                    Effects.PlaySound(endLoc, map, Utility.Random(0x11B, 4));
                    Effects.SendLocationEffect(endLoc, map, 0x373A + (0x10 * Utility.Random(4)), 16, 10, hue, renderMode);</pre>

## Duplicated Code. Size: 287

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\QuestRewardGump.cs

<pre>object o = null;

								try
								{
									o = Activator.CreateInstance( r.RewardType , r.RewardArgs);
								}
								catch {}

								bool received = true;

								if(o is Item)
								{
									// and give them the item
									from.AddToBackpack((Item)o);
								}
								else if(o is Mobile)
								{
									// if it is controllable then set the buyer as master.  Note this does not check for control slot limits.
									if(o is BaseCreature)
									{
										BaseCreature b = o as BaseCreature;
										b.Controlled = true;
										b.ControlMaster = from;
									}

									((Mobile)o).MoveToWorld(from.Location, from.Map);
								}
								else if(o is XmlAttachment)
								{
									XmlAttachment a = o as XmlAttachment;

									XmlAttach.AttachTo(from, a);
								}
								else
								{
                                    from.SendMessage(33, "unable to create {0}.", r.RewardType.Name);
									received = false;
								}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlMobFactions\MobFactionsRewardGump.cs

<pre>object o = null;

                                try{
                                    o = Activator.CreateInstance( r.RewardType , r.RewardArgs);
                                } catch {}

                                bool received = true;

                                if(o is Item)
                                {

                                    // and give them the item
                                    from.AddToBackpack((Item)o);

                                } else
                                if(o is Mobile)
                                {

                                    // if it is controllable then set the buyer as master.  Note this does not check for control slot limits.
                                    if(o is BaseCreature)
                                    {
                                        BaseCreature b = o as BaseCreature;
                                        b.Controlled = true;
                                        b.ControlMaster = from;
                                    }

                                    ((Mobile)o).MoveToWorld(from.Location, from.Map);

                                } else
                                if(o is XmlAttachment)
                                {
                                    XmlAttachment a = o as XmlAttachment;

                                    XmlAttach.AttachTo(from, a);

                                } else
                                {
                                    from.SendMessage(33, "unable to create {0}.", r.RewardType.Name);
                                    received = false;
                                }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\PointsRewardGump.cs

<pre>object o = null;

                                try{
                                    o = Activator.CreateInstance( r.RewardType , r.RewardArgs);
                                } catch {}

                                bool received = true;

                                if(o is Item)
                                {

                                    // and give them the item
                                    from.AddToBackpack((Item)o);

                                } else
                                if(o is Mobile)
                                {

                                    // if it is controllable then set the buyer as master.  Note this does not check for control slot limits.
                                    if(o is BaseCreature)
                                    {
                                        BaseCreature b = o as BaseCreature;
                                        b.Controlled = true;
                                        b.ControlMaster = from;
                                    }

                                    ((Mobile)o).MoveToWorld(from.Location, from.Map);

                                } else
                                if(o is XmlAttachment)
                                {
                                    XmlAttachment a = o as XmlAttachment;

                                    XmlAttach.AttachTo(from, a);

                                } else
                                {
                                    from.SendMessage(33, "unable to create {0}.", r.RewardType.Name);
                                    received = false;
                                }</pre>

## Duplicated Code. Size: 286

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write((byte)type);
			m_Stream.Write(@from);
			m_Stream.Write(to);
			m_Stream.Write((short)itemID);
			m_Stream.Write((short)fromPoint.m_X);
			m_Stream.Write((short)fromPoint.m_Y);
			m_Stream.Write((sbyte)fromPoint.m_Z);
			m_Stream.Write((short)toPoint.m_X);
			m_Stream.Write((short)toPoint.m_Y);
			m_Stream.Write((sbyte)toPoint.m_Z);
			m_Stream.Write((byte)speed);
			m_Stream.Write((byte)duration);
			m_Stream.Write((byte)0);
			m_Stream.Write((byte)0);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write((byte)type);
			m_Stream.Write(@from);
			m_Stream.Write(to);
			m_Stream.Write((short)itemID);
			m_Stream.Write((short)fromPoint.m_X);
			m_Stream.Write((short)fromPoint.m_Y);
			m_Stream.Write((sbyte)fromPoint.m_Z);
			m_Stream.Write((short)toPoint.m_X);
			m_Stream.Write((short)toPoint.m_Y);
			m_Stream.Write((sbyte)toPoint.m_Z);
			m_Stream.Write((byte)speed);
			m_Stream.Write((byte)duration);
			m_Stream.Write((byte)0);
			m_Stream.Write((byte)0);</pre>

## Duplicated Code. Size: 285

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\IceFiend.cs

<pre>this.SetSkill(SkillName.EvalInt, 80.1, 90.0);
            this.SetSkill(SkillName.Magery, 80.1, 90.0);
            this.SetSkill(SkillName.MagicResist, 75.1, 85.0);
            this.SetSkill(SkillName.Tactics, 80.1, 90.0);
            this.SetSkill(SkillName.Wrestling, 80.1, 100.0);

            this.SetResistance(ResistanceType.Physical, 55, 65);
            this.SetResistance(ResistanceType.Fire, 10, 20);
            this.SetResistance(ResistanceType.Cold, 60, 70);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 30, 40);

            this.Fame = 18000;
            this.Karma = -18000;

            this.VirtualArmor = 60;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\PitFiend.cs

<pre>this.SetSkill(SkillName.EvalInt, 80.1, 90.0);
            this.SetSkill(SkillName.Magery, 80.1, 90.0);
            this.SetSkill(SkillName.MagicResist, 75.1, 85.0);
            this.SetSkill(SkillName.Tactics, 80.1, 90.0);
            this.SetSkill(SkillName.Wrestling, 80.1, 100.0);

            this.SetResistance(ResistanceType.Physical, 55, 65);
            this.SetResistance(ResistanceType.Fire, 10, 20);
            this.SetResistance(ResistanceType.Cold, 60, 70);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 30, 40);

            this.Fame = 18000;
            this.Karma = -18000;

            this.VirtualArmor = 60;</pre>

## Duplicated Code. Size: 285

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>public override void InitOutfit()
        {
            if (this.Female)
                this.AddItem(new FancyDress());
            else
                this.AddItem(new FancyShirt(this.GetRandomHue()));

            int lowHue = this.GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new ThighBoots(lowHue));
            else
                this.AddItem(new Boots(lowHue));

            if (!this.Female)
                this.AddItem(new BodySash(lowHue));

            this.AddItem(new Cloak(this.GetRandomHue()));

            if (!this.Female)
                this.AddItem(new Longsword());

            this.PackGold(200, 250);
        }</pre>

Fragment 2 in file Scripts\Quests\Escortables.cs

<pre>public override void InitOutfit()
        {
            if (this.Female)
                this.AddItem(new FancyDress());
            else
                this.AddItem(new FancyShirt(this.GetRandomHue()));

            int lowHue = this.GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new ThighBoots(lowHue));
            else
                this.AddItem(new Boots(lowHue));

            if (!this.Female)
                this.AddItem(new BodySash(lowHue));

            this.AddItem(new Cloak(this.GetRandomHue()));

            if (!this.Female)
                this.AddItem(new Longsword());

            this.PackGold(200, 250);
        }</pre>

## Duplicated Code. Size: 285

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Paragon.cs

<pre>bc.Hue = Hue;

            if (bc.HitsMaxSeed >= 0)
                bc.HitsMaxSeed = (int)(bc.HitsMaxSeed * HitsBuff);

            bc.RawStr = (int)(bc.RawStr * StrBuff);
            bc.RawInt = (int)(bc.RawInt * IntBuff);
            bc.RawDex = (int)(bc.RawDex * DexBuff);

            bc.Hits = bc.HitsMax;
            bc.Mana = bc.ManaMax;
            bc.Stam = bc.StamMax;

            for (int i = 0; i < bc.Skills.Length; i++)
            {
                Skill skill = (Skill)bc.Skills[i];

                if (skill.Base > 0.0)
                    skill.Base *= SkillsBuff;
            }

            bc.PassiveSpeed /= SpeedBuff;
            bc.ActiveSpeed /= SpeedBuff;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlParagon\XmlParagon.cs

<pre>bc.Hue = Hue;

            if (bc.HitsMaxSeed >= 0)
                bc.HitsMaxSeed = (int)(bc.HitsMaxSeed * HitsBuff);

            bc.RawStr = (int)(bc.RawStr * StrBuff);
            bc.RawInt = (int)(bc.RawInt * IntBuff);
            bc.RawDex = (int)(bc.RawDex * DexBuff);

            bc.Hits = bc.HitsMax;
            bc.Mana = bc.ManaMax;
            bc.Stam = bc.StamMax;

            for (int i = 0; i < bc.Skills.Length; i++)
            {
                Skill skill = (Skill)bc.Skills[i];

                if (skill.Base > 0.0)
                    skill.Base *= SkillsBuff;
            }

            bc.PassiveSpeed /= SpeedBuff;
            bc.ActiveSpeed /= SpeedBuff;</pre>

## Duplicated Code. Size: 285

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Paragon.cs

<pre>bc.Hue = 0;

            if (bc.HitsMaxSeed >= 0)
                bc.HitsMaxSeed = (int)(bc.HitsMaxSeed / HitsBuff);

            bc.RawStr = (int)(bc.RawStr / StrBuff);
            bc.RawInt = (int)(bc.RawInt / IntBuff);
            bc.RawDex = (int)(bc.RawDex / DexBuff);

            bc.Hits = bc.HitsMax;
            bc.Mana = bc.ManaMax;
            bc.Stam = bc.StamMax;

            for (int i = 0; i < bc.Skills.Length; i++)
            {
                Skill skill = (Skill)bc.Skills[i];

                if (skill.Base > 0.0)
                    skill.Base /= SkillsBuff;
            }

            bc.PassiveSpeed *= SpeedBuff;
            bc.ActiveSpeed *= SpeedBuff;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlParagon\XmlParagon.cs

<pre>bc.Hue = 0;

            if (bc.HitsMaxSeed >= 0)
                bc.HitsMaxSeed = (int)(bc.HitsMaxSeed / HitsBuff);

            bc.RawStr = (int)(bc.RawStr / StrBuff);
            bc.RawInt = (int)(bc.RawInt / IntBuff);
            bc.RawDex = (int)(bc.RawDex / DexBuff);

            bc.Hits = bc.HitsMax;
            bc.Mana = bc.ManaMax;
            bc.Stam = bc.StamMax;

            for (int i = 0; i < bc.Skills.Length; i++)
            {
                Skill skill = (Skill)bc.Skills[i];

                if (skill.Base > 0.0)
                    skill.Base /= SkillsBuff;
            }

            bc.PassiveSpeed *= SpeedBuff;
            bc.ActiveSpeed *= SpeedBuff;</pre>

## Duplicated Code. Size: 285

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>{
			Serial parentSerial;

			if (item.Parent is Item)
			{
				parentSerial = ((Item)item.Parent).Serial;
			}
			else
			{
				Console.WriteLine("Warning: ContainerContentUpdate on item with !(parent is Item)");
				parentSerial = Serial.Zero;
			}

			m_Stream.Write(item.Serial);
			m_Stream.Write((ushort)item.ItemID);
			m_Stream.Write((byte)0); // signed, itemID offset
			m_Stream.Write((ushort)item.Amount);
			m_Stream.Write((short)item.X);
			m_Stream.Write((short)item.Y);
            m_Stream.Write((byte)item.GridLocation);
            m_Stream.Write(parentSerial);
			m_Stream.Write((ushort)(item.QuestItem ? Item.QuestItemHue : item.Hue));
		}</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>{
			Serial parentSerial;

			if (item.Parent is Item)
			{
				parentSerial = ((Item)item.Parent).Serial;
			}
			else
			{
				Console.WriteLine("Warning: ContainerContentUpdate on item with !(parent is Item)");
				parentSerial = Serial.Zero;
			}

			m_Stream.Write(item.Serial);
			m_Stream.Write((ushort)item.ItemID);
			m_Stream.Write((byte)0); // signed, itemID offset
			m_Stream.Write((ushort)item.Amount);
			m_Stream.Write((short)item.X);
			m_Stream.Write((short)item.Y);
            m_Stream.Write((byte)item.GridLocation);
            m_Stream.Write(parentSerial);
			m_Stream.Write((ushort)(item.QuestItem ? Item.QuestItemHue : item.Hue));
		}</pre>

## Duplicated Code. Size: 284

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\BaseConflagrationPotion.cs

<pre>public override void Drink(Mobile from)
        {
            if (Core.AOS && (from.Paralyzed || from.Frozen || (from.Spell != null && from.Spell.IsCasting)))
            {
                from.SendLocalizedMessage(1062725); // You can not use that potion while paralyzed.
                return;
            }

            int delay = GetDelay(from);

            if (delay > 0)
            {
                from.SendLocalizedMessage(1072529, String.Format("{0}\t{1}", delay, delay > 1 ? "seconds." : "second.")); // You cannot use that for another ~1_NUM~ ~2_TIMEUNITS~
                return;
            }

            ThrowTarget targ = from.Target as ThrowTarget;

            if (targ != null && targ.Potion == this)
                return;

            from.RevealingAction();

            if (!this.m_Users.Contains(from))
                this.m_Users.Add(from);

            from.Target = new ThrowTarget(this);
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\BaseConfusionBlastPotion.cs

<pre>public override void Drink(Mobile from)
        {
            if (Core.AOS && (from.Paralyzed || from.Frozen || (from.Spell != null && from.Spell.IsCasting)))
            {
                from.SendLocalizedMessage(1062725); // You can not use that potion while paralyzed.
                return;
            }

            int delay = GetDelay(from);

            if (delay > 0)
            {
                from.SendLocalizedMessage(1072529, String.Format("{0}\t{1}", delay, delay > 1 ? "seconds." : "second.")); // You cannot use that for another ~1_NUM~ ~2_TIMEUNITS~
                return;
            }

            ThrowTarget targ = from.Target as ThrowTarget;

            if (targ != null && targ.Potion == this)
                return;

            from.RevealingAction();

            if (!this.m_Users.Contains(from))
                this.m_Users.Add(from);

            from.Target = new ThrowTarget(this);
        }</pre>

## Duplicated Code. Size: 284

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if ((prop = this.m_AosAttributes.SpellChanneling) != 0)
                list.Add(1060482); // spell channeling

            if ((prop = this.m_AosAttributes.SpellDamage) != 0)
                list.Add(1060483, prop.ToString()); // spell damage increase ~1_val~%

            if ((prop = this.m_AosAttributes.BonusStam) != 0)
                list.Add(1060484, prop.ToString()); // stamina increase ~1_val~

            if ((prop = this.m_AosAttributes.BonusStr) != 0)
                list.Add(1060485, prop.ToString()); // strength bonus ~1_val~

            if ((prop = this.m_AosAttributes.WeaponSpeed) != 0)
                list.Add(1060486, prop.ToString()); // swing speed increase ~1_val~%

            if (Core.ML && (prop = this.m_AosAttributes.IncreasedKarmaLoss) != 0)
                list.Add(1075210, prop.ToString()); // Increased Karma Loss ~1val~%</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if ((prop = this.m_AosAttributes.SpellChanneling) != 0)
                list.Add(1060482); // spell channeling

            if ((prop = this.m_AosAttributes.SpellDamage) != 0)
                list.Add(1060483, prop.ToString()); // spell damage increase ~1_val~%

            if ((prop = this.m_AosAttributes.BonusStam) != 0)
                list.Add(1060484, prop.ToString()); // stamina increase ~1_val~

            if ((prop = this.m_AosAttributes.BonusStr) != 0)
                list.Add(1060485, prop.ToString()); // strength bonus ~1_val~

            if ((prop = this.m_AosAttributes.WeaponSpeed) != 0)
                list.Add(1060486, prop.ToString()); // swing speed increase ~1_val~%

            if (Core.ML && (prop = this.m_AosAttributes.IncreasedKarmaLoss) != 0)
                list.Add(1075210, prop.ToString()); // Increased Karma Loss ~1val~%</pre>

## Duplicated Code. Size: 284

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Swoop.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (0.1 > Utility.RandomDouble())
            {
                ExpireTimer timer = (ExpireTimer)m_Table[defender];

                if (timer != null)
                {
                    timer.DoExpire();
                    defender.SendLocalizedMessage(1070837); // The creature lands another blow in your weakened state.
                }
                else
                    defender.SendLocalizedMessage(1070836); // The blow from the creature's claws has made you more susceptible to physical attacks.

                int effect = -(defender.PhysicalResistance * 15 / 100);

                ResistanceMod mod = new ResistanceMod(ResistanceType.Physical, effect);

                defender.FixedEffect(0x37B9, 10, 5);
                defender.AddResistanceMod(mod);

                timer = new ExpireTimer(defender, mod, TimeSpan.FromSeconds(5.0));
                timer.Start();
                m_Table[defender] = timer;
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\LesserHiryu.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (0.1 > Utility.RandomDouble())
            {
                /* Grasping Claw
                * Start cliloc: 1070836
                * Effect: Physical resistance -15% for 5 seconds
                * End cliloc: 1070838
                * Effect: Type: "3" - From: "0x57D4F5B" (player) - To: "0x0" - ItemId: "0x37B9" - ItemIdName: "glow" - FromLocation: "(1149 808, 32)" - ToLocation: "(1149 808, 32)" - Speed: "10" - Duration: "5" - FixedDirection: "True" - Explode: "False"
                */
                ExpireTimer timer = (ExpireTimer)m_Table[defender];

                if (timer != null)
                {
                    timer.DoExpire();
                    defender.SendLocalizedMessage(1070837); // The creature lands another blow in your weakened state.
                }
                else
                    defender.SendLocalizedMessage(1070836); // The blow from the creature's claws has made you more susceptible to physical attacks.

                int effect = -(defender.PhysicalResistance * 15 / 100);

                ResistanceMod mod = new ResistanceMod(ResistanceType.Physical, effect);

                defender.FixedEffect(0x37B9, 10, 5);
                defender.AddResistanceMod(mod);

                timer = new ExpireTimer(defender, mod, TimeSpan.FromSeconds(5.0));
                timer.Start();
                m_Table[defender] = timer;
            }
        }</pre>

## Duplicated Code. Size: 284

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>public override void InitOutfit()
        {
            if (this.Female)
                this.AddItem(new FancyDress(this.GetRandomHue()));
            else
                this.AddItem(new FancyShirt(this.GetRandomHue()));

            int lowHue = this.GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new ThighBoots(lowHue));
            else
                this.AddItem(new Boots(lowHue));

            if (!this.Female)
                this.AddItem(new BodySash(lowHue));

            this.AddItem(new Cloak(this.GetRandomHue()));

            this.AddItem(new Longsword());

            this.PackGold(100, 150);
        }</pre>

Fragment 2 in file Scripts\Quests\Escortables.cs

<pre>public override void InitOutfit()
        {
            if (this.Female)
                this.AddItem(new FancyDress(this.GetRandomHue()));
            else
                this.AddItem(new FancyShirt(this.GetRandomHue()));

            int lowHue = this.GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new ThighBoots(lowHue));
            else
                this.AddItem(new Boots(lowHue));

            if (!this.Female)
                this.AddItem(new BodySash(lowHue));

            this.AddItem(new Cloak(this.GetRandomHue()));

            this.AddItem(new Longsword());

            this.PackGold(100, 150);
        }</pre>

## Duplicated Code. Size: 283

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\Teleporter.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);

			int version = reader.ReadInt();

			switch (version)
			{
				case 4:
					{
						m_CriminalCheck = reader.ReadBool();
						goto case 3;
					}
				case 3:
					{
						m_CombatCheck = reader.ReadBool();
						goto case 2;
					}
				case 2:
					{
						m_SourceEffect = reader.ReadBool();
						m_DestEffect = reader.ReadBool();
						m_Delay = reader.ReadTimeSpan();
						m_SoundID = reader.ReadEncodedInt();

						goto case 1;
					}
				case 1:
					{
						m_Creatures = reader.ReadBool();

						goto case 0;
					}
				case 0:
					{
						m_Active = reader.ReadBool();
						m_PointDest = reader.ReadPoint3D();
						m_MapDest = reader.ReadMap();

						break;
					}
			}
		}</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\Teleporter\Whirlpool.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch (version)
            {
                case 4:
                    {
                        m_CriminalCheck = reader.ReadBool();
                        goto case 3;
                    }
                case 3:
                    {
                        m_CombatCheck = reader.ReadBool();
                        goto case 2;
                    }
                case 2:
                    {
                        m_SourceEffect = reader.ReadBool();
                        m_DestEffect = reader.ReadBool();
                        m_Delay = reader.ReadTimeSpan();
                        m_SoundID = reader.ReadEncodedInt();

                        goto case 1;
                    }
                case 1:
                    {
                        m_Creatures = reader.ReadBool();

                        goto case 0;
                    }
                case 0:
                    {
                        m_Active = reader.ReadBool();
                        m_PointDest = reader.ReadPoint3D();
                        m_MapDest = reader.ReadMap();

                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 283

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>{
			List<XmlAttachment> list;
			if(o == null || attachments == null || o.Deleted || !attachments.TryGetValue(o, out list) || list==null) return null;

			if (type == null && name == null)
			{
				// return the first valid attachment
				foreach (XmlAttachment i in list)
				{
					if (i != null && !i.Deleted)
						return i;
				}
			}
			else
			{
				// just get those of a particular type and/or name
				foreach (XmlAttachment i in list)
				{
					// see if it is deleted
					if (i == null || i.Deleted)
						continue;

					Type itype = i.GetType();

					if ((type == null || (itype != null && (itype == type || itype.IsSubclassOf(type)))) && (name == null || (name == i.Name)))
					{
						return i;
					}
				}
			}
			return null;
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>{
			List<XmlAttachment> list;
			if(o == null || attachments == null || o.Deleted || !attachments.TryGetValue(o, out list) || list==null) return null;

			if (type == null && name == null)
			{
				// return the first valid attachment
				foreach (XmlAttachment i in list)
				{
					if (i != null && !i.Deleted)
						return i;
				}
			}
			else
			{
				// just get those of a particular type and/or name
				foreach (XmlAttachment i in list)
				{
					// see if it is deleted
					if (i == null || i.Deleted)
						continue;

					Type itype = i.GetType();

					if ((type == null || (itype != null && (itype == type || itype.IsSubclassOf(type)))) && (name == null || (name == i.Name)))
					{
						return i;
					}
				}
			}
			return null;
		}</pre>

## Duplicated Code. Size: 282

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\EggBomb.cs

<pre>public override void OnDoubleClick(Mobile from)
		{
			if (!IsChildOf(from.Backpack))
			{
				// The item must be in your backpack to use it.
				from.SendLocalizedMessage(1060640);
			}
			else if (from.Skills.Ninjitsu.Value < 50.0)
			{
				// You need at least ~1_SKILL_REQUIREMENT~ ~2_SKILL_NAME~ skill to use that ability.
				from.SendLocalizedMessage(1063013, "50\tNinjitsu");
			}
			else if (from.NextSkillTime > Core.TickCount)
			{
				// You must wait a few seconds before you can use that item.
				from.SendLocalizedMessage(1070772);
			}
			else if (from.Mana < 10)
			{
				// You don't have enough mana to do that.
				from.SendLocalizedMessage(1049456);
			}
			else
			{
				Hiding.CombatOverride = true;

				if (from.UseSkill(SkillName.Hiding))
				{
					from.Mana -= 10;

					from.FixedParticles(0x3709, 1, 30, 9904, 1108, 6, EffectLayer.RightFoot);
					from.PlaySound(0x22F);

					Consume();
				}

				Hiding.CombatOverride = false;
			}
		}</pre>

Fragment 2 in file Scripts\Items\Consumables\SmokeBomb.cs

<pre>public override void OnDoubleClick(Mobile from)
		{
			if (!IsChildOf(from.Backpack))
			{
				// The item must be in your backpack to use it.
				from.SendLocalizedMessage(1060640);
			}
			else if (from.Skills.Ninjitsu.Value < 50.0)
			{
				// You need at least ~1_SKILL_REQUIREMENT~ ~2_SKILL_NAME~ skill to use that ability.
				from.SendLocalizedMessage(1063013, "50\tNinjitsu");
			}
			else if (from.NextSkillTime > Core.TickCount)
			{
				// You must wait a few seconds before you can use that item.
				from.SendLocalizedMessage(1070772);
			}
			else if (from.Mana < 10)
			{
				// You don't have enough mana to do that.
				from.SendLocalizedMessage(1049456);
			}
			else
			{
				Hiding.CombatOverride = true;

				if (from.UseSkill(SkillName.Hiding))
				{
					from.Mana -= 10;

					from.FixedParticles(0x3709, 1, 30, 9904, 1108, 6, EffectLayer.RightFoot);
					from.PlaySound(0x22F);

					Consume();
				}

				Hiding.CombatOverride = false;
			}
		}</pre>

## Duplicated Code. Size: 282

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseRenowned.cs

<pre>public void AwardArtifact(Item artifact)
        {
            if (artifact == null)
                return;

            int totalDamage = 0;

            Dictionary<Mobile, int> validEntries = new Dictionary<Mobile, int>();

            foreach (KeyValuePair<Mobile, int> kvp in this.m_DamageEntries)
            {
                if (this.IsEligible(kvp.Key, artifact))
                {
                    validEntries.Add(kvp.Key, kvp.Value);
                    totalDamage += kvp.Value;
                }
            }

            int randomDamage = Utility.RandomMinMax(1, totalDamage);

            totalDamage = 0;

            foreach (KeyValuePair<Mobile, int> kvp in this.m_DamageEntries)
            {
                totalDamage += kvp.Value;

                if (totalDamage > randomDamage)
                {
                    this.GiveArtifact(kvp.Key, artifact);
                    break;
                }
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseSABosses.cs

<pre>public void AwardArtifact(Item artifact)
        {
            if (artifact == null)
                return;

            int totalDamage = 0;

            Dictionary<Mobile, int> validEntries = new Dictionary<Mobile, int>();

            foreach (KeyValuePair<Mobile, int> kvp in this.m_DamageEntries)
            {
                if (this.IsEligible(kvp.Key, artifact))
                {
                    validEntries.Add(kvp.Key, kvp.Value);
                    totalDamage += kvp.Value;
                }
            }

            int randomDamage = Utility.RandomMinMax(1, totalDamage);

            totalDamage = 0;

            foreach (KeyValuePair<Mobile, int> kvp in this.m_DamageEntries)
            {
                totalDamage += kvp.Value;

                if (totalDamage > randomDamage)
                {
                    this.GiveArtifact(kvp.Key, artifact);
                    break;
                }
            }
        }</pre>

## Duplicated Code. Size: 281

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\ResurrectGump.cs

<pre>this.AddButton(290, 175, 247, 248, 2, GumpButtonType.Reply, 0);

            this.AddImageTiled(15, 14, 365, 1, 9107);
            this.AddImageTiled(380, 14, 1, 190, 9105);
            this.AddImageTiled(15, 205, 365, 1, 9107);
            this.AddImageTiled(15, 14, 1, 190, 9105);
            this.AddImageTiled(0, 0, 395, 1, 9157);
            this.AddImageTiled(394, 0, 1, 217, 9155);
            this.AddImageTiled(0, 216, 395, 1, 9157);
            this.AddImageTiled(0, 0, 1, 217, 9155);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Chyloth.cs

<pre>this.AddButton(290, 175, 247, 248, 2, GumpButtonType.Reply, 0);

            this.AddImageTiled(15, 14, 365, 1, 9107);
            this.AddImageTiled(380, 14, 1, 190, 9105);
            this.AddImageTiled(15, 205, 365, 1, 9107);
            this.AddImageTiled(15, 14, 1, 190, 9105);
            this.AddImageTiled(0, 0, 395, 1, 9157);
            this.AddImageTiled(394, 0, 1, 217, 9155);
            this.AddImageTiled(0, 216, 395, 1, 9157);
            this.AddImageTiled(0, 0, 1, 217, 9155);</pre>

## Duplicated Code. Size: 281

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGauntlet.cs

<pre>int count = reader.ReadInt();
                for(int i = 0;i<count;i++)
                {
                    ChallengeEntry entry = new ChallengeEntry();
                    entry.Participant = reader.ReadMobile();
                    string sname = reader.ReadString();
                    // look up the enum by name
                    ChallengeStatus status = ChallengeStatus.None;
                    try{
                    status = (ChallengeStatus)Enum.Parse(typeof(ChallengeStatus), sname);
                    } catch{}
                    entry.Status = status;
                    entry.Accepted = reader.ReadBool();
                    entry.PageBeingViewed = reader.ReadInt();
                    entry.Score = reader.ReadInt();
                    entry.Winner = reader.ReadBool();
                    entry.Team = reader.ReadInt();

                    Participants.Add(entry);
                }
                break;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGauntlet.cs

<pre>int count = reader.ReadInt();
                for(int i = 0;i<count;i++)
                {
                    ChallengeEntry entry = new ChallengeEntry();
                    entry.Participant = reader.ReadMobile();
                    string sname = reader.ReadString();
                    // look up the enum by name
                    ChallengeStatus status = ChallengeStatus.None;
                    try{
                    status = (ChallengeStatus)Enum.Parse(typeof(ChallengeStatus), sname);
                    } catch{}
                    entry.Status = status;
                    entry.Accepted = reader.ReadBool();
                    entry.PageBeingViewed = reader.ReadInt();
                    entry.Score = reader.ReadInt();
                    entry.Winner = reader.ReadBool();
                    entry.Team = reader.ReadInt();

                    Participants.Add(entry);
                }
                break;</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGauntlet.cs

<pre>int count = reader.ReadInt();
                for(int i = 0;i<count;i++)
                {
                    ChallengeEntry entry = new ChallengeEntry();
                    entry.Participant = reader.ReadMobile();
                    string sname = reader.ReadString();
                    // look up the enum by name
                    ChallengeStatus status = ChallengeStatus.None;
                    try{
                    status = (ChallengeStatus)Enum.Parse(typeof(ChallengeStatus), sname);
                    } catch{}
                    entry.Status = status;
                    entry.Accepted = reader.ReadBool();
                    entry.PageBeingViewed = reader.ReadInt();
                    entry.Score = reader.ReadInt();
                    entry.Winner = reader.ReadBool();
                    entry.Team = reader.ReadInt();

                    Participants.Add(entry);
                }
                break;</pre>

## Duplicated Code. Size: 279

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\AbyssalInfernal.cs

<pre>this.SetDamageType(ResistanceType.Physical, 25);
            this.SetDamageType(ResistanceType.Fire, 50);
            this.SetDamageType(ResistanceType.Energy, 25);

            this.SetResistance(ResistanceType.Physical, 80, 90);
            this.SetResistance(ResistanceType.Fire, 80, 90);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 80, 90);
            this.SetResistance(ResistanceType.Energy, 80, 90);

            this.SetSkill(SkillName.Anatomy, 100.0);
            this.SetSkill(SkillName.MagicResist, 140.2, 160.0);
            this.SetSkill(SkillName.Tactics, 100.0);

            this.Fame = 22500;
            this.Karma = -22500;</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\Rikktor.cs

<pre>this.SetDamageType(ResistanceType.Physical, 25);
            this.SetDamageType(ResistanceType.Fire, 50);
            this.SetDamageType(ResistanceType.Energy, 25);

            this.SetResistance(ResistanceType.Physical, 80, 90);
            this.SetResistance(ResistanceType.Fire, 80, 90);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 80, 90);
            this.SetResistance(ResistanceType.Energy, 80, 90);

            this.SetSkill(SkillName.Anatomy, 100.0);
            this.SetSkill(SkillName.MagicResist, 140.2, 160.0);
            this.SetSkill(SkillName.Tactics, 100.0);

            this.Fame = 22500;
            this.Karma = -22500;</pre>

## Duplicated Code. Size: 279

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ChaosDragoon.cs

<pre>CraftResource res = CraftResource.None;

            switch (Utility.Random(6))
            {
                case 0:
                    res = CraftResource.BlackScales;
                    break;
                case 1:
                    res = CraftResource.RedScales;
                    break;
                case 2:
                    res = CraftResource.BlueScales;
                    break;
                case 3:
                    res = CraftResource.YellowScales;
                    break;
                case 4:
                    res = CraftResource.GreenScales;
                    break;
                case 5:
                    res = CraftResource.WhiteScales;
                    break;
            }

            BaseWeapon melee = null;

            switch (Utility.Random(3))
            {
                case 0:
                    melee = new Kryss();
                    break;
                case 1:
                    melee = new Broadsword();
                    break;
                case 2:
                    melee = new Katana();
                    break;
            }

            melee.Movable = false;
            this.AddItem(melee);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ChaosDragoonElite.cs

<pre>CraftResource res = CraftResource.None;

            switch (Utility.Random(6))
            {
                case 0:
                    res = CraftResource.BlackScales;
                    break;
                case 1:
                    res = CraftResource.RedScales;
                    break;
                case 2:
                    res = CraftResource.BlueScales;
                    break;
                case 3:
                    res = CraftResource.YellowScales;
                    break;
                case 4:
                    res = CraftResource.GreenScales;
                    break;
                case 5:
                    res = CraftResource.WhiteScales;
                    break;
            }

            BaseWeapon melee = null;

            switch (Utility.Random(3))
            {
                case 0:
                    melee = new Kryss();
                    break;
                case 1:
                    melee = new Broadsword();
                    break;
                case 2:
                    melee = new Katana();
                    break;
            }

            melee.Movable = false;
            this.AddItem(melee);</pre>

## Duplicated Code. Size: 279

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Reports\Objects\Staffing\StaffHistory.cs

<pre>barGraph.FontSize = 6;

            for (int i = 7; i <= totals.Length + 7; ++i)
            {
                int val;

                if (counts[i % totals.Length] == 0)
                    val = 0;
                else
                    val = (totals[i % totals.Length] + (counts[i % totals.Length] / 2)) / counts[i % totals.Length];

                int realHours = i % totals.Length;
                int hours;

                if (realHours == 0)
                    hours = 12;
                else if (realHours > 12)
                    hours = realHours - 12;
                else
                    hours = realHours;

                barGraph.Items.Add(hours + (realHours >= 12 ? " PM" : " AM"), val);
            }

            return barGraph;</pre>

Fragment 2 in file Scripts\Services\Reports\Objects\Staffing\StaffHistory.cs

<pre>barGraph.FontSize = 6;

            for (int i = 7; i <= totals.Length + 7; ++i)
            {
                int val;

                if (counts[i % totals.Length] == 0)
                    val = 0;
                else
                    val = (totals[i % totals.Length] + (counts[i % totals.Length] / 2)) / counts[i % totals.Length];

                int realHours = i % totals.Length;
                int hours;

                if (realHours == 0)
                    hours = 12;
                else if (realHours > 12)
                    hours = realHours - 12;
                else
                    hours = realHours;

                barGraph.Items.Add(hours + (realHours >= 12 ? " PM" : " AM"), val);
            }

            return barGraph;</pre>

## Duplicated Code. Size: 278

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Medusa.cs

<pre>bool validLocation = false;
                    Point3D loc = Location;

                    for (int j = 0; !validLocation && j < 10; ++j)
                    {
                        int x = X + Utility.Random(10) - 1;
                        int y = Y + Utility.Random(10) - 1;
                        int z = map.GetAverageZ(x, y);

                        if (validLocation = map.CanFit(x, y, Z, 16, false, false))
                            loc = new Point3D(x, y, Z);
                        else if (validLocation = map.CanFit(x, y, z, 16, false, false))
                            loc = new Point3D(x, y, z);
                    }</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\Medusa.cs

<pre>bool validLocation = false;
                Point3D loc = Location;

                for (int j = 0; !validLocation && j < 10; ++j)
                {
                    int x = X + Utility.Random(10) - 1;
                    int y = Y + Utility.Random(10) - 1;
                    int z = map.GetAverageZ(x, y);

                    if (validLocation = map.CanFit(x, y, Z, 16, false, false))
                        loc = new Point3D(x, y, Z);
                    else if (validLocation = map.CanFit(x, y, z, 16, false, false))
                        loc = new Point3D(x, y, z);
                }</pre>

## Duplicated Code. Size: 278

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\CauldronOfTransmutation.cs

<pre>public void Decay()
        {
            if (RootParent is Mobile)
            {
                Mobile parent = (Mobile)RootParent;

                if (Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            Delete();
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\CauldronOfTransmutation.cs

<pre>public void Decay()
        {
            if (RootParent is Mobile)
            {
                Mobile parent = (Mobile)RootParent;

                if (Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            Delete();
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\HarvestMap.cs

<pre>public void Decay()
        {
            if (RootParent is Mobile)
            {
                Mobile parent = (Mobile)RootParent;

                if (Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            Delete();
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\MagicFishFinder.cs

<pre>public void Decay()
        {
            if (RootParent is Mobile)
            {
                Mobile parent = (Mobile)RootParent;

                if (Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            Delete();
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\SmeltersTalisman.cs

<pre>public void Decay()
        {
            if (RootParent is Mobile)
            {
                Mobile parent = (Mobile)RootParent;

                if (Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            Delete();
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\TemporaryForge.cs

<pre>public void Decay()
        {
            if (RootParent is Mobile)
            {
                Mobile parent = (Mobile)RootParent;

                if (Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            Delete();
        }</pre>

Fragment 7 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\TemporaryForge.cs

<pre>public void Decay()
        {
            if (RootParent is Mobile)
            {
                Mobile parent = (Mobile)RootParent;

                if (Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            Delete();
        }</pre>

Fragment 8 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\WoodsmanTalisman.cs

<pre>public void Decay()
        {
            if (RootParent is Mobile)
            {
                Mobile parent = (Mobile)RootParent;

                if (Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);
            }
            else
            {
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }

            Delete();
        }</pre>

## Duplicated Code. Size: 277

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if ((prop = this.m_AosAttributes.BonusMana) != 0)
                list.Add(1060439, prop.ToString()); // mana increase ~1_val~

            if ((prop = this.m_AosAttributes.RegenMana) != 0)
                list.Add(1060440, prop.ToString()); // mana regeneration ~1_val~

            if ((prop = this.m_AosAttributes.NightSight) != 0)
                list.Add(1060441); // night sight

            if ((prop = this.m_AosAttributes.ReflectPhysical) != 0)
                list.Add(1060442, prop.ToString()); // reflect physical damage ~1_val~%

            if ((prop = this.m_AosAttributes.RegenStam) != 0)
                list.Add(1060443, prop.ToString()); // stamina regeneration ~1_val~

            if ((prop = this.m_AosAttributes.RegenHits) != 0)
                list.Add(1060444, prop.ToString()); // hit point regeneration ~1_val~</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if ((prop = this.m_AosAttributes.BonusMana) != 0)
                list.Add(1060439, prop.ToString()); // mana increase ~1_val~

            if ((prop = this.m_AosAttributes.RegenMana) != 0)
                list.Add(1060440, prop.ToString()); // mana regeneration ~1_val~

            if ((prop = this.m_AosAttributes.NightSight) != 0)
                list.Add(1060441); // night sight

            if ((prop = this.m_AosAttributes.ReflectPhysical) != 0)
                list.Add(1060442, prop.ToString()); // reflect physical damage ~1_val~%

            if ((prop = this.m_AosAttributes.RegenStam) != 0)
                list.Add(1060443, prop.ToString()); // stamina regeneration ~1_val~

            if ((prop = this.m_AosAttributes.RegenHits) != 0)
                list.Add(1060444, prop.ToString()); // hit point regeneration ~1_val~</pre>

## Duplicated Code. Size: 277

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Spellbooks\Spellbook.cs

<pre>if ((prop = m_AosAttributes.BonusMana) != 0)
			{
				list.Add(1060439, prop.ToString()); // mana increase ~1_val~
			}

			if ((prop = m_AosAttributes.RegenMana) != 0)
			{
				list.Add(1060440, prop.ToString()); // mana regeneration ~1_val~
			}

			if ((prop = m_AosAttributes.NightSight) != 0)
			{
				list.Add(1060441); // night sight
			}

			if ((prop = m_AosAttributes.ReflectPhysical) != 0)
			{
				list.Add(1060442, prop.ToString()); // reflect physical damage ~1_val~%
			}

			if ((prop = m_AosAttributes.RegenStam) != 0)
			{
				list.Add(1060443, prop.ToString()); // stamina regeneration ~1_val~
			}

			if ((prop = m_AosAttributes.RegenHits) != 0)
			{
				list.Add(1060444, prop.ToString()); // hit point regeneration ~1_val~
			}</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if ((prop = m_AosAttributes.BonusMana) != 0)
			{
				list.Add(1060439, prop.ToString()); // mana increase ~1_val~
			}

			if ((prop = m_AosAttributes.RegenMana) != 0)
			{
				list.Add(1060440, prop.ToString()); // mana regeneration ~1_val~
			}

			if ((prop = m_AosAttributes.NightSight) != 0)
			{
				list.Add(1060441); // night sight
			}

			if ((prop = m_AosAttributes.ReflectPhysical) != 0)
			{
				list.Add(1060442, prop.ToString()); // reflect physical damage ~1_val~%
			}

			if ((prop = m_AosAttributes.RegenStam) != 0)
			{
				list.Add(1060443, prop.ToString()); // stamina regeneration ~1_val~
			}

			if ((prop = m_AosAttributes.RegenHits) != 0)
			{
				list.Add(1060444, prop.ToString()); // hit point regeneration ~1_val~
			}</pre>

## Duplicated Code. Size: 277

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>int highSlot = -1;

			for (int i = 0; i < a.Length; ++i)
			{
				if (a[i] != null)
				{
					highSlot = i;
				}
			}

			int count = Math.Max(Math.Max(highSlot + 1, a.Limit), 5);

			m_Stream.Write((byte)count);

			for (int i = 0; i < count; ++i)
			{
				if (a[i] != null)
				{
					m_Stream.WriteAsciiFixed(a[i].Name, 30);
					m_Stream.Fill(30); // password
				}
				else
				{
					m_Stream.Fill(60);
				}
			}

			m_Stream.Write((byte)info.Length);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>int highSlot = -1;

			for (int i = 0; i < a.Length; ++i)
			{
				if (a[i] != null)
				{
					highSlot = i;
				}
			}

			int count = Math.Max(Math.Max(highSlot + 1, a.Limit), 5);

			m_Stream.Write((byte)count);

			for (int i = 0; i < count; ++i)
			{
				if (a[i] != null)
				{
					m_Stream.WriteAsciiFixed(a[i].Name, 30);
					m_Stream.Fill(30); // password
				}
				else
				{
					m_Stream.Fill(60);
				}
			}

			m_Stream.Write((byte)info.Length);</pre>

## Duplicated Code. Size: 276

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>item.MoveToWorld(loc, maps[j]);
                        ++count;

                        if (item is BaseDoor)
                        {
                            IPooledEnumerable eable = maps[j].GetItemsInRange(loc, 1);

                            Type itemType = item.GetType();

                            foreach (Item link in eable)
                            {
                                if (link != item && link.Z == item.Z && link.GetType() == itemType)
                                {
                                    ((BaseDoor)item).Link = (BaseDoor)link;
                                    ((BaseDoor)link).Link = (BaseDoor)item;
                                    break;
                                }
                            }

                            eable.Free();
                        }
                        else if (item is MarkContainer)
                        {
                            try
                            {
                                ((MarkContainer)item).Target = Point3D.Parse(extra);
                            }
                            catch
                            {
                            }
                        }</pre>

Fragment 2 in file Scripts\Commands\DecorateMag.cs

<pre>item.MoveToWorld(loc, maps[j]);
                        ++count;

                        if (item is BaseDoor)
                        {
                            IPooledEnumerable eable = maps[j].GetItemsInRange(loc, 1);

                            Type itemType = item.GetType();

                            foreach (Item link in eable)
                            {
                                if (link != item && link.Z == item.Z && link.GetType() == itemType)
                                {
                                    ((BaseDoor)item).Link = (BaseDoor)link;
                                    ((BaseDoor)link).Link = (BaseDoor)item;
                                    break;
                                }
                            }

                            eable.Free();
                        }
                        else if (item is MarkContainer)
                        {
                            try
                            {
                                ((MarkContainer)item).Target = Point3D.Parse(extra);
                            }
                            catch
                            {
                            }
                        }</pre>

## Duplicated Code. Size: 276

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>int changes = 0;

            BitArray defs;

            if (ruleset.Flavors.Count > 0)
            {
                defs = new BitArray(basedef.Options);

                for (int i = 0; i < ruleset.Flavors.Count; ++i)
                    defs.Or(((Ruleset)ruleset.Flavors[i]).Options);

                height += ruleset.Flavors.Count * 18;
            }
            else
            {
                defs = basedef.Options;
            }

            BitArray opts = ruleset.Options;

            for (int i = 0; i < opts.Length; ++i)
            {
                if (defs[i] != opts[i])
                    ++changes;
            }

            height += (changes * 22);

            height += 10 + 22 + 25 + 25;</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>int changes = 0;

            BitArray defs;

            if (ruleset.Flavors.Count > 0)
            {
                defs = new BitArray(basedef.Options);

                for (int i = 0; i < ruleset.Flavors.Count; ++i)
                    defs.Or(((Ruleset)ruleset.Flavors[i]).Options);

                height += ruleset.Flavors.Count * 18;
            }
            else
            {
                defs = basedef.Options;
            }

            BitArray opts = ruleset.Options;

            for (int i = 0; i < opts.Length; ++i)
            {
                if (defs[i] != opts[i])
                    ++changes;
            }

            height += (changes * 22);

            height += 10 + 22 + 25 + 25;</pre>

## Duplicated Code. Size: 276

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBarkeeper.cs

<pre>this.Add(new GenericBuyInfo(typeof(ApplePie), 7, 20, 0x1041, 0)); //OSI just has Pie, not Apple/Fruit/Meat

                this.Add(new GenericBuyInfo("1016450", typeof(Chessboard), 2, 20, 0xFA6, 0));
                this.Add(new GenericBuyInfo("1016449", typeof(CheckerBoard), 2, 20, 0xFA6, 0));
                this.Add(new GenericBuyInfo(typeof(Backgammon), 2, 20, 0xE1C, 0));
                this.Add(new GenericBuyInfo(typeof(Dices), 2, 20, 0xFA7, 0));
                this.Add(new GenericBuyInfo("1041243", typeof(ContractOfEmployment), 1252, 20, 0x14F0, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBTavernKeeper.cs

<pre>this.Add(new GenericBuyInfo(typeof(ApplePie), 7, 20, 0x1041, 0)); //OSI just has Pie, not Apple/Fruit/Meat

                this.Add(new GenericBuyInfo("1016450", typeof(Chessboard), 2, 20, 0xFA6, 0));
                this.Add(new GenericBuyInfo("1016449", typeof(CheckerBoard), 2, 20, 0xFA6, 0));
                this.Add(new GenericBuyInfo(typeof(Backgammon), 2, 20, 0xE1C, 0));
                this.Add(new GenericBuyInfo(typeof(Dices), 2, 20, 0xFA7, 0));
                this.Add(new GenericBuyInfo("1041243", typeof(ContractOfEmployment), 1252, 20, 0x14F0, 0));</pre>

## Duplicated Code. Size: 276

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\GypsyAnimalTrainer.cs

<pre>if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.OuterLegs);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.InnerLegs);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.OuterTorso);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.InnerTorso);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.Shirt);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\GypsyBanker.cs

<pre>if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.OuterLegs);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.InnerLegs);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.OuterTorso);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.InnerTorso);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.Shirt);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\IronWorker.cs

<pre>if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.OuterLegs);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.InnerLegs);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.OuterTorso);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.InnerTorso);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}

			item = FindItemOnLayer(Layer.Shirt);

			if (item != null)
			{
				item.Hue = Utility.RandomBrightHue();
			}</pre>

## Duplicated Code. Size: 275

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\Abilities.cs

<pre>if (checkguildparty)
            {
                //Guilds
                Guild fromguild = GetGuild(from);
                Guild toguild = GetGuild(to);

                if (fromguild != null && toguild != null)
                    if (fromguild == toguild || fromguild.IsAlly(toguild))
                        return !harm;

                //Parties
                Party p = GetParty(from);

                if (p != null && p.Contains(to))
                    return !harm;
            }

            //Default
            if (harm)
                return (IsGoodGuy(from) && !(IsGoodGuy(to))) | (!(IsGoodGuy(from)) && IsGoodGuy(to));
            else
                return (IsGoodGuy(from) && IsGoodGuy(to)) | (!(IsGoodGuy(from)) && !(IsGoodGuy(to)));</pre>

Fragment 2 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>if (checkguildparty)
            {
                //Guilds
                Guild fromguild = GetGuild(from);
                Guild toguild = GetGuild(to);

                if (fromguild != null && toguild != null)
                    if (fromguild == toguild || fromguild.IsAlly(toguild))
                        return !harm;

                //Parties
                Party p = GetParty(from);

                if (p != null && p.Contains(to))
                    return !harm;
            }

            //Default
            if (harm)
                return (IsGoodGuy(from) && !(IsGoodGuy(to))) | (!(IsGoodGuy(from)) && IsGoodGuy(to));
            else
                return (IsGoodGuy(from) && IsGoodGuy(to)) | (!(IsGoodGuy(from)) && !(IsGoodGuy(to)));</pre>

## Duplicated Code. Size: 275

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>new XmlSpawner(SpawnId, x, y, 0, 0, spawnername, totalmaxcount,
										TimeSpan.FromMinutes(mindelay), TimeSpan.FromMinutes(maxdelay), TimeSpan.FromMinutes(0), -1, defaultTriggerSound, 1,
										0, homerange, false, so, TimeSpan.FromMinutes(0), TimeSpan.FromMinutes(0), TimeSpan.FromMinutes(0),
										TimeSpan.FromMinutes(0), null, null, null, null, null,
										null, null, null, null, 1, null, false, defTODMode, defKillReset, false, -1, null, false, false, false, null,
										TimeSpan.FromHours(0), null, false, null)</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>new XmlSpawner(SpawnId, x, y, 0, 0, spawnername, totalmaxcount,
										TimeSpan.FromMinutes(mindelay), TimeSpan.FromMinutes(maxdelay), TimeSpan.FromMinutes(0), -1, defaultTriggerSound, 1,
										0, homerange, false, so, TimeSpan.FromMinutes(0), TimeSpan.FromMinutes(0), TimeSpan.FromMinutes(0),
										TimeSpan.FromMinutes(0), null, null, null, null, null,
										null, null, null, null, 1, null, false, defTODMode, defKillReset, false, -1, null, false, false, false, null,
										TimeSpan.FromHours(0), null, false, null)</pre>

## Duplicated Code. Size: 275

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>new XmlSpawner(SpawnId, x, y, 0, 0, spawnername, maxcount,
									TimeSpan.FromMinutes(mindelay), TimeSpan.FromMinutes(maxdelay), TimeSpan.FromMinutes(0), -1, defaultTriggerSound, 1,
									0, homerange, false, so, TimeSpan.FromMinutes(0), TimeSpan.FromMinutes(0), TimeSpan.FromMinutes(0),
									TimeSpan.FromMinutes(0), null, null, null, null, null,
									null, null, null, null, 1, null, false, defTODMode, defKillReset, false, -1, null, false, false, false, null,
									TimeSpan.FromHours(0), null, false, null)</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>new XmlSpawner(SpawnId, x, y, 0, 0, spawnername, maxcount,
										TimeSpan.FromMinutes(mindelay), TimeSpan.FromMinutes(maxdelay), TimeSpan.FromMinutes(0), -1, defaultTriggerSound, 1,
										0, homerange, false, so, TimeSpan.FromMinutes(0), TimeSpan.FromMinutes(0), TimeSpan.FromMinutes(0),
										TimeSpan.FromMinutes(0), null, null, null, null, null,
										null, null, null, null, 1, null, false, defTODMode, defKillReset, false, -1, null, false, false, false, null,
										TimeSpan.FromHours(0), null, false, null)</pre>

## Duplicated Code. Size: 274

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Blacksmith.cs

<pre>public override Item CreateBulkOrder(Mobile from, bool fromContextMenu)
        {
            PlayerMobile pm = from as PlayerMobile;

            if (pm != null && pm.NextSmithBulkOrder == TimeSpan.Zero && (fromContextMenu || 0.2 > Utility.RandomDouble()))
            {
                double theirSkill = pm.Skills[SkillName.Blacksmith].Base;

                if (theirSkill >= 70.1)
                    pm.NextSmithBulkOrder = TimeSpan.FromHours(6.0);
                else if (theirSkill >= 50.1)
                    pm.NextSmithBulkOrder = TimeSpan.FromHours(2.0);
                else
                    pm.NextSmithBulkOrder = TimeSpan.FromHours(1.0);

                if (theirSkill >= 70.1 && ((theirSkill - 40.0) / 300.0) > Utility.RandomDouble())
                    return new LargeSmithBOD();

                return SmallSmithBOD.CreateRandomFor(from);
            }

            return null;
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Weaponsmith.cs

<pre>public override Item CreateBulkOrder(Mobile from, bool fromContextMenu)
        {
            PlayerMobile pm = from as PlayerMobile;

            if (pm != null && pm.NextSmithBulkOrder == TimeSpan.Zero && (fromContextMenu || 0.2 > Utility.RandomDouble()))
            {
                double theirSkill = pm.Skills[SkillName.Blacksmith].Base;

                if (theirSkill >= 70.1)
                    pm.NextSmithBulkOrder = TimeSpan.FromHours(6.0);
                else if (theirSkill >= 50.1)
                    pm.NextSmithBulkOrder = TimeSpan.FromHours(2.0);
                else
                    pm.NextSmithBulkOrder = TimeSpan.FromHours(1.0);

                if (theirSkill >= 70.1 && ((theirSkill - 40.0) / 300.0) > Utility.RandomDouble())
                    return new LargeSmithBOD();

                return SmallSmithBOD.CreateRandomFor(from);
            }

            return null;
        }</pre>

## Duplicated Code. Size: 274

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Tailor.cs

<pre>public override Item CreateBulkOrder(Mobile from, bool fromContextMenu)
        {
            PlayerMobile pm = from as PlayerMobile;

            if (pm != null && pm.NextTailorBulkOrder == TimeSpan.Zero && (fromContextMenu || 0.2 > Utility.RandomDouble()))
            {
                double theirSkill = pm.Skills[SkillName.Tailoring].Base;

                if (theirSkill >= 70.1)
                    pm.NextTailorBulkOrder = TimeSpan.FromHours(6.0);
                else if (theirSkill >= 50.1)
                    pm.NextTailorBulkOrder = TimeSpan.FromHours(2.0);
                else
                    pm.NextTailorBulkOrder = TimeSpan.FromHours(1.0);

                if (theirSkill >= 70.1 && ((theirSkill - 40.0) / 300.0) > Utility.RandomDouble())
                    return new LargeTailorBOD();

                return SmallTailorBOD.CreateRandomFor(from);
            }

            return null;
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Weaver.cs

<pre>public override Item CreateBulkOrder(Mobile from, bool fromContextMenu)
        {
            PlayerMobile pm = from as PlayerMobile;

            if (pm != null && pm.NextTailorBulkOrder == TimeSpan.Zero && (fromContextMenu || 0.2 > Utility.RandomDouble()))
            {
                double theirSkill = pm.Skills[SkillName.Tailoring].Base;

                if (theirSkill >= 70.1)
                    pm.NextTailorBulkOrder = TimeSpan.FromHours(6.0);
                else if (theirSkill >= 50.1)
                    pm.NextTailorBulkOrder = TimeSpan.FromHours(2.0);
                else
                    pm.NextTailorBulkOrder = TimeSpan.FromHours(1.0);

                if (theirSkill >= 70.1 && ((theirSkill - 40.0) / 300.0) > Utility.RandomDouble())
                    return new LargeTailorBOD();

                return SmallTailorBOD.CreateRandomFor(from);
            }

            return null;
        }</pre>

## Duplicated Code. Size: 274

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Gumps\FactionStoneGump.cs

<pre>this.AddHtmlLocalized(20, 60, 100, 20, 1011429, false, false); // Led By : 
            this.AddHtml(125, 60, 200, 20, faction.Commander != null ? faction.Commander.Name : "Nobody", false, false);

            this.AddHtmlLocalized(20, 80, 100, 20, 1011457, false, false); // Tithe rate : 
            if (faction.Tithe >= 0 && faction.Tithe <= 100 && (faction.Tithe % 10) == 0)
                this.AddHtmlLocalized(125, 80, 350, 20, 1011480 + (faction.Tithe / 10), false, false);
            else
                this.AddHtml(125, 80, 350, 20, faction.Tithe + "%", false, false);</pre>

Fragment 2 in file Scripts\Services\Factions\Gumps\JoinStoneGump.cs

<pre>this.AddHtmlLocalized(20, 60, 100, 20, 1011429, false, false); // Led By : 
            this.AddHtml(125, 60, 200, 20, faction.Commander != null ? faction.Commander.Name : "Nobody", false, false);

            this.AddHtmlLocalized(20, 80, 100, 20, 1011457, false, false); // Tithe rate : 
            if (faction.Tithe >= 0 && faction.Tithe <= 100 && (faction.Tithe % 10) == 0)
                this.AddHtmlLocalized(125, 80, 350, 20, 1011480 + (faction.Tithe / 10), false, false);
            else
                this.AddHtml(125, 80, 350, 20, faction.Tithe + "%", false, false);</pre>

## Duplicated Code. Size: 274

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Bushido\SamuraiSpell.cs

<pre>public override bool CheckCast()
        {
            int mana = this.ScaleMana(this.RequiredMana);

            if (!base.CheckCast())
                return false;

            if (!CheckExpansion(this.Caster))
            {
                this.Caster.SendLocalizedMessage(1063456); // You must upgrade to Samurai Empire in order to use that ability.
                return false;
            }

            if (this.Caster.Skills[this.CastSkill].Value < this.RequiredSkill)
            {
                string args = String.Format("{0}\t{1}\t ", this.RequiredSkill.ToString("F1"), this.CastSkill.ToString());
                this.Caster.SendLocalizedMessage(1063013, args); // You need at least ~1_SKILL_REQUIREMENT~ ~2_SKILL_NAME~ skill to use that ability.
                return false;
            }
            else if (this.Caster.Mana < mana)
            {
                this.Caster.SendLocalizedMessage(1060174, mana.ToString()); // You must have at least ~1_MANA_REQUIREMENT~ Mana to use this ability.
                return false;
            }

            return true;
        }</pre>

Fragment 2 in file Scripts\Spells\Ninjitsu\NinjaSpell.cs

<pre>public override bool CheckCast()
        {
            int mana = this.ScaleMana(this.RequiredMana);

            if (!base.CheckCast())
                return false;

            if (!CheckExpansion(this.Caster))
            {
                this.Caster.SendLocalizedMessage(1063456); // You must upgrade to Samurai Empire in order to use that ability.
                return false;
            }

            if (this.Caster.Skills[this.CastSkill].Value < this.RequiredSkill)
            {
                string args = String.Format("{0}\t{1}\t ", this.RequiredSkill.ToString("F1"), this.CastSkill.ToString());
                this.Caster.SendLocalizedMessage(1063013, args); // You need at least ~1_SKILL_REQUIREMENT~ ~2_SKILL_NAME~ skill to use that ability.
                return false;
            }
            else if (this.Caster.Mana < mana)
            {
                this.Caster.SendLocalizedMessage(1060174, mana.ToString()); // You must have at least ~1_MANA_REQUIREMENT~ Mana to use this ability.
                return false;
            }

            return true;
        }</pre>

## Duplicated Code. Size: 273

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Ethics\Evil\Powers\UnholyItem.cs

<pre>Player from = state as Player;

            Item item = obj as Item;

            if (item == null)
            {
                from.Mobile.LocalOverheadMessage(Server.Network.MessageType.Regular, 0x3B2, false, "You may not imbue that.");
                return;
            }

            if (item.Parent != from.Mobile)
            {
                from.Mobile.LocalOverheadMessage(Server.Network.MessageType.Regular, 0x3B2, false, "You may only imbue items you are wearing.");
                return;
            }

            if ((item.SavedFlags & 0x300) != 0)
            {
                from.Mobile.LocalOverheadMessage(Server.Network.MessageType.Regular, 0x3B2, false, "That has already beem imbued.");
                return;
            }

            bool canImbue = (item is Spellbook || item is BaseClothing || item is BaseArmor || item is BaseWeapon) && (item.Name == null);</pre>

Fragment 2 in file Scripts\Services\Ethics\Hero\Powers\HolyItem.cs

<pre>Player from = state as Player;

            Item item = obj as Item;

            if (item == null)
            {
                from.Mobile.LocalOverheadMessage(Server.Network.MessageType.Regular, 0x3B2, false, "You may not imbue that.");
                return;
            }

            if (item.Parent != from.Mobile)
            {
                from.Mobile.LocalOverheadMessage(Server.Network.MessageType.Regular, 0x3B2, false, "You may only imbue items you are wearing.");
                return;
            }

            if ((item.SavedFlags & 0x300) != 0)
            {
                from.Mobile.LocalOverheadMessage(Server.Network.MessageType.Regular, 0x3B2, false, "That has already beem imbued.");
                return;
            }

            bool canImbue = (item is Spellbook || item is BaseClothing || item is BaseArmor || item is BaseWeapon) && (item.Name == null);</pre>

## Duplicated Code. Size: 272

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddCheck(182, 48, 210, 211, false, 101);
            this.AddCheck(182, 73, 210, 211, false, 102);
            this.AddCheck(182, 98, 210, 211, false, 103);
            this.AddCheck(182, 123, 210, 211, false, 104);
            this.AddCheck(182, 148, 210, 211, false, 105);
            this.AddCheck(182, 173, 210, 211, false, 106);
            this.AddCheck(182, 198, 210, 211, false, 107);
            this.AddCheck(182, 223, 210, 211, false, 108);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddCheck(182, 48, 210, 211, false, 101);
            this.AddCheck(182, 73, 210, 211, false, 102);
            this.AddCheck(182, 98, 210, 211, false, 103);
            this.AddCheck(182, 123, 210, 211, false, 104);
            this.AddCheck(182, 148, 210, 211, false, 105);
            this.AddCheck(182, 173, 210, 211, false, 106);
            this.AddCheck(182, 198, 210, 211, false, 107);
            this.AddCheck(182, 223, 210, 211, false, 108);</pre>

Fragment 3 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddCheck(182, 48, 210, 211, false, 101);
            this.AddCheck(182, 73, 210, 211, false, 102);
            this.AddCheck(182, 98, 210, 211, false, 103);
            this.AddCheck(182, 123, 210, 211, false, 104);
            this.AddCheck(182, 148, 210, 211, false, 105);
            this.AddCheck(182, 173, 210, 211, false, 106);
            this.AddCheck(182, 198, 210, 211, false, 107);
            this.AddCheck(182, 223, 210, 211, false, 108);</pre>

## Duplicated Code. Size: 270

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\CombatTraining.cs

<pre>if (attacker is BaseCreature && (((BaseCreature)attacker).Controlled || ((BaseCreature)attacker).Summoned))
            {
                Mobile master = ((BaseCreature)attacker).GetMaster();

                if (master != null)
                {
                    CombatTrainingSpell spell = GetSpell(master, typeof(CombatTrainingSpell)) as CombatTrainingSpell;

                    if (spell != null)
                    {
                        switch (spell.SpellType)
                        {
                            case TrainingType.Empowerment:
                                damage = damage + (int)((double)damage * spell.DamageModifier(defender));
                                attacker.FixedParticles(0x376A, 10, 30, 5052, 1261, 7, EffectLayer.LeftFoot, 0);
                                break;
                            case TrainingType.Berserk:
                                break;
                            case TrainingType.ConsumeDamage:
                                break;
                        }
                    }
                }
            }</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\CombatTraining.cs

<pre>if (attacker is BaseCreature && (((BaseCreature)attacker).Controlled || ((BaseCreature)attacker).Summoned))
            {
                Mobile master = ((BaseCreature)attacker).GetMaster();

                if (master != null)
                {
                    CombatTrainingSpell spell = GetSpell(master, typeof(CombatTrainingSpell)) as CombatTrainingSpell;

                    if (spell != null)
                    {
                        switch (spell.SpellType)
                        {
                            case TrainingType.Empowerment:
                                break;
                            case TrainingType.Berserk:
                                damage = damage + (int)((double)damage * spell.DamageModifier(defender));
                                attacker.FixedParticles(0x376A, 10, 30, 5052, 1261, 7, EffectLayer.LeftFoot, 0);
                                break;
                            case TrainingType.ConsumeDamage:
                                break;
                        }
                    }
                }
            }</pre>

## Duplicated Code. Size: 269

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Books\BaseBook.cs

<pre>int pageCount = pvSrc.ReadUInt16();

            if (pageCount > book.PagesCount)
                return;

            for (int i = 0; i < pageCount; ++i)
            {
                int index = pvSrc.ReadUInt16();

                if (index >= 1 && index <= book.PagesCount)
                {
                    --index;

                    int lineCount = pvSrc.ReadUInt16();

                    if (lineCount <= 8)
                    {
                        string[] lines = new string[lineCount];

                        for (int j = 0; j < lineCount; ++j)
                            if ((lines[j] = pvSrc.ReadUTF8StringSafe()).Length >= 80)
                                return;

                        book.Pages[index].Lines = lines;
                    }
                    else
                    {
                        return;
                    }
                }
                else
                {
                    return;
                }
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlTextEntryBook.cs

<pre>int pageCount = pvSrc.ReadUInt16();

			if ( pageCount > book.PagesCount )
				return;

			for ( int i = 0; i < pageCount; ++i )
			{
				int index = pvSrc.ReadUInt16();

				if ( index >= 1 && index <= book.PagesCount )
				{
					--index;

					int lineCount = pvSrc.ReadUInt16();

					if ( lineCount <= 8 )
					{
						string[] lines = new string[lineCount];

						for ( int j = 0; j < lineCount; ++j )
							if ( (lines[j] = pvSrc.ReadUTF8StringSafe()).Length >= 80 )
								return;

						book.Pages[index].Lines = lines;
					}
					else
					{
						return;
					}
				}
				else
				{
					return;
				}
			}</pre>

## Duplicated Code. Size: 269

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusArchZealot.cs

<pre>AddHtmlLocalized(155, 320, 250, 24, 1153678, White, false, false);
            AddButton(125, 320, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 5);//Summoning Rite?

            AddHtmlLocalized(155, 340, 250, 24, 1153680, White, false, false);
            AddButton(125, 340, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 6);//Sacrifical Dagger?

            AddHtmlLocalized(155, 360, 250, 24, 1153682, White, false, false);
            AddButton(125, 360, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 7);//The Keys?

            AddButton(325, 390, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusArchZealot.cs

<pre>AddHtmlLocalized(155, 320, 250, 24, 1153678, White, false, false);
            AddButton(125, 320, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 5);//Summoning Rite?

            AddHtmlLocalized(155, 340, 250, 24, 1153680, White, false, false);
            AddButton(125, 340, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 6);//Sacrifical Dagger?

            AddHtmlLocalized(155, 360, 250, 24, 1153682, White, false, false);
            AddButton(125, 360, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 7);//The Keys?

            AddButton(325, 390, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK</pre>

## Duplicated Code. Size: 267

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\ResonantShieldOfVengeance.cs

<pre>{
            Hue = 2076;

            switch (Utility.Random(5))
            {
                case 0: AbsorptionAttributes.ResonanceKinetic = 10; break;
                case 1: AbsorptionAttributes.ResonanceFire = 10; break;
                case 2: AbsorptionAttributes.ResonanceCold = 10; break;
                case 3: AbsorptionAttributes.ResonancePoison = 10; break;
                case 4: AbsorptionAttributes.ResonanceEnergy = 10; break;
            }

            Attributes.SpellChanneling = 1;
            Attributes.ReflectPhysical = 20;
            Attributes.DefendChance = 8;

            switch (Utility.Random(5))
            {
                case 0: PhysicalBonus = 10; break;
                case 1: FireBonus = 10; break;
                case 2: ColdBonus = 10; break;
                case 3: PoisonBonus = 10; break;
                case 4: EnergyBonus = 10; break;
            }
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\ResonantShieldOfVengeance.cs

<pre>{
            Hue = 2076;

            switch (Utility.Random(5))
            {
                case 0: AbsorptionAttributes.ResonanceKinetic = 10; break;
                case 1: AbsorptionAttributes.ResonanceFire = 10; break;
                case 2: AbsorptionAttributes.ResonanceCold = 10; break;
                case 3: AbsorptionAttributes.ResonancePoison = 10; break;
                case 4: AbsorptionAttributes.ResonanceEnergy = 10; break;
            }

            Attributes.SpellChanneling = 1;
            Attributes.ReflectPhysical = 20;
            Attributes.DefendChance = 8;

            switch (Utility.Random(5))
            {
                case 0: PhysicalBonus = 10; break;
                case 1: FireBonus = 10; break;
                case 2: ColdBonus = 10; break;
                case 3: PoisonBonus = 10; break;
                case 4: EnergyBonus = 10; break;
            }
        }</pre>

## Duplicated Code. Size: 267

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGauntlet.cs

<pre>public override void OnPlayerKilled(Mobile killer, Mobile killed)
        {
            if(killed == null) return;

            if(AutoRes)
            {
                // prepare the autores callback
                    Timer.DelayCall( RespawnTime, new TimerStateCallback( XmlPoints.AutoRes_Callback ),
                    new object[]{ killed, false } );
            }

            // find the player in the participants list and set their status to Dead
            if(m_Participants != null)
            {
                int leftstanding = 0;
                Mobile winner = null;

                foreach(IChallengeEntry entry in m_Participants)
                {
                    if(entry.Participant == killed && entry.Status != ChallengeStatus.Forfeit)
                    {
                        entry.Status = ChallengeStatus.Dead;
                        // clear up their noto
                        RefreshSymmetricNoto(killed);

                        GameBroadcast(100314, killed.Name); // "{0} has been killed"
                    }

                    if(entry.Status == ChallengeStatus.Active)
                    {
                        leftstanding++;
                        winner = entry.Participant;
                    }
                }
            }

            // see if the game is over
            CheckForGameEnd();
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGauntlet.cs

<pre>public override void OnPlayerKilled(Mobile killer, Mobile killed)
        {
            if(killed == null) return;

            if(AutoRes)
            {
                // prepare the autores callback
                    Timer.DelayCall( RespawnTime, new TimerStateCallback( XmlPoints.AutoRes_Callback ),
                    new object[]{ killed, false } );
            }

            // find the player in the participants list and set their status to Dead
            if(m_Participants != null)
            {
                int leftstanding = 0;
                Mobile winner = null;

                foreach(IChallengeEntry entry in m_Participants)
                {
                    if(entry.Participant == killed && entry.Status != ChallengeStatus.Forfeit)
                    {
                        entry.Status = ChallengeStatus.Dead;
                        // clear up their noto
                        RefreshSymmetricNoto(killed);

                        GameBroadcast(100314, killed.Name); // "{0} has been killed"
                    }

                    if(entry.Status == ChallengeStatus.Active)
                    {
                        leftstanding++;
                        winner = entry.Participant;
                    }
                }
            }

            // see if the game is over
            CheckForGameEnd();
        }</pre>

## Duplicated Code. Size: 266

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>{
                if (m_ReforgedPrefix != ReforgedPrefix.None)
                {
                    int prefix = RunicReforging.GetPrefixName(m_ReforgedPrefix);

                    if (m_ReforgedSuffix == ReforgedSuffix.None)
                        list.Add(1151757, String.Format("#{0}\t{1}", prefix, GetNameString())); // ~1_PREFIX~ ~2_ITEM~
                    else
                        list.Add(1151756, String.Format("#{0}\t{1}\t#{2}", prefix, GetNameString(), RunicReforging.GetSuffixName(m_ReforgedSuffix))); // ~1_PREFIX~ ~2_ITEM~ of ~3_SUFFIX~
                }
                else if (m_ReforgedSuffix != ReforgedSuffix.None)
                {
                    if (m_ReforgedSuffix == ReforgedSuffix.Minax)
                        list.Add(1154507, String.Format("{0}", GetNameString())); // ~1_ITEM~ bearing the crest of Minax
                    else
                        list.Add(1151758, String.Format("{0}\t#{1}", GetNameString(), RunicReforging.GetSuffixName(m_ReforgedSuffix))); // ~1_ITEM~ of ~2_SUFFIX~
                }
            }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>{
                if (m_ReforgedPrefix != ReforgedPrefix.None)
                {
                    int prefix = RunicReforging.GetPrefixName(m_ReforgedPrefix);

                    if (m_ReforgedSuffix == ReforgedSuffix.None)
                        list.Add(1151757, String.Format("#{0}\t{1}", prefix, GetNameString())); // ~1_PREFIX~ ~2_ITEM~
                    else
                        list.Add(1151756, String.Format("#{0}\t{1}\t#{2}", prefix, GetNameString(), RunicReforging.GetSuffixName(m_ReforgedSuffix))); // ~1_PREFIX~ ~2_ITEM~ of ~3_SUFFIX~
                }
                else if (m_ReforgedSuffix != ReforgedSuffix.None)
                {
                    if (m_ReforgedSuffix == ReforgedSuffix.Minax)
                        list.Add(1154507, String.Format("{0}", GetNameString())); // ~1_ITEM~ bearing the crest of Minax
                    else
                        list.Add(1151758, String.Format("{0}\t#{1}", GetNameString(), RunicReforging.GetSuffixName(m_ReforgedSuffix))); // ~1_ITEM~ of ~2_SUFFIX~
                }
            }</pre>

## Duplicated Code. Size: 265

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\SQ1Gump.cs

<pre>this.AddImage(430, 9, 10441);
            this.AddImageTiled(40, 38, 17, 391, 9263);
            this.AddImage(6, 25, 10421);
            this.AddImage(34, 12, 10420);
            this.AddImageTiled(94, 25, 342, 15, 10304);
            this.AddImageTiled(40, 427, 415, 16, 10304);
            this.AddImage(-10, 314, 10402);
            this.AddImage(56, 150, 10411);
            this.AddImage(136, 84, 96);

            this.AddButton(114, 380, 12009, 12010, 0, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Gumps\SQ5Gump.cs

<pre>this.AddImage(430, 9, 10441);
            this.AddImageTiled(40, 38, 17, 391, 9263);
            this.AddImage(6, 25, 10421);
            this.AddImage(34, 12, 10420);
            this.AddImageTiled(94, 25, 342, 15, 10304);
            this.AddImageTiled(40, 427, 415, 16, 10304);
            this.AddImage(-10, 314, 10402);
            this.AddImage(56, 150, 10411);
            this.AddImage(136, 84, 96);

            this.AddButton(114, 380, 12009, 12010, 0, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 265

### Duplicated Fragments:

Fragment 1 in file Ultima\AnimationEdit.cs

<pre>var bmp = new Bitmap(0x100, 20, PixelFormat.Format16bppArgb1555);
						BitmapData bd = bmp.LockBits(
							new Rectangle(0, 0, 0x100, 20), ImageLockMode.WriteOnly, PixelFormat.Format16bppArgb1555);
						var line = (ushort*)bd.Scan0;
						int delta = bd.Stride >> 1;
						for (int y = 0; y < bd.Height; ++y, line += delta)
						{
							ushort* cur = line;
							for (int i = 0; i < 0x100; ++i)
							{
								*cur++ = Palette[i];
							}
						}
						bmp.UnlockBits(bd);
						var b = new Bitmap(bmp);</pre>

Fragment 2 in file Ultima\AnimationEdit.cs

<pre>var bmp = new Bitmap(0x100, 20, PixelFormat.Format16bppArgb1555);
						BitmapData bd = bmp.LockBits(
							new Rectangle(0, 0, 0x100, 20), ImageLockMode.WriteOnly, PixelFormat.Format16bppArgb1555);
						var line = (ushort*)bd.Scan0;
						int delta = bd.Stride >> 1;
						for (int y = 0; y < bd.Height; ++y, line += delta)
						{
							ushort* cur = line;
							for (int i = 0; i < 0x100; ++i)
							{
								*cur++ = Palette[i];
							}
						}
						bmp.UnlockBits(bd);
						var b = new Bitmap(bmp);</pre>

## Duplicated Code. Size: 264

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Protector.cs

<pre>this.SetDamage(6, 12);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 30, 40);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 35, 40);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);

            this.SetSkill(SkillName.Wrestling, 70.0, 100.0);
            this.SetSkill(SkillName.Tactics, 80.0, 100.0);
            this.SetSkill(SkillName.MagicResist, 50.0, 70.0);
            this.SetSkill(SkillName.Anatomy, 70.0, 100.0);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusZealot.cs

<pre>this.SetDamage(6, 12);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 30, 40);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 35, 40);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);

            this.SetSkill(SkillName.Wrestling, 70.0, 100.0);
            this.SetSkill(SkillName.Tactics, 80.0, 100.0);
            this.SetSkill(SkillName.MagicResist, 50.0, 70.0);
            this.SetSkill(SkillName.Anatomy, 70.0, 100.0);</pre>

## Duplicated Code. Size: 263

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\AncientLichRenowned.cs

<pre>this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Cold, 40);
            this.SetDamageType(ResistanceType.Energy, 40);

            this.SetResistance(ResistanceType.Physical, 55, 65);
            this.SetResistance(ResistanceType.Fire, 25, 30);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 50, 60);
            this.SetResistance(ResistanceType.Energy, 25, 30);

            this.SetSkill(SkillName.EvalInt, 120.1, 130.0);
            this.SetSkill(SkillName.Magery, 120.1, 130.0);
            this.SetSkill(SkillName.Meditation, 100.1, 101.0);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\TheMasterInstructor.cs

<pre>this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Cold, 40);
            this.SetDamageType(ResistanceType.Energy, 40);

            this.SetResistance(ResistanceType.Physical, 55, 65);
            this.SetResistance(ResistanceType.Fire, 25, 30);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 50, 60);
            this.SetResistance(ResistanceType.Energy, 25, 30);

            this.SetSkill(SkillName.EvalInt, 120.1, 130.0);
            this.SetSkill(SkillName.Magery, 120.1, 130.0);
            this.SetSkill(SkillName.Meditation, 100.1, 101.0);</pre>

## Duplicated Code. Size: 263

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>SpawnObject[] so = new SpawnObject[1];
			so[0] = new SpawnObject(creatureName, amount);

			InitSpawn(0, 0, m_Width, m_Height, string.Empty, amount, TimeSpan.FromMinutes(minDelay), TimeSpan.FromMinutes(maxDelay), defDuration,
				defProximityRange, defProximityTriggerSound, defAmount, team, homeRange, defRelativeHome, so, defMinRefractory, defMaxRefractory,
				defTODStart, defTODEnd, null, null, null, null, null, null, null, null, null, defTriggerProbability, null, defIsGroup, defTODMode,
				defKillReset, false, -1, null, false, false, false, null, defDespawnTime, null, false, null);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>SpawnObject[] so = new SpawnObject[1];
			so[0] = new SpawnObject(creatureName, amount);

			InitSpawn(0, 0, m_Width, m_Height, string.Empty, amount, TimeSpan.FromMinutes(minDelay), TimeSpan.FromMinutes(maxDelay), defDuration,
				defProximityRange, defProximityTriggerSound, defAmount, team, homeRange, defRelativeHome, so, defMinRefractory, defMaxRefractory,
				defTODStart, defTODEnd, null, null, null, null, null, null, null, null, null, defTriggerProbability, null, defIsGroup, defTODMode,
				defKillReset, false, -1, null, false, false, false, null, defDespawnTime, null, false, null);</pre>

## Duplicated Code. Size: 262

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>{
                        statusmsg = XmlPoints.GetText(from, 200509);  // "Waiting"
                        if(entry.Accepted)
                        {
                            texthue = 68;
                            statusmsg = XmlPoints.GetText(from, 200510);    // "Accepted"
                        }

                        // check to see if they have the Entry fee
                        if(!m_gauntlet.HasEntryFee(m))
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200511);   // "Insufficient funds"
                        }

                    // if the game is still open then enable these buttons

                        // if this is the participant then add the accept button to the entry
                        if(m == from)
                        {
                            AddButton( 15, yoffset, entry.Accepted ? 0xd1 : 0xd0, entry.Accepted ? 0xd0 : 0xd1,  1000+i, GumpButtonType.Reply, 0 );
                        }
                        // if this is the organizer then add the kick button to each entry
                        if(from == m_gauntlet.Challenger || from == entry.Participant)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  2000+i, GumpButtonType.Reply, 0 );
                        }
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>{
                        statusmsg = XmlPoints.GetText(from, 200509);  // "Waiting"
                        if(entry.Accepted)
                        {
                            texthue = 68;
                            statusmsg = XmlPoints.GetText(from, 200510);    // "Accepted"
                        }

                        // check to see if they have the Entry fee
                        if(!m_gauntlet.HasEntryFee(m))
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200511);   // "Insufficient funds"
                        }

                    // if the game is still open then enable these buttons

                        // if this is the participant then add the accept button to the entry
                        if(m == from)
                        {
                            AddButton( 15, yoffset, entry.Accepted ? 0xd1 : 0xd0, entry.Accepted ? 0xd0 : 0xd1,  1000+i, GumpButtonType.Reply, 0 );
                        }
                        // if this is the organizer then add the kick button to each entry
                        if(from == m_gauntlet.Challenger || from == entry.Participant)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  2000+i, GumpButtonType.Reply, 0 );
                        }
                    }</pre>

## Duplicated Code. Size: 262

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Betrayer.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (!this.m_Stunning && 0.3 > Utility.RandomDouble())
            {
                this.m_Stunning = true;

                defender.Animate(21, 6, 1, true, false, 0);
                this.PlaySound(0xEE);
                defender.LocalOverheadMessage(MessageType.Regular, 0x3B2, false, "You have been stunned by a colossal blow!");

                BaseWeapon weapon = this.Weapon as BaseWeapon;
                if (weapon != null)
                    weapon.OnHit(this, defender);

                if (defender.Alive)
                {
                    defender.Frozen = true;
                    Timer.DelayCall(TimeSpan.FromSeconds(5.0), new TimerStateCallback(Recover_Callback), defender);
                }
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Golem.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (!this.m_Stunning && 0.3 > Utility.RandomDouble())
            {
                this.m_Stunning = true;

                defender.Animate(21, 6, 1, true, false, 0);
                this.PlaySound(0xEE);
                defender.LocalOverheadMessage(MessageType.Regular, 0x3B2, false, "You have been stunned by a colossal blow!");

                BaseWeapon weapon = this.Weapon as BaseWeapon;
                if (weapon != null)
                    weapon.OnHit(this, defender);

                if (defender.Alive)
                {
                    defender.Frozen = true;
                    Timer.DelayCall(TimeSpan.FromSeconds(5.0), new TimerStateCallback(Recover_Callback), defender);
                }
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\Juggernaut.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (!this.m_Stunning && 0.3 > Utility.RandomDouble())
            {
                this.m_Stunning = true;

                defender.Animate(21, 6, 1, true, false, 0);
                this.PlaySound(0xEE);
                defender.LocalOverheadMessage(MessageType.Regular, 0x3B2, false, "You have been stunned by a colossal blow!");

                BaseWeapon weapon = this.Weapon as BaseWeapon;
                if (weapon != null)
                    weapon.OnHit(this, defender);

                if (defender.Alive)
                {
                    defender.Frozen = true;
                    Timer.DelayCall(TimeSpan.FromSeconds(5.0), new TimerStateCallback(Recover_Callback), defender);
                }
            }
        }</pre>

## Duplicated Code. Size: 260

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Regions\SeaMarket.cs

<pre>e.Mobile.SendMessage("Boats: {0}", boats.Count);

            if (!m_RestrictBoats)
                e.Mobile.SendMessage("Boat restriction is currenlty disabled.");

            Console.WriteLine("========Boat Info as Follows===========");
            Console.WriteLine("Boats: {0}", boats.Count);

            if (!m_RestrictBoats)
                Console.WriteLine("Boat restriction is currenlty disabled.");

            for (int i = 0; i < boats.Count; i++)
            {
                BaseBoat boat = boats[i];

                if (boat == null || boat.Deleted)
                    continue;

                e.Mobile.SendMessage("Boat Name: {0}; Boat Owner: {1}; Expires: {2}", boat.ShipName, boat.Owner, times[i]);

                Console.WriteLine("Boat Name: {0}; Boat Owner: {1}; Expires: {2}", boat.ShipName, boat.Owner, times[i]);
            }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Regions\SeaMarket.cs

<pre>e.Mobile.SendMessage("Boats: {0}", boats.Count);

            if (!m_RestrictBoats)
                e.Mobile.SendMessage("Boat restriction is currenlty disabled.");

            Console.WriteLine("========Boat Info as Follows===========");
            Console.WriteLine("Boats: {0}", boats.Count);

            if (!m_RestrictBoats)
                Console.WriteLine("Boat restriction is currenlty disabled.");

            for (int i = 0; i < boats.Count; i++)
            {
                BaseBoat boat = boats[i];

                if (boat == null || boat.Deleted)
                    continue;

                e.Mobile.SendMessage("Boat Name: {0}; Boat Owner: {1}; Expires: {2}", boat.ShipName, boat.Owner, times[i]);

                Console.WriteLine("Boat Name: {0}; Boat Owner: {1}; Expires: {2}", boat.ShipName, boat.Owner, times[i]);
            }</pre>

## Duplicated Code. Size: 259

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>{
                        statusmsg = XmlPoints.GetText(from, 200509);  // "Waiting"
                        if(entry.Accepted)
                        {
                            texthue = 68;
                            statusmsg = XmlPoints.GetText(from, 200510);    // "Accepted"
                        }

                        // check to see if they have the Entry fee
                        if(!HasEntryFee(m))
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200511);   // "Insufficient funds"
                        }

                    // if the game is still open then enable these buttons

                        // if this is the participant then add the accept button to the entry
                        if(m == from)
                        {
                            AddButton( 15, yoffset, entry.Accepted ? 0xd1 : 0xd0, entry.Accepted ? 0xd0 : 0xd1,  1000+i, GumpButtonType.Reply, 0 );
                        }
                        // if this is the organizer then add the kick button to each entry
                        if(from == m_gauntlet.Challenger || from == entry.Participant)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  2000+i, GumpButtonType.Reply, 0 );
                        }
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>{
                        statusmsg = XmlPoints.GetText(from, 200509);  // "Waiting"
                        if(entry.Accepted)
                        {
                            texthue = 68;
                            statusmsg = XmlPoints.GetText(from, 200510);    // "Accepted"
                        }

                        // check to see if they have the Entry fee
                        if(!HasEntryFee(m))
                        {
                            texthue = 33;
                            statusmsg = XmlPoints.GetText(from, 200511);   // "Insufficient funds"
                        }

                    // if the game is still open then enable these buttons

                        // if this is the participant then add the accept button to the entry
                        if(m == from)
                        {
                            AddButton( 15, yoffset, entry.Accepted ? 0xd1 : 0xd0, entry.Accepted ? 0xd0 : 0xd1,  1000+i, GumpButtonType.Reply, 0 );
                        }
                        // if this is the organizer then add the kick button to each entry
                        if(from == m_gauntlet.Challenger || from == entry.Participant)
                        {
                            AddButton( 190, yoffset, 0xFB1, 0xFB3,  2000+i, GumpButtonType.Reply, 0 );
                        }
                    }</pre>

## Duplicated Code. Size: 259

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Chivalry\SacredJourney.cs

<pre>if (o is Server.Engines.NewMagincia.WritOfLease)
                {
                    Server.Engines.NewMagincia.WritOfLease lease = (Server.Engines.NewMagincia.WritOfLease)o;

                    if (lease.RecallLoc != Point3D.Zero && lease.Facet != null && lease.Facet != Map.Internal)
                        m_Owner.Effect(lease.RecallLoc, lease.Facet, false);
                    else
                        from.Send(new MessageLocalized(from.Serial, from.Body, MessageType.Regular, 0x3B2, 3, 502357, from.Name, "")); // I can not recall from that object.
                }
                #endregion

                else
                {
                    from.Send(new MessageLocalized(from.Serial, from.Body, MessageType.Regular, 0x3B2, 3, 502357, from.Name, "")); // I can not recall from that object.
                }</pre>

Fragment 2 in file Scripts\Spells\Fourth\Recall.cs

<pre>if (o is Server.Engines.NewMagincia.WritOfLease)
                {
                    Server.Engines.NewMagincia.WritOfLease lease = (Server.Engines.NewMagincia.WritOfLease)o;

                    if (lease.RecallLoc != Point3D.Zero && lease.Facet != null && lease.Facet != Map.Internal)
                        m_Owner.Effect(lease.RecallLoc, lease.Facet, false);
                    else
                        from.Send(new MessageLocalized(from.Serial, from.Body, MessageType.Regular, 0x3B2, 3, 502357, from.Name, "")); // I can not recall from that object.
                }
                #endregion

                else
                {
                    from.Send(new MessageLocalized(from.Serial, from.Body, MessageType.Regular, 0x3B2, 3, 502357, from.Name, "")); // I can not recall from that object.
                }</pre>

## Duplicated Code. Size: 259

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Fifth\PoisonField.cs

<pre>SpellHelper.Turn(this.Caster, p);

                SpellHelper.GetSurfaceTop(ref p);

                int dx = this.Caster.Location.X - p.X;
                int dy = this.Caster.Location.Y - p.Y;
                int rx = (dx - dy) * 44;
                int ry = (dx + dy) * 44;

                bool eastToWest;

                if (rx >= 0 && ry >= 0)
                {
                    eastToWest = false;
                }
                else if (rx >= 0)
                {
                    eastToWest = true;
                }
                else if (ry >= 0)
                {
                    eastToWest = true;
                }
                else
                {
                    eastToWest = false;
                }

                Effects.PlaySound(p, this.Caster.Map, 0x20B);</pre>

Fragment 2 in file Scripts\Spells\Seventh\EnergyField.cs

<pre>SpellHelper.Turn(this.Caster, p);

                SpellHelper.GetSurfaceTop(ref p);

                int dx = this.Caster.Location.X - p.X;
                int dy = this.Caster.Location.Y - p.Y;
                int rx = (dx - dy) * 44;
                int ry = (dx + dy) * 44;

                bool eastToWest;

                if (rx >= 0 && ry >= 0)
                {
                    eastToWest = false;
                }
                else if (rx >= 0)
                {
                    eastToWest = true;
                }
                else if (ry >= 0)
                {
                    eastToWest = true;
                }
                else
                {
                    eastToWest = false;
                }

                Effects.PlaySound(p, this.Caster.Map, 0x20B);</pre>

## Duplicated Code. Size: 258

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\PotionKeg.cs

<pre>int number;

            if (this.m_Held <= 0)
                number = 502246; // The keg is empty.
            else if (this.m_Held < 5)
                number = 502248; // The keg is nearly empty.
            else if (this.m_Held < 20)
                number = 502249; // The keg is not very full.
            else if (this.m_Held < 30)
                number = 502250; // The keg is about one quarter full.
            else if (this.m_Held < 40)
                number = 502251; // The keg is about one third full.
            else if (this.m_Held < 47)
                number = 502252; // The keg is almost half full.
            else if (this.m_Held < 54)
                number = 502254; // The keg is approximately half full.
            else if (this.m_Held < 70)
                number = 502253; // The keg is more than half full.
            else if (this.m_Held < 80)
                number = 502255; // The keg is about three quarters full.
            else if (this.m_Held < 96)
                number = 502256; // The keg is very full.
            else if (this.m_Held < 100)
                number = 502257; // The liquid is almost to the top of the keg.
            else
                number = 502258; // The keg is completely full.</pre>

Fragment 2 in file Scripts\Items\Resource\PotionKeg.cs

<pre>int number;

            if (this.m_Held <= 0)
                number = 502246; // The keg is empty.
            else if (this.m_Held < 5)
                number = 502248; // The keg is nearly empty.
            else if (this.m_Held < 20)
                number = 502249; // The keg is not very full.
            else if (this.m_Held < 30)
                number = 502250; // The keg is about one quarter full.
            else if (this.m_Held < 40)
                number = 502251; // The keg is about one third full.
            else if (this.m_Held < 47)
                number = 502252; // The keg is almost half full.
            else if (this.m_Held < 54)
                number = 502254; // The keg is approximately half full.
            else if (this.m_Held < 70)
                number = 502253; // The keg is more than half full.
            else if (this.m_Held < 80)
                number = 502255; // The keg is about three quarters full.
            else if (this.m_Held < 96)
                number = 502256; // The keg is very full.
            else if (this.m_Held < 100)
                number = 502257; // The liquid is almost to the top of the keg.
            else
                number = 502258; // The keg is completely full.</pre>

## Duplicated Code. Size: 258

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>private static readonly int[] m_Offsets = new int[]
        {
            -1, -1,
            -1, 0,
            -1, 1,
            0, -1,
            0, 1,
            1, -1,
            1, 0,
            1, 1,
            -2, -2,
            -2, -1,
            -2, 0,
            -2, 1,
            -2, 2,
            -1, -2,
            -1, 2,
            0, -2,
            0, 2,
            1, -2,
            1, 2,
            2, -2,
            2, -1,
            2, 0,
            2, 1,
            2, 2
        };</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>private static readonly int[] m_Offsets = new int[]
        {
            -1, -1,
            -1, 0,
            -1, 1,
            0, -1,
            0, 1,
            1, -1,
            1, 0,
            1, 1,
            -2, -2,
            -2, -1,
            -2, 0,
            -2, 1,
            -2, 2,
            -1, -2,
            -1, 2,
            0, -2,
            0, 2,
            1, -2,
            1, 2,
            2, -2,
            2, -1,
            2, 0,
            2, 1,
            2, 2
        };</pre>

## Duplicated Code. Size: 258

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\QuestRewardGump.cs

<pre>if(Rewards != null && Rewards.Count > 0)
			{
                AddLabel( width - 165, height - 35, 0, String.Format("Page: {0}/{1}", viewpage+1, (int)(Rewards.Count/maxItemsPerPage)+1));

				// page up and down buttons
				AddButton( width - 55, height - 35, 0x15E0, 0x15E4, 13, GumpButtonType.Reply, 0 );
				AddButton( width - 35, height - 35, 0x15E2, 0x15E6, 12, GumpButtonType.Reply, 0 );
			}

			AddLabel( 70, 50, 40, "Reward" );
			AddLabel( x_creditoffset, 50, 40, "Credits" );
			AddLabel( x_pointsoffset, 50, 40, "Min Points" );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\PointsRewardGump.cs

<pre>if(Rewards != null && Rewards.Count > 0)
			{
                AddLabel( width - 165, height - 35, 0, String.Format("Page: {0}/{1}", viewpage+1, (int)(Rewards.Count/maxItemsPerPage)+1));

                // page up and down buttons
                AddButton( width - 55, height - 35, 0x15E0, 0x15E4, 13, GumpButtonType.Reply, 0 );
                AddButton( width - 35, height - 35, 0x15E2, 0x15E6, 12, GumpButtonType.Reply, 0 );
            }

			AddLabel( 70, 50, 40, "Reward" );
			AddLabel( x_creditoffset, 50, 40, "Credits" );
			AddLabel( x_pointsoffset, 50, 40, "Min Points" );</pre>

## Duplicated Code. Size: 258

### Duplicated Fragments:

Fragment 1 in file Server\Main.cs

<pre>if (
						t.GetMethod(
							"Serialize",
							BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.DeclaredOnly) == null)
					{
						if (warningSb == null)
						{
							warningSb = new StringBuilder();
						}

						warningSb.AppendLine("       - No Serialize() method");
					}

					if (
						t.GetMethod(
							"Deserialize",
							BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.DeclaredOnly) == null)
					{
						if (warningSb == null)
						{
							warningSb = new StringBuilder();
						}

						warningSb.AppendLine("       - No Deserialize() method");
					}

					if (warningSb != null && warningSb.Length > 0)
					{
						Utility.PushColor(ConsoleColor.Yellow);
						Console.WriteLine("Warning: {0}\n{1}", t, warningSb);
						Utility.PopColor();
					}</pre>

Fragment 2 in file Server\Main.cs

<pre>if (
						t.GetMethod(
							"Serialize",
							BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.DeclaredOnly) == null)
					{
						if (warningSb == null)
						{
							warningSb = new StringBuilder();
						}

						warningSb.AppendLine("       - No Serialize() method");
					}

					if (
						t.GetMethod(
							"Deserialize",
							BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.DeclaredOnly) == null)
					{
						if (warningSb == null)
						{
							warningSb = new StringBuilder();
						}

						warningSb.AppendLine("       - No Deserialize() method");
					}

					if (warningSb != null && warningSb.Length > 0)
					{
						Utility.PushColor(ConsoleColor.Yellow);
						Console.WriteLine("Warning: {0}\n{1}", t, warningSb);
						Utility.PopColor();
					}</pre>

## Duplicated Code. Size: 257

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SpecialFishingNet.cs

<pre>int x, y;

                        switch ( Utility.Random(8) )
                        {
                            default:
                            case 0:
                                x = -1;
                                y = -1;
                                break;
                            case 1:
                                x = -1;
                                y = 0;
                                break;
                            case 2:
                                x = -1;
                                y = +1;
                                break;
                            case 3:
                                x = 0;
                                y = -1;
                                break;
                            case 4:
                                x = 0;
                                y = +1;
                                break;
                            case 5:
                                x = +1;
                                y = -1;
                                break;
                            case 6:
                                x = +1;
                                y = 0;
                                break;
                            case 7:
                                x = +1;
                                y = +1;
                                break;
                        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\WinchAssembly.cs

<pre>int x, y;

                switch (Utility.Random(8))
                {
                    default:
                    case 0:
                        x = -1;
                        y = -1;
                        break;
                    case 1:
                        x = -1;
                        y = 0;
                        break;
                    case 2:
                        x = -1;
                        y = +1;
                        break;
                    case 3:
                        x = 0;
                        y = -1;
                        break;
                    case 4:
                        x = 0;
                        y = +1;
                        break;
                    case 5:
                        x = +1;
                        y = -1;
                        break;
                    case 6:
                        x = +1;
                        y = 0;
                        break;
                    case 7:
                        x = +1;
                        y = +1;
                        break;
                }</pre>

## Duplicated Code. Size: 257

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>var entries = menu.Entries;

			int length = (byte)entries.Length;

			EnsureCapacity(12 + (length * 8));

			m_Stream.Write((short)0x14);
			m_Stream.Write((short)0x02);

			IEntity target = menu.Target as IEntity;

			m_Stream.Write((target == null ? Serial.MinusOne : target.Serial));

			m_Stream.Write((byte)length);

			Point3D p;

			if (target is Mobile)
			{
				p = target.Location;
			}
			else if (target is Item)
			{
				p = ((Item)target).GetWorldLocation();
			}
			else
			{
				p = Point3D.Zero;
			}</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>var entries = menu.Entries;

            int length = (byte)entries.Length;

            EnsureCapacity(12 + (length * 8));

            m_Stream.Write((short)0x14);
			m_Stream.Write((short)0x02); 

            IEntity target = menu.Target as IEntity;

			m_Stream.Write((target == null ? Serial.MinusOne : target.Serial));

			m_Stream.Write((byte)length);

			Point3D p;

			if (target is Mobile)
			{
				p = target.Location;
			}
			else if (target is Item)
			{
				p = ((Item)target).GetWorldLocation();
			}
			else
			{
				p = Point3D.Zero;
			}</pre>

## Duplicated Code. Size: 256

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>private void AddBorderedText(int x, int y, int width, int height, string text, int color, int borderColor)
        {
            this.AddColoredText(x - 1, y - 1, width, height, text, borderColor);
            this.AddColoredText(x - 1, y + 1, width, height, text, borderColor);
            this.AddColoredText(x + 1, y - 1, width, height, text, borderColor);
            this.AddColoredText(x + 1, y + 1, width, height, text, borderColor);
            this.AddColoredText(x, y, width, height, text, color);
        }</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>private void AddBorderedText(int x, int y, int width, int height, string text, int color, int borderColor)
        {
            this.AddColoredText(x - 1, y - 1, width, height, text, borderColor);
            this.AddColoredText(x - 1, y + 1, width, height, text, borderColor);
            this.AddColoredText(x + 1, y - 1, width, height, text, borderColor);
            this.AddColoredText(x + 1, y + 1, width, height, text, borderColor);
            this.AddColoredText(x, y, width, height, text, color);
        }</pre>

Fragment 3 in file Scripts\Services\ConPVP\Tournament.cs

<pre>private void AddBorderedText(int x, int y, int width, int height, string text, int color, int borderColor)
        {
            this.AddColoredText(x - 1, y - 1, width, height, text, borderColor);
            this.AddColoredText(x - 1, y + 1, width, height, text, borderColor);
            this.AddColoredText(x + 1, y - 1, width, height, text, borderColor);
            this.AddColoredText(x + 1, y + 1, width, height, text, borderColor);
            this.AddColoredText(x, y, width, height, text, color);
        }</pre>

## Duplicated Code. Size: 255

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new int[][]
        {
            new int[] { 3, 4, 4, 4, 5, 5, 5 },
            new int[] { 4, 4, 5, 5, 5, 5, 5 },
            new int[] { 5, 5, 5, 5, 5, 5, 5 },
            new int[] { 4, 4, 5, 5, 5, 5, 5 },
            new int[] { 4, 4, 5, 5, 5, 5, 5 },
            new int[] { 5, 5, 5, 5, 5, 5, 5 },
        }</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new int[][]
        {
            new int[] { 3, 4, 4, 4, 5, 5, 5 },
            new int[] { 4, 4, 5, 5, 5, 5, 5 },
            new int[] { 5, 5, 5, 5, 5, 5, 5 },
            new int[] { 4, 4, 5, 5, 5, 5, 5 },
            new int[] { 4, 4, 5, 5, 5, 5, 5 },
            new int[] { 5, 5, 5, 5, 5, 5, 5 },
        }</pre>

## Duplicated Code. Size: 254

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Bosses.cs

<pre>new Type[]
		{
			typeof(AnonsBoots),					typeof(AnonsBootsGargoyle),			typeof(AnonsSpellbook),			typeof(BalakaisShamanStaff),
			typeof(BalakaisShamanStaffGargoyle),typeof(EnchantressCameo),			typeof(GrugorsShield),			typeof(GrugorsShieldGargoyle),
			typeof(HalawasHuntingBow),			typeof(HalawasHuntingBowGargoyle),	typeof(HawkwindsRobe),			typeof(JumusSacredHide),
			typeof(JumusSacredHideGargoyle), 	typeof(JuonarsGrimoire), 			typeof(LereisHuntingSpear), 	typeof(LereisHuntingSpearGargoyle), 
			typeof(MinaxsSandles), 				typeof(MinaxsSandlesGargoyle), 		typeof(MocapotilsObsidianSword),typeof(OzymandiasObi),
			typeof(OzymandiasObiGargoyle), 		typeof(ShantysWaders), 				typeof(ShantysWadersGargoyle), 	typeof(TotemOfTheTribe),
			typeof(WamapsBoneEarrings), 		typeof(WamapsBoneEarringsGargoyle), typeof(UnstableTimeRift)
		}</pre>

Fragment 2 in file Scripts\Services\Expansions\TimeOfLegends.cs

<pre>new Type[]
		{
			typeof(AnonsBoots),					typeof(AnonsBootsGargoyle),			typeof(AnonsSpellbook),			typeof(BalakaisShamanStaff),
			typeof(BalakaisShamanStaffGargoyle),typeof(EnchantressCameo),			typeof(GrugorsShield),			typeof(GrugorsShieldGargoyle),
			typeof(HalawasHuntingBow),			typeof(HalawasHuntingBowGargoyle),	typeof(HawkwindsRobe),			typeof(JumusSacredHide),
			typeof(JumusSacredHideGargoyle), 	typeof(JuonarsGrimoire), 			typeof(LereisHuntingSpear), 	typeof(LereisHuntingSpearGargoyle), 
			typeof(MinaxsSandles), 				typeof(MinaxsSandlesGargoyle), 		typeof(MocapotilsObsidianSword),typeof(OzymandiasObi),
			typeof(OzymandiasObiGargoyle), 		typeof(ShantysWaders), 				typeof(ShantysWadersGargoyle), 	typeof(TotemOfTheTribe),
			typeof(WamapsBoneEarrings), 		typeof(WamapsBoneEarringsGargoyle), typeof(UnstableTimeRift)
		}</pre>

## Duplicated Code. Size: 254

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\HireBeggar.cs

<pre>this.SpeechHue = Utility.RandomDyedHue();
            this.Hue = Utility.RandomSkinHue();

            if (this.Female = Utility.RandomBool()) 
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");

                switch ( Utility.Random(2) )
                {
                    case 0:
                        this.AddItem(new Skirt(Utility.RandomNeutralHue()));
                        break;
                    case 1:
                        this.AddItem(new Kilt(Utility.RandomNeutralHue()));
                        break;
                }
            }
            else 
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
                this.AddItem(new ShortPants(Utility.RandomNeutralHue()));
            }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HirePeasant.cs

<pre>this.SpeechHue = Utility.RandomDyedHue();
            this.Hue = Utility.RandomSkinHue();

            if (this.Female = Utility.RandomBool()) 
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");

                switch ( Utility.Random(2) )
                {
                    case 0:
                        this.AddItem(new Skirt(Utility.RandomNeutralHue()));
                        break;
                    case 1:
                        this.AddItem(new Kilt(Utility.RandomNeutralHue()));
                        break;
                }
            }
            else 
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
                this.AddItem(new ShortPants(Utility.RandomNeutralHue()));
            }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\HireThief.cs

<pre>this.SpeechHue = Utility.RandomDyedHue();
            this.Hue = Utility.RandomSkinHue();

            if (this.Female = Utility.RandomBool()) 
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");

                switch ( Utility.Random(2) )
                {
                    case 0:
                        this.AddItem(new Skirt(Utility.RandomNeutralHue()));
                        break;
                    case 1:
                        this.AddItem(new Kilt(Utility.RandomNeutralHue()));
                        break;
                }
            }
            else 
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
                this.AddItem(new ShortPants(Utility.RandomNeutralHue()));
            }</pre>

## Duplicated Code. Size: 254

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BrokenBed.cs

<pre>this.m_Deed = deed;

                this.AddPage(0);

                this.AddBackground(0, 0, 273, 324, 0x13BE);
                this.AddImageTiled(10, 10, 253, 20, 0xA40);
                this.AddImageTiled(10, 40, 253, 244, 0xA40);
                this.AddImageTiled(10, 294, 253, 20, 0xA40);
                this.AddAlphaRegion(10, 10, 253, 304);
                this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 296, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 2 in file Scripts\Items\Addons\BrokenVanity.cs

<pre>this.m_Deed = deed;

                this.AddPage(0);

                this.AddBackground(0, 0, 273, 324, 0x13BE);
                this.AddImageTiled(10, 10, 253, 20, 0xA40);
                this.AddImageTiled(10, 40, 253, 244, 0xA40);
                this.AddImageTiled(10, 294, 253, 20, 0xA40);
                this.AddAlphaRegion(10, 10, 253, 304);
                this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 296, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 3 in file Scripts\Items\Addons\Curtains.cs

<pre>this.m_Deed = deed;

                this.AddPage(0);

                this.AddBackground(0, 0, 273, 324, 0x13BE);
                this.AddImageTiled(10, 10, 253, 20, 0xA40);
                this.AddImageTiled(10, 40, 253, 244, 0xA40);
                this.AddImageTiled(10, 294, 253, 20, 0xA40);
                this.AddAlphaRegion(10, 10, 253, 304);
                this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 296, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 4 in file Scripts\Items\Addons\HangingAxes.cs

<pre>this.m_Deed = deed;

                this.AddPage(0);

                this.AddBackground(0, 0, 273, 324, 0x13BE);
                this.AddImageTiled(10, 10, 253, 20, 0xA40);
                this.AddImageTiled(10, 40, 253, 244, 0xA40);
                this.AddImageTiled(10, 294, 253, 20, 0xA40);
                this.AddAlphaRegion(10, 10, 253, 304);
                this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 296, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 5 in file Scripts\Items\Addons\HangingSwords.cs

<pre>this.m_Deed = deed;

                this.AddPage(0);

                this.AddBackground(0, 0, 273, 324, 0x13BE);
                this.AddImageTiled(10, 10, 253, 20, 0xA40);
                this.AddImageTiled(10, 40, 253, 244, 0xA40);
                this.AddImageTiled(10, 294, 253, 20, 0xA40);
                this.AddAlphaRegion(10, 10, 253, 304);
                this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 296, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 6 in file Scripts\Items\Addons\HouseLadder.cs

<pre>this.m_Deed = deed;

                this.AddPage(0);

                this.AddBackground(0, 0, 273, 324, 0x13BE);
                this.AddImageTiled(10, 10, 253, 20, 0xA40);
                this.AddImageTiled(10, 40, 253, 244, 0xA40);
                this.AddImageTiled(10, 294, 253, 20, 0xA40);
                this.AddAlphaRegion(10, 10, 253, 304);
                this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 296, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 7 in file Scripts\Items\Addons\Statue.cs

<pre>this.m_Deed = deed;

                this.AddPage(0);

                this.AddBackground(0, 0, 273, 324, 0x13BE);
                this.AddImageTiled(10, 10, 253, 20, 0xA40);
                this.AddImageTiled(10, 40, 253, 244, 0xA40);
                this.AddImageTiled(10, 294, 253, 20, 0xA40);
                this.AddAlphaRegion(10, 10, 253, 304);
                this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 296, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 8 in file Scripts\Items\Addons\UnmadeBed.cs

<pre>this.m_Deed = deed;

                this.AddPage(0);

                this.AddBackground(0, 0, 273, 324, 0x13BE);
                this.AddImageTiled(10, 10, 253, 20, 0xA40);
                this.AddImageTiled(10, 40, 253, 244, 0xA40);
                this.AddImageTiled(10, 294, 253, 20, 0xA40);
                this.AddAlphaRegion(10, 10, 253, 304);
                this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 296, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 9 in file Scripts\Items\Addons\WoodenCoffin.cs

<pre>this.m_Deed = deed;

                this.AddPage(0);

                this.AddBackground(0, 0, 273, 324, 0x13BE);
                this.AddImageTiled(10, 10, 253, 20, 0xA40);
                this.AddImageTiled(10, 40, 253, 244, 0xA40);
                this.AddImageTiled(10, 294, 253, 20, 0xA40);
                this.AddAlphaRegion(10, 10, 253, 304);
                this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 296, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 10 in file Scripts\Items\Containers\Vanity.cs

<pre>this.m_Deed = deed;

                this.AddPage(0);

                this.AddBackground(0, 0, 273, 324, 0x13BE);
                this.AddImageTiled(10, 10, 253, 20, 0xA40);
                this.AddImageTiled(10, 40, 253, 244, 0xA40);
                this.AddImageTiled(10, 294, 253, 20, 0xA40);
                this.AddAlphaRegion(10, 10, 253, 304);
                this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 296, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

## Duplicated Code. Size: 253

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetGump.cs

<pre>x += EntryWidth + OffsetSize;

            if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);

            x = BorderSize + OffsetSize;
            y += EntryHeight + OffsetSize;

            this.AddImageTiled(x, y, EntryWidth, EntryHeight, EntryGumpID);
            this.AddTextEntry(x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, 0, initialText);
            x += EntryWidth + OffsetSize;

            if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);

            this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 1, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Gumps\SkillsGump.cs

<pre>x += EntryWidth + OffsetSize;

            if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);

            x = BorderSize + OffsetSize;
            y += EntryHeight + OffsetSize;

            this.AddImageTiled(x, y, EntryWidth, EntryHeight, EntryGumpID);
            this.AddTextEntry(x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, 0, initialText);
            x += EntryWidth + OffsetSize;

            if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);

            this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 1, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 253

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\RottingCorpse.cs

<pre>SetStr(301, 350);
            SetDex(75);
            SetInt(151, 200);

            SetHits(1200);
            SetStam(150);
            SetMana(0);

            SetDamage(8, 10);

            SetDamageType(ResistanceType.Physical, 0);
            SetDamageType(ResistanceType.Cold, 50);
            SetDamageType(ResistanceType.Poison, 50);

            SetResistance(ResistanceType.Physical, 35, 45);
            SetResistance(ResistanceType.Fire, 20, 30);
            SetResistance(ResistanceType.Cold, 50, 70);
            SetResistance(ResistanceType.Poison, 40, 50);
            SetResistance(ResistanceType.Energy, 20, 30);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SkeletalLich.cs

<pre>SetStr( 301, 350 );
			SetDex( 75 );
			SetInt( 151, 200 );

			SetHits( 1200 );
			SetStam( 150 );
			SetMana( 0 );

			SetDamage( 8, 10 );

			SetDamageType( ResistanceType.Physical, 0 );
			SetDamageType( ResistanceType.Cold, 50 );
			SetDamageType( ResistanceType.Poison, 50 );

			SetResistance( ResistanceType.Physical, 35, 45 );
			SetResistance( ResistanceType.Fire, 20, 30 );
			SetResistance( ResistanceType.Cold, 50, 70 );
			SetResistance( ResistanceType.Poison, 40, 50 );
			SetResistance( ResistanceType.Energy, 20, 30 );</pre>

## Duplicated Code. Size: 253

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Creatures.cs

<pre>private void DropCrack(MovementPath path)
        {
            int time = 10;
            int x = this.X;
            int y = this.Y;

            for (int i = 0; i < path.Directions.Length; ++i)
            {
                Movement.Movement.Offset(path.Directions[i], ref x, ref y);
                IPoint3D p = new Point3D(x, y, this.Map.GetAverageZ(x, y)) as IPoint3D;

                Timer.DelayCall(TimeSpan.FromMilliseconds(time), new TimerStateCallback(ManaDrainEffects_Callback), new object[] { p, this.Map });

                time += 200;
            }
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Creatures\Cora.cs

<pre>private void DropCrack(MovementPath path)
        {
            int time = 10;
            int x = this.X;
            int y = this.Y;

            for (int i = 0; i < path.Directions.Length; ++i)
            {
                Movement.Movement.Offset(path.Directions[i], ref x, ref y);
                IPoint3D p = new Point3D(x, y, this.Map.GetAverageZ(x, y)) as IPoint3D;

                Timer.DelayCall(TimeSpan.FromMilliseconds(time), new TimerStateCallback(ManaDrainEffects_Callback), new object[] { p, this.Map });

                time += 200;
            }
        }</pre>

## Duplicated Code. Size: 253

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBCook.cs

<pre>this.Add(typeof(WoodenBowlOfCarrots), 1);
                this.Add(typeof(WoodenBowlOfCorn), 1);
                this.Add(typeof(WoodenBowlOfLettuce), 1);
                this.Add(typeof(WoodenBowlOfPeas), 1);
                this.Add(typeof(EmptyPewterBowl), 1);
                this.Add(typeof(PewterBowlOfCorn), 1);
                this.Add(typeof(PewterBowlOfLettuce), 1);
                this.Add(typeof(PewterBowlOfPeas), 1);
                this.Add(typeof(PewterBowlOfPotatos), 1);
                this.Add(typeof(WoodenBowlOfStew), 1);
                this.Add(typeof(WoodenBowlOfTomatoSoup), 1);</pre>

Fragment 2 in file Scripts\VendorInfo\SBInnKeeper.cs

<pre>this.Add(typeof(WoodenBowlOfCarrots), 1);
                this.Add(typeof(WoodenBowlOfCorn), 1);
                this.Add(typeof(WoodenBowlOfLettuce), 1);
                this.Add(typeof(WoodenBowlOfPeas), 1);
                this.Add(typeof(EmptyPewterBowl), 1);
                this.Add(typeof(PewterBowlOfCorn), 1);
                this.Add(typeof(PewterBowlOfLettuce), 1);
                this.Add(typeof(PewterBowlOfPeas), 1);
                this.Add(typeof(PewterBowlOfPotatos), 1);
                this.Add(typeof(WoodenBowlOfStew), 1);
                this.Add(typeof(WoodenBowlOfTomatoSoup), 1);</pre>

## Duplicated Code. Size: 253

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>m_Buffer[m_Index] = (byte)value;
			m_Buffer[m_Index + 1] = (byte)(value >> 8);
			m_Buffer[m_Index + 2] = (byte)(value >> 16);
			m_Buffer[m_Index + 3] = (byte)(value >> 24);
			m_Buffer[m_Index + 4] = (byte)(value >> 32);
			m_Buffer[m_Index + 5] = (byte)(value >> 40);
			m_Buffer[m_Index + 6] = (byte)(value >> 48);
			m_Buffer[m_Index + 7] = (byte)(value >> 56);
			m_Index += 8;</pre>

Fragment 2 in file Server\Serialization.cs

<pre>m_Buffer[m_Index] = (byte)value;
			m_Buffer[m_Index + 1] = (byte)(value >> 8);
			m_Buffer[m_Index + 2] = (byte)(value >> 16);
			m_Buffer[m_Index + 3] = (byte)(value >> 24);
			m_Buffer[m_Index + 4] = (byte)(value >> 32);
			m_Buffer[m_Index + 5] = (byte)(value >> 40);
			m_Buffer[m_Index + 6] = (byte)(value >> 48);
			m_Buffer[m_Index + 7] = (byte)(value >> 56);
			m_Index += 8;</pre>

## Duplicated Code. Size: 253

### Duplicated Fragments:

Fragment 1 in file Server\TileData.cs

<pre>{
								if ((i & 0x1F) == 0)
								{
									bin.ReadInt32(); // header
								}

								TileFlag flags = (TileFlag)bin.ReadInt32();
								int weight = bin.ReadByte();
								int quality = bin.ReadByte();
								bin.ReadInt16();
								bin.ReadByte();
								int quantity = bin.ReadByte();
								bin.ReadInt32();
								bin.ReadByte();
								int value = bin.ReadByte();
								int height = bin.ReadByte();

								m_ItemData[i] = new ItemData(ReadNameString(bin), flags, weight, quality, quantity, value, height);
							}</pre>

Fragment 2 in file Server\TileData.cs

<pre>{
								if ((i & 0x1F) == 0)
								{
									bin.ReadInt32(); // header
								}

								TileFlag flags = (TileFlag)bin.ReadInt32();
								int weight = bin.ReadByte();
								int quality = bin.ReadByte();
								bin.ReadInt16();
								bin.ReadByte();
								int quantity = bin.ReadByte();
								bin.ReadInt32();
								bin.ReadByte();
								int value = bin.ReadByte();
								int height = bin.ReadByte();

								m_ItemData[i] = new ItemData(ReadNameString(bin), flags, weight, quality, quantity, value, height);
							}</pre>

## Duplicated Code. Size: 253

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCannonDeed.cs

<pre>public bool ValidatePlacement( Mobile from, Point3D loc )
		{
			if ( from.AccessLevel >= AccessLevel.GameMaster )
				return true;

			if ( !from.InRange( this.GetWorldLocation(), 1 ) )
			{
				from.SendLocalizedMessage( 500446 ); // That is too far away.
				return false;
			}

			Map map = from.Map;

			if ( map == null )
				return false;

			BaseHouse house = BaseHouse.FindHouseAt( loc, map, 20 );

			if ( house != null && !house.IsFriend( from ) )
			{
				from.SendLocalizedMessage(500269); // You cannot build that there.
				return false;
			}

			if ( !map.CanFit( loc, 20 ) )
			{
				from.SendLocalizedMessage( 500269 ); // You cannot build that there.
				return false;
			}

			return true;
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCatapultDeed.cs

<pre>public bool ValidatePlacement( Mobile from, Point3D loc )
		{
			if ( from.AccessLevel >= AccessLevel.GameMaster )
				return true;

			if ( !from.InRange( this.GetWorldLocation(), 1 ) )
			{
				from.SendLocalizedMessage( 500446 ); // That is too far away.
				return false;
			}

			Map map = from.Map;

			if ( map == null )
				return false;

			BaseHouse house = BaseHouse.FindHouseAt( loc, map, 20 );

			if ( house != null && !house.IsFriend( from ) )
			{
				from.SendLocalizedMessage(500269); // You cannot build that there.
				return false;
			}

			if ( !map.CanFit( loc, 20 ) )
			{
				from.SendLocalizedMessage( 500269 ); // You cannot build that there.
				return false;
			}

			return true;
		}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRamDeed.cs

<pre>public bool ValidatePlacement( Mobile from, Point3D loc )
		{
			if ( from.AccessLevel >= AccessLevel.GameMaster )
				return true;

			if ( !from.InRange( this.GetWorldLocation(), 1 ) )
			{
				from.SendLocalizedMessage( 500446 ); // That is too far away.
				return false;
			}

			Map map = from.Map;

			if ( map == null )
				return false;

			BaseHouse house = BaseHouse.FindHouseAt( loc, map, 20 );

			if ( house != null && !house.IsFriend( from ) )
			{
				from.SendLocalizedMessage(500269); // You cannot build that there.
				return false;
			}

			if ( !map.CanFit( loc, 20 ) )
			{
				from.SendLocalizedMessage( 500269 ); // You cannot build that there.
				return false;
			}

			return true;
		}</pre>

## Duplicated Code. Size: 252

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x373A, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x373A, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z - 1), m.Map, 0x373A, 15, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x213);</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x213);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y + 1, m.Z), m.Map, 0x373A, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X + 1, m.Y, m.Z), m.Map, 0x373A, 15, effHue, 0);
                    Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z - 1), m.Map, 0x373A, 15, effHue, 0);</pre>

## Duplicated Code. Size: 252

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseEvilCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 20, 30 );
			SetResistance( ResistanceType.Fire, 30, 40 );
			SetResistance( ResistanceType.Cold, 30, 40 );
			SetResistance( ResistanceType.Poison, 10, 20 );
			SetResistance( ResistanceType.Energy, 30, 40 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );
			SetSkill( SkillName.Musicianship, 50, 75 );
			SetSkill( SkillName.Discordance, 50, 75 );

			Fame = GetFame;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DespiseGoodCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 20, 30 );
			SetResistance( ResistanceType.Fire, 30, 40 );
			SetResistance( ResistanceType.Cold, 30, 40 );
			SetResistance( ResistanceType.Poison, 10, 20 );
			SetResistance( ResistanceType.Energy, 30, 40 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );
			SetSkill( SkillName.Musicianship, 50, 75 );
			SetSkill( SkillName.Discordance, 50, 75 );

			Fame = GetFame;</pre>

## Duplicated Code. Size: 250

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Statics.cs

<pre>if (item is Static || item is BaseFloor || item is BaseWall)
                    {
                        Map itemMap = item.Map;

                        if (itemMap == null || itemMap == Map.Internal)
                            continue;

                        Hashtable table = (Hashtable)mapTable[itemMap];

                        if (table == null)
                            mapTable[itemMap] = table = new Hashtable();

                        Point2D p = new Point2D(item.X >> 3, item.Y >> 3);

                        DeltaState state = (DeltaState)table[p];

                        if (state == null)
                            table[p] = state = new DeltaState(p);

                        state.m_List.Add(item);
                    }</pre>

Fragment 2 in file Scripts\Commands\Statics.cs

<pre>if (item is Static || item is BaseFloor || item is BaseWall)
                    {
                        Map itemMap = item.Map;

                        if (itemMap == null || itemMap == Map.Internal)
                            continue;

                        Hashtable table = (Hashtable)mapTable[itemMap];

                        if (table == null)
                            mapTable[itemMap] = table = new Hashtable();

                        Point2D p = new Point2D(item.X >> 3, item.Y >> 3);

                        DeltaState state = (DeltaState)table[p];

                        if (state == null)
                            table[p] = state = new DeltaState(p);

                        state.m_List.Add(item);
                    }</pre>

## Duplicated Code. Size: 250

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\EngravingTools.cs

<pre>this.AddButton(125, 300, 0x81A, 0x81B, (int)Buttons.Okay, GumpButtonType.Reply, 0);
                this.AddButton(320, 300, 0x819, 0x818, (int)Buttons.Cancel, GumpButtonType.Reply, 0);

                this.AddImageTiled(75, 245, 350, 40, 0xDB0);
                this.AddImageTiled(76, 245, 350, 2, 0x23C5);
                this.AddImageTiled(75, 245, 2, 40, 0x23C3);
                this.AddImageTiled(75, 285, 350, 2, 0x23C5);
                this.AddImageTiled(425, 245, 2, 42, 0x23C3);</pre>

Fragment 2 in file Scripts\Items\Tools\WeaponEngravingTool.cs

<pre>this.AddButton(125, 300, 0x81A, 0x81B, (int)Buttons.Okay, GumpButtonType.Reply, 0);
                this.AddButton(320, 300, 0x819, 0x818, (int)Buttons.Cancel, GumpButtonType.Reply, 0);
                this.AddImageTiled(75, 245, 350, 40, 0xDB0);
                this.AddImageTiled(76, 245, 350, 2, 0x23C5);
                this.AddImageTiled(75, 245, 2, 40, 0x23C3);
                this.AddImageTiled(75, 285, 350, 2, 0x23C5);
                this.AddImageTiled(425, 245, 2, 42, 0x23C3);</pre>

## Duplicated Code. Size: 250

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\BaseStatuette.cs

<pre>{
                this.m_Statuette = statuette;

                this.AddBackground(0, 0, 300, 150, 0xA28);

                this.AddHtmlLocalized(45, 20, 300, 35, statuette.TurnedOn ? 1011035 : 1011034, false, false); // [De]Activate this item

                this.AddButton(40, 53, 0xFA5, 0xFA7, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(80, 55, 65, 35, 1011036, false, false); // OKAY

                this.AddButton(150, 53, 0xFA5, 0xFA7, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(190, 55, 100, 35, 1011012, false, false); // CANCEL
            }</pre>

Fragment 2 in file Scripts\Items\Decorative\MonsterStatuette.cs

<pre>{
                this.m_Statuette = statuette;

                this.AddBackground(0, 0, 300, 150, 0xA28);

                this.AddHtmlLocalized(45, 20, 300, 35, statuette.TurnedOn ? 1011035 : 1011034, false, false); // [De]Activate this item

                this.AddButton(40, 53, 0xFA5, 0xFA7, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(80, 55, 65, 35, 1011036, false, false); // OKAY

                this.AddButton(150, 53, 0xFA5, 0xFA7, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(190, 55, 100, 35, 1011012, false, false); // CANCEL
            }</pre>

## Duplicated Code. Size: 249

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\LightningArrow.cs

<pre>ArrayList targets = new ArrayList();

            for (int i = 0; i < list.Count; ++i)
            {
                Mobile m = (Mobile)list[i];

                if (m != defender && m != attacker && SpellHelper.ValidIndirectTarget(attacker, m))
                {
                    if (m == null || m.Deleted || m.Map != attacker.Map || !m.Alive || !attacker.CanSee(m) || !attacker.CanBeHarmful(m))
                        continue;

                    if (!attacker.InRange(m, weapon.MaxRange))
                        continue;

                    if (attacker.InLOS(m))
                        targets.Add(m);
                }
            }</pre>

Fragment 2 in file Scripts\Abilities\WhirlwindAttack.cs

<pre>ArrayList targets = new ArrayList();

            for (int i = 0; i < list.Count; ++i)
            {
                Mobile m = (Mobile)list[i];

                if (m != defender && m != attacker && SpellHelper.ValidIndirectTarget(attacker, m))
                {
                    if (m == null || m.Deleted || m.Map != attacker.Map || !m.Alive || !attacker.CanSee(m) || !attacker.CanBeHarmful(m))
                        continue;

                    if (!attacker.InRange(m, weapon.MaxRange))
                        continue;

                    if (attacker.InLOS(m))
                        targets.Add(m);
                }
            }</pre>

## Duplicated Code. Size: 249

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>{
                    int wear;

                    if (weapon.Type == WeaponType.Bashing)
                        wear = Absorbed / 2;
                    else
                        wear = Utility.Random(2);

                    if (wear > 0 && this.m_MaxHitPoints > 0)
                    {
                        if (this.m_HitPoints >= wear)
                        {
                            this.HitPoints -= wear;
                            wear = 0;
                        }
                        else
                        {
                            wear -= this.HitPoints;
                            this.HitPoints = 0;
                        }

                        if (wear > 0)
                        {
                            if (this.m_MaxHitPoints > wear)
                            {
                                this.MaxHitPoints -= wear;

                                if (this.Parent is Mobile)
                                    ((Mobile)this.Parent).LocalOverheadMessage(MessageType.Regular, 0x3B2, 1061121); // Your equipment is severely damaged.
                            }
                            else
                            {
                                this.Delete();
                            }
                        }
                    }
                }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>{
                    int wear;

                    if (weapon.Type == WeaponType.Bashing)
                        wear = Absorbed / 2;
                    else
                        wear = Utility.Random(2);

                    if (wear > 0 && this.m_MaxHitPoints > 0)
                    {
                        if (this.m_HitPoints >= wear)
                        {
                            this.HitPoints -= wear;
                            wear = 0;
                        }
                        else
                        {
                            wear -= this.HitPoints;
                            this.HitPoints = 0;
                        }

                        if (wear > 0)
                        {
                            if (this.m_MaxHitPoints > wear)
                            {
                                this.MaxHitPoints -= wear;

                                if (this.Parent is Mobile)
                                    ((Mobile)this.Parent).LocalOverheadMessage(MessageType.Regular, 0x3B2, 1061121); // Your equipment is severely damaged.
                            }
                            else
                            {
                                this.Delete();
                            }
                        }
                    }
                }</pre>

## Duplicated Code. Size: 249

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\SQ2Gump.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            this.AddPage(0);
            this.AddBackground(65, 65, 386, 294, 9200);
            this.AddTextEntry(159, 81, 200, 26, 1163, 0, @"La Insep Ohm");
            this.AddButton(82, 304, 2152, 248, 2, GumpButtonType.Reply, 2);
            this.AddButton(82, 249, 2151, 248, 1, GumpButtonType.Reply, 1);
            this.AddButton(82, 194, 2151, 248, 0, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Gumps\SQ3Gump.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            this.AddPage(0);
            this.AddBackground(65, 65, 386, 294, 9200);
            this.AddTextEntry(159, 81, 200, 26, 1163, 0, @"La Insep Ohm");
            this.AddButton(82, 304, 2152, 248, 2, GumpButtonType.Reply, 2);
            this.AddButton(82, 249, 2151, 248, 1, GumpButtonType.Reply, 1);
            this.AddButton(82, 194, 2151, 248, 0, GumpButtonType.Reply, 0);</pre>

Fragment 3 in file Scripts\Gumps\SQ4Gump.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            this.AddPage(0);
            this.AddBackground(65, 65, 386, 294, 9200);
            this.AddTextEntry(159, 81, 200, 26, 1163, 0, @"La Insep Ohm");
            this.AddButton(82, 304, 2152, 248, 0, GumpButtonType.Reply, 0);
            this.AddButton(82, 249, 2151, 248, 1, GumpButtonType.Reply, 1);
            this.AddButton(82, 194, 2151, 248, 2, GumpButtonType.Reply, 2);</pre>

## Duplicated Code. Size: 248

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\HighPlainsBoura.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (!m_Stunning && 0.3 > Utility.RandomDouble())
            {
                m_Stunning = true;

                defender.Animate(21, 6, 1, true, false, 0);
                PlaySound(0xEE);
                defender.LocalOverheadMessage(MessageType.Regular, 0x3B2, false,
                    "You have been stunned by a colossal blow!");

                var weapon = Weapon as BaseWeapon;
                if (weapon != null)
                    weapon.OnHit(this, defender);

                if (defender.Alive)
                {
                    defender.Frozen = true;
                    Timer.DelayCall(TimeSpan.FromSeconds(5.0), new TimerStateCallback(Recover_Callback), defender);
                }
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\LowlandBoura.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (!m_Stunning && 0.3 > Utility.RandomDouble())
            {
                m_Stunning = true;

                defender.Animate(21, 6, 1, true, false, 0);
                PlaySound(0xEE);
                defender.LocalOverheadMessage(MessageType.Regular, 0x3B2, false,
                    "You have been stunned by a colossal blow!");

                var weapon = Weapon as BaseWeapon;
                if (weapon != null)
                    weapon.OnHit(this, defender);

                if (defender.Alive)
                {
                    defender.Frozen = true;
                    Timer.DelayCall(TimeSpan.FromSeconds(5.0), new TimerStateCallback(Recover_Callback), defender);
                }
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\RuddyBoura.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (!m_Stunning && 0.3 > Utility.RandomDouble())
            {
                m_Stunning = true;

                defender.Animate(21, 6, 1, true, false, 0);
                PlaySound(0xEE);
                defender.LocalOverheadMessage(MessageType.Regular, 0x3B2, false,
                    "You have been stunned by a colossal blow!");

                var weapon = Weapon as BaseWeapon;
                if (weapon != null)
                    weapon.OnHit(this, defender);

                if (defender.Alive)
                {
                    defender.Frozen = true;
                    Timer.DelayCall(TimeSpan.FromSeconds(5.0), new TimerStateCallback(Recover_Callback), defender);
                }
            }
        }</pre>

## Duplicated Code. Size: 247

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Spellbooks\Spellbook.cs

<pre>if ((prop = m_AosAttributes.SpellDamage) != 0)
			{
				list.Add(1060483, prop.ToString()); // spell damage increase ~1_val~%
			}

			if ((prop = m_AosAttributes.BonusStam) != 0)
			{
				list.Add(1060484, prop.ToString()); // stamina increase ~1_val~
			}

			if ((prop = m_AosAttributes.BonusStr) != 0)
			{
				list.Add(1060485, prop.ToString()); // strength bonus ~1_val~
			}

			if ((prop = m_AosAttributes.WeaponSpeed) != 0)
			{
				list.Add(1060486, prop.ToString()); // swing speed increase ~1_val~%
			}

			if (Core.ML && (prop = m_AosAttributes.IncreasedKarmaLoss) != 0)
			{
				list.Add(1075210, prop.ToString()); // Increased Karma Loss ~1val~%
			}</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if ((prop = m_AosAttributes.SpellDamage) != 0)
			{
				list.Add(1060483, prop.ToString()); // spell damage increase ~1_val~%
			}

			if ((prop = m_AosAttributes.BonusStam) != 0)
			{
				list.Add(1060484, prop.ToString()); // stamina increase ~1_val~
			}

			if ((prop = m_AosAttributes.BonusStr) != 0)
			{
				list.Add(1060485, prop.ToString()); // strength bonus ~1_val~
			}

			if ((prop = m_AosAttributes.WeaponSpeed) != 0)
			{
				list.Add(1060486, prop.ToString()); // swing speed increase ~1_val~%
			}

			if (Core.ML && (prop = m_AosAttributes.IncreasedKarmaLoss) != 0)
			{
				list.Add(1075210, prop.ToString()); // Increased Karma Loss ~1val~%
			}</pre>

## Duplicated Code. Size: 247

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ViceVsVirtue\Gumps\GuildLeaderboardGump.cs

<pre>y += 20;
                pageindex++;

                if (pageindex == PerPage)
                {
                    AddHtmlLocalized(60, 290, 150, 20, 1153561, String.Format("{0}\t{1}", page.ToString(), pages.ToString()), 0xFFFF, false, false); // Page ~1_CUR~ of ~2_MAX~

                    if (i > 0 && i < list.Count - 1)
                    {
                        AddButton(200, 290, 4005, 4007, 0, GumpButtonType.Page, page + 1);

                        page++;
                        y = 75;
                        pageindex = 0;
                        AddPage(page);

                        AddButton(170, 290, 4014, 4016, 0, GumpButtonType.Page, page - 1);
                    }
                }</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\Gumps\LeaderboardGump.cs

<pre>y += 20;
                pageindex++;

                if (pageindex == PerPage)
                {
                    AddHtmlLocalized(60, 290, 150, 20, 1153561, String.Format("{0}\t{1}", page.ToString(), pages.ToString()), 0xFFFF, false, false); // Page ~1_CUR~ of ~2_MAX~

                    if (i > 0 && i < list.Count - 1)
                    {
                        AddButton(200, 290, 4005, 4007, 0, GumpButtonType.Page, page + 1);

                        page++;
                        y = 75;
                        pageindex = 0;
                        AddPage(page);

                        AddButton(170, 290, 4014, 4016, 0, GumpButtonType.Page, page - 1);
                    }
                }</pre>

## Duplicated Code. Size: 247

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>SendEverything();
					SendIncomingPacket();

					if (ns != null)
					{
						ns.Sequence = 0;
						ClearFastwalkStack();

						ns.Send(MobileIncoming.Create(ns, this, this));

						if (ns.StygianAbyss)
						{
							ns.Send(SupportedFeatures.Instantiate(ns));
							ns.Send(new MobileUpdate(this));
							ns.Send(new MobileAttributes(this));
						}
						else
						{
							ns.Send(SupportedFeatures.Instantiate(ns));
							ns.Send(new MobileUpdateOld(this));
							ns.Send(new MobileAttributes(this));
						}
					}

					OnMapChange(oldMap);</pre>

Fragment 2 in file Server\Mobile.cs

<pre>SendEverything();
			SendIncomingPacket();

			if (ns != null)
			{
				ns.Sequence = 0;
				ClearFastwalkStack();

				ns.Send(MobileIncoming.Create(ns, this, this));

				if (ns.StygianAbyss)
				{
					ns.Send(SupportedFeatures.Instantiate(ns));
					ns.Send(new MobileUpdate(this));
					ns.Send(new MobileAttributes(this));
				}
				else
				{
					ns.Send(SupportedFeatures.Instantiate(ns));
					ns.Send(new MobileUpdateOld(this));
					ns.Send(new MobileAttributes(this));
				}
			}

			OnMapChange(oldMap);</pre>

## Duplicated Code. Size: 246

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\CategorizedAddGump.cs

<pre>x += emptyWidth + OffsetSize;

            if (OldStyle)
                this.AddImageTiled(x, y, TotalWidth - (OffsetSize * 3) - SetWidth, EntryHeight, HeaderGumpID);
            else
                this.AddImageTiled(x, y, PrevWidth, EntryHeight, HeaderGumpID);

            if (page > 0)
            {
                this.AddButton(x + PrevOffsetX, y + PrevOffsetY, PrevButtonID1, PrevButtonID2, 2, GumpButtonType.Reply, 0);

                if (PrevLabel)
                    this.AddLabel(x + PrevLabelOffsetX, y + PrevLabelOffsetY, TextHue, "Previous");
            }

            x += PrevWidth + OffsetSize;

            if (!OldStyle)
                this.AddImageTiled(x, y, NextWidth, EntryHeight, HeaderGumpID);</pre>

Fragment 2 in file Scripts\Gumps\Go\GoGump.cs

<pre>x += emptyWidth + OffsetSize;

            if (OldStyle)
                this.AddImageTiled(x, y, TotalWidth - (OffsetSize * 3) - SetWidth, EntryHeight, HeaderGumpID);
            else
                this.AddImageTiled(x, y, PrevWidth, EntryHeight, HeaderGumpID);

            if (page > 0)
            {
                this.AddButton(x + PrevOffsetX, y + PrevOffsetY, PrevButtonID1, PrevButtonID2, 2, GumpButtonType.Reply, 0);

                if (PrevLabel)
                    this.AddLabel(x + PrevLabelOffsetX, y + PrevLabelOffsetY, TextHue, "Previous");
            }

            x += PrevWidth + OffsetSize;

            if (!OldStyle)
                this.AddImageTiled(x, y, NextWidth, EntryHeight, HeaderGumpID);</pre>

## Duplicated Code. Size: 246

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>{
                        line1.Location = new Point3D(X + 2, Y + 3, Z + ZSurface);
                        line2.Location = new Point3D(X - 2, Y + 3, Z + ZSurface);
                        line3.Location = new Point3D(X + 2, Y - 1, Z + ZSurface);
                        line4.Location = new Point3D(X - 2, Y - 1, Z + ZSurface);
                        line5.Location = new Point3D(X + 2, Y - 6, Z + ZSurface);
                        line6.Location = new Point3D(X - 2, Y - 6, Z + ZSurface);
                        break;
                    }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>{
                        line1.Location = new Point3D(X + 3, Y - 2, Z + ZSurface);
                        line2.Location = new Point3D(X + 3, Y + 2, Z + ZSurface);
                        line3.Location = new Point3D(X - 1, Y - 2, Z + ZSurface);
                        line4.Location = new Point3D(X - 1, Y + 2, Z + ZSurface);
                        line5.Location = new Point3D(X - 6, Y - 2, Z + ZSurface);
                        line6.Location = new Point3D(X - 6, Y + 2, Z + ZSurface);
                        break;
                    }</pre>

## Duplicated Code. Size: 246

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>{
                        line1.Location = new Point3D(X + 2, Y - 3, Z + ZSurface);
                        line2.Location = new Point3D(X - 2, Y - 3, Z + ZSurface);
                        line3.Location = new Point3D(X + 2, Y + 1, Z + ZSurface);
                        line4.Location = new Point3D(X - 2, Y + 1, Z + ZSurface);
                        line5.Location = new Point3D(X + 2, Y + 6, Z + ZSurface);
                        line6.Location = new Point3D(X - 2, Y + 6, Z + ZSurface);
                        break;
                    }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>{
                        line1.Location = new Point3D(X - 3, Y - 2, Z + ZSurface);
                        line2.Location = new Point3D(X - 3, Y + 2, Z + ZSurface);
                        line3.Location = new Point3D(X + 1, Y - 2, Z + ZSurface);
                        line4.Location = new Point3D(X + 1, Y + 2, Z + ZSurface);
                        line5.Location = new Point3D(X + 6, Y - 2, Z + ZSurface);
                        line6.Location = new Point3D(X + 6, Y + 2, Z + ZSurface);
                        break;
                    }</pre>

## Duplicated Code. Size: 246

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>{
                        line1.Location = new Point3D(X + 2, Y - 3, Z + ZSurface);
                        line2.Location = new Point3D(X - 2, Y - 3, Z + ZSurface);
                        line3.Location = new Point3D(X + 2, Y + 1, Z + ZSurface);
                        line4.Location = new Point3D(X - 2, Y + 1, Z + ZSurface);
                        line5.Location = new Point3D(X + 2, Y + 5, Z + ZSurface);
                        line6.Location = new Point3D(X - 2, Y + 5, Z + ZSurface);
                        break;
                    }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>{
                        line1.Location = new Point3D(X + 1, Y - 2, Z + ZSurface);
                        line2.Location = new Point3D(X + 1, Y + 2, Z + ZSurface);
                        line3.Location = new Point3D(X + 5, Y - 2, Z + ZSurface);
                        line4.Location = new Point3D(X + 5, Y + 2, Z + ZSurface);
                        line5.Location = new Point3D(X - 3, Y - 2, Z + ZSurface);
                        line6.Location = new Point3D(X - 3, Y + 2, Z + ZSurface);
                        break;
                    }</pre>

## Duplicated Code. Size: 246

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>{
                        line1.Location = new Point3D(X + 2, Y + 3, Z + ZSurface);
                        line2.Location = new Point3D(X - 2, Y + 3, Z + ZSurface);
                        line3.Location = new Point3D(X + 2, Y - 1, Z + ZSurface);
                        line4.Location = new Point3D(X - 2, Y - 1, Z + ZSurface);
                        line5.Location = new Point3D(X + 2, Y - 5, Z + ZSurface);
                        line6.Location = new Point3D(X - 2, Y - 5, Z + ZSurface);
                        break;
                    }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>{
                        line1.Location = new Point3D(X - 1, Y - 2, Z + ZSurface);
                        line2.Location = new Point3D(X - 1, Y + 2, Z + ZSurface);
                        line3.Location = new Point3D(X - 5, Y - 2, Z + ZSurface);
                        line4.Location = new Point3D(X - 5, Y + 2, Z + ZSurface);
                        line5.Location = new Point3D(X + 3, Y - 2, Z + ZSurface);
                        line6.Location = new Point3D(X + 3, Y + 2, Z + ZSurface);
                        break;
                    }</pre>

## Duplicated Code. Size: 246

### Duplicated Fragments:

Fragment 1 in file Server\Items\Container.cs

<pre>var typedItems = FindItemsByType(type, recurse);

			var groups = new List<List<Item>>();
			int idx = 0;

			while (idx < typedItems.Length)
			{
				Item a = typedItems[idx++];
				var group = new List<Item>();

				group.Add(a);

				while (idx < typedItems.Length)
				{
					Item b = typedItems[idx];
					int v = grouper(a, b);

					if (v == 0)
					{
						group.Add(b);
					}
					else
					{
						break;
					}

					++idx;
				}

				groups.Add(group);
			}</pre>

Fragment 2 in file Server\Items\Container.cs

<pre>var typedItems = FindItemsByType(type, recurse);

			var groups = new List<List<Item>>();
			int idx = 0;

			while (idx < typedItems.Length)
			{
				Item a = typedItems[idx++];
				var group = new List<Item>();

				group.Add(a);

				while (idx < typedItems.Length)
				{
					Item b = typedItems[idx];
					int v = grouper(a, b);

					if (v == 0)
					{
						group.Add(b);
					}
					else
					{
						break;
					}

					++idx;
				}

				groups.Add(group);
			}</pre>

## Duplicated Code. Size: 245

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ChaosDragoon.cs

<pre>int amount = Utility.RandomMinMax(1, 3);

            switch ( res )
            {
                case CraftResource.BlackScales:
                    this.AddItem(new BlackScales(amount));
                    break;
                case CraftResource.RedScales:
                    this.AddItem(new RedScales(amount));
                    break;
                case CraftResource.BlueScales:
                    this.AddItem(new BlueScales(amount));
                    break;
                case CraftResource.YellowScales:
                    this.AddItem(new YellowScales(amount));
                    break;
                case CraftResource.GreenScales:
                    this.AddItem(new GreenScales(amount));
                    break;
                case CraftResource.WhiteScales:
                    this.AddItem(new WhiteScales(amount));
                    break;
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ChaosDragoonElite.cs

<pre>int amount = Utility.RandomMinMax(1, 3);

            switch (res)
            {
                case CraftResource.BlackScales:
                    this.AddItem(new BlackScales(amount));
                    break;
                case CraftResource.RedScales:
                    this.AddItem(new RedScales(amount));
                    break;
                case CraftResource.BlueScales:
                    this.AddItem(new BlueScales(amount));
                    break;
                case CraftResource.YellowScales:
                    this.AddItem(new YellowScales(amount));
                    break;
                case CraftResource.GreenScales:
                    this.AddItem(new GreenScales(amount));
                    break;
                case CraftResource.WhiteScales:
                    this.AddItem(new WhiteScales(amount));
                    break;
            }</pre>

## Duplicated Code. Size: 245

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\CorrosiveSlime.cs

<pre>this.SetDamage(1, 5);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 5, 10);
            this.SetResistance(ResistanceType.Poison, 15, 20);

            this.SetSkill(SkillName.Poisoning, 36.0, 49.1);
            this.SetSkill(SkillName.Anatomy, 0);
            this.SetSkill(SkillName.MagicResist, 15.9, 18.9);
            this.SetSkill(SkillName.Tactics, 24.6, 26.1);
            this.SetSkill(SkillName.Wrestling, 24.9, 26.1);

            this.Fame = 300;
            this.Karma = -300;

            this.VirtualArmor = 8;</pre>

Fragment 2 in file Scripts\Mobiles\Void Creatures\Korpre.cs

<pre>this.SetDamage(1, 5);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 5, 10);
            this.SetResistance(ResistanceType.Poison, 15, 20);

            this.SetSkill(SkillName.Poisoning, 36.0, 49.1);
            this.SetSkill(SkillName.Anatomy, 0);
            this.SetSkill(SkillName.MagicResist, 15.9, 18.9);
            this.SetSkill(SkillName.Tactics, 24.6, 26.1);
            this.SetSkill(SkillName.Wrestling, 24.9, 26.1);

            this.Fame = 300;
            this.Karma = -300;

            this.VirtualArmor = 8;</pre>

## Duplicated Code. Size: 245

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\Core\CraftGump.cs

<pre>if (index == 0)
                    {
                        if (i > 0)
                        {
                            this.AddButton(370, 260, 4005, 4007, 0, GumpButtonType.Page, (i / 10) + 1);
                            this.AddHtmlLocalized(405, 263, 100, 18, 1044045, LabelColor, false, false); // NEXT PAGE
                        }

                        this.AddPage((i / 10) + 1);

                        if (i > 0)
                        {
                            this.AddButton(220, 260, 4014, 4015, 0, GumpButtonType.Page, i / 10);
                            this.AddHtmlLocalized(255, 263, 100, 18, 1044044, LabelColor, false, false); // PREV PAGE
                        }
                    }</pre>

Fragment 2 in file Scripts\Services\Craft\Core\CraftGump.cs

<pre>if (index == 0)
                {
                    if (i > 0)
                    {
                        this.AddButton(370, 260, 4005, 4007, 0, GumpButtonType.Page, (i / 10) + 1);
                        this.AddHtmlLocalized(405, 263, 100, 18, 1044045, LabelColor, false, false); // NEXT PAGE
                    }

                    this.AddPage((i / 10) + 1);

                    if (i > 0)
                    {
                        this.AddButton(220, 260, 4014, 4015, 0, GumpButtonType.Page, i / 10);
                        this.AddHtmlLocalized(255, 263, 100, 18, 1044044, LabelColor, false, false); // PREV PAGE
                    }
                }</pre>

## Duplicated Code. Size: 245

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\VeteranRewards\CrystalPortals\CorruptedCrystalPortal.cs

<pre>public virtual void OnTeleport(Mobile m, Point3D loc, Map map)
		{
			if (m == null || loc == Point3D.Zero || map == null || map == Map.Internal)
			{
				return;
			}		

			Effects.SendLocationEffect(m.Location, m.Map, 0x3728, 10, 10);
			Effects.PlaySound(m.Location, m.Map, 0x1FE);

			BaseCreature.TeleportPets(m, loc, map);
			m.MoveToWorld(loc, map);

			Effects.SendLocationEffect(m.Location, m.Map, 0x3728, 10, 10);
			Effects.PlaySound(m.Location, m.Map, 0x1FE);
		}</pre>

Fragment 2 in file Scripts\Services\VeteranRewards\CrystalPortals\CrystalPortal.cs

<pre>public virtual void OnTeleport(Mobile m, Point3D loc, Map map)
		{
			if (m == null || loc == Point3D.Zero || map == null || map == Map.Internal)
			{
				return;
			}

			Effects.SendLocationEffect(m.Location, m.Map, 0x3728, 10, 10);
			Effects.PlaySound(m.Location, m.Map, 0x1FE);

			BaseCreature.TeleportPets(m, loc, map);
			m.MoveToWorld(loc, map);

			Effects.SendLocationEffect(m.Location, m.Map, 0x3728, 10, 10);
			Effects.PlaySound(m.Location, m.Map, 0x1FE);
		}</pre>

## Duplicated Code. Size: 245

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>if (m_Journal == null || m_Journal.Count == 0)
			{
				writer.Write((int)0);
			}
			else
			{
				writer.Write((int)m_Journal.Count);
				foreach (XmlQuest.JournalEntry e in m_Journal)
				{
					writer.Write(e.EntryID);
					writer.Write(e.EntryText);
				}
			}
			// version 5
			writer.Write(m_Repeatable);
			// version 4
			writer.Write(m_QuestDifficulty);
			// version 3
			writer.Write(m_AttachmentString);
			// version 2
			writer.Write(m_NextRepeatable);
			// version 1
			if (m_RewardAttachment != null)
				writer.Write(m_RewardAttachment.Serial.Value);
			else
				writer.Write((int)0);
			// version 0
			writer.Write(m_ReturnContainer);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>if (m_Journal == null || m_Journal.Count == 0)
            {
                writer.Write((int)0);
            }
            else
            {
                writer.Write((int)m_Journal.Count);
                foreach (XmlQuest.JournalEntry e in m_Journal)
                {
                    writer.Write(e.EntryID);
                    writer.Write(e.EntryText);
                }
            }
            // version 13
            writer.Write(m_Repeatable);
            // version 12
            writer.Write(m_QuestDifficulty);
            // version 11
            writer.Write(m_AttachmentString);
            // version 10
            writer.Write(m_NextRepeatable);
            // version 9
            if (m_RewardAttachment != null)
                writer.Write(m_RewardAttachment.Serial.Value);
            else
                writer.Write((int)0);
            // version 8
            writer.Write(m_ReturnContainer);</pre>

## Duplicated Code. Size: 245

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGauntlet.cs

<pre>int count = reader.ReadInt();
                for(int i = 0;i<count;i++)
                {
                    ChallengeEntry entry = new ChallengeEntry();
                    entry.Participant = reader.ReadMobile();
                    string sname = reader.ReadString();
                    // look up the enum by name
                    ChallengeStatus status = ChallengeStatus.None;
                    try{
                    status = (ChallengeStatus)Enum.Parse(typeof(ChallengeStatus), sname);
                    } catch{}
                    entry.Status = status;
                    entry.Accepted = reader.ReadBool();
                    entry.PageBeingViewed = reader.ReadInt();
                    entry.Score = reader.ReadInt();

                    Participants.Add(entry);
                }
                break;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGauntlet.cs

<pre>int count = reader.ReadInt();
                for(int i = 0;i<count;i++)
                {
                    ChallengeEntry entry = new ChallengeEntry();
                    entry.Participant = reader.ReadMobile();
                    string sname = reader.ReadString();
                    // look up the enum by name
                    ChallengeStatus status = ChallengeStatus.None;
                    try{
                    status = (ChallengeStatus)Enum.Parse(typeof(ChallengeStatus), sname);
                    } catch{}
                    entry.Status = status;
                    entry.Accepted = reader.ReadBool();
                    entry.PageBeingViewed = reader.ReadInt();
                    entry.Score = reader.ReadInt();

                    Participants.Add(entry);
                }
                break;</pre>

## Duplicated Code. Size: 245

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Seventh\ChainLightning.cs

<pre>IDamageable id = targets[i];
                        Mobile m = id as Mobile;

                        if (Core.AOS)
                            damage = this.GetNewAosDamage(51, 1, 5, id is PlayerMobile, id);
                        else
                            damage = Utility.Random(27, 22);

                        if (Core.AOS && targets.Count > 2)
                            damage = (damage * 2) / targets.Count;
                        else if (!Core.AOS)
                            damage /= targets.Count;

                        if (!Core.AOS && m != null && this.CheckResisted(m))
                        {
                            damage *= 0.5;

                            m.SendLocalizedMessage(501783); // You feel yourself resisting magical energy.
                        }

                        Mobile source = this.Caster;</pre>

Fragment 2 in file Scripts\Spells\Seventh\MeteorSwarm.cs

<pre>IDamageable id = targets[i];
                        Mobile m = id as Mobile;

                        if (Core.AOS)
                            damage = this.GetNewAosDamage(51, 1, 5, id is PlayerMobile, id);
                        else
                            damage = Utility.Random(27, 22);

                        if (Core.AOS && targets.Count > 2)
                            damage = (damage * 2) / targets.Count;
                        else if (!Core.AOS)
                            damage /= targets.Count;

                        if (!Core.AOS && m != null && this.CheckResisted(m))
                        {
                            damage *= 0.5;

                            m.SendLocalizedMessage(501783); // You feel yourself resisting magical energy.
                        }

                        Mobile source = this.Caster;</pre>

## Duplicated Code. Size: 244

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>public override void InitOutfit()
        {
            if (this.Female)
                this.AddItem(new PlainDress());
            else
                this.AddItem(new Shirt(this.GetRandomHue()));

            int lowHue = this.GetRandomHue();

            this.AddItem(new ThighBoots());

            if (this.Female)
                this.AddItem(new FancyDress(lowHue));
            else
                this.AddItem(new FancyShirt(lowHue));
            this.AddItem(new LongPants(lowHue));

            if (!this.Female)
                this.AddItem(new BodySash(lowHue));

            this.PackGold(200, 250);
        }</pre>

Fragment 2 in file Scripts\Quests\Escortables.cs

<pre>public override void InitOutfit()
        {
            if (this.Female)
                this.AddItem(new PlainDress());
            else
                this.AddItem(new Shirt(this.GetRandomHue()));

            int lowHue = this.GetRandomHue();

            this.AddItem(new ThighBoots());

            if (this.Female)
                this.AddItem(new FancyDress(lowHue));
            else
                this.AddItem(new FancyShirt(lowHue));
            this.AddItem(new LongPants(lowHue));

            if (!this.Female)
                this.AddItem(new BodySash(lowHue));

            this.PackGold(200, 250);
        }</pre>

## Duplicated Code. Size: 244

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>Guild g = entry.Player == null ? null : entry.Player.Guild as Guild;

                AddButton(10, 70 + (pageIndex * 25), 4002, 4004, i + 100, GumpButtonType.Reply, 0);
                AddHtml(130, 70 + (pageIndex * 25), 200, 20, String.Format("<basefont color=#EEE8AA>{0}", entry.Player == null ? "Unknown" : entry.Player.Name), false, false);
                AddHtml(300, 70 + (pageIndex * 25), 200, 20, String.Format("<basefont color=#EEE8AA>{0}", g != null ? g.Name : ""), false, false);</pre>

Fragment 2 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>Guild g = entry.Player == null ? null : entry.Player.Guild as Guild;

                AddButton(10, 70 + (pageIndex * 25), 4002, 4004, i + 100, GumpButtonType.Reply, 0);
                AddHtml(130, 70 + (pageIndex * 25), 200, 20, String.Format("<basefont color=#EEE8AA>{0}", entry.Player == null ? "Unknown" : entry.Player.Name), false, false);
                AddHtml(300, 70 + (pageIndex * 25), 200, 20, String.Format("<basefont color=#EEE8AA>{0}", g != null ? g.Name : ""), false, false);</pre>

## Duplicated Code. Size: 244

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>StringBuilder sb = new StringBuilder();

            if (tourny.TournyType == TournyType.FreeForAll)
            {
                sb.Append("FFA");
            }
            else if (tourny.TournyType == TournyType.RandomTeam)
            {
                sb.Append("Team");
            }
            else if (tourny.TournyType == TournyType.RedVsBlue)
            {
                sb.Append("Red v Blue");
            }
            else
            {
                for (int i = 0; i < tourny.ParticipantsPerMatch; ++i)
                {
                    if (sb.Length > 0)
                        sb.Append('v');

                    sb.Append(tourny.PlayersPerParticipant);
                }
            }

            if (tourny.EventController != null)
                sb.Append(' ').Append(tourny.EventController.Title);</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>StringBuilder sb = new StringBuilder();

                        if (tourny.TournyType == TournyType.FreeForAll)
                        {
                            sb.Append("FFA");
                        }
                        else if (tourny.TournyType == TournyType.RandomTeam)
                        {
                            sb.Append("Team");
                        }
                        else if (tourny.TournyType == TournyType.RedVsBlue)
                        {
                            sb.Append("Red v Blue");
                        }
                        else
                        {
                            for (int i = 0; i < tourny.ParticipantsPerMatch; ++i)
                            {
                                if (sb.Length > 0)
                                    sb.Append('v');

                                sb.Append(tourny.PlayersPerParticipant);
                            }
                        }

                        if (tourny.EventController != null)
                            sb.Append(' ').Append(tourny.EventController.Title);</pre>

## Duplicated Code. Size: 244

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Items\WoodenKeyBarrel.cs

<pre>public static void DoWrath(Item source, int mindmg, int maxdmg, int range)
        {
            if (source.Deleted)
                return;

            Map map = source.Map;

            if (map != null)
            {
                for (int x = -range; x <= range; ++x)
                {
                    for (int y = -range; y <= range; ++y)
                    {
                        double dist = Math.Sqrt(x * x + y * y);

                        if (dist <= range)
                        {
                            new BarrelExplodeWrathTimer(map, source.X + x, source.Y + y, mindmg, maxdmg, source).Start();
                        }
                    }
                }
            }
        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\WoodenKeyBarrel.cs

<pre>public static void DoWrath(Item source, int mindmg, int maxdmg, int range)
        {
            if (source.Deleted)
                return;

            Map map = source.Map;

            if (map != null)
            {
                for (int x = -range; x <= range; ++x)
                {
                    for (int y = -range; y <= range; ++y)
                    {
                        double dist = Math.Sqrt(x * x + y * y);

                        if (dist <= range)
                        {
                            new BarrelExplodeWrathTimer(map, source.X + x, source.Y + y, mindmg, maxdmg, source).Start();
                        }
                    }
                }
            }
        }</pre>

## Duplicated Code. Size: 244

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>int amount = item.Amount;
			m_Stream.Write((short)amount);
			m_Stream.Write((short)amount);

			Point3D loc = item.Location;
			int x = loc.m_X & 0x7FFF;
			int y = loc.m_Y & 0x3FFF;
			m_Stream.Write((short)x);
			m_Stream.Write((short)y);
			m_Stream.Write((sbyte)loc.m_Z);

			m_Stream.Write((byte)item.Light);
			m_Stream.Write((short)item.Hue);
			m_Stream.Write((byte)item.GetPacketFlags());</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>int amount = item.Amount;
            m_Stream.Write((short)amount);
            m_Stream.Write((short)amount);

            Point3D loc = item.Location;
            int x = loc.m_X & 0x7FFF;
            int y = loc.m_Y & 0x3FFF;
            m_Stream.Write((short)x);
            m_Stream.Write((short)y);
            m_Stream.Write((sbyte)loc.m_Z);

            m_Stream.Write((byte)item.Light);
            m_Stream.Write((short)item.Hue);
            m_Stream.Write((byte)item.GetPacketFlags());</pre>

## Duplicated Code. Size: 244

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Darkwood\DarkwoodChest.cs

<pre>public override int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            if (resHue > 0)
                this.Hue = resHue;

            Type resourceType = typeRes;

            if (resourceType == null)
                resourceType = craftItem.Resources.GetAt(0).ItemType;

            this.Resource = CraftResources.GetFromType(resourceType);

            switch ( this.Resource )
            {
                case CraftResource.Bloodwood:
                    this.Attributes.RegenHits = 2;
                    break;
                case CraftResource.Heartwood:
                    this.Attributes.Luck = 40;
                    break;
                case CraftResource.YewWood:
                    this.Attributes.RegenHits = 1;
                    break;
            }

            return 0;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Darkwood\DarkwoodCrown.cs

<pre>public override int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            if (resHue > 0)
                this.Hue = resHue;

            Type resourceType = typeRes;

            if (resourceType == null)
                resourceType = craftItem.Resources.GetAt(0).ItemType;

            this.Resource = CraftResources.GetFromType(resourceType);

            switch ( this.Resource )
            {
                case CraftResource.Bloodwood:
                    this.Attributes.RegenHits = 2;
                    break;
                case CraftResource.Heartwood:
                    this.Attributes.Luck = 40;
                    break;
                case CraftResource.YewWood:
                    this.Attributes.RegenHits = 1;
                    break;
            }

            return 0;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Darkwood\DarkwoodGauntlets.cs

<pre>public override int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            if (resHue > 0)
                this.Hue = resHue;

            Type resourceType = typeRes;

            if (resourceType == null)
                resourceType = craftItem.Resources.GetAt(0).ItemType;

            this.Resource = CraftResources.GetFromType(resourceType);

            switch ( this.Resource )
            {
                case CraftResource.Bloodwood:
                    this.Attributes.RegenHits = 2;
                    break;
                case CraftResource.Heartwood:
                    this.Attributes.Luck = 40;
                    break;
                case CraftResource.YewWood:
                    this.Attributes.RegenHits = 1;
                    break;
            }

            return 0;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Darkwood\DarkwoodGorget.cs

<pre>public override int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            if (resHue > 0)
                this.Hue = resHue;

            Type resourceType = typeRes;

            if (resourceType == null)
                resourceType = craftItem.Resources.GetAt(0).ItemType;

            this.Resource = CraftResources.GetFromType(resourceType);

            switch ( this.Resource )
            {
                case CraftResource.Bloodwood:
                    this.Attributes.RegenHits = 2;
                    break;
                case CraftResource.Heartwood:
                    this.Attributes.Luck = 40;
                    break;
                case CraftResource.YewWood:
                    this.Attributes.RegenHits = 1;
                    break;
            }

            return 0;
        }</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Darkwood\DarkwoodLeggings.cs

<pre>public override int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            if (resHue > 0)
                this.Hue = resHue;

            Type resourceType = typeRes;

            if (resourceType == null)
                resourceType = craftItem.Resources.GetAt(0).ItemType;

            this.Resource = CraftResources.GetFromType(resourceType);

            switch ( this.Resource )
            {
                case CraftResource.Bloodwood:
                    this.Attributes.RegenHits = 2;
                    break;
                case CraftResource.Heartwood:
                    this.Attributes.Luck = 40;
                    break;
                case CraftResource.YewWood:
                    this.Attributes.RegenHits = 1;
                    break;
            }

            return 0;
        }</pre>

Fragment 6 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Darkwood\DarkwoodPauldrons.cs

<pre>public override int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            if (resHue > 0)
                this.Hue = resHue;

            Type resourceType = typeRes;

            if (resourceType == null)
                resourceType = craftItem.Resources.GetAt(0).ItemType;

            this.Resource = CraftResources.GetFromType(resourceType);

            switch ( this.Resource )
            {
                case CraftResource.Bloodwood:
                    this.Attributes.RegenHits = 2;
                    break;
                case CraftResource.Heartwood:
                    this.Attributes.Luck = 40;
                    break;
                case CraftResource.YewWood:
                    this.Attributes.RegenHits = 1;
                    break;
            }

            return 0;
        }</pre>

## Duplicated Code. Size: 243

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\PersonalAttendantDeed.cs

<pre>this.AddPage(0);

                this.AddBackground(0, 0, 273, 324, 0x13BE);
                this.AddImageTiled(10, 10, 253, 20, 0xA40);
                this.AddImageTiled(10, 40, 253, 244, 0xA40);
                this.AddImageTiled(10, 294, 253, 20, 0xA40);
                this.AddAlphaRegion(10, 10, 253, 304);
                this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 296, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 2 in file Scripts\Services\VeteranRewards\RewardOptionGump.cs

<pre>this.AddPage(0);

            this.AddBackground(0, 0, 273, 324, 0x13BE);
            this.AddImageTiled(10, 10, 253, 20, 0xA40);
            this.AddImageTiled(10, 40, 253, 244, 0xA40);
            this.AddImageTiled(10, 294, 253, 20, 0xA40);
            this.AddAlphaRegion(10, 10, 253, 304);

            this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(45, 296, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

## Duplicated Code. Size: 243

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\SmallSmithBOD.cs

<pre>List<SmallBulkEntry> validEntries = new List<SmallBulkEntry>();

                for (int i = 0; i < entries.Length; ++i)
                {
                    CraftItem item = system.CraftItems.SearchFor(entries[i].Type);

                    if (item != null)
                    {
                        bool allRequiredSkills = true;
                        double chance = item.GetSuccessChance(m, null, system, false, ref allRequiredSkills);

                        if (allRequiredSkills && chance >= 0.0)
                        {
                            if (reqExceptional)
                                chance = item.GetExceptionalChance(system, chance, m);

                            if (chance > 0.0)
                                validEntries.Add(entries[i]);
                        }
                    }
                }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallTailorBOD.cs

<pre>List<SmallBulkEntry> validEntries = new List<SmallBulkEntry>();

                for (int i = 0; i < entries.Length; ++i)
                {
                    CraftItem item = system.CraftItems.SearchFor(entries[i].Type);

                    if (item != null)
                    {
                        bool allRequiredSkills = true;
                        double chance = item.GetSuccessChance(m, null, system, false, ref allRequiredSkills);

                        if (allRequiredSkills && chance >= 0.0)
                        {
                            if (reqExceptional)
                                chance = item.GetExceptionalChance(system, chance, m);

                            if (chance > 0.0)
                                validEntries.Add(entries[i]);
                        }
                    }
                }</pre>

## Duplicated Code. Size: 243

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>public XmlAttachment RewardAttachment
		{
			get
			{
				// if the reward item is not set, and the reward string is specified, then use the reward string to construct and assign the
				// reward item
				// dont allow player made quests to use the rewardstring creation feature
				if (m_RewardAttachment != null && m_RewardAttachment.Deleted) m_RewardAttachment = null;

				if ((m_RewardAttachment == null || m_RewardAttachment.Deleted) &&
					(m_AttachmentString != null) && !PlayerMade)
				{
					object o = XmlQuest.CreateItem(this, m_AttachmentString, out m_status_str, typeof(XmlAttachment));
					if (o is Item)
					{
						((Item)o).Delete();
					}
					else
						if (o is XmlAttachment)
						{
							m_RewardAttachment = o as XmlAttachment;
							m_RewardAttachment.OwnedBy = this;
						}
				}

				return m_RewardAttachment;
			}
			set
			{
				// get rid of any existing attachment
				if (m_RewardAttachment != null && !m_RewardAttachment.Deleted)
				{
					m_RewardAttachment.Delete();
				}

				m_RewardAttachment = value;
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>public XmlAttachment RewardAttachment
        {
            get
            {
                // if the reward item is not set, and the reward string is specified, then use the reward string to construct and assign the
                // reward item
                // dont allow player made quests to use the rewardstring creation feature
                if (m_RewardAttachment != null && m_RewardAttachment.Deleted) m_RewardAttachment = null;

                if ((m_RewardAttachment == null || m_RewardAttachment.Deleted) &&
                    (m_AttachmentString != null) && !PlayerMade)
                {
                    object o = XmlQuest.CreateItem(this, m_AttachmentString, out m_status_str, typeof(XmlAttachment));
                    if (o is Item)
                    {
                        // should never get here
                        ((Item)o).Delete();
                    }
                    else
                        if (o is XmlAttachment)
                        {
                            m_RewardAttachment = o as XmlAttachment;
                            m_RewardAttachment.OwnedBy = this;
                        }
                }

                return m_RewardAttachment;
            }
            set
            {
                // get rid of any existing attachment
                if (m_RewardAttachment != null && !m_RewardAttachment.Deleted)
                {
                    m_RewardAttachment.Delete();
                }

                m_RewardAttachment = value;
            }
        }</pre>

## Duplicated Code. Size: 241

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\CommodityBrokerGump.cs

<pre>AddHtmlLocalized(205, 10, 200, 18, 1150636, RedColor16, false, false); // Commodity Broker

            if (m_Broker.Plot.ShopName != null && m_Broker.Plot.ShopName.Length > 0)
                AddHtml(173, 40, 173, 18, Color(FormatStallName(m_Broker.Plot.ShopName), BlueColor), false, false); // "~1_NAME~"
            else
                AddHtmlLocalized(180, 40, 200, 18, 1150314, BlueColor16, false, false); // This Shop Has No Name

            AddHtml(173, 65, 173, 18, Color(FormatBrokerName(String.Format("Proprietor: {0}", broker.Name)), BlueColor), false, false);</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\CommodityBrokerGump.cs

<pre>AddHtmlLocalized(205, 10, 200, 18, 1150636, RedColor16, false, false); // Commodity Broker

            if (m_Broker.Plot.ShopName != null && m_Broker.Plot.ShopName.Length > 0)
                AddHtml(173, 40, 173, 18, Color(FormatStallName(m_Broker.Plot.ShopName), BlueColor), false, false); // "~1_NAME~"
            else
                AddHtmlLocalized(180, 40, 200, 18, 1150314, BlueColor16, false, false); // This Shop Has No Name

            AddHtml(173, 65, 173, 18, Color(FormatBrokerName(String.Format("Proprietor: {0}", broker.Name)), BlueColor), false, false);</pre>

## Duplicated Code. Size: 241

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>if (GetSaveFlag(flags, SaveFlag.Map))
                        {
                            m_Map = reader.ReadMap();
                        }
                        else
                        {
                            m_Map = Map.Internal;
                        }

                        if (GetSaveFlag(flags, SaveFlag.Visible))
                        {
                            SetFlag(ImplFlag.Visible, reader.ReadBool());
                        }
                        else
                        {
                            SetFlag(ImplFlag.Visible, true);
                        }

                        if (GetSaveFlag(flags, SaveFlag.Movable))
                        {
                            SetFlag(ImplFlag.Movable, reader.ReadBool());
                        }
                        else
                        {
                            SetFlag(ImplFlag.Movable, true);
                        }

                        if (GetSaveFlag(flags, SaveFlag.Stackable))
                        {
                            SetFlag(ImplFlag.Stackable, reader.ReadBool());
                        }</pre>

Fragment 2 in file Server\Item.cs

<pre>if (GetSaveFlag(flags, SaveFlag.Map))
                        {
                            m_Map = reader.ReadMap();
                        }
                        else
                        {
                            m_Map = Map.Internal;
                        }

                        if (GetSaveFlag(flags, SaveFlag.Visible))
                        {
                            SetFlag(ImplFlag.Visible, reader.ReadBool());
                        }
                        else
                        {
                            SetFlag(ImplFlag.Visible, true);
                        }

                        if (GetSaveFlag(flags, SaveFlag.Movable))
                        {
                            SetFlag(ImplFlag.Movable, reader.ReadBool());
                        }
                        else
                        {
                            SetFlag(ImplFlag.Movable, true);
                        }

                        if (GetSaveFlag(flags, SaveFlag.Stackable))
                        {
                            SetFlag(ImplFlag.Stackable, reader.ReadBool());
                        }</pre>

## Duplicated Code. Size: 241

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>AddHtmlLocalized(215, 10, 200, 18, 1150311, RedColor16, false, false); // Animal Broker

			if(m_Broker.Plot.ShopName != null && m_Broker.Plot.ShopName.Length > 0)
				AddHtml(173, 40, 173, 18, Color(FormatStallName(m_Broker.Plot.ShopName), BlueColor), false, false);
			else
				AddHtmlLocalized(180, 40, 200, 18, 1150314, BlueColor16, false, false); // This Shop Has No Name

			AddHtml(173, 65, 173, 18, Color(FormatBrokerName(String.Format("Proprietor: {0}", broker.Name)), BlueColor), false, false);</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>AddHtmlLocalized(215, 10, 200, 18, 1150311, RedColor16, false, false); // Animal Broker

            if (m_Broker.Plot.ShopName != null && m_Broker.Plot.ShopName.Length > 0)
                AddHtml(173, 40, 173, 18, Color(FormatStallName(m_Broker.Plot.ShopName), BlueColor), false, false);
            else
                AddHtmlLocalized(180, 40, 200, 18, 1150314, BlueColor16, false, false); // This Shop Has No Name

            AddHtml(173, 65, 173, 18, Color(FormatBrokerName(String.Format("Proprietor: {0}", broker.Name)), BlueColor), false, false);</pre>

Fragment 3 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>AddHtmlLocalized(215, 10, 200, 18, 1150311, RedColor16, false, false); // Animal Broker

            if (m_Broker.Plot.ShopName != null && m_Broker.Plot.ShopName.Length > 0)
                AddHtml(173, 40, 173, 18, Color(FormatStallName(m_Broker.Plot.ShopName), BlueColor), false, false);
            else
                AddHtmlLocalized(180, 40, 200, 18, 1150314, BlueColor16, false, false); // This Shop Has No Name

            AddHtml(173, 65, 173, 18, Color(FormatBrokerName(String.Format("Proprietor: {0}", broker.Name)), BlueColor), false, false);</pre>

## Duplicated Code. Size: 240

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Handlers.cs

<pre>if (pets.Count > 0)
                {
                    CommandLogging.WriteLine(from, "{0} {1} getting all followers of {2}", from.AccessLevel, CommandLogging.Format(from), CommandLogging.Format(master));

                    from.SendMessage("That player has {0} pet{1}.", pets.Count, pets.Count != 1 ? "s" : "");

                    for (int i = 0; i < pets.Count; ++i)
                    {
                        Mobile pet = (Mobile)pets[i];

                        if (pet is IMount)
                            ((IMount)pet).Rider = null; // make sure it's dismounted

                        pet.MoveToWorld(from.Location, from.Map);
                    }
                }
                else
                {
                    from.SendMessage("There were no pets found for that player.");
                }</pre>

Fragment 2 in file Scripts\Commands\Handlers.cs

<pre>if (pets.Count > 0)
                {
                    CommandLogging.WriteLine(from, "{0} {1} getting all followers of {2}", from.AccessLevel, CommandLogging.Format(from), CommandLogging.Format(master));

                    from.SendMessage("That player has {0} pet{1}.", pets.Count, pets.Count != 1 ? "s" : "");

                    for (int i = 0; i < pets.Count; ++i)
                    {
                        Mobile pet = (Mobile)pets[i];

                        if (pet is IMount)
                            ((IMount)pet).Rider = null; // make sure it's dismounted

                        pet.MoveToWorld(from.Location, from.Map);
                    }
                }
                else
                {
                    from.SendMessage("There were no pets found for that player.");
                }</pre>

## Duplicated Code. Size: 240

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Ilhenir.cs

<pre>public virtual void PackResources(int amount)
        {
            for (int i = 0; i < amount; i++)
                switch( Utility.Random(6) )
                {
                    case 0:
                        this.PackItem(new Blight());
                        break;
                    case 1:
                        this.PackItem(new Scourge());
                        break;
                    case 2:
                        this.PackItem(new Taint());
                        break;
                    case 3:
                        this.PackItem(new Putrefication());
                        break;
                    case 4:
                        this.PackItem(new Corruption());
                        break;
                    case 5:
                        this.PackItem(new Muculent());
                        break;
                }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Named\Meraktus.cs

<pre>public virtual void PackResources(int amount)
        {
            for (int i = 0; i < amount; i++)
                switch (Utility.Random(6))
                {
                    case 0:
                        this.PackItem(new Blight());
                        break;
                    case 1:
                        this.PackItem(new Scourge());
                        break;
                    case 2:
                        this.PackItem(new Taint());
                        break;
                    case 3:
                        this.PackItem(new Putrefication());
                        break;
                    case 4:
                        this.PackItem(new Corruption());
                        break;
                    case 5:
                        this.PackItem(new Muculent());
                        break;
                }
        }</pre>

Fragment 3 in file Scripts\Services\Peerless\BasePeerless.cs

<pre>public virtual void PackResources(int amount)
        {
            for (int i = 0; i < amount; i ++)
                switch ( Utility.Random(6) )
                {
                    case 0:
                        this.PackItem(new Blight());
                        break;
                    case 1:
                        this.PackItem(new Scourge());
                        break;
                    case 2:
                        this.PackItem(new Taint());
                        break;
                    case 3:
                        this.PackItem(new Putrefication());
                        break;
                    case 4:
                        this.PackItem(new Corruption());
                        break;
                    case 5:
                        this.PackItem(new Muculent());
                        break;
                }
        }</pre>

## Duplicated Code. Size: 240

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BlackSolenQueen.cs

<pre>public void BeginAcidBreath()
        {
            PlayerMobile m = Combatant as PlayerMobile;

            if (m == null || m.Deleted || !m.Alive || !Alive || m_NextAcidBreath > DateTime.Now || !CanBeHarmful(m))
                return;

            PlaySound(0x118);
            MovingEffect(m, 0x36D4, 1, 0, false, false, 0x3F, 0);

            TimeSpan delay = TimeSpan.FromSeconds(GetDistanceToSqrt(m) / 5.0);
            Timer.DelayCall<Mobile>(delay, new TimerStateCallback<Mobile>(EndAcidBreath), m);

            m_NextAcidBreath = DateTime.Now + TimeSpan.FromSeconds(5);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BlackSolenWarrior.cs

<pre>public void BeginAcidBreath()
        {
            PlayerMobile m = Combatant as PlayerMobile;
            // Mobile m = Combatant;

            if (m == null || m.Deleted || !m.Alive || !Alive || m_NextAcidBreath > DateTime.Now || !CanBeHarmful(m))
                return;

            PlaySound(0x118);
            MovingEffect(m, 0x36D4, 1, 0, false, false, 0x3F, 0);

            TimeSpan delay = TimeSpan.FromSeconds(GetDistanceToSqrt(m) / 5.0);
            Timer.DelayCall<Mobile>(delay, new TimerStateCallback<Mobile>(EndAcidBreath), m);

            m_NextAcidBreath = DateTime.Now + TimeSpan.FromSeconds(5);
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\RedSolenQueen.cs

<pre>public void BeginAcidBreath()
        {
            PlayerMobile m = Combatant as PlayerMobile;
            // Mobile m = Combatant;

            if (m == null || m.Deleted || !m.Alive || !Alive || m_NextAcidBreath > DateTime.Now || !CanBeHarmful(m))
                return;

            PlaySound(0x118);
            MovingEffect(m, 0x36D4, 1, 0, false, false, 0x3F, 0);

            TimeSpan delay = TimeSpan.FromSeconds(GetDistanceToSqrt(m) / 5.0);
            Timer.DelayCall<Mobile>(delay, new TimerStateCallback<Mobile>(EndAcidBreath), m);

            m_NextAcidBreath = DateTime.Now + TimeSpan.FromSeconds(5);
        }</pre>

Fragment 4 in file Scripts\Mobiles\Normal\RedSolenWarrior.cs

<pre>public void BeginAcidBreath()
        {
            PlayerMobile m = Combatant as PlayerMobile;
            // Mobile m = Combatant;

            if (m == null || m.Deleted || !m.Alive || !Alive || m_NextAcidBreath > DateTime.Now || !CanBeHarmful(m))
                return;

            PlaySound(0x118);
            MovingEffect(m, 0x36D4, 1, 0, false, false, 0x3F, 0);

            TimeSpan delay = TimeSpan.FromSeconds(GetDistanceToSqrt(m) / 5.0);
            Timer.DelayCall<Mobile>(delay, new TimerStateCallback<Mobile>(EndAcidBreath), m);

            m_NextAcidBreath = DateTime.Now + TimeSpan.FromSeconds(5);
        }</pre>

## Duplicated Code. Size: 239

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\InstancedPeerless\ConfirmJoinInstanceGump.cs

<pre>{
				Effects.SendLocationParticles( EffectItem.Create( from.Location, from.Map, EffectItem.DefaultDuration ), 0x3728, 10, 10, 2023 );
				Effects.PlaySound( from.Location, from.Map, 0x1FE );

				BaseCreature.TeleportPets( from, m_Instance.EntranceLocation, m_Instance.Map );
				from.MoveToWorld( m_Instance.EntranceLocation, m_Instance.Map );

				Effects.SendLocationParticles( EffectItem.Create( from.Location, from.Map, EffectItem.DefaultDuration ), 0x3728, 10, 10, 2023 );
				Effects.PlaySound( from.Location, from.Map, 0x1FE );

				m_Instance.AddFighter( from );
			}</pre>

Fragment 2 in file Scripts\Services\InstancedPeerless\RejoinInstanceGump.cs

<pre>{
				Effects.SendLocationParticles( EffectItem.Create( from.Location, from.Map, EffectItem.DefaultDuration ), 0x3728, 10, 10, 2023 );
				Effects.PlaySound( from.Location, from.Map, 0x1FE );

				BaseCreature.TeleportPets( from, m_Instance.EntranceLocation, m_Instance.Map );
				from.MoveToWorld( m_Instance.EntranceLocation, m_Instance.Map );

				Effects.SendLocationParticles( EffectItem.Create( from.Location, from.Map, EffectItem.DefaultDuration ), 0x3728, 10, 10, 2023 );
				Effects.PlaySound( from.Location, from.Map, 0x1FE );

				m_Instance.AddFighter( from );
			}</pre>

## Duplicated Code. Size: 239

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCannon.cs

<pre>if (itemid != null && xoffset != null && yoffset != null && Components.Count == itemid.Length)
				{
					for (int i = 0; i < Components.Count; i++)
					{
						((AddonComponent)Components[i]).ItemID = itemid[i];
						Point3D newoffset = new Point3D(xoffset[i], yoffset[i], 0);
						((AddonComponent)Components[i]).Offset = newoffset;
						((AddonComponent)Components[i]).Location = new Point3D(newoffset.X + X, newoffset.Y + Y, z);
					}
				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCatapult.cs

<pre>if (itemid != null && xoffset != null && yoffset != null && Components.Count == itemid.Length)
				{
					for (int i = 0; i < Components.Count; i++)
					{
						((AddonComponent)Components[i]).ItemID = itemid[i];
						Point3D newoffset = new Point3D(xoffset[i], yoffset[i], 0);
						((AddonComponent)Components[i]).Offset = newoffset;
						((AddonComponent)Components[i]).Location = new Point3D(newoffset.X + X, newoffset.Y + Y, z);
					}
				}</pre>

## Duplicated Code. Size: 239

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketHandlers.cs

<pre>int hue = pvSrc.ReadUInt16();
			int hairVal = pvSrc.ReadInt16();
			int hairHue = pvSrc.ReadInt16();
			int hairValf = pvSrc.ReadInt16();
			int hairHuef = pvSrc.ReadInt16();
			pvSrc.ReadByte();
			int cityIndex = pvSrc.ReadByte();
			int charSlot = pvSrc.ReadInt32();
			int clientIP = pvSrc.ReadInt32();
			int shirtHue = pvSrc.ReadInt16();
			int pantsHue = pvSrc.ReadInt16();

			/*
			Pre-7.0.0.0:
			0x00, 0x01 -> Human Male, Human Female
			0x02, 0x03 -> Elf Male, Elf Female

			Post-7.0.0.0:
			0x00, 0x01
			0x02, 0x03 -> Human Male, Human Female
			0x04, 0x05 -> Elf Male, Elf Female
			0x05, 0x06 -> Gargoyle Male, Gargoyle Female
			*/

			bool female = ((genderRace % 2) != 0);

			Race race = null;</pre>

Fragment 2 in file Server\Network\PacketHandlers.cs

<pre>int hue = pvSrc.ReadUInt16();
			int hairVal = pvSrc.ReadInt16();
			int hairHue = pvSrc.ReadInt16();
			int hairValf = pvSrc.ReadInt16();
			int hairHuef = pvSrc.ReadInt16();
			pvSrc.ReadByte();
			int cityIndex = pvSrc.ReadByte();
			int charSlot = pvSrc.ReadInt32();
			int clientIP = pvSrc.ReadInt32();
			int shirtHue = pvSrc.ReadInt16();
			int pantsHue = pvSrc.ReadInt16();

			/*
			0x00, 0x01
			0x02, 0x03 -> Human Male, Human Female
			0x04, 0x05 -> Elf Male, Elf Female
			0x05, 0x06 -> Gargoyle Male, Gargoyle Female
			*/

			bool female = ((genderRace % 2) != 0);

			Race race = null;</pre>

## Duplicated Code. Size: 239

### Duplicated Fragments:

Fragment 1 in file Ultima\Multis.cs

<pre>{
							m_SortedTiles[i].m_OffsetX -= (short)centerx;
							m_SortedTiles[i].m_OffsetY -= (short)centery;
							if (m_SortedTiles[i].m_OffsetX < m_Min.X)
							{
								m_Min.X = m_SortedTiles[i].m_OffsetX;
							}
							if (m_SortedTiles[i].m_OffsetX > m_Max.X)
							{
								m_Max.X = m_SortedTiles[i].m_OffsetX;
							}

							if (m_SortedTiles[i].m_OffsetY < m_Min.Y)
							{
								m_Min.Y = m_SortedTiles[i].m_OffsetY;
							}
							if (m_SortedTiles[i].m_OffsetY > m_Max.Y)
							{
								m_Max.Y = m_SortedTiles[i].m_OffsetY;
							}
						}</pre>

Fragment 2 in file Ultima\Multis.cs

<pre>{
				m_SortedTiles[i].m_OffsetX -= (short)centerx;
				m_SortedTiles[i].m_OffsetY -= (short)centery;
				if (m_SortedTiles[i].m_OffsetX < m_Min.X)
				{
					m_Min.X = m_SortedTiles[i].m_OffsetX;
				}
				if (m_SortedTiles[i].m_OffsetX > m_Max.X)
				{
					m_Max.X = m_SortedTiles[i].m_OffsetX;
				}

				if (m_SortedTiles[i].m_OffsetY < m_Min.Y)
				{
					m_Min.Y = m_SortedTiles[i].m_OffsetY;
				}
				if (m_SortedTiles[i].m_OffsetY > m_Max.Y)
				{
					m_Max.Y = m_SortedTiles[i].m_OffsetY;
				}
			}</pre>

## Duplicated Code. Size: 238

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Docs.cs

<pre>html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+5</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+10</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+15</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+20</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"du\"><center><small>Du</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"sh\"><center><small>Sh</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"co\"><center><small>Co</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"br\"><center><small>Br</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"go\"><center><small>Go</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"ag\"><center><small>Ag</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"ve\"><center><small>Ve</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"va\"><center><small>Va</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+10</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+15</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+30</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+60</small></center></td>");
			html.WriteLine("         </tr>");</pre>

Fragment 2 in file Scripts\Commands\Docs.cs

<pre>html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+5</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+10</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+15</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+20</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"du\"><center><small>Du</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"sh\"><center><small>Sh</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"co\"><center><small>Co</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"br\"><center><small>Br</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"go\"><center><small>Go</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"ag\"><center><small>Ag</small></center&ggt;</td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"ve\"><center><small>Ve</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"va\"><center><small>Va</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+10</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+15</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+30</small></center></td>");
			html.WriteLine("            <td style=\"width: 25px;\" class=\"entry\"><center><small>+60</small></center></td>");
			html.WriteLine("         </tr>");</pre>

## Duplicated Code. Size: 238

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\TaxidermyKit.cs

<pre>bool northWall = BaseAddon.IsWall( from.X, from.Y - 1, from.Z, from.Map );
					bool westWall = BaseAddon.IsWall( from.X - 1, from.Y, from.Z, from.Map );

					if ( northWall && westWall )
					{
						switch ( from.Direction & Direction.Mask )
						{
							case Direction.North:
							case Direction.South: northWall = true; westWall = false; break;

							case Direction.East:
							case Direction.West:  northWall = false; westWall = true; break;

							default: from.SendMessage( "Turn to face the wall on which to hang this trophy." ); return;
						}
					}

					int itemID = 0;</pre>

Fragment 2 in file Scripts\Services\HuntmasterChallenge\HuntTrophy.cs

<pre>bool northWall = BaseAddon.IsWall(from.X, from.Y - 1, from.Z, from.Map);
                    bool westWall = BaseAddon.IsWall(from.X - 1, from.Y, from.Z, from.Map);

                    if (northWall && westWall)
                    {
                        switch (from.Direction & Direction.Mask)
                        {
                            case Direction.North:
                            case Direction.South: northWall = true; westWall = false; break;

                            case Direction.East:
                            case Direction.West: northWall = false; westWall = true; break;

                            default: from.SendMessage("Turn to face the wall on which to hang this trophy."); return;
                        }
                    }

                    int itemID = 0;</pre>

## Duplicated Code. Size: 238

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Bird.cs

<pre>this.VirtualArmor = Utility.RandomMinMax(0, 6);

            this.SetStr(10);
            this.SetDex(25, 35);
            this.SetInt(10);

            this.SetDamage(0);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetSkill(SkillName.Wrestling, 4.2, 6.4);
            this.SetSkill(SkillName.Tactics, 4.0, 6.0);
            this.SetSkill(SkillName.MagicResist, 4.0, 5.0);

            this.Fame = 150;
            this.Karma = 0;

            this.Tamable = true;
            this.ControlSlots = 1;
            this.MinTameSkill = -6.9;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Bird.cs

<pre>this.VirtualArmor = Utility.RandomMinMax(0, 6);

            this.SetStr(10);
            this.SetDex(25, 35);
            this.SetInt(10);

            this.SetDamage(0);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetSkill(SkillName.Wrestling, 4.2, 6.4);
            this.SetSkill(SkillName.Tactics, 4.0, 6.0);
            this.SetSkill(SkillName.MagicResist, 4.0, 5.0);

            this.Fame = 150;
            this.Karma = 0;

            this.Tamable = true;
            this.ControlSlots = 1;
            this.MinTameSkill = -6.9;</pre>

## Duplicated Code. Size: 238

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestLeaders.cs

<pre>if(r.Rank != a.Rank)
						{
							a.WhenRanked = DateTime.UtcNow;
							if(a.Rank > 0)
								a.DeltaRank = a.Rank - r.Rank;
							a.Rank = r.Rank;

						}

						// check for guild filter
						if(m_attachment != null && m_attachment.guildFilter != null && m_attachment.guildFilter.Length > 0)
						{
							// parse the comma separated list
							string [] args = m_attachment.guildFilter.Split(',');
							if(args != null)
							{
								bool found = false;
								foreach(string arg in args)
								{
									if(arg != null && guildname == arg.Trim())
									{
										found = true;
										break;
									}
								}
								if(!found) continue;
							}
						}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>if(r.Rank != a.Rank)
						{
							a.WhenRanked = DateTime.UtcNow;
							if(a.Rank > 0)
								a.DeltaRank = a.Rank - r.Rank;
							a.Rank = r.Rank;

						}

						// check for guild filter
						if(m_attachment != null && m_attachment.guildFilter != null && m_attachment.guildFilter.Length > 0)
						{
							// parse the comma separated list
							string [] args = m_attachment.guildFilter.Split(',');
							if(args != null)
							{
								bool found = false;
								foreach(string arg in args)
								{
									if(arg != null && guildname == arg.Trim())
									{
										found = true;
										break;
									}
								}
								if(!found) continue;
							}
						}</pre>

## Duplicated Code. Size: 238

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>string filename = LocateFile(e.Arguments[0].ToString());

					// Spawner load criteria (if any)
					string SpawnerPrefix = string.Empty;
					bool badargs = false;
					int maxrange = 48;

					// Check if there is an argument provided (load criteria)
					try
					{
						// Check if there is an argument provided (load criteria)
						for (int nxtarg = 1; nxtarg < e.Arguments.Length; nxtarg++)
						{
							// is it a maxrange option?
							if (e.Arguments[nxtarg].ToLower() == "-maxrange")
							{
								maxrange = int.Parse(e.Arguments[++nxtarg]);
							}
							else
							{
								SpawnerPrefix = e.Arguments[nxtarg];
							}
						}
					}
					catch { e.Mobile.SendMessage("Usage:  {0} <SpawnFile or directory> [SpawnerPrefixFilter][-maxrange range]", e.Command); badargs = true; }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>string filename = LocateFile(e.Arguments[0].ToString());

					// Spawner load criteria (if any)
					string SpawnerPrefix = string.Empty;
					bool badargs = false;
					int maxrange = 48;

					try
					{
						// Check if there is an argument provided (load criteria)
						for (int nxtarg = 1; nxtarg < e.Arguments.Length; nxtarg++)
						{
							// is it a maxrange option?
							if (e.Arguments[nxtarg].ToLower() == "-maxrange")
							{
								maxrange = int.Parse(e.Arguments[++nxtarg]);
							}
							else
							{
								SpawnerPrefix = e.Arguments[nxtarg];
							}
						}
					}
					catch { e.Mobile.SendMessage("Usage:  {0} <SpawnFile or directory> [SpawnerPrefixFilter][-maxrange range]", e.Command); badargs = true; }</pre>

## Duplicated Code. Size: 237

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetListOptionGump.cs

<pre>int totalHeight = OffsetSize + ((count + 2) * (EntryHeight + OffsetSize));
				int backHeight = BorderSize + totalHeight + BorderSize;

				AddBackground(0, 0, BackWidth, backHeight, BackGumpID);
				AddImageTiled(
					BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), totalHeight, OffsetGumpID);

				int x = BorderSize + OffsetSize;
				int y = BorderSize + OffsetSize;

				int emptyWidth = TotalWidth - PrevWidth - NextWidth - (OffsetSize * 4) - (OldStyle ? SetWidth + OffsetSize : 0);

				AddImageTiled(x, y, PrevWidth, EntryHeight, HeaderGumpID);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetListOptionGump.cs

<pre>int totalHeight = OffsetSize + ((count + 2) * (EntryHeight + OffsetSize));
				int backHeight = BorderSize + totalHeight + BorderSize;

				AddBackground( 0, 0, BackWidth, backHeight, BackGumpID );
				AddImageTiled( BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), totalHeight, OffsetGumpID );

				int x = BorderSize + OffsetSize;
				int y = BorderSize + OffsetSize;

				int emptyWidth = TotalWidth - PrevWidth - NextWidth - (OffsetSize * 4) - (OldStyle ? SetWidth + OffsetSize : 0);

				AddImageTiled( x, y, PrevWidth, EntryHeight, HeaderGumpID );</pre>

## Duplicated Code. Size: 237

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>public override void InitOutfit()
        {
            if (this.Female)
                this.AddItem(new FancyDress());
            else
                this.AddItem(new FancyShirt());

            int lowHue = this.GetRandomHue();

            this.AddItem(new LongPants(lowHue));

            if (this.Female)
                this.AddItem(new Shoes(lowHue));
            else
                this.AddItem(new Boots(lowHue));

            if (Utility.RandomBool())
                this.HairItemID = 0x203B;
            else
                this.HairItemID = 0x203C;

            this.HairHue = this.Race.RandomHairHue();

            this.PackGold(200, 250);
        }</pre>

Fragment 2 in file Scripts\Quests\Escortables.cs

<pre>public override void InitOutfit()
        {
            if (this.Female)				
                this.AddItem(new FancyDress());
            else
                this.AddItem(new FancyShirt());

            int lowHue = this.GetRandomHue();

            this.AddItem(new LongPants(lowHue));

            if (this.Female)
                this.AddItem(new Shoes(lowHue));
            else
                this.AddItem(new Boots(lowHue));

            if (Utility.RandomBool())
                this.HairItemID = 0x203B;
            else
                this.HairItemID = 0x203C;

            this.HairHue = this.Race.RandomHairHue();

            this.PackGold(200, 250);
        }</pre>

## Duplicated Code. Size: 237

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>Item item = null;

										// look up the method
										Type ltype = typeof(Loot);
										if (ltype != null)
										{
											MethodInfo method = null;

											try
											{
												// get the zero-arg method with the specified name
												method = ltype.GetMethod(itemkeywordargs[1], new Type[0]);

											}
											catch { }

											if (method != null && method.IsStatic)
											{
												ParameterInfo[] pinfo = method.GetParameters();
												// check to make sure the method for this object has the right args
												if (pinfo.Length == 0)
												{
													// method must be public static with no arguments returning an Item class object
													try
													{
														item = method.Invoke(null, null) as Item;
													}
													catch { }
												}
												else
												{
													status_str = "LOOT method must be zero arg : " + itemtypestr;
													return false;
												}
											}
											else
											{
												status_str = "LOOT no valid method found : " + itemtypestr;
												return false;
											}
										}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>Item item = null;

									// look up the method
									Type ltype = typeof(Loot);
									if (ltype != null)
									{
										MethodInfo method = null;

										try
										{
											// get the zero arg method with the specified name
											method = ltype.GetMethod(itemkeywordargs[1], new Type[0]);
										}
										catch { }

										if (method != null && method.IsStatic)
										{
											ParameterInfo[] pinfo = method.GetParameters();
											// check to make sure the method for this object has the right args
											if (pinfo.Length == 0)
											{
												// method must be public static with no arguments returning an Item class object
												try
												{
													item = method.Invoke(null, null) as Item;
												}
												catch { }
											}
											else
											{
												status_str = "LOOT method must be zero arg : " + itemtypestr;
												return false;
											}
										}
										else
										{
											status_str = "LOOT no valid method found : " + itemtypestr;
											return false;
										}
									}</pre>

## Duplicated Code. Size: 237

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>if (overridemap >= 0) map = overridemap;
								Map spawnmap = Map.Internal;
								switch (map)
								{
									case 0:
										spawnmap = Map.Felucca;
										// note it also does trammel
										break;
									case 1:
										spawnmap = Map.Felucca;
										break;
									case 2:
										spawnmap = Map.Trammel;
										break;
									case 3:
										spawnmap = Map.Ilshenar;
										break;
                                    case 4:
										spawnmap = Map.Malas;
										break;
									case 5:
										spawnmap = Map.Tokuno;
                                        break;
								}

								if (!IsValidMapLocation(x, y, spawnmap))
								{
									// invalid so dont spawn it
									badspawnercount++;
									from.SendMessage("Invalid map/location at line {0}", linenumber);
									from.SendMessage("Bad spawn at line {1}: {0}", line, linenumber);
									return;
								}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>if (overridemap >= 0) map = overridemap;
								Map spawnmap = Map.Internal;
								switch (map)
								{
									case 0:
										spawnmap = Map.Felucca;
										// note it also does trammel
										break;
									case 1:
										spawnmap = Map.Felucca;
										break;
									case 2:
										spawnmap = Map.Trammel;
										break;
									case 3:
										spawnmap = Map.Ilshenar;
										break;
                                    case 4:
                                        spawnmap = Map.Malas;
										break;
                                    case 5:
                                        spawnmap = Map.Tokuno;
										break;
								}

								if (!IsValidMapLocation(x, y, spawnmap))
								{
									// invalid so dont spawn it
									badspawnercount++;
									from.SendMessage("Invalid map/location at line {0}", linenumber);
									from.SendMessage("Bad spawn at line {1}: {0}", line, linenumber);
									return;
								}</pre>

## Duplicated Code. Size: 236

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\Abilities.cs

<pre>public static Mobile FindRandomTarget(Mobile from, bool allowcombatant)
        {
            List<Mobile> list = new List<Mobile>();

            foreach (Mobile m in from.GetMobilesInRange(12))
            {
                if (m != null && m != from)
                    if (CanTarget(from, m) && from.InLOS(m))
                    {
                        if (allowcombatant && m == from.Combatant)
                            continue;
                        else
                            list.Add(m);
                    }
            }

            if (list.Count == 0)
                return null;
            if (list.Count == 1)
                return list[0];

            return list[Utility.Random(list.Count)];
        }</pre>

Fragment 2 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>public static Mobile FindRandomTarget(Mobile from, bool allowcombatant)
        {
            List<Mobile> list = new List<Mobile>();

            foreach (Mobile m in from.GetMobilesInRange(12))
            {
                if (m != null && m != from)
                    if (CanTarget(from, m) && from.InLOS(m))
                    {
                        if (allowcombatant && m == from.Combatant)
                            continue;
                        else
                            list.Add(m);
                    }
            }

            if (list.Count == 0)
                return null;
            if (list.Count == 1)
                return list[0];

            return list[Utility.Random(list.Count)];
        }</pre>

## Duplicated Code. Size: 235

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AdminGump.cs

<pre>if (listPage > 0)
                            this.AddButton(375, 122, 0x15E3, 0x15E7, this.GetButtonID(1, 0), GumpButtonType.Reply, 0);
                        else
                            this.AddImage(375, 122, 0x25EA);

                        if ((listPage + 1) * 12 < this.m_List.Count)
                            this.AddButton(392, 122, 0x15E1, 0x15E5, this.GetButtonID(1, 1), GumpButtonType.Reply, 0);
                        else
                            this.AddImage(392, 122, 0x25E6);

                        if (this.m_List.Count == 0)
                            this.AddLabel(12, 140, LabelHue, "There are no accounts to display.");</pre>

Fragment 2 in file Scripts\Gumps\AdminGump.cs

<pre>if (listPage > 0)
                            this.AddButton(375, 122, 0x15E3, 0x15E7, this.GetButtonID(1, 0), GumpButtonType.Reply, 0);
                        else
                            this.AddImage(375, 122, 0x25EA);

                        if ((listPage + 1) * 12 < this.m_List.Count)
                            this.AddButton(392, 122, 0x15E1, 0x15E5, this.GetButtonID(1, 1), GumpButtonType.Reply, 0);
                        else
                            this.AddImage(392, 122, 0x25E6);

                        if (this.m_List.Count == 0)
                            this.AddLabel(12, 140, LabelHue, "There are no accounts to display.");</pre>

## Duplicated Code. Size: 235

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if (_Owner != null && _Owner != from)
                {
                    from.SendLocalizedMessage(501023); // You must be the owner to use this item.
                    return false;
                }

                if (this is IAccountRestricted && ((IAccountRestricted)this).Account != null)
                {
                    Accounting.Account acct = from.Account as Accounting.Account;

                    if (acct == null || acct.Username != ((IAccountRestricted)this).Account)
                    {
                        from.SendLocalizedMessage(1071296); // This item is Account Bound and your character is not bound to it. You cannot use this item.
                        return false;
                    }
                }

                if (IsVvVItem && !Engines.VvV.ViceVsVirtueSystem.IsVvV(from))
                {
                    from.SendLocalizedMessage(1155496); // This item can only be used by VvV participants!
                    return false;
                }

                bool morph = from.FindItemOnLayer(Layer.Earrings) is MorphEarrings;</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if (_Owner != null && _Owner != from)
                {
                    from.SendLocalizedMessage(501023); // You must be the owner to use this item.
                    return false;
                }

                if (this is IAccountRestricted && ((IAccountRestricted)this).Account != null)
                {
                    Accounting.Account acct = from.Account as Accounting.Account;

                    if (acct == null || acct.Username != ((IAccountRestricted)this).Account)
                    {
                        from.SendLocalizedMessage(1071296); // This item is Account Bound and your character is not bound to it. You cannot use this item.
                        return false;
                    }
                }

                if (IsVvVItem && !Engines.VvV.ViceVsVirtueSystem.IsVvV(from))
                {
                    from.SendLocalizedMessage(1155496); // This item can only be used by VvV participants!
                    return false;
                }

                bool morph = from.FindItemOnLayer(Layer.Earrings) is MorphEarrings;</pre>

## Duplicated Code. Size: 235

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>public override bool ExemptOverheadComponent(Point3D newPnt, int itemID, int x, int y, int height)
        {
            //if (height > this.Z + 16) //TODO: Get height of mast
            //    return false;

            switch (itemID)
            {
                case 0x18: //North/South ID's
                case 0x1A:
                case 0x1C:
                case 0x1E:
                case 0x20:
                case 0x22:
                    if (x > newPnt.X + PortAndStarboardOffset || x < newPnt.X - PortAndStarboardOffset)
                        return true;
                    break;
                case 0x19: //East/West ID's
                case 0x1B:
                case 0x1D:
                case 0x1F:
                case 0x21:
                case 0x23:
                    if (y > newPnt.Y + PortAndStarboardOffset || y < newPnt.Y - PortAndStarboardOffset)
                        return true;
                    break;
            }

            return base.ExemptOverheadComponent(newPnt, itemID, x, y, height);
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>public override bool ExemptOverheadComponent(Point3D newPnt, int itemID, int x , int y, int height)
		{
			//if(height > this.Z + 16) //TODO: Get height of mast
			//	return false;

			switch(itemID)
			{
				case 0x18: //North/South ID's
				case 0x1A:
				case 0x1C:
				case 0x1E:
				case 0x20:
				case 0x22:
					if(x > newPnt.X + PortAndStarboardOffset || x < newPnt.X - PortAndStarboardOffset)
						return true;
					break;
				case 0x19: //East/West ID's
				case 0x1B:
				case 0x1D:
				case 0x1F:
				case 0x21:
				case 0x23:
					if(y > newPnt.Y + PortAndStarboardOffset || y < newPnt.Y - PortAndStarboardOffset)
						return true;
					break;
			}

            return base.ExemptOverheadComponent(newPnt, itemID, x, y, height);
		}</pre>

## Duplicated Code. Size: 235

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\GeoffreyCampAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\PotteryWheelAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType)lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 4 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\BarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 5 in file Scripts\Services\FireCasino\TentBrownAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 6 in file Scripts\Services\FireCasino\TentWhiteAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 7 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\Alchemist2BazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 8 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\ArtistBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 9 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\CarpetedStairBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 10 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\DistilleryBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 11 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\EvilBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 12 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\FishermanBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 13 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\JewelerBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 14 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\LeatherArmourBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 15 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\PillowBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 16 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\ScribeBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 17 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\Tailor2BazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

Fragment 18 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\TailorBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource, string name, int amount)
        {
            AddonComponent ac;
            ac = new AddonComponent(item);
            if (name != null && name.Length > 0)
                ac.Name = name;
            if (hue != 0)
                ac.Hue = hue;
            if (amount > 1)
            {
                ac.Stackable = true;
                ac.Amount = amount;
            }
            if (lightsource != -1)
                ac.Light = (LightType) lightsource;
            addon.AddComponent(ac, xoffset, yoffset, zoffset);
        }</pre>

## Duplicated Code. Size: 234

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GalleonPilot.cs

<pre>if (Female)
                {
                    switch (Utility.Random(6))
                    {
                        case 0: EquipItem(new ShortPants(GetRandomHue())); break;
                        case 1:
                        case 2: EquipItem(new Kilt(GetRandomHue())); break;
                        case 3:
                        case 4:
                        case 5: EquipItem(new Skirt(GetRandomHue())); break;
                    }
                }
                else
                {
                    switch (Utility.Random(2))
                    {
                        case 0: EquipItem(new LongPants(GetRandomHue())); break;
                        case 1: EquipItem(new ShortPants(GetRandomHue())); break;
                    }
                }</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Mobiles\BaseBizaarBroker.cs

<pre>if (Female)
			{
				switch (Utility.Random(6))
				{
					case 0: EquipItem(new ShortPants(GetRandomHue())); break;
					case 1:
					case 2: EquipItem(new Kilt(GetRandomHue())); break;
					case 3:
					case 4:
					case 5: EquipItem(new Skirt(GetRandomHue())); break;
				}
			}
			else
			{
				switch (Utility.Random(2))
				{
					case 0: EquipItem(new LongPants(GetRandomHue())); break;
					case 1: EquipItem(new ShortPants(GetRandomHue())); break;
				}
			}</pre>

## Duplicated Code. Size: 234

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\MyrmidexLarvae.cs

<pre>SetHits(446, 588);
			SetMana(0);

			SetResistance( ResistanceType.Physical, 20 );
			SetResistance( ResistanceType.Fire, 10, 20 );
			SetResistance( ResistanceType.Cold, 10, 20 );
			SetResistance( ResistanceType.Poison, 30, 40 );
			SetResistance( ResistanceType.Energy, 10, 20 );

			SetDamageType( ResistanceType.Physical, 50 );
			SetDamageType( ResistanceType.Poison, 50 );

			SetSkill( SkillName.MagicResist, 30.1, 43.5 );
			SetSkill( SkillName.Tactics, 30.1, 49.0 );
			SetSkill( SkillName.Wrestling, 40, 50 );</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\SilverbackGorilla.cs

<pre>SetHits(446, 588);
            SetMana(0);

            SetResistance(ResistanceType.Physical, 20);
            SetResistance(ResistanceType.Fire, 10, 20);
            SetResistance(ResistanceType.Cold, 10, 20);
            SetResistance(ResistanceType.Poison, 30, 40);
            SetResistance(ResistanceType.Energy, 10, 20);

            SetDamageType(ResistanceType.Physical, 50);
            SetDamageType(ResistanceType.Poison, 50);

            SetSkill(SkillName.MagicResist, 30.1, 43.5);
            SetSkill(SkillName.Tactics, 30.1, 49.0);
            SetSkill(SkillName.Wrestling, 40, 50);</pre>

## Duplicated Code. Size: 234

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Toolbar\Core\ToolbarInfo.cs

<pre>entries.Add(CommandSystem.Prefix + "StaffRunebook");
						entries.Add(CommandSystem.Prefix + "SpeedBoost");
						entries.Add(CommandSystem.Prefix + "M Tele");
						entries.Add(CommandSystem.Prefix + "Where");
						entries.Add(CommandSystem.Prefix + "Who");

						for (int j = 0; j < 3; j++)
						{
							entries.Add("-*UNUSED*-");
						}

						entries.Add(CommandSystem.Prefix + "Add");
						entries.Add(CommandSystem.Prefix + "Remove");
						entries.Add(CommandSystem.Prefix + "Props");
						entries.Add(CommandSystem.Prefix + "Move");</pre>

Fragment 2 in file Scripts\Services\Toolbar\Core\ToolbarInfo.cs

<pre>entries.Add(CommandSystem.Prefix + "StaffRunebook");
						entries.Add(CommandSystem.Prefix + "SpeedBoost");
						entries.Add(CommandSystem.Prefix + "M Tele");
						entries.Add(CommandSystem.Prefix + "Where");
						entries.Add(CommandSystem.Prefix + "Who");

						for (int j = 0; j < 3; j++)
						{
							entries.Add("-*UNUSED*-");
						}

						entries.Add(CommandSystem.Prefix + "Props");
						entries.Add(CommandSystem.Prefix + "Move");
						entries.Add(CommandSystem.Prefix + "Add");
						entries.Add(CommandSystem.Prefix + "Remove");</pre>

## Duplicated Code. Size: 233

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Cat.cs

<pre>this.Body = 0xC9;
            this.Hue = Utility.RandomAnimalHue();
            this.BaseSoundID = 0x69;

            this.SetStr(9);
            this.SetDex(35);
            this.SetInt(5);

            this.SetHits(6);
            this.SetMana(0);

            this.SetDamage(1);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 5, 10);

            this.SetSkill(SkillName.MagicResist, 5.0);
            this.SetSkill(SkillName.Tactics, 4.0);
            this.SetSkill(SkillName.Wrestling, 5.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DiseasedCat.cs

<pre>this.Body = 0xC9;
            this.Hue = Utility.RandomAnimalHue();
            this.BaseSoundID = 0x69;

            this.SetStr(9);
            this.SetDex(35);
            this.SetInt(5);

            this.SetHits(6);
            this.SetMana(0);

            this.SetDamage(1);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 5, 10);

            this.SetSkill(SkillName.MagicResist, 5.0);
            this.SetSkill(SkillName.Tactics, 4.0);
            this.SetSkill(SkillName.Wrestling, 5.0);</pre>

## Duplicated Code. Size: 233

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Golem.cs

<pre>public override void OnDamage(int amount, Mobile from, bool willKill)
        {
            if (this.Controlled || this.Summoned)
            {
                Mobile master = (this.ControlMaster);

                if (master == null)
                    master = this.SummonMaster;

                if (master != null && master.Player && master.Map == this.Map && master.InRange(this.Location, 20))
                {
                    if (master.Mana >= amount)
                    {
                        master.Mana -= amount;
                    }
                    else
                    {
                        amount -= master.Mana;
                        master.Mana = 0;
                        master.Damage(amount);
                    }
                }
            }

            base.OnDamage(amount, from, willKill);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Vollem.cs

<pre>public override void OnDamage(int amount, Mobile from, bool willKill)
        {
            if (this.Controlled || this.Summoned)
            {
                Mobile master = (this.ControlMaster);

                if (master == null)
                    master = this.SummonMaster;

                if (master != null && master.Player && master.Map == this.Map && master.InRange(this.Location, 20))
                {
                    if (master.Mana >= amount)
                    {
                        master.Mana -= amount;
                    }
                    else
                    {
                        amount -= master.Mana;
                        master.Mana = 0;
                        master.Damage(amount);
                    }
                }
            }

            base.OnDamage(amount, from, willKill);
        }</pre>

## Duplicated Code. Size: 231

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseEvilCreatures.cs

<pre>private bool CanDoTarget(Mobile m)
        {
            int discordanceEffect = 0;

            if (!CanBeHarmful(m, false) || Server.SkillHandlers.Discordance.GetEffect(m, ref discordanceEffect))
                return false;

            if ((m is DespiseCreature && ((DespiseCreature)m).Alignment != Alignment.Neutral && ((DespiseCreature)m).Alignment != this.Alignment) || m is DespiseBoss)
                return true;

            return m is PlayerMobile && !this.Controlled && ((m.Karma < 0 && this.Alignment == Alignment.Good) || (m.Karma > 0 && this.Alignment == Alignment.Evil));
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DespiseGoodCreatures.cs

<pre>private bool CanDoTarget(Mobile m)
        {
            int discordanceEffect = 0;

            if (!CanBeHarmful(m, false) || Server.SkillHandlers.Discordance.GetEffect(m, ref discordanceEffect))
                return false;

            if ((m is DespiseCreature && ((DespiseCreature)m).Alignment != Alignment.Neutral && ((DespiseCreature)m).Alignment != this.Alignment) || m is DespiseBoss)
                return true;

            return m is PlayerMobile && !this.Controlled && ((m.Karma < 0 && this.Alignment == Alignment.Good) || (m.Karma > 0 && this.Alignment == Alignment.Evil));
        }</pre>

## Duplicated Code. Size: 231

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Imp.cs

<pre>this.SetDamage(10, 14);

            this.SetDamageType(ResistanceType.Physical, 0);
            this.SetDamageType(ResistanceType.Fire, 50);
            this.SetDamageType(ResistanceType.Poison, 50);

            this.SetResistance(ResistanceType.Physical, 25, 35);
            this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);

            this.SetSkill(SkillName.EvalInt, 20.1, 30.0);</pre>

Fragment 2 in file Scripts\Spells\Spellweaving\Mobiles\ArcaneFiend.cs

<pre>this.SetDamage(10, 14);

            this.SetDamageType(ResistanceType.Physical, 0);
            this.SetDamageType(ResistanceType.Fire, 50);
            this.SetDamageType(ResistanceType.Poison, 50);

            this.SetResistance(ResistanceType.Physical, 25, 35);
            this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);

            this.SetSkill(SkillName.EvalInt, 20.1, 30.0);</pre>

## Duplicated Code. Size: 231

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>BarkeeperRumor rumor = rumors[i];

				AddHtml(100, 70 + (i * 120), 50, 20, "Message", false, false);
				AddHtml(100, 90 + (i * 120), 450, 40, rumor == null ? "No current message" : rumor.Message, true, false);
				AddHtml(100, 130 + (i * 120), 50, 20, "Keyword", false, false);
				AddHtml(100, 150 + (i * 120), 450, 40, rumor == null ? "None" : rumor.Keyword, true, false);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>BarkeeperRumor rumor = rumors[i];

				AddHtml(100, 70 + (i * 120), 50, 20, "Message", false, false);
				AddHtml(100, 90 + (i * 120), 450, 40, rumor == null ? "No current message" : rumor.Message, true, false);
				AddHtml(100, 130 + (i * 120), 50, 20, "Keyword", false, false);
				AddHtml(100, 150 + (i * 120), 450, 40, rumor == null ? "None" : rumor.Keyword, true, false);</pre>

## Duplicated Code. Size: 231

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\QuestLogGump.cs

<pre>for ( int i = index; i < (index + count) && i >= 0 && i < list.Count; ++i )
			{
				object obj = list[i];

				AddImageTiled( 24, 94 + (tableIndex * 32), 489, 2, 2624 );

				++tableIndex;
			}

			AddAlphaRegion( 18, 20, width - 17, 420 );
			AddImage( 5, 5, 10460 );
			AddImage( width - 15, 5, 10460 );
			AddImage( 5, 424, 10460 );
			AddImage( width - 15, 424, 10460 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestBookGump.cs

<pre>for ( int i = index; i < (index + count) && i >= 0 && i < list.Count; ++i )
			{
				object obj = list[i];

				AddImageTiled( 24, 94 + (tableIndex * 32), 489, 2, 2624 );

				++tableIndex;
			}

			AddAlphaRegion( 18, 20, width - 17, 420 );
			AddImage( 5, 5, 10460 );
			AddImage( width - 15, 5, 10460 );
			AddImage( 5, 424, 10460 );
			AddImage( width - 15, 424, 10460 );</pre>

## Duplicated Code. Size: 231

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>if (args == null) return;

			string entryID = null;
			string entryText = null;
			if (args.Length > 0)
			{
				entryID = args[0].Trim();
			}

			if (entryID == null || entryID.Length == 0) return;

			if (args.Length > 1)
			{
				entryText = args[1].Trim();
			}

			// allocate a new journal if none exists
			if (m_Journal == null) m_Journal = new List<XmlQuest.JournalEntry>();

			// go through the existing journal to find a matching ID
			XmlQuest.JournalEntry foundEntry = null;

			foreach (XmlQuest.JournalEntry e in m_Journal)
			{
				if (e.EntryID == entryID)
				{
					foundEntry = e;
					break;
				}
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>if (args == null) return;

                string entryID = null;
                string entryText = null;
                if (args.Length > 0)
                {
                    entryID = args[0].Trim();
                }

                if (entryID == null || entryID.Length == 0) return;

                if (args.Length > 1)
                {
                    entryText = args[1].Trim();
                }

                // allocate a new journal if none exists
                if (m_Journal == null) m_Journal = new List<XmlQuest.JournalEntry>();

                // go through the existing journal to find a matching ID
                XmlQuest.JournalEntry foundEntry = null;

                foreach (XmlQuest.JournalEntry e in m_Journal)
                {
                    if (e.EntryID == entryID)
                    {
                        foundEntry = e;
                        break;
                    }
                }</pre>

## Duplicated Code. Size: 231

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Fourth\FireField.cs

<pre>SpellHelper.Turn(this.Caster, p);

                SpellHelper.GetSurfaceTop(ref p);

                int dx = this.Caster.Location.X - p.X;
                int dy = this.Caster.Location.Y - p.Y;
                int rx = (dx - dy) * 44;
                int ry = (dx + dy) * 44;

                bool eastToWest;

                if (rx >= 0 && ry >= 0)
                {
                    eastToWest = false;
                }
                else if (rx >= 0)
                {
                    eastToWest = true;
                }
                else if (ry >= 0)
                {
                    eastToWest = true;
                }
                else
                {
                    eastToWest = false;
                }</pre>

Fragment 2 in file Scripts\Spells\Third\WallOfStone.cs

<pre>SpellHelper.Turn(this.Caster, p);

                SpellHelper.GetSurfaceTop(ref p);

                int dx = this.Caster.Location.X - p.X;
                int dy = this.Caster.Location.Y - p.Y;
                int rx = (dx - dy) * 44;
                int ry = (dx + dy) * 44;

                bool eastToWest;

                if (rx >= 0 && ry >= 0)
                {
                    eastToWest = false;
                }
                else if (rx >= 0)
                {
                    eastToWest = true;
                }
                else if (ry >= 0)
                {
                    eastToWest = true;
                }
                else
                {
                    eastToWest = false;
                }</pre>

## Duplicated Code. Size: 230

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\FlourMillEastAddon.cs

<pre>private void FinishWorking_Callback(object state)
        {
            if (this.m_Timer != null)
            {
                this.m_Timer.Stop();
                this.m_Timer = null;
            }

            Mobile from = state as Mobile;

            if (from != null && !from.Deleted && !this.Deleted && this.IsFull)
            {
                SackFlour flour = new SackFlour();

                flour.ItemID = (Utility.RandomBool() ? 4153 : 4165);

                if (from.PlaceInBackpack(flour))
                {
                    this.m_Flour = 0;
                }
                else
                {
                    flour.Delete();
                    from.SendLocalizedMessage(500998); // There is not enough room in your backpack!  You stop grinding.
                }
            }

            this.UpdateStage();
        }</pre>

Fragment 2 in file Scripts\Items\Addons\FlourMillSouthAddon.cs

<pre>private void FinishWorking_Callback(object state)
        {
            if (this.m_Timer != null)
            {
                this.m_Timer.Stop();
                this.m_Timer = null;
            }

            Mobile from = state as Mobile;

            if (from != null && !from.Deleted && !this.Deleted && this.IsFull)
            {
                SackFlour flour = new SackFlour();

                flour.ItemID = (Utility.RandomBool() ? 4153 : 4165);

                if (from.PlaceInBackpack(flour))
                {
                    this.m_Flour = 0;
                }
                else
                {
                    flour.Delete();
                    from.SendLocalizedMessage(500998); // There is not enough room in your backpack!  You stop grinding.
                }
            }

            this.UpdateStage();
        }</pre>

## Duplicated Code. Size: 230

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SoulStone.cs

<pre>this.AddBackground(0, 0, 520, 440, 0x13BE);

                this.AddImageTiled(10, 10, 500, 20, 0xA40);
                this.AddImageTiled(10, 40, 500, 360, 0xA40);
                this.AddImageTiled(10, 410, 500, 20, 0xA40);

                this.AddAlphaRegion(10, 10, 500, 420);

                this.AddHtmlLocalized(10, 12, 500, 20, 1070709, 0x7FFF, false, false); // <CENTER>Confirm Soulstone Transfer</CENTER>

                /* <CENTER>Soulstone</CENTER><BR>
                * You are using a Soulstone.  This powerful artifact allows you to remove skill points
                * from your character and store them in the stone for later retrieval.  In order to use
                * the stone, you must make sure your Skill Lock for the indicated skill is pointed downward.
                * Click the "Skills" button on your Paperdoll to access the Skill List, and double-check
                * your skill lock.<BR><BR>
                *
                * Once you activate the stone, all skill points in the indicated skill will be removed from
                * your character.  These skill points can later be retrieved.  IMPORTANT: When retrieving
                * skill points from a Soulstone, the Soulstone WILL REPLACE any existing skill points
                * already on your character!<BR><BR>
                *
                * This is an Account Bound Soulstone.  Skill pointsstored inside can be retrieved by any
                * character on the same account as the character who placed them into the stone.
                */
                this.AddHtmlLocalized(10, 42, 500, 110, 1061067, 0x7FFF, false, true);</pre>

Fragment 2 in file Scripts\Items\Consumables\SoulStone.cs

<pre>this.AddBackground(0, 0, 520, 440, 0x13BE);

                this.AddImageTiled(10, 10, 500, 20, 0xA40);
                this.AddImageTiled(10, 40, 500, 360, 0xA40);
                this.AddImageTiled(10, 410, 500, 20, 0xA40);

                this.AddAlphaRegion(10, 10, 500, 420);

                this.AddHtmlLocalized(10, 12, 500, 20, 1070709, 0x7FFF, false, false); // <CENTER>Confirm Soulstone Transfer</CENTER>

                /* <CENTER>Soulstone</CENTER><BR>
                * You are using a Soulstone.  This powerful artifact allows you to remove skill points
                * from your character and store them in the stone for later retrieval.  In order to use
                * the stone, you must make sure your Skill Lock for the indicated skill is pointed downward.
                * Click the "Skills" button on your Paperdoll to access the Skill List, and double-check
                * your skill lock.<BR><BR>
                *
                * Once you activate the stone, all skill points in the indicated skill will be removed from
                * your character.  These skill points can later be retrieved.  IMPORTANT: When retrieving
                * skill points from a Soulstone, the Soulstone WILL REPLACE any existing skill points
                * already on your character!<BR><BR>
                *
                * This is an Account Bound Soulstone.  Skill pointsstored inside can be retrieved by any
                * character on the same account as the character who placed them into the stone.
                */
                this.AddHtmlLocalized(10, 42, 500, 110, 1061067, 0x7FFF, false, true);</pre>

## Duplicated Code. Size: 230

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\BaseCollectionItem.cs

<pre>Item item = QuestHelper.Construct(reward.Type) as Item;

            if (item != null && player.AddToBackpack(item))
            {
                if (hue > 0)
                    item.Hue = hue;

                player.AddCollectionPoints(this.CollectionID, (int)reward.Points * -1);
                player.SendLocalizedMessage(1073621); // Your reward has been placed in your backpack.
                player.PlaySound(0x5A7);

                if (reward.QuestItem)
                    CollectionsObtainObjective.CheckReward(player, item);
            }
            else if (item != null)
            {
                player.SendLocalizedMessage(1074361); // The reward could not be given.  Make sure you have room in your pack.
                item.Delete();
            }

            reward.OnGiveReward(player, this, hue);</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\BaseCollectionMobile.cs

<pre>Item item = QuestHelper.Construct(reward.Type) as Item;

            if (item != null && player.AddToBackpack(item))
            {
                if (hue > 0)
                    item.Hue = hue;

                player.AddCollectionPoints(this.CollectionID, (int)reward.Points * -1);
                player.SendLocalizedMessage(1073621); // Your reward has been placed in your backpack.
                player.PlaySound(0x5A7);

                if (reward.QuestItem)
                    CollectionsObtainObjective.CheckReward(player, item);
            }
            else if (item != null)
            {
                player.SendLocalizedMessage(1074361); // The reward could not be given.  Make sure you have room in your pack.
                item.Delete();
            }

            reward.OnGiveReward(player, this, hue);</pre>

## Duplicated Code. Size: 230

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestLeaders.cs

<pre>string guildname = null;

					if(r.Quester.Guild != null)
						guildname = r.Quester.Guild.Abbreviation;
#if(FACTIONS)
					string factionname = null;

					if(r.Quester is PlayerMobile && ((PlayerMobile)r.Quester).FactionPlayerState != null) 
						factionname = ((PlayerMobile)r.Quester).FactionPlayerState.Faction.ToString();
#endif
					// check for any ranking change and update rank date
					if(r.Rank != a.Rank)
					{
						a.WhenRanked = DateTime.UtcNow;
						if(a.Rank > 0)
							a.DeltaRank = a.Rank - r.Rank;
						a.Rank = r.Rank;

					}

					TimeSpan timeranked = DateTime.UtcNow - a.WhenRanked;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestLeaders.cs

<pre>string guildname = null;

					if(r.Quester.Guild != null)
						guildname = r.Quester.Guild.Abbreviation;
#if(FACTIONS)
					string factionname = null;

					if(r.Quester is PlayerMobile && ((PlayerMobile)r.Quester).FactionPlayerState != null) 
						factionname = ((PlayerMobile)r.Quester).FactionPlayerState.Faction.ToString();
#endif
					// check for any ranking change and update rank date
					if(r.Rank != a.Rank)
					{
						a.WhenRanked = DateTime.UtcNow;
						if(a.Rank > 0)
							a.DeltaRank = a.Rank - r.Rank;
						a.Rank = r.Rank;

					}

					TimeSpan timeranked = DateTime.UtcNow - a.WhenRanked;</pre>

## Duplicated Code. Size: 230

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBAlchemist.cs

<pre>this.Add(typeof(BlackPearl), 3); 
                this.Add(typeof(Bloodmoss), 3); 
                this.Add(typeof(MandrakeRoot), 2); 
                this.Add(typeof(Garlic), 2); 
                this.Add(typeof(Ginseng), 2); 
                this.Add(typeof(Nightshade), 2); 
                this.Add(typeof(SpidersSilk), 2); 
                this.Add(typeof(SulfurousAsh), 2); 
                this.Add(typeof(Bottle), 3);
                this.Add(typeof(MortarPestle), 4);</pre>

Fragment 2 in file Scripts\VendorInfo\SBGlassblower.cs

<pre>this.Add(typeof(BlackPearl), 3); 
                this.Add(typeof(Bloodmoss), 3); 
                this.Add(typeof(MandrakeRoot), 2); 
                this.Add(typeof(Garlic), 2); 
                this.Add(typeof(Ginseng), 2); 
                this.Add(typeof(Nightshade), 2); 
                this.Add(typeof(SpidersSilk), 2); 
                this.Add(typeof(SulfurousAsh), 2); 
                this.Add(typeof(Bottle), 3);
                this.Add(typeof(MortarPestle), 4);</pre>

## Duplicated Code. Size: 230

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketHandlers.cs

<pre>int prof = pvSrc.ReadByte();
			pvSrc.Seek(15, SeekOrigin.Current);

			//bool female = pvSrc.ReadBoolean();

			int genderRace = pvSrc.ReadByte();

			int str = pvSrc.ReadByte();
			int dex = pvSrc.ReadByte();
			int intl = pvSrc.ReadByte();
			int is1 = pvSrc.ReadByte();
			int vs1 = pvSrc.ReadByte();
			int is2 = pvSrc.ReadByte();
			int vs2 = pvSrc.ReadByte();
			int is3 = pvSrc.ReadByte();
			int vs3 = pvSrc.ReadByte();</pre>

Fragment 2 in file Server\Network\PacketHandlers.cs

<pre>int prof = pvSrc.ReadByte();
			pvSrc.Seek(15, SeekOrigin.Current);

			int genderRace = pvSrc.ReadByte();

			int str = pvSrc.ReadByte();
			int dex = pvSrc.ReadByte();
			int intl = pvSrc.ReadByte();
			int is1 = pvSrc.ReadByte();
			int vs1 = pvSrc.ReadByte();
			int is2 = pvSrc.ReadByte();
			int vs2 = pvSrc.ReadByte();
			int is3 = pvSrc.ReadByte();
			int vs3 = pvSrc.ReadByte();</pre>

## Duplicated Code. Size: 230

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\InhumanSpeech.cs

<pre>new string[]
                    {
                        "meat", "gold", "kill", "killing", "slay",
                        "sword", "axe", "spell", "magic", "spells",
                        "swords", "axes", "mace", "maces", "monster",
                        "monsters", "food", "run", "escape", "away",
                        "help", "dead", "die", "dying", "lose",
                        "losing", "life", "lives", "death", "ghost",
                        "ghosts", "british", "blackthorn", "guild",
                        "guilds", "dragon", "dragons", "game", "games",
                        "ultima", "silly", "stupid", "dumb", "idiot",
                        "idiots", "cheesy", "cheezy", "crazy", "dork",
                        "jerk", "fool", "foolish", "ugly", "insult", "scum"
                    }</pre>

Fragment 2 in file Scripts\Misc\InhumanSpeech.cs

<pre>new string[]
                    {
                        "meat", "gold", "kill", "killing", "slay",
                        "sword", "axe", "spell", "magic", "spells",
                        "swords", "axes", "mace", "maces", "monster",
                        "monsters", "food", "run", "escape", "away",
                        "help", "dead", "die", "dying", "lose",
                        "losing", "life", "lives", "death", "ghost",
                        "ghosts", "british", "blackthorn", "guild",
                        "guilds", "dragon", "dragons", "game", "games",
                        "ultima", "silly", "stupid", "dumb", "idiot",
                        "idiots", "cheesy", "cheezy", "crazy", "dork",
                        "jerk", "fool", "foolish", "ugly", "insult", "scum"
                    }</pre>

Fragment 3 in file Scripts\Misc\InhumanSpeech.cs

<pre>new string[]
                    {
                        "meat", "gold", "kill", "killing", "slay",
                        "sword", "axe", "spell", "magic", "spells",
                        "swords", "axes", "mace", "maces", "monster",
                        "monsters", "food", "run", "escape", "away",
                        "help", "dead", "die", "dying", "lose",
                        "losing", "life", "lives", "death", "ghost",
                        "ghosts", "british", "blackthorn", "guild",
                        "guilds", "dragon", "dragons", "game", "games",
                        "ultima", "silly", "stupid", "dumb", "idiot",
                        "idiots", "cheesy", "cheezy", "crazy", "dork",
                        "jerk", "fool", "foolish", "ugly", "insult", "scum"
                    }</pre>

## Duplicated Code. Size: 229

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\BaseShipCaptain.cs

<pre>SetStr(500, 750);
            SetDex(125, 175);
            SetInt(61, 75);

            SetHits(4500, 5000);

            SetDamage(23, 35);

            SetSkill(SkillName.Fencing, 115.0, 120.0);
            SetSkill(SkillName.Macing, 115.0, 120.0);
            SetSkill(SkillName.MagicResist, 115.0, 120.0);
            SetSkill(SkillName.Swords, 115.0, 120.0);
            SetSkill(SkillName.Tactics, 115.0, 120.0);
            SetSkill(SkillName.Wrestling, 115.0, 120.0);
            SetSkill(SkillName.Anatomy, 115.0, 120.0);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\PirateCaptain.cs

<pre>SetStr(500, 750);
            SetDex(125, 175);
            SetInt(61, 75);

            SetHits(4500, 5000);

            SetDamage(23, 35);

            SetSkill(SkillName.Fencing, 115.0, 120.0);
            SetSkill(SkillName.Macing, 115.0, 120.0);
            SetSkill(SkillName.MagicResist, 115.0, 120.0);
            SetSkill(SkillName.Swords, 115.0, 120.0);
            SetSkill(SkillName.Tactics, 115.0, 120.0);
            SetSkill(SkillName.Wrestling, 115.0, 120.0);
            SetSkill(SkillName.Anatomy, 115.0, 120.0);</pre>

## Duplicated Code. Size: 229

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Camps\BrigandCamp.cs

<pre>public override void OnEnter(Mobile m)
        {
            if (m.Player && this.m_Prisoner != null && this.m_Prisoner.CantWalk)
            {
                int number;

                switch ( Utility.Random(8) )
                {
                    case 0:
                        number = 502261;
                        break; // HELP!
                    case 1:
                        number = 502262;
                        break; // Help me!
                    case 2:
                        number = 502263;
                        break; // Canst thou aid me?!
                    case 3:
                        number = 502264;
                        break; // Help a poor prisoner!
                    case 4:
                        number = 502265;
                        break; // Help! Please!
                    case 5:
                        number = 502266;
                        break; // Aaah! Help me!
                    case 6:
                        number = 502267;
                        break; // Go and get some help!
                    default:
                        number = 502268;
                        break; // Quickly, I beg thee! Unlock my chains! If thou dost look at me close thou canst see them.	
                }
                this.m_Prisoner.Yell(number);
            }
        }</pre>

Fragment 2 in file Scripts\Multis\Camps\LizardmenCamp.cs

<pre>public override void OnEnter(Mobile m)
        {
            if (m.Player && this.m_Prisoner != null && this.m_Prisoner.CantWalk)
            {
                int number;

                switch ( Utility.Random(8) )
                {
                    case 0:
                        number = 502261;
                        break; // HELP!
                    case 1:
                        number = 502262;
                        break; // Help me!
                    case 2:
                        number = 502263;
                        break; // Canst thou aid me?!
                    case 3:
                        number = 502264;
                        break; // Help a poor prisoner!
                    case 4:
                        number = 502265;
                        break; // Help! Please!
                    case 5:
                        number = 502266;
                        break; // Aaah! Help me!
                    case 6:
                        number = 502267;
                        break; // Go and get some help!
                    default:
                        number = 502268;
                        break; // Quickly, I beg thee! Unlock my chains! If thou dost look at me close thou canst see them.	
                }
                this.m_Prisoner.Yell(number);
            }
        }</pre>

Fragment 3 in file Scripts\Multis\Camps\OrcCamp.cs

<pre>public override void OnEnter(Mobile m)
        {
            if (m.Player && this.m_Prisoner != null && this.m_Prisoner.CantWalk)
            {
                int number;

                switch ( Utility.Random(8) )
                {
                    case 0:
                        number = 502261;
                        break; // HELP!
                    case 1:
                        number = 502262;
                        break; // Help me!
                    case 2:
                        number = 502263;
                        break; // Canst thou aid me?!
                    case 3:
                        number = 502264;
                        break; // Help a poor prisoner!
                    case 4:
                        number = 502265;
                        break; // Help! Please!
                    case 5:
                        number = 502266;
                        break; // Aaah! Help me!
                    case 6:
                        number = 502267;
                        break; // Go and get some help!
                    default:
                        number = 502268;
                        break; // Quickly, I beg thee! Unlock my chains! If thou dost look at me close thou canst see them.	
                }
                this.m_Prisoner.Yell(number);
            }
        }</pre>

Fragment 4 in file Scripts\Multis\Camps\RatCamp.cs

<pre>public override void OnEnter(Mobile m)
        {
            if (m.Player && this.m_Prisoner != null && this.m_Prisoner.CantWalk)
            {
                int number;

                switch ( Utility.Random(8) )
                {
                    case 0:
                        number = 502261;
                        break; // HELP!
                    case 1:
                        number = 502262;
                        break; // Help me!
                    case 2:
                        number = 502263;
                        break; // Canst thou aid me?!
                    case 3:
                        number = 502264;
                        break; // Help a poor prisoner!
                    case 4:
                        number = 502265;
                        break; // Help! Please!
                    case 5:
                        number = 502266;
                        break; // Aaah! Help me!
                    case 6:
                        number = 502267;
                        break; // Go and get some help!
                    default:
                        number = 502268;
                        break; // Quickly, I beg thee! Unlock my chains! If thou dost look at me close thou canst see them.	
                }
                this.m_Prisoner.Yell(number);
            }
        }</pre>

## Duplicated Code. Size: 228

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Summons\BladeSpirits.cs

<pre>public override void OnThink()
        {
            if (Core.SE && this.Summoned)
            {
                ArrayList spirtsOrVortexes = new ArrayList();

                foreach (Mobile m in this.GetMobilesInRange(5))
                {
                    if (m is EnergyVortex || m is BladeSpirits)
                    {
                        if (((BaseCreature)m).Summoned)
                            spirtsOrVortexes.Add(m);
                    }
                }

                while (spirtsOrVortexes.Count > 6)
                {
                    int index = Utility.Random(spirtsOrVortexes.Count);
                    this.Dispel(((Mobile)spirtsOrVortexes[index]));
                    spirtsOrVortexes.RemoveAt(index);
                }
            }

            base.OnThink();
        }</pre>

Fragment 2 in file Scripts\Mobiles\Summons\EnergyVortex.cs

<pre>public override void OnThink()
        {
            if (Core.SE && this.Summoned)
            {
                ArrayList spirtsOrVortexes = new ArrayList();

                foreach (Mobile m in this.GetMobilesInRange(5))
                {
                    if (m is EnergyVortex || m is BladeSpirits)
                    {
                        if (((BaseCreature)m).Summoned)
                            spirtsOrVortexes.Add(m);
                    }
                }

                while (spirtsOrVortexes.Count > 6)
                {
                    int index = Utility.Random(spirtsOrVortexes.Count);
                    //TODO: Confim if it's the dispel with all the pretty effects or just a Deletion of it.
                    this.Dispel(((Mobile)spirtsOrVortexes[index]));
                    spirtsOrVortexes.RemoveAt(index);
                }
            }

            base.OnThink();
        }</pre>

## Duplicated Code. Size: 228

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new int[][]
        {
            new int[] { 2, 4, 4, 4, 5, 5, 5 },
            new int[] { 4, 4, 5, 5, 5, 5, 5 },
            new int[] { 5, 5, 5, 5, 5, 5, 5 },
            new int[] { },
            new int[] { 4, 4, 5, 5, 5, 5, 5 },
            new int[] { 5, 5, 5, 5, 5, 5, 5 },
        }</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new int[][]
        {
            new int[] { 2, 4, 4, 4, 5, 5, 5 },
            new int[] { 4, 4, 5, 5, 5, 5, 5 },
            new int[] { 5, 5, 5, 5, 5, 5, 5 },
            new int[] {  },
            new int[] { 4, 4, 5, 5, 5, 5, 5 },
            new int[] { 5, 5, 5, 5, 5, 5, 5 },
        }</pre>

## Duplicated Code. Size: 228

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>if ((i.Map == Map.Felucca && criteria.Dosearchfel) || (i.Map == Map.Trammel && criteria.Dosearchtram) ||
							(i.Map == Map.Malas && criteria.Dosearchmal) || (i.Map == Map.Ilshenar && criteria.Dosearchilsh) || 
                            (i.Map == Map.TerMur && criteria.Dosearchter) || (i.Map == Map.Internal && criteria.Dosearchint) ||
							(i.Map == null && criteria.Dosearchnull))
						{
							hasmap = true;
						}

						if (tokunomap != null && i.Map == tokunomap && criteria.Dosearchtok)
						{
							hasmap = true;
						}

						if (!hasmap) continue;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>if ((i.Map == Map.Felucca && criteria.Dosearchfel) || (i.Map == Map.Trammel && criteria.Dosearchtram) ||
							(i.Map == Map.Malas && criteria.Dosearchmal) || (i.Map == Map.Ilshenar && criteria.Dosearchilsh) || 
                            (i.Map == Map.TerMur && criteria.Dosearchter) || (i.Map == Map.Internal && criteria.Dosearchint) ||
							(i.Map == null && criteria.Dosearchnull))
						{
							hasmap = true;
						}

						if (tokunomap != null && i.Map == tokunomap && criteria.Dosearchtok)
						{
							hasmap = true;
						}

						if (!hasmap) continue;</pre>

## Duplicated Code. Size: 228

### Duplicated Fragments:

Fragment 1 in file Ultima\FileIndex.cs

<pre>if (String.IsNullOrEmpty(idxPath))
				{
					idxPath = null;
				}
				else
				{
					if (String.IsNullOrEmpty(Path.GetDirectoryName(idxPath)))
					{
						idxPath = Path.Combine(Files.RootDir, idxPath);
					}

					if (!File.Exists(idxPath))
					{
						idxPath = null;
					}
				}

				if (String.IsNullOrEmpty(MulPath))
				{
					MulPath = null;
				}
				else
				{
					if (String.IsNullOrEmpty(Path.GetDirectoryName(MulPath)))
					{
						MulPath = Path.Combine(Files.RootDir, MulPath);
					}

					if (!File.Exists(MulPath))
					{
						MulPath = null;
					}
				}</pre>

Fragment 2 in file Ultima\FileIndex.cs

<pre>if (String.IsNullOrEmpty(idxPath))
				{
					idxPath = null;
				}
				else
				{
					if (String.IsNullOrEmpty(Path.GetDirectoryName(idxPath)))
					{
						idxPath = Path.Combine(Files.RootDir, idxPath);
					}
					if (!File.Exists(idxPath))
					{
						idxPath = null;
					}
				}
				if (String.IsNullOrEmpty(MulPath))
				{
					MulPath = null;
				}
				else
				{
					if (String.IsNullOrEmpty(Path.GetDirectoryName(MulPath)))
					{
						MulPath = Path.Combine(Files.RootDir, MulPath);
					}
					if (!File.Exists(MulPath))
					{
						MulPath = null;
					}
				}</pre>

## Duplicated Code. Size: 228

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new int[][]
        {
            new int[] { 30, 50, 50, 60, 70, 70, 70 },
            new int[] { 50, 60, 70, 70, 70, 70, 70 },
            new int[] { 70, 70, 70, 70, 70, 70, 70 },
            new int[] {  },
            new int[] { 50, 60, 70, 70, 70, 70, 70 },
            new int[] { 70, 70, 70, 70, 70, 70, 70 },
        }</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new int[][]
        {
            new int[] { 30, 50, 50, 60, 70, 70, 70 },
            new int[] { 50, 60, 70, 70, 70, 70, 70 },
            new int[] { 70, 70, 70, 70, 70, 70, 70 },
            new int[] {  },
            new int[] { 50, 60, 70, 70, 70, 70, 70 },
            new int[] { 70, 70, 70, 70, 70, 70, 70 },
        }</pre>

Fragment 3 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new int[][]
        {
            new int[] { 30, 50, 50, 60, 70, 70, 70 },
            new int[] { 50, 60, 70, 70, 70, 70, 70 },
            new int[] { 70, 70, 70, 70, 70, 70, 70 },
            new int[] {  },
            new int[] { 50, 60, 70, 70, 70, 70, 70 },
            new int[] { 70, 70, 70, 70, 70, 70, 70 },
        }</pre>

## Duplicated Code. Size: 227

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetPoint3DGump.cs

<pre>case 3: // Use values
                    {
                        TextRelay x = info.GetTextEntry(0);
                        TextRelay y = info.GetTextEntry(1);
                        TextRelay z = info.GetTextEntry(2);

                        toSet = new Point3D(x == null ? 0 : Utility.ToInt32(x.Text), y == null ? 0 : Utility.ToInt32(y.Text), z == null ? 0 : Utility.ToInt32(z.Text));
                        shouldSet = true;
                        shouldSend = true;

                        break;
                    }
                default:
                    {
                        toSet = Point3D.Zero;
                        shouldSet = false;
                        shouldSend = true;

                        break;
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetPoint3DGump.cs

<pre>case 3: // Use values
				{
					TextRelay x = info.GetTextEntry( 0 );
					TextRelay y = info.GetTextEntry( 1 );
					TextRelay z = info.GetTextEntry( 2 );

					toSet = new Point3D( x == null ? 0 : Utility.ToInt32( x.Text ), y == null ? 0 : Utility.ToInt32( y.Text ), z == null ? 0 : Utility.ToInt32( z.Text ) );
					shouldSet = true;
					shouldSend = true;

					break;
				}
				default:
				{
					toSet = Point3D.Zero;
					shouldSet = false;
					shouldSend = true;

					break;
				}</pre>

## Duplicated Code. Size: 227

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>public int SetResistBonus(ResistanceType resist)
        {
            switch (resist)
            {
                case ResistanceType.Physical: return m_SetEquipped ? LastEquipped ? (PhysicalResistance * Pieces) + m_SetPhysicalBonus : 0 : PhysicalResistance;
                case ResistanceType.Fire: return m_SetEquipped ? LastEquipped ? (FireResistance * Pieces) + m_SetFireBonus : 0 : FireResistance;
                case ResistanceType.Cold: return m_SetEquipped ? LastEquipped ? (ColdResistance * Pieces) + m_SetColdBonus : 0 : ColdResistance;
                case ResistanceType.Poison: return m_SetEquipped ? LastEquipped ? (PoisonResistance * Pieces) + m_SetPoisonBonus : 0 : PoisonResistance;
                case ResistanceType.Energy: return m_SetEquipped ? LastEquipped ? (EnergyResistance * Pieces) + m_SetEnergyBonus : 0 : EnergyResistance;
            }

            return 0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>public int SetResistBonus(ResistanceType resist)
        {
            switch (resist)
            {
                case ResistanceType.Physical: return m_SetEquipped ? LastEquipped ? (PhysicalResistance * Pieces) + m_SetPhysicalBonus : 0 : PhysicalResistance;
                case ResistanceType.Fire: return m_SetEquipped ? LastEquipped ? (FireResistance * Pieces) + m_SetFireBonus : 0 : FireResistance;
                case ResistanceType.Cold: return m_SetEquipped ? LastEquipped ? (ColdResistance * Pieces) + m_SetColdBonus : 0 : ColdResistance;
                case ResistanceType.Poison: return m_SetEquipped ? LastEquipped ? (PoisonResistance * Pieces) + m_SetPoisonBonus : 0 : PoisonResistance;
                case ResistanceType.Energy: return m_SetEquipped ? LastEquipped ? (EnergyResistance * Pieces) + m_SetEnergyBonus : 0 : EnergyResistance;
            }

            return 0;
        }</pre>

## Duplicated Code. Size: 227

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DeadlyImp.cs

<pre>this.SetDamage(50, 80);

            this.SetDamageType(ResistanceType.Fire, 100);

            this.SetResistance(ResistanceType.Physical, 95, 98);
            this.SetResistance(ResistanceType.Fire, 95, 98);
            this.SetResistance(ResistanceType.Cold, 95, 98);
            this.SetResistance(ResistanceType.Poison, 95, 98);
            this.SetResistance(ResistanceType.Energy, 95, 98);

            this.SetSkill(SkillName.Magery, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0);
            this.SetSkill(SkillName.Wrestling, 120.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\FierceDragon.cs

<pre>this.SetDamage(50, 80);

            this.SetDamageType(ResistanceType.Fire, 100);

            this.SetResistance(ResistanceType.Physical, 95, 98);
            this.SetResistance(ResistanceType.Fire, 95, 98);
            this.SetResistance(ResistanceType.Cold, 95, 98);
            this.SetResistance(ResistanceType.Poison, 95, 98);
            this.SetResistance(ResistanceType.Energy, 95, 98);

            this.SetSkill(SkillName.Tactics, 120.0);
            this.SetSkill(SkillName.Wrestling, 120.0);
            this.SetSkill(SkillName.Magery, 120.0);</pre>

## Duplicated Code. Size: 227

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Savage.cs

<pre>public override void AggressiveAction(Mobile aggressor, bool criminal)
        {
            base.AggressiveAction(aggressor, criminal);

            if (aggressor.BodyMod == 183 || aggressor.BodyMod == 184)
            {
                AOS.Damage(aggressor, 50, 0, 100, 0, 0, 0);
                aggressor.BodyMod = 0;
                aggressor.HueMod = -1;
                aggressor.FixedParticles(0x36BD, 20, 10, 5044, EffectLayer.Head);
                aggressor.PlaySound(0x307);
                aggressor.SendLocalizedMessage(1040008); // Your skin is scorched as the tribal paint burns away!

                if (aggressor is PlayerMobile)
                    ((PlayerMobile)aggressor).SavagePaintExpiration = TimeSpan.Zero;
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SavageRider.cs

<pre>public override void AggressiveAction(Mobile aggressor, bool criminal)
        {
            base.AggressiveAction(aggressor, criminal);

            if (aggressor.BodyMod == 183 || aggressor.BodyMod == 184)
            {
                AOS.Damage(aggressor, 50, 0, 100, 0, 0, 0);
                aggressor.BodyMod = 0;
                aggressor.HueMod = -1;
                aggressor.FixedParticles(0x36BD, 20, 10, 5044, EffectLayer.Head);
                aggressor.PlaySound(0x307);
                aggressor.SendLocalizedMessage(1040008); // Your skin is scorched as the tribal paint burns away!

                if (aggressor is PlayerMobile)
                    ((PlayerMobile)aggressor).SavagePaintExpiration = TimeSpan.Zero;
            }
        }</pre>

## Duplicated Code. Size: 226

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseEvilCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 15, 25 );
			SetResistance( ResistanceType.Fire, 20, 30 );
			SetResistance( ResistanceType.Cold, 15, 25 );
			SetResistance( ResistanceType.Poison, 30, 40 );
			SetResistance( ResistanceType.Energy, 30, 40 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );
			SetSkill( SkillName.Archery, SkillStart );

			Fame = GetFame;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DespiseGoodCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 15, 25 );
			SetResistance( ResistanceType.Fire, 20, 30 );
			SetResistance( ResistanceType.Cold, 15, 25 );
			SetResistance( ResistanceType.Poison, 30, 40 );
			SetResistance( ResistanceType.Energy, 30, 40 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );
			SetSkill( SkillName.Archery, SkillStart );

			Fame = GetFame;</pre>

## Duplicated Code. Size: 226

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\MyrmidexThreat\Mobiles\Creatures.cs

<pre>if (this.Map == null)
                return;

            IPooledEnumerable eable = this.Map.GetMobilesInRange(this.Location, 12);
            List<Mobile> random = new List<Mobile>();

            foreach (Mobile m in eable)
            {
                if (m.Alive && m is PlayerMobile && SpellHelper.ValidIndirectTarget(this, m) && this.CanBeHarmful(m, false))
                    random.Add(m);
            }

            eable.Free();
            Mobile target = null;

            if(random.Count > 0)
                target = random[Utility.Random(random.Count)];</pre>

Fragment 2 in file Scripts\Quests\Eodon\MyrmidexThreat\Mobiles\Creatures.cs

<pre>if (this.Map == null)
                return;

            IPooledEnumerable eable = this.Map.GetMobilesInRange(this.Location, 12);
            List<Mobile> random = new List<Mobile>();

            foreach (Mobile m in eable)
            {
                if (m.Alive && m is PlayerMobile && SpellHelper.ValidIndirectTarget(this, m) && this.CanBeHarmful(m, false))
                    random.Add(m);
            }

            eable.Free();
            Mobile target = null;

            if (random.Count > 0)
                target = random[Utility.Random(random.Count)];</pre>

## Duplicated Code. Size: 225

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Docs.cs

<pre>if (parms.Length > 0)
			{
				html.Write(' ');

				for (var i = 0; i < parms.Length; ++i)
				{
					var pi = parms[i];

					if (i != 0)
					{
						html.Write(", ");
					}

					if (pi.IsIn)
					{
						html.Write(InString);
					}
					else if (pi.IsOut)
					{
						html.Write(OutString);
					}

					html.Write(GetPair(pi.ParameterType, pi.Name, pi.IsOut));
				}

				html.Write(' ');
			}

			html.WriteLine(")<br />");</pre>

Fragment 2 in file Scripts\Commands\Docs.cs

<pre>if (parms.Length > 0)
			{
				html.Write(' ');

				for (var i = 0; i < parms.Length; ++i)
				{
					var pi = parms[i];

					if (i != 0)
					{
						html.Write(", ");
					}

					if (pi.IsIn)
					{
						html.Write(InString);
					}
					else if (pi.IsOut)
					{
						html.Write(OutString);
					}

					html.Write(GetPair(pi.ParameterType, pi.Name, pi.IsOut));
				}

				html.Write(' ');
			}

			html.WriteLine(")<br />");</pre>

## Duplicated Code. Size: 224

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\QuestLogGump.cs

<pre>AddPage( 0 );

			AddBackground( 10, 10, width, 439, 5054 );
			AddImageTiled( 18, 20, width - 17, 420, 2624 );

			AddImageTiled( 58 - xoffset, 64, 36, 352, 200 ); // open
			AddImageTiled( 96 - xoffset, 64, 163, 352, 1416 );  // name
			AddImageTiled( 261 - xoffset, 64, 55, 352, 200 ); // type
			AddImageTiled( 308 - xoffset, 64, 85, 352, 1416 );  // status
			AddImageTiled( 395 - xoffset, 64, 116, 352, 200 );  // expires</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestBookGump.cs

<pre>AddPage( 0 );

			AddBackground( 10, 10, width, 439, 5054 );
			AddImageTiled( 18, 20, width - 17, 420, 2624 );

			AddImageTiled( 58 - xoffset, 64, 36, 352, 200 ); // open
			AddImageTiled( 96 - xoffset, 64, 163, 352, 1416 );  // name
			AddImageTiled( 261 - xoffset, 64, 55, 352, 200 ); // type
			AddImageTiled( 308 - xoffset, 64, 85, 352, 1416 );  // status
			AddImageTiled( 395 - xoffset, 64, 116, 352, 200 );  // expires</pre>

## Duplicated Code. Size: 224

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>{
                bool unlit = false, unprotected = false;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (!unlit && this.m_Params[i] == "Unlit")
                        unlit = true;
                    else if (!unprotected && this.m_Params[i] == "Unprotected")
                        unprotected = true;

                    if (unlit && unprotected)
                        break;
                }

                if (!unlit)
                    ((BaseLight)item).Ignite();
                if (!unprotected)
                    ((BaseLight)item).Protected = true;

                if (this.m_ItemID > 0)
                    item.ItemID = this.m_ItemID;
            }</pre>

Fragment 2 in file Scripts\Commands\DecorateDelete.cs

<pre>{
                bool unlit = false, unprotected = false;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (!unlit && this.m_Params[i] == "Unlit")
                        unlit = true;
                    else if (!unprotected && this.m_Params[i] == "Unprotected")
                        unprotected = true;

                    if (unlit && unprotected)
                        break;
                }

                if (!unlit)
                    ((BaseLight)item).Ignite();
                if (!unprotected)
                    ((BaseLight)item).Protected = true;

                if (this.m_ItemID > 0)
                    item.ItemID = this.m_ItemID;
            }</pre>

Fragment 3 in file Scripts\Commands\DecorateMag.cs

<pre>{
                bool unlit = false, unprotected = false;

                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (!unlit && this.m_Params[i] == "Unlit")
                        unlit = true;
                    else if (!unprotected && this.m_Params[i] == "Unprotected")
                        unprotected = true;

                    if (unlit && unprotected)
                        break;
                }

                if (!unlit)
                    ((BaseLight)item).Ignite();
                if (!unprotected)
                    ((BaseLight)item).Protected = true;

                if (this.m_ItemID > 0)
                    item.ItemID = this.m_ItemID;
            }</pre>

## Duplicated Code. Size: 223

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AdminGump.cs

<pre>this.AddLabelCropped(132, offset, 120, 20, LabelHue, FormatAccessLevel(accessLevel));

                            if (online)
                                this.AddLabelCropped(252, offset, 120, 20, GreenHue, "Online");
                            else if (a.Banned)
                                this.AddLabelCropped(252, offset, 120, 20, RedHue, "Banned");
                            else
                                this.AddLabelCropped(252, offset, 120, 20, RedHue, "Offline");

                            this.AddButton(380, offset - 1, 0xFA5, 0xFA7, this.GetButtonID(5, index + 56), GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Gumps\AdminGump.cs

<pre>this.AddLabelCropped(132, offset, 120, 20, LabelHue, FormatAccessLevel(accessLevel));

                            if (online)
                                this.AddLabelCropped(252, offset, 120, 20, GreenHue, "Online");
                            else if (a.Banned)
                                this.AddLabelCropped(252, offset, 120, 20, RedHue, "Banned");
                            else
                                this.AddLabelCropped(252, offset, 120, 20, RedHue, "Offline");

                            this.AddButton(380, offset - 1, 0xFA5, 0xFA7, this.GetButtonID(5, index + 56), GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 222

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Docs.cs

<pre>sbod.Type = typeof(SkullCap);
				sbod.Material = BulkMaterialType.None;
				DocumentTailorBOD(html, sbod.ComputeRewards(true), "10, 15", sbod.Material, sbod.Type);

				sbod.Type = typeof(LeatherCap);
				for (var mat = BulkMaterialType.None; mat <= BulkMaterialType.Barbed; ++mat)
				{
					if (mat >= BulkMaterialType.DullCopper && mat <= BulkMaterialType.Valorite)
					{
						continue;
					}

					sbod.Material = mat;
					DocumentTailorBOD(html, sbod.ComputeRewards(true), "10, 15", sbod.Material, sbod.Type);
				}

				html.WriteLine("         <tr>");</pre>

Fragment 2 in file Scripts\Commands\Docs.cs

<pre>sbod.Type = typeof(SkullCap);
				sbod.Material = BulkMaterialType.None;
				DocumentTailorBOD(html, sbod.ComputeRewards(true), "10, 15", sbod.Material, sbod.Type);

				sbod.Type = typeof(LeatherCap);
				for (var mat = BulkMaterialType.None; mat <= BulkMaterialType.Barbed; ++mat)
				{
					if (mat >= BulkMaterialType.DullCopper && mat <= BulkMaterialType.Valorite)
					{
						continue;
					}

					sbod.Material = mat;
					DocumentTailorBOD(html, sbod.ComputeRewards(true), "10, 15", sbod.Material, sbod.Type);
				}

				html.WriteLine("         <tr>");</pre>

## Duplicated Code. Size: 222

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\BaseConfirmGump.cs

<pre>this.AddImageTiled(30, 0, 300, 17, 0x280A);
            this.AddImage(315, 0, 0x280E); 
            this.AddImage(15, 244, 0x280C); 
            this.AddImageTiled(30, 244, 300, 17, 0x280A);
            this.AddImage(315, 244, 0x280E); 
            this.AddImage(330, 15, 0x27A8); 
            this.AddImageTiled(330, 30, 17, 200, 0x27A7);
            this.AddImage(330, 230, 0x27AA); 
            this.AddImage(333, 2, 0x2716);</pre>

Fragment 2 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainResignGump.cs

<pre>this.AddImageTiled(30, 0, 300, 17, 0x280A);
            this.AddImage(315, 0, 0x280E);
            this.AddImage(15, 244, 0x280C);
            this.AddImageTiled(30, 244, 300, 17, 0x280A);
            this.AddImage(315, 244, 0x280E);
            this.AddImage(330, 15, 0x27A8);
            this.AddImageTiled(330, 30, 17, 200, 0x27A7);
            this.AddImage(330, 230, 0x27AA);
            this.AddImage(333, 2, 0x2716);</pre>

## Duplicated Code. Size: 222

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\HouseTransferGump.cs

<pre>this.AddImageTiled(10, 250, 400, 20, 2624);
            this.AddAlphaRegion(10, 250, 400, 20);

            this.AddButton(10, 250, 4005, 4007, 1, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(40, 250, 170, 20, 1011036, 32767, false, false); // OKAY

            this.AddButton(210, 250, 4005, 4007, 0, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(240, 250, 170, 20, 1011012, 32767, false, false); // CANCEL</pre>

Fragment 2 in file Scripts\Items\Internal\Moongate.cs

<pre>this.AddImageTiled(10, 250, 400, 20, 2624);
                this.AddAlphaRegion(10, 250, 400, 20);

                this.AddButton(10, 250, 4005, 4007, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(40, 250, 170, 20, 1011036, 32767, false, false); // OKAY

                this.AddButton(210, 250, 4005, 4007, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(240, 250, 170, 20, 1011012, 32767, false, false); // CANCEL</pre>

## Duplicated Code. Size: 222

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\PrismOfLightTeleporters.cs

<pre>public override bool OnMoveOver(Mobile m)
        {
            if (m.NetState == null || !m.NetState.SupportsExpansion(Expansion.ML))
            {
                m.SendLocalizedMessage(1072608); // You must upgrade to the Mondain's Legacy expansion in order to enter here.				
                return true;
            }
            else if (!MondainsLegacy.PrismOfLight && (int)m.AccessLevel < (int)AccessLevel.GameMaster)
            {
                m.SendLocalizedMessage(1042753, "Prism of Light"); // ~1_SOMETHING~ has been temporarily disabled.
                return true;
            }

            if (m.Backpack != null)
            {
                if (m.Backpack.FindItemByType(typeof(PrismOfLightAdmissionTicket), true) != null)
                    return base.OnMoveOver(m);
            }

            m.SendLocalizedMessage(1074277); // No admission without a ticket.

            return true;	
        }</pre>

Fragment 2 in file Scripts\Items\Internal\PrismOfLightTeleporters.cs

<pre>public override bool OnMoveOver(Mobile m)
        {
            if (m.NetState == null || !m.NetState.SupportsExpansion(Expansion.ML))
            {
                m.SendLocalizedMessage(1072608); // You must upgrade to the Mondain's Legacy expansion in order to enter here.				
                return true;
            }
            else if (!MondainsLegacy.PrismOfLight && (int)m.AccessLevel < (int)AccessLevel.GameMaster)
            {
                m.SendLocalizedMessage(1042753, "Prism of Light"); // ~1_SOMETHING~ has been temporarily disabled.
                return true;
            }

            if (m.Backpack != null)
            {
                if (m.Backpack.FindItemByType(typeof(PrismOfLightAdmissionTicket), true) != null)
                    return base.OnMoveOver(m);
            }

            m.SendLocalizedMessage(1074277); // No admission without a ticket.

            return true;
        }</pre>

## Duplicated Code. Size: 222

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Rikktor.cs

<pre>Map map = this.Map;

            if (map == null)
                return;

            ArrayList targets = new ArrayList();

            foreach (Mobile m in this.GetMobilesInRange(8))
            {
                if (m == this || !this.CanBeHarmful(m))
                    continue;

                if (m is BaseCreature && (((BaseCreature)m).Controlled || ((BaseCreature)m).Summoned || ((BaseCreature)m).Team != this.Team))
                    targets.Add(m);
                else if (m.Player)
                    targets.Add(m);
            }

            this.PlaySound(0x2F3);</pre>

Fragment 2 in file Scripts\Mobiles\Named\Meraktus.cs

<pre>Map map = this.Map;
            if (map == null)
                return;
            ArrayList targets = new ArrayList();
            foreach (Mobile m in this.GetMobilesInRange(8))
            {
                if (m == this || !this.CanBeHarmful(m))
                    continue;
                if (m is BaseCreature && (((BaseCreature)m).Controlled || ((BaseCreature)m).Summoned || ((BaseCreature)m).Team != this.Team))
                    targets.Add(m);
                else if (m.Player)
                    targets.Add(m);
            }
            this.PlaySound(0x2F3);</pre>

## Duplicated Code. Size: 222

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Brigand.cs

<pre>switch ( Utility.Random(7))
            {
                case 0:
                    this.AddItem(new Longsword());
                    break;
                case 1:
                    this.AddItem(new Cutlass());
                    break;
                case 2:
                    this.AddItem(new Broadsword());
                    break;
                case 3:
                    this.AddItem(new Axe());
                    break;
                case 4:
                    this.AddItem(new Club());
                    break;
                case 5:
                    this.AddItem(new Dagger());
                    break;
                case 6:
                    this.AddItem(new Spear());
                    break;
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ForgottenServant.cs

<pre>switch ( Utility.Random(7))
            {
                case 0:
                    this.AddItem(new Longsword());
                    break;
                case 1:
                    this.AddItem(new Cutlass());
                    break;
                case 2:
                    this.AddItem(new Broadsword());
                    break;
                case 3:
                    this.AddItem(new Axe());
                    break;
                case 4:
                    this.AddItem(new Club());
                    break;
                case 5:
                    this.AddItem(new Dagger());
                    break;
                case 6:
                    this.AddItem(new Spear());
                    break;
            }</pre>

## Duplicated Code. Size: 221

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\PrimevalLich.cs

<pre>this.Animate(10, 4, 1, true, false, 0);

                ArrayList targets = new ArrayList();

                foreach (Mobile m in target.GetMobilesInRange(8))
                {
                    if (m == this || !this.CanBeHarmful(m))
                        continue;

                    if (m is BaseCreature && (((BaseCreature)m).Controlled || ((BaseCreature)m).Summoned || ((BaseCreature)m).Team != this.Team))
                        targets.Add(m);
                    else if (m.Player && m.Alive)
                        targets.Add(m);
                }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Yamandon.cs

<pre>this.Animate(10, 4, 1, true, false, 0);

                ArrayList targets = new ArrayList();

                foreach (Mobile m in target.GetMobilesInRange(8))
                {
                    if (m == this || !this.CanBeHarmful(m))
                        continue;

                    if (m is BaseCreature && (((BaseCreature)m).Controlled || ((BaseCreature)m).Summoned || ((BaseCreature)m).Team != this.Team))
                        targets.Add(m);
                    else if (m.Player && m.Alive)
                        targets.Add(m);
                }</pre>

## Duplicated Code. Size: 221

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>if (hasvendor)
								{
									// force vendor spawners to behave like the distro
									spawner.SpawnRange = 0;
								}
								else
								{
									spawner.SpawnRange = spawnrange;
								}

								spawner.m_PlayerCreated = true;
								string fromname = null;
								if (from != null) fromname = from.Name;
								spawner.LastModifiedBy = fromname;
								spawner.FirstModifiedBy = fromname;
								spawner.MoveToWorld(new Point3D(x, y, z), spawnmap);
								if (spawner.Map == Map.Internal)
								{
									badspawnercount++;
									spawner.Delete();
									from.SendMessage("Invalid map at line {0}", linenumber);
									from.SendMessage("Bad spawn at line {1}: {0}", line, linenumber);
									return;
								}
								spawnercount++;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>if (hasvendor)
								{
									// force vendor spawners to behave like the distro
									spawner.SpawnRange = 0;
								}
								else
								{
									spawner.SpawnRange = spawnrange;
								}

								spawner.m_PlayerCreated = true;
								string fromname = null;
								if (from != null) fromname = from.Name;
								spawner.LastModifiedBy = fromname;
								spawner.FirstModifiedBy = fromname;
								spawner.MoveToWorld(new Point3D(x, y, z), spawnmap);
								if (spawner.Map == Map.Internal)
								{
									badspawnercount++;
									spawner.Delete();
									from.SendMessage("Invalid map at line {0}", linenumber);
									from.SendMessage("Bad spawn at line {1}: {0}", line, linenumber);
									return;
								}
								spawnercount++;</pre>

## Duplicated Code. Size: 221

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>if (from.IsPlayer())
            {
                if (_Owner != null && _Owner != from)
                {
                    from.SendLocalizedMessage(501023); // You must be the owner to use this item.
                    return false;
                }

                if (this is IAccountRestricted && ((IAccountRestricted)this).Account != null)
                {
                    Accounting.Account acct = from.Account as Accounting.Account;

                    if (acct == null || acct.Username != ((IAccountRestricted)this).Account)
                    {
                        from.SendLocalizedMessage(1071296); // This item is Account Bound and your character is not bound to it. You cannot use this item.
                        return false;
                    }
                }

                if (IsVvVItem && !Engines.VvV.ViceVsVirtueSystem.IsVvV(from))
                {
                    from.SendLocalizedMessage(1155496); // This item can only be used by VvV participants!
                    return false;
                }
            }</pre>

Fragment 2 in file Scripts\Items\Equipment\Talismans\BaseTalisman.cs

<pre>if (from.IsPlayer())
            {
                if (_Owner != null && _Owner != from)
                {
                    from.SendLocalizedMessage(501023); // You must be the owner to use this item.
                    return false;
                }

                if (this is IAccountRestricted && ((IAccountRestricted)this).Account != null)
                {
                    Accounting.Account acct = from.Account as Accounting.Account;

                    if (acct == null || acct.Username != ((IAccountRestricted)this).Account)
                    {
                        from.SendLocalizedMessage(1071296); // This item is Account Bound and your character is not bound to it. You cannot use this item.
                        return false;
                    }
                }

                if (IsVvVItem && !Engines.VvV.ViceVsVirtueSystem.IsVvV(from))
                {
                    from.SendLocalizedMessage(1155496); // This item can only be used by VvV participants!
                    return false;
                }
            }</pre>

Fragment 3 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if (from.IsPlayer())
            {
                if (_Owner != null && _Owner != from)
                {
                    from.SendLocalizedMessage(501023); // You must be the owner to use this item.
                    return false;
                }

                if (this is IAccountRestricted && ((IAccountRestricted)this).Account != null)
                {
                    Accounting.Account acct = from.Account as Accounting.Account;

                    if (acct == null || acct.Username != ((IAccountRestricted)this).Account)
                    {
                        from.SendLocalizedMessage(1071296); // This item is Account Bound and your character is not bound to it. You cannot use this item.
                        return false;
                    }
                }

                if (IsVvVItem && !Engines.VvV.ViceVsVirtueSystem.IsVvV(from))
                {
                    from.SendLocalizedMessage(1155496); // This item can only be used by VvV participants!
                    return false;
                }
            }</pre>

## Duplicated Code. Size: 220

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>{
                    int id = 0;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("SecretWall"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                            {
                                id = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                                break;
                            }
                        }
                    }

                    Item wall = Decorate.FindByID(id);

                    item = new SecretSwitch(this.m_ItemID, wall as SecretWall);
                }</pre>

Fragment 2 in file Scripts\Commands\DecorateDelete.cs

<pre>{
                    int id = 0;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("SecretWall"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                            {
                                id = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                                break;
                            }
                        }
                    }

                    Item wall = Decorate.FindByID(id);

                    item = new SecretSwitch(this.m_ItemID, wall as SecretWall);
                }</pre>

## Duplicated Code. Size: 220

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MeleeAI.cs

<pre>{
                if (this.m_Mobile.Hits < this.m_Mobile.HitsMax * 20 / 100)
                {
                    // We are low on health, should we flee?
                    bool flee = false;

                    if (this.m_Mobile.Hits < combatant.Hits)
                    {
                        // We are more hurt than them
                        int diff = combatant.Hits - this.m_Mobile.Hits;

                        flee = (Utility.Random(0, 100) < (10 + diff)); // (10 + diff)% chance to flee
                    }
                    else
                    {
                        flee = Utility.Random(0, 100) < 10; // 10% chance to flee
                    }

                    if (flee)
                    {
                        if (this.m_Mobile.Debug)
                            this.m_Mobile.DebugSay("I am going to flee from {0}", combatant.Name);

                        this.Action = ActionType.Flee;
                    }
                }
            }</pre>

Fragment 2 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>{
                if (this.m_Mobile.Hits < this.m_Mobile.HitsMax * 20 / 100)
                {
                    // We are low on health, should we flee?
                    bool flee = false;

                    if (this.m_Mobile.Hits < combatant.Hits)
                    {
                        // We are more hurt than them
                        int diff = combatant.Hits - this.m_Mobile.Hits;

                        flee = (Utility.Random(0, 100) < (10 + diff)); // (10 + diff)% chance to flee
                    }
                    else
                    {
                        flee = Utility.Random(0, 100) < 10; // 10% chance to flee
                    }

                    if (flee)
                    {
                        if (this.m_Mobile.Debug)
                            this.m_Mobile.DebugSay("I am going to flee from {0}", combatant.Name);

                        this.Action = ActionType.Flee;
                    }
                }
            }</pre>

## Duplicated Code. Size: 220

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Underworld\ExperimentalRoom\ExperimentalGem.cs

<pre>AddImageTiled(5, 40, 285, 40, 2624);
                AddHtmlLocalized(10, 40, 275, 40, 1113391, 0x7FFF, false, false); // Click CANCEL to read the instruction book or OK to start the timer now.

                AddButton(5, 85, 4017, 4018, 0, GumpButtonType.Reply, 0);
                AddHtmlLocalized(40, 87, 80, 25, 1011012, 0x7FFF, false, false);   //CANCEL

                AddButton(215, 85, 4023, 4024, 1, GumpButtonType.Reply, 0);
                AddHtmlLocalized(250, 87, 80, 25, 1006044, 0x7FFF, false, false);  //OK</pre>

Fragment 2 in file Scripts\Services\Underworld\PuzzleRoom\MagicKey.cs

<pre>AddImageTiled(5, 40, 285, 40, 2624);
                AddHtmlLocalized(10, 40, 275, 40, 1113391, 0x7FFF, false, false); // Click CANCEL to read the instruction book or OK to start the timer now.

                AddButton(5, 85, 4017, 4018, 0, GumpButtonType.Reply, 0);
                AddHtmlLocalized(40, 87, 80, 25, 1011012, 0x7FFF, false, false);   //CANCEL

                AddButton(215, 85, 4023, 4024, 1, GumpButtonType.Reply, 0);
                AddHtmlLocalized(250, 87, 80, 25, 1006044, 0x7FFF, false, false);  //OK</pre>

## Duplicated Code. Size: 220

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBlacksmith.cs

<pre>this.Add(new GenericBuyInfo(typeof(BronzeShield), 66, 20, 0x1B72, 0));
                this.Add(new GenericBuyInfo(typeof(Buckler), 50, 20, 0x1B73, 0));
                this.Add(new GenericBuyInfo(typeof(MetalKiteShield), 123, 20, 0x1B74, 0));
                this.Add(new GenericBuyInfo(typeof(HeaterShield), 231, 20, 0x1B76, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenKiteShield), 70, 20, 0x1B78, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBMetalShields.cs

<pre>this.Add(new GenericBuyInfo(typeof(BronzeShield), 66, 20, 0x1B72, 0));
                this.Add(new GenericBuyInfo(typeof(Buckler), 50, 20, 0x1B73, 0));
                this.Add(new GenericBuyInfo(typeof(MetalKiteShield), 123, 20, 0x1B74, 0));
                this.Add(new GenericBuyInfo(typeof(HeaterShield), 231, 20, 0x1B76, 0));
                this.Add(new GenericBuyInfo(typeof(WoodenKiteShield), 70, 20, 0x1B78, 0));</pre>

## Duplicated Code. Size: 220

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Quests.cs

<pre>if (offer)
                g.AddHtmlLocalized(130, 45, 270, 16, 1049010, 0xFFFFFF, false, false); // Quest Offer
            else
                g.AddHtmlLocalized(130, 45, 270, 16, 1046026, 0xFFFFFF, false, false); // Quest Log

            g.AddHtmlObject(160, 70, 330, 16, Title, BaseQuestGump.DarkGreen, false, false);
            g.AddHtmlLocalized(98, 140, 312, 16, 1049073, 0x2710, false, false); // Objective:
            g.AddHtmlLocalized(98, 156, 312, 16, 1072208, 0x2710, false, false); // All of the following	</pre>

Fragment 2 in file Scripts\Quests\Eodon\Valley of One Quest\Quests.cs

<pre>if (offer)
                g.AddHtmlLocalized(130, 45, 270, 16, 1049010, 0xFFFFFF, false, false); // Quest Offer
            else
                g.AddHtmlLocalized(130, 45, 270, 16, 1046026, 0xFFFFFF, false, false); // Quest Log

            g.AddHtmlObject(160, 70, 330, 16, Title, BaseQuestGump.DarkGreen, false, false);
            g.AddHtmlLocalized(98, 140, 312, 16, 1049073, 0x2710, false, false); // Objective:
            g.AddHtmlLocalized(98, 156, 312, 16, 1072208, 0x2710, false, false); // All of the following	</pre>

Fragment 3 in file Scripts\Quests\Eodon\Valley of One Quest\Quests.cs

<pre>if (offer)
                g.AddHtmlLocalized(130, 45, 270, 16, 1049010, 0xFFFFFF, false, false); // Quest Offer
            else
                g.AddHtmlLocalized(130, 45, 270, 16, 1046026, 0xFFFFFF, false, false); // Quest Log

            g.AddHtmlObject(160, 70, 330, 16, Title, BaseQuestGump.DarkGreen, false, false);
            g.AddHtmlLocalized(98, 140, 312, 16, 1049073, 0x2710, false, false); // Objective:
            g.AddHtmlLocalized(98, 156, 312, 16, 1072208, 0x2710, false, false); // All of the following</pre>

Fragment 4 in file Scripts\Quests\Eodon\Valley of One Quest\Quests.cs

<pre>if (offer)
                g.AddHtmlLocalized(130, 45, 270, 16, 1049010, 0xFFFFFF, false, false); // Quest Offer
            else
                g.AddHtmlLocalized(130, 45, 270, 16, 1046026, 0xFFFFFF, false, false); // Quest Log

            g.AddHtmlObject(160, 70, 330, 16, Title, BaseQuestGump.DarkGreen, false, false);
            g.AddHtmlLocalized(98, 140, 312, 16, 1049073, 0x2710, false, false); // Objective:
            g.AddHtmlLocalized(98, 156, 312, 16, 1072208, 0x2710, false, false); // All of the following	</pre>

Fragment 5 in file Scripts\Quests\Eodon\Valley of One Quest\Quests.cs

<pre>if (offer)
                g.AddHtmlLocalized(130, 45, 270, 16, 1049010, 0xFFFFFF, false, false); // Quest Offer
            else
                g.AddHtmlLocalized(130, 45, 270, 16, 1046026, 0xFFFFFF, false, false); // Quest Log

            g.AddHtmlObject(160, 70, 330, 16, Title, BaseQuestGump.DarkGreen, false, false);
            g.AddHtmlLocalized(98, 140, 312, 16, 1049073, 0x2710, false, false); // Objective:
            g.AddHtmlLocalized(98, 156, 312, 16, 1072208, 0x2710, false, false); // All of the following	</pre>

Fragment 6 in file Scripts\Quests\Eodon\Valley of One Quest\Quests.cs

<pre>if (offer)
                g.AddHtmlLocalized(130, 45, 270, 16, 1049010, 0xFFFFFF, false, false); // Quest Offer
            else
                g.AddHtmlLocalized(130, 45, 270, 16, 1046026, 0xFFFFFF, false, false); // Quest Log

            g.AddHtmlObject(160, 70, 330, 16, Title, BaseQuestGump.DarkGreen, false, false);
            g.AddHtmlLocalized(98, 140, 312, 16, 1049073, 0x2710, false, false); // Objective:
            g.AddHtmlLocalized(98, 156, 312, 16, 1072208, 0x2710, false, false); // All of the following	</pre>

Fragment 7 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\ProfessionalBountyQuest.cs

<pre>if (offer)
                g.AddHtmlLocalized(130, 45, 270, 16, 1049010, 0xFFFFFF, false, false); // Quest Offer
            else
                g.AddHtmlLocalized(130, 45, 270, 16, 1046026, 0xFFFFFF, false, false); // Quest Log

            g.AddHtmlObject(160, 70, 330, 16, Title, BaseQuestGump.DarkGreen, false, false);
            g.AddHtmlLocalized(98, 140, 312, 16, 1049073, 0x2710, false, false); // Objective:
            g.AddHtmlLocalized(98, 156, 312, 16, 1072208, 0x2710, false, false); // All of the following	</pre>

## Duplicated Code. Size: 219

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>tile2.Location = new Point3D(X + 2, Y - 5, Z);   //Left Front
                        tile3.Location = new Point3D(X - 2, Y - 5, Z);   //Right Front
                        tile4.Location = new Point3D(X + 2, Y - 2, Z);   //Left Center
                        tile5.Location = new Point3D(X - 2, Y - 2, Z);   //Right Center
                        tile6.Location = new Point3D(X + 2, Y + 1, Z);   //Left Rear
                        tile7.Location = new Point3D(X - 2, Y + 1, Z);   //Right Rear
                        break;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>tile2.Location = new Point3D(X - 5, Y - 2, Z);   //Left Front
                        tile3.Location = new Point3D(X - 5, Y + 2, Z);   //Right Front
                        tile4.Location = new Point3D(X - 2, Y - 2, Z);   //Left Center
                        tile5.Location = new Point3D(X - 2, Y + 2, Z);   //Right Center
                        tile6.Location = new Point3D(X + 1, Y - 2, Z);   //Left Rear
                        tile7.Location = new Point3D(X + 1, Y + 2, Z);   //Right Rear
                        break;</pre>

## Duplicated Code. Size: 219

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>tile2.Location = new Point3D(X - 2, Y + 5, Z);   //Left Front
                        tile3.Location = new Point3D(X + 2, Y + 5, Z);   //Right Front
                        tile4.Location = new Point3D(X - 2, Y + 2, Z);   //Left Center
                        tile5.Location = new Point3D(X + 2, Y + 2, Z);   //Right Center
                        tile6.Location = new Point3D(X - 2, Y - 1, Z);   //Left Rear
                        tile7.Location = new Point3D(X + 2, Y - 1, Z);   //Right Rear
                        break;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>tile2.Location = new Point3D(X + 5, Y + 2, Z);   //Left Front
                        tile3.Location = new Point3D(X + 5, Y - 2, Z);   //Right Front
                        tile4.Location = new Point3D(X + 2, Y + 2, Z);   //Left Center
                        tile5.Location = new Point3D(X + 2, Y - 2, Z);   //Right Center
                        tile6.Location = new Point3D(X - 1, Y + 2, Z);   //Left Rear
                        tile7.Location = new Point3D(X - 1, Y - 2, Z);   //Right Rear
                        break;</pre>

## Duplicated Code. Size: 218

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\Abilities.cs

<pre>public class DiscordEffectTimer : Timer
        {
            public Mobile Mob;
            public int Count;
            public int MaxCount;

            public DiscordEffectTimer(Mobile mob, TimeSpan duration)
                : base(TimeSpan.FromSeconds(1.25), TimeSpan.FromSeconds(1.25))
            {
                this.Mob = mob;
                this.Count = 0;
                this.MaxCount = (int)((double)duration.TotalSeconds / 1.25);
            }

            protected override void OnTick()
            {
                if (this.Count >= this.MaxCount)
                    this.Stop();
                else
                {
                    this.Mob.FixedEffect(0x376A, 1, 32);
                    this.Count++;
                }
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\AI\Omni AI\OmniIA Bard.cs

<pre>public class DiscordEffectTimer : Timer
        {
            public Mobile Mob;
            public int Count;
            public int MaxCount;

            public DiscordEffectTimer(Mobile mob, TimeSpan duration)
                : base(TimeSpan.FromSeconds(1.25), TimeSpan.FromSeconds(1.25))
            {
                this.Mob = mob;
                this.Count = 0;
                this.MaxCount = (int)((double)duration.TotalSeconds / 1.25);
            }

            protected override void OnTick()
            {
                if (this.Count >= this.MaxCount)
                    this.Stop();
                else
                {
                    this.Mob.FixedEffect(0x376A, 1, 32);
                    this.Count++;
                }
            }
        }</pre>

## Duplicated Code. Size: 218

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\SkillsGump.cs

<pre>int totalHeight = OffsetSize + ((EntryHeight + OffsetSize) * (count + 1));

            this.AddPage(0);

            this.AddBackground(0, 0, BackWidth, BorderSize + totalHeight + BorderSize, BackGumpID);
            this.AddImageTiled(BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), totalHeight, OffsetGumpID);

            int x = BorderSize + OffsetSize;
            int y = BorderSize + OffsetSize;

            int emptyWidth = TotalWidth - PrevWidth - NextWidth - (OffsetSize * 4) - (OldStyle ? SetWidth + OffsetSize : 0);</pre>

Fragment 2 in file Scripts\Gumps\WhoGump.cs

<pre>int totalHeight = OffsetSize + ((EntryHeight + OffsetSize) * (count + 1));

            this.AddPage(0);

            this.AddBackground(0, 0, BackWidth, BorderSize + totalHeight + BorderSize, BackGumpID);
            this.AddImageTiled(BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), totalHeight, OffsetGumpID);

            int x = BorderSize + OffsetSize;
            int y = BorderSize + OffsetSize;

            int emptyWidth = TotalWidth - PrevWidth - NextWidth - (OffsetSize * 4) - (OldStyle ? SetWidth + OffsetSize : 0);</pre>

## Duplicated Code. Size: 218

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SpecialFishingNet.cs

<pre>private static bool ValidateUndeepWater(Map map, object obj, ref int z)
        {
            if (!(obj is StaticTarget))
                return false;

            StaticTarget target = (StaticTarget)obj;

            if (BaseHouse.FindHouseAt(target.Location, map, 0) != null)
                return false;

            int itemID = target.ItemID;

            for (int i = 0; i < m_UndeepWaterTiles.Length; i += 2)
            {
                if (itemID >= m_UndeepWaterTiles[i] && itemID <= m_UndeepWaterTiles[i + 1])
                {
                    z = target.Z;
                    return true;
                }
            }

            return false;
        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\SpecialSalvageHook.cs

<pre>private static bool ValidateUndeepWater(Map map, object obj, ref int z)
        {
            if (!(obj is StaticTarget))
                return false;

            StaticTarget target = (StaticTarget)obj;

            if (BaseHouse.FindHouseAt(target.Location, map, 0) != null)
                return false;

            int itemID = target.ItemID;

            for (int i = 0; i < m_UndeepWaterTiles.Length; i += 2)
            {
                if (itemID >= m_UndeepWaterTiles[i] && itemID <= m_UndeepWaterTiles[i + 1])
                {
                    z = target.Z;
                    return true;
                }
            }

            return false;
        }</pre>

## Duplicated Code. Size: 218

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Paragon.cs

<pre>new Type[]
        {
            typeof(GoldBricks), typeof(PhillipsWoodenSteed),
            typeof(AlchemistsBauble), typeof(ArcticDeathDealer),
            typeof(BlazeOfDeath), typeof(BowOfTheJukaKing),
            typeof(BurglarsBandana), typeof(CavortingClub),
            typeof(EnchantedTitanLegBone), typeof(GwennosHarp),
            typeof(IolosLute), typeof(LunaLance),
            typeof(NightsKiss), typeof(NoxRangersHeavyCrossbow),
            typeof(OrcishVisage), typeof(PolarBearMask),
            typeof(ShieldOfInvulnerability), typeof(StaffOfPower),
            typeof(VioletCourage), typeof(HeartOfTheLion),
            typeof(WrathOfTheDryad), typeof(PixieSwatter),
            typeof(GlovesOfThePugilist)
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlParagon\XmlParagon.cs

<pre>new Type[]
		{
			typeof( GoldBricks ), typeof( PhillipsWoodenSteed ), 
			typeof( AlchemistsBauble ), typeof( ArcticDeathDealer ),
			typeof( BlazeOfDeath ), typeof( BowOfTheJukaKing ),
			typeof( BurglarsBandana ), typeof( CavortingClub ),
			typeof( EnchantedTitanLegBone ), typeof( GwennosHarp ),
			typeof( IolosLute ), typeof( LunaLance ),
			typeof( NightsKiss ), typeof( NoxRangersHeavyCrossbow ),
			typeof( OrcishVisage ), typeof( PolarBearMask ),
			typeof( ShieldOfInvulnerability ), typeof( StaffOfPower ),
			typeof( VioletCourage ), typeof( HeartOfTheLion ), 
			typeof( WrathOfTheDryad ), typeof( PixieSwatter ), 
			typeof( GlovesOfThePugilist )
		}</pre>

## Duplicated Code. Size: 218

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\Conduit.cs

<pre>skull.MoveToWorld(new Point3D(rec.X, rec.Y, Caster.Map.GetAverageZ(rec.X, rec.Y)), Caster.Map);
                Skulls.Add(skull);

                skull = new InternalItem();
                skull.MoveToWorld(new Point3D(rec.X + rec.Width, rec.Y + rec.Height, Caster.Map.GetAverageZ(rec.X + rec.Width, rec.Y + rec.Height)), Caster.Map);
                Skulls.Add(skull);

                skull = new InternalItem();</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\Conduit.cs

<pre>skull.MoveToWorld(new Point3D(rec.X + rec.Width, rec.Y, Caster.Map.GetAverageZ(rec.X + rec.Width, rec.Y)), Caster.Map);
                Skulls.Add(skull);

                skull = new InternalItem();
                skull.MoveToWorld(new Point3D(rec.X, rec.Y + rec.Height, Caster.Map.GetAverageZ(rec.X, rec.Y + rec.Height)), Caster.Map);
                Skulls.Add(skull);

                skull = new InternalItem();</pre>

## Duplicated Code. Size: 217

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\QuestNote.cs

<pre>m_Note = note;

			AddPage( 0 );
			AddAlphaRegion( 40, 41, 225, /*371*/70*note.Size );
			// scroll top
			AddImageTiled( 3, 5, 300, 37, 0x820 );
			// scroll middle, upper portion
			AddImageTiled( 19, 41, 263, 70, 0x821 );
			for(int i=1;i<note.Size;i++)
			{
				// scroll middle , lower portion
				AddImageTiled( 19, 41+70*i, 263, 70, 0x822 );
			}
			// scroll bottom
			AddImageTiled( 20, 111+70*(note.Size-1), 273, 34, 0x823 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\SimpleNote.cs

<pre>m_Note = note;

			AddPage( 0 );
			AddAlphaRegion( 40, 41, 225, /*371*/70*note.Size );
			// scroll top
			AddImageTiled( 3, 5, 300, 37, 0x820 );
			// scroll middle, upper portion
			AddImageTiled( 19, 41, 263, 70, 0x821 );
			for(int i=1;i<note.Size;i++)
			{
				// scroll middle , lower portion
				AddImageTiled( 19, 41+70*i, 263, 70, 0x822 );
			}
			// scroll bottom
			AddImageTiled( 20, 111+70*(note.Size-1), 273, 34, 0x823 );</pre>

## Duplicated Code. Size: 216

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if (strBonus != 0 || dexBonus != 0 || intBonus != 0)
            {
                string modName = this.Serial.ToString();

                if (strBonus != 0)
                    from.AddStatMod(new StatMod(StatType.Str, modName + "Str", strBonus, TimeSpan.Zero));

                if (dexBonus != 0)
                    from.AddStatMod(new StatMod(StatType.Dex, modName + "Dex", dexBonus, TimeSpan.Zero));

                if (intBonus != 0)
                    from.AddStatMod(new StatMod(StatType.Int, modName + "Int", intBonus, TimeSpan.Zero));
            }</pre>

Fragment 2 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>if (strBonus != 0 || dexBonus != 0 || intBonus != 0)
                {
                    string modName = this.Serial.ToString();

                    if (strBonus != 0)
                        from.AddStatMod(new StatMod(StatType.Str, modName + "Str", strBonus, TimeSpan.Zero));

                    if (dexBonus != 0)
                        from.AddStatMod(new StatMod(StatType.Dex, modName + "Dex", dexBonus, TimeSpan.Zero));

                    if (intBonus != 0)
                        from.AddStatMod(new StatMod(StatType.Int, modName + "Int", intBonus, TimeSpan.Zero));
                }</pre>

## Duplicated Code. Size: 216

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Mobiles\Raider.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 45, 55);
            SetResistance(ResistanceType.Fire, 45, 55);
            SetResistance(ResistanceType.Cold, 45, 55);
            SetResistance(ResistanceType.Poison, 45, 55);
            SetResistance(ResistanceType.Energy, 45, 55);

            SetSkill(SkillName.MagicResist, 50.0, 75.5);
            SetSkill(SkillName.Archery, 90.0, 105.5);
            SetSkill(SkillName.Tactics, 90.0, 105.5);
            SetSkill(SkillName.Anatomy, 90.0, 105.5);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Mobiles\Corgul\SoulboundPirateRaider.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 45, 55);
            SetResistance(ResistanceType.Fire, 45, 55);
            SetResistance(ResistanceType.Cold, 45, 55);
            SetResistance(ResistanceType.Poison, 45, 55);
            SetResistance(ResistanceType.Energy, 45, 55);

            SetSkill(SkillName.MagicResist, 50.0, 75.5);
            SetSkill(SkillName.Archery, 90.0, 105.5);
            SetSkill(SkillName.Tactics, 90.0, 105.5);
            SetSkill(SkillName.Anatomy, 90.0, 105.5);</pre>

## Duplicated Code. Size: 216

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Generate.cs

<pre>sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(4544, 2302, -1), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(4544, 2302, -1), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Generate.cs

<pre>sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(4544, 2302, -1), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);
            sp.SpawnRange = 1;
            sp.HomeRange = 5;
            sp.MoveToWorld(new Point3D(4544, 2302, -1), Map.Felucca);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);</pre>

## Duplicated Code. Size: 216

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainQuestGump.cs

<pre>if (this.m_Offer)
            {
                this.AddButton(95, 455, 0x2EE0, 0x2EE2, (int)Buttons.AcceptQuest, GumpButtonType.Reply, 0);
                this.AddButton(313, 455, 0x2EF2, 0x2EF4, (int)Buttons.RefuseQuest, GumpButtonType.Reply, 0);
            }
            else
            {
                this.AddButton(95, 455, 0x2EF5, 0x2EF7, (int)Buttons.ResignQuest, GumpButtonType.Reply, 0);
                this.AddButton(313, 455, 0x2EEC, 0x2EEE, (int)Buttons.CloseQuest, GumpButtonType.Reply, 0);
            }</pre>

Fragment 2 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainQuestGump.cs

<pre>if (this.m_Offer)
            {
                this.AddButton(95, 455, 0x2EE0, 0x2EE2, (int)Buttons.AcceptQuest, GumpButtonType.Reply, 0);
                this.AddButton(313, 455, 0x2EF2, 0x2EF4, (int)Buttons.RefuseQuest, GumpButtonType.Reply, 0);
            }
            else
            {
                this.AddButton(95, 455, 0x2EF5, 0x2EF7, (int)Buttons.ResignQuest, GumpButtonType.Reply, 0);
                this.AddButton(313, 455, 0x2EEC, 0x2EEE, (int)Buttons.CloseQuest, GumpButtonType.Reply, 0);
            }</pre>

## Duplicated Code. Size: 216

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Pathing\FastMovement.cs

<pre>public void Offset(Direction d, ref int x, ref int y)
		{
			switch (d & Direction.Mask)
			{
				case Direction.North:
					--y;
					break;
				case Direction.South:
					++y;
					break;
				case Direction.West:
					--x;
					break;
				case Direction.East:
					++x;
					break;
				case Direction.Right:
					++x;
					--y;
					break;
				case Direction.Left:
					--x;
					++y;
					break;
				case Direction.Down:
					++x;
					++y;
					break;
				case Direction.Up:
					--x;
					--y;
					break;
			}
		}</pre>

Fragment 2 in file Scripts\Services\Pathing\Movement.cs

<pre>public void Offset(Direction d, ref int x, ref int y)
        {
            switch ( d & Direction.Mask )
            {
                case Direction.North:
                    --y;
                    break;
                case Direction.South:
                    ++y;
                    break;
                case Direction.West:
                    --x;
                    break;
                case Direction.East:
                    ++x;
                    break;
                case Direction.Right:
                    ++x;
                    --y;
                    break;
                case Direction.Left:
                    --x;
                    ++y;
                    break;
                case Direction.Down:
                    ++x;
                    ++y;
                    break;
                case Direction.Up:
                    --x;
                    --y;
                    break;
            }
        }</pre>

## Duplicated Code. Size: 216

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>this.Expiration = reader.ReadDouble();
						this.m_TimeCreated = reader.ReadDateTime();
						this.m_Objective1 = reader.ReadString();
						this.m_Objective2 = reader.ReadString();
						this.m_Objective3 = reader.ReadString();
						this.m_Objective4 = reader.ReadString();
						this.m_Objective5 = reader.ReadString();
						this.m_Completed1 = reader.ReadBool();
						this.m_Completed2 = reader.ReadBool();
						this.m_Completed3 = reader.ReadBool();
						this.m_Completed4 = reader.ReadBool();
						this.m_Completed5 = reader.ReadBool();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>this.Expiration = reader.ReadDouble();
                        this.m_TimeCreated = reader.ReadDateTime();
                        this.m_Objective1 = reader.ReadString();
                        this.m_Objective2 = reader.ReadString();
                        this.m_Objective3 = reader.ReadString();
                        this.m_Objective4 = reader.ReadString();
                        this.m_Objective5 = reader.ReadString();
                        this.m_Completed1 = reader.ReadBool();
                        this.m_Completed2 = reader.ReadBool();
                        this.m_Completed3 = reader.ReadBool();
                        this.m_Completed4 = reader.ReadBool();
                        this.m_Completed5 = reader.ReadBool();</pre>

## Duplicated Code. Size: 216

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTF.cs

<pre>public override bool AreTeamMembers(Mobile from, Mobile target)
        {
            if(from == null || target == null) return false;

            int frommember = 0;
            int targetmember = 0;

            // go through each teams members list and determine whether the players are on any team list
            if(m_Participants != null)
            {
                foreach(ChallengeEntry entry in m_Participants)
                {
                    if(!(entry.Status == ChallengeStatus.Active)) continue;

                    Mobile m = entry.Participant;

                    if(m == from)
                    {
                        frommember = entry.Team;
                    }
                    if(m == target)
                    {
                        targetmember = entry.Team;
                    }
                }
            }

            return (frommember == targetmember && frommember != 0 && targetmember != 0);

        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGauntlet.cs

<pre>public override bool AreTeamMembers(Mobile from, Mobile target)
        {
            if(from == null || target == null) return false;

            int frommember = 0;
            int targetmember = 0;

            // go through each teams members list and determine whether the players are on any team list
            if(m_Participants != null)
            {
                foreach(ChallengeEntry entry in m_Participants)
                {
                    if(!(entry.Status == ChallengeStatus.Active)) continue;

                    Mobile m = entry.Participant;

                    if(m == from)
                    {
                        frommember = entry.Team;
                    }
                    if(m == target)
                    {
                        targetmember = entry.Team;
                    }
                }
            }

            return (frommember == targetmember && frommember != 0 && targetmember != 0);

        }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGauntlet.cs

<pre>public override bool AreTeamMembers(Mobile from, Mobile target)
        {
            if(from == null || target == null) return false;

            int frommember = 0;
            int targetmember = 0;

            // go through each teams members list and determine whether the players are on any team list
            if(m_Participants != null)
            {
                foreach(ChallengeEntry entry in m_Participants)
                {
                    if(!(entry.Status == ChallengeStatus.Active)) continue;

                    Mobile m = entry.Participant;

                    if(m == from)
                    {
                        frommember = entry.Team;
                    }
                    if(m == target)
                    {
                        targetmember = entry.Team;
                    }
                }
            }

            return (frommember == targetmember && frommember != 0 && targetmember != 0);

        }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGauntlet.cs

<pre>public override bool AreTeamMembers(Mobile from, Mobile target)
        {
            if(from == null || target == null) return false;

            int frommember = 0;
            int targetmember = 0;

            // go through each teams members list and determine whether the players are on any team list
            if(m_Participants != null)
            {
                foreach(ChallengeEntry entry in m_Participants)
                {
                    if(!(entry.Status == ChallengeStatus.Active)) continue;

                    Mobile m = entry.Participant;

                    if(m == from)
                    {
                        frommember = entry.Team;
                    }
                    if(m == target)
                    {
                        targetmember = entry.Team;
                    }
                }
            }

            return (frommember == targetmember && frommember != 0 && targetmember != 0);

        }</pre>

## Duplicated Code. Size: 216

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTF.cs

<pre>public override bool AreChallengers(Mobile from, Mobile target)
        {
            if(from == null || target == null) return false;

            int frommember = 0;
            int targetmember = 0;

            // go through each teams members list and determine whether the players are on any team list
            if(m_Participants != null)
            {
                foreach(ChallengeEntry entry in m_Participants)
                {
                    if(!(entry.Status == ChallengeStatus.Active)) continue;

                    Mobile m = entry.Participant;

                    if(m == from)
                    {
                        frommember = entry.Team;
                    }
                    if(m == target)
                    {
                        targetmember = entry.Team;
                    }
                }
            }

            return (frommember != targetmember && frommember != 0 && targetmember != 0);

        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGauntlet.cs

<pre>public override bool AreChallengers(Mobile from, Mobile target)
        {
            if(from == null || target == null) return false;

            int frommember = 0;
            int targetmember = 0;

            // go through each teams members list and determine whether the players are on any team list
            if(m_Participants != null)
            {
                foreach(ChallengeEntry entry in m_Participants)
                {
                    if(!(entry.Status == ChallengeStatus.Active)) continue;

                    Mobile m = entry.Participant;

                    if(m == from)
                    {
                        frommember = entry.Team;
                    }
                    if(m == target)
                    {
                        targetmember = entry.Team;
                    }
                }
            }

            return (frommember != targetmember && frommember != 0 && targetmember != 0);

        }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGauntlet.cs

<pre>public override bool AreChallengers(Mobile from, Mobile target)
        {
            if(from == null || target == null) return false;

            int frommember = 0;
            int targetmember = 0;

            // go through each teams members list and determine whether the players are on any team list
            if(m_Participants != null)
            {
                foreach(ChallengeEntry entry in m_Participants)
                {
                    if(!(entry.Status == ChallengeStatus.Active)) continue;

                    Mobile m = entry.Participant;

                    if(m == from)
                    {
                        frommember = entry.Team;
                    }
                    if(m == target)
                    {
                        targetmember = entry.Team;
                    }
                }
            }

            return (frommember != targetmember && frommember != 0 && targetmember != 0);

        }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGauntlet.cs

<pre>public override bool AreChallengers(Mobile from, Mobile target)
        {
            if(from == null || target == null) return false;

            int frommember = 0;
            int targetmember = 0;

            // go through each teams members list and determine whether the players are on any team list
            if(m_Participants != null)
            {
                foreach(ChallengeEntry entry in m_Participants)
                {
                    if(!(entry.Status == ChallengeStatus.Active)) continue;

                    Mobile m = entry.Participant;

                    if(m == from)
                    {
                        frommember = entry.Team;
                    }
                    if(m == target)
                    {
                        targetmember = entry.Team;
                    }
                }
            }

            return (frommember != targetmember && frommember != 0 && targetmember != 0);

        }</pre>

## Duplicated Code. Size: 215

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\ElwoodMcCarrin.cs

<pre>Item item;

                if (Core.AOS)
                {
                    item = Loot.RandomArmorOrShieldOrJewelry();

                    if (item is BaseArmor)
                        BaseRunicTool.ApplyAttributesTo((BaseArmor)item, 2, 20, 30);
                    else if (item is BaseJewel)
                        BaseRunicTool.ApplyAttributesTo((BaseJewel)item, 2, 20, 30);
                }
                else
                {
                    BaseArmor armor = Loot.RandomArmorOrShield();
                    item = armor;

                    armor.ProtectionLevel = (ArmorProtectionLevel)BaseCreature.RandomMinMaxScaled(2, 3);
                    armor.Durability = (ArmorDurabilityLevel)BaseCreature.RandomMinMaxScaled(2, 3);
                }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Grizelda.cs

<pre>Item item;

                                    if (Core.AOS)
                                    {
                                        item = Loot.RandomArmorOrShieldOrJewelry();

                                        if (item is BaseArmor)
                                            BaseRunicTool.ApplyAttributesTo((BaseArmor)item, 2, 20, 30);
                                        else if (item is BaseJewel)
                                            BaseRunicTool.ApplyAttributesTo((BaseJewel)item, 2, 20, 30);
                                    }
                                    else
                                    {
                                        BaseArmor armor = Loot.RandomArmorOrShield();
                                        item = armor;

                                        armor.ProtectionLevel = (ArmorProtectionLevel)BaseCreature.RandomMinMaxScaled(2, 3);
                                        armor.Durability = (ArmorDurabilityLevel)BaseCreature.RandomMinMaxScaled(2, 3);
                                    }</pre>

## Duplicated Code. Size: 215

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\QuestLogGump.cs

<pre>AddHtmlLocalized( 63 - xoffset, 64, 200, 32, 3000362, LabelColor, false, false ); // Open
			AddHtmlLocalized( 147 - xoffset, 64, 200, 32, 3005104, LabelColor, false, false ); // Name
			AddHtmlLocalized( 270 - xoffset, 64, 200, 32, 1062213, LabelColor, false, false ); // Type
			AddHtmlLocalized( 326 - xoffset, 64, 200, 32, 3000132, LabelColor, false, false ); // Status
			AddHtmlLocalized( 429 - xoffset, 64, 200, 32, 1062465, LabelColor, false, false ); // Expires</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestBookGump.cs

<pre>AddHtmlLocalized( 63 - xoffset, 64, 200, 32, 3000362, LabelColor, false, false ); // Open
			AddHtmlLocalized( 147 - xoffset, 64, 200, 32, 3005104, LabelColor, false, false ); // Name
			AddHtmlLocalized( 270 - xoffset, 64, 200, 32, 1062213, LabelColor, false, false ); // Type
			AddHtmlLocalized( 326 - xoffset, 64, 200, 32, 3000132, LabelColor, false, false ); // Status
			AddHtmlLocalized( 429 - xoffset, 64, 200, 32, 1062465, LabelColor, false, false ); // Expires</pre>

## Duplicated Code. Size: 215

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>AddLabel( 220, 130, 0, String.Format(XmlPoints.GetText(from, 200508), viewpage+1, (int)(m_WorkingList.Count/PlayersPerPage)+1)); // "Page: {0}/{1}"

                if(gauntlet.GameInProgress && gauntlet.MatchLength > TimeSpan.Zero)
                {
                    AddLabelCropped( 20, 130, 180, 21, 0, String.Format(XmlPoints.GetText(from, 200565),                // "Time left {0}"
                    TimeSpan.FromSeconds((double)((int)((gauntlet.MatchStart + gauntlet.MatchLength - DateTime.UtcNow).TotalSeconds)))));
                }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>AddLabel( 220, 130, 0, String.Format(XmlPoints.GetText(from, 200508), viewpage+1, (int)(m_WorkingList.Count/PlayersPerPage)+1)); // "Page: {0}/{1}"

                if(gauntlet.GameInProgress && gauntlet.MatchLength > TimeSpan.Zero)
                {
                    AddLabelCropped( 20, 130, 180, 21, 0, String.Format(XmlPoints.GetText(from, 200565),                // "Time left {0}"
                    TimeSpan.FromSeconds((double)((int)((gauntlet.MatchStart + gauntlet.MatchLength - DateTime.UtcNow).TotalSeconds)))));
                }</pre>

## Duplicated Code. Size: 215

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\ElementalFury.cs

<pre>int phys, fire, cold, pois, nrgy, chaos, direct;
            weapon.GetDamageTypes(null, out phys, out fire, out cold, out pois, out nrgy, out chaos, out direct);

            int highest = phys;
            int type = 0;

            if (fire > phys)
            {
                type = 1;
                highest = fire;
            }

            if (cold > highest)
            {
                type = 2;
                highest = cold;
            }

            if (pois > highest)
            {
                type = 3;
                highest = pois;
            }

            if (nrgy > highest)
            {
                type = 4;
                highest = nrgy;
            }</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\Onslaught.cs

<pre>int phys, fire, cold, pois, nrgy, chaos, direct;
                weapon.GetDamageTypes(null, out phys, out fire, out cold, out pois, out nrgy, out chaos, out direct);

                int highest = phys;
                int type = 0;

                if (fire > phys)
                {
                    type = 1;
                    highest = fire;
                }

                if (cold > highest)
                {
                    type = 2;
                    highest = cold;
                }

                if (pois > highest)
                {
                    type = 3;
                    highest = pois;
                }

                if (nrgy > highest)
                {
                    type = 4;
                    highest = nrgy;
                }</pre>

## Duplicated Code. Size: 214

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\VendorRentalGumps.cs

<pre>this.AddPage(0);

            this.AddImage(0, 0, 0x1F40);
            this.AddImageTiled(20, 37, 300, 308, 0x1F42);
            this.AddImage(20, 325, 0x1F43);

            this.AddImage(35, 8, 0x39);
            this.AddImageTiled(65, 8, 257, 10, 0x3A);
            this.AddImage(290, 8, 0x3B);

            this.AddImageTiled(70, 55, 230, 2, 0x23C5);

            this.AddImage(32, 33, 0x2635);</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>this.AddPage(0);

            this.AddImage(0, 0, 0x1F40);			
            this.AddImageTiled(20, 37, 300, 308, 0x1F42);			
            this.AddImage(20, 325, 0x1F43);			
            this.AddImage(35, 8, 0x39);			
            this.AddImageTiled(65, 8, 257, 10, 0x3A);			
            this.AddImage(290, 8, 0x3B);			
            this.AddImage(32, 33, 0x2635);			
            this.AddImageTiled(70, 55, 230, 2, 0x23C5);</pre>

## Duplicated Code. Size: 214

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\WaterVat.cs

<pre>this.AddComponent(new AddonComponent(0x1558), 0, 0, 0);
            this.AddComponent(new AddonComponent(0x14DE), -1, 1, 0);
            this.AddComponent(new AddonComponent(0x1552), 0, 1, 0);
            this.AddComponent(new AddonComponent(0x14DF), 1, -1, 0);
            this.AddComponent(new AddonComponent(0x1554), 1, 0, 0);
            this.AddComponent(new AddonComponent(0x1559), 1, 1, 0);</pre>

Fragment 2 in file Scripts\Items\Addons\WaterVat.cs

<pre>this.AddComponent(new AddonComponent(0x1558), 0, 0, 0);
            this.AddComponent(new AddonComponent(0x14DE), -1, 1, 0);
            this.AddComponent(new AddonComponent(0x1552), 0, 1, 0);
            this.AddComponent(new AddonComponent(0x14DF), 1, -1, 0);
            this.AddComponent(new AddonComponent(0x1554), 1, 0, 0);
            this.AddComponent(new AddonComponent(0x1559), 1, 1, 0);</pre>

## Duplicated Code. Size: 214

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\Hides.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 2: // Reset from Resource System
                    this.m_Resource = this.DefaultResource;
                    reader.ReadString();
                    break;
                case 1:
                    {
                        this.m_Resource = (CraftResource)reader.ReadInt();
                        break;
                    }
                case 0:
                    {
                        OreInfo info = new OreInfo(reader.ReadInt(), reader.ReadInt(), reader.ReadString());

                        this.m_Resource = CraftResources.GetFromOreInfo(info);
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Resource\Leathers.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 2: // Reset from Resource System
                    this.m_Resource = this.DefaultResource;
                    reader.ReadString();
                    break;
                case 1:
                    {
                        this.m_Resource = (CraftResource)reader.ReadInt();
                        break;
                    }
                case 0:
                    {
                        OreInfo info = new OreInfo(reader.ReadInt(), reader.ReadInt(), reader.ReadString());

                        this.m_Resource = CraftResources.GetFromOreInfo(info);
                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 214

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\HousePlacementTool.cs

<pre>case HousePlacementResult.BadItem:
                case HousePlacementResult.BadLand:
                case HousePlacementResult.BadStatic:
                case HousePlacementResult.BadRegionHidden:
                case HousePlacementResult.NoSurface:
                    {
                        from.SendLocalizedMessage(1043287); // The house could not be created here.  Either something is blocking the house, or the house would not be on valid terrain.
                        break;
                    }
                case HousePlacementResult.BadRegion:
                    {
                        from.SendLocalizedMessage(501265); // Housing cannot be created in this area.
                        break;
                    }
                case HousePlacementResult.BadRegionTemp:
                    {
                        from.SendLocalizedMessage(501270); // Lord British has decreed a 'no build' period, thus you cannot build this house at this time.
                        break;
                    }
                case HousePlacementResult.BadRegionRaffle:
                    {
                        from.SendLocalizedMessage(1150493); // You must have a deed for this plot of land in order to build here.
                        break;
                    }
                case HousePlacementResult.InvalidCastleKeep:
                    {
                        from.SendLocalizedMessage(1061122); // Castles and keeps cannot be created here.
                        break;
                    }
                case HousePlacementResult.NoQueenLoyalty:
                    {
                        from.SendLocalizedMessage(1113707, "10000"); // You must have at lease ~1_MIN~ loyalty to the Gargoyle Queen to place a house in Ter Mur.
                        break;
                    }</pre>

Fragment 2 in file Scripts\Multis\HousePlacementTool.cs

<pre>case HousePlacementResult.BadItem:
                case HousePlacementResult.BadLand:
                case HousePlacementResult.BadStatic:
                case HousePlacementResult.BadRegionHidden:
                case HousePlacementResult.NoSurface:
                    {
                        from.SendLocalizedMessage(1043287); // The house could not be created here.  Either something is blocking the house, or the house would not be on valid terrain.
                        break;
                    }
                case HousePlacementResult.BadRegion:
                    {
                        from.SendLocalizedMessage(501265); // Housing cannot be created in this area.
                        break;
                    }
                case HousePlacementResult.BadRegionTemp:
                    {
                        from.SendLocalizedMessage(501270); //Lord British has decreed a 'no build' period, thus you cannot build this house at this time.
                        break;
                    }
                case HousePlacementResult.BadRegionRaffle:
                    {
                        from.SendLocalizedMessage(1150493); // You must have a deed for this plot of land in order to build here.
                        break;
                    }
                case HousePlacementResult.InvalidCastleKeep:
                    {
                        from.SendLocalizedMessage(1061122); // Castles and keeps cannot be created here.
                        break;
                    }
                case HousePlacementResult.NoQueenLoyalty:
                    {
                        from.SendLocalizedMessage(1113707, "10000"); // You must have at lease ~1_MIN~ loyalty to the Gargoyle Queen to place a house in Ter Mur.
                        break;
                    }</pre>

## Duplicated Code. Size: 214

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>TextRelay tr = info.GetTextEntry(0);

                    if (tr != null)
                    {
                        string text = tr.Text;
                        int bet = Utility.ToInt32(text);
                        int chips = (int)PointsSystem.CasinoData.GetPoints(User);

                        if (bet > 0 && bet <= chips)
                        {
                            PointsSystem.CasinoData.DeductPoints(User, bet, false);

                            Game.CurrentBet = bet;
                            Game.BettingOn = info.ButtonID;

                            Game.BeginRollDice();
                        }
                        else
                        {
                            Game.Stage = GameStage.Error;
                            Refresh();
                        }
                    }

                    break;</pre>

Fragment 2 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>TextRelay tr = info.GetTextEntry(0);

                    if (tr != null)
                    {
                        string text = tr.Text;
                        int bet = Utility.ToInt32(text);
                        int chips = (int)PointsSystem.CasinoData.GetPoints(User);

                        if (bet > 0 && bet <= chips)
                        {
                            PointsSystem.CasinoData.DeductPoints(User, bet, false);

                            Game.CurrentBet = bet;
                            Game.BettingOn = info.ButtonID;

                            Game.BeginRollDice();
                        }
                        else
                        {
                            Game.Stage = GameStage.Error;
                            Refresh();
                        }
                    }
                    break;</pre>

## Duplicated Code. Size: 214

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10117, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075621, LabelColor, false, false);       //Lower Mana Cost
                    yOffset += 1;

                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10118, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075625, LabelColor, false, false);       //Lower Reg Cost
                    yOffset += 1;</pre>

Fragment 2 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10117, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075621, LabelColor, false, false);       //Lower Mana Cost
                    yOffset += 1;

                    AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10118, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075625, LabelColor, false, false);       //Lower Reg Cost
                    yOffset += 1;</pre>

## Duplicated Code. Size: 214

### Duplicated Fragments:

Fragment 1 in file Ultima\Multis.cs

<pre>{
						if (newtiles[i].m_OffsetX == 0 && newtiles[i].m_OffsetY == 0 && newtiles[i].m_ItemID != 0x1 &&
							newtiles[i].m_OffsetZ == 0)
						{
							MultiComponentList.MultiTileEntry centeritem = newtiles[i];
							newtiles.RemoveAt(i); // jep so save it
							for (int j = newtiles.Count - 1; j >= 0; --j) // and remove all invis
							{
								if (newtiles[j].m_ItemID == 0x1)
								{
									newtiles.RemoveAt(j);
								}
							}
							newtiles.Insert(0, centeritem);
							return newtiles;
						}
					}</pre>

Fragment 2 in file Ultima\Multis.cs

<pre>{
				if (newtiles[i].m_OffsetX == 0 && newtiles[i].m_OffsetY == 0 && newtiles[i].m_ItemID != 0x1 &&
					newtiles[i].m_OffsetZ == 0)
				{
					MultiComponentList.MultiTileEntry centeritem = newtiles[i];
					newtiles.RemoveAt(i); // store it
					for (int j = newtiles.Count - 1; j >= 0; --j) // remove all invis
					{
						if (newtiles[j].m_ItemID == 0x1)
						{
							newtiles.RemoveAt(j);
						}
					}
					newtiles.Insert(0, centeritem);
					return newtiles;
				}
			}</pre>

## Duplicated Code. Size: 213

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\GreenThorns.cs

<pre>case 0:
                    {
                        Effects.PlaySound(this.Location, this.Map, 0x106);
                        Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3735, 1, 182, 0xBE3);

                        return TimeSpan.FromSeconds(4.0);
                    }
                case 1:
                    {
                        Effects.PlaySound(this.Location, this.Map, 0x222);

                        return TimeSpan.FromSeconds(4.0);
                    }
                case 2:
                    {
                        Effects.PlaySound(this.Location, this.Map, 0x21F);

                        return TimeSpan.FromSeconds(5.0);
                    }</pre>

Fragment 2 in file Scripts\Items\Consumables\GreenThorns.cs

<pre>case 0:
                    {
                        Effects.PlaySound(this.Location, this.Map, 0x106);
                        Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3735, 1, 182, 0xBE3);

                        return TimeSpan.FromSeconds(4.0);
                    }
                case 1:
                    {
                        Effects.PlaySound(this.Location, this.Map, 0x222);

                        return TimeSpan.FromSeconds(4.0);
                    }
                case 2:
                    {
                        Effects.PlaySound(this.Location, this.Map, 0x21F);

                        return TimeSpan.FromSeconds(5.0);
                    }</pre>

## Duplicated Code. Size: 213

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\LargeBOD.cs

<pre>public virtual void GetRewards(out Item reward, out int gold, out int fame)
        {
            reward = null;
            gold = this.ComputeGold();
            fame = this.ComputeFame();

            List<Item> rewards = this.ComputeRewards(false);

            if (rewards.Count > 0)
            {
                reward = rewards[Utility.Random(rewards.Count)];

                for (int i = 0; i < rewards.Count; ++i)
                {
                    if (rewards[i] != reward)
                        rewards[i].Delete();
                }
            }
        }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallBOD.cs

<pre>public virtual void GetRewards(out Item reward, out int gold, out int fame)
        {
            reward = null;
            gold = this.ComputeGold();
            fame = this.ComputeFame();

            List<Item> rewards = this.ComputeRewards(false);

            if (rewards.Count > 0)
            {
                reward = rewards[Utility.Random(rewards.Count)];

                for (int i = 0; i < rewards.Count; ++i)
                {
                    if (rewards[i] != reward)
                        rewards[i].Delete();
                }
            }
        }</pre>

## Duplicated Code. Size: 213

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Toolbar\Core\ToolbarInfo.cs

<pre>entries.Add(CommandSystem.Prefix + "GMBody");
						entries.Add(CommandSystem.Prefix + "StaffRunebook");
						entries.Add(CommandSystem.Prefix + "SpeedBoost");
						entries.Add(CommandSystem.Prefix + "M Tele");
						entries.Add(CommandSystem.Prefix + "Where");
						entries.Add(CommandSystem.Prefix + "Who");

						for (int j = 0; j < 3; j++)
						{
							entries.Add("-*UNUSED*-");
						}

						entries.Add(CommandSystem.Prefix + "Add");
						entries.Add(CommandSystem.Prefix + "Remove");</pre>

Fragment 2 in file Scripts\Services\Toolbar\Core\ToolbarInfo.cs

<pre>entries.Add(CommandSystem.Prefix + "GMBody");
						entries.Add(CommandSystem.Prefix + "StaffRunebook");
						entries.Add(CommandSystem.Prefix + "SpeedBoost");
						entries.Add(CommandSystem.Prefix + "M Tele");
						entries.Add(CommandSystem.Prefix + "Where");
						entries.Add(CommandSystem.Prefix + "Who");

						for (int j = 0; j < 3; j++)
						{
							entries.Add("-*UNUSED*-");
						}

						entries.Add(CommandSystem.Prefix + "Add");
						entries.Add(CommandSystem.Prefix + "Remove");</pre>

## Duplicated Code. Size: 213

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ViceVsVirtue\ViceVsVirtueSystem.cs

<pre>{
                if (((HeartOfTheLion)item).PhysicalBonus != 5)
                    ((HeartOfTheLion)item).PhysicalBonus = 5;

                if (((HeartOfTheLion)item).FireBonus != 5)
                    ((HeartOfTheLion)item).FireBonus = 5;

                if (((HeartOfTheLion)item).ColdBonus != 5)
                    ((HeartOfTheLion)item).ColdBonus = 5;

                if (((HeartOfTheLion)item).PoisonBonus != 5)
                    ((HeartOfTheLion)item).PoisonBonus = 5;

                if (((HeartOfTheLion)item).EnergyBonus != 5)
                    ((HeartOfTheLion)item).EnergyBonus = 5;
            }</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\ViceVsVirtueSystem.cs

<pre>{
                if (((WizardsCrystalGlasses)item).PhysicalBonus != 5)
                    ((WizardsCrystalGlasses)item).PhysicalBonus = 5;

                if (((WizardsCrystalGlasses)item).FireBonus != 5)
                    ((WizardsCrystalGlasses)item).FireBonus = 5;

                if (((WizardsCrystalGlasses)item).ColdBonus != 5)
                    ((WizardsCrystalGlasses)item).ColdBonus = 5;

                if (((WizardsCrystalGlasses)item).PoisonBonus != 5)
                    ((WizardsCrystalGlasses)item).PoisonBonus = 5;

                if (((WizardsCrystalGlasses)item).EnergyBonus != 5)
                    ((WizardsCrystalGlasses)item).EnergyBonus = 5;
            }</pre>

## Duplicated Code. Size: 212

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\Notoriety.cs

<pre>if ((pmFrom != null && pmFrom.DuelContext != null && pmFrom.DuelContext.Started) || (pmTarg != null && pmTarg.DuelContext != null && pmTarg.DuelContext.Started))
                return false;

            Engines.ConPVP.SafeZone sz = from.Region.GetRegion(typeof(Engines.ConPVP.SafeZone)) as Engines.ConPVP.SafeZone;

            if (sz != null /*&& sz.IsDisabled()*/)
                return false;

            sz = target.Region.GetRegion(typeof(Engines.ConPVP.SafeZone)) as Engines.ConPVP.SafeZone;

            if (sz != null /*&& sz.IsDisabled()*/)
                return false;
            #endregion

            Map map = from.Map;</pre>

Fragment 2 in file Scripts\Misc\Notoriety.cs

<pre>if ((pmFrom != null && pmFrom.DuelContext != null && pmFrom.DuelContext.Started) || (pmTarg != null && pmTarg.DuelContext != null && pmTarg.DuelContext.Started))
                return false;

            Engines.ConPVP.SafeZone sz = from.Region.GetRegion(typeof(Engines.ConPVP.SafeZone)) as Engines.ConPVP.SafeZone;

            if (sz != null /*&& sz.IsDisabled()*/)
                return false;

            sz = target.Region.GetRegion(typeof(Engines.ConPVP.SafeZone)) as Engines.ConPVP.SafeZone;

            if (sz != null /*&& sz.IsDisabled()*/)
                return false;
            #endregion

            Map map = from.Map;</pre>

## Duplicated Code. Size: 212

### Duplicated Fragments:

Fragment 1 in file Ultima\Map.cs

<pre>if (cache == null)
			{
				if (UseDiff)
				{
					if (statics)
					{
						m_Cache = cache = new short[m_Tiles.BlockHeight][][];
					}
					else
					{
						m_Cache_NoStatics = cache = new short[m_Tiles.BlockHeight][][];
					}
				}
				else
				{
					if (statics)
					{
						m_Cache_NoPatch = cache = new short[m_Tiles.BlockHeight][][];
					}
					else
					{
						m_Cache_NoStatics_NoPatch = cache = new short[m_Tiles.BlockHeight][][];
					}
				}
			}

			if (cache[y] == null)
			{
				cache[y] = new short[m_Tiles.BlockWidth][];
			}</pre>

Fragment 2 in file Ultima\Map.cs

<pre>if (cache == null)
			{
				if (UseDiff)
				{
					if (statics)
					{
						m_Cache = cache = new short[m_Tiles.BlockHeight][][];
					}
					else
					{
						m_Cache_NoStatics = cache = new short[m_Tiles.BlockHeight][][];
					}
				}
				else
				{
					if (statics)
					{
						m_Cache_NoPatch = cache = new short[m_Tiles.BlockHeight][][];
					}
					else
					{
						m_Cache_NoStatics_NoPatch = cache = new short[m_Tiles.BlockHeight][][];
					}
				}
			}

			if (cache[y] == null)
			{
				cache[y] = new short[m_Tiles.BlockWidth][];
			}</pre>

## Duplicated Code. Size: 212

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Camps\BrigandCamp.cs

<pre>switch ( Utility.Random(2) )
            {
                case 0:
                    this.m_Prisoner = new Noble();
                    break;
                default:
                    this.m_Prisoner = new SeekerOfAdventure();
                    break;
            }

            //be = (BaseEscortable)m_Prisoner;
            //be.m_Captive = true;

            bc = (BaseCreature)this.m_Prisoner;
            bc.IsPrisoner = true;
            bc.CantWalk = true;

            this.m_Prisoner.YellHue = Utility.RandomList(0x57, 0x67, 0x77, 0x87, 0x117);
            this.AddMobile(this.m_Prisoner, 2, Utility.RandomMinMax(-2, 2), Utility.RandomMinMax(-2, 2), 0);</pre>

Fragment 2 in file Scripts\Multis\Camps\LizardmenCamp.cs

<pre>switch ( Utility.Random(2) )
            {
                case 0:
                    this.m_Prisoner = new Noble();
                    break;
                default:
                    this.m_Prisoner = new SeekerOfAdventure();
                    break;
            }

            //be = (BaseEscortable)m_Prisoner;
            //be.m_Captive = true;

            bc = (BaseCreature)this.m_Prisoner;
            bc.IsPrisoner = true;
            bc.CantWalk = true;

            this.m_Prisoner.YellHue = Utility.RandomList(0x57, 0x67, 0x77, 0x87, 0x117);
            this.AddMobile(this.m_Prisoner, 2, Utility.RandomMinMax(-2, 2), Utility.RandomMinMax(-2, 2), 0);</pre>

Fragment 3 in file Scripts\Multis\Camps\OrcCamp.cs

<pre>switch ( Utility.Random(2) )
            {
                case 0:
                    this.m_Prisoner = new Noble();
                    break;
                default:
                    this.m_Prisoner = new SeekerOfAdventure();
                    break;
            }

            //be = (BaseEscortable)m_Prisoner;
            //be.m_Captive = true;

            bc = (BaseCreature)this.m_Prisoner;
            bc.IsPrisoner = true;
            bc.CantWalk = true;

            this.m_Prisoner.YellHue = Utility.RandomList(0x57, 0x67, 0x77, 0x87, 0x117);
            this.AddMobile(this.m_Prisoner, 2, Utility.RandomMinMax(-2, 2), Utility.RandomMinMax(-2, 2), 0);</pre>

Fragment 4 in file Scripts\Multis\Camps\RatCamp.cs

<pre>switch ( Utility.Random(2) )
            {
                case 0:
                    this.m_Prisoner = new Noble();
                    break;
                default:
                    this.m_Prisoner = new SeekerOfAdventure();
                    break;
            }

            //be = (BaseEscortable)m_Prisoner;
            //be.m_Captive = true;

            bc = (BaseCreature)this.m_Prisoner;
            bc.IsPrisoner = true;
            bc.CantWalk = true;

            this.m_Prisoner.YellHue = Utility.RandomList(0x57, 0x67, 0x77, 0x87, 0x117);
            this.AddMobile(this.m_Prisoner, 2, Utility.RandomMinMax(-2, 2), Utility.RandomMinMax(-2, 2), 0);</pre>

## Duplicated Code. Size: 211

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\PvPWarnTeleporter.cs

<pre>AddImage(0, 0, 0xE10);
            AddImageTiled(0, 14, 15, 200, 0xE13);
            AddImageTiled(380, 14, 14, 200, 0xE15);
            AddImage(0, 201, 0xE16);
            AddImageTiled(15, 201, 370, 16, 0xE17);
            AddImageTiled(15, 0, 370, 16, 0xE11);
            AddImage(380, 0, 0xE12);
            AddImage(380, 201, 0xE18);
            AddImageTiled(15, 15, 365, 190, 0xA40);</pre>

Fragment 2 in file Scripts\Services\InstancedPeerless\ConfirmExitInstanceGump.cs

<pre>AddImage( 0, 0, 0xE10 );
			AddImageTiled( 0, 14, 15, 200, 0xE13 );
			AddImageTiled( 380, 14, 14, 200, 0xE15 );
			AddImage( 0, 201, 0xE16 );
			AddImageTiled( 15, 201, 370, 16, 0xE17 );
			AddImageTiled( 15, 0, 370, 16, 0xE11 );
			AddImage( 380, 0, 0xE12 );
			AddImage( 380, 201, 0xE18 );
			AddImageTiled( 15, 15, 365, 190, 0xA40 );</pre>

## Duplicated Code. Size: 211

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>AddHtmlLocalized(0, 140, 138, 16, 1114514, "#1153383", Yellow, false, false); // Amount of Bet:
            AddHtml(142, 140, 150, 16, Color("#FFFF00", Game.CurrentBet.ToString(CultureInfo.GetCultureInfo("en-US"))), false, false);

            AddHtmlLocalized(0, 160, 138, 16, 1114514, "#1153382", Yellow, false, false);  // Betting On:
            AddHtml(142, 160, 150, 16, Color("#FFFF00", Game.BettingOn.ToString()), false, false);</pre>

Fragment 2 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>AddHtmlLocalized(0, 140, 138, 16, 1114514, "#1153383", Yellow, false, false); // Amount of Bet:
            AddHtml(142, 140, 150, 16, Color("#FFFF00", Game.CurrentBet.ToString(CultureInfo.GetCultureInfo("en-US"))), false, false);

            AddHtmlLocalized(0, 160, 138, 16, 1114514, "#1153382", Yellow, false, false);  // Betting On:
            AddHtml(142, 160, 150, 16, Color("#FFFF00", Game.BettingOn.ToString()), false, false);</pre>

## Duplicated Code. Size: 210

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Quest\EminosKatanaChest.cs

<pre>private void GenerateTreasure()
        {
            for (int i = this.Items.Count - 1; i >= 0; i--)
                this.Items[i].Delete();

            for (int i = 0; i < 75; i++)
            {
                switch ( Utility.Random(3) )
                {
                    case 0:
                        this.DropItem(new GoldBracelet());
                        break;
                    case 1:
                        this.DropItem(new GoldRing());
                        break;
                    case 2:
                        this.DropItem(Loot.RandomGem());
                        break;
                }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Quest\HaochisTreasureChest.cs

<pre>private void GenerateTreasure()
        {
            for (int i = this.Items.Count - 1; i >= 0; i--)
                this.Items[i].Delete();

            for (int i = 0; i < 75; i++)
            {
                switch ( Utility.Random(3) )
                {
                    case 0:
                        this.DropItem(new GoldBracelet());
                        break;
                    case 1:
                        this.DropItem(new GoldRing());
                        break;
                    case 2:
                        this.DropItem(Loot.RandomGem());
                        break;
                }
            }
        }</pre>

## Duplicated Code. Size: 210

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>double drop_probability = 1;
								int hue = 0x3b2;
								if (keywordargs.Length > 1)
								{
									if(!double.TryParse(keywordargs[1], NumberStyles.Any, CultureInfo.InvariantCulture, out drop_probability))
									{ status_str = "Invalid msg probability : " + arglist[1]; no_error = false; }
								}
								if (keywordargs.Length > 2)
								{
									if(!int.TryParse(keywordargs[2], out hue))
									{ status_str = "Invalid MSG hue : " + arglist[1]; no_error = false; }
								}

								if (hue < 0) hue = 0;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>double drop_probability = 1;
								int hue = 0x3b2;
								if (keywordargs.Length > 1)
								{
									if(!double.TryParse(keywordargs[1], NumberStyles.Any, CultureInfo.InvariantCulture, out drop_probability))
									{ status_str = "Invalid msg probability : " + arglist[1]; no_error = false; }
								}
								if (keywordargs.Length > 2)
								{
									if(!int.TryParse(keywordargs[2], out hue))
									{ status_str = "Invalid MSG hue : " + arglist[1]; no_error = false; }
								}

								if (hue < 0) hue = 0;</pre>

## Duplicated Code. Size: 210

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);</pre>

Fragment 3 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);
            this.AddImageTiled(20, 145, 200, 2, 10001);
            this.AddImageTiled(20, 170, 200, 2, 10001);
            this.AddImageTiled(20, 195, 200, 2, 10001);</pre>

## Duplicated Code. Size: 210

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlLevelItem\ItemExperienceGump.cs

<pre>pageindex = index % 10;

					if ( pageindex == 0 )
					{
						if ( index > 0 )
						{
							AddButton(536, 343, 4005, 4007, 0, GumpButtonType.Page, (index / 10) + 1);
                            AddLabel(497, 344, LabelHue, @"Next");
						}

						AddPage( (index / 10) + 1 );

						if ( index > 0 )
						{
							AddButton(301, 343, 4014, 4016, 0, GumpButtonType.Page, index / 10);
                            AddLabel(337, 344, LabelHue, @"Previous");
						}
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlLevelItem\ItemExperienceGump.cs

<pre>pageindex = index % 10;

                        if (pageindex == 0)
                        {
                            if (index > 0)
                            {
                                AddButton(536, 343, 4005, 4007, 0, GumpButtonType.Page, (index / 10) + 1);
                                AddLabel(497, 344, LabelHue, @"Next");
                            }

                            AddPage((index / 10) + 1);

                            if (index > 0)
                            {
                                AddButton(301, 343, 4014, 4016, 0, GumpButtonType.Page, index / 10);
                                AddLabel(337, 344, LabelHue, @"Previous");
                            }
                        }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlLevelItem\ItemExperienceGump.cs

<pre>pageindex = index % 10;

						if (pageindex == 0)
						{
							if (index > 0)
							{
								AddButton(536, 343, 4005, 4007, 0, GumpButtonType.Page, (index / 10) + 1);
								AddLabel(497, 344, LabelHue, @"Next");
							}

							AddPage((index / 10) + 1);

							if (index > 0)
							{
								AddButton(301, 343, 4014, 4016, 0, GumpButtonType.Page, index / 10);
								AddLabel(337, 344, LabelHue, @"Previous");
							}
						}</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlLevelItem\ItemExperienceGump.cs

<pre>pageindex = index % 10;

							if (pageindex == 0)
							{
								if (index > 0)
								{
									AddButton(536, 343, 4005, 4007, 0, GumpButtonType.Page, (index / 10) + 1);
									AddLabel(497, 344, LabelHue, @"Next");
								}

								AddPage((index / 10) + 1);

								if (index > 0)
								{
									AddButton(301, 343, 4014, 4016, 0, GumpButtonType.Page, index / 10);
									AddLabel(337, 344, LabelHue, @"Previous");
								}
							}</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlLevelItem\ItemExperienceGump.cs

<pre>pageindex = index % 10;

						if (pageindex == 0)
						{
							if (index > 0)
							{
								AddButton(536, 343, 4005, 4007, 0, GumpButtonType.Page, (index / 10) + 1);
								AddLabel(497, 344, LabelHue, @"Next");
							}

							AddPage((index / 10) + 1);

							if (index > 0)
							{
								AddButton(301, 343, 4014, 4016, 0, GumpButtonType.Page, index / 10);
								AddLabel(337, 344, LabelHue, @"Previous");
							}
						}</pre>

## Duplicated Code. Size: 209

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>Point3D loc = m.Location;

			int hue = m.Hue;

			if (m.SolidHueOverride >= 0)
			{
				hue = m.SolidHueOverride;
			}

			m_Stream.Write(m.Serial);
			m_Stream.Write((short)m.Body);
			m_Stream.Write((short)loc.m_X);
			m_Stream.Write((short)loc.m_Y);
			m_Stream.Write((sbyte)loc.m_Z);
			m_Stream.Write((byte)m.Direction);
			m_Stream.Write((short)hue);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>Point3D loc = m.Location;

			int hue = m.Hue;

			if (m.SolidHueOverride >= 0)
			{
				hue = m.SolidHueOverride;
			}

			m_Stream.Write(m.Serial);
			m_Stream.Write((short)m.Body);
			m_Stream.Write((short)loc.m_X);
			m_Stream.Write((short)loc.m_Y);
			m_Stream.Write((sbyte)loc.m_Z);
			m_Stream.Write((byte)m.Direction);
			m_Stream.Write((short)hue);</pre>

## Duplicated Code. Size: 208

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Docs.cs

<pre>sbod.Type = typeof(SkullCap);
				sbod.Material = BulkMaterialType.None;
				DocumentTailorBOD(html, sbod.ComputeRewards(true), "20", sbod.Material, sbod.Type);

				sbod.Type = typeof(LeatherCap);
				for (var mat = BulkMaterialType.None; mat <= BulkMaterialType.Barbed; ++mat)
				{
					if (mat >= BulkMaterialType.DullCopper && mat <= BulkMaterialType.Valorite)
					{
						continue;
					}

					sbod.Material = mat;
					DocumentTailorBOD(html, sbod.ComputeRewards(true), "20", sbod.Material, sbod.Type);
				}</pre>

Fragment 2 in file Scripts\Commands\Docs.cs

<pre>sbod.Type = typeof(SkullCap);
				sbod.Material = BulkMaterialType.None;
				DocumentTailorBOD(html, sbod.ComputeRewards(true), "20", sbod.Material, sbod.Type);

				sbod.Type = typeof(LeatherCap);
				for (var mat = BulkMaterialType.None; mat <= BulkMaterialType.Barbed; ++mat)
				{
					if (mat >= BulkMaterialType.DullCopper && mat <= BulkMaterialType.Valorite)
					{
						continue;
					}

					sbod.Material = mat;
					DocumentTailorBOD(html, sbod.ComputeRewards(true), "20", sbod.Material, sbod.Type);
				}</pre>

## Duplicated Code. Size: 208

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SOS.cs

<pre>for (int j = 1, offset = 5; valid && j <= 5; ++j, offset += 5)
                {
                    if (!ValidateDeepWater(map, x + offset, y + offset))
                        valid = false;
                    else if (!ValidateDeepWater(map, x + offset, y - offset))
                        valid = false;
                    else if (!ValidateDeepWater(map, x - offset, y + offset))
                        valid = false;
                    else if (!ValidateDeepWater(map, x - offset, y - offset))
                        valid = false;
                }</pre>

Fragment 2 in file Scripts\Items\Consumables\SpecialFishingNet.cs

<pre>for (int j = 1, offset = 5; valid && j <= 5; ++j, offset += 5)
            {
                if (!ValidateDeepWater(map, x + offset, y + offset))
                    valid = false;
                else if (!ValidateDeepWater(map, x + offset, y - offset))
                    valid = false;
                else if (!ValidateDeepWater(map, x - offset, y + offset))
                    valid = false;
                else if (!ValidateDeepWater(map, x - offset, y - offset))
                    valid = false;
            }</pre>

## Duplicated Code. Size: 208

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseEvilCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 30 );
			SetResistance( ResistanceType.Fire, 25 );
			SetResistance( ResistanceType.Cold, 40, 50 );
			SetResistance( ResistanceType.Poison, 30 );
			SetResistance( ResistanceType.Energy, 30 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );

			Fame = GetFame;
			Karma = GetKarmaEvil;
            Power = powerLevel;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DespiseEvilCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 30 );
			SetResistance( ResistanceType.Fire, 25 );
			SetResistance( ResistanceType.Cold, 40, 50 );
			SetResistance( ResistanceType.Poison, 30 );
			SetResistance( ResistanceType.Energy, 30 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );

			Fame = GetFame;
			Karma = GetKarmaEvil;
            Power = powerLevel;</pre>

## Duplicated Code. Size: 208

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseEvilCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 40, 50 );
			SetResistance( ResistanceType.Fire, 30, 40 );
			SetResistance( ResistanceType.Cold, 20, 30 );
			SetResistance( ResistanceType.Poison, 30, 40 );
			SetResistance( ResistanceType.Energy, 20, 30 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );

			Fame = GetFame;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DespiseGoodCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 40, 50 );
			SetResistance( ResistanceType.Fire, 30, 40 );
			SetResistance( ResistanceType.Cold, 20, 30 );
			SetResistance( ResistanceType.Poison, 30, 40 );
			SetResistance( ResistanceType.Energy, 20, 30 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );

			Fame = GetFame;</pre>

## Duplicated Code. Size: 208

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseEvilCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 40, 50 );
			SetResistance( ResistanceType.Fire, 20, 30 );
			SetResistance( ResistanceType.Cold, 20, 30 );
			SetResistance( ResistanceType.Poison, 30, 40 );
			SetResistance( ResistanceType.Energy, 20, 30 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );

			Fame = GetFame;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DespiseGoodCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 40, 50 );
			SetResistance( ResistanceType.Fire, 20, 30 );
			SetResistance( ResistanceType.Cold, 20, 30 );
			SetResistance( ResistanceType.Poison, 30, 40 );
			SetResistance( ResistanceType.Energy, 20, 30 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );

			Fame = GetFame;</pre>

## Duplicated Code. Size: 208

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseEvilCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 10, 20 );
			SetResistance( ResistanceType.Fire, 20, 30 );
			SetResistance( ResistanceType.Cold, 40, 50 );
			SetResistance( ResistanceType.Poison, 20, 30 );
			SetResistance( ResistanceType.Energy, 30, 40 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );

			Fame = GetFame;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DespiseGoodCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 10, 20 );
			SetResistance( ResistanceType.Fire, 20, 30 );
			SetResistance( ResistanceType.Cold, 40, 50 );
			SetResistance( ResistanceType.Poison, 20, 30 );
			SetResistance( ResistanceType.Energy, 30, 40 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );

			Fame = GetFame;</pre>

## Duplicated Code. Size: 208

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseGoodCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 30 );
			SetResistance( ResistanceType.Fire, 25 );
			SetResistance( ResistanceType.Cold, 40, 50 );
			SetResistance( ResistanceType.Poison, 30 );
			SetResistance( ResistanceType.Energy, 30 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );

			Fame = GetFame;
			Karma = GetKarmaGood;
            Power = powerLevel;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DespiseGoodCreatures.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 30 );
			SetResistance( ResistanceType.Fire, 25 );
			SetResistance( ResistanceType.Cold, 40, 50 );
			SetResistance( ResistanceType.Poison, 30 );
			SetResistance( ResistanceType.Energy, 30 );

			SetSkill( SkillName.MagicResist, SkillStart );
			SetSkill( SkillName.Tactics, SkillStart );
			SetSkill( SkillName.Wrestling, SkillStart );
			SetSkill( SkillName.Anatomy, SkillStart );

			Fame = GetFame;
			Karma = GetKarmaGood;
            Power = powerLevel;</pre>

## Duplicated Code. Size: 208

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>x = int.Parse(args[2]);
										y = int.Parse(args[3]);
										z = int.Parse(args[4]);
										map = int.Parse(args[5]);
										mindelay = double.Parse(args[6]);
										maxdelay = double.Parse(args[7]);
										homerange = int.Parse(args[8]);
										spawnrange = int.Parse(args[9]);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>x = int.Parse(args[2]);
											y = int.Parse(args[3]);
											z = int.Parse(args[4]);
											map = int.Parse(args[5]);
											mindelay = double.Parse(args[6]);
											maxdelay = double.Parse(args[7]);
											homerange = int.Parse(args[8]);
											spawnrange = int.Parse(args[9]);</pre>

## Duplicated Code. Size: 208

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGauntlet.cs

<pre>base.Serialize( writer );

            writer.Write( (int) 0 ); // version

            writer.Write(m_Challenger);
            writer.Write(m_GameLocked);
            writer.Write(m_GameInProgress);
            writer.Write(m_TotalPurse);
            writer.Write(m_EntryFee);
            writer.Write(m_ArenaSize);
            writer.Write(m_TargetScore);
            writer.Write(m_MatchLength);

            if(GameTimer != null && GameTimer.Running)
            {
                writer.Write(DateTime.UtcNow - m_MatchStart);
            } else
            {
                writer.Write(TimeSpan.Zero);
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGauntlet.cs

<pre>base.Serialize( writer );

            writer.Write( (int) 0 ); // version

            writer.Write(m_Challenger);
            writer.Write(m_GameLocked);
            writer.Write(m_GameInProgress);
            writer.Write(m_TotalPurse);
            writer.Write(m_EntryFee);
            writer.Write(m_ArenaSize);
            writer.Write(m_TargetScore);
            writer.Write(m_MatchLength);

            if(GameTimer != null && GameTimer.Running)
            {
                writer.Write(DateTime.UtcNow - m_MatchStart);
            } else
            {
                writer.Write(TimeSpan.Zero);
            }</pre>

## Duplicated Code. Size: 208

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketReader.cs

<pre>{
			int bound = m_Index + (fixedLength << 1);
			int end = bound;

			if (bound > m_Size)
			{
				bound = m_Size;
			}

			StringBuilder sb = new StringBuilder();

			int c;

			while ((m_Index + 1) < bound && (c = (m_Data[m_Index++] | (m_Data[m_Index++] << 8))) != 0)
			{
				if (IsSafeChar(c))
				{
					sb.Append((char)c);
				}
			}

			m_Index = end;

			return sb.ToString();
		}</pre>

Fragment 2 in file Server\Network\PacketReader.cs

<pre>{
			int bound = m_Index + (fixedLength << 1);
			int end = bound;

			if (bound > m_Size)
			{
				bound = m_Size;
			}

			StringBuilder sb = new StringBuilder();

			int c;

			while ((m_Index + 1) < bound && (c = ((m_Data[m_Index++] << 8) | m_Data[m_Index++])) != 0)
			{
				if (IsSafeChar(c))
				{
					sb.Append((char)c);
				}
			}

			m_Index = end;

			return sb.ToString();
		}</pre>

## Duplicated Code. Size: 208

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\SQ1Gump.cs

<pre>this.AddPage(0);
            this.AddImageTiled(54, 33, 369, 400, 2624);
            this.AddAlphaRegion(54, 33, 369, 400);

            this.AddImageTiled(416, 39, 44, 389, 203);
            //--------------------------------------Window size bar--------------------------------------------

            this.AddImage(97, 49, 9005);
            this.AddImageTiled(58, 39, 29, 390, 10460);
            this.AddImageTiled(412, 37, 31, 389, 10460);
            this.AddLabel(140, 60, 1153, "Quest Offer");</pre>

Fragment 2 in file Scripts\Gumps\SQ5Gump.cs

<pre>this.AddPage(0);
            this.AddImageTiled(54, 33, 369, 400, 2624);
            this.AddAlphaRegion(54, 33, 369, 400);

            this.AddImageTiled(416, 39, 44, 389, 203);
            //--------------------------------------Window size bar--------------------------------------------

            this.AddImage(97, 49, 9005);
            this.AddImageTiled(58, 39, 29, 390, 10460);
            this.AddImageTiled(412, 37, 31, 389, 10460);
            this.AddLabel(140, 60, 1153, "Quest Offer");</pre>

Fragment 3 in file Scripts\Gumps\SQGump.cs

<pre>this.AddPage(0);
            this.AddImageTiled(54, 33, 369, 400, 2624);
            this.AddAlphaRegion(54, 33, 369, 400);

            this.AddImageTiled(416, 39, 44, 389, 203);
            //--------------------------------------Window size bar--------------------------------------------

            this.AddImage(97, 49, 9005);
            this.AddImageTiled(58, 39, 29, 390, 10460);
            this.AddImageTiled(412, 37, 31, 389, 10460);
            this.AddLabel(140, 60, 1153, "Quest Offer");</pre>

## Duplicated Code. Size: 207

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\BagOfIngots.cs

<pre>this.DropItem(new DullCopperIngot(amount)); 
            this.DropItem(new ShadowIronIngot(amount)); 
            this.DropItem(new CopperIngot(amount)); 
            this.DropItem(new BronzeIngot(amount)); 
            this.DropItem(new GoldIngot(amount)); 
            this.DropItem(new AgapiteIngot(amount)); 
            this.DropItem(new VeriteIngot(amount)); 
            this.DropItem(new ValoriteIngot(amount)); 
            this.DropItem(new IronIngot(amount));</pre>

Fragment 2 in file Scripts\Items\Containers\SmithBag.cs

<pre>this.DropItem(new DullCopperIngot(amount)); 
            this.DropItem(new ShadowIronIngot(amount)); 
            this.DropItem(new CopperIngot(amount)); 
            this.DropItem(new BronzeIngot(amount)); 
            this.DropItem(new GoldIngot(amount)); 
            this.DropItem(new AgapiteIngot(amount)); 
            this.DropItem(new VeriteIngot(amount)); 
            this.DropItem(new ValoriteIngot(amount)); 
            this.DropItem(new IronIngot(amount));</pre>

## Duplicated Code. Size: 207

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\BaseRunicTool.cs

<pre>new SkillName[]
        {
            SkillName.Swords,
            SkillName.Fencing,
            SkillName.Macing,
            SkillName.Archery,
            SkillName.Wrestling,
            SkillName.Parry,
            SkillName.Tactics,
            SkillName.Anatomy,
            SkillName.Healing,
            SkillName.Magery,
            SkillName.Meditation,
            SkillName.EvalInt,
            SkillName.MagicResist,
            SkillName.AnimalTaming,
            SkillName.AnimalLore,
            SkillName.Veterinary,
            SkillName.Musicianship,
            SkillName.Provocation,
            SkillName.Discordance,
            SkillName.Peacemaking,
            SkillName.Chivalry,
            SkillName.Focus,
            SkillName.Necromancy,
            SkillName.Stealing,
            SkillName.Stealth,
            SkillName.SpiritSpeak,
            SkillName.Bushido,
            SkillName.Ninjitsu
        }</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new SkillName[]
        {
            SkillName.Swords,
            SkillName.Fencing,
            SkillName.Macing,
            SkillName.Archery,
            SkillName.Wrestling,
            SkillName.Parry,
            SkillName.Tactics,
            SkillName.Anatomy,
            SkillName.Healing,
            SkillName.Magery,
            SkillName.Meditation,
            SkillName.EvalInt,
            SkillName.MagicResist,
            SkillName.AnimalTaming,
            SkillName.AnimalLore,
            SkillName.Veterinary,
            SkillName.Musicianship,
            SkillName.Provocation,
            SkillName.Discordance,
            SkillName.Peacemaking,
            SkillName.Chivalry,
            SkillName.Focus,
            SkillName.Necromancy,
            SkillName.Stealing,
            SkillName.Stealth,
            SkillName.SpiritSpeak,
            SkillName.Bushido,
            SkillName.Ninjitsu
        }</pre>

## Duplicated Code. Size: 207

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGauntlet.cs

<pre>public override void OnPlayerKilled(Mobile killer, Mobile killed)
        {
            if(killed == null) return;

            if(AutoRes)
            {
                // prepare the autores callback
                    Timer.DelayCall( RespawnTime, new TimerStateCallback( XmlPoints.AutoRes_Callback ),
                    new object[]{ killed, true } );
            }

            // drop the ball if they were carrying it
            if(m_DeathBall != null && m_DeathBall.RootParent is Corpse)
            {
                Mobile owner = ((Corpse)(m_DeathBall.RootParent)).Owner;
                if(owner == killed)
                {
                    GameBroadcast(100412, killed.Name);  // "{0} has dropped the ball!"
                    m_DeathBall.MoveToWorld(owner.Location, owner.Map);
                }
            }
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGauntlet.cs

<pre>public override void OnPlayerKilled(Mobile killer, Mobile killed)
        {
            if(killed == null) return;

            if(AutoRes)
            {
                // prepare the autores callback
                    Timer.DelayCall( RespawnTime, new TimerStateCallback( XmlPoints.AutoRes_Callback ),
                    new object[]{ killed, true } );
            }

            // drop the ball if they were carrying it
            if(m_DeathBall != null && m_DeathBall.RootParent is Corpse)
            {
                Mobile owner = ((Corpse)(m_DeathBall.RootParent)).Owner;
                if(owner == killed)
                {
                    GameBroadcast(100412, killed.Name);  // "{0} has dropped the ball!"
                    m_DeathBall.MoveToWorld(owner.Location, owner.Map);
                }
            }
        }</pre>

## Duplicated Code. Size: 207

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>public List<BaseModule> SearchModules(string search)
        {
            var keywords = search.ToLower().Split(' ');
            var modules = new List<BaseModule>();

            foreach (BaseModule mod in Modules)
            {
                bool match = true;
                string name = mod.Name.ToLower();

                foreach (string keyword in keywords)
                {
                    if (name.IndexOf(keyword, StringComparison.Ordinal) == -1)
                    {
                        match = false;
                    }
                }

                if (match)
                {
                    modules.Add(mod);
                }
            }

            return modules;
        }</pre>

Fragment 2 in file Server\Mobile.cs

<pre>public List<BaseModule> SearchModules(string search)
		{
			var keywords = search.ToLower().Split(' ');
			var modules = new List<BaseModule>();

			foreach (BaseModule mod in Modules)
			{
				bool match = true;
				string name = mod.Name.ToLower();

				foreach (string keyword in keywords)
				{
					if (name.IndexOf(keyword, StringComparison.Ordinal) == -1)
					{
						match = false;
					}
				}

				if (match)
				{
					modules.Add(mod);
				}
			}

			return modules;
		}</pre>

## Duplicated Code. Size: 206

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SpecialBeardDye.cs

<pre>this.AddPage(i + 1);

                for (int j = 0; j < e.HueCount; ++j)
                {
                    this.AddLabel(328 + ((j / 16) * 80), 102 + ((j % 16) * 17), e.HueStart + j - 1, "*****");
                    this.AddRadio(310 + ((j / 16) * 80), 102 + ((j % 16) * 17), 210, 211, false, (i * 100) + j);
                }</pre>

Fragment 2 in file Scripts\Items\Consumables\SpecialHairDye.cs

<pre>this.AddPage(i + 1);

                for (int j = 0; j < e.HueCount; ++j)
                {
                    this.AddLabel(328 + ((j / 16) * 80), 102 + ((j % 16) * 17), e.HueStart + j - 1, "*****");
                    this.AddRadio(310 + ((j / 16) * 80), 102 + ((j % 16) * 17), 210, 211, false, (i * 100) + j);
                }</pre>

## Duplicated Code. Size: 206

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BlackSolenQueen.cs

<pre>public override void OnDamage(int amount, Mobile from, bool willKill)
        {
            SolenHelper.OnBlackDamage(from);

            if (!willKill)
            {
                if (!this.BurstSac)
                {
                    if (this.Hits < 50)
                    {
                        this.PublicOverheadMessage(MessageType.Regular, 0x3B2, true, "* The solen's acid sac is burst open! *");
                        this.m_BurstSac = true;
                    }
                }
                else if (from != null && from != this && this.InRange(from, 1))
                {
                    this.SpillAcid(from, 1);
                }
            }

            base.OnDamage(amount, from, willKill);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BlackSolenWarrior.cs

<pre>public override void OnDamage(int amount, Mobile from, bool willKill)
        {
            SolenHelper.OnBlackDamage(from);

            if (!willKill)
            {
                if (!this.BurstSac)
                {
                    if (this.Hits < 50)
                    {
                        this.PublicOverheadMessage(MessageType.Regular, 0x3B2, true, "* The solen's acid sac is burst open! *");
                        this.m_BurstSac = true;
                    }
                }
                else if (from != null && from != this && this.InRange(from, 1))
                {
                    this.SpillAcid(from, 1);
                }
            }

            base.OnDamage(amount, from, willKill);
        }</pre>

## Duplicated Code. Size: 206

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\RedSolenQueen.cs

<pre>public override void OnDamage(int amount, Mobile from, bool willKill)
        {
            SolenHelper.OnRedDamage(from);

            if (!willKill)
            {
                if (!this.BurstSac)
                {
                    if (this.Hits < 50)
                    {
                        this.PublicOverheadMessage(MessageType.Regular, 0x3B2, true, "* The solen's acid sac is burst open! *");
                        this.m_BurstSac = true;
                    }
                }
                else if (from != null && from != this && this.InRange(from, 1))
                {
                    this.SpillAcid(from, 1);
                }
            }

            base.OnDamage(amount, from, willKill);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RedSolenWarrior.cs

<pre>public override void OnDamage(int amount, Mobile from, bool willKill)
        {
            SolenHelper.OnRedDamage(from);

            if (!willKill)
            {
                if (!this.BurstSac)
                {
                    if (this.Hits < 50)
                    {
                        this.PublicOverheadMessage(MessageType.Regular, 0x3B2, true, "* The solen's acid sac is burst open! *");
                        this.m_BurstSac = true;
                    }
                }
                else if (from != null && from != this && this.InRange(from, 1))
                {
                    this.SpillAcid(from, 1);
                }
            }

            base.OnDamage(amount, from, willKill);
        }</pre>

## Duplicated Code. Size: 206

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Items\WoodenKeyBarrel.cs

<pre>int z = n_Map.GetAverageZ(n_X, n_Y);
            bool canFit = n_Map.CanFit(n_X, n_Y, z, 6, false, false);

            for (int i = -3; !canFit && i <= 3; ++i)
            {
                canFit = n_Map.CanFit(n_X, n_Y, z + i, 6, false, false);

                if (canFit)
                    z += i;
            }

            if (!canFit)
                return;

            Item g = n_SourceItem;

            // Explosion
            if (g.Deleted || g == null)
                return;</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\WoodenKeyBarrel.cs

<pre>int z = n_Map.GetAverageZ(n_X, n_Y);
            bool canFit = n_Map.CanFit(n_X, n_Y, z, 6, false, false);

            for (int i = -3; !canFit && i <= 3; ++i)
            {
                canFit = n_Map.CanFit(n_X, n_Y, z + i, 6, false, false);

                if (canFit)
                    z += i;
            }

            if (!canFit)
                return;

            Item g = n_SourceItem;

            //Poisonous Vapor
            if (g.Deleted || g == null)
                return;</pre>

## Duplicated Code. Size: 206

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketHandlers.cs

<pre>if (s.IsMobile)
				{
					Mobile m = World.FindMobile(s);

					if (m != null && from.CanSee(m) && Utility.InUpdateRange(from, m))
					{
						m.SendPropertiesTo(from);
					}
				}
				else if (s.IsItem)
				{
					Item item = World.FindItem(s);

					if (item != null && !item.Deleted && from.CanSee(item) &&
						Utility.InUpdateRange(from.Location, item.GetWorldLocation()))
					{
						item.SendPropertiesTo(from);
					}
				}</pre>

Fragment 2 in file Server\Network\PacketHandlers.cs

<pre>if (s.IsMobile)
			{
				Mobile m = World.FindMobile(s);

				if (m != null && from.CanSee(m) && Utility.InUpdateRange(from, m))
				{
					m.SendPropertiesTo(from);
				}
			}
			else if (s.IsItem)
			{
				Item item = World.FindItem(s);

				if (item != null && !item.Deleted && from.CanSee(item) &&
					Utility.InUpdateRange(from.Location, item.GetWorldLocation()))
				{
					item.SendPropertiesTo(from);
				}
			}</pre>

## Duplicated Code. Size: 205

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Implementors\MultiCommandImplementor.cs

<pre>switch ( command.ObjectTypes )
            {
                case ObjectTypes.Both:
                    {
                        if (!(targeted is Item) && !(targeted is Mobile))
                        {
                            from.SendMessage("This command does not work on that.");
                            return;
                        }

                        break;
                    }
                case ObjectTypes.Items:
                    {
                        if (!(targeted is Item))
                        {
                            from.SendMessage("This command only works on items.");
                            return;
                        }

                        break;
                    }
                case ObjectTypes.Mobiles:
                    {
                        if (!(targeted is Mobile))
                        {
                            from.SendMessage("This command only works on mobiles.");
                            return;
                        }

                        break;
                    }
            }

            this.RunCommand(from, targeted, command, args);</pre>

Fragment 2 in file Scripts\Commands\Generic\Implementors\SingleCommandImplementor.cs

<pre>switch ( command.ObjectTypes )
            {
                case ObjectTypes.Both:
                    {
                        if (!(targeted is Item) && !(targeted is Mobile))
                        {
                            from.SendMessage("This command does not work on that.");
                            return;
                        }

                        break;
                    }
                case ObjectTypes.Items:
                    {
                        if (!(targeted is Item))
                        {
                            from.SendMessage("This command only works on items.");
                            return;
                        }

                        break;
                    }
                case ObjectTypes.Mobiles:
                    {
                        if (!(targeted is Mobile))
                        {
                            from.SendMessage("This command only works on mobiles.");
                            return;
                        }

                        break;
                    }
            }

            this.RunCommand(from, targeted, command, args);</pre>

## Duplicated Code. Size: 205

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\MailboxEastAddon.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.Owner == null)// && IsChildOf(from.Backpack))
            {
                this.Owner = from;
                from.SendMessage("You now own this mailbox!");
                base.OnDoubleClick(from);
            }
            else if (this.Owner == null)
            {
                from.SendMessage("You can only set your self as owner of this mailbox if it is in your house!");
            }
            else if (!this.IsSecure && this.IsAccessibleTo(from))
                base.OnDoubleClick(from);
            else if (this.Owner == from || from.AccessLevel > this.Owner.AccessLevel)
                base.OnDoubleClick(from);
            else
                from.SendMessage("This is not your mailbox, you must be the owner to open it!");
        }</pre>

Fragment 2 in file Scripts\Items\Addons\MailboxSouthAddon.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.Owner == null)// && IsChildOf(from.Backpack))
            {
                this.Owner = from;
                from.SendMessage("You now own this mailbox!");
                base.OnDoubleClick(from);
            }
            else if (this.Owner == null)
            {
                from.SendMessage("You can only set your self as owner of this mailbox if it is in your house!");
            }
            else if (!this.IsSecure && this.IsAccessibleTo(from))
                base.OnDoubleClick(from);
            else if (this.Owner == from || from.AccessLevel > this.Owner.AccessLevel)
                base.OnDoubleClick(from);
            else
                from.SendMessage("This is not your mailbox, you must be the owner to open it!");
        }</pre>

## Duplicated Code. Size: 205

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestGumps.cs

<pre>if(args[1].StartsWith("0x"))
								{
									int.TryParse(args[1].Substring(2), NumberStyles.HexNumber, CultureInfo.InvariantCulture, out gumpid);
								} 
								else
								{
									int.TryParse(args[1], out gumpid);
								}
								int.TryParse(args[2], out gx);
								int.TryParse(args[3], out gy);

								if(args.Length > 4)
								{
									int.TryParse(args[4], out color);
								}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestGumps.cs

<pre>if(args[1].StartsWith("0x"))
								{
									int.TryParse(args[1].Substring(2), NumberStyles.HexNumber, CultureInfo.InvariantCulture, out gumpid);
								} 
								else
								{
									int.TryParse(args[1], out gumpid);
								}
								int.TryParse(args[2], out gx);
								int.TryParse(args[3], out gy);

								if(args.Length > 4)
								{
									int.TryParse(args[4], out color);
								}</pre>

## Duplicated Code. Size: 204

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddCheck(182, 48, 210, 211, false, 109);
            this.AddCheck(182, 73, 210, 211, false, 110);
            this.AddCheck(182, 98, 210, 211, false, 111);
            this.AddCheck(182, 123, 210, 211, false, 112);
            this.AddCheck(182, 148, 210, 211, false, 113);
            this.AddCheck(182, 173, 210, 211, false, 114);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddCheck(182, 48, 210, 211, false, 109);
            this.AddCheck(182, 73, 210, 211, false, 110);
            this.AddCheck(182, 98, 210, 211, false, 111);
            this.AddCheck(182, 123, 210, 211, false, 112);
            this.AddCheck(182, 148, 210, 211, false, 113);
            this.AddCheck(182, 173, 210, 211, false, 114);</pre>

## Duplicated Code. Size: 204

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>public override void InitOutfit()
        {
            if (this.Female)
                this.AddItem(new PlainDress());
            else
                this.AddItem(new Shirt(this.GetRandomHue()));

            int lowHue = this.GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new Boots(lowHue));
            else
                this.AddItem(new Shoes(lowHue));

            Utility.AssignRandomHair(this);

            this.PackGold(200, 250);
        }</pre>

Fragment 2 in file Scripts\Quests\Escortables.cs

<pre>public override void InitOutfit()
        {
            if (this.Female)
                this.AddItem(new PlainDress());
            else
                this.AddItem(new Shirt(this.GetRandomHue()));

            int lowHue = this.GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new Boots(lowHue));
            else
                this.AddItem(new Shoes(lowHue));

            Utility.AssignRandomHair(this);

            this.PackGold(200, 250);
        }</pre>

## Duplicated Code. Size: 204

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ViceVsVirtue\Items\VvVAltar.cs

<pre>AddComponent(new AddonComponent(_Tiles[1][virtue]), -2, 1, 5);
            AddComponent(new AddonComponent(_Tiles[1][virtue] + 1), -1, 1, 5);
            AddComponent(new AddonComponent(_Tiles[1][virtue] + 2), -2, 2, 5);
            AddComponent(new AddonComponent(_Tiles[1][virtue] + 3), -1, 2, 5);</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\Items\VvVAltar.cs

<pre>AddComponent(new AddonComponent(_Tiles[1][virtue]), 1, -2, 5);
            AddComponent(new AddonComponent(_Tiles[1][virtue] + 1), 2, -2, 5);
            AddComponent(new AddonComponent(_Tiles[1][virtue] + 2), 1, -1, 5);
            AddComponent(new AddonComponent(_Tiles[1][virtue] + 3), 2, -1, 5);</pre>

## Duplicated Code. Size: 204

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBPlayerBarkeeper.cs

<pre>this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Ale, 7, 20, 0x99F, 0));
                this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Wine, 7, 20, 0x9C7, 0));
                this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Liquor, 7, 20, 0x99B, 0));
                this.Add(new BeverageBuyInfo(typeof(Jug), BeverageType.Cider, 13, 20, 0x9C8, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBProvisioner.cs

<pre>this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Ale, 7, 20, 0x99F, 0));
                this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Wine, 7, 20, 0x9C7, 0));
                this.Add(new BeverageBuyInfo(typeof(BeverageBottle), BeverageType.Liquor, 7, 20, 0x99B, 0));
                this.Add(new BeverageBuyInfo(typeof(Jug), BeverageType.Cider, 13, 20, 0x9C8, 0));</pre>

## Duplicated Code. Size: 204

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\RunebookGump.cs

<pre>int xLong = 0, yLat = 0;
                                    int xMins = 0, yMins = 0;
                                    bool xEast = false, ySouth = false;

                                    if (Sextant.Format(e.Location, e.Map, ref xLong, ref yLat, ref xMins, ref yMins, ref xEast, ref ySouth))
                                    {
                                        string location = String.Format("{0}° {1}'{2}, {3}° {4}'{5}", yLat, yMins, ySouth ? "S" : "N", xLong, xMins, xEast ? "E" : "W");
                                        from.SendMessage(location);
                                    }

                                    this.m_Book.OnTravel();</pre>

Fragment 2 in file Scripts\Gumps\RunebookGump.cs

<pre>int xLong = 0, yLat = 0;
                                    int xMins = 0, yMins = 0;
                                    bool xEast = false, ySouth = false;

                                    if (Sextant.Format(e.Location, e.Map, ref xLong, ref yLat, ref xMins, ref yMins, ref xEast, ref ySouth))
                                    {
                                        string location = String.Format("{0}° {1}'{2}, {3}° {4}'{5}", yLat, yMins, ySouth ? "S" : "N", xLong, xMins, xEast ? "E" : "W");
                                        from.SendMessage(location);
                                    }

                                    this.m_Book.OnTravel();</pre>

Fragment 3 in file Scripts\Gumps\RunebookGump.cs

<pre>int xLong = 0, yLat = 0;
                                    int xMins = 0, yMins = 0;
                                    bool xEast = false, ySouth = false;

                                    if (Sextant.Format(e.Location, e.Map, ref xLong, ref yLat, ref xMins, ref yMins, ref xEast, ref ySouth))
                                    {
                                        string location = String.Format("{0}° {1}'{2}, {3}° {4}'{5}", yLat, yMins, ySouth ? "S" : "N", xLong, xMins, xEast ? "E" : "W");
                                        from.SendMessage(location);
                                    }

                                    this.m_Book.OnTravel();</pre>

Fragment 4 in file Scripts\Gumps\RunebookGump.cs

<pre>int xLong = 0, yLat = 0;
                                        int xMins = 0, yMins = 0;
                                        bool xEast = false, ySouth = false;

                                        if (Sextant.Format(e.Location, e.Map, ref xLong, ref yLat, ref xMins, ref yMins, ref xEast, ref ySouth))
                                        {
                                            string location = String.Format("{0}° {1}'{2}, {3}° {4}'{5}", yLat, yMins, ySouth ? "S" : "N", xLong, xMins, xEast ? "E" : "W");
                                            from.SendMessage(location);
                                        }

                                        this.m_Book.OnTravel();</pre>

## Duplicated Code. Size: 203

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>Point3D itemloc;
					if (item.Parent != null)
					{
						if (item.RootParent is Mobile)
						{
							itemloc = ((Mobile)(item.RootParent)).Location;
						}
						else
							if (item.RootParent is Container)
							{
								itemloc = ((Container)(item.RootParent)).Location;
							}
							else
							{
								return;
							}
					}
					else
					{
						itemloc = item.Location;
					}
					if (item == null || item.Deleted || item.Map == null || item.Map == Map.Internal) return;
					m_From.Location = itemloc;
					m_From.Map = item.Map;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>Point3D itemloc;
									if (item.Parent != null)
									{
										if (item.RootParent is Mobile)
										{
											itemloc = ((Mobile)(item.RootParent)).Location;
										}
										else
											if (item.RootParent is Container)
											{
												itemloc = ((Container)(item.RootParent)).Location;
											}
											else
											{
												return;
											}
									}
									else
									{
										itemloc = item.Location;
									}
									if (item == null || item.Deleted || item.Map == null || item.Map == Map.Internal) return;
									m_From.Location = itemloc;
									m_From.Map = item.Map;</pre>

## Duplicated Code. Size: 203

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetPoint2DGump.cs

<pre>if (shouldSet)
            {
                try
                {
                    CommandLogging.LogChangeProperty(this.m_Mobile, this.m_Object, this.m_Property.Name, toSet.ToString());
                    this.m_Property.SetValue(this.m_Object, toSet, null);
                    PropertiesGump.OnValueChanged(this.m_Object, this.m_Property, this.m_Stack);
                }
                catch
                {
                    this.m_Mobile.SendMessage("An exception was caught. The property may not have changed.");
                }
            }

            if (shouldSend)
                this.m_Mobile.SendGump(new PropertiesGump(this.m_Mobile, this.m_Object, this.m_Stack, this.m_List, this.m_Page));</pre>

Fragment 2 in file Scripts\Gumps\Properties\SetPoint3DGump.cs

<pre>if (shouldSet)
            {
                try
                {
                    CommandLogging.LogChangeProperty(this.m_Mobile, this.m_Object, this.m_Property.Name, toSet.ToString());
                    this.m_Property.SetValue(this.m_Object, toSet, null);
                    PropertiesGump.OnValueChanged(this.m_Object, this.m_Property, this.m_Stack);
                }
                catch
                {
                    this.m_Mobile.SendMessage("An exception was caught. The property may not have changed.");
                }
            }

            if (shouldSend)
                this.m_Mobile.SendGump(new PropertiesGump(this.m_Mobile, this.m_Object, this.m_Stack, this.m_List, this.m_Page));</pre>

Fragment 3 in file Scripts\Gumps\Properties\SetTimeSpanGump.cs

<pre>if (shouldSet)
            {
                try
                {
                    CommandLogging.LogChangeProperty(this.m_Mobile, this.m_Object, this.m_Property.Name, toSet.ToString());
                    this.m_Property.SetValue(this.m_Object, toSet, null);
                    PropertiesGump.OnValueChanged(this.m_Object, this.m_Property, this.m_Stack);
                }
                catch
                {
                    this.m_Mobile.SendMessage("An exception was caught. The property may not have changed.");
                }
            }

            if (shouldSend)
                this.m_Mobile.SendGump(new PropertiesGump(this.m_Mobile, this.m_Object, this.m_Stack, this.m_List, this.m_Page));</pre>

## Duplicated Code. Size: 202

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\BritchesOfWarding.cs

<pre>{
            switch (Utility.Random(6))
            {
                case 0: this.AbsorptionAttributes.EaterKinetic = 9; break;
                case 1: this.AbsorptionAttributes.EaterFire = 9; break;
                case 2: this.AbsorptionAttributes.EaterCold = 9; break;
                case 3: this.AbsorptionAttributes.EaterPoison = 9; break;
                case 4: this.AbsorptionAttributes.EaterEnergy = 9; break;
                case 5: this.AbsorptionAttributes.EaterDamage = 9; break;
            }

            this.Attributes.BonusStam = 12;
            this.Attributes.AttackChance = 10;
            this.Attributes.LowerManaCost = 8;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\BritchesOfWarding.cs

<pre>{
            switch (Utility.Random(6))
            {
                case 0: this.AbsorptionAttributes.EaterKinetic = 9; break;
                case 1: this.AbsorptionAttributes.EaterFire = 9; break;
                case 2: this.AbsorptionAttributes.EaterCold = 9; break;
                case 3: this.AbsorptionAttributes.EaterPoison = 9; break;
                case 4: this.AbsorptionAttributes.EaterEnergy = 9; break;
                case 5: this.AbsorptionAttributes.EaterDamage = 9; break;
            }

            this.Attributes.BonusStam = 12;
            this.Attributes.AttackChance = 10;
            this.Attributes.LowerManaCost = 8;
        }</pre>

## Duplicated Code. Size: 202

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\LootPack.cs

<pre>case 1:
					p0 = 3;
					p1 = 1;
					break;
				case 2:
					p0 = 6;
					p1 = 3;
					p2 = 1;
					break;
				case 3:
					p0 = 10;
					p1 = 6;
					p2 = 3;
					p3 = 1;
					break;
				case 4:
					p0 = 16;
					p1 = 12;
					p2 = 6;
					p3 = 5;
					p4 = 1;
					break;
				case 5:
					p0 = 30;
					p1 = 25;
					p2 = 20;
					p3 = 15;
					p4 = 9;
					p5 = 1;</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>case 1: p0 = 3; p1 = 1; break;
                case 2: p0 = 6; p1 = 3; p2 = 1; break;
                case 3: p0 = 10; p1 = 6; p2 = 3; p3 = 1; break;
                case 4: p0 = 16; p1 = 12; p2 = 6; p3 = 5; p4 = 1; break;
                case 5: p0 = 30; p1 = 25; p2 = 20; p3 = 15; p4 = 9; p5 = 1;</pre>

## Duplicated Code. Size: 202

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Blacksmith.cs

<pre>public override void InitOutfit()
        {
            base.InitOutfit();

            Item item = (Utility.RandomBool() ? null : new Server.Items.RingmailChest());

            if (item != null && !this.EquipItem(item))
            {
                item.Delete();
                item = null;
            }

            if (item == null)
                this.AddItem(new Server.Items.FullApron());

            this.AddItem(new Server.Items.Bascinet());
            this.AddItem(new Server.Items.SmithHammer());
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\BlacksmithGuildmaster.cs

<pre>public override void InitOutfit()
        {
            base.InitOutfit();

            Item item = (Utility.RandomBool() ? null : new Server.Items.RingmailChest());

            if (item != null && !this.EquipItem(item))
            {
                item.Delete();
                item = null;
            }

            if (item == null)
                this.AddItem(new Server.Items.FullApron());

            this.AddItem(new Server.Items.Bascinet());
            this.AddItem(new Server.Items.SmithHammer());
        }</pre>

## Duplicated Code. Size: 202

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Mobiles\Raider.cs

<pre>Item bow;

            switch (Utility.Random(4))
            {
                default:
                case 0: bow = new CompositeBow(); PackItem(new Arrow(25)); break;
                case 1: bow = new Crossbow(); PackItem(new Bolt(25)); break;
                case 2: bow = new Bow(); PackItem(new Arrow(25)); break;
                case 3: bow = new HeavyCrossbow(); PackItem(new Bolt(25)); break;
            }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Mobiles\Corgul\SoulboundPirateRaider.cs

<pre>Item bow;

            switch (Utility.Random(4))
            {
                default:
                case 0: bow = new CompositeBow(); PackItem(new Arrow(25)); break;
                case 1: bow = new Crossbow(); PackItem(new Bolt(25)); break;
                case 2: bow = new Bow(); PackItem(new Arrow(25)); break;
                case 3: bow = new HeavyCrossbow(); PackItem(new Bolt(25)); break;
            }</pre>

## Duplicated Code. Size: 202

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Help\PageQueueGump.cs

<pre>if (i >= 5 && (i % 5) == 0)
                    {
                        this.AddButton(368, 10, 0xFA5, 0xFA7, 0, GumpButtonType.Page, (i / 5) + 1);
                        this.AddLabel(298, 10, 2100, "Next Page");
                        this.AddPage((i / 5) + 1);
                        this.AddButton(12, 10, 0xFAE, 0xFB0, 0, GumpButtonType.Page, i / 5);
                        this.AddLabel(48, 10, 2100, "Previous Page");
                    }</pre>

Fragment 2 in file Scripts\Services\Help\PageQueueGump.cs

<pre>if (i >= 5 && (i % 5) == 0)
                    {
                        this.AddButton(368, 10, 0xFA5, 0xFA7, 0, GumpButtonType.Page, (i / 5) + 1);
                        this.AddLabel(298, 10, 2100, "Next Page");
                        this.AddPage((i / 5) + 1);
                        this.AddButton(12, 10, 0xFAE, 0xFB0, 0, GumpButtonType.Page, i / 5);
                        this.AddLabel(48, 10, 2100, "Previous Page");
                    }</pre>

## Duplicated Code. Size: 202

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Pathing\FastAStarAlgorithm.cs

<pre>default:
                    case 0:
                        x = 0;
                        y = -1;
                        break;
                    case 1:
                        x = 1;
                        y = -1;
                        break;
                    case 2:
                        x = 1;
                        y = 0;
                        break;
                    case 3:
                        x = 1;
                        y = 1;
                        break;
                    case 4:
                        x = 0;
                        y = 1;
                        break;
                    case 5:
                        x = -1;
                        y = 1;
                        break;
                    case 6:
                        x = -1;
                        y = 0;
                        break;
                    case 7:
                        x = -1;</pre>

Fragment 2 in file Scripts\Services\Pathing\SlowAStarAlgorithm.cs

<pre>default:
                        case 0:
                            x = 0;
                            y = -1;
                            break;
                        case 1:
                            x = 1;
                            y = -1;
                            break;
                        case 2:
                            x = 1;
                            y = 0;
                            break;
                        case 3:
                            x = 1;
                            y = 1;
                            break;
                        case 4:
                            x = 0;
                            y = 1;
                            break;
                        case 5:
                            x = -1;
                            y = 1;
                            break;
                        case 6:
                            x = -1;
                            y = 0;
                            break;
                        case 7:
                            x = -1;</pre>

## Duplicated Code. Size: 202

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\InhumanSpeech.cs

<pre>new string[]
                    {
                        "meat", "kill", "pound", "crush", "yum yum",
                        "crunch", "destroy", "murder", "eat", "munch",
                        "massacre", "food", "monster", "evil", "run",
                        "die", "lose", "dumb", "idiot", "fool", "crazy",
                        "dinner", "lunch", "breakfast", "fight", "battle",
                        "doomed", "rip apart", "tear apart", "smash",
                        "edible?", "shred", "disembowel", "ugly", "smelly",
                        "stupid", "hideous", "smell", "tasty", "invader",
                        "attack", "raid", "plunder", "pillage", "treasure",
                        "loser", "lose", "scum"
                    }</pre>

Fragment 2 in file Scripts\Misc\InhumanSpeech.cs

<pre>new string[]
                    {
                        "meat", "kill", "pound", "crush", "yum yum",
                        "crunch", "destroy", "murder", "eat", "munch",
                        "massacre", "food", "monster", "evil", "run",
                        "die", "lose", "dumb", "idiot", "fool", "crazy",
                        "dinner", "lunch", "breakfast", "fight", "battle",
                        "doomed", "rip apart", "tear apart", "smash",
                        "edible?", "shred", "disembowel", "ugly", "smelly",
                        "stupid", "hideous", "smell", "tasty", "invader",
                        "attack", "raid", "plunder", "pillage", "treasure",
                        "loser", "lose", "scum"
                    }</pre>

Fragment 3 in file Scripts\Misc\InhumanSpeech.cs

<pre>new string[]
                    {
                        "meat", "kill", "pound", "crush", "yum yum",
                        "crunch", "destroy", "murder", "eat", "munch",
                        "massacre", "food", "monster", "evil", "run",
                        "die", "lose", "dumb", "idiot", "fool", "crazy",
                        "dinner", "lunch", "breakfast", "fight", "battle",
                        "doomed", "rip apart", "tear apart", "smash",
                        "edible?", "shred", "disembowel", "ugly", "smelly",
                        "stupid", "hideous", "smell", "tasty", "invader",
                        "attack", "raid", "plunder", "pillage", "treasure",
                        "loser", "lose", "scum"
                    }</pre>

## Duplicated Code. Size: 201

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseRenowned.cs

<pre>public override void OnDeath(Container c)
        {
            if (this.Map == Map.Felucca || this.Map == Map.TerMur)
            {
                //TODO: Confirm SE change or AoS one too?
                List<DamageStore> rights = GetLootingRights();
                List<Mobile> toGive = new List<Mobile>();

                for (int i = rights.Count - 1; i >= 0; --i)
                {
                    DamageStore ds = rights[i];

                    if (ds.m_HasRight)
                        toGive.Add(ds.m_Mobile);
                }
            }

            base.OnDeath(c);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseSABosses.cs

<pre>public override void OnDeath(Container c)
        {
            if (this.Map == Map.Felucca || this.Map == Map.TerMur)
            {
                //TODO: Confirm SE change or AoS one too?
                List<DamageStore> rights = GetLootingRights();
                List<Mobile> toGive = new List<Mobile>();

                for (int i = rights.Count - 1; i >= 0; --i)
                {
                    DamageStore ds = rights[i];

                    if (ds.m_HasRight)
                        toGive.Add(ds.m_Mobile);
                }
            }

            base.OnDeath(c);
        }</pre>

## Duplicated Code. Size: 201

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\HouseFoundation.cs

<pre>int stairBufferIndex = (totalStairsUsed / MaxItemsPerStairBuffer);
                            byte[] stairBuffer = m_StairBuffers[stairBufferIndex];

                            int byteIndex = (totalStairsUsed % MaxItemsPerStairBuffer) * 5;

                            stairBuffer[byteIndex++] = (byte)(mte.m_ItemID >> 8);
                            stairBuffer[byteIndex++] = (byte)mte.m_ItemID;

                            stairBuffer[byteIndex++] = (byte)mte.m_OffsetX;
                            stairBuffer[byteIndex++] = (byte)mte.m_OffsetY;
                            stairBuffer[byteIndex++] = (byte)mte.m_OffsetZ;</pre>

Fragment 2 in file Scripts\Multis\HouseFoundation.cs

<pre>int stairBufferIndex = (totalStairsUsed / MaxItemsPerStairBuffer);
                    byte[] stairBuffer = m_StairBuffers[stairBufferIndex];

                    int byteIndex = (totalStairsUsed % MaxItemsPerStairBuffer) * 5;

                    stairBuffer[byteIndex++] = (byte)(mte.m_ItemID >> 8);
                    stairBuffer[byteIndex++] = (byte)mte.m_ItemID;

                    stairBuffer[byteIndex++] = (byte)mte.m_OffsetX;
                    stairBuffer[byteIndex++] = (byte)mte.m_OffsetY;
                    stairBuffer[byteIndex++] = (byte)mte.m_OffsetZ;</pre>

## Duplicated Code. Size: 201

### Duplicated Fragments:

Fragment 1 in file Ultima\AnimationEdit.cs

<pre>for (int i = 0; i < 0x100; ++i)
				{
					Palette[i] = (ushort)(bin.ReadUInt16() ^ 0x8000);
				}

				var start = (int)bin.BaseStream.Position;
				int frameCount = bin.ReadInt32();

				var lookups = new int[frameCount];

				for (int i = 0; i < frameCount; ++i)
				{
					lookups[i] = start + bin.ReadInt32();
				}

				Frames = new List<FrameEdit>();</pre>

Fragment 2 in file Ultima\AnimationEdit.cs

<pre>for (int i = 0; i < 0x100; ++i)
			{
				Palette[i] = (ushort)(bin.ReadUInt16() ^ 0x8000);
			}

			var start = (int)bin.BaseStream.Position;
			int frameCount = bin.ReadInt32();

			var lookups = new int[frameCount];

			for (int i = 0; i < frameCount; ++i)
			{
				lookups[i] = start + bin.ReadInt32();
			}

			Frames = new List<FrameEdit>();</pre>

## Duplicated Code. Size: 201

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public void DoEffects(Mobile from)
        {
            if (Table == null)
                Table = new Dictionary<Mobile, Timer>();

            if (!Table.ContainsKey(from))
            {
                Table[from] = Timer.DelayCall(TimeSpan.FromSeconds(1.5), TimeSpan.FromSeconds(1.5), new TimerStateCallback(SapMana), new object[] { from, this });
                Table[from].Start();

                from.SendLocalizedMessage(1151482); // Your mana has been tainted!
                from.SendLocalizedMessage(1151485); // Your mana is being diverted.
            }
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public void DoEffects(Mobile from)
        {
            if (Table == null)
                Table = new Dictionary<Mobile, Timer>();

            if (!Table.ContainsKey(from))
            {
                Table[from] = Timer.DelayCall(TimeSpan.FromSeconds(1.5), TimeSpan.FromSeconds(1.5), new TimerStateCallback(SapMana), new object[] { from, this });
                Table[from].Start();

                from.SendLocalizedMessage(1151482); // Your mana has been tainted!
                from.SendLocalizedMessage(1151485); // Your mana is being diverted.
            }
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public void DoEffects(Mobile from)
        {
            if (Table == null)
                Table = new Dictionary<Mobile, Timer>();

            if (!Table.ContainsKey(from))
            {
                Table[from] = Timer.DelayCall(TimeSpan.FromSeconds(1.5), TimeSpan.FromSeconds(1.5), new TimerStateCallback(SapMana), new object[] { from, this });
                Table[from].Start();

                from.SendLocalizedMessage(1151482); // Your mana has been tainted!
                from.SendLocalizedMessage(1151485); // Your mana is being diverted.
            }
        }</pre>

## Duplicated Code. Size: 200

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\ArcherGuard.cs

<pre>protected override void OnTick()
			{
				if (m_Owner.Deleted)
				{
					Stop();
					return;
				}

				if ((m_Stage++ % 4) == 0 || !m_Owner.Move(m_Owner.Direction))
				{
					m_Owner.Direction = (Direction)Utility.Random(8);
				}

				if (m_Stage > 16)
				{
					Effects.SendLocationParticles(
						EffectItem.Create(m_Owner.Location, m_Owner.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 2023);
					m_Owner.PlaySound(0x1FE);

					m_Owner.Delete();
				}
			}</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\WarriorGuard.cs

<pre>protected override void OnTick()
			{
				if (m_Owner.Deleted)
				{
					Stop();
					return;
				}

				if ((m_Stage++ % 4) == 0 || !m_Owner.Move(m_Owner.Direction))
				{
					m_Owner.Direction = (Direction)Utility.Random(8);
				}

				if (m_Stage > 16)
				{
					Effects.SendLocationParticles(
						EffectItem.Create(m_Owner.Location, m_Owner.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 2023);
					m_Owner.PlaySound(0x1FE);

					m_Owner.Delete();
				}
			}</pre>

## Duplicated Code. Size: 200

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionDeathKnight.cs

<pre>this.SetSkill(SkillName.Wrestling, 100.0, 110.0);
            this.SetSkill(SkillName.Tactics, 100.0, 110.0);
            this.SetSkill(SkillName.MagicResist, 100.0, 110.0);
            this.SetSkill(SkillName.Healing, 100.0, 110.0);
            this.SetSkill(SkillName.Anatomy, 100.0, 110.0);

            this.SetSkill(SkillName.Magery, 100.0, 110.0);
            this.SetSkill(SkillName.EvalInt, 100.0, 110.0);
            this.SetSkill(SkillName.Meditation, 100.0, 110.0);</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionSorceress.cs

<pre>this.SetSkill(SkillName.Wrestling, 100.0, 110.0);
            this.SetSkill(SkillName.Tactics, 100.0, 110.0);
            this.SetSkill(SkillName.MagicResist, 100.0, 110.0);
            this.SetSkill(SkillName.Healing, 100.0, 110.0);
            this.SetSkill(SkillName.Anatomy, 100.0, 110.0);

            this.SetSkill(SkillName.Magery, 100.0, 110.0);
            this.SetSkill(SkillName.EvalInt, 100.0, 110.0);
            this.SetSkill(SkillName.Meditation, 100.0, 110.0);</pre>

## Duplicated Code. Size: 200

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionPaladin.cs

<pre>this.SetSkill(SkillName.Wrestling, 110.0, 120.0);
            this.SetSkill(SkillName.Tactics, 110.0, 120.0);
            this.SetSkill(SkillName.MagicResist, 110.0, 120.0);
            this.SetSkill(SkillName.Healing, 110.0, 120.0);
            this.SetSkill(SkillName.Anatomy, 110.0, 120.0);

            this.SetSkill(SkillName.Magery, 110.0, 120.0);
            this.SetSkill(SkillName.EvalInt, 110.0, 120.0);
            this.SetSkill(SkillName.Meditation, 110.0, 120.0);</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionWizard.cs

<pre>this.SetSkill(SkillName.Wrestling, 110.0, 120.0);
            this.SetSkill(SkillName.Tactics, 110.0, 120.0);
            this.SetSkill(SkillName.MagicResist, 110.0, 120.0);
            this.SetSkill(SkillName.Healing, 110.0, 120.0);
            this.SetSkill(SkillName.Anatomy, 110.0, 120.0);

            this.SetSkill(SkillName.Magery, 110.0, 120.0);
            this.SetSkill(SkillName.EvalInt, 110.0, 120.0);
            this.SetSkill(SkillName.Meditation, 110.0, 120.0);</pre>

## Duplicated Code. Size: 200

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\TreasuresOfTokuno\TreasuresOfTokuno.cs

<pre>public override void HandleCancel(NetState sender)
        {
            PlayerMobile pm = sender.Mobile as PlayerMobile;

            if (pm == null || !pm.InRange(this.m_Collector.Location, 7))
                return;

            if (pm.ToTItemsTurnedIn == 0)
                this.m_Collector.SayTo(pm, 1071013); // Bring me 10 of the lost treasures of Tokuno and I will reward you with a valuable item.
            else if (pm.ToTItemsTurnedIn < TreasuresOfTokuno.ItemsPerReward)	//This case should ALWAYS be true with this gump, jsut a sanity check
                this.m_Collector.SayTo(pm, 1070981, String.Format("{0}\t{1}", pm.ToTItemsTurnedIn, TreasuresOfTokuno.ItemsPerReward)); // You have turned in ~1_COUNT~ minor artifacts. Turn in ~2_NUM~ to receive a reward.
            else
                this.m_Collector.SayTo(pm, 1070982); // When you wish to choose your reward, you have but to approach me again.
        }</pre>

Fragment 2 in file Scripts\Services\TreasuresOfTokuno\TreasuresOfTokuno.cs

<pre>public override void HandleCancel(NetState sender)
        {
            PlayerMobile pm = sender.Mobile as PlayerMobile;

            if (pm == null || !pm.InRange(this.m_Collector.Location, 7))
                return;

            if (pm.ToTItemsTurnedIn == 0)
                this.m_Collector.SayTo(pm, 1071013); // Bring me 10 of the lost treasures of Tokuno and I will reward you with a valuable item.
            else if (pm.ToTItemsTurnedIn < TreasuresOfTokuno.ItemsPerReward)	//This and above case should ALWAYS be FALSE with this gump, jsut a sanity check
                this.m_Collector.SayTo(pm, 1070981, String.Format("{0}\t{1}", pm.ToTItemsTurnedIn, TreasuresOfTokuno.ItemsPerReward)); // You have turned in ~1_COUNT~ minor artifacts. Turn in ~2_NUM~ to receive a reward.
            else
                this.m_Collector.SayTo(pm, 1070982); // When you wish to choose your reward, you have but to approach me again.
        }</pre>

## Duplicated Code. Size: 200

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\SimpleSwitches.cs

<pre>this.m_LeverSound = reader.ReadInt();
						int ltype = reader.ReadInt();
						switch (ltype)
						{
							case (int)leverType.Two_State: this.m_LeverType = leverType.Two_State; break;
							case (int)leverType.Three_State: this.m_LeverType = leverType.Three_State; break;

						}
						this.m_TargetItem0 = reader.ReadItem();
						this.m_TargetProperty0 = reader.ReadString();
						this.m_TargetItem1 = reader.ReadItem();
						this.m_TargetProperty1 = reader.ReadString();
						this.m_TargetItem2 = reader.ReadItem();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>this.m_LeverSound = reader.ReadInt();
					int ltype = reader.ReadInt();
					switch( ltype )
					{
						case (int)leverType.Two_State:		this.m_LeverType = leverType.Two_State;	break;
						case (int)leverType.Three_State:	this.m_LeverType = leverType.Three_State;	break;

					}
					this.m_TargetItem0 = reader.ReadItem();
					this.m_TargetProperty0 = reader.ReadString();
					this.m_TargetItem1 = reader.ReadItem();
					this.m_TargetProperty1 = reader.ReadString();
					this.m_TargetItem2 = reader.ReadItem();</pre>

## Duplicated Code. Size: 199

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Bosses.cs

<pre>int z = m_Map.GetAverageZ(m_X, m_Y);
                bool canFit = m_Map.CanFit(m_X, m_Y, z, 6, false, false);

                for (int i = -3; !canFit && i <= 3; ++i)
                {
                    canFit = m_Map.CanFit(m_X, m_Y, z + i, 6, false, false);

                    if (canFit)
                        z += i;
                }

                if (!canFit)
                    return;

                Gold g = new Gold(500, 1000); // [WarLocke] Changed to vary by champion. Originally 500, 1000.</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ClockworkExodus.cs

<pre>int z = m_Map.GetAverageZ(m_X, m_Y);
                bool canFit = m_Map.CanFit(m_X, m_Y, z, 6, false, false);

                for (int i = -3; !canFit && i <= 3; ++i)
                {
                    canFit = m_Map.CanFit(m_X, m_Y, z + i, 6, false, false);

                    if (canFit)
                        z += i;
                }

                if (!canFit)
                    return;

                Gold g = new Gold(500, 1000);</pre>

## Duplicated Code. Size: 199

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Mobiles.cs

<pre>foreach (Item item in eable)
                {
                    if (item.Z + item.ItemData.CalcHeight > z)
                    {
                        z = item.Z + item.ItemData.CalcHeight;
                    }
                }

                StaticTile[] staticTiles = this.Map.Tiles.GetStaticTiles(x, y, true);

                foreach (StaticTile tile in staticTiles)
                {
                    ItemData itemData = TileData.ItemTable[tile.ID & TileData.MaxItemValue];

                    if (tile.Z + itemData.CalcHeight > z)
                        z = tile.Z + itemData.CalcHeight;
                }

                eable.Free();</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Mobiles.cs

<pre>foreach (Item item in eable)
                {
                    if (item.Z + item.ItemData.CalcHeight > z)
                    {
                        z = item.Z + item.ItemData.CalcHeight;
                    }
                }

                eable.Free();

                StaticTile[] staticTiles = this.Map.Tiles.GetStaticTiles(x, y, true);

                foreach (StaticTile tile in staticTiles)
                {
                    ItemData itemData = TileData.ItemTable[tile.ID & TileData.MaxItemValue];

                    if (tile.Z + itemData.CalcHeight > z)
                        z = tile.Z + itemData.CalcHeight;
                }</pre>

## Duplicated Code. Size: 199

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Arabella.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));			
            this.Donations.Add(new CollectionItem(typeof(BrownBook), 0xFEF, 1074906, 0x0, 3));
            this.Donations.Add(new CollectionItem(typeof(TanBook), 0xFF0, 1074906, 0x0, 3));</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Bonnie.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));	
            this.Donations.Add(new CollectionItem(typeof(BrownBook), 0xFEF, 1074906, 0x0, 3));
            this.Donations.Add(new CollectionItem(typeof(TanBook), 0xFF0, 1074906, 0x0, 3));</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Corey.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));				
            this.Donations.Add(new CollectionItem(typeof(BrownBook), 0xFEF, 1074906, 0x0, 3));
            this.Donations.Add(new CollectionItem(typeof(TanBook), 0xFF0, 1074906, 0x0, 3));</pre>

Fragment 4 in file Scripts\Mobiles\NPCs\Margo.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));				
            this.Donations.Add(new CollectionItem(typeof(BrownBook), 0xFEF, 1074906, 0x0, 3));
            this.Donations.Add(new CollectionItem(typeof(TanBook), 0xFF0, 1074906, 0x0, 3));</pre>

Fragment 5 in file Scripts\Mobiles\NPCs\Talbart.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));	
            this.Donations.Add(new CollectionItem(typeof(BrownBook), 0xFEF, 1074906, 0x0, 3));
            this.Donations.Add(new CollectionItem(typeof(TanBook), 0xFF0, 1074906, 0x0, 3));</pre>

Fragment 6 in file Scripts\Mobiles\NPCs\Xanthe.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));	
            this.Donations.Add(new CollectionItem(typeof(BrownBook), 0xFEF, 1074906, 0x0, 3));
            this.Donations.Add(new CollectionItem(typeof(TanBook), 0xFF0, 1074906, 0x0, 3));</pre>

## Duplicated Code. Size: 198

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Banner.cs

<pre>public override void OnDoubleClick(Mobile from)
        { 
            if (this.m_IsRewardItem && !RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            if (this.IsChildOf(from.Backpack))
            {
                BaseHouse house = BaseHouse.FindHouseAt(from);

                if (house != null && house.IsOwner(from))
                {
                    from.CloseGump(typeof(InternalGump));
                    from.SendGump(new InternalGump(this));
                }
                else
                    from.SendLocalizedMessage(502092); // You must be in your house to do this.
            }
            else
                from.SendLocalizedMessage(1042038); // You must have the object in your backpack to use it.          	
        }</pre>

Fragment 2 in file Scripts\Items\Addons\HangingSkeleton.cs

<pre>public override void OnDoubleClick(Mobile from)
        { 
            if (this.m_IsRewardItem && !RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            if (this.IsChildOf(from.Backpack))
            {
                BaseHouse house = BaseHouse.FindHouseAt(from);

                if (house != null && house.IsOwner(from))
                {
                    from.CloseGump(typeof(InternalGump));
                    from.SendGump(new InternalGump(this));
                }
                else
                    from.SendLocalizedMessage(502092); // You must be in your house to do this.
            }
            else
                from.SendLocalizedMessage(1042038); // You must have the object in your backpack to use it.          	
        }</pre>

## Duplicated Code. Size: 198

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>var targets = new List<Mobile>();

            if (Map != null)
            {
                foreach (Mobile m in GetMobilesInRange(AreaDamageRange))
                {
                    if (this != m && SpellHelper.ValidIndirectTarget(this, m) && CanBeHarmful(m, false) && (!Core.AOS || InLOS(m)))
                    {
                        if (m is BaseCreature && ((BaseCreature)m).Controlled)
                        {
                            targets.Add(m);
                        }
                        else if (m.Player)
                        {
                            targets.Add(m);
                        }
                    }
                }
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>var targets = new List<Mobile>();

            if (Map != null)
            {
                foreach (Mobile m in GetMobilesInRange(AreaDamageRange))
                {
                    if (this != m && SpellHelper.ValidIndirectTarget(this, m) && CanBeHarmful(m, false) && (!Core.AOS || InLOS(m)))
                    {
                        if (m is BaseCreature && ((BaseCreature)m).Controlled)
                        {
                            targets.Add(m);
                        }
                        else if (m.Player)
                        {
                            targets.Add(m);
                        }
                    }
                }
            }</pre>

## Duplicated Code. Size: 198

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GargishRouser.cs

<pre>if (m is BaseCreature && (((BaseCreature)m).Summoned || ((BaseCreature)m).Controlled))
                        m = ((BaseCreature)m).GetMaster();

                    this.FixedParticles(0x3709, 1, 30, 9904, 1108, 6, EffectLayer.RightFoot);
                    BaseCreature vm = new VoidManifestation(m_Type);
                    vm.MoveToWorld(this.Location, this.Map);
                    vm.PlaySound(vm.GetAngerSound());

                    if (m != null)
                        vm.Combatant = m;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GargishRouser.cs

<pre>if (m is BaseCreature && (((BaseCreature)m).Summoned || ((BaseCreature)m).Controlled))
					m = ((BaseCreature)m).GetMaster();

				this.FixedParticles( 0x3709, 1, 30, 9904, 1108, 6, EffectLayer.RightFoot );
                BaseCreature vm = new VoidManifestation(m_Type);
				vm.MoveToWorld(this.Location, this.Map);
				vm.PlaySound(vm.GetAngerSound());

				if(m != null)
					vm.Combatant = m;</pre>

## Duplicated Code. Size: 198

### Duplicated Fragments:

Fragment 1 in file Ultima\Animations.cs

<pre>var palette = new ushort[0x100];

				for (int i = 0; i < 0x100; ++i)
				{
					palette[i] = (ushort)(bin.ReadUInt16() ^ 0x8000);
				}

				var start = (int)bin.BaseStream.Position;
				int frameCount = bin.ReadInt32();

				var lookups = new int[frameCount];

				for (int i = 0; i < frameCount; ++i)
				{
					lookups[i] = start + bin.ReadInt32();
				}</pre>

Fragment 2 in file Ultima\Animations.cs

<pre>var palette = new ushort[0x100];

				for (int i = 0; i < 0x100; ++i)
				{
					palette[i] = (ushort)(bin.ReadUInt16() ^ 0x8000);
				}

				var start = (int)bin.BaseStream.Position;
				int frameCount = bin.ReadInt32();

				var lookups = new int[frameCount];

				for (int i = 0; i < frameCount; ++i)
				{
					lookups[i] = start + bin.ReadInt32();
				}</pre>

## Duplicated Code. Size: 198

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Swoop.cs

<pre>private class ExpireTimer : Timer
        {
            private readonly Mobile m_Mobile;
            private readonly ResistanceMod m_Mod;
            public ExpireTimer(Mobile m, ResistanceMod mod, TimeSpan delay)
                : base(delay)
            {
                this.m_Mobile = m;
                this.m_Mod = mod;
                this.Priority = TimerPriority.TwoFiftyMS;
            }

            public void DoExpire()
            {
                this.m_Mobile.RemoveResistanceMod(this.m_Mod);
                this.Stop();
                m_Table.Remove(this.m_Mobile);
            }

            protected override void OnTick()
            {
                this.m_Mobile.SendLocalizedMessage(1070838); // Your resistance to physical attacks has returned.
                this.DoExpire();
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Hiryu.cs

<pre>private class ExpireTimer : Timer
        {
            private readonly Mobile m_Mobile;
            private readonly ResistanceMod m_Mod;
            public ExpireTimer(Mobile m, ResistanceMod mod, TimeSpan delay)
                : base(delay)
            {
                this.m_Mobile = m;
                this.m_Mod = mod;
                this.Priority = TimerPriority.TwoFiftyMS;
            }

            public void DoExpire()
            {
                this.m_Mobile.RemoveResistanceMod(this.m_Mod);
                this.Stop();
                m_Table.Remove(this.m_Mobile);
            }

            protected override void OnTick()
            {
                this.m_Mobile.SendLocalizedMessage(1070838); // Your resistance to physical attacks has returned.
                this.DoExpire();
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\LesserHiryu.cs

<pre>private class ExpireTimer : Timer
        {
            private readonly Mobile m_Mobile;
            private readonly ResistanceMod m_Mod;
            public ExpireTimer(Mobile m, ResistanceMod mod, TimeSpan delay)
                : base(delay)
            {
                this.m_Mobile = m;
                this.m_Mod = mod;
                this.Priority = TimerPriority.TwoFiftyMS;
            }

            public void DoExpire()
            {
                this.m_Mobile.RemoveResistanceMod(this.m_Mod);
                this.Stop();
                m_Table.Remove(this.m_Mobile);
            }

            protected override void OnTick()
            {
                this.m_Mobile.SendLocalizedMessage(1070838); // Your resistance to physical attacks has returned.
                this.DoExpire();
            }
        }</pre>

## Duplicated Code. Size: 197

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\BaseCollectionItem.cs

<pre>public virtual void Init()
        { 
            if (this.m_Donations == null)
                this.m_Donations = new List<CollectionItem>();

            if (this.m_Rewards == null)
                this.m_Rewards = new List<CollectionItem>();

            if (this.m_Tiers == null)
                this.m_Tiers = new List<List<object>>();

            // start decay timer
            if (this.m_DailyDecay > 0)
            {
                DateTime today = DateTime.Today;
                today.AddDays(1);

                new CollectionDecayTimer(this, today - DateTime.UtcNow);
            }
        }</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\BaseCollectionMobile.cs

<pre>public virtual void Init()
        { 
            if (this.m_Donations == null)
                this.m_Donations = new List<CollectionItem>();

            if (this.m_Rewards == null)
                this.m_Rewards = new List<CollectionItem>();

            if (this.m_Tiers == null)
                this.m_Tiers = new List<List<object>>();

            // start decay timer
            if (this.m_DailyDecay > 0)
            {
                DateTime today = DateTime.Today;
                today.AddDays(1);

                new CollectionDecayTimer(this, today - DateTime.UtcNow);
            }
        }</pre>

## Duplicated Code. Size: 197

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>Map map = null;
                int x = 0;
                int y = 0;
                if (AttachedTo is Item)
                {
                    map = ((Item)AttachedTo).Map;
                    x = ((Item)AttachedTo).Location.X;
                    y = ((Item)AttachedTo).Location.Y;

                }
                else
                    if (AttachedTo is Mobile)
                    {
                        map = ((Mobile)AttachedTo).Map;
                        x = ((Mobile)AttachedTo).Location.X;
                        y = ((Mobile)AttachedTo).Location.Y;
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>Map map = null;
                int x = 0;
                int y = 0;
                if (AttachedTo is Item)
                {
                    map = ((Item)AttachedTo).Map;
                    x = ((Item)AttachedTo).Location.X;
                    y = ((Item)AttachedTo).Location.Y;

                }
                else
                    if (AttachedTo is Mobile)
                    {
                        map = ((Mobile)AttachedTo).Map;
                        x = ((Mobile)AttachedTo).Location.X;
                        y = ((Mobile)AttachedTo).Location.Y;
                    }</pre>

## Duplicated Code. Size: 196

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTF.cs

<pre>ChallengeEntry entry = new ChallengeEntry();
                    entry.Participant = reader.ReadMobile();
                    string sname = reader.ReadString();
                    // look up the enum by name
                    ChallengeStatus status = ChallengeStatus.None;
                    try{
                    status = (ChallengeStatus)Enum.Parse(typeof(ChallengeStatus), sname);
                    } catch{}
                    entry.Status = status;
                    entry.Accepted = reader.ReadBool();
                    entry.PageBeingViewed = reader.ReadInt();
                    entry.Score = reader.ReadInt();
                    entry.Winner = reader.ReadBool();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGauntlet.cs

<pre>ChallengeEntry entry = new ChallengeEntry();
                    entry.Participant = reader.ReadMobile();
                    string sname = reader.ReadString();
                    // look up the enum by name
                    ChallengeStatus status = ChallengeStatus.None;
                    try{
                    status = (ChallengeStatus)Enum.Parse(typeof(ChallengeStatus), sname);
                    } catch{}
                    entry.Status = status;
                    entry.Accepted = reader.ReadBool();
                    entry.PageBeingViewed = reader.ReadInt();
                    entry.Score = reader.ReadInt();
                    entry.Winner = reader.ReadBool();</pre>

## Duplicated Code. Size: 196

### Duplicated Fragments:

Fragment 1 in file Ultima\Multis.cs

<pre>m_SortedTiles[itemcount].m_Unk1 = 0;

							MultiTileEntry e = m_SortedTiles[itemcount];

							if (e.m_OffsetX < m_Min.X)
							{
								m_Min.X = e.m_OffsetX;
							}

							if (e.m_OffsetY < m_Min.Y)
							{
								m_Min.Y = e.m_OffsetY;
							}

							if (e.m_OffsetX > m_Max.X)
							{
								m_Max.X = e.m_OffsetX;
							}

							if (e.m_OffsetY > m_Max.Y)
							{
								m_Max.Y = e.m_OffsetY;
							}

							if (e.m_OffsetZ > m_maxHeight)
							{
								m_maxHeight = e.m_OffsetZ;
							}</pre>

Fragment 2 in file Ultima\Multis.cs

<pre>m_SortedTiles[itemcount].m_Unk1 = 0;

								MultiTileEntry e = m_SortedTiles[itemcount];

								if (e.m_OffsetX < m_Min.X)
								{
									m_Min.X = e.m_OffsetX;
								}

								if (e.m_OffsetY < m_Min.Y)
								{
									m_Min.Y = e.m_OffsetY;
								}

								if (e.m_OffsetX > m_Max.X)
								{
									m_Max.X = e.m_OffsetX;
								}

								if (e.m_OffsetY > m_Max.Y)
								{
									m_Max.Y = e.m_OffsetY;
								}

								if (e.m_OffsetZ > m_maxHeight)
								{
									m_maxHeight = e.m_OffsetZ;
								}</pre>

## Duplicated Code. Size: 196

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTF.cs

<pre>if(Participants != null)
            {
                writer.Write(Participants.Count);

                foreach(ChallengeEntry entry in Participants)
                {
                    writer.Write(entry.Participant);
                    writer.Write(entry.Status.ToString());
                    writer.Write(entry.Accepted);
                    writer.Write(entry.PageBeingViewed);
                    writer.Write(entry.Score);
                    writer.Write(entry.Winner);
                    writer.Write(entry.Team);
                }
            } else
            {
                writer.Write((int)0);
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGauntlet.cs

<pre>if(Participants != null)
            {
                writer.Write(Participants.Count);

                foreach(ChallengeEntry entry in Participants)
                {
                    writer.Write(entry.Participant);
                    writer.Write(entry.Status.ToString());
                    writer.Write(entry.Accepted);
                    writer.Write(entry.PageBeingViewed);
                    writer.Write(entry.Score);
                    writer.Write(entry.Winner);
                    writer.Write(entry.Team);
                }
            } else
            {
                writer.Write((int)0);
            }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGauntlet.cs

<pre>if(Participants != null)
            {
                writer.Write(Participants.Count);

                foreach(ChallengeEntry entry in Participants)
                {
                    writer.Write(entry.Participant);
                    writer.Write(entry.Status.ToString());
                    writer.Write(entry.Accepted);
                    writer.Write(entry.PageBeingViewed);
                    writer.Write(entry.Score);
                    writer.Write(entry.Winner);
                    writer.Write(entry.Team);
                }
            } else
            {
                writer.Write((int)0);
            }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGauntlet.cs

<pre>if(Participants != null)
            {
                writer.Write(Participants.Count);

                foreach(ChallengeEntry entry in Participants)
                {
                    writer.Write(entry.Participant);
                    writer.Write(entry.Status.ToString());
                    writer.Write(entry.Accepted);
                    writer.Write(entry.PageBeingViewed);
                    writer.Write(entry.Score);
                    writer.Write(entry.Winner);
                    writer.Write(entry.Team);
                }
            } else
            {
                writer.Write((int)0);
            }</pre>

## Duplicated Code. Size: 195

### Duplicated Fragments:

Fragment 1 in file Ultima\Art.cs

<pre>if (m_patched.Contains(index))
			{
				patched = (bool)m_patched[index];
			}
			else
			{
				patched = false;
			}

			if (m_Removed[index])
			{
				return null;
			}
			if (m_Cache[index] != null)
			{
				return m_Cache[index];
			}

			int length, extra;
			Stream stream = m_FileIndex.Seek(index, out length, out extra, out patched);
			if (stream == null)
			{
				return null;
			}
			if (patched)
			{
				m_patched[index] = true;
			}</pre>

Fragment 2 in file Ultima\Art.cs

<pre>if (m_patched.Contains(index))
			{
				patched = (bool)m_patched[index];
			}
			else
			{
				patched = false;
			}

			if (m_Removed[index])
			{
				return null;
			}
			if (m_Cache[index] != null)
			{
				return m_Cache[index];
			}

			int length, extra;
			Stream stream = m_FileIndex.Seek(index, out length, out extra, out patched);
			if (stream == null)
			{
				return null;
			}
			if (patched)
			{
				m_patched[index] = true;
			}</pre>

## Duplicated Code. Size: 194

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DungeonHitchingPost.cs

<pre>for (int i = 0; i < from.Stabled.Count; ++i)
            {
                BaseCreature pet = from.Stabled[i] as BaseCreature;

                if (pet == null || pet.Deleted)
                {
                    pet.IsStabled = false;
                    from.Stabled.RemoveAt(i);
                    --i;
                    continue;
                }

                list.Add(pet);
            }

            if (list.Count > 0)
                from.SendGump(new ClaimListGump(this, from, list));
            else
                from.SendLocalizedMessage(502671); // But I have no animals stabled with me at the moment!</pre>

Fragment 2 in file Scripts\Items\Addons\HitchingPost.cs

<pre>for (int i = 0; i < from.Stabled.Count; ++i)
                {
                    BaseCreature pet = from.Stabled[i] as BaseCreature;

                    if (pet == null || pet.Deleted)
                    {
                        pet.IsStabled = false;
                        from.Stabled.RemoveAt(i);
                        --i;
                        continue;
                    }

                    list.Add(pet);
                }

                if (list.Count > 0)
                    from.SendGump(new ClaimListGump(this, from, list));
                else
                    from.SendLocalizedMessage(502671); // But I have no animals stabled with me at the moment!</pre>

## Duplicated Code. Size: 194

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\RoseRug.cs

<pre>public override void OnComponentUsed(AddonComponent component, Mobile from)
        {
            if (m_NextUse < DateTime.UtcNow)
            {
                Container cont = from.Backpack;

                Engines.Plants.Seed seed = new Engines.Plants.Seed();

                if (cont == null || !cont.TryDropItem(from, seed, false))
                {
                    from.BankBox.DropItem(seed);
                    from.SendLocalizedMessage(1072224); // An item has been placed in your bank box.
                }
                else
                    from.SendLocalizedMessage(1072223); // An item has been placed in your backpack.

                m_NextUse = DateTime.UtcNow + TimeSpan.FromDays(7);
            }
        }</pre>

Fragment 2 in file Scripts\Items\Addons\RoseRug.cs

<pre>public override void OnComponentUsed(AddonComponent component, Mobile from)
        {
            if (m_NextUse < DateTime.UtcNow)
            {
                Container cont = from.Backpack;

                Engines.Plants.Seed seed = new Engines.Plants.Seed();

                if (cont == null || !cont.TryDropItem(from, seed, false))
                {
                    from.BankBox.DropItem(seed);
                    from.SendLocalizedMessage(1072224); // An item has been placed in your bank box.
                }
                else
                    from.SendLocalizedMessage(1072223); // An item has been placed in your backpack.

                m_NextUse = DateTime.UtcNow + TimeSpan.FromDays(7);
            }
        }</pre>

## Duplicated Code. Size: 194

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>SetResistance( ResistanceType.Physical, 65, 75 );
			SetResistance( ResistanceType.Fire, 65, 75 );
			SetResistance( ResistanceType.Cold, 65, 75 );
			SetResistance( ResistanceType.Poison, 65, 75 );
			SetResistance( ResistanceType.Energy, 65, 75 );

			SetSkill( SkillName.MagicResist, 100, 110 );
			SetSkill( SkillName.Tactics, 110, 130 );
			SetSkill( SkillName.Wrestling, 124, 140 );

			Fame = 22500;
			Karma = -22500;</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>SetResistance( ResistanceType.Physical, 65, 75 );
			SetResistance( ResistanceType.Fire, 65, 75 );
			SetResistance( ResistanceType.Cold, 65, 75 );
			SetResistance( ResistanceType.Poison, 65, 75 );
			SetResistance( ResistanceType.Energy, 65, 75 );

			SetSkill( SkillName.MagicResist, 100, 110 );
			SetSkill( SkillName.Tactics, 110, 130 );
			SetSkill( SkillName.Wrestling, 124, 140 );

			Fame = 22500;
			Karma = -22500;</pre>

## Duplicated Code. Size: 194

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlGetAttachGump.cs

<pre>case 201: // forward block
				{
					// clear the selections
					if(m_SelectionList != null && !SelectAll) Array.Clear(m_SelectionList,0,m_SelectionList.Length);
					if(m_SearchList != null && DisplayFrom + MaxEntries < m_SearchList.Count) {
						DisplayFrom += MaxEntries;
						// clear any selection
						Selected = -1;
					}
					break;
				}
				case 202: // backward block
				{
					// clear the selections
					if(m_SelectionList != null && !SelectAll) Array.Clear(m_SelectionList,0,m_SelectionList.Length);
					DisplayFrom -= MaxEntries;
					if(DisplayFrom < 0) DisplayFrom = 0;
					// clear any selection
					Selected = -1;
					break;
				}

				case 700: // Sort</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlEdit.cs

<pre>case 201: // forward block
				{
					// clear the selections
					if(m_SelectionList != null && !SelectAll) Array.Clear(m_SelectionList,0,m_SelectionList.Length);
					if(m_SearchList != null && DisplayFrom + MaxEntries < m_SearchList.Count) 
					{
						DisplayFrom += MaxEntries;
						// clear any selection
						Selected = -1;
					}
					break;
				}
				case 202: // backward block
				{
					// clear the selections
					if(m_SelectionList != null && !SelectAll) Array.Clear(m_SelectionList,0,m_SelectionList.Length);
					DisplayFrom -= MaxEntries;
					if(DisplayFrom < 0) DisplayFrom = 0;
					// clear any selection
					Selected = -1;
					break;
				}

				case 700: // Sort</pre>

## Duplicated Code. Size: 194

### Duplicated Fragments:

Fragment 1 in file Server\Random.cs

<pre>public unsafe double NextDouble()
		{
			var b = new byte[8];

			if (BitConverter.IsLittleEndian)
			{
				b[7] = 0;
				_GetBytes(b, 0, 7);
			}
			else
			{
				b[0] = 0;
				_GetBytes(b, 1, 7);
			}

			ulong r = 0;
			fixed (byte* buf = b)
			{
				r = *(ulong*)(&buf[0]) >> 3;
			}

			/* double: 53 bits of significand precision
			 * ulong.MaxValue >> 11 = 9007199254740991
			 * 2^53 = 9007199254740992
			 */

			return (double)r / 9007199254740992;
		}</pre>

Fragment 2 in file Server\Random.cs

<pre>public unsafe double NextDouble()
		{
			var b = new byte[8];

			if (BitConverter.IsLittleEndian)
			{
				b[7] = 0;
				_GetBytes(b, 0, 7);
			}
			else
			{
				b[0] = 0;
				_GetBytes(b, 1, 7);
			}

			ulong r = 0;
			fixed (byte* buf = b)
			{
				r = *(ulong*)(&buf[0]) >> 3;
			}

			/* double: 53 bits of significand precision
			 * ulong.MaxValue >> 11 = 9007199254740991
			 * 2^53 = 9007199254740992
			 */

			return (double)r / 9007199254740992;
		}</pre>

Fragment 3 in file Server\Random.cs

<pre>public unsafe double NextDouble()
		{
			var b = new byte[8];

			if (BitConverter.IsLittleEndian)
			{
				b[7] = 0;
				_GetBytes(b, 0, 7);
			}
			else
			{
				b[0] = 0;
				_GetBytes(b, 1, 7);
			}

			ulong r = 0;
			fixed (byte* buf = b)
			{
				r = *(ulong*)(&buf[0]) >> 3;
			}

			/* double: 53 bits of significand precision
			 * ulong.MaxValue >> 11 = 9007199254740991
			 * 2^53 = 9007199254740992
			 */

			return (double)r / 9007199254740992;
		}</pre>

## Duplicated Code. Size: 193

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AdminGump.cs

<pre>if (listPage > 0)
                            this.AddButton(375, 122, 0x15E3, 0x15E7, this.GetButtonID(1, 0), GumpButtonType.Reply, 0);
                        else
                            this.AddImage(375, 122, 0x25EA);

                        if ((listPage + 1) * 12 < this.m_List.Count)
                            this.AddButton(392, 122, 0x15E1, 0x15E5, this.GetButtonID(1, 1), GumpButtonType.Reply, 0);
                        else
                            this.AddImage(392, 122, 0x25E6);</pre>

Fragment 2 in file Scripts\Gumps\AdminGump.cs

<pre>if (listPage > 0)
                            this.AddButton(375, 122, 0x15E3, 0x15E7, this.GetButtonID(1, 0), GumpButtonType.Reply, 0);
                        else
                            this.AddImage(375, 122, 0x25EA);

                        if ((listPage + 1) * 12 < this.m_List.Count)
                            this.AddButton(392, 122, 0x15E1, 0x15E5, this.GetButtonID(1, 1), GumpButtonType.Reply, 0);
                        else
                            this.AddImage(392, 122, 0x25E6);</pre>

## Duplicated Code. Size: 193

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DeathWatchBeetle.cs

<pre>switch ( Utility.Random(12) )
            {
                case 0:
                    this.PackItem(new LeatherGorget());
                    break;
                case 1:
                    this.PackItem(new LeatherGloves());
                    break;
                case 2:
                    this.PackItem(new LeatherArms());
                    break;
                case 3:
                    this.PackItem(new LeatherLegs());
                    break;
                case 4:
                    this.PackItem(new LeatherCap());
                    break;
                case 5:
                    this.PackItem(new LeatherChest());
                    break;
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DeathWatchBeetleHatchling.cs

<pre>switch ( Utility.Random(12) )
            {
                case 0:
                    this.PackItem(new LeatherGorget());
                    break;
                case 1:
                    this.PackItem(new LeatherGloves());
                    break;
                case 2:
                    this.PackItem(new LeatherArms());
                    break;
                case 3:
                    this.PackItem(new LeatherLegs());
                    break;
                case 4:
                    this.PackItem(new LeatherCap());
                    break;
                case 5:
                    this.PackItem(new LeatherChest());
                    break;
            }</pre>

## Duplicated Code. Size: 193

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGauntlet.cs

<pre>public override void OnPlayerKilled(Mobile killer, Mobile killed)
        {
            if(killed == null) return;

            if(AutoRes)
            {
                // prepare the autores callback
                    Timer.DelayCall( RespawnTime, new TimerStateCallback( XmlPoints.AutoRes_Callback ),
                    new object[]{ killed, true } );
            }

			// add 15 seconds of res kill protection
			//XmlAttach.AttachTo(killed, new XmlBless(15.0));

            // find the player in the participants list and announce it
            if(m_Participants != null)
            {

                foreach(ChallengeEntry entry in m_Participants)
                {
                    if(entry.Status == ChallengeStatus.Active && entry.Participant == killed)
                    {
                        GameBroadcast(100314, killed.Name); // "{0} has been killed"
                        SubtractScore(entry);
                    }
                }
            }

            // see if the game is over
            CheckForGameEnd();
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGauntlet.cs

<pre>public override void OnPlayerKilled(Mobile killer, Mobile killed)
        {
            if(killed == null) return;

            if(AutoRes)
            {
                // prepare the autores callback
                    Timer.DelayCall( RespawnTime, new TimerStateCallback( XmlPoints.AutoRes_Callback ),
                    new object[]{ killed, true } );
            }

            // find the player in the participants list and announce it
            if(m_Participants != null)
            {

                foreach(ChallengeEntry entry in m_Participants)
                {
                    if(entry.Status == ChallengeStatus.Active && entry.Participant == killed)
                    {
                        GameBroadcast(100314, killed.Name); // "{0} has been killed"
                        SubtractScore(entry);
                    }
                }
            }

            // see if the game is over
            CheckForGameEnd();
        }</pre>

## Duplicated Code. Size: 193

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>{
			m_Stream.Write(t.AllowGround);
			m_Stream.Write(t.TargetID);
			m_Stream.Write((byte)t.Flags);

			m_Stream.Fill();

			m_Stream.Seek(18, SeekOrigin.Begin);
			m_Stream.Write((short)t.MultiID);
			m_Stream.Write((short)t.Offset.X);
			m_Stream.Write((short)t.Offset.Y);
			m_Stream.Write((short)t.Offset.Z);
		}</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>{
			m_Stream.Write(t.AllowGround);
			m_Stream.Write(t.TargetID);
			m_Stream.Write((byte)t.Flags);

			m_Stream.Fill();

			m_Stream.Seek(18, SeekOrigin.Begin);
			m_Stream.Write((short)t.MultiID);
			m_Stream.Write((short)t.Offset.X);
			m_Stream.Write((short)t.Offset.Y);
			m_Stream.Write((short)t.Offset.Z);
		}</pre>

## Duplicated Code. Size: 193

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\ArcaneBookshelfEastAddon.cs

<pre>deed.MoveToWorld(this.Location, this.Map);

                deed.IsLockedDown = IsLockedDown;
                deed.IsSecure = IsSecure;
                deed.Movable = Movable;

                if (house != null && house.LockDowns.ContainsKey(this))
                {
                    house.LockDowns.Remove(this);
                    house.LockDowns.Add(deed, house.Owner);
                }
                else if (house != null && house.Secures.Contains(this))
                {
                    house.Secures.Remove(this);
                    house.Secures.Add(deed);
                }</pre>

Fragment 2 in file Scripts\Items\Addons\ArcaneBookshelfSouthAddon.cs

<pre>deed.MoveToWorld(this.Location, this.Map);

                deed.IsLockedDown = IsLockedDown;
                deed.IsSecure = IsSecure;
                deed.Movable = Movable;

                if (house != null && house.LockDowns.ContainsKey(this))
                {
                    house.LockDowns.Remove(this);
                    house.LockDowns.Add(deed, house.Owner);
                }
                else if (house != null && house.Secures.Contains(this))
                {
                    house.Secures.Remove(this);
                    house.Secures.Add(deed);
                }</pre>

Fragment 3 in file Scripts\Items\Addons\ElvenDresserEastAddon.cs

<pre>deed.MoveToWorld(this.Location, this.Map);

                deed.IsLockedDown = IsLockedDown;
                deed.IsSecure = IsSecure;
                deed.Movable = Movable;

                if (house != null && house.LockDowns.ContainsKey(this))
                {
                    house.LockDowns.Remove(this);
                    house.LockDowns.Add(deed, house.Owner);
                }
                else if (house != null && house.Secures.Contains(this))
                {
                    house.Secures.Remove(this);
                    house.Secures.Add(deed);
                }</pre>

Fragment 4 in file Scripts\Items\Addons\ElvenDresserSouthAddon.cs

<pre>deed.MoveToWorld(this.Location, this.Map);

                deed.IsLockedDown = IsLockedDown;
                deed.IsSecure = IsSecure;
                deed.Movable = Movable;

                if (house != null && house.LockDowns.ContainsKey(this))
                {
                    house.LockDowns.Remove(this);
                    house.LockDowns.Add(deed, house.Owner);
                }
                else if (house != null && house.Secures.Contains(this))
                {
                    house.Secures.Remove(this);
                    house.Secures.Add(deed);
                }</pre>

## Duplicated Code. Size: 192

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>Item item = null;

                                List<Item> items = this.m_Vendor.Items;

                                for (int i = 0; item == null && i < items.Count; ++i)
                                {
                                    Item checkitem = items[i];
                                    Type type = checkitem.GetType();

                                    for (int j = 0; item == null && j < category.Entries.Length; ++j)
                                    {
                                        if (type == category.Entries[j].Type)
                                            item = checkitem;
                                    }
                                }</pre>

Fragment 2 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>Item item = null;

                                List<Item> items = this.m_Vendor.Items;

                                for (int i = 0; item == null && i < items.Count; ++i)
                                {
                                    Item checkitem = items[i];
                                    Type type = checkitem.GetType();

                                    for (int j = 0; item == null && j < category.Entries.Length; ++j)
                                    {
                                        if (type == category.Entries[j].Type)
                                            item = checkitem;
                                    }
                                }</pre>

## Duplicated Code. Size: 192

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SpecialBeardDye.cs

<pre>this.AddButton(200, 380, 0xFA5, 0xFA7, 1, GumpButtonType.Reply, 0);        // DYE HAIR

            for (int i = 0; i < m_Entries.Length; ++i)
            {
                this.AddLabel(180, 109 + (i * 22), m_Entries[i].HueStart - 1, m_Entries[i].Name);
                this.AddButton(257, 110 + (i * 22), 5224, 5224, 0, GumpButtonType.Page, i + 1);
            }</pre>

Fragment 2 in file Scripts\Items\Consumables\SpecialHairDye.cs

<pre>this.AddButton(200, 380, 0xFA5, 0xFA7, 1, GumpButtonType.Reply, 0);        // DYE HAIR

            for (int i = 0; i < m_Entries.Length; ++i)
            {
                this.AddLabel(180, 109 + (i * 22), m_Entries[i].HueStart - 1, m_Entries[i].Name);
                this.AddButton(257, 110 + (i * 22), 5224, 5224, 0, GumpButtonType.Page, i + 1);
            }</pre>

## Duplicated Code. Size: 192

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Spellbooks\Spellbook.cs

<pre>if ((prop = m_AosAttributes.BonusHits) != 0)
			{
				list.Add(1060431, prop.ToString()); // hit point increase ~1_val~
			}

			if ((prop = m_AosAttributes.BonusInt) != 0)
			{
				list.Add(1060432, prop.ToString()); // intelligence bonus ~1_val~
			}

			if ((prop = m_AosAttributes.LowerManaCost) != 0)
			{
				list.Add(1060433, prop.ToString()); // lower mana cost ~1_val~%
			}

			if ((prop = m_AosAttributes.LowerRegCost) != 0)
			{
				list.Add(1060434, prop.ToString()); // lower reagent cost ~1_val~%
			}</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if ((prop = m_AosAttributes.BonusHits) != 0)
			{
				list.Add(1060431, prop.ToString()); // hit point increase ~1_val~
			}

			if ((prop = m_AosAttributes.BonusInt) != 0)
			{
				list.Add(1060432, prop.ToString()); // intelligence bonus ~1_val~
			}

			if ((prop = m_AosAttributes.LowerManaCost) != 0)
			{
				list.Add(1060433, prop.ToString()); // lower mana cost ~1_val~%
			}

			if ((prop = m_AosAttributes.LowerRegCost) != 0)
			{
				list.Add(1060434, prop.ToString()); // lower reagent cost ~1_val~%
			}</pre>

## Duplicated Code. Size: 192

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\Teleporter.cs

<pre>bool sendEffect = (!m.Hidden || m.IsPlayer());

			if (m_SourceEffect && sendEffect)
			{
				Effects.SendLocationEffect(m.Location, m.Map, 0x3728, 10, 10);
			}

			m.MoveToWorld(p, map);

			if (m_DestEffect && sendEffect)
			{
				Effects.SendLocationEffect(m.Location, m.Map, 0x3728, 10, 10);
			}

			if (m_SoundID > 0 && sendEffect)
			{
				Effects.PlaySound(m.Location, m.Map, m_SoundID);
			}</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\Teleporter\Whirlpool.cs

<pre>bool sendEffect = (!m.Hidden || m.IsPlayer());

            if (m_SourceEffect && sendEffect)
            {
                Effects.SendLocationEffect(m.Location, m.Map, 0x3728, 10, 10);
            }

            m.MoveToWorld(p, map);

            if (m_DestEffect && sendEffect)
            {
                Effects.SendLocationEffect(m.Location, m.Map, 0x3728, 10, 10);
            }

            if (m_SoundID > 0 && sendEffect)
            {
                Effects.PlaySound(m.Location, m.Map, m_SoundID);
            }</pre>

## Duplicated Code. Size: 192

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Items.cs

<pre>case VirtueType.Honesty: return this.VirtueType == VirtueType.Deceit;
                case VirtueType.Compassion: return this.VirtueType == VirtueType.Despise;
                case VirtueType.Valor: return this.VirtueType == VirtueType.Destard;
                case VirtueType.Justice: return this.VirtueType == VirtueType.Wrong;
                case VirtueType.Sacrafice: return this.VirtueType == VirtueType.Covetous;
                case VirtueType.Honor: return this.VirtueType == VirtueType.Shame;
                case VirtueType.Spirituality: return this.VirtueType == VirtueType.Hythloth;
                case VirtueType.Humility: return this.VirtueType == VirtueType.Pride;</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Items.cs

<pre>case VirtueType.Deceit: return this.VirtueType == VirtueType.Honesty;
                case VirtueType.Despise: return this.VirtueType == VirtueType.Compassion;
                case VirtueType.Destard: return this.VirtueType == VirtueType.Valor;
                case VirtueType.Wrong: return this.VirtueType == VirtueType.Justice;
                case VirtueType.Covetous: return this.VirtueType == VirtueType.Sacrafice;
                case VirtueType.Shame: return this.VirtueType == VirtueType.Honor;
                case VirtueType.Hythloth: return this.VirtueType == VirtueType.Spirituality;
                case VirtueType.Pride: return this.VirtueType == VirtueType.Humility;</pre>

## Duplicated Code. Size: 192

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusArchZealot.cs

<pre>AddHtmlLocalized(155, 340, 250, 24, 1153686, White, false, false);
            AddButton(125, 340, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 9);//The Rogue?

            AddHtmlLocalized(155, 360, 250, 24, 1153688, White, false, false);
            AddButton(125, 360, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 10);//The Craftsman?

            AddButton(325, 390, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusArchZealot.cs

<pre>AddHtmlLocalized(155, 340, 250, 24, 1153686, White, false, false);
            AddButton(125, 340, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 9);//The Rogue?

            AddHtmlLocalized(155, 360, 250, 24, 1153688, White, false, false);
            AddButton(125, 360, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 10);//The Craftsman?

            AddButton(325, 390, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK</pre>

## Duplicated Code. Size: 192

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>AddLabel( 20, 30, 0, String.Format(XmlPoints.GetText(from, 200501), gauntlet.Challenger.Name));  // "Organized by: {0}"
			AddLabel( 20, 50, 0, String.Format(XmlPoints.GetText(from, 200502), m_gauntlet.EntryFee));  // "Entry Fee: {0}"
			AddLabel( 20, 70, 0, String.Format(XmlPoints.GetText(from, 200503), m_gauntlet.ArenaSize));  // "Arena Size: {0}"

			AddImageTiled( 15, 110, 320, 20, 0xdb3 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>AddLabel( 20, 30, 0, String.Format(XmlPoints.GetText(from, 200501), gauntlet.Challenger.Name));  // "Organized by: {0}"
			AddLabel( 20, 50, 0, String.Format(XmlPoints.GetText(from, 200502), m_gauntlet.EntryFee));      // "Entry Fee: {0}"
			AddLabel( 20, 70, 0, String.Format(XmlPoints.GetText(from, 200503), m_gauntlet.ArenaSize)); // "Arena Size: {0}"

			AddImageTiled( 15, 110, 320, 20, 0xdb3 );</pre>

## Duplicated Code. Size: 192

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>int checkTop = checkZ + id.CalcHeight;

                if (checkTop == checkZ && !id.Surface)
                {
                    ++checkTop;
                }

                int zStart = checkZ - z;
                int zEnd = checkTop - z;

                if (zStart >= 20 || zEnd < 0)
                {
                    continue;
                }

                if (zStart < 0)
                {
                    zStart = 0;
                }

                if (zEnd > 19)
                {
                    zEnd = 19;
                }

                int bitCount = zEnd - zStart;

                m_OpenSlots &= ~(((1 << bitCount) - 1) << zStart);</pre>

Fragment 2 in file Server\Item.cs

<pre>int checkTop = checkZ + id.CalcHeight;

                if (checkTop == checkZ && !id.Surface)
                {
                    ++checkTop;
                }

                int zStart = checkZ - z;
                int zEnd = checkTop - z;

                if (zStart >= 20 || zEnd < 0)
                {
                    continue;
                }

                if (zStart < 0)
                {
                    zStart = 0;
                }

                if (zEnd > 19)
                {
                    zEnd = 19;
                }

                int bitCount = zEnd - zStart;

                m_OpenSlots &= ~(((1 << bitCount) - 1) << zStart);</pre>

## Duplicated Code. Size: 192

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>AddLabel(20, 30, 0, String.Format(XmlPoints.GetText(from, 200501), gauntlet.Challenger.Name));  // "Organized by: {0}"
			AddLabel(20, 50, 0, String.Format(XmlPoints.GetText(from, 200502), m_gauntlet.EntryFee));      // "Entry Fee: {0}"
			AddLabel(20, 70, 0, String.Format(XmlPoints.GetText(from, 200503), m_gauntlet.ArenaSize)); // "Arena Size: {0}"

			AddImageTiled(15, 130, 320, 20, 0xdb3);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>AddLabel( 20, 30, 0, String.Format(XmlPoints.GetText(from, 200501), gauntlet.Challenger.Name));  // "Organized by: {0}"
			AddLabel( 20, 50, 0, String.Format(XmlPoints.GetText(from, 200502), m_gauntlet.EntryFee));      // "Entry Fee: {0}"
			AddLabel( 20, 70, 0, String.Format(XmlPoints.GetText(from, 200503), m_gauntlet.ArenaSize)); // "Arena Size: {0}"

			AddImageTiled( 15, 130, 320, 20, 0xdb3 );</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>AddLabel( 20, 30, 0, String.Format(XmlPoints.GetText(from, 200501), gauntlet.Challenger.Name));  // "Organized by: {0}"
			AddLabel( 20, 50, 0, String.Format(XmlPoints.GetText(from, 200502), m_gauntlet.EntryFee));      // "Entry Fee: {0}"
			AddLabel( 20, 70, 0, String.Format(XmlPoints.GetText(from, 200503), m_gauntlet.ArenaSize)); // "Arena Size: {0}"

			AddImageTiled( 15, 130, 320, 20, 0xdb3 );</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>AddLabel( 20, 30, 0, String.Format(XmlPoints.GetText(from, 200501), gauntlet.Challenger.Name));  // "Organized by: {0}"
			AddLabel( 20, 50, 0, String.Format(XmlPoints.GetText(from, 200502), m_gauntlet.EntryFee));      // "Entry Fee: {0}"
			AddLabel( 20, 70, 0, String.Format(XmlPoints.GetText(from, 200503), m_gauntlet.ArenaSize)); // "Arena Size: {0}"

			AddImageTiled( 15, 130, 320, 20, 0xdb3 );</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>AddLabel( 20, 30, 0, String.Format(XmlPoints.GetText(from, 200501), gauntlet.Challenger.Name));  // "Organized by: {0}"
			AddLabel( 20, 50, 0, String.Format(XmlPoints.GetText(from, 200502), m_gauntlet.EntryFee));      // "Entry Fee: {0}"
			AddLabel( 20, 70, 0, String.Format(XmlPoints.GetText(from, 200503), m_gauntlet.ArenaSize)); // "Arena Size: {0}"

			AddImageTiled( 15, 130, 320, 20, 0xdb3 );</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>AddLabel( 20, 30, 0, String.Format(XmlPoints.GetText(from, 200501), gauntlet.Challenger.Name));  // "Organized by: {0}"
			AddLabel( 20, 50, 0, String.Format(XmlPoints.GetText(from, 200502), m_gauntlet.EntryFee));      // "Entry Fee: {0}"
			AddLabel( 20, 70, 0, String.Format(XmlPoints.GetText(from, 200503), m_gauntlet.ArenaSize)); // "Arena Size: {0}"

			AddImageTiled( 15, 130, 320, 20, 0xdb3 );</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>AddLabel( 20, 30, 0, String.Format(XmlPoints.GetText(from, 200501), gauntlet.Challenger.Name));  // "Organized by: {0}"
			AddLabel( 20, 50, 0, String.Format(XmlPoints.GetText(from, 200502), m_gauntlet.EntryFee));      // "Entry Fee: {0}"
			AddLabel( 20, 70, 0, String.Format(XmlPoints.GetText(from, 200503), m_gauntlet.ArenaSize)); // "Arena Size: {0}"

			AddImageTiled( 15, 130, 320, 20, 0xdb3 );</pre>

## Duplicated Code. Size: 191

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseShield.cs

<pre>if (wear > 0 && this.MaxHitPoints > 0)
                    {
                        if (this.HitPoints >= wear)
                        {
                            this.HitPoints -= wear;
                            wear = 0;
                        }
                        else
                        {
                            wear -= this.HitPoints;
                            this.HitPoints = 0;
                        }

                        if (wear > 0)
                        {
                            if (this.MaxHitPoints > wear)
                            {
                                this.MaxHitPoints -= wear;

                                if (this.Parent is Mobile)
                                    ((Mobile)this.Parent).LocalOverheadMessage(MessageType.Regular, 0x3B2, 1061121); // Your equipment is severely damaged.
                            }
                            else
                            {
                                this.Delete();
                            }
                        }
                    }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\BaseShield.cs

<pre>if (wear > 0 && this.MaxHitPoints > 0)
                        {
                            if (this.HitPoints >= wear)
                            {
                                this.HitPoints -= wear;
                                wear = 0;
                            }
                            else
                            {
                                wear -= this.HitPoints;
                                this.HitPoints = 0;
                            }

                            if (wear > 0)
                            {
                                if (this.MaxHitPoints > wear)
                                {
                                    this.MaxHitPoints -= wear;

                                    if (this.Parent is Mobile)
                                        ((Mobile)this.Parent).LocalOverheadMessage(MessageType.Regular, 0x3B2, 1061121); // Your equipment is severely damaged.
                                }
                                else
                                {
                                    this.Delete();
                                }
                            }
                        }</pre>

## Duplicated Code. Size: 191

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\MondainsLegacy.cs

<pre>{
            typeof(AegisOfGrace), typeof(BladeDance), typeof(BloodwoodSpirit), typeof(Bonesmasher),
            typeof(Boomstick), typeof(BrightsightLenses), typeof(FeyLeggings), typeof(FleshRipper),
            typeof(HelmOfSwiftness), typeof(PadsOfTheCuSidhe), typeof(QuiverOfRage), typeof(QuiverOfElements),
            typeof(RaedsGlory), typeof(RighteousAnger), typeof(RobeOfTheEclipse), typeof(RobeOfTheEquinox),
            typeof(SoulSeeker), typeof(TalonBite), typeof(TotemOfVoid), typeof(WildfireBow),
            typeof(Windsong)
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>{
            typeof(AegisOfGrace), typeof(BladeDance), typeof(Bonesmasher), typeof(FeyLeggings), typeof(FleshRipper),
            typeof(HelmOfSwiftness), typeof(PadsOfTheCuSidhe), typeof(RaedsGlory), typeof(RighteousAnger),
            typeof(RobeOfTheEclipse), typeof(RobeOfTheEquinox), typeof(SoulSeeker), typeof(TalonBite), typeof(BloodwoodSpirit),
            typeof(TotemOfVoid), typeof(QuiverOfRage), typeof(QuiverOfElements), typeof(BrightsightLenses), typeof(Boomstick),
            typeof(WildfireBow), typeof(Windsong)
        }</pre>

## Duplicated Code. Size: 191

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BasketWeaving\MiscSAResources.cs

<pre>public override void AddNameProperty(ObjectPropertyList list)
        {
            PlantHueInfo info = PlantHueInfo.GetInfo(m_PlantHue);
            int cliloc;

            if (Amount > 1)
            {
                cliloc = info.IsBright() ? 1113273 : 1113275;
                list.Add(cliloc, String.Format("{0}\t#{1}", Amount.ToString(), info.Name));
            }
            else
            {
                cliloc = info.IsBright() ? 1112288 : 1112289;
                list.Add(cliloc, String.Format("#{0}", info.Name));
            }
        }</pre>

Fragment 2 in file Scripts\Services\BasketWeaving\MiscSAResources.cs

<pre>public override void AddNameProperty(ObjectPropertyList list)
        {

            PlantHueInfo info = PlantHueInfo.GetInfo(m_PlantHue);
            int cliloc;

            if (Amount > 1)
            {
                cliloc = info.IsBright() ? 1113273 : 1113275;
                list.Add(cliloc, String.Format("{0}\t#{1}", Amount.ToString(), info.Name));
            }
            else
            {
                cliloc = info.IsBright() ? 1112288 : 1112289;
                list.Add(cliloc, String.Format("#{0}", info.Name));
            }
        }</pre>

## Duplicated Code. Size: 191

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBMage.cs

<pre>Type[] types = Loot.RegularScrollTypes;

                int circles = 3;

                for (int i = 0; i < circles * 8 && i < types.Length; ++i)
                {
                    int itemID = 0x1F2E + i;

                    if (i == 6)
                        itemID = 0x1F2D;
                    else if (i > 6)
                        --itemID;

                    this.Add(new GenericBuyInfo(types[i], 12 + ((i / 8) * 10), 20, itemID, 0));
                }</pre>

Fragment 2 in file Scripts\VendorInfo\SBVarietyDealer.cs

<pre>Type[] types = Loot.RegularScrollTypes;

                int circles = 3;

                for (int i = 0; i < circles * 8 && i < types.Length; ++i)
                {
                    int itemID = 0x1F2E + i;

                    if (i == 6)
                        itemID = 0x1F2D;
                    else if (i > 6)
                        --itemID;

                    this.Add(new GenericBuyInfo(types[i], 12 + ((i / 8) * 10), 20, itemID, 0));
                }</pre>

## Duplicated Code. Size: 190

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\FlourMillEastAddon.cs

<pre>public void UpdateStage(FlourMillStage stage)
        {
            List<AddonComponent> components = this.Components;

            int[][] stageTable = m_StageTable;

            for (int i = 0; i < components.Count; ++i)
            {
                AddonComponent component = components[i] as AddonComponent;

                if (component == null)
                    continue;

                int[] itemTable = this.FindItemTable(component.ItemID);

                if (itemTable != null)
                    component.ItemID = itemTable[(int)stage];
            }
        }</pre>

Fragment 2 in file Scripts\Items\Addons\FlourMillSouthAddon.cs

<pre>public void UpdateStage(FlourMillStage stage)
        {
            List<AddonComponent> components = this.Components;

            int[][] stageTable = m_StageTable;

            for (int i = 0; i < components.Count; ++i)
            {
                AddonComponent component = components[i] as AddonComponent;

                if (component == null)
                    continue;

                int[] itemTable = this.FindItemTable(component.ItemID);

                if (itemTable != null)
                    component.ItemID = itemTable[(int)stage];
            }
        }</pre>

## Duplicated Code. Size: 190

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>string typeName = BaseXmlSpawner.ParseObjectType(substitutedtypeName);

            Point3D loc = new Point3D(0, 0, 0);
            Map map = null;

            if (AttachedTo is Mobile)
            {
                Mobile m = AttachedTo as Mobile;
                loc = m.Location;
                map = m.Map;
            }
            else
                if (AttachedTo is Item && ((Item)AttachedTo).Parent == null)
                {
                    Item i = AttachedTo as Item;
                    loc = i.Location;
                    map = i.Map;
                }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>string typeName = BaseXmlSpawner.ParseObjectType(substitutedtypeName);

            Point3D loc = new Point3D(0, 0, 0);
            Map map = null;

            if (AttachedTo is Mobile)
            {
                Mobile m = AttachedTo as Mobile;
                loc = m.Location;
                map = m.Map;
            }
            else
                if (AttachedTo is Item && ((Item)AttachedTo).Parent == null)
                {
                    Item i = AttachedTo as Item;
                    loc = i.Location;
                    map = i.Map;
                }</pre>

## Duplicated Code. Size: 190

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>if (criteria.Dosearchtype && (i.GetType().IsSubclassOf(targetType) || i.GetType().Equals(targetType)))
						{
							hastype = true;
						}
						if (criteria.Dosearchtype && !hastype) continue;

						// check for name
						if (criteria.Dosearchname && (i.Name != null) && (criteria.Searchname != null) && (i.Name.ToLower().IndexOf(criteria.Searchname.ToLower()) >= 0))
						{
							hasname = true;
						}
						if (criteria.Dosearchname && !hasname) continue;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>if (criteria.Dosearchtype && (i.GetType().IsSubclassOf(targetType) || i.GetType().Equals(targetType)))
						{
							hastype = true;
						}
						if (criteria.Dosearchtype && !hastype) continue;

						// check for name
						if (criteria.Dosearchname && (i.Name != null) && (criteria.Searchname != null) && (i.Name.ToLower().IndexOf(criteria.Searchname.ToLower()) >= 0))
						{
							hasname = true;
						}
						if (criteria.Dosearchname && !hasname) continue;</pre>

## Duplicated Code. Size: 190

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGauntlet.cs

<pre>case 0:
                m_Challenger = reader.ReadMobile();

                m_Organizers.Add(m_Challenger);

                m_GameLocked = reader.ReadBool();
                m_GameInProgress = reader.ReadBool();
                m_TotalPurse = reader.ReadInt();
                m_EntryFee = reader.ReadInt();
                m_ArenaSize = reader.ReadInt();
                m_TargetScore = reader.ReadInt();
                m_MatchLength = reader.ReadTimeSpan();

                TimeSpan elapsed = reader.ReadTimeSpan();

                if(elapsed > TimeSpan.Zero)
                {
                    m_MatchStart = DateTime.UtcNow - elapsed;
                }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGauntlet.cs

<pre>case 0:
                m_Challenger = reader.ReadMobile();

                m_Organizers.Add(m_Challenger);

                m_GameLocked = reader.ReadBool();
                m_GameInProgress = reader.ReadBool();
                m_TotalPurse = reader.ReadInt();
                m_EntryFee = reader.ReadInt();
                m_ArenaSize = reader.ReadInt();
                m_TargetScore = reader.ReadInt();
                m_MatchLength = reader.ReadTimeSpan();

                TimeSpan elapsed = reader.ReadTimeSpan();

                if(elapsed > TimeSpan.Zero)
                {
                    m_MatchStart = DateTime.UtcNow - elapsed;
                }</pre>

## Duplicated Code. Size: 190

### Duplicated Fragments:

Fragment 1 in file Server\Geometry.cs

<pre>int start = value.IndexOf('(');
			int end = value.IndexOf(',', start + 1);

			string param1 = value.Substring(start + 1, end - (start + 1)).Trim();

			start = end;
			end = value.IndexOf(',', start + 1);

			string param2 = value.Substring(start + 1, end - (start + 1)).Trim();

			start = end;</pre>

Fragment 2 in file Server\Geometry.cs

<pre>int start = value.IndexOf('(');
			int end = value.IndexOf(',', start + 1);

			string param1 = value.Substring(start + 1, end - (start + 1)).Trim();

			start = end;
			end = value.IndexOf(',', start + 1);

			string param2 = value.Substring(start + 1, end - (start + 1)).Trim();

			start = end;</pre>

## Duplicated Code. Size: 189

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>m_ReforgedPrefix = (ReforgedPrefix)reader.ReadInt();
                        m_ReforgedSuffix = (ReforgedSuffix)reader.ReadInt();
                        m_ItemPower = (ItemPower)reader.ReadInt();
                        m_BlockRepair = reader.ReadBool();
                        #endregion

                        #region Stygian Abyss
                        m_GorgonLenseCharges = reader.ReadInt();
                        m_GorgonLenseType = (LenseType)reader.ReadInt();

                        m_PhysImbuing = reader.ReadInt();
                        m_FireImbuing = reader.ReadInt();
                        m_ColdImbuing = reader.ReadInt();
                        m_PoisonImbuing = reader.ReadInt();
                        m_EnergyImbuing = reader.ReadInt();</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>m_ReforgedPrefix = (ReforgedPrefix)reader.ReadInt();
                        m_ReforgedSuffix = (ReforgedSuffix)reader.ReadInt();
                        m_ItemPower = (ItemPower)reader.ReadInt();
                        m_BlockRepair = reader.ReadBool();
                        #endregion

                        #region Stygian Abyss
                        m_GorgonLenseCharges = reader.ReadInt();
                        m_GorgonLenseType = (LenseType)reader.ReadInt();

                        m_PhysImbuing = reader.ReadInt();
                        m_FireImbuing = reader.ReadInt();
                        m_ColdImbuing = reader.ReadInt();
                        m_PoisonImbuing = reader.ReadInt();
                        m_EnergyImbuing = reader.ReadInt();</pre>

## Duplicated Code. Size: 189

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\LordOaks.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (0.25 > Utility.RandomDouble())
            {
                int toSap = Utility.RandomMinMax(20, 30);

                switch (Utility.Random(3))
                {
                    case 0:
                        defender.Damage(toSap, this);
                        Hits += toSap;
                        break;
                    case 1:
                        defender.Stam -= toSap;
                        Stam += toSap;
                        break;
                    case 2:
                        defender.Mana -= toSap;
                        Mana += toSap;
                        break;
                }
            }

            /*defender.Damage(Utility.Random(20, 10), this);
            defender.Stam -= Utility.Random(20, 10);
            defender.Mana -= Utility.Random(20, 10);*/
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\EtherealWarrior.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (0.25 > Utility.RandomDouble())
            {
                int toSap = Utility.RandomMinMax(20, 30);

                switch (Utility.Random(3))
                {
                    case 0:
                        defender.Damage(toSap, this);
                        Hits += toSap;
                        break;
                    case 1:
                        defender.Stam -= toSap;
                        Stam += toSap;
                        break;
                    case 2:
                        defender.Mana -= toSap;
                        Mana += toSap;
                        break;
                }
            }
            /*defender.Damage(Utility.Random(10, 10), this);
            defender.Stam -= Utility.Random(10, 10);
            defender.Mana -= Utility.Random(10, 10);*/
        }</pre>

## Duplicated Code. Size: 189

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>m.PlaySound(0x5B4);

            if (item == null)
            {
                return;
            }

            if (m.AddToBackpack(item))
            {
                m.SendLocalizedMessage(1062317);
                // For your valor in combating the fallen beast, a special artifact has been bestowed on you.
                m.SendLocalizedMessage(1072223); // An item has been placed in your backpack.
            }
            else if (m.BankBox != null && m.BankBox.TryDropItem(m, item, false))
            {
                m.SendLocalizedMessage(1062317);
                // For your valor in combating the fallen beast, a special artifact has been bestowed on you.
                m.SendLocalizedMessage(1072224); // An item has been placed in your bank box.
            }
            else
            {
                item.MoveToWorld(m.Location, m.Map);
                m.SendLocalizedMessage(1072523); // You find an artifact, but your backpack and bank are too full to hold it.
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>m.PlaySound(0x5B4);

            if (item == null)
            {
                return;
            }

            if (m.AddToBackpack(item))
            {
                m.SendLocalizedMessage(1062317);
                // For your valor in combating the fallen beast, a special artifact has been bestowed on you.
                m.SendLocalizedMessage(1072223); // An item has been placed in your backpack.
            }
            else if (m.BankBox != null && m.BankBox.TryDropItem(m, item, false))
            {
                m.SendLocalizedMessage(1062317);
                // For your valor in combating the fallen beast, a special artifact has been bestowed on you.
                m.SendLocalizedMessage(1072224); // An item has been placed in your bank box.
            }
            else
            {
                item.MoveToWorld(m.Location, m.Map);
                m.SendLocalizedMessage(1072523); // You find an artifact, but your backpack and bank are too full to hold it.
            }</pre>

## Duplicated Code. Size: 189

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\FanDancer.cs

<pre>if (0.8 > Utility.RandomDouble() && !attacker.InRange(this, 1))
            {
                /* Fan Throw
                * Effect: - To: "0x57D4F5B" - ItemId: "0x27A3" - ItemIdName: "Tessen" - FromLocation: "(992 299, 24)" - ToLocation: "(992 308, 22)" - Speed: "10" - Duration: "0" - FixedDirection: "False" - Explode: "False" - Hue: "0x0" - Render: "0x0"
                * Damage: 50-65
                */
                Effects.SendPacket(attacker, attacker.Map, new HuedEffect(EffectType.Moving, Serial.Zero, Serial.Zero, 0x27A3, this.Location, attacker.Location, 10, 0, false, false, 0, 0));
                AOS.Damage(attacker, this, Utility.RandomMinMax(50, 65), 100, 0, 0, 0, 0);
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\FanDancer.cs

<pre>if (0.8 > Utility.RandomDouble() && !attacker.InRange(this, 1))
            {
                /* Fan Throw
                * Effect: - To: "0x57D4F5B" - ItemId: "0x27A3" - ItemIdName: "Tessen" - FromLocation: "(992 299, 24)" - ToLocation: "(992 308, 22)" - Speed: "10" - Duration: "0" - FixedDirection: "False" - Explode: "False" - Hue: "0x0" - Render: "0x0"
                * Damage: 50-65
                */
                Effects.SendPacket(attacker, attacker.Map, new HuedEffect(EffectType.Moving, Serial.Zero, Serial.Zero, 0x27A3, this.Location, attacker.Location, 10, 0, false, false, 0, 0));
                AOS.Damage(attacker, this, Utility.RandomMinMax(50, 65), 100, 0, 0, 0, 0);
            }</pre>

## Duplicated Code. Size: 189

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Scout\ScoutBustier.cs

<pre>{
            this.Hue = 1148;
			this.Weight = 1;

            this.Attributes.BonusDex = 1;
            this.ArmorAttributes.MageArmor = 1;

            this.SetAttributes.BonusDex = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1148;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Scout\ScoutGloves.cs

<pre>{
            this.Hue = 1148;			
			this.Weight = 1;

            this.Attributes.BonusDex = 1;
            this.ArmorAttributes.MageArmor = 1;

            this.SetAttributes.BonusDex = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1148;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Scout\ScoutGorget.cs

<pre>{
            this.Hue = 1148;
            this.Weight = 1;

            this.Attributes.BonusDex = 1;
            this.ArmorAttributes.MageArmor = 1;

            this.SetAttributes.BonusDex = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1148;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

## Duplicated Code. Size: 189

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Sorcerers\SorcererFemaleChest.cs

<pre>{
            this.Hue = 1165;            
			this.Weight = 1;

            this.Attributes.BonusInt = 1;
            this.Attributes.LowerRegCost = 10;

            this.SetAttributes.BonusInt = 6;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.DefendChance = 10;
            this.SetAttributes.LowerManaCost = 5;
            this.SetAttributes.LowerRegCost = 40;

            this.SetHue = 1165;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Sorcerers\SorcererGloves.cs

<pre>{
            this.Hue = 1165;				
			this.Weight = 1;

            this.Attributes.BonusInt = 1;
            this.Attributes.LowerRegCost = 10;

            this.SetAttributes.BonusInt = 6;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.DefendChance = 10;
            this.SetAttributes.LowerManaCost = 5;
            this.SetAttributes.LowerRegCost = 40;

            this.SetHue = 1165;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Sorcerers\SorcererGorget.cs

<pre>{
            this.Hue = 1165;			
			this.Weight = 1;

            this.Attributes.BonusInt = 1;
            this.Attributes.LowerRegCost = 10;

            this.SetAttributes.BonusInt = 6;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.DefendChance = 10;
            this.SetAttributes.LowerManaCost = 5;
            this.SetAttributes.LowerRegCost = 40;

            this.SetHue = 1165;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Sorcerers\SorcererHat.cs

<pre>{
            this.Hue = 1165;
            this.Weight = 1;

            this.Attributes.BonusInt = 1;
            this.Attributes.LowerRegCost = 10;

            this.SetAttributes.BonusInt = 6;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.DefendChance = 10;
            this.SetAttributes.LowerManaCost = 5;
            this.SetAttributes.LowerRegCost = 40;

            this.SetHue = 1165;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Sorcerers\SorcererSkirt.cs

<pre>{
            this.Hue = 1165;			
			this.Weight = 1;

            this.Attributes.BonusInt = 1;
            this.Attributes.LowerRegCost = 10;

            this.SetAttributes.BonusInt = 6;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.DefendChance = 10;
            this.SetAttributes.LowerManaCost = 5;
            this.SetAttributes.LowerRegCost = 40;

            this.SetHue = 1165;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

## Duplicated Code. Size: 188

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\BaseConfirmGump.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            this.AddPage(0);

            this.AddImageTiled(0, 0, 348, 262, 0xA8E);
            this.AddAlphaRegion(0, 0, 348, 262);
            this.AddImage(0, 15, 0x27A8); 
            this.AddImageTiled(0, 30, 17, 200, 0x27A7);
            this.AddImage(0, 230, 0x27AA);</pre>

Fragment 2 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainResignGump.cs

<pre>this.Closable = false;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            this.AddPage(0);

            this.AddImageTiled(0, 0, 348, 262, 0xA8E);
            this.AddAlphaRegion(0, 0, 348, 262);
            this.AddImage(0, 15, 0x27A8);
            this.AddImageTiled(0, 30, 17, 200, 0x27A7);
            this.AddImage(0, 230, 0x27AA);</pre>

## Duplicated Code. Size: 188

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseEvilCreatures.cs

<pre>public override Mobile GetBardTarget(bool creaturesOnly = false)
        {
            IPooledEnumerable eable = this.Map.GetMobilesInRange(this.Location, RangePerception);

            Mobile closest = null;
            int range = 0;

            foreach (Mobile m in eable)
            {
                if (CanDoTarget(m))
                {
                    int dist = (int)GetDistanceToSqrt(m);

                    if (closest == null || dist < range)
                    {
                        closest = m;
                        range = dist;
                    }
                }
            }
            eable.Free();

            return closest;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DespiseGoodCreatures.cs

<pre>public override Mobile GetBardTarget(bool creaturesOnly = false)
        {
            IPooledEnumerable eable = this.Map.GetMobilesInRange(this.Location, RangePerception);

            Mobile closest = null;
            int range = 0;

            foreach (Mobile m in eable)
            {
                if (CanDoTarget(m))
                {
                    int dist = (int)GetDistanceToSqrt(m);

                    if (closest == null || dist < range)
                    {
                        closest = m;
                        range = dist;
                    }
                }
            }
            eable.Free();

            return closest;
        }</pre>

## Duplicated Code. Size: 188

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GargishRouser.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 30);
            this.SetResistance(ResistanceType.Fire, 50, 65);
            this.SetResistance(ResistanceType.Cold, 50, 65);
            this.SetResistance(ResistanceType.Poison, 50, 65);
            this.SetResistance(ResistanceType.Energy, 50, 65);

            this.SetSkill(SkillName.MagicResist, 140.0);
            this.SetSkill(SkillName.Tactics, 130);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\VoidManesfistation.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 30);
            this.SetResistance(ResistanceType.Fire, 50, 65);
            this.SetResistance(ResistanceType.Cold, 50, 65);
            this.SetResistance(ResistanceType.Poison, 50, 65);
            this.SetResistance(ResistanceType.Energy, 50, 65);

            this.SetSkill(SkillName.MagicResist, 140.0);
            this.SetSkill(SkillName.Tactics, 130);</pre>

## Duplicated Code. Size: 188

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>int iHue = 20 + this.Team * 40;
            int jHue = 25 + this.Team * 40;

            // Skills and Stats
            this.InitStats(125, 125, 125);
            this.Skills[SkillName.Magery].Base = 120;
            this.Skills[SkillName.EvalInt].Base = 120;
            this.Skills[SkillName.Anatomy].Base = 120;
            this.Skills[SkillName.Wrestling].Base = 120;
            this.Skills[SkillName.Meditation].Base = 120;</pre>

Fragment 2 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>int iHue = 20 + this.Team * 40;
            int jHue = 25 + this.Team * 40;

            // Skills and Stats
            this.InitStats(125, 125, 125);
            this.Skills[SkillName.Magery].Base = 120;
            this.Skills[SkillName.EvalInt].Base = 120;
            this.Skills[SkillName.Anatomy].Base = 120;
            this.Skills[SkillName.Wrestling].Base = 120;
            this.Skills[SkillName.Meditation].Base = 120;</pre>

## Duplicated Code. Size: 187

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SignGenDelete.cs

<pre>Map[] brit = new Map[] { Map.Felucca, Map.Trammel };
                Map[] fel = new Map[] { Map.Felucca };
                Map[] tram = new Map[] { Map.Trammel };
                Map[] ilsh = new Map[] { Map.Ilshenar };
                Map[] malas = new Map[] { Map.Malas };
                Map[] tokuno = new Map[] { Map.Tokuno };</pre>

Fragment 2 in file Scripts\Commands\SignParser.cs

<pre>Map[] brit = new Map[] { Map.Felucca, Map.Trammel };
            Map[] fel = new Map[] { Map.Felucca };
            Map[] tram = new Map[] { Map.Trammel };
            Map[] ilsh = new Map[] { Map.Ilshenar };
            Map[] malas = new Map[] { Map.Malas };
            Map[] tokuno = new Map[] { Map.Tokuno };</pre>

## Duplicated Code. Size: 187

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\Teleporter.cs

<pre>public override void Serialize(GenericWriter writer)
		{
			base.Serialize(writer);

			writer.Write(4); // version

			writer.Write(m_CriminalCheck);
			writer.Write(m_CombatCheck);

			writer.Write(m_SourceEffect);
			writer.Write(m_DestEffect);
			writer.Write(m_Delay);
			writer.WriteEncodedInt(m_SoundID);

			writer.Write(m_Creatures);

			writer.Write(m_Active);
			writer.Write(m_PointDest);
			writer.Write(m_MapDest);
		}</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\Teleporter\Whirlpool.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write(4); // version

            writer.Write(m_CriminalCheck);
            writer.Write(m_CombatCheck);

            writer.Write(m_SourceEffect);
            writer.Write(m_DestEffect);
            writer.Write(m_Delay);
            writer.WriteEncodedInt(m_SoundID);

            writer.Write(m_Creatures);

            writer.Write(m_Active);
            writer.Write(m_PointDest);
            writer.Write(m_MapDest);
        }</pre>

## Duplicated Code. Size: 187

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\FishingPole.cs

<pre>string modName = this.Serial.ToString();

                if (strBonus != 0)
                    m.AddStatMod(new StatMod(StatType.Str, modName + "Str", strBonus, TimeSpan.Zero));

                if (dexBonus != 0)
                    m.AddStatMod(new StatMod(StatType.Dex, modName + "Dex", dexBonus, TimeSpan.Zero));

                if (intBonus != 0)
                    m.AddStatMod(new StatMod(StatType.Int, modName + "Int", intBonus, TimeSpan.Zero));</pre>

Fragment 2 in file Scripts\Items\Tools\FishingPole.cs

<pre>string modName = this.Serial.ToString();

                if (strBonus != 0)
                    m.AddStatMod(new StatMod(StatType.Str, modName + "Str", strBonus, TimeSpan.Zero));

                if (dexBonus != 0)
                    m.AddStatMod(new StatMod(StatType.Dex, modName + "Dex", dexBonus, TimeSpan.Zero));

                if (intBonus != 0)
                    m.AddStatMod(new StatMod(StatType.Int, modName + "Int", intBonus, TimeSpan.Zero));</pre>

## Duplicated Code. Size: 187

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\IronBeetle.cs

<pre>{
            switch (d & Direction.Mask)
            {
                case Direction.North: --y; break;
                case Direction.South: ++y; break;
                case Direction.West: --x; break;
                case Direction.East: ++x; break;
                case Direction.Right: ++x; --y; break;
                case Direction.Left: --x; ++y; break;
                case Direction.Down: ++x; ++y; break;
                case Direction.Up: --x; --y; break;
            }
        }</pre>

Fragment 2 in file Server\Movement.cs

<pre>{
			switch (d & Direction.Mask)
			{
				case Direction.North:
					--y;
					break;
				case Direction.South:
					++y;
					break;
				case Direction.West:
					--x;
					break;
				case Direction.East:
					++x;
					break;
				case Direction.Right:
					++x;
					--y;
					break;
				case Direction.Left:
					--x;
					++y;
					break;
				case Direction.Down:
					++x;
					++y;
					break;
				case Direction.Up:
					--x;
					--y;
					break;
			}
		}</pre>

## Duplicated Code. Size: 187

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\AttendantHerald.cs

<pre>this.AddBackground(0, 0, 273, 324, 0x13BE);
                this.AddImageTiled(10, 10, 253, 20, 0xA40);
                this.AddImageTiled(10, 40, 253, 244, 0xA40);
                this.AddImageTiled(10, 294, 253, 20, 0xA40);
                this.AddAlphaRegion(10, 10, 253, 304);
                this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\AttendantLuckyDealer.cs

<pre>this.AddBackground(0, 0, 273, 324, 0x13BE);
                this.AddImageTiled(10, 10, 253, 20, 0xA40);
                this.AddImageTiled(10, 40, 253, 244, 0xA40);
                this.AddImageTiled(10, 294, 253, 20, 0xA40);
                this.AddAlphaRegion(10, 10, 253, 304);
                this.AddButton(10, 294, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 187

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\CommodityBrokerGump.cs

<pre>AddHtml(190, 180, 300, 18, FormatAmt(broker.BankBalance), false, false);

			int balance = Banker.GetBalance(from);
			AddHtmlLocalized(68, 200, 200, 18, 1150149, GreenColor16, false, false); // Your Bank Balance:
			AddHtml(190, 200, 200, 18, FormatAmt(balance), false, false);

			AddHtmlLocalized(32, 230, 200, 18, 1150329, OrangeColor16, false, false); // Broker Sales Comission</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>AddHtml(190, 180, 300, 18, FormatAmt(broker.BankBalance), false, false);

			int balance = Banker.GetBalance(from);
			AddHtmlLocalized(68, 200, 200, 18, 1150149, GreenColor16, false, false); // Your Bank Balance:
			AddHtml(190, 200, 200, 18, FormatAmt(balance), false, false);

			AddHtmlLocalized(32, 230, 200, 18, 1150329, OrangeColor16, false, false); // Broker Sales Comission</pre>

## Duplicated Code. Size: 187

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void WriteMobileList(ArrayList list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (((Mobile)list[i]).Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write((Mobile)list[i]);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void WriteMobileList(ArrayList list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (((Mobile)list[i]).Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write((Mobile)list[i]);
			}
		}</pre>

## Duplicated Code. Size: 187

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void WriteItemList(ArrayList list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (((Item)list[i]).Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write((Item)list[i]);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void WriteItemList(ArrayList list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (((Item)list[i]).Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write((Item)list[i]);
			}
		}</pre>

## Duplicated Code. Size: 187

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void WriteGuildList(ArrayList list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (((BaseGuild)list[i]).Disbanded)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write((BaseGuild)list[i]);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void WriteGuildList(ArrayList list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (((BaseGuild)list[i]).Disbanded)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write((BaseGuild)list[i]);
			}
		}</pre>

## Duplicated Code. Size: 187

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void WriteDataList(ArrayList list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (((SaveData)list[i]).Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write((SaveData)list[i]);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void WriteDataList(ArrayList list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (((SaveData)list[i]).Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write((BaseGuild)list[i]);
			}
		}</pre>

## Duplicated Code. Size: 186

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Items\LavaFishItems.cs

<pre>switch (Utility.Random(5))
            {
                default:
                case 0: item = new GeodeEast(); break;
                case 1: item = new GeodeSouth(); break;
                case 2: item = new GeodeShardEast(); break;
                case 3: item = new GeodeShardSouth(); break;
                case 4: item = new LavaRock(); break;
            }

            if (item != null)
            {
                from.AddToBackpack(item);
                from.SendMessage("You have split the lava rock!");
                Delete();
            }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\LavaFishItems.cs

<pre>switch (Utility.Random(5))
            {
                default:
                case 0: item = new GeodeEast(); break;
                case 1: item = new GeodeSouth(); break;
                case 2: item = new GeodeShardEast(); break;
                case 3: item = new GeodeShardSouth(); break;
                case 4: item = new LavaRock(); break;
            }

            if (item != null)
            {
                from.AddToBackpack(item);
                from.SendMessage("You have split the lava rock!");
                Delete();
            }</pre>

## Duplicated Code. Size: 186

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Mobiles\Charybdis.cs

<pre>SetResistance(ResistanceType.Energy, 5, 10);

            SetSkill(SkillName.Wrestling, 52.0, 70.0);
            SetSkill(SkillName.Tactics, 0.0);
            SetSkill(SkillName.MagicResist, 100.4, 113.5);
            SetSkill(SkillName.Anatomy, 1.0, 0.0);
            SetSkill(SkillName.Magery, 60.2, 72.4);
            SetSkill(SkillName.EvalInt, 60.1, 73.4);
            SetSkill(SkillName.Meditation, 100.0);

            Fame = 2500;
            Karma = -2500;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Mobiles\OsiredonTheScalisEnforcer.cs

<pre>SetResistance(ResistanceType.Energy, 5, 10);

            SetSkill(SkillName.Wrestling, 52.0, 70.0);
            SetSkill(SkillName.Tactics, 0.0);
            SetSkill(SkillName.MagicResist, 100.4, 113.5);
            SetSkill(SkillName.Anatomy, 1.0, 0.0);
            SetSkill(SkillName.Magery, 60.2, 72.4);
            SetSkill(SkillName.EvalInt, 60.1, 73.4);
            SetSkill(SkillName.Meditation, 100.0);

            Fame = 2500;
            Karma = -2500;</pre>

## Duplicated Code. Size: 185

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DreadHornStatuette.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2))
                Effects.PlaySound(this.Location, this.Map, m_Sounds[Utility.Random(m_Sounds.Length)]);

            base.OnMovement(m, oldLocation);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\DreadSpiderStatuette.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2))
                Effects.PlaySound(this.Location, this.Map, m_Sounds[Utility.Random(m_Sounds.Length)]);

            base.OnMovement(m, oldLocation);
        }</pre>

Fragment 3 in file Scripts\Items\Addons\MinotaurStatuette.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2))
                Effects.PlaySound(this.Location, this.Map, m_Sounds[Utility.Random(m_Sounds.Length)]);

            base.OnMovement(m, oldLocation);
        }</pre>

Fragment 4 in file Scripts\Items\Addons\OphidianArchMageStatuette.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2))
                Effects.PlaySound(this.Location, this.Map, m_Sounds[Utility.Random(m_Sounds.Length)]);

            base.OnMovement(m, oldLocation);
        }</pre>

Fragment 5 in file Scripts\Items\Addons\OphidianKnightStatuette.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2))
                Effects.PlaySound(this.Location, this.Map, m_Sounds[Utility.Random(m_Sounds.Length)]);

            base.OnMovement(m, oldLocation);
        }</pre>

Fragment 6 in file Scripts\Items\Addons\OphidianMageStatuette.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2))
                Effects.PlaySound(this.Location, this.Map, m_Sounds[Utility.Random(m_Sounds.Length)]);

            base.OnMovement(m, oldLocation);
        }</pre>

Fragment 7 in file Scripts\Items\Addons\OphidianWarriorStatuette.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2))
                Effects.PlaySound(this.Location, this.Map, m_Sounds[Utility.Random(m_Sounds.Length)]);

            base.OnMovement(m, oldLocation);
        }</pre>

Fragment 8 in file Scripts\Items\Addons\PlagueBeastStatuette.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2))
                Effects.PlaySound(this.Location, this.Map, m_Sounds[Utility.Random(m_Sounds.Length)]);

            base.OnMovement(m, oldLocation);
        }</pre>

Fragment 9 in file Scripts\Items\Addons\RedDeathStatuette.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2))
                Effects.PlaySound(this.Location, this.Map, m_Sounds[Utility.Random(m_Sounds.Length)]);

            base.OnMovement(m, oldLocation);
        }</pre>

Fragment 10 in file Scripts\Items\Addons\SlimeStatuette.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2))
                Effects.PlaySound(this.Location, this.Map, m_Sounds[Utility.Random(m_Sounds.Length)]);

            base.OnMovement(m, oldLocation);
        }</pre>

Fragment 11 in file Scripts\Items\Addons\TormentedMinotaurStatuette.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
		{
			if (this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2))
				Effects.PlaySound(this.Location, this.Map, m_Sounds[Utility.Random(m_Sounds.Length)]);

			base.OnMovement(m, oldLocation);
		}</pre>

Fragment 12 in file Scripts\Items\Artifacts\Decorative\TragicRemainsOfTravesty.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2))
                Effects.PlaySound(this.Location, this.Map, m_Sounds[Utility.Random(m_Sounds.Length)]);

            base.OnMovement(m, oldLocation);
        }</pre>

## Duplicated Code. Size: 184

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Wreath.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                BaseHouse house = BaseHouse.FindHouseAt(from);

                if (house != null && house.IsCoOwner(from))
                {
                    from.SendLocalizedMessage(1062838); // Where would you like to place this decoration?
                    from.BeginTarget(-1, true, TargetFlags.None, new TargetStateCallback(Placement_OnTarget), null);
                }
                else
                {
                    from.SendLocalizedMessage(502092); // You must be in your house to do this.
                }
            }
            else
            {
                from.SendLocalizedMessage(1042001); // That must be in your pack for you to use it.
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\Mistletoe.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                BaseHouse house = BaseHouse.FindHouseAt(from);

                if (house != null && house.IsCoOwner(from))
                {
                    from.SendLocalizedMessage(1062838); // Where would you like to place this decoration?
                    from.BeginTarget(-1, true, TargetFlags.None, new TargetStateCallback(Placement_OnTarget), null);
                }
                else
                {
                    from.SendLocalizedMessage(502092); // You must be in your house to do this.
                }
            }
            else
            {
                from.SendLocalizedMessage(1042001); // That must be in your pack for you to use it.
            }
        }</pre>

## Duplicated Code. Size: 184

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBGlassblower.cs

<pre>this.Add(typeof(NightSightPotion), 7);
                this.Add(typeof(AgilityPotion), 7);
                this.Add(typeof(StrengthPotion), 7);
                this.Add(typeof(RefreshPotion), 7);
                this.Add(typeof(LesserCurePotion), 7);
                this.Add(typeof(LesserHealPotion), 7);
                this.Add(typeof(LesserPoisonPotion), 7);
                this.Add(typeof(LesserExplosionPotion), 10);</pre>

Fragment 2 in file Scripts\VendorInfo\SBVarietyDealer.cs

<pre>this.Add(typeof(NightSightPotion), 7);
                this.Add(typeof(AgilityPotion), 7);
                this.Add(typeof(StrengthPotion), 7);
                this.Add(typeof(RefreshPotion), 7);
                this.Add(typeof(LesserCurePotion), 7);
                this.Add(typeof(LesserHealPotion), 7);
                this.Add(typeof(LesserPoisonPotion), 7);
                this.Add(typeof(LesserExplosionPotion), 10);</pre>

## Duplicated Code. Size: 184

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBHolyMage.cs

<pre>this.Add(typeof(BlackPearl), 3); 
                this.Add(typeof(Bloodmoss), 3); 
                this.Add(typeof(MandrakeRoot), 2); 
                this.Add(typeof(Garlic), 2); 
                this.Add(typeof(Ginseng), 2); 
                this.Add(typeof(Nightshade), 2); 
                this.Add(typeof(SpidersSilk), 2); 
                this.Add(typeof(SulfurousAsh), 2);</pre>

Fragment 2 in file Scripts\VendorInfo\SBVarietyDealer.cs

<pre>this.Add(typeof(BlackPearl), 3);
                this.Add(typeof(Bloodmoss), 3);
                this.Add(typeof(MandrakeRoot), 2);
                this.Add(typeof(Garlic), 2);
                this.Add(typeof(Ginseng), 2);
                this.Add(typeof(Nightshade), 2);
                this.Add(typeof(SpidersSilk), 2);
                this.Add(typeof(SulfurousAsh), 2);</pre>

## Duplicated Code. Size: 184

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBInnKeeper.cs

<pre>this.Add(new GenericBuyInfo("1016450", typeof(Chessboard), 2, 20, 0xFA6, 0));
                this.Add(new GenericBuyInfo("1016449", typeof(CheckerBoard), 2, 20, 0xFA6, 0));
                this.Add(new GenericBuyInfo(typeof(Backgammon), 2, 20, 0xE1C, 0));
                this.Add(new GenericBuyInfo(typeof(Dices), 2, 20, 0xFA7, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBPlayerBarkeeper.cs

<pre>this.Add(new GenericBuyInfo("1016450", typeof(Chessboard), 2, 20, 0xFA6, 0));
                this.Add(new GenericBuyInfo("1016449", typeof(CheckerBoard), 2, 20, 0xFA6, 0));
                this.Add(new GenericBuyInfo(typeof(Backgammon), 2, 20, 0xE1C, 0));
                this.Add(new GenericBuyInfo(typeof(Dices), 2, 20, 0xFA7, 0));</pre>

## Duplicated Code. Size: 183

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\HelpInfo.cs

<pre>list.Add(new CommandInfo(command.AccessLevel, cmd, aliases, usage, desc));

                for (int j = 0; j < aliases.Length; j++)
                {
                    string[] newAliases = new string[aliases.Length];

                    aliases.CopyTo(newAliases, 0);

                    newAliases[j] = cmd;

                    list.Add(new CommandInfo(command.AccessLevel, aliases[j], newAliases, usage, desc));
                }</pre>

Fragment 2 in file Scripts\Commands\HelpInfo.cs

<pre>list.Add(new CommandInfo(command.AccessLevel, cmd, aliases, usage, desc));

                for (int j = 0; j < aliases.Length; j++)
                {
                    string[] newAliases = new string[aliases.Length];

                    aliases.CopyTo(newAliases, 0);

                    newAliases[j] = cmd;

                    list.Add(new CommandInfo(command.AccessLevel, aliases[j], newAliases, usage, desc));
                }</pre>

## Duplicated Code. Size: 183

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BaseAddon.cs

<pre>{
                        Point3D addonLoc = new Point3D(p.X + c.Offset.X, p.Y + c.Offset.Y, p.Z + c.Offset.Z);
                        int addonHeight = c.ItemData.CalcHeight;

                        if (Utility.InRange(doorLoc, addonLoc, 1) && (addonLoc.Z == doorLoc.Z || ((addonLoc.Z + addonHeight) > doorLoc.Z && (doorLoc.Z + doorHeight) > addonLoc.Z)))
                            return AddonFitResult.DoorTooClose;
                    }</pre>

Fragment 2 in file Scripts\Items\Addons\BaseAddonContainer.cs

<pre>{
                        Point3D addonLoc = new Point3D(p.X + c.Offset.X, p.Y + c.Offset.Y, p.Z + c.Offset.Z);
                        int addonHeight = c.ItemData.CalcHeight;

                        if (Utility.InRange(doorLoc, addonLoc, 1) && (addonLoc.Z == doorLoc.Z || ((addonLoc.Z + addonHeight) > doorLoc.Z && (doorLoc.Z + doorHeight) > addonLoc.Z)))
                            return AddonFitResult.DoorTooClose;
                    }</pre>

## Duplicated Code. Size: 183

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\AttendantGuide.cs

<pre>public override void InitBody()
        {
            this.SetStr(50, 60);
            this.SetDex(20, 30);
            this.SetInt(100, 110);

            this.Name = NameList.RandomName("female");
            this.Female = true;
            this.Race = Race.Human;
            this.Hue = this.Race.RandomSkinHue();

            this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\AttendantHerald.cs

<pre>public override void InitBody()
        {
            this.SetStr(50, 60);
            this.SetDex(20, 30);
            this.SetInt(100, 110);

            this.Name = NameList.RandomName("female");
            this.Female = true;
            this.Race = Race.Human;
            this.Hue = this.Race.RandomSkinHue();

            this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();
        }</pre>

## Duplicated Code. Size: 183

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>AddButton(10, 368, 4014, 4016, 1, GumpButtonType.Reply, 0);
            AddHtmlLocalized(45, 368, 150, 16, 1149777, 0xFFFF, false, false); // MAIN MENU

            AddButton(540, 368, 4017, 4019, 2, GumpButtonType.Reply, 0);
            AddHtmlLocalized(485, 368, 150, 16, 1153910, 0xFFFF, false, false); // Withdraw

            page++;
            AddPage(page);
            int pageIndex = 0;</pre>

Fragment 2 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>AddButton(10, 368, 4014, 4016, 1, GumpButtonType.Reply, 0);
            AddHtmlLocalized(45, 368, 150, 16, 1149777, 0xFFFF, false, false); // MAIN MENU

            AddButton(540, 368, 4017, 4019, 2, GumpButtonType.Reply, 0);
            AddHtmlLocalized(485, 368, 150, 16, 1153910, 0xFFFF, false, false); // Withdraw

            page++;
            AddPage(page);
            int pageIndex = 0;</pre>

## Duplicated Code. Size: 183

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>fill7.Location = new Point3D(X - 5, Y + 1, Z);
                    fill8.Location = new Point3D(X - 5, Y + 2, Z);
                    fill9.Location = new Point3D(X - 6, Y + 2, Z);
                    fill10.Location = new Point3D(X - 7, Y + 2, Z);
                    fill11.Location = new Point3D(X - 8, Y + 2, Z);
                    break;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>fill7.Location = new Point3D(X + 5, Y - 1, Z);
                    fill8.Location = new Point3D(X + 5, Y - 2, Z);
                    fill9.Location = new Point3D(X + 6, Y - 2, Z);
                    fill10.Location = new Point3D(X + 7, Y - 2, Z);
                    fill11.Location = new Point3D(X + 8, Y - 2, Z);
                    break;</pre>

## Duplicated Code. Size: 183

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>Mobile combatant = m_Creature.Combatant != null ? m_Creature.Combatant as Mobile : m_Creature.ControlMaster != null ? m_Creature.ControlMaster.Combatant as Mobile : null;

                        if (combatant != null && combatant.GetDistanceToSqrt(p) <= length)
                        {
                            if (m_Creature.Debug)
                                m_Creature.DebugSay("I have detected {0} as an aggressor, attacking", m_Creature.FocusMob.Name);

                            m_Creature.Combatant = combatant;
                            m_Creature.ControlTarget = combatant;
                            m_Creature.ControlOrder = OrderType.Attack;
                            Action = ActionType.Combat;
                        }
                        else
                            return base.DoOrderNone();</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>Mobile combatant = m_Creature.Combatant != null ? m_Creature.Combatant as Mobile : m_Creature.ControlMaster != null ? m_Creature.ControlMaster.Combatant as Mobile : null;

                        if (combatant != null && combatant.GetDistanceToSqrt(p) <= length)
                        {
                            if (m_Creature.Debug)
                                m_Creature.DebugSay("I have detected {0} as an aggressor, attacking", m_Creature.FocusMob.Name);

                            m_Creature.Combatant = combatant;
                            m_Creature.ControlTarget = combatant;
                            m_Creature.ControlOrder = OrderType.Attack;
                            Action = ActionType.Combat;
                        }
                        else
                            return base.DoOrderNone();</pre>

## Duplicated Code. Size: 183

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void WriteItemList<T>(List<T> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void WriteItemList<T>(List<T> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

## Duplicated Code. Size: 183

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void WriteMobileList<T>(List<T> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void WriteMobileList<T>(List<T> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

## Duplicated Code. Size: 183

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void WriteGuildList<T>(List<T> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Disbanded)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void WriteGuildList<T>(List<T> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Disbanded)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

## Duplicated Code. Size: 183

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void WriteDataList<lt;T>(List<T> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void WriteDataList<T>(List<T> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

## Duplicated Code. Size: 183

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\AttendantGuide.cs

<pre>public override void InitBody()
        {
            this.SetStr(50, 60);
            this.SetDex(20, 30);
            this.SetInt(100, 110);

            this.Name = NameList.RandomName("male");
            this.Female = false;
            this.Race = Race.Human;
            this.Hue = this.Race.RandomSkinHue();

            this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\AttendantHerald.cs

<pre>public override void InitBody()
        {
            this.SetStr(50, 60);
            this.SetDex(20, 30);
            this.SetInt(100, 110);

            this.Name = NameList.RandomName("male");
            this.Female = false;
            this.Race = Race.Human;
            this.Hue = this.Race.RandomSkinHue();

            this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\AttendantLuckyDealer.cs

<pre>public override void InitBody()
        {
            this.SetStr(50, 60);
            this.SetDex(20, 30);
            this.SetInt(100, 110);

            this.Name = NameList.RandomName("male");
            this.Female = false;
            this.Race = Race.Human;
            this.Hue = this.Race.RandomSkinHue();

            this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();
        }</pre>

## Duplicated Code. Size: 182

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DolphinRug.cs

<pre>public override void OnComponentUsed(AddonComponent component, Mobile from)
        {
            if (m_NextUse < DateTime.UtcNow)
            {
                Container cont = from.Backpack;

                MessageInABottle mib = new MessageInABottle();

                if (cont == null || !cont.TryDropItem(from, mib, false))
                {
                    from.BankBox.DropItem(mib);
                    from.SendLocalizedMessage(1072224); // An item has been placed in your bank box.
                }
                else
                    from.SendLocalizedMessage(1072223); // An item has been placed in your backpack.

                m_NextUse = DateTime.UtcNow + TimeSpan.FromDays(7);
            }
        }</pre>

Fragment 2 in file Scripts\Items\Addons\DolphinRug.cs

<pre>public override void OnComponentUsed(AddonComponent component, Mobile from)
        {
            if (m_NextUse < DateTime.UtcNow)
            {
                Container cont = from.Backpack;

                MessageInABottle mib = new MessageInABottle();

                if (cont == null || !cont.TryDropItem(from, mib, false))
                {
                    from.BankBox.DropItem(mib);
                    from.SendLocalizedMessage(1072224); // An item has been placed in your bank box.
                }
                else
                    from.SendLocalizedMessage(1072223); // An item has been placed in your backpack.

                m_NextUse = DateTime.UtcNow + TimeSpan.FromDays(7);
            }
        }</pre>

## Duplicated Code. Size: 182

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\MapItem.cs

<pre>m_Stream.Write( (int) map.Serial );
				m_Stream.Write( (short) 0x139D );
				m_Stream.Write( (short) map.Bounds.Start.X );
				m_Stream.Write( (short) map.Bounds.Start.Y );
				m_Stream.Write( (short) map.Bounds.End.X );
				m_Stream.Write( (short) map.Bounds.End.Y );
				m_Stream.Write( (short) map.Width );</pre>

Fragment 2 in file Scripts\Items\Tools\MapItem.cs

<pre>m_Stream.Write((int)map.Serial);
                m_Stream.Write((short)0x139D);
                m_Stream.Write((short)map.Bounds.Start.X);
                m_Stream.Write((short)map.Bounds.Start.Y);
                m_Stream.Write((short)map.Bounds.End.X);
                m_Stream.Write((short)map.Bounds.End.Y);
                m_Stream.Write((short)map.Width);</pre>

## Duplicated Code. Size: 182

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>writer.Write(m_Creator);
			writer.Write(m_Description1);
			writer.Write(m_Description2);
			writer.Write(m_Description3);
			writer.Write(m_Description4);
			writer.Write(m_Description5);
			writer.Write(m_Owner);
			writer.Write(m_RewardString);
			writer.Write(m_ConfigFile);
			writer.Write(m_NoteString);    // moved from the QuestNote class
			writer.Write(m_TitleString);   // moved from the QuestNote class
			writer.Write(m_PartyEnabled);
			writer.Write(m_PartyRange);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>writer.Write(m_Creator);
            // version 6
            writer.Write(m_Description1);
            writer.Write(m_Description2);
            writer.Write(m_Description3);
            writer.Write(m_Description4);
            writer.Write(m_Description5);
            // version 5
            writer.Write(m_Owner);
            // version 4
            writer.Write(m_RewardString);
            // version 3
            writer.Write(m_ConfigFile);
            writer.Write(m_NoteString);    // moved from the QuestNote class
            writer.Write(m_TitleString);   // moved from the QuestNote class

            // version 2
            writer.Write(m_PartyEnabled);
            writer.Write(m_PartyRange);</pre>

## Duplicated Code. Size: 182

### Duplicated Fragments:

Fragment 1 in file Server\ScriptCompiler.cs

<pre>CompilerParameters parms = new CompilerParameters(GetReferenceAssemblies(), path, debug);

				string options = GetCompilerOptions(debug);

				if (options != null)
				{
					parms.CompilerOptions = options;
				}

				if (Core.HaltOnWarning)
				{
					parms.WarningLevel = 4;
				}

#if !MONO
				CompilerResults results = provider.CompileAssemblyFromFile(parms, files);
#else
				parms.CompilerOptions = String.Format( "{0} /nowarn:169,219,414 /recurse:Scripts/*.cs", parms.CompilerOptions );
				CompilerResults results = provider.CompileAssemblyFromFile( parms, "" );
                #endif
				m_AdditionalReferences.Add(path);

				Display(results);

#if !MONO
				if (results.Errors.Count > 0)
				{
					assembly = null;
					return false;
				}</pre>

Fragment 2 in file Server\ScriptCompiler.cs

<pre>CompilerParameters parms = new CompilerParameters(GetReferenceAssemblies(), path, debug);

				string options = GetCompilerOptions(debug);

				if (options != null)
				{
					parms.CompilerOptions = options;
				}

				if (Core.HaltOnWarning)
				{
					parms.WarningLevel = 4;
				}

				CompilerResults results = provider.CompileAssemblyFromFile(parms, files);
				m_AdditionalReferences.Add(path);

				Display(results);

				if (results.Errors.Count > 0)
				{
					assembly = null;
					return false;
				}</pre>

## Duplicated Code. Size: 181

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\SalvageBag.cs

<pre>double difficulty = 0.0;

                switch ( resource )
                {
                    case CraftResource.DullCopper:
                        difficulty = 65.0;
                        break;
                    case CraftResource.ShadowIron:
                        difficulty = 70.0;
                        break;
                    case CraftResource.Copper:
                        difficulty = 75.0;
                        break;
                    case CraftResource.Bronze:
                        difficulty = 80.0;
                        break;
                    case CraftResource.Gold:
                        difficulty = 85.0;
                        break;
                    case CraftResource.Agapite:
                        difficulty = 90.0;
                        break;
                    case CraftResource.Verite:
                        difficulty = 95.0;
                        break;
                    case CraftResource.Valorite:
                        difficulty = 99.0;
                        break;
                }</pre>

Fragment 2 in file Scripts\Services\Craft\Core\Resmelt.cs

<pre>double difficulty = 0.0;

                    switch ( resource )
                    {
                        case CraftResource.DullCopper:
                            difficulty = 65.0;
                            break;
                        case CraftResource.ShadowIron:
                            difficulty = 70.0;
                            break;
                        case CraftResource.Copper:
                            difficulty = 75.0;
                            break;
                        case CraftResource.Bronze:
                            difficulty = 80.0;
                            break;
                        case CraftResource.Gold:
                            difficulty = 85.0;
                            break;
                        case CraftResource.Agapite:
                            difficulty = 90.0;
                            break;
                        case CraftResource.Verite:
                            difficulty = 95.0;
                            break;
                        case CraftResource.Valorite:
                            difficulty = 99.0;
                            break;
                    }</pre>

## Duplicated Code. Size: 181

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseCreature.cs

<pre>if (hitsRaise > HitsMax)
                SetHits(Math.Min(MaxHits, hitsRaise));

            if (stamRaise > StamMax)
                SetStam(Math.Min(MaxStam, stamRaise));

            if (manaRaise > ManaMax)
                SetMana(Math.Min(MaxMana, manaRaise));

            if (RaiseDamage && Utility.RandomDouble() < RaiseDamageFactor)
            {
                DamageMin = Math.Min(MinDamMax, DamageMin + 1);
                DamageMax = Math.Min(MaxDamMax, DamageMax + 1);
            }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Creatures\CovetousCreature.cs

<pre>if (hitsRaise > HitsMax)
                SetHits(Math.Min(MaxHits, hitsRaise));

            if (stamRaise > StamMax)
                SetStam(Math.Min(MaxStam, stamRaise));

            if (manaRaise > ManaMax)
                SetMana(Math.Min(MaxMana, manaRaise));

            if (RaiseDamage && Utility.RandomDouble() < RaiseDamageFactor)
            {
                DamageMin = Math.Min(MinDamMax, DamageMin + 1);
                DamageMax = Math.Min(MaxDamMax, DamageMax + 1);
            }</pre>

## Duplicated Code. Size: 181

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\ArcherGuard.cs

<pre>private void TeleportTo(Mobile target)
			{
				Point3D from = m_Owner.Location;
				Point3D to = target.Location;

				m_Owner.Location = to;

				Effects.SendLocationParticles(
					EffectItem.Create(from, m_Owner.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 2023);
				Effects.SendLocationParticles(EffectItem.Create(to, m_Owner.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 5023);

				m_Owner.PlaySound(0x1FE);
			}</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\WarriorGuard.cs

<pre>private void TeleportTo(Mobile target)
			{
				Point3D from = m_Owner.Location;
				Point3D to = target.Location;

				m_Owner.Location = to;

				Effects.SendLocationParticles(
					EffectItem.Create(from, m_Owner.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 2023);
				Effects.SendLocationParticles(EffectItem.Create(to, m_Owner.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 5023);

				m_Owner.PlaySound(0x1FE);
			}</pre>

## Duplicated Code. Size: 181

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\Books\BOBGump.cs

<pre>if (canDrop)
                        this.AddButton(35, y + 2, 5602, 5606, 5 + (i * 2), GumpButtonType.Reply, 0);

                    if (canDrop || (canBuy && e.Price > 0))
                    {
                        this.AddButton(579, y + 2, 2117, 2118, 6 + (i * 2), GumpButtonType.Reply, 0);
                        this.AddLabel(495, y, 1152, e.Price.ToString());
                    }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\Books\BOBGump.cs

<pre>if (canDrop)
                        this.AddButton(35, y + 2, 5602, 5606, 5 + (i * 2), GumpButtonType.Reply, 0);

                    if (canDrop || (canBuy && e.Price > 0))
                    {
                        this.AddButton(579, y + 2, 2117, 2118, 6 + (i * 2), GumpButtonType.Reply, 0);
                        this.AddLabel(495, y, 1152, e.Price.ToString());
                    }</pre>

## Duplicated Code. Size: 181

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>ns.Sequence = 0;
						ClearFastwalkStack();

						ns.Send(MobileIncoming.Create(ns, this, this));

						if (ns.StygianAbyss)
						{
							ns.Send(new MobileUpdate(this));
							CheckLightLevels(true);
							ns.Send(new MobileUpdate(this));
						}
						else
						{
							ns.Send(new MobileUpdateOld(this));
							CheckLightLevels(true);
							ns.Send(new MobileUpdateOld(this));
						}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>ns.Sequence = 0;
				ClearFastwalkStack();

				ns.Send(MobileIncoming.Create(ns, this, this));

				if (ns.StygianAbyss)
				{
					ns.Send(new MobileUpdate(this));
					CheckLightLevels(true);
					ns.Send(new MobileUpdate(this));
				}
				else
				{
					ns.Send(new MobileUpdateOld(this));
					CheckLightLevels(true);
					ns.Send(new MobileUpdateOld(this));
				}</pre>

## Duplicated Code. Size: 181

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DecorativeShield.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (from.InRange(this.Location, 2))
            {
                BaseHouse house = BaseHouse.FindHouseAt(this);  

                if (house != null && house.IsOwner(from))
                {
                    from.CloseGump(typeof(RewardDemolitionGump));
                    from.SendGump(new RewardDemolitionGump(this, 1049783)); // Do you wish to re-deed this decoration?
                }
                else
                    from.SendLocalizedMessage(1049784); // You can only re-deed this decoration if you are the house owner or originally placed the decoration.
            }
            else
                from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
        }</pre>

Fragment 2 in file Scripts\Services\CleanUpBritannia\Items\DragonHead.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (from.InRange(this.Location, 2))
            {
                BaseHouse house = BaseHouse.FindHouseAt(this);

                if (house != null && house.IsOwner(from))
                {
                    from.CloseGump(typeof(RewardDemolitionGump));
                    from.SendGump(new RewardDemolitionGump(this, 1049783)); // Do you wish to re-deed this decoration?
                }
                else
                    from.SendLocalizedMessage(1049784); // You can only re-deed this decoration if you are the house owner or originally placed the decoration.
            }
            else
                from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\DecorativeShardShields.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (from.InRange(this.Location, 2))
            {
                BaseHouse house = BaseHouse.FindHouseAt(this);

                if (house != null && house.IsOwner(from))
                {
                    from.CloseGump(typeof(RewardDemolitionGump));
                    from.SendGump(new RewardDemolitionGump(this, 1049783)); // Do you wish to re-deed this decoration?
                }
                else
                    from.SendLocalizedMessage(1049784); // You can only re-deed this decoration if you are the house owner or originally placed the decoration.
            }
            else
                from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
        }</pre>

## Duplicated Code. Size: 181

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>{
						if (entry != null)
						{
							Mobile m = entry.Participant;

							if (m == null) continue;

							if (!m_gauntlet.CheckQualify(m))
							{
								complete = false;
								break;
							}

							if (!entry.Accepted)
							{
								XmlPoints.SendText(m_gauntlet.Challenger, 100539, m.Name);  // "{0} has not accepted yet."
								complete = false;
								break;
							}

							// and they have a team
							if (entry.Team <= 0)
							{
								XmlPoints.SendText(m_gauntlet.Challenger, 100594, m.Name); // "{0} has not been assigned a team."
								complete = false;
							}
						}
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>{
                        if(entry != null)
                        {
                            Mobile m = entry.Participant;

                            if(m == null) continue;

                            if(!m_gauntlet.CheckQualify(m))
                            {
                                complete = false;
                                break;
                            }

                            if(!entry.Accepted)
                            {
                                XmlPoints.SendText(m_gauntlet.Challenger, 100539, m.Name);  // "{0} has not accepted yet."
                                complete = false;
                                break;
                            }

                            // and they have a team
                            if(entry.Team <= 0)
                            {
                                XmlPoints.SendText(m_gauntlet.Challenger, 100594, m.Name); // "{0} has not been assigned a team."
                                complete = false;
                            }
                        }
                    }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>{
                        if(entry != null)
                        {
                            Mobile m = entry.Participant;

                            if(m == null) continue;

                            if(!m_gauntlet.CheckQualify(m))
                            {
                                complete = false;
                                break;
                            }

                            if(!entry.Accepted)
                            {
                                XmlPoints.SendText(m_gauntlet.Challenger, 100539, m.Name);  // "{0} has not accepted yet."
                                complete = false;
                                break;
                            }

                            // and they have a team
                            if(entry.Team <= 0)
                            {
                                XmlPoints.SendText(m_gauntlet.Challenger, 100594, m.Name); // "{0} has not been assigned a team."
                                complete = false;
                            }
                        }
                    }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>{
                        if(entry != null)
                        {
                            Mobile m = entry.Participant;

                            if(m == null) continue;

                            if(!m_gauntlet.CheckQualify(m))
                            {
                                complete = false;
                                break;
                            }

                            if(!entry.Accepted)
                            {
                                XmlPoints.SendText(m_gauntlet.Challenger, 100539, m.Name);  // "{0} has not accepted yet."
                                complete = false;
                                break;
                            }

                            // and they have a team
                            if(entry.Team <= 0)
                            {
                                XmlPoints.SendText(m_gauntlet.Challenger, 100594, m.Name); // "{0} has not been assigned a team."
                                complete = false;
                            }
                        }
                    }</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>{
                        if(entry != null)
                        {
                            Mobile m = entry.Participant;

                            if(m == null) continue;

                            if(!m_gauntlet.CheckQualify(m))
                            {
                                complete = false;
                                break;
                            }

                            if(!entry.Accepted)
                            {
                                XmlPoints.SendText(m_gauntlet.Challenger, 100539, m.Name);  // "{0} has not accepted yet."
                                complete = false;
                                break;
                            }

                            // and they have a team
                            if(entry.Team <= 0)
                            {
                                XmlPoints.SendText(m_gauntlet.Challenger, 100594, m.Name); // "{0} has not been assigned a team."
                                complete = false;
                            }
                        }
                    }</pre>

## Duplicated Code. Size: 181

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ExodusMinion.cs

<pre>public override void OnDamagedBySpell(Mobile from)
        {
            if (from != null && from.Alive && 0.4 > Utility.RandomDouble())
            {
                this.SendEBolt(from);
            }

            if (!this.m_FieldActive)
            {
                // should there be an effect when spells nullifying is on?
                this.FixedParticles(0, 10, 0, 0x2522, EffectLayer.Waist);
            }
            else if (this.m_FieldActive && !this.CanUseField)
            {
                this.m_FieldActive = false;

                // TODO: message and effect when field turns down; cannot be verified on OSI due to a bug
                this.FixedParticles(0x3735, 1, 30, 0x251F, EffectLayer.Waist);
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ExodusOverseer.cs

<pre>public override void OnDamagedBySpell(Mobile from)
        {
            if (from != null && from.Alive && 0.4 > Utility.RandomDouble())
            {
                this.SendEBolt(from);
            }

            if (!this.m_FieldActive)
            {
                // should there be an effect when spells nullifying is on?
                this.FixedParticles(0, 10, 0, 0x2522, EffectLayer.Waist);
            }
            else if (this.m_FieldActive && !this.CanUseField)
            {
                this.m_FieldActive = false;

                // TODO: message and effect when field turns down; cannot be verified on OSI due to a bug
                this.FixedParticles(0x3735, 1, 30, 0x251F, EffectLayer.Waist);
            }
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusDrone.cs

<pre>public override void OnDamagedBySpell(Mobile from)
        {
            if (from != null && from.Alive && 0.4 > Utility.RandomDouble())
            {
                this.SendEBolt(from);
            }

            if (!this.m_FieldActive)
            {
                // should there be an effect when spells nullifying is on?
                this.FixedParticles(0, 10, 0, 0x2522, EffectLayer.Waist);
            }
            else if (this.m_FieldActive && !this.CanUseField)
            {
                this.m_FieldActive = false;

                // TODO: message and effect when field turns down; cannot be verified on OSI due to a bug
                this.FixedParticles(0x3735, 1, 30, 0x251F, EffectLayer.Waist);
            }
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusJuggernaut.cs

<pre>public override void OnDamagedBySpell(Mobile from)
        {
            if (from != null && from.Alive && 0.4 > Utility.RandomDouble())
            {
                this.SendEBolt(from);
            }

            if (!this.m_FieldActive)
            {
                // should there be an effect when spells nullifying is on?
                this.FixedParticles(0, 10, 0, 0x2522, EffectLayer.Waist);
            }
            else if (this.m_FieldActive && !this.CanUseField)
            {
                this.m_FieldActive = false;

                // TODO: message and effect when field turns down; cannot be verified on OSI due to a bug
                this.FixedParticles(0x3735, 1, 30, 0x251F, EffectLayer.Waist);
            }
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusMinionLord.cs

<pre>public override void OnDamagedBySpell(Mobile from)
        {
            if (from != null && from.Alive && 0.4 > Utility.RandomDouble())
            {
                this.SendEBolt(from);
            }

            if (!this.m_FieldActive)
            {
                // should there be an effect when spells nullifying is on?
                this.FixedParticles(0, 10, 0, 0x2522, EffectLayer.Waist);
            }
            else if (this.m_FieldActive && !this.CanUseField)
            {
                this.m_FieldActive = false;

                // TODO: message and effect when field turns down; cannot be verified on OSI due to a bug
                this.FixedParticles(0x3735, 1, 30, 0x251F, EffectLayer.Waist);
            }
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusSentinel.cs

<pre>public override void OnDamagedBySpell(Mobile from)
        {
            if (from != null && from.Alive && 0.4 > Utility.RandomDouble())
            {
                this.SendEBolt(from);
            }

            if (!this.m_FieldActive)
            {
                // should there be an effect when spells nullifying is on?
                this.FixedParticles(0, 10, 0, 0x2522, EffectLayer.Waist);
            }
            else if (this.m_FieldActive && !this.CanUseField)
            {
                this.m_FieldActive = false;

                // TODO: message and effect when field turns down; cannot be verified on OSI due to a bug
                this.FixedParticles(0x3735, 1, 30, 0x251F, EffectLayer.Waist);
            }
        }</pre>

## Duplicated Code. Size: 180

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>if (teleportAway)
                {
                    int rx = this.m_Mobile.X - toTarget.X;
                    int ry = this.m_Mobile.Y - toTarget.Y;
                    double d = this.m_Mobile.GetDistanceToSqrt(toTarget);

                    px = toTarget.X + (int)(rx * (10 / d));
                    py = toTarget.Y + (int)(ry * (10 / d));
                }
                else
                {
                    px = toTarget.X;
                    py = toTarget.Y;
                }</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>if (teleportAway)
                {
                    int rx = this.m_Mobile.X - toTarget.X;
                    int ry = this.m_Mobile.Y - toTarget.Y;

                    double d = this.m_Mobile.GetDistanceToSqrt(toTarget);

                    px = toTarget.X + (int)(rx * (10 / d));
                    py = toTarget.Y + (int)(ry * (10 / d));
                }
                else
                {
                    px = toTarget.X;
                    py = toTarget.Y;
                }</pre>

## Duplicated Code. Size: 180

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Rikktor.cs

<pre>double damage = m.Hits * 0.6;

                if (damage < 10.0)
                    damage = 10.0;
                else if (damage > 75.0)
                    damage = 75.0;

                this.DoHarmful(m);

                AOS.Damage(m, this, (int)damage, 100, 0, 0, 0, 0);

                if (m.Alive && m.Body.IsHuman && !m.Mounted)
                    m.Animate(20, 7, 1, true, false, 0); // take hit</pre>

Fragment 2 in file Scripts\Mobiles\Named\Meraktus.cs

<pre>double damage = m.Hits * 0.6;//was .6
                if (damage < 10.0)
                    damage = 10.0;
                else if (damage > 75.0)
                    damage = 75.0;
                this.DoHarmful(m);
                AOS.Damage(m, this, (int)damage, 100, 0, 0, 0, 0);
                if (m.Alive && m.Body.IsHuman && !m.Mounted)
                    m.Animate(20, 7, 1, true, false, 0); // take hit</pre>

## Duplicated Code. Size: 180

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\HuntmasterChallenge\BestKillBoard.cs

<pre>case (int)HuntType.GrizzlyBear: return "Grizzly Bear";
                    case (int)HuntType.GrayWolf: return "Gray Wolf";
                    case (int)HuntType.Cougar: return "Cougar";
                    case (int)HuntType.Turkey: return "Turkey";
                    case (int)HuntType.Bull: return "Bull";
                    case (int)HuntType.Boar: return "Boar";
                    case (int)HuntType.Walrus: return "Walrus";
                    case (int)HuntType.Alligator: return "Alligator";
                    case (int)HuntType.Eagle: return "Eagle";</pre>

Fragment 2 in file Scripts\Services\HuntmasterChallenge\BestKillBoard.cs

<pre>case HuntType.GrizzlyBear: return "Grizzly Bear";
                    case HuntType.GrayWolf: return "Gray Wolf";
                    case HuntType.Cougar: return "Cougar";
                    case HuntType.Turkey: return "Turkey";
                    case HuntType.Bull: return "Bull";
                    case HuntType.Boar: return "Boar";
                    case HuntType.Walrus: return "Walrus";
                    case HuntType.Alligator: return "Alligator";
                    case HuntType.Eagle: return "Eagle";</pre>

## Duplicated Code. Size: 180

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Paragon.cs

<pre>bc.DamageMin += DamageBuff;
            bc.DamageMax += DamageBuff;

            if (bc.Fame > 0)
                bc.Fame = (int)(bc.Fame * FameBuff);

            if (bc.Fame > 32000)
                bc.Fame = 32000;

            // TODO: Mana regeneration rate = Sqrt( buffedFame ) / 4

            if (bc.Karma != 0)
            {
                bc.Karma = (int)(bc.Karma * KarmaBuff);

                if (Math.Abs(bc.Karma) > 32000)
                    bc.Karma = 32000 * Math.Sign(bc.Karma);
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlParagon\XmlParagon.cs

<pre>bc.DamageMin += DamageBuff;
            bc.DamageMax += DamageBuff;

            if (bc.Fame > 0)
                bc.Fame = (int)(bc.Fame * FameBuff);

            if (bc.Fame > 32000)
                bc.Fame = 32000;

            // TODO: Mana regeneration rate = Sqrt( buffedFame ) / 4

            if (bc.Karma != 0)
            {
                bc.Karma = (int)(bc.Karma * KarmaBuff);

                if (Math.Abs(bc.Karma) > 32000)
                    bc.Karma = 32000 * Math.Sign(bc.Karma);
            }</pre>

## Duplicated Code. Size: 180

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BrokenBed.cs

<pre>this.AddPage(1);

                this.AddButton(19, 49, 0x845, 0x846, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 47, 213, 20, 1075386, 0x7FFF, false, false); // South
                this.AddButton(19, 73, 0x845, 0x846, 2, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 71, 213, 20, 1075387, 0x7FFF, false, false); // East</pre>

Fragment 2 in file Scripts\Items\Addons\BrokenVanity.cs

<pre>this.AddPage(1);

                this.AddButton(19, 49, 0x845, 0x846, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 47, 213, 20, 1075386, 0x7FFF, false, false); // South
                this.AddButton(19, 73, 0x845, 0x846, 2, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 71, 213, 20, 1075387, 0x7FFF, false, false); // East</pre>

Fragment 3 in file Scripts\Items\Addons\Curtains.cs

<pre>this.AddPage(1);

                this.AddButton(19, 49, 0x845, 0x846, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 47, 213, 20, 1075386, 0x7FFF, false, false); // South
                this.AddButton(19, 73, 0x845, 0x846, 2, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 71, 213, 20, 1075387, 0x7FFF, false, false); // East</pre>

Fragment 4 in file Scripts\Items\Addons\HangingAxes.cs

<pre>this.AddPage(1);

                this.AddButton(19, 49, 0x845, 0x846, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 47, 213, 20, 1075386, 0x7FFF, false, false); // South
                this.AddButton(19, 73, 0x845, 0x846, 2, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 71, 213, 20, 1075387, 0x7FFF, false, false); // East</pre>

Fragment 5 in file Scripts\Items\Addons\HangingSwords.cs

<pre>this.AddPage(1);

                this.AddButton(19, 49, 0x845, 0x846, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 47, 213, 20, 1075386, 0x7FFF, false, false); // South
                this.AddButton(19, 73, 0x845, 0x846, 2, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 71, 213, 20, 1075387, 0x7FFF, false, false); // East</pre>

Fragment 6 in file Scripts\Items\Addons\Statue.cs

<pre>this.AddPage(1);

                this.AddButton(19, 49, 0x845, 0x846, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 47, 213, 20, 1075386, 0x7FFF, false, false); // South
                this.AddButton(19, 73, 0x845, 0x846, 2, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 71, 213, 20, 1075387, 0x7FFF, false, false); // East</pre>

Fragment 7 in file Scripts\Items\Addons\UnmadeBed.cs

<pre>this.AddPage(1);

                this.AddButton(19, 49, 0x845, 0x846, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 47, 213, 20, 1075386, 0x7FFF, false, false); // South
                this.AddButton(19, 73, 0x845, 0x846, 2, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 71, 213, 20, 1075387, 0x7FFF, false, false); // East</pre>

Fragment 8 in file Scripts\Items\Addons\WoodenCoffin.cs

<pre>this.AddPage(1);

                this.AddButton(19, 49, 0x845, 0x846, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 47, 213, 20, 1075386, 0x7FFF, false, false); // South
                this.AddButton(19, 73, 0x845, 0x846, 2, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 71, 213, 20, 1075387, 0x7FFF, false, false); // East</pre>

Fragment 9 in file Scripts\Items\Containers\Vanity.cs

<pre>this.AddPage(1);

                this.AddButton(19, 49, 0x845, 0x846, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 47, 213, 20, 1075386, 0x7FFF, false, false); // South
                this.AddButton(19, 73, 0x845, 0x846, 2, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(44, 71, 213, 20, 1075387, 0x7FFF, false, false); // East</pre>

## Duplicated Code. Size: 179

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\Abilities.cs

<pre>ResistanceMod[] mods = 
                    {
                        new ResistanceMod(ResistanceType.Physical, (int)(effect * 0.01)),
                        new ResistanceMod(ResistanceType.Fire, (int)(effect * 0.01)),
                        new ResistanceMod(ResistanceType.Cold, (int)(effect * 0.01)),
                        new ResistanceMod(ResistanceType.Poison, (int)(effect * 0.01)),
                        new ResistanceMod(ResistanceType.Energy, (int)(effect * 0.01))
                    };</pre>

Fragment 2 in file Scripts\Mobiles\AI\Omni AI\OmniIA Bard.cs

<pre>ResistanceMod[] mods = 
                {
                    new ResistanceMod(ResistanceType.Physical, (int)(effect * 0.01)),
                    new ResistanceMod(ResistanceType.Fire, (int)(effect * 0.01)),
                    new ResistanceMod(ResistanceType.Cold, (int)(effect * 0.01)),
                    new ResistanceMod(ResistanceType.Poison, (int)(effect * 0.01)),
                    new ResistanceMod(ResistanceType.Energy, (int)(effect * 0.01))
                };</pre>

## Duplicated Code. Size: 179

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\New Guild System\BaseGuildGump.cs

<pre>public void AddHtmlText(int x, int y, int width, int height, TextDefinition text, bool back, bool scroll)
        {
            if (text != null && text.Number > 0)
                this.AddHtmlLocalized(x, y, width, height, text.Number, back, scroll);
            else if (text != null && text.String != null)
                this.AddHtml(x, y, width, height, text.String, back, scroll);
        }</pre>

Fragment 2 in file Scripts\Services\Factions\Gumps\FactionGump.cs

<pre>public void AddHtmlText(int x, int y, int width, int height, TextDefinition text, bool back, bool scroll)
        {
            if (text != null && text.Number > 0)
                this.AddHtmlLocalized(x, y, width, height, text.Number, back, scroll);
            else if (text != null && text.String != null)
                this.AddHtml(x, y, width, height, text.String, back, scroll);
        }</pre>

## Duplicated Code. Size: 179

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\WaterVat.cs

<pre>this.AddComponent(new AddonComponent(0x14D7), 2, 2, 0);

            // Blockers
            this.AddComponent(new AddonComponent(0x21A4), 2, -1, 0);
            this.AddComponent(new AddonComponent(0x21A4), 3, 0, 0);
            this.AddComponent(new AddonComponent(0x21A4), -1, 2, 0);
            this.AddComponent(new AddonComponent(0x21A4), 0, 3, 0);</pre>

Fragment 2 in file Scripts\Items\Addons\WaterVat.cs

<pre>this.AddComponent(new AddonComponent(0x14D7), 2, 2, 0);

            // Blockers
            this.AddComponent(new AddonComponent(0x21A4), 2, -1, 0);
            this.AddComponent(new AddonComponent(0x21A4), 3, 0, 0);
            this.AddComponent(new AddonComponent(0x21A4), -1, 2, 0);
            this.AddComponent(new AddonComponent(0x21A4), 0, 3, 0);</pre>

## Duplicated Code. Size: 179

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Rotworm.cs

<pre>case 0: PackItem( new LeftArm() ); break;
				case 1: PackItem( new RightArm() ); break;
				case 2: PackItem( new Torso() ); break;
				case 3: PackItem( new Bone() ); break;
				case 4: PackItem( new RibCage() ); break;
				case 5: PackItem( new RibCage() ); break;
				case 6: PackItem( new BonePile() );</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Zombie.cs

<pre>case 0:
                    PackItem(new LeftArm());
                    break;
                case 1:
                    PackItem(new RightArm());
                    break;
                case 2:
                    PackItem(new Torso());
                    break;
                case 3:
                    PackItem(new Bone());
                    break;
                case 4:
                    PackItem(new RibCage());
                    break;
                case 5:
                    PackItem(new RibCage());
                    break;
                case 6:
                    PackItem(new BonePile());</pre>

## Duplicated Code. Size: 179

### Duplicated Fragments:

Fragment 1 in file Server\Persistence\DynamicSaveStrategy.cs

<pre>private void WriteCount(SequentialFileWriter indexFile, int count)
        {
            //Equiv to GenericWriter.Write( (int)count );
            byte[] buffer = new byte[4];

            buffer[0] = (byte)(count);
            buffer[1] = (byte)(count >> 8);
            buffer[2] = (byte)(count >> 16);
            buffer[3] = (byte)(count >> 24);

            indexFile.Write(buffer, 0, buffer.Length);
        }</pre>

Fragment 2 in file Server\Persistence\ParallelSaveStrategy.cs

<pre>private void WriteCount(SequentialFileWriter indexFile, int count)
        {
            byte[] buffer = new byte[4];

            buffer[0] = (byte)(count);
            buffer[1] = (byte)(count >> 8);
            buffer[2] = (byte)(count >> 16);
            buffer[3] = (byte)(count >> 24);

            indexFile.Write(buffer, 0, buffer.Length);
        }</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AddGump.cs

<pre>Type[] types;

            Assembly[] asms = ScriptCompiler.Assemblies;

            for (int i = 0; i < asms.Length; ++i)
            {
                types = ScriptCompiler.GetTypeCache(asms[i]).Types;
                Match(match, types, results);
            }

            types = ScriptCompiler.GetTypeCache(Core.Assembly).Types;
            Match(match, types, results);

            results.Sort(new TypeNameComparer());

            return results;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlPartialCategorizedAddGump.cs

<pre>Type[] types;

			Assembly[] asms = ScriptCompiler.Assemblies;

			for ( int i = 0; i < asms.Length; ++i )
			{
				types = ScriptCompiler.GetTypeCache( asms[i] ).Types;
				Match( match, types, results );
			}

			types = ScriptCompiler.GetTypeCache( Core.Assembly ).Types;
			Match( match, types, results );

			results.Sort( new TypeNameComparer() );

			return results;</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\TitlesMenu.cs

<pre>object description = GetRewardTitleInfo(title);

                    if (description is int)
                        AddHtmlLocalized(225, 70, 270, 140, (int)description, 0xFFFF, false, false);
                    else if (description is string)
                        AddHtml(225, 70, 270, 140, Color("#FFFFFF", (string)description), false, false);

                    AddHtmlLocalized(225, 220, 160, 16, 1115029, 0xFFFF, false, false); // Subtitle</pre>

Fragment 2 in file Scripts\Gumps\TitlesMenu.cs

<pre>object description = GetRewardTitleInfo(title);

                    if (description is int)
                        AddHtmlLocalized(225, 70, 270, 140, (int)description, 0xFFFF, false, false);
                    else if (description is string)
                        AddHtml(225, 70, 270, 140, Color("#FFFFFF", (string)description), false, false);

                    AddHtmlLocalized(225, 220, 160, 16, 1115029, 0xFFFF, false, false); // Subtitle</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BakeKitsune.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (0.1 > Utility.RandomDouble())
            {
                /* Blood Bath
                * Start cliloc 1070826
                * Sound: 0x52B
                * 2-3 blood spots
                * Damage: 2 hps per second for 5 seconds
                * End cliloc: 1070824
                */
                ExpireTimer timer = (ExpireTimer)m_Table[defender];

                if (timer != null)
                {
                    timer.DoExpire();
                    defender.SendLocalizedMessage(1070825); // The creature continues to rage!
                }
                else
                    defender.SendLocalizedMessage(1070826); // The creature goes into a rage, inflicting heavy damage!

                timer = new ExpireTimer(defender, this);
                timer.Start();
                m_Table[defender] = timer;
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\TsukiWolf.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (0.1 > Utility.RandomDouble())
            {
                /* Blood Bath
                * Start cliloc 1070826
                * Sound: 0x52B
                * 2-3 blood spots
                * Damage: 2 hps per second for 5 seconds
                * End cliloc: 1070824
                */
                ExpireTimer timer = (ExpireTimer)m_Table[defender];

                if (timer != null)
                {
                    timer.DoExpire();
                    defender.SendLocalizedMessage(1070825); // The creature continues to rage!
                }
                else
                    defender.SendLocalizedMessage(1070826); // The creature goes into a rage, inflicting heavy damage!

                timer = new ExpireTimer(defender, this);
                timer.Start();
                m_Table[defender] = timer;
            }
        }</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Chiyo.cs

<pre>{ 
            this.SetSkill(SkillName.Hiding, 120.0, 120.0);
            this.SetSkill(SkillName.Tracking, 120.0, 120.0);
            this.SetSkill(SkillName.Healing, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Fencing, 120.0, 120.0);
            this.SetSkill(SkillName.Stealth, 120.0, 120.0);
            this.SetSkill(SkillName.Ninjitsu, 120.0, 120.0);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Ryuichi.cs

<pre>{ 
            this.SetSkill(SkillName.Hiding, 120.0, 120.0);
            this.SetSkill(SkillName.Tracking, 120.0, 120.0);
            this.SetSkill(SkillName.Healing, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Fencing, 120.0, 120.0);
            this.SetSkill(SkillName.Stealth, 120.0, 120.0);
            this.SetSkill(SkillName.Ninjitsu, 120.0, 120.0);
        }</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\CloakOfHumility\CloakOfHumilityQuest.cs

<pre>if (offer)
                g.AddHtmlLocalized(130, 45, 270, 16, 1049010, 0xFFFFFF, false, false); // Quest Offer
            else
                g.AddHtmlLocalized(130, 45, 270, 16, 1046026, 0xFFFFFF, false, false); // Quest Log

            g.AddHtmlObject(160, 70, 200, 40, Title, BaseQuestGump.DarkGreen, false, false);
            g.AddHtmlLocalized(98, 140, 312, 16, 1049073, 0x2710, false, false); // Objective:</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionFishQuest\ProfessionalFisherQuest.cs

<pre>if (offer)
                g.AddHtmlLocalized(130, 45, 270, 16, 1049010, 0xFFFFFF, false, false); // Quest Offer
            else
                g.AddHtmlLocalized(130, 45, 270, 16, 1046026, 0xFFFFFF, false, false); // Quest Log

            g.AddHtmlObject(160, 70, 200, 40, Title, BaseQuestGump.DarkGreen, false, false);
            g.AddHtmlLocalized(98, 140, 312, 16, 1049073, 0x2710, false, false); // Objective:</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>for (int i = 0; i < keyarray.Length; i++)
					{
						// write the key
						imawriter.Write(keyarray[i]);

						// write out the attachments
						List<XmlAttachment> alist = valuearray[i];

						imawriter.Write(alist.Count);
						foreach (XmlAttachment a in alist)
						{
							// write the attachment serial
							imawriter.Write(a.Serial.Value);

							// write the value type
							imawriter.Write(a.GetType().ToString());

							// save the fileposition index
							fpiwriter.Write(imawriter.Position);
						}
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>for (int i = 0; i < keyarray.Length; i++)
					{
						// write the key
						imawriter.Write(keyarray[i]);

						// write out the attachments			             
						List<XmlAttachment> alist = valuearray[i];

						imawriter.Write(alist.Count);
						foreach (XmlAttachment a in alist)
						{
							// write the attachment serial
							imawriter.Write(a.Serial.Value);

							// write the value type
							imawriter.Write(a.GetType().ToString());

							// save the fileposition index
							fpiwriter.Write(imawriter.Position);
						}
					}</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestLeaders.cs

<pre>string deltalabel = a.DeltaRank.ToString();
						int deltahue = 0;
						if(a.DeltaRank > 0)
						{
							deltalabel = String.Format("+{0}",a.DeltaRank);
							deltahue = 68;
						}
						else
							if(a.DeltaRank < 0)
						{
							deltahue = 33;
						}
						xloc += 50;
						AddLabel( xloc, y, deltahue, deltalabel );
						xloc += 40;
						AddLabel( xloc, y, 0, label);

						y += 20;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>string deltalabel = a.DeltaRank.ToString();
						int deltahue = 0;
						if(a.DeltaRank > 0)
						{
							deltalabel = String.Format("+{0}",a.DeltaRank);
							deltahue = 68;
						} 
						else
							if(a.DeltaRank < 0)
						{
							deltahue = 33;
						}
						xloc += 50;
						AddLabel( xloc, y, deltahue, deltalabel );
						xloc += 40;
						AddLabel( xloc, y, 0, label);

						y += 20;</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketReader.cs

<pre>if (m_Index >= m_Size)
			{
				return String.Empty;
			}

			int count = 0;
			int index = m_Index;

			while (index < m_Size && m_Data[index++] != 0)
			{
				++count;
			}

			index = 0;

			var buffer = new byte[count];
			int value = 0;

			while (m_Index < m_Size && (value = m_Data[m_Index++]) != 0)
			{
				buffer[index++] = (byte)value;
			}</pre>

Fragment 2 in file Server\Network\PacketReader.cs

<pre>if (m_Index >= m_Size)
			{
				return String.Empty;
			}

			int count = 0;
			int index = m_Index;

			while (index < m_Size && m_Data[index++] != 0)
			{
				++count;
			}

			index = 0;

			var buffer = new byte[count];
			int value = 0;

			while (m_Index < m_Size && (value = m_Data[m_Index++]) != 0)
			{
				buffer[index++] = (byte)value;
			}</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void Write(List<Item> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void Write(List<Item> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void Write(List<Mobile> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void Write(List<Mobile> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void Write(List<BaseGuild> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Disbanded)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void Write(List<BaseGuild> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Disbanded)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void Write(List<SaveData> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void Write(List<SaveData> list, bool tidy)
		{
			if (tidy)
			{
				for (int i = 0; i < list.Count;)
				{
					if (list[i].Deleted)
					{
						list.RemoveAt(i);
					}
					else
					{
						++i;
					}
				}
			}

			Write(list.Count);

			for (int i = 0; i < list.Count; ++i)
			{
				Write(list[i]);
			}
		}</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Amelia.cs

<pre>{ 
            this.SetSkill(SkillName.ArmsLore, 120.0, 120.0);
            this.SetSkill(SkillName.Blacksmith, 120.0, 120.0);
            this.SetSkill(SkillName.Magery, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Swords, 120.0, 120.0);
            this.SetSkill(SkillName.Tinkering, 120.0, 120.0);
            this.SetSkill(SkillName.Mining, 120.0, 120.0);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\GeorgeHephaestus.cs

<pre>{ 
            this.SetSkill(SkillName.ArmsLore, 120.0, 120.0);
            this.SetSkill(SkillName.Blacksmith, 120.0, 120.0);
            this.SetSkill(SkillName.Magery, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Swords, 120.0, 120.0);
            this.SetSkill(SkillName.Tinkering, 120.0, 120.0);
            this.SetSkill(SkillName.Mining, 120.0, 120.0);
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Jacob.cs

<pre>{ 
            this.SetSkill(SkillName.ArmsLore, 120.0, 120.0);
            this.SetSkill(SkillName.Blacksmith, 120.0, 120.0);
            this.SetSkill(SkillName.Magery, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Tinkering, 120.0, 120.0);
            this.SetSkill(SkillName.Swords, 120.0, 120.0);
            this.SetSkill(SkillName.Mining, 120.0, 120.0);
        }</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlGetAttachGump.cs

<pre>AddRadio( 35, 255, 9721, 9724, false, 1 ); // accept/yes radio
			AddRadio( 135, 255, 9721, 9724, true, 2 ); // decline/no radio
			AddHtmlLocalized(72, 255, 200, 30, 1049016, 0x7fff , false , false ); // Yes
			AddHtmlLocalized(172, 255, 200, 30, 1049017, 0x7fff , false , false ); // No
			AddButton( 80, 289, 2130, 2129, 3, GumpButtonType.Reply, 0 ); // Okay button</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>AddRadio(35, 255, 9721, 9724, false, 1); // accept/yes radio
                AddRadio(135, 255, 9721, 9724, true, 2); // decline/no radio
                AddHtmlLocalized(72, 255, 200, 30, 1049016, 0x7fff, false, false); // Yes
                AddHtmlLocalized(172, 255, 200, 30, 1049017, 0x7fff, false, false); // No
                AddButton(80, 289, 2130, 2129, 3, GumpButtonType.Reply, 0); // Okay button</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestGumps.cs

<pre>AddRadio( 35, 255, 9721, 9724, false, 1 ); // accept/yes radio
			AddRadio( 135, 255, 9721, 9724, true, 2 ); // decline/no radio
			AddHtmlLocalized(72, 255, 200, 30, 1049016, 0x7fff , false , false ); // Yes
			AddHtmlLocalized(172, 255, 200, 30, 1049017, 0x7fff , false , false ); // No
			AddButton( 80, 289, 2130, 2129, 3, GumpButtonType.Reply, 0 ); // Okay button</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlEdit.cs

<pre>AddRadio( 35, 255, 9721, 9724, false, 1 ); // accept/yes radio
				AddRadio( 135, 255, 9721, 9724, true, 2 ); // decline/no radio
				AddHtmlLocalized(72, 255, 200, 30, 1049016, 0x7fff , false , false ); // Yes
				AddHtmlLocalized(172, 255, 200, 30, 1049017, 0x7fff , false , false ); // No
				AddButton( 80, 289, 2130, 2129, 3, GumpButtonType.Reply, 0 ); // Okay button</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlEdit.cs

<pre>AddRadio( 35, 255, 9721, 9724, false, 1 ); // accept/yes radio
				AddRadio( 135, 255, 9721, 9724, true, 2 ); // decline/no radio
				AddHtmlLocalized(72, 255, 200, 30, 1049016, 0x7fff , false , false ); // Yes
				AddHtmlLocalized(172, 255, 200, 30, 1049017, 0x7fff , false , false ); // No
				AddButton( 80, 289, 2130, 2129, 3, GumpButtonType.Reply, 0 ); // Okay button</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>AddRadio(35, 255, 9721, 9724, false, 1); // accept/yes radio
				AddRadio(135, 255, 9721, 9724, true, 2); // decline/no radio
				AddHtmlLocalized(72, 255, 200, 30, 1049016, 0x7fff, false, false); // Yes
				AddHtmlLocalized(172, 255, 200, 30, 1049017, 0x7fff, false, false); // No
				AddButton(80, 289, 2130, 2129, 3, GumpButtonType.Reply, 0); // Okay button</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>AddRadio(35, 255, 9721, 9724, false, 1); // accept/yes radio
				AddRadio(135, 255, 9721, 9724, true, 2); // decline/no radio
				AddHtmlLocalized(72, 255, 200, 30, 1049016, 0x7fff, false, false); // Yes
				AddHtmlLocalized(172, 255, 200, 30, 1049017, 0x7fff, false, false); // No
				AddButton(80, 289, 2130, 2129, 3, GumpButtonType.Reply, 0); // Okay button</pre>

## Duplicated Code. Size: 178

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Orc.cs

<pre>public override void AggressiveAction(Mobile aggressor, bool criminal)
        {
            base.AggressiveAction(aggressor, criminal);

            Item item = aggressor.FindItemOnLayer(Layer.Helm);

            if (item is OrcishKinMask)
            {
                AOS.Damage(aggressor, 50, 0, 100, 0, 0, 0);
                item.Delete();
                aggressor.FixedParticles(0x36BD, 20, 10, 5044, EffectLayer.Head);
                aggressor.PlaySound(0x307);
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\OrcBomber.cs

<pre>public override void AggressiveAction(Mobile aggressor, bool criminal)
        {
            base.AggressiveAction(aggressor, criminal);

            Item item = aggressor.FindItemOnLayer(Layer.Helm);

            if (item is OrcishKinMask)
            {
                AOS.Damage(aggressor, 50, 0, 100, 0, 0, 0);
                item.Delete();
                aggressor.FixedParticles(0x36BD, 20, 10, 5044, EffectLayer.Head);
                aggressor.PlaySound(0x307);
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\OrcBrute.cs

<pre>public override void AggressiveAction(Mobile aggressor, bool criminal)
        {
            base.AggressiveAction(aggressor, criminal);

            Item item = aggressor.FindItemOnLayer(Layer.Helm);

            if (item is OrcishKinMask)
            {
                AOS.Damage(aggressor, 50, 0, 100, 0, 0, 0);
                item.Delete();
                aggressor.FixedParticles(0x36BD, 20, 10, 5044, EffectLayer.Head);
                aggressor.PlaySound(0x307);
            }
        }</pre>

Fragment 4 in file Scripts\Mobiles\Normal\OrcCaptain.cs

<pre>public override void AggressiveAction(Mobile aggressor, bool criminal)
        {
            base.AggressiveAction(aggressor, criminal);

            Item item = aggressor.FindItemOnLayer(Layer.Helm);

            if (item is OrcishKinMask)
            {
                AOS.Damage(aggressor, 50, 0, 100, 0, 0, 0);
                item.Delete();
                aggressor.FixedParticles(0x36BD, 20, 10, 5044, EffectLayer.Head);
                aggressor.PlaySound(0x307);
            }
        }</pre>

Fragment 5 in file Scripts\Mobiles\Normal\OrcChopper.cs

<pre>public override void AggressiveAction(Mobile aggressor, bool criminal)
        {
            base.AggressiveAction(aggressor, criminal);

            Item item = aggressor.FindItemOnLayer(Layer.Helm);

            if (item is OrcishKinMask)
            {
                AOS.Damage(aggressor, 50, 0, 100, 0, 0, 0);
                item.Delete();
                aggressor.FixedParticles(0x36BD, 20, 10, 5044, EffectLayer.Head);
                aggressor.PlaySound(0x307);
            }
        }</pre>

Fragment 6 in file Scripts\Mobiles\Normal\OrcishLord.cs

<pre>public override void AggressiveAction(Mobile aggressor, bool criminal)
        {
            base.AggressiveAction(aggressor, criminal);

            Item item = aggressor.FindItemOnLayer(Layer.Helm);

            if (item is OrcishKinMask)
            {
                AOS.Damage(aggressor, 50, 0, 100, 0, 0, 0);
                item.Delete();
                aggressor.FixedParticles(0x36BD, 20, 10, 5044, EffectLayer.Head);
                aggressor.PlaySound(0x307);
            }
        }</pre>

Fragment 7 in file Scripts\Mobiles\Normal\OrcishMage.cs

<pre>public override void AggressiveAction(Mobile aggressor, bool criminal)
        {
            base.AggressiveAction(aggressor, criminal);

            Item item = aggressor.FindItemOnLayer(Layer.Helm);

            if (item is OrcishKinMask)
            {
                AOS.Damage(aggressor, 50, 0, 100, 0, 0, 0);
                item.Delete();
                aggressor.FixedParticles(0x36BD, 20, 10, 5044, EffectLayer.Head);
                aggressor.PlaySound(0x307);
            }
        }</pre>

Fragment 8 in file Scripts\Mobiles\Normal\OrcScout.cs

<pre>public override void AggressiveAction(Mobile aggressor, bool criminal)
		{
			base.AggressiveAction(aggressor, criminal);

			Item item = aggressor.FindItemOnLayer(Layer.Helm);

			if (item is OrcishKinMask)
			{
				AOS.Damage(aggressor, 50, 0, 100, 0, 0, 0);
				item.Delete();
				aggressor.FixedParticles(0x36BD, 20, 10, 5044, EffectLayer.Head);
				aggressor.PlaySound(0x307);
			}
		}</pre>

## Duplicated Code. Size: 177

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetPoint2DGump.cs

<pre>case 3: // Use values
                    {
                        TextRelay x = info.GetTextEntry(0);
                        TextRelay y = info.GetTextEntry(1);

                        toSet = new Point2D(x == null ? 0 : Utility.ToInt32(x.Text), y == null ? 0 : Utility.ToInt32(y.Text));
                        shouldSet = true;
                        shouldSend = true;

                        break;
                    }
                default:
                    {
                        toSet = Point2D.Zero;
                        shouldSet = false;
                        shouldSend = true;

                        break;
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetPoint2DGump.cs

<pre>case 3: // Use values
				{
					TextRelay x = info.GetTextEntry( 0 );
					TextRelay y = info.GetTextEntry( 1 );

					toSet = new Point2D( x == null ? 0 : Utility.ToInt32( x.Text ), y == null ? 0 : Utility.ToInt32( y.Text ) );
					shouldSet = true;
					shouldSend = true;

					break;
				}
				default:
				{
					toSet = Point2D.Zero;
					shouldSet = false;
					shouldSend = true;

					break;
				}</pre>

## Duplicated Code. Size: 177

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Mobiles\WarehouseSuperintendent.cs

<pre>if (entry == null)
                return;

            int fees = entry.Funds;

            if (fees < 0)
            {
                int owed = fees * -1;
                SayTo(from, String.Format("It looks like you owe {0}gp as back fees.  How much would you like to pay now?", owed.ToString("###,###,###")));
                from.Prompt = new BackfeePrompt(this, entry);
                return;
            }

            if (!TryPayFunds(from, entry))
            {
                from.SendGump(new BazaarInformationGump(1150681, 1150678)); // Some personal possessions that were equipped on the broker still remain in storage, because your backpack cannot hold them. Please free up space in your backpack and return to claim these items.
                return;
            }</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Mobiles\WarehouseSuperintendent.cs

<pre>if (entry == null)
                return;

            int fees = entry.Funds;

			if(fees < 0)
			{
                int owed = fees * -1;
				SayTo(from, String.Format("It looks like you owe {0}gp as back fees.  How much would you like to pay now?", owed.ToString("###,###,###")));
				from.Prompt = new BackfeePrompt(this, entry);
                return;
			}

            if (!TryPayFunds(from, entry))
            {
                from.SendGump(new BazaarInformationGump(1150681, 1150678)); // Some personal possessions that were equipped on the broker still remain in storage, because your backpack cannot hold them. Please free up space in your backpack and return to claim these items.
                return;
            }</pre>

## Duplicated Code. Size: 177

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
		public virtual bool IsCompleted
		{
			get
			{
				if (IsValid &&
					(Completed1 || Objective1 == null || (Objective1.Length == 0)) &&
					(Completed2 || Objective2 == null || (Objective2.Length == 0)) &&
					(Completed3 || Objective3 == null || (Objective3.Length == 0)) &&
					(Completed4 || Objective4 == null || (Objective4.Length == 0)) &&
					(Completed5 || Objective5 == null || (Objective5.Length == 0))
					)
					return true;
				else
					return false;
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public virtual bool IsCompleted
        {
            get
            {
                if (IsValid &&
                    (Completed1 || Objective1 == null || (Objective1.Length == 0)) &&
                    (Completed2 || Objective2 == null || (Objective2.Length == 0)) &&
                    (Completed3 || Objective3 == null || (Objective3.Length == 0)) &&
                    (Completed4 || Objective4 == null || (Objective4.Length == 0)) &&
                    (Completed5 || Objective5 == null || (Objective5.Length == 0))
                    )
                    return true;
                else
                    return false;
            }
        }</pre>

## Duplicated Code. Size: 177

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Fourth\Recall.cs

<pre>{
                    BaseGalleon galleon = ((ShipRune)o).Galleon;

                    if (!galleon.Deleted && galleon.Map != null && galleon.Map != Map.Internal && galleon.HasAccess(from))
                        m_Owner.Effect(galleon.GetMarkedLocation(), galleon.Map, false, true);
                    else
                        from.Send(new MessageLocalized(from.Serial, from.Body, MessageType.Regular, 0x3B2, 3, 502357, from.Name, "")); // I can not recall from that object.
                }</pre>

Fragment 2 in file Scripts\Spells\Seventh\GateTravel.cs

<pre>{
                    BaseGalleon galleon = ((ShipRune)o).Galleon;

                    if (!galleon.Deleted && galleon.Map != null && galleon.Map != Map.Internal && galleon.HasAccess(from))
                        m_Owner.Effect(galleon.GetMarkedLocation(), galleon.Map, false, true);
                    else
                        from.Send(new MessageLocalized(from.Serial, from.Body, MessageType.Regular, 0x3B2, 3, 502357, from.Name, "")); // I can not recall from that object.
                }</pre>

## Duplicated Code. Size: 177

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>if (ns != null && m_Map != null)
					{
						ns.Sequence = 0;
						ns.Send(new MapChange(this));
						ns.Send(new MapPatches());
						ns.Send(SeasonChange.Instantiate(GetSeason(), true));

						if (ns.StygianAbyss)
						{
							ns.Send(new MobileUpdate(this));
						}
						else
						{
							ns.Send(new MobileUpdateOld(this));
						}

						ClearFastwalkStack();
					}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>if (ns != null && m_Map != null)
				{
					ns.Sequence = 0;
					ns.Send(new MapChange(this));
					ns.Send(new MapPatches());
					ns.Send(SeasonChange.Instantiate(GetSeason(), true));

					if (ns.StygianAbyss)
					{
						ns.Send(new MobileUpdate(this));
					}
					else
					{
						ns.Send(new MobileUpdateOld(this));
					}

					ClearFastwalkStack();
				}</pre>

## Duplicated Code. Size: 176

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Statics.cs

<pre>for (int i = 0; i < newTileCount; ++i)
                                {
                                    StaticTile toWrite = newTiles[i];

                                    mulWriter.Write((ushort)toWrite.ID);
                                    mulWriter.Write((byte)toWrite.X);
                                    mulWriter.Write((byte)toWrite.Y);
                                    mulWriter.Write((sbyte)toWrite.Z);
                                    mulWriter.Write((short)toWrite.Hue);
                                }

                                mulWriter.Flush();</pre>

Fragment 2 in file Scripts\Commands\Statics.cs

<pre>for (int i = 0; i < newTileCount; ++i)
                                {
                                    StaticTile toWrite = newTiles[i];

                                    mulWriter.Write((ushort)toWrite.ID);
                                    mulWriter.Write((byte)toWrite.X);
                                    mulWriter.Write((byte)toWrite.Y);
                                    mulWriter.Write((sbyte)toWrite.Z);
                                    mulWriter.Write((short)toWrite.Hue);
                                }

                                mulWriter.Flush();</pre>

## Duplicated Code. Size: 176

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>int number;

            if (this.Name == null)
            {
                number = this.LabelNumber;
            }
            else
            {
                this.LabelTo(from, this.Name);
                number = 1041000;
            }

            if (attrs.Count == 0 && this.Crafter == null && this.Name != null)
                return;

            EquipmentInfo eqInfo = new EquipmentInfo(number, this.m_Crafter, false, attrs.ToArray());

            from.Send(new DisplayEquipmentInfo(this, eqInfo));</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>int number;

            if (this.Name == null)
            {
                number = this.LabelNumber;
            }
            else
            {
                this.LabelTo(from, this.Name);
                number = 1041000;
            }

            if (attrs.Count == 0 && this.Crafter == null && this.Name != null)
                return;

            EquipmentInfo eqInfo = new EquipmentInfo(number, this.m_Crafter, false, attrs.ToArray());

            from.Send(new DisplayEquipmentInfo(this, eqInfo));</pre>

## Duplicated Code. Size: 176

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>bool bad = false;

                        for (int j = 0; j < part.Players.Count; ++j)
                        {
                            Mobile check = (Mobile)part.Players[j];

                            if (check.Deleted || check.Map == null || check.Map == Map.Internal || !check.Alive || Factions.Sigil.ExistsOn(check) || check.Region.IsPartOf(typeof(Regions.Jail)))
                            {
                                bad = true;
                                break;
                            }
                        }</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>bool bad = false;

                            for (int j = 0; j < part.Players.Count; ++j)
                            {
                                Mobile check = (Mobile)part.Players[j];

                                if (check.Deleted || check.Map == null || check.Map == Map.Internal || !check.Alive || Factions.Sigil.ExistsOn(check) || check.Region.IsPartOf(typeof(Regions.Jail)))
                                {
                                    bad = true;
                                    break;
                                }
                            }</pre>

## Duplicated Code. Size: 176

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBaker.cs

<pre>this.Add(new GenericBuyInfo(typeof(BreadLoaf), 5, 20, 0x103C, 0));
                this.Add(new GenericBuyInfo(typeof(ApplePie), 7, 20, 0x1041, 0)); //OSI just has Pie, not Apple/Fruit/Meat
                this.Add(new GenericBuyInfo(typeof(Cake), 13, 20, 0x9E9, 0));
                this.Add(new GenericBuyInfo(typeof(Muffins), 3, 20, 0x9EA, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBCook.cs

<pre>this.Add(new GenericBuyInfo(typeof(BreadLoaf), 5, 20, 0x103C, 0));
                this.Add(new GenericBuyInfo(typeof(ApplePie), 7, 20, 0x1041, 0)); //OSI just has Pie, not Apple/Fruit/Meat
                this.Add(new GenericBuyInfo(typeof(Cake), 13, 20, 0x9E9, 0));
                this.Add(new GenericBuyInfo(typeof(Muffins), 3, 20, 0x9EA, 0));</pre>

## Duplicated Code. Size: 176

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBlacksmith.cs

<pre>this.Add(new GenericBuyInfo(typeof(PlateGorget), 104, 20, 0x1413, 0));
                this.Add(new GenericBuyInfo(typeof(PlateChest), 243, 20, 0x1415, 0));
                this.Add(new GenericBuyInfo(typeof(PlateLegs), 218, 20, 0x1411, 0));
                this.Add(new GenericBuyInfo(typeof(PlateArms), 188, 20, 0x1410, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBPlateArmor.cs

<pre>this.Add(new GenericBuyInfo(typeof(PlateGorget), 104, 20, 0x1413, 0));
                this.Add(new GenericBuyInfo(typeof(PlateChest), 243, 20, 0x1415, 0));
                this.Add(new GenericBuyInfo(typeof(PlateLegs), 218, 20, 0x1411, 0));
                this.Add(new GenericBuyInfo(typeof(PlateArms), 188, 20, 0x1410, 0));</pre>

## Duplicated Code. Size: 176

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBMage.cs

<pre>this.Add(new GenericBuyInfo(typeof(DaemonBlood), 6, 999, 0xF7D, 0));
                    this.Add(new GenericBuyInfo(typeof(PigIron), 5, 999, 0xF8A, 0));
                    this.Add(new GenericBuyInfo(typeof(NoxCrystal), 6, 999, 0xF8E, 0));
                    this.Add(new GenericBuyInfo(typeof(GraveDust), 3, 999, 0xF8F, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBVarietyDealer.cs

<pre>this.Add(new GenericBuyInfo(typeof(GraveDust), 3, 999, 0xF8F, 0));
                    this.Add(new GenericBuyInfo(typeof(DaemonBlood), 6, 999, 0xF7D, 0));
                    this.Add(new GenericBuyInfo(typeof(NoxCrystal), 6, 999, 0xF8E, 0));
                    this.Add(new GenericBuyInfo(typeof(PigIron), 5, 999, 0xF8A, 0));</pre>

## Duplicated Code. Size: 176

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBSATailor.cs

<pre>this.Add(new GenericBuyInfo(typeof(Cotton), 102, 20, 0xDF9, 0));
                this.Add(new GenericBuyInfo(typeof(Wool), 62, 20, 0xDF8, 0));
                this.Add(new GenericBuyInfo(typeof(Flax), 102, 20, 0x1A9C, 0));
                this.Add(new GenericBuyInfo(typeof(SpoolOfThread), 18, 20, 0xFA0, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBTailor.cs

<pre>this.Add(new GenericBuyInfo(typeof(Cotton), 102, 20, 0xDF9, 0));
                this.Add(new GenericBuyInfo(typeof(Wool), 62, 20, 0xDF8, 0));
                this.Add(new GenericBuyInfo(typeof(Flax), 102, 20, 0x1A9C, 0));
                this.Add(new GenericBuyInfo(typeof(SpoolOfThread), 18, 20, 0xFA0, 0));</pre>

## Duplicated Code. Size: 176

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBSATailor.cs

<pre>this.Add(new GenericBuyInfo(typeof(SewingKit), 3, 20, 0xF9D, 0)); 
                this.Add(new GenericBuyInfo(typeof(Scissors), 11, 20, 0xF9F, 0));
                this.Add(new GenericBuyInfo(typeof(DyeTub), 8, 20, 0xFAB, 0)); 
                this.Add(new GenericBuyInfo(typeof(Dyes), 8, 20, 0xFA9, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBTailor.cs

<pre>this.Add(new GenericBuyInfo(typeof(SewingKit), 3, 20, 0xF9D, 0)); 
                this.Add(new GenericBuyInfo(typeof(Scissors), 11, 20, 0xF9F, 0));
                this.Add(new GenericBuyInfo(typeof(DyeTub), 8, 20, 0xFAB, 0)); 
                this.Add(new GenericBuyInfo(typeof(Dyes), 8, 20, 0xFA9, 0));</pre>

## Duplicated Code. Size: 176

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBSATanner.cs

<pre>this.Add(new GenericBuyInfo(typeof(Bag), 6, 20, 0xE76, 0));
                this.Add(new GenericBuyInfo(typeof(Pouch), 6, 20, 0xE79, 0));
                this.Add(new GenericBuyInfo(typeof(Backpack), 15, 20, 0x9B2, 0));
                this.Add(new GenericBuyInfo(typeof(Leather), 6, 20, 0x1081, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBTanner.cs

<pre>this.Add(new GenericBuyInfo(typeof(Bag), 6, 20, 0xE76, 0));
                this.Add(new GenericBuyInfo(typeof(Pouch), 6, 20, 0xE79, 0));
                this.Add(new GenericBuyInfo(typeof(Backpack), 15, 20, 0x9B2, 0));
                this.Add(new GenericBuyInfo(typeof(Leather), 6, 20, 0x1081, 0));</pre>

## Duplicated Code. Size: 175

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Properties.cs

<pre>IDynamicEnum toSet;
			object toSetObj = null;
			string result = null;

			if (IsIDynamicEnum(p.PropertyType))
			{
				toSetObj = toSet = p.GetValue(o, null) as IDynamicEnum;

				if (toSet != null)
				{
					toSet.Value = value;

					if (!toSet.IsValid)
					{
						result = "No type with that name was found.";
					}
				}
				else
				{
					result = "That is not properly formatted.";
				}
			}
			else
			{
				result = ConstructFromString(p.PropertyType, o, value, ref toSetObj);
			}</pre>

Fragment 2 in file Scripts\Commands\Properties.cs

<pre>IDynamicEnum toSet;
			object toSetObj = null;
			string result = null;

			if (IsIDynamicEnum(p.PropertyType))
			{
				toSetObj = toSet = p.GetValue(o, null) as IDynamicEnum;

				if (toSet != null)
				{
					toSet.Value = value;

					if (!toSet.IsValid)
					{
						result = "No type with that name was found.";
					}
				}
				else
				{
					result = "That is not properly formatted.";
				}
			}
			else
			{
				result = ConstructFromString(p.PropertyType, o, value, ref toSetObj);
			}</pre>

## Duplicated Code. Size: 175

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Knights\KnightsPlateGloves.cs

<pre>{
            this.Hue = 1150;
            this.Weight = 2;

            this.Attributes.BonusHits = 1;

            this.SetAttributes.BonusHits = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1150;
            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Knights\KnightsPlateGorget.cs

<pre>{
            this.Hue = 1150;
            this.Weight = 2;

            this.Attributes.BonusHits = 1;

            this.SetAttributes.BonusHits = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1150;
            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

## Duplicated Code. Size: 175

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>{
                        if (m != this.m_Mobile && this.CanDispel(m))
                        {
                            double prio = this.m_Mobile.GetDistanceToSqrt(m);

                            if (!activeOnly && (inactive == null || prio < inactPrio))
                            {
                                inactive = m;
                                inactPrio = prio;
                            }

                            if ((this.m_Mobile.Combatant == m || m.Combatant == this.m_Mobile) && (active == null || prio < actPrio))
                            {
                                active = m;
                                actPrio = prio;
                            }
                        }
                    }</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>{
                        if (m != this.m_Mobile && this.CanDispel(m))
                        {
                            double prio = this.m_Mobile.GetDistanceToSqrt(m);

                            if (!activeOnly && (inactive == null || prio < inactPrio))
                            {
                                inactive = m;
                                inactPrio = prio;
                            }

                            if ((this.m_Mobile.Combatant == m || m.Combatant == this.m_Mobile) && (active == null || prio < actPrio))
                            {
                                active = m;
                                actPrio = prio;
                            }
                        }
                    }</pre>

## Duplicated Code. Size: 175

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\FireSteed.cs

<pre>if (version < 1)
            {
                for (int i = 0; i < this.Skills.Length; ++i)
                {
                    this.Skills[i].Cap = Math.Max(100.0, this.Skills[i].Cap * 0.9);

                    if (this.Skills[i].Base > this.Skills[i].Cap)
                    {
                        this.Skills[i].Base = this.Skills[i].Cap;
                    }
                }
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RuneBeetle.cs

<pre>if (version < 1)
            {
                for (int i = 0; i < this.Skills.Length; ++i)
                {
                    this.Skills[i].Cap = Math.Max(100.0, this.Skills[i].Cap * 0.9);

                    if (this.Skills[i].Base > this.Skills[i].Cap)
                    {
                        this.Skills[i].Base = this.Skills[i].Cap;
                    }
                }
            }</pre>

## Duplicated Code. Size: 175

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\KazeKemono.cs

<pre>this.SetResistance(ResistanceType.Cold, 30, 60);
            this.SetResistance(ResistanceType.Poison, 50, 70);
            this.SetResistance(ResistanceType.Energy, 60, 80);

            this.SetSkill(SkillName.MagicResist, 110.1, 125.0);
            this.SetSkill(SkillName.Tactics, 55.1, 65.0);
            this.SetSkill(SkillName.Wrestling, 85.1, 95.0);
            this.SetSkill(SkillName.Anatomy, 25.1, 35.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RaiJu.cs

<pre>this.SetResistance(ResistanceType.Cold, 30, 60);
            this.SetResistance(ResistanceType.Poison, 50, 70);
            this.SetResistance(ResistanceType.Energy, 60, 80);

            this.SetSkill(SkillName.Wrestling, 85.1, 95.0);
            this.SetSkill(SkillName.Tactics, 55.1, 65.0);
            this.SetSkill(SkillName.MagicResist, 110.1, 125.0);
            this.SetSkill(SkillName.Anatomy, 25.1, 35.0);</pre>

## Duplicated Code. Size: 175

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuest.cs

<pre>List<PartyMemberInfo> startlist = new List<PartyMemberInfo>();
					List<PartyMemberInfo> randlist = new List<PartyMemberInfo>();

					foreach (PartyMemberInfo mi in p.Members)
					{
						startlist.Add(mi);
					}

					while (randlist.Count < p.Members.Count)
					{
						// pick a random member from the start list
						// then take them off the list
						int randindex = Utility.Random(startlist.Count);

						randlist.Add(startlist[randindex]);

						startlist.RemoveAt(randindex);
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuest.cs

<pre>List<PartyMemberInfo> startlist = new List<PartyMemberInfo>();
					List<PartyMemberInfo> randlist = new List<PartyMemberInfo>();

					foreach (PartyMemberInfo mi in p.Members)
					{
						startlist.Add(mi);
					}

					while (randlist.Count < p.Members.Count)
					{
						// pick a random member from the start list
						// then take them off the list
						int randindex = Utility.Random(startlist.Count);

						randlist.Add(startlist[randindex]);

						startlist.RemoveAt(randindex);
					}</pre>

## Duplicated Code. Size: 175

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Seventh\EnergyField.cs

<pre>Point3D loc = new Point3D(eastToWest ? p.X + i : p.X, eastToWest ? p.Y : p.Y + i, p.Z);
                    bool canFit = SpellHelper.AdjustField(ref loc, this.Caster.Map, 12, false);

                    if (!canFit)
                        continue;

                    Item item = new InternalItem(loc, this.Caster.Map, duration, itemID, this.Caster);
                    item.ProcessDelta();</pre>

Fragment 2 in file Scripts\Spells\Sixth\ParalyzeField.cs

<pre>Point3D loc = new Point3D(eastToWest ? p.X + i : p.X, eastToWest ? p.Y : p.Y + i, p.Z);
                    bool canFit = SpellHelper.AdjustField(ref loc, this.Caster.Map, 12, false);

                    if (!canFit)
                        continue;

                    Item item = new InternalItem(this.Caster, itemID, loc, this.Caster.Map, duration);
                    item.ProcessDelta();</pre>

## Duplicated Code. Size: 175

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBHolyMage.cs

<pre>Type[] types = Loot.RegularScrollTypes;

                for (int i = 0; i < types.Length && i < 8; ++i)
                {
                    int itemID = 0x1F2E + i;

                    if (i == 6)
                        itemID = 0x1F2D;
                    else if (i > 6)
                        --itemID;

                    this.Add(new GenericBuyInfo(types[i], 12 + ((i / 8) * 10), 20, itemID, 0));
                }</pre>

Fragment 2 in file Scripts\VendorInfo\SBNecromancer.cs

<pre>Type[] types = Loot.RegularScrollTypes;

				for (int i = 0; i < types.Length && i < 8; ++i)
                {
                    int itemID = 0x1F2E + i;

                    if (i == 6)
                        itemID = 0x1F2D;
                    else if (i > 6)
                        --itemID;

                    this.Add(new GenericBuyInfo(types[i], 12 + ((i / 8) * 10), 20, itemID, 0));
                }</pre>

## Duplicated Code. Size: 175

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Knights\KnightsBascinet.cs

<pre>{	
			this.Hue = 1150;	
            this.Weight = 5;

            this.Attributes.BonusHits = 1;

            this.SetAttributes.BonusHits = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1150;
            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Knights\KnightsCloseHelm.cs

<pre>{
            this.Hue = 1150;
            this.Weight = 5;

            this.Attributes.BonusHits = 1;

            this.SetAttributes.BonusHits = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1150;
            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Knights\KnightsNorseHelm.cs

<pre>{
            this.Hue = 1150;
            this.Weight = 5;

            this.Attributes.BonusHits = 1;

            this.SetAttributes.BonusHits = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1150;
            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Knights\KnightsPlateArms.cs

<pre>{
            this.Hue = 1150;
            this.Weight = 5;

            this.Attributes.BonusHits = 1;

            this.SetAttributes.BonusHits = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1150;
            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Knights\KnightsPlateHelm.cs

<pre>{
            this.Hue = 1150;
            this.Weight = 5;

            this.Attributes.BonusHits = 1;

            this.SetAttributes.BonusHits = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1150;
            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;
		}</pre>

## Duplicated Code. Size: 174

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SHTelGenDelete.cs

<pre>SHTeleporter tele1, tele2;

                this.AddSHTCouple(true, 2608, 763, 0, false, 5918, 1794, 0);
                this.AddSHTCouple(false, 5897, 1877, 0, false, 5871, 1867, 0);
                this.AddSHTCouple(false, 5852, 1848, 0, false, 5771, 1867, 0);

                tele1 = this.AddSHT(Map.Trammel, false, 5747, 1895, 0);</pre>

Fragment 2 in file Scripts\Items\Addons\SHTeleporter.cs

<pre>SHTeleporter tele1, tele2;

                this.AddSHTCouple(true, 2608, 763, 0, false, 5918, 1794, 0);
                this.AddSHTCouple(false, 5897, 1877, 0, false, 5871, 1867, 0);
                this.AddSHTCouple(false, 5852, 1848, 0, false, 5771, 1867, 0);

                tele1 = this.AddSHT(Map.Trammel, false, 5747, 1895, 0);</pre>

## Duplicated Code. Size: 174

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\CategorizedAddGump.cs

<pre>if (count < 0)
                count = 0;
            else if (count > EntryCount)
                count = EntryCount;

            int totalHeight = OffsetSize + ((EntryHeight + OffsetSize) * (count + 1));

            this.AddPage(0);

            this.AddBackground(0, 0, BackWidth, BorderSize + totalHeight + BorderSize, BackGumpID);
            this.AddImageTiled(BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), totalHeight, OffsetGumpID);</pre>

Fragment 2 in file Scripts\Gumps\Go\GoGump.cs

<pre>if (count < 0)
                count = 0;
            else if (count > EntryCount)
                count = EntryCount;

            int totalHeight = OffsetSize + ((EntryHeight + OffsetSize) * (count + 1));

            this.AddPage(0);

            this.AddBackground(0, 0, BackWidth, BorderSize + totalHeight + BorderSize, BackGumpID);
            this.AddImageTiled(BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), totalHeight, OffsetGumpID);</pre>

## Duplicated Code. Size: 174

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DungeonHitchingPost.cs

<pre>if (!e.Handled && e.HasKeyword(0x0008))
            {
                e.Handled = true;
                this.BeginStable(e.Mobile);
            }
            else if (!e.Handled && e.HasKeyword(0x0009))
            {
                e.Handled = true;

                if (!Insensitive.Equals(e.Speech, "claim"))
                    this.BeginClaimList(e.Mobile);
                else
                    this.Claim(e.Mobile);
            }
            else
            {
                base.OnSpeech(e);
            }</pre>

Fragment 2 in file Scripts\Items\Addons\HitchingPost.cs

<pre>if (!e.Handled && e.HasKeyword(0x0008))
                {
                    e.Handled = true;
                    this.BeginStable(e.Mobile);
                }
                else if (!e.Handled && e.HasKeyword(0x0009))
                {
                    e.Handled = true;

                    if (!Insensitive.Equals(e.Speech, "claim"))
                        this.BeginClaimList(e.Mobile);
                    else
                        this.Claim(e.Mobile);
                }
                else
                {
                    base.OnSpeech(e);
                }</pre>

## Duplicated Code. Size: 174

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\AnimalAI.cs

<pre>{
                if (this.AcquireFocusMob(this.m_Mobile.RangePerception * 2, FightMode.Closest, true, false, true))
                {
                    if (this.WalkMobileRange(this.m_Mobile.FocusMob, 1, false, this.m_Mobile.RangePerception, this.m_Mobile.RangePerception * 2))
                    {
                        this.m_Mobile.DebugSay("Well, here I am safe");
                        this.Action = ActionType.Wander;
                    }
                }
                else
                {
                    this.m_Mobile.DebugSay("I have lost my focus, lets relax");
                    this.Action = ActionType.Wander;
                }
            }</pre>

Fragment 2 in file Scripts\Mobiles\AI\PredatorAI.cs

<pre>{
                if (this.AcquireFocusMob(this.m_Mobile.RangePerception * 2, FightMode.Closest, true, false, true))
                {
                    if (this.WalkMobileRange(this.m_Mobile.FocusMob, 1, false, this.m_Mobile.RangePerception, this.m_Mobile.RangePerception * 2))
                    {
                        this.m_Mobile.DebugSay("Well, here I am safe");
                        this.Action = ActionType.Wander;
                    }
                }
                else
                {
                    this.m_Mobile.DebugSay("I have lost my focus, lets relax");
                    this.Action = ActionType.Wander;
                }
            }</pre>

## Duplicated Code. Size: 174

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\CrystalDaemon.cs

<pre>this.SetSkill(SkillName.Wrestling, 60.0, 80.0);
            this.SetSkill(SkillName.Tactics, 70.0, 80.0);
            this.SetSkill(SkillName.MagicResist, 100.0, 110.0);
            this.SetSkill(SkillName.Magery, 120.0, 130.0);
            this.SetSkill(SkillName.EvalInt, 100.0, 110.0);
            this.SetSkill(SkillName.Meditation, 100.0, 110.0);

            this.Fame = 15000;
            this.Karma = -15000;</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\Djinn.cs

<pre>this.SetSkill(SkillName.Wrestling, 60.0, 80.0);
            this.SetSkill(SkillName.Tactics, 70.0, 80.0);
            this.SetSkill(SkillName.MagicResist, 100.0, 110.0);
            this.SetSkill(SkillName.Magery, 120.0, 130.0);
            this.SetSkill(SkillName.EvalInt, 100.0, 110.0);
            this.SetSkill(SkillName.Meditation, 100.0, 110.0);

            this.Fame = 15000;
            this.Karma = -15000;</pre>

## Duplicated Code. Size: 173

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\PickpocketDips.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_MinSkill = reader.ReadDouble();
                        this.m_MaxSkill = reader.ReadDouble();

                        if (this.m_MinSkill == 0.0 && this.m_MaxSkill == 30.0)
                        {
                            this.m_MinSkill = -25.0;
                            this.m_MaxSkill = +25.0;
                        }

                        break;
                    }
            }

            this.UpdateItemID();
        }</pre>

Fragment 2 in file Scripts\Items\Addons\TrainingDummies.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_MinSkill = reader.ReadDouble();
                        this.m_MaxSkill = reader.ReadDouble();

                        if (this.m_MinSkill == 0.0 && this.m_MaxSkill == 30.0)
                        {
                            this.m_MinSkill = -25.0;
                            this.m_MaxSkill = +25.0;
                        }

                        break;
                    }
            }

            this.UpdateItemID();
        }</pre>

## Duplicated Code. Size: 173

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\TaxidermyKit.cs

<pre>public override void Serialize( GenericWriter writer )
		{
			base.Serialize( writer );

			writer.Write( (int) 1 ); // version

			writer.Write( (Mobile) m_Hunter );
			writer.Write( (int) m_AnimalWeight );

			writer.Write( (int) m_WestID );
			writer.Write( (int) m_NorthID );
			writer.Write( (int) m_DeedNumber );
			writer.Write( (int) m_AddonNumber );
		}</pre>

Fragment 2 in file Scripts\Items\Consumables\TaxidermyKit.cs

<pre>public override void Serialize( GenericWriter writer )
		{
			base.Serialize( writer );

			writer.Write( (int) 1 ); // version

			writer.Write( (Mobile) m_Hunter );
			writer.Write( (int) m_AnimalWeight );

			writer.Write( (int) m_WestID );
			writer.Write( (int) m_NorthID );
			writer.Write( (int) m_DeedNumber );
			writer.Write( (int) m_AddonNumber );
		}</pre>

## Duplicated Code. Size: 173

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\BaseCollectionItem.cs

<pre>public virtual void Donate(PlayerMobile player, CollectionItem item, int amount)
        {
            int points = (int)Math.Round(amount * item.Points);

            player.AddCollectionPoints(this.CollectionID, points);

            player.SendLocalizedMessage(1072816); // Thank you for your donation!
            player.SendLocalizedMessage(1072817, points.ToString()); // You have earned ~1_POINTS~ reward points for this donation.	
            player.SendLocalizedMessage(1072818, points.ToString()); // The Collection has been awarded ~1_POINTS~ points

            this.Points += points;

            this.InvalidateProperties();
        }</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\BaseCollectionMobile.cs

<pre>public virtual void Donate(PlayerMobile player, CollectionItem item, int amount)
        {
            int points = (int)Math.Round(amount * item.Points);

            player.AddCollectionPoints(this.CollectionID, points);

            player.SendLocalizedMessage(1072816); // Thank you for your donation!
            player.SendLocalizedMessage(1072817, points.ToString()); // You have earned ~1_POINTS~ reward points for this donation.	
            player.SendLocalizedMessage(1072818, points.ToString()); // The Collection has been awarded ~1_POINTS~ points

            this.Points += points;

            this.InvalidateProperties();
        }</pre>

## Duplicated Code. Size: 173

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Artifacts.cs

<pre>{
            Hue = 1645;
			Attributes.Luck = 150;
			Attributes.LowerManaCost = 5;
			Attributes.LowerRegCost = 10;

			switch(Utility.Random(5))
			{
                case 0: Resistances.Physical = -3; break;
                case 1: Resistances.Fire = -3; break;
                case 2: Resistances.Cold = -3; break;
                case 3: Resistances.Poison = -3; break;
                case 4: Resistances.Energy = -3; break;
			}
		}</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Artifacts.cs

<pre>{
            Hue = 1645;
			Attributes.Luck = 150;
			Attributes.LowerManaCost = 5;
			Attributes.LowerRegCost = 10;

			switch(Utility.Random(5))
			{
                case 0: Resistances.Physical = -3; break;
                case 1: Resistances.Fire = -3; break;
                case 2: Resistances.Cold = -3; break;
                case 3: Resistances.Poison = -3; break;
                case 4: Resistances.Energy = -3; break;
			}
		}</pre>

## Duplicated Code. Size: 173

### Duplicated Fragments:

Fragment 1 in file Ultima\AnimationEdit.cs

<pre>int BlueTemp = (Palette[i] - 0x8000) / 0x20;
				BlueTemp *= 0x20;
				BlueTemp = (Palette[i] - 0x8000) - BlueTemp;
				int GreenTemp = (Palette[i] - 0x8000) / 0x400;
				GreenTemp *= 0x400;
				GreenTemp = ((Palette[i] - 0x8000) - GreenTemp) - BlueTemp;
				GreenTemp /= 0x20;
				int RedTemp = (Palette[i] - 0x8000) / 0x400;</pre>

Fragment 2 in file Ultima\AnimationEdit.cs

<pre>int BlueTemp = (Palette[i] - 0x8000) / 0x20;
				BlueTemp *= 0x20;
				BlueTemp = (Palette[i] - 0x8000) - BlueTemp;
				int GreenTemp = (Palette[i] - 0x8000) / 0x400;
				GreenTemp *= 0x400;
				GreenTemp = ((Palette[i] - 0x8000) - GreenTemp) - BlueTemp;
				GreenTemp /= 0x20;
				int RedTemp = (Palette[i] - 0x8000) / 0x400;</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\Abilities.cs

<pre>public static Party GetParty(Mobile m)
        {
            Party party = Party.Get(m);

            if (party == null && m is BaseCreature)
            {
                BaseCreature bc = (BaseCreature)m;
                m = bc.ControlMaster;

                if (m != null)
                    party = Party.Get(m);

                m = bc.SummonMaster;

                if (m != null && party == null)
                    party = Party.Get(m);
            }

            return party;
        }</pre>

Fragment 2 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>public static Party GetParty(Mobile m)
        {
            Party party = Party.Get(m);

            if (party == null && m is BaseCreature)
            {
                BaseCreature bc = (BaseCreature)m;
                m = bc.ControlMaster;

                if (m != null)
                    party = Party.Get(m);

                m = bc.SummonMaster;

                if (m != null && party == null)
                    party = Party.Get(m);
            }

            return party;
        }</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(172, 27, 200, "Unload");
            //colunas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 2, 171, 10003);
            this.AddImageTiled(163, 25, 2, 171, 10003);
            this.AddImageTiled(220, 25, 2, 171, 10003);

            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(172, 27, 200, "Unload");
            //colunas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 2, 171, 10003);
            this.AddImageTiled(163, 25, 2, 171, 10003);
            this.AddImageTiled(220, 25, 2, 171, 10003);

            //Linhas
            //x, y, comprimento, ?, item
            this.AddImageTiled(20, 25, 200, 2, 10001);</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DecorativeShield.cs

<pre>this.m_ItemID = itemID;
                    this.m_Location = location;
                    this.m_House = house;

                    this.Closable = true;
                    this.Disposable = true;
                    this.Dragable = true;
                    this.Resizable = false;

                    this.AddPage(0);
                    this.AddBackground(0, 0, 300, 150, 0xA28);

                    this.AddItem(90, 30, GetWestItemID(itemID));
                    this.AddItem(180, 30, itemID);</pre>

Fragment 2 in file Scripts\Items\Addons\HangingSkeleton.cs

<pre>this.m_ItemID = itemID;
                    this.m_Location = location;
                    this.m_House = house;

                    this.Closable = true;
                    this.Disposable = true;
                    this.Dragable = true;
                    this.Resizable = false;

                    this.AddPage(0);

                    this.AddBackground(0, 0, 300, 150, 0xA28);

                    this.AddItem(90, 30, GetWestItemID(itemID));
                    this.AddItem(180, 30, itemID);</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if (GetSaveFlag(flags, SaveFlag.MaxHitPoints))
                writer.WriteEncodedInt((int)this.m_MaxHitPoints);

            if (GetSaveFlag(flags, SaveFlag.HitPoints))
                writer.WriteEncodedInt((int)this.m_HitPoints);

            if (GetSaveFlag(flags, SaveFlag.Crafter))
                writer.Write((Mobile)this.m_Crafter);

            if (GetSaveFlag(flags, SaveFlag.Quality))
                writer.WriteEncodedInt((int)this.m_Quality);</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if (GetSaveFlag(flags, SaveFlag.MaxHitPoints))
                writer.WriteEncodedInt((int)this.m_MaxHitPoints);

            if (GetSaveFlag(flags, SaveFlag.HitPoints))
                writer.WriteEncodedInt((int)this.m_HitPoints);

            if (GetSaveFlag(flags, SaveFlag.Crafter))
                writer.Write((Mobile)this.m_Crafter);

            if (GetSaveFlag(flags, SaveFlag.Quality))
                writer.WriteEncodedInt((int)this.m_Quality);</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Quest\TyballsKey.cs

<pre>public override void OnDoubleClick(Mobile m)
        {
            Item a = m.Backpack.FindItemByType(typeof(RedKey1));
            if (a != null)
            {
                Item b = m.Backpack.FindItemByType(typeof(BlueKey1));
                if (b != null)
                {
                    m.AddToBackpack(new TripartiteKey());
                    a.Delete();
                    b.Delete();
                    this.Delete();
                    m.SendLocalizedMessage(1111649);
                }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Quest\YellowKey1.cs

<pre>public override void OnDoubleClick(Mobile m)
        {
            Item a = m.Backpack.FindItemByType(typeof(RedKey1));
            if (a != null)
            {
                Item b = m.Backpack.FindItemByType(typeof(BlueKey1));
                if (b != null)
                {
                    m.AddToBackpack(new TripartiteKey());
                    a.Delete();
                    b.Delete();
                    this.Delete();
                    m.SendLocalizedMessage(1111649);
                }
            }
        }</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\MonstrousInterredGrizzle.cs

<pre>Point3D p = new Point3D(this.Location);

                for (int j = 0; j < 5; j ++)
                {
                    p = this.GetSpawnPosition(2);
                    bool found = false;

                    foreach (Item item in this.Map.GetItemsInRange(p, 0))
                        if (item is InfernalOoze)
                        {
                            found = true;
                            break;
                        }

                    if (!found)
                        break;			
                }

                ooze.MoveToWorld(p, this.Map);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\InterredGrizzle .cs

<pre>Point3D p = new Point3D(this.Location);

                for (int j = 0; j < 5; j++)
                {
                    p = this.GetSpawnPosition(2);
                    bool found = false;

                    foreach (Item item in this.Map.GetItemsInRange(p, 0))
                        if (item is InfernalOoze)
                        {
                            found = true;
                            break;
                        }

                    if (!found)
                        break;
                }

                ooze.MoveToWorld(p, this.Map);</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\OphidianMatriarch.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 45, 55);
            SetResistance(ResistanceType.Fire, 30, 40);
            SetResistance(ResistanceType.Cold, 35, 45);
            SetResistance(ResistanceType.Poison, 40, 50);
            SetResistance(ResistanceType.Energy, 35, 45);

            SetSkill(SkillName.EvalInt, 90.1, 100.0);
            SetSkill(SkillName.Magery, 90.1, 100.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\TerathanMatriarch.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 45, 55);
            SetResistance(ResistanceType.Fire, 30, 40);
            SetResistance(ResistanceType.Cold, 35, 45);
            SetResistance(ResistanceType.Poison, 40, 50);
            SetResistance(ResistanceType.Energy, 35, 45);

            SetSkill(SkillName.EvalInt, 90.1, 100.0);
            SetSkill(SkillName.Magery, 90.1, 100.0);</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CleanUpBritannia\Items\DragonHead.cs

<pre>public bool CouldFit(IPoint3D p, Map map)
        {
            if (map == null || !map.CanFit(p.X, p.Y, p.Z, this.ItemData.Height))
                return false;

            if (this.FacingEast)
                return BaseAddon.IsWall(p.X - 1, p.Y, p.Z, map); // west wall                
            else
                return BaseAddon.IsWall(p.X, p.Y - 1, p.Z, map); // north wall
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\DecorativeShardShields.cs

<pre>public bool CouldFit(IPoint3D p, Map map)
        {
            if (map == null || !map.CanFit(p.X, p.Y, p.Z, this.ItemData.Height))
                return false;

            if (this.FacingEast)
                return BaseAddon.IsWall(p.X - 1, p.Y, p.Z, map); // west wall                
            else
                return BaseAddon.IsWall(p.X, p.Y - 1, p.Z, map); // north wall
        }</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CleanUpBritannia\Items\Steward.cs

<pre>if (checkItems && maxItems != 0 &&
                    (TotalItems + plusItems + item.TotalItems + (item.IsVirtualItem ? 0 : 1)) > maxItems)
                {
                    if (message)
                    {
                        SendFullItemsMessage(m, item);
                    }

                    return false;
                }
                else
                {
                    int maxWeight = MaxWeight;

                    if (maxWeight != 0 && (TotalWeight + plusWeight + item.TotalWeight + item.PileWeight) > maxWeight)
                    {
                        if (message)
                        {
                            SendFullWeightMessage(m, item);
                        }

                        return false;
                    }
                }</pre>

Fragment 2 in file Server\Items\Container.cs

<pre>if (checkItems && maxItems != 0 &&
					(TotalItems + plusItems + item.TotalItems + (item.IsVirtualItem ? 0 : 1)) > maxItems)
				{
					if (message)
					{
						SendFullItemsMessage(m, item);
					}

					return false;
				}
				else
				{
					int maxWeight = MaxWeight;

					if (maxWeight != 0 && (TotalWeight + plusWeight + item.TotalWeight + item.PileWeight) > maxWeight)
					{
						if (message)
						{
							SendFullWeightMessage(m, item);
						}

						return false;
					}
				}</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\Core\CraftItem.cs

<pre>{
				if (tool != null && !tool.Deleted && tool.UsesRemaining > 0)
				{
					from.SendGump(new CraftGump(from, craftSystem, tool, checkMessage));
				}
				else if (checkMessage is int && (int)checkMessage > 0)
				{
					from.SendLocalizedMessage((int)checkMessage);
				}
				else if (checkMessage is string)
				{
					from.SendMessage((string)checkMessage);
				}

                AutoCraftTimer.EndTimer(from);

				return;
			}</pre>

Fragment 2 in file Scripts\Services\Craft\Core\CraftItem.cs

<pre>{
				if (tool != null && !tool.Deleted && tool.UsesRemaining > 0)
				{
					from.SendGump(new CraftGump(from, craftSystem, tool, checkMessage));
				}
				else if (checkMessage is int && (int)checkMessage > 0)
				{
					from.SendLocalizedMessage((int)checkMessage);
				}
				else if (checkMessage is string)
				{
					from.SendMessage((string)checkMessage);
				}

                AutoCraftTimer.EndTimer(from);

				return;
			}</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\AuctionSafe\Gumps.cs

<pre>TimeSpan left = Auction.EndTime - DateTime.Now;
                int cliloc;
                double v;

                if (left.TotalDays >= 7)
                {
                    cliloc = 1153092; // Lifespan: ~1_val~ weeks
                    v = left.TotalDays / 7;
                }
                else if (left.TotalDays >= 1)
                {
                    cliloc = 1153091; // Lifespan: ~1_val~ days
                    v = left.TotalDays;
                }
                else if (left.TotalHours >= 1)
                {
                    cliloc = 1153090; // Lifespan: ~1_val~ hours
                    v = left.TotalHours;
                }
                else
                {
                    cliloc = 1153089; // Lifespan: ~1_val~ minutes
                    v = left.TotalMinutes;
                }</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\AuctionSafe\Gumps.cs

<pre>TimeSpan left = Auction.EndTime - DateTime.Now;
            int cliloc;
            double v;

            if (left.TotalDays >= 7)
            {
                cliloc = 1153092; // Lifespan: ~1_val~ weeks
                v = left.TotalDays / 7;
            }
            else if (left.TotalDays >= 1)
            {
                cliloc = 1153091; // Lifespan: ~1_val~ days
                v = left.TotalDays;
            }
            else if (left.TotalHours >= 1)
            {
                cliloc = 1153090; // Lifespan: ~1_val~ hours
                v = left.TotalHours;
            }
            else
            {
                cliloc = 1153089; // Lifespan: ~1_val~ minutes
                v = left.TotalMinutes;
            }</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketHandlers.cs

<pre>state.Send(new MobileStatus(m, m));
				state.Send(Network.SetWarMode.Instantiate(m.Warmode));

				m.SendEverything();

				state.Send(SupportedFeatures.Instantiate(state));
				state.Send(new MobileUpdate(m));
				//state.Send( new MobileAttributes( m ) );
				state.Send(new MobileStatus(m, m));
				state.Send(Network.SetWarMode.Instantiate(m.Warmode));</pre>

Fragment 2 in file Server\Network\PacketHandlers.cs

<pre>state.Send(new MobileStatus(m, m));
				state.Send(Network.SetWarMode.Instantiate(m.Warmode));

				m.SendEverything();

				state.Send(SupportedFeatures.Instantiate(state));
				state.Send(new MobileUpdate(m));
				//state.Send( new MobileAttributes( m ) );
				state.Send(new MobileStatus(m, m));
				state.Send(Network.SetWarMode.Instantiate(m.Warmode));</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketHandlers.cs

<pre>for (int i = 0; i < a.Length; ++i)
				{
					Mobile check = a[i];

					if (check != null && check.Map != Map.Internal)
					{
						Utility.PushColor(ConsoleColor.Red);
						Console.WriteLine("Login: {0}: Account in use", state);
						Utility.PopColor();
						state.Send(new PopupMessage(PMMessage.CharInWorld));
						return;
					}
				}

				state.Flags = (ClientFlags)flags;</pre>

Fragment 2 in file Server\Network\PacketHandlers.cs

<pre>for (int i = 0; i < a.Length; ++i)
				{
					Mobile check = a[i];

					if (check != null && check.Map != Map.Internal)
					{
						Utility.PushColor(ConsoleColor.Red);
						Console.WriteLine("Login: {0}: Account in use", state);
						Utility.PopColor();
						state.Send(new PopupMessage(PMMessage.CharInWorld));
						return;
					}
				}

				state.Flags = (ClientFlags)flags;</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Banner.cs

<pre>public bool CouldFit(IPoint3D p, Map map)
        { 
            if (map == null || !map.CanFit(p.X, p.Y, p.Z, this.ItemData.Height))
                return false;

            if (this.FacingSouth)
                return BaseAddon.IsWall(p.X, p.Y - 1, p.Z, map); // north wall
            else
                return BaseAddon.IsWall(p.X - 1, p.Y, p.Z, map); // west wall
        }</pre>

Fragment 2 in file Scripts\Items\Addons\DecorativeShield.cs

<pre>public bool CouldFit(IPoint3D p, Map map)
        { 
            if (map == null || !map.CanFit(p.X, p.Y, p.Z, this.ItemData.Height))
                return false;

            if (this.FacingSouth)
                return BaseAddon.IsWall(p.X, p.Y - 1, p.Z, map); // north wall
            else
                return BaseAddon.IsWall(p.X - 1, p.Y, p.Z, map); // west wall
        }</pre>

Fragment 3 in file Scripts\Items\Addons\HangingSkeleton.cs

<pre>public bool CouldFit(IPoint3D p, Map map)
        { 
            if (map == null || !map.CanFit(p.X, p.Y, p.Z, this.ItemData.Height))
                return false;

            if (this.FacingSouth)	
                return BaseAddon.IsWall(p.X, p.Y - 1, p.Z, map); // north wall
            else
                return BaseAddon.IsWall(p.X - 1, p.Y, p.Z, map); // west wall
        }</pre>

## Duplicated Code. Size: 172

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\Core\CraftItem.cs

<pre>{
					if (tool != null && !tool.Deleted && tool.UsesRemaining > 0)
					{
						from.SendGump(new CraftGump(from, craftSystem, tool, message));
					}
					else if (message is int && (int)message > 0)
					{
						from.SendLocalizedMessage((int)message);
					}
					else if (message is string)
					{
						from.SendMessage((string)message);
					}

                    AutoCraftTimer.EndTimer(from);

					return;
				}</pre>

Fragment 2 in file Scripts\Services\Craft\Core\CraftItem.cs

<pre>{
					if (tool != null && !tool.Deleted && tool.UsesRemaining > 0)
					{
						from.SendGump(new CraftGump(from, craftSystem, tool, message));
					}
					else if (message is int && (int)message > 0)
					{
						from.SendLocalizedMessage((int)message);
					}
					else if (message is string)
					{
						from.SendMessage((string)message);
					}

                    AutoCraftTimer.EndTimer(from);

					return;
				}</pre>

Fragment 3 in file Scripts\Services\Craft\Core\CraftItem.cs

<pre>{
					if (tool != null && !tool.Deleted && tool.UsesRemaining > 0)
					{
						from.SendGump(new CraftGump(from, craftSystem, tool, message));
					}
					else if (message is int && (int)message > 0)
					{
						from.SendLocalizedMessage((int)message);
					}
					else if (message is string)
					{
						from.SendMessage((string)message);
					}

                    AutoCraftTimer.EndTimer(from);

					return;
				}</pre>

## Duplicated Code. Size: 171

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\Abilities.cs

<pre>public static bool IsGoodGuy(Mobile m)
        {
            if (m.Criminal)
                return false;

            if (m.Player && m.Kills < 5)
                return true;

            if (m is BaseCreature)
            {
                BaseCreature bc = (BaseCreature)m;

                if (bc.Controlled || bc.Summoned)
                {
                    if (bc.ControlMaster != null)
                        return IsGoodGuy(bc.ControlMaster);
                    else if (bc.SummonMaster != null)
                        return IsGoodGuy(bc.SummonMaster);
                }
            }

            return false;
        }</pre>

Fragment 2 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>public static bool IsGoodGuy(Mobile m)
        {
            if (m.Criminal)
                return false;

            if (m.Player && m.Kills < 5)
                return true;

            if (m is BaseCreature)
            {
                BaseCreature bc = (BaseCreature)m;

                if (bc.Controlled || bc.Summoned)
                {
                    if (bc.ControlMaster != null)
                        return IsGoodGuy(bc.ControlMaster);
                    else if (bc.SummonMaster != null)
                        return IsGoodGuy(bc.SummonMaster);
                }
            }

            return false;
        }</pre>

## Duplicated Code. Size: 171

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\SmeltersTalisman.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            Resource = (CraftResource)reader.ReadInt();
            Expires = reader.ReadDateTime();
            UsesRemaining = reader.ReadInt();

            if (Expires < DateTime.UtcNow)
                Decay();
            else
                m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), CheckDecay);
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\WoodsmanTalisman.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            Resource = (CraftResource)reader.ReadInt();
            Expires = reader.ReadDateTime();
            UsesRemaining = reader.ReadInt();

            if (Expires < DateTime.UtcNow)
                Decay();
            else
                m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), CheckDecay);
        }</pre>

## Duplicated Code. Size: 171

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\TreasuresOfTokuno\TreasuresOfTokuno.cs

<pre>new PigmentsTileButtonInfo[]
            {
                new PigmentsTileButtonInfo(PigmentType.ParagonGold),
                new PigmentsTileButtonInfo(PigmentType.VioletCouragePurple),
                new PigmentsTileButtonInfo(PigmentType.InvulnerabilityBlue),
                new PigmentsTileButtonInfo(PigmentType.LunaWhite),
                new PigmentsTileButtonInfo(PigmentType.DryadGreen),
                new PigmentsTileButtonInfo(PigmentType.ShadowDancerBlack),
                new PigmentsTileButtonInfo(PigmentType.BerserkerRed),
                new PigmentsTileButtonInfo(PigmentType.NoxGreen),
                new PigmentsTileButtonInfo(PigmentType.RumRed),
                new PigmentsTileButtonInfo(PigmentType.FireOrange)
            }</pre>

Fragment 2 in file Scripts\Services\TreasuresOfTokuno\TreasuresOfTokuno.cs

<pre>new PigmentsTileButtonInfo[]
            {
                new PigmentsTileButtonInfo(PigmentType.ParagonGold),
                new PigmentsTileButtonInfo(PigmentType.VioletCouragePurple),
                new PigmentsTileButtonInfo(PigmentType.InvulnerabilityBlue),
                new PigmentsTileButtonInfo(PigmentType.LunaWhite),
                new PigmentsTileButtonInfo(PigmentType.DryadGreen),
                new PigmentsTileButtonInfo(PigmentType.ShadowDancerBlack),
                new PigmentsTileButtonInfo(PigmentType.BerserkerRed),
                new PigmentsTileButtonInfo(PigmentType.NoxGreen),
                new PigmentsTileButtonInfo(PigmentType.RumRed),
                new PigmentsTileButtonInfo(PigmentType.FireOrange)
            }</pre>

## Duplicated Code. Size: 171

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\HolyFistSpell.cs

<pre>public override bool CheckSequence()
        {
            int requiredTithing = this.RequiredTithing;

            if (Caster is PlayerMobile && Caster.TithingPoints < requiredTithing)
            {
                Caster.SendLocalizedMessage(1060173, RequiredTithing.ToString()); // You must have at least ~1_TITHE_REQUIREMENT~ Tithing Points to use this ability,
                return false;
            }

            if (AosAttributes.GetValue(Caster, AosAttribute.LowerRegCost) > Utility.Random(100))
                requiredTithing = 0;

            if(requiredTithing > 0 && Caster is PlayerMobile)
                Caster.TithingPoints -= requiredTithing;

            return base.CheckSequence();
        }</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\Rejuvinate.cs

<pre>public override bool CheckSequence()
        {
            int requiredTithing = this.RequiredTithing;

            if (Caster is PlayerMobile && Caster.TithingPoints < requiredTithing)
            {
                Caster.SendLocalizedMessage(1060173, RequiredTithing.ToString()); // You must have at least ~1_TITHE_REQUIREMENT~ Tithing Points to use this ability,
                return false;
            }

            if (AosAttributes.GetValue(Caster, AosAttribute.LowerRegCost) > Utility.Random(100))
                requiredTithing = 0;

            if (requiredTithing > 0 && Caster is PlayerMobile)
                Caster.TithingPoints -= requiredTithing;

            return base.CheckSequence();
        }</pre>

## Duplicated Code. Size: 171

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\ThrowingDagger.cs

<pre>{
                                case Direction.North:
                                    --y;
                                    break;
                                case Direction.South:
                                    ++y;
                                    break;
                                case Direction.West:
                                    --x;
                                    break;
                                case Direction.East:
                                    ++x;
                                    break;
                                case Direction.Up:
                                    --x;
                                    --y;
                                    break;
                                case Direction.Down:
                                    ++x;
                                    ++y;
                                    break;
                                case Direction.Left:
                                    --x;
                                    ++y;
                                    break;
                                case Direction.Right:
                                    ++x;
                                    --y;
                                    break;
                            }</pre>

Fragment 2 in file Scripts\Items\Functional\BaseDoor.cs

<pre>{
                    case Direction.North:
                        --y;
                        break;
                    case Direction.Right:
                        ++x;
                        --y;
                        break;
                    case Direction.East:
                        ++x;
                        break;
                    case Direction.Down:
                        ++x;
                        ++y;
                        break;
                    case Direction.South:
                        ++y;
                        break;
                    case Direction.Left:
                        --x;
                        ++y;
                        break;
                    case Direction.West:
                        --x;
                        break;
                    case Direction.Up:
                        --x;
                        --y;
                        break;
                }</pre>

Fragment 3 in file Server\Mobile.cs

<pre>{
						case Direction.North:
							--y;
							break;
						case Direction.Right:
							++x;
							--y;
							break;
						case Direction.East:
							++x;
							break;
						case Direction.Down:
							++x;
							++y;
							break;
						case Direction.South:
							++y;
							break;
						case Direction.Left:
							--x;
							++y;
							break;
						case Direction.West:
							--x;
							break;
						case Direction.Up:
							--x;
							--y;
							break;
					}</pre>

## Duplicated Code. Size: 170

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>if (list != null)
			{
				if (removeall)
				{
					attachments.Remove(o);
				}
				else
				{
					for(int i = list.Count - 1; i>=0; --i)
					{
						XmlAttachment x = list[i];
						if (x == null || x.Deleted)
							list.Remove(x);
					}
					if(list.Count == 0)
						attachments.Remove(o);
				}
			}
			else
				attachments.Remove(o);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>if (list != null)
			{
				if (removeall)
				{
					attachments.Remove(o);
				}
				else
				{
					for(int i = list.Count - 1; i>=0; --i)
					{
						XmlAttachment x = list[i];
						if (x == null || x.Deleted)
							list.Remove(x);
					}
					if(list.Count == 0)
						attachments.Remove(o);
				}
			}
			else
				attachments.Remove(o);</pre>

## Duplicated Code. Size: 169

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Wreath.cs

<pre>public virtual bool Dye(Mobile from, DyeTub sender)
        {
            if (this.Deleted)
                return false;

            BaseHouse house = BaseHouse.FindHouseAt(this);

            if (house != null && house.IsCoOwner(from))
            {
                if (from.InRange(this.GetWorldLocation(), 1))
                {
                    this.Hue = sender.DyedHue;
                    return true;
                }
                else
                {
                    from.SendLocalizedMessage(500295); // You are too far away to do that.
                    return false;
                }
            }
            else 
            {
                return false;
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\Mistletoe.cs

<pre>public virtual bool Dye(Mobile from, DyeTub sender)
        {
            if (this.Deleted)
                return false;

            BaseHouse house = BaseHouse.FindHouseAt(this);

            if (house != null && house.IsCoOwner(from))
            {
                if (from.InRange(this.GetWorldLocation(), 1))
                {
                    this.Hue = sender.DyedHue;
                    return true;
                }
                else
                {
                    from.SendLocalizedMessage(500295); // You are too far away to do that.
                    return false;
                }
            }
            else 
            {
                return false;
            }
        }</pre>

## Duplicated Code. Size: 169

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>{
						if (i == null || i.Deleted) continue;
						alist = XmlAttach.FindAttachments(i);
						if (alist != null)
						{
							foreach (XmlAttachment a in alist)
							{
								if (a != null && !a.Deleted && (type == null || (a.GetType() == type || a.GetType().IsSubclassOf(type))) && (name == null || name == a.Name))
								{
									return a;
								}
							}
						}
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>{
					if (i == null || i.Deleted) continue;

					alist = XmlAttach.FindAttachments(i);

					if (alist != null)
					{
						foreach (XmlAttachment a in alist)
						{
							if (a != null && !a.Deleted && (type == null || (a.GetType() == type || a.GetType().IsSubclassOf(type))) && (name == null || name == a.Name))
							{
								return a;
							}
						}
					}
				}</pre>

## Duplicated Code. Size: 169

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>bool returned = false;

					if ((ReturnContainer != null) && !ReturnContainer.Deleted)
					{
						returned = ReturnContainer.TryDropItem(Creator, m_RewardItem, false);
						//ReturnContainer.DropItem(m_RewardItem);
					}
					if (!returned)
					{

						returned = Creator.AddToBackpack(m_RewardItem);

					}
					if (returned)
					{
                        Creator.SendMessage("Your reward {0} was returned from quest {1}", m_RewardItem.GetType().Name, Name);
						//AddMobileWeight(Creator, m_RewardItem);
					}
					else
					{
                        Creator.SendMessage("Attempted to return reward {0} from quest {1} : containers full.", m_RewardItem.GetType().Name, Name);
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>bool returned = false;

                    //RefreshPackLocation(Creator, false);

                    if ((ReturnContainer != null) && !ReturnContainer.Deleted)
                    {
                        returned = ReturnContainer.TryDropItem(Creator, m_RewardItem, false);
                        //ReturnContainer.DropItem(m_RewardItem);
                    }
                    if (!returned)
                    {

                        returned = Creator.AddToBackpack(m_RewardItem);

                    }
                    if (returned)
                    {
                        Creator.SendMessage("Your reward {0} was returned from quest {1}", m_RewardItem.GetType().Name, Name);
                        //AddMobileWeight(Creator, m_RewardItem);
                    }
                    else
                    {
                        Creator.SendMessage("Attempted to return reward {0} from quest {1} : containers full.", m_RewardItem.GetType().Name, Name);
                    }</pre>

## Duplicated Code. Size: 169

### Duplicated Fragments:

Fragment 1 in file Server\MultiData.cs

<pre>{
						var newTiles = new StaticTile[oldTiles.Length - 1];

						for (int j = 0; j < i; ++j)
						{
							newTiles[j] = oldTiles[j];
						}

						for (int j = i + 1; j < oldTiles.Length; ++j)
						{
							newTiles[j - 1] = oldTiles[j];
						}

						m_Tiles[vx][vy] = newTiles;

						break;
					}</pre>

Fragment 2 in file Server\MultiData.cs

<pre>{
						var newTiles = new StaticTile[oldTiles.Length - 1];

						for (int j = 0; j < i; ++j)
						{
							newTiles[j] = oldTiles[j];
						}

						for (int j = i + 1; j < oldTiles.Length; ++j)
						{
							newTiles[j - 1] = oldTiles[j];
						}

						m_Tiles[vx][vy] = newTiles;

						break;
					}</pre>

## Duplicated Code. Size: 168

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Docs.cs

<pre>html.WriteLine("      <style type=\"text/css\">");
				html.WriteLine("      body { background-color: white; font-family: Tahoma; color: #000000; }");
				html.WriteLine("      a, a:visited { color: #000000; }");
				html.WriteLine("      a:active, a:hover { color: #808080; }");
				html.WriteLine("      table { width: 100%; }");
				html.WriteLine("      td.header { width: 100%; }");
				html.WriteLine("      </style>");
				html.WriteLine("      <link rel=\"stylesheet\" type=\"text/css\" href=\"styles.css\" />");
				html.WriteLine("   </head>");
				html.WriteLine("   <body>");
				html.WriteLine("      <a name=\"Top\" />");
				html.WriteLine("      <h4><a href=\"index.html\">Back to the index</a></h4>");</pre>

Fragment 2 in file Scripts\Commands\Docs.cs

<pre>html.WriteLine("      <style type=\"text/css\">");
				html.WriteLine("      body { background-color: white; font-family: Tahoma; color: #000000; }");
				html.WriteLine("      a, a:visited { color: #000000; }");
				html.WriteLine("      a:active, a:hover { color: #808080; }");
				html.WriteLine("      table { width: 100%; }");
				html.WriteLine("      td.header { width: 100%; }");
				html.WriteLine("      </style>");
				html.WriteLine("      <link rel=\"stylesheet\" type=\"text/css\" href=\"styles.css\" />");
				html.WriteLine("   </head>");
				html.WriteLine("   <body>");
				html.WriteLine("      <a name=\"Top\" />");
				html.WriteLine("      <h4><a href=\"index.html\">Back to the index</a></h4>");</pre>

## Duplicated Code. Size: 168

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Mistletoe.cs

<pre>public bool CouldFit(IPoint3D p, Map map)
        {
            if (!map.CanFit(p.X, p.Y, p.Z, this.ItemData.Height))
                return false;

            if (this.ItemID == 0x2375)
                return BaseAddon.IsWall(p.X, p.Y - 1, p.Z, map); // North wall
            else
                return BaseAddon.IsWall(p.X - 1, p.Y, p.Z, map); // West wall
        }</pre>

Fragment 2 in file Scripts\Items\Functional\WallSafe.cs

<pre>public bool CouldFit(IPoint3D p, Map map)
        {
            if (!map.CanFit(p.X, p.Y, p.Z, this.ItemData.Height))
                return false;

            if (this.ItemID == 0x2375)
                return BaseAddon.IsWall(p.X, p.Y - 1, p.Z, map); // North wall
            else
                return BaseAddon.IsWall(p.X - 1, p.Y, p.Z, map); // West wall
        }</pre>

## Duplicated Code. Size: 168

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>Item line1 = AddMooringLine(new MooringLine(this));
            Item line2 = AddMooringLine(new MooringLine(this));
            Item line3 = AddMooringLine(new MooringLine(this));
            Item line4 = AddMooringLine(new MooringLine(this));
            Item line5 = AddMooringLine(new MooringLine(this));
            Item line6 = AddMooringLine(new MooringLine(this));</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>Item line1 = AddMooringLine(new MooringLine(this));
            Item line2 = AddMooringLine(new MooringLine(this));
            Item line3 = AddMooringLine(new MooringLine(this));
            Item line4 = AddMooringLine(new MooringLine(this));
            Item line5 = AddMooringLine(new MooringLine(this));
            Item line6 = AddMooringLine(new MooringLine(this));</pre>

## Duplicated Code. Size: 168

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>Static fill1 = AddFillerTile(new Static(m_FillerIDs[dir][0]));
            Static fill2 = AddFillerTile(new Static(m_FillerIDs[dir][1]));
            Static fill3 = AddFillerTile(new Static(m_FillerIDs[dir][2]));
            Static fill4 = AddFillerTile(new Static(m_FillerIDs[dir][3]));</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>Static fill1 = AddFillerTile(new Static(m_FillerIDs[dir][0]));
            Static fill2 = AddFillerTile(new Static(m_FillerIDs[dir][1]));
            Static fill3 = AddFillerTile(new Static(m_FillerIDs[dir][2]));
            Static fill4 = AddFillerTile(new Static(m_FillerIDs[dir][3]));</pre>

## Duplicated Code. Size: 168

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>writer.Write(m_ExpirationDuration);
			writer.Write(m_TimeCreated);
			writer.Write(m_Objective1);
			writer.Write(m_Objective2);
			writer.Write(m_Objective3);
			writer.Write(m_Objective4);
			writer.Write(m_Objective5);
			writer.Write(m_Completed1);
			writer.Write(m_Completed2);
			writer.Write(m_Completed3);
			writer.Write(m_Completed4);
			writer.Write(m_Completed5);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>writer.Write(m_ExpirationDuration);
            writer.Write(m_TimeCreated);
            writer.Write(m_Objective1);
            writer.Write(m_Objective2);
            writer.Write(m_Objective3);
            writer.Write(m_Objective4);
            writer.Write(m_Objective5);
            writer.Write(m_Completed1);
            writer.Write(m_Completed2);
            writer.Write(m_Completed3);
            writer.Write(m_Completed4);
            writer.Write(m_Completed5);</pre>

## Duplicated Code. Size: 168

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>FileStream fs = null;
				try
				{
					fs = File.Open(filename, FileMode.Open, FileAccess.Read);
				}
				catch { }

				if (fs == null)
				{
					Status = String.Format("Unable to open {0} for loading", filename);
					return;
				}

				// Create the data set
				DataSet ds = new DataSet(XmlDataSetName);

				// Read in the file
				//ds.ReadXml( e.Arguments[0].ToString() );
				bool fileerror = false;
				try
				{
					ds.ReadXml(fs);
				}
				catch { fileerror = true; }

				// close the file
				fs.Close();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>FileStream fs = null;
                try
                {
                    fs = File.Open(filename, FileMode.Open, FileAccess.Read);
                }
                catch { }

                if (fs == null)
                {
                    Status = String.Format("Unable to open {0} for loading", filename);
                    return;
                }
                // Create the data set
                DataSet ds = new DataSet(XmlDataSetName);

                // Read in the file
                //ds.ReadXml( e.Arguments[0].ToString() );
                bool fileerror = false;
                try
                {
                    ds.ReadXml(fs);
                }
                catch { fileerror = true; }
                // close the file
                fs.Close();</pre>

## Duplicated Code. Size: 168

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Second\MagicTrap.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(new Point3D(loc.X + 1, loc.Y, loc.Z), item.Map, EffectItem.DefaultDuration), 0x376A, 9, 10, 9502);
                Effects.SendLocationParticles(EffectItem.Create(new Point3D(loc.X, loc.Y - 1, loc.Z), item.Map, EffectItem.DefaultDuration), 0x376A, 9, 10, 9502);</pre>

Fragment 2 in file Scripts\Spells\Second\MagicTrap.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(new Point3D(loc.X - 1, loc.Y, loc.Z), item.Map, EffectItem.DefaultDuration), 0x376A, 9, 10, 9502);
                Effects.SendLocationParticles(EffectItem.Create(new Point3D(loc.X, loc.Y + 1, loc.Z), item.Map, EffectItem.DefaultDuration), 0x376A, 9, 10, 9502);</pre>

## Duplicated Code. Size: 168

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\SimpleSwitches.cs

<pre>if (Link != null && Link is ILinkable)
			{
				if (links == null)
				{
					links = new ArrayList();
				}
				// activate other linked objects if they have not already been activated
				if (!links.Contains(this))
				{
					links.Add(this);

					((ILinkable)Link).Activate(from, state, links);
				}
			}

			// report any problems to staff
			if (status_str != null && from != null && from.AccessLevel > AccessLevel.Player)
			{
				from.SendMessage("{0}", status_str);
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\SimpleSwitches.cs

<pre>if (Link != null && Link is ILinkable)
			{
				if (links == null)
				{
					links = new ArrayList();
				}
				// activate other linked objects if they have not already been activated
				if (!links.Contains(this))
				{
					links.Add(this);

					((ILinkable)Link).Activate(from, state, links);
				}
			}

			// report any problems to staff
			if (status_str != null && from != null && from.AccessLevel > AccessLevel.Player)
			{
				from.SendMessage("{0}", status_str);
			}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>if (Link != null && Link is ILinkable)
			{
				if (links == null)
				{
					links = new ArrayList();
				}
				// activate other linked objects if they have not already been activated
				if (!links.Contains(this))
				{
					links.Add(this);

					((ILinkable)Link).Activate(from, state, links);
				}
			}

			// report any problems to staff
			if (status_str != null && from != null && from.AccessLevel > AccessLevel.Player)
			{
				from.SendMessage("{0}", status_str);
			}</pre>

## Duplicated Code. Size: 167

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\GreenThorns.cs

<pre>case 0:
                    {
                        Effects.PlaySound(this.Location, this.Map, 0x106);
                        Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3735, 1, 182, 0xBE3);

                        return TimeSpan.FromSeconds(4.0);
                    }
                case 1:
                    {
                        Effects.PlaySound(this.Location, this.Map, 0x222);

                        return TimeSpan.FromSeconds(4.0);
                    }
                case 2:</pre>

Fragment 2 in file Scripts\Items\Consumables\GreenThorns.cs

<pre>case 0:
                    {
                        Effects.PlaySound(this.Location, this.Map, 0x106);
                        Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3735, 1, 182, 0xBE3);

                        return TimeSpan.FromSeconds(4.0);
                    }
                case 1:
                    {
                        Effects.PlaySound(this.Location, this.Map, 0x222);

                        return TimeSpan.FromSeconds(4.0);
                    }
                case 2:</pre>

## Duplicated Code. Size: 167

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\HireBeggar.cs

<pre>this.Fame = 0;
            this.Karma = 0;

            this.AddItem(new Sandals(Utility.RandomNeutralHue()));

            switch ( Utility.Random(2) )
            {
                case 0:
                    this.AddItem(new Doublet(Utility.RandomNeutralHue()));
                    break;
                case 1:
                    this.AddItem(new Shirt(Utility.RandomNeutralHue()));
                    break;
            }

            this.PackGold(0, 25);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HirePeasant.cs

<pre>this.Fame = 0;
            this.Karma = 0;

            this.AddItem(new Sandals(Utility.RandomNeutralHue()));
            switch ( Utility.Random(2) )
            {
                case 0:
                    this.AddItem(new Doublet(Utility.RandomNeutralHue()));
                    break;
                case 1:
                    this.AddItem(new Shirt(Utility.RandomNeutralHue()));
                    break;
            }

            this.PackGold(0, 25);</pre>

## Duplicated Code. Size: 167

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>break;
                case Aggression.Aggressive:
                    {
                        if (AcquireFocusMob(m_Creature.GetLeashLength(), m_Creature.FightMode, false, false, true))
                        {
                            if (m_Creature.Debug)
                                m_Creature.DebugSay("I have detected {0}, attacking", m_Creature.FocusMob.Name);

                            fighting = true;

                            m_Creature.Combatant = m_Creature.FocusMob;
                            m_Creature.ControlTarget = m_Creature.FocusMob;
                            m_Creature.ControlOrder = OrderType.Attack;
                            Action = ActionType.Combat;
                        }
                        else
                            return base.DoOrderFollow();
                    }
                    break;</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>break;
                case Aggression.Aggressive:
                    {
                        if (AcquireFocusMob(m_Creature.GetLeashLength(), m_Creature.FightMode, false, false, true))
                        {
                            if (m_Creature.Debug)
                                m_Creature.DebugSay("I have detected {0}, attacking", m_Creature.FocusMob.Name);

                            fighting = true;

                            m_Creature.Combatant = m_Creature.FocusMob;
                            m_Creature.ControlTarget = m_Creature.FocusMob;
                            m_Creature.ControlOrder = OrderType.Attack;
                            Action = ActionType.Combat;
                        }
                        else
                            return base.DoOrderFollow();
                    }
                    break;</pre>

## Duplicated Code. Size: 167

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Toolbar\Gumps\Toolbar.cs

<pre>AddButton(
				offset + GumpIDs.Buttons[(int)GumpIDs.ButtonIDs.Minimize].Content[_Info.Skin, 2] + 5,
				y + offset,
				GumpIDs.Buttons[(int)GumpIDs.ButtonIDs.Customize].Content[_Info.Skin, 0],
				GumpIDs.Buttons[(int)GumpIDs.ButtonIDs.Customize].Content[_Info.Skin, 1],
				1,
				GumpButtonType.Reply,
				0); // 1 Edit</pre>

Fragment 2 in file Scripts\Services\Toolbar\Gumps\Toolbar.cs

<pre>AddButton(
				offset + GumpIDs.Buttons[(int)GumpIDs.ButtonIDs.Minimize].Content[_Info.Skin, 2] + 5,
				y + offset,
				GumpIDs.Buttons[(int)GumpIDs.ButtonIDs.Customize].Content[_Info.Skin, 0],
				GumpIDs.Buttons[(int)GumpIDs.ButtonIDs.Customize].Content[_Info.Skin, 1],
				1,
				GumpButtonType.Reply,
				0); // 1 Edit</pre>

## Duplicated Code. Size: 167

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>remainder = "";
			status_str = null;

			if (o == null || keywordargs == null || arglist == null) return false;

			// Use the format /ATTACH,drop_probability/attachmenttype,name[,args]/
			// or /ATTACH,drop_probability/<attachmenttype,name[,args]/propname1/value1/propname2/value2/...>/
			double drop_probability = 1;

			if (keywordargs.Length > 1)
			{
				bool converterror = false;
				try { drop_probability = Convert.ToDouble(keywordargs[1], CultureInfo.InvariantCulture); }
				catch { status_str = "Invalid drop probability : " + arglist[1]; converterror = true; }

				if (converterror) return false;
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>remainder = "";
			status_str = null;

			if (o == null || keywordargs == null || arglist == null) return false;

			// if the object is a mobile then add the item in the next arg to its pack.  Use the format /ADD,drop_probability/itemtype/
			// or /ADD,drop_probability/<itemtype/propname1/value1/propname2/value2/...>/
			double drop_probability = 1;

			if (keywordargs.Length > 1)
			{
				bool converterror = false;
				try { drop_probability = Convert.ToDouble(keywordargs[1], CultureInfo.InvariantCulture); }
				catch { status_str = "Invalid drop probability : " + arglist[1]; converterror = true; }

				if (converterror) return false;
			}</pre>

## Duplicated Code. Size: 167

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>{
					// make sure gold amount is consistent with totalgold
					if (i is Gold)
					{
						UpdateTotal(i, TotalType.Gold, i.Amount);
					}

					if (i is Container)
					{
						CalculateWeight(i);
						weight += i.TotalWeight + (int)i.Weight;
						gold += i.TotalGold;
						nitems += i.TotalItems + 1;
					}
					else
					{
						weight += (int)(i.Weight * i.Amount);
						gold += i.TotalGold;
						nitems += 1;
					}
				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>{
                    // make sure gold amount is consistent with totalgold
                    if (i is Gold)
                    {
                        UpdateTotal(i, TotalType.Gold, i.Amount);
                    }

                    if (i is Container)
                    {
                        CalculateWeight(i);
                        weight += i.TotalWeight + (int)i.Weight;
                        gold += i.TotalGold;
                        nitems += i.TotalItems + 1;
                    }
                    else
                    {
                        weight += (int)(i.Weight * i.Amount);
                        gold += i.TotalGold;
                        nitems += 1;
                    }
                }</pre>

## Duplicated Code. Size: 167

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>if(from == null || target == null) return false;

			// both must be players
			if(!(from.Player && target.Player)) return false;

			// check for points attachments on each
			XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(from, typeof(XmlPoints));

			if(afrom == null || afrom.Deleted)
				return false;

			XmlPoints atarget = (XmlPoints)XmlAttach.FindAttachment(target, typeof(XmlPoints));

			if(atarget == null || atarget.Deleted)
				return false;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>if(from == null || target == null) return false;

			// both must be players
			if(!(from.Player && target.Player)) return false;

			// check for points attachments on each
			XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(from, typeof(XmlPoints));

			if(afrom == null || afrom.Deleted)
				return false;

			XmlPoints atarget = (XmlPoints)XmlAttach.FindAttachment(target, typeof(XmlPoints));

			if(atarget == null || atarget.Deleted)
				return false;</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>if(from == null || target == null) return false;

			// both must be players
			if(!(from.Player && target.Player)) return false;

			// check for points attachments on each
			XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(from, typeof(XmlPoints));

			if(afrom == null || afrom.Deleted)
				return false;

			XmlPoints atarget = (XmlPoints)XmlAttach.FindAttachment(target, typeof(XmlPoints));

			if(atarget == null || atarget.Deleted)
				return false;</pre>

## Duplicated Code. Size: 167

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ExodusMinion.cs

<pre>public override void OnGotMeleeAttack(Mobile attacker)
        {
            base.OnGotMeleeAttack(attacker);

            if (this.m_FieldActive)
            {
                this.FixedParticles(0x376A, 20, 10, 0x2530, EffectLayer.Waist);

                this.PlaySound(0x2F4);

                attacker.SendAsciiMessage("Your weapon cannot penetrate the creature's magical barrier");
            }

            if (attacker != null && attacker.Alive && attacker.Weapon is BaseRanged && 0.4 > Utility.RandomDouble())
            {
                this.SendEBolt(attacker);
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ExodusOverseer.cs

<pre>public override void OnGotMeleeAttack(Mobile attacker)
        {
            base.OnGotMeleeAttack(attacker);

            if (this.m_FieldActive)
            {
                this.FixedParticles(0x376A, 20, 10, 0x2530, EffectLayer.Waist);

                this.PlaySound(0x2F4);

                attacker.SendAsciiMessage("Your weapon cannot penetrate the creature's magical barrier");
            }

            if (attacker != null && attacker.Alive && attacker.Weapon is BaseRanged && 0.4 > Utility.RandomDouble())
            {
                this.SendEBolt(attacker);
            }
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusDrone.cs

<pre>public override void OnGotMeleeAttack(Mobile attacker)
        {
            base.OnGotMeleeAttack(attacker);

            if (this.m_FieldActive)
            {
                this.FixedParticles(0x376A, 20, 10, 0x2530, EffectLayer.Waist);

                this.PlaySound(0x2F4);

                attacker.SendAsciiMessage("Your weapon cannot penetrate the creature's magical barrier");
            }

            if (attacker != null && attacker.Alive && attacker.Weapon is BaseRanged && 0.4 > Utility.RandomDouble())
            {
                this.SendEBolt(attacker);
            }
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusJuggernaut.cs

<pre>public override void OnGotMeleeAttack(Mobile attacker)
        {
            base.OnGotMeleeAttack(attacker);

            if (this.m_FieldActive)
            {
                this.FixedParticles(0x376A, 20, 10, 0x2530, EffectLayer.Waist);

                this.PlaySound(0x2F4);

                attacker.SendAsciiMessage("Your weapon cannot penetrate the creature's magical barrier");
            }

            if (attacker != null && attacker.Alive && attacker.Weapon is BaseRanged && 0.4 > Utility.RandomDouble())
            {
                this.SendEBolt(attacker);
            }
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusMinionLord.cs

<pre>public override void OnGotMeleeAttack(Mobile attacker)
        {
            base.OnGotMeleeAttack(attacker);

            if (this.m_FieldActive)
            {
                this.FixedParticles(0x376A, 20, 10, 0x2530, EffectLayer.Waist);

                this.PlaySound(0x2F4);

                attacker.SendAsciiMessage("Your weapon cannot penetrate the creature's magical barrier");
            }

            if (attacker != null && attacker.Alive && attacker.Weapon is BaseRanged && 0.4 > Utility.RandomDouble())
            {
                this.SendEBolt(attacker);
            }
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusSentinel.cs

<pre>public override void OnGotMeleeAttack(Mobile attacker)
        {
            base.OnGotMeleeAttack(attacker);

            if (this.m_FieldActive)
            {
                this.FixedParticles(0x376A, 20, 10, 0x2530, EffectLayer.Waist);

                this.PlaySound(0x2F4);

                attacker.SendAsciiMessage("Your weapon cannot penetrate the creature's magical barrier");
            }

            if (attacker != null && attacker.Alive && attacker.Weapon is BaseRanged && 0.4 > Utility.RandomDouble())
            {
                this.SendEBolt(attacker);
            }
        }</pre>

## Duplicated Code. Size: 166

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\Abilities.cs

<pre>public static Guild GetGuild(Mobile m)
        {
            Guild guild = m.Guild as Guild;

            if (guild == null && m is BaseCreature)
            {
                BaseCreature bc = (BaseCreature)m;
                m = bc.ControlMaster;

                if (m != null)
                    guild = m.Guild as Guild;

                m = bc.SummonMaster;

                if (m != null && guild == null)
                    guild = m.Guild as Guild;
            }

            return guild;
        }</pre>

Fragment 2 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>public static Guild GetGuild(Mobile m)
        {
            Guild guild = m.Guild as Guild;

            if (guild == null && m is BaseCreature)
            {
                BaseCreature bc = (BaseCreature)m;
                m = bc.ControlMaster;

                if (m != null)
                    guild = m.Guild as Guild;

                m = bc.SummonMaster;

                if (m != null && guild == null)
                    guild = m.Guild as Guild;
            }

            return guild;
        }</pre>

## Duplicated Code. Size: 166

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>int labelNumber = 0;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("LabelNumber"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                            {
                                labelNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                                break;
                            }
                        }
                    }</pre>

Fragment 2 in file Scripts\Commands\Decorate.cs

<pre>int labelNumber = 0;

                    for (int i = 0; i < this.m_Params.Length; ++i)
                    {
                        if (this.m_Params[i].StartsWith("LabelNumber"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                            {
                                labelNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                                break;
                            }
                        }
                    }</pre>

## Duplicated Code. Size: 166

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SoulStone.cs

<pre>this.AddButton(10, 380, 0xFA5, 0xFA6, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 382, 450, 20, 1052072, 0x7FFF, false, false); // Continue

                this.AddButton(10, 410, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 412, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 2 in file Scripts\Items\Consumables\SoulStone.cs

<pre>this.AddButton(10, 380, 0xFA5, 0xFA6, 1, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 382, 450, 20, 1052072, 0x7FFF, false, false); // Continue

                this.AddButton(10, 410, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 412, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

## Duplicated Code. Size: 166

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Housing Lotto\Core\MaginciaLottoSystem.cs

<pre>List<Item> items = new List<Item>();

                Item[] packItems = from.Backpack.FindItemsByType(typeof(WritOfLease));
                Item[] bankItems = from.BankBox.FindItemsByType(typeof(WritOfLease));

                if (packItems != null && packItems.Length > 0)
                    items.AddRange(packItems);

                if (bankItems != null && bankItems.Length > 0)
                    items.AddRange(bankItems);</pre>

Fragment 2 in file Scripts\Services\New Magincia\Housing Lotto\Core\Region.cs

<pre>List<Item> items = new List<Item>();

                Item[] packItems = from.Backpack.FindItemsByType(typeof(WritOfLease));
                Item[] bankItems = from.BankBox.FindItemsByType(typeof(WritOfLease));

                if (packItems != null && packItems.Length > 0)
                    items.AddRange(packItems);

                if (bankItems != null && bankItems.Length > 0)
                    items.AddRange(bankItems);</pre>

## Duplicated Code. Size: 166

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestLeaders.cs

<pre>xf.WriteEndElement();

					xf.WriteStartElement( "Rank" );
					xf.WriteString( a.Rank.ToString() );
					xf.WriteEndElement();

					xf.WriteStartElement( "Change" );
					xf.WriteString( a.DeltaRank.ToString() );
					xf.WriteEndElement();

					xf.WriteStartElement( "Duration" );
					xf.WriteString( timeranked.ToString() );
					xf.WriteEndElement();

					// end the entry
					xf.WriteEndElement();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>xf.WriteEndElement();

					xf.WriteStartElement( "Rank" );
					xf.WriteString( a.Rank.ToString() );
					xf.WriteEndElement();

					xf.WriteStartElement( "Change" );
					xf.WriteString( a.DeltaRank.ToString() );
					xf.WriteEndElement();

					xf.WriteStartElement( "Duration" );
					xf.WriteString( timeranked.ToString() );
					xf.WriteEndElement();

					// end the entry
					xf.WriteEndElement();</pre>

## Duplicated Code. Size: 166

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>{
                        line1.Location = new Point3D(X + 2, Y - 2, Z + ZSurface);
                        line2.Location = new Point3D(X - 2, Y - 2, Z + ZSurface);
                        line3.Location = new Point3D(X + 2, Y + 3, Z + ZSurface);
                        line4.Location = new Point3D(X - 2, Y + 3, Z + ZSurface);
                        break;
                    }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>{
                        line1.Location = new Point3D(X + 2, Y + 2, Z + ZSurface);
                        line2.Location = new Point3D(X - 2, Y + 2, Z + ZSurface);
                        line3.Location = new Point3D(X + 2, Y - 3, Z + ZSurface);
                        line4.Location = new Point3D(X - 2, Y - 3, Z + ZSurface);
                        break;
                    }</pre>

Fragment 3 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>{
                        line1.Location = new Point3D(X - 3, Y - 2, Z + ZSurface);
                        line2.Location = new Point3D(X - 3, Y + 2, Z + ZSurface);
                        line3.Location = new Point3D(X + 2, Y - 2, Z + ZSurface);
                        line4.Location = new Point3D(X + 2, Y + 2, Z + ZSurface);
                        break;
                    }</pre>

Fragment 4 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>{
                        line1.Location = new Point3D(X + 3, Y - 2, Z + ZSurface);
                        line2.Location = new Point3D(X + 3, Y + 2, Z + ZSurface);
                        line3.Location = new Point3D(X - 2, Y - 2, Z + ZSurface);
                        line4.Location = new Point3D(X - 2, Y + 2, Z + ZSurface);
                        break;
                    }</pre>

## Duplicated Code. Size: 166

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\HuntmasterChallenge\ComplexHuntTrophy.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int v = reader.ReadInt();

            m_Owner = reader.ReadString();
            m_Measurement = reader.ReadInt();
            m_DateKilled = reader.ReadString();
            m_Location = reader.ReadString();
            m_Species = TextDefinition.Deserialize(reader);
            m_MeasuredBy = (MeasuredBy)reader.ReadInt();
            m_SouthID = reader.ReadInt();
        }</pre>

Fragment 2 in file Scripts\Services\HuntmasterChallenge\ComplexHuntTrophy.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int v = reader.ReadInt();

            m_Owner = reader.ReadString();
            m_Measurement = reader.ReadInt();
            m_DateKilled = reader.ReadString();
            m_Location = reader.ReadString();
            m_Species = TextDefinition.Deserialize(reader);
            m_MeasuredBy = (MeasuredBy)reader.ReadInt();
            m_SouthID = reader.ReadInt();
        }</pre>

Fragment 3 in file Scripts\Services\HuntmasterChallenge\HuntTrophy.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);
			int v = reader.ReadInt();

			m_Owner = reader.ReadString();
			m_Measurement = reader.ReadInt();
			m_DateKilled = reader.ReadString();
			m_Location = reader.ReadString();
			m_Species = TextDefinition.Deserialize(reader);
			m_MeasuredBy = (MeasuredBy)reader.ReadInt();
            m_SouthID = reader.ReadInt();
		}</pre>

Fragment 4 in file Scripts\Services\HuntmasterChallenge\HuntTrophy.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int v = reader.ReadInt();

            m_Owner = reader.ReadString();
            m_Measurement = reader.ReadInt();
            m_DateKilled = reader.ReadString();
            m_Location = reader.ReadString();
            m_Species = TextDefinition.Deserialize(reader);
            m_MeasuredBy = (MeasuredBy)reader.ReadInt();
            m_SouthID = reader.ReadInt();
        }</pre>

## Duplicated Code. Size: 165

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GargishOutcast.cs

<pre>SetDamage(15, 19);

            if (Utility.RandomBool())
            {
                Name = NameList.RandomName("Gargoyle Male");
                Female = false;
                Body = 666;
            }
            else
            {
                Name = NameList.RandomName("Gargoyle Female");
                Female = true;
                Body = 667;
            }

            Utility.AssignRandomHair(this, true);
            if (!Female)
                Utility.AssignRandomFacialHair(this, true);

            this.Hue = Race.RandomSkinHue();</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GargishRouser.cs

<pre>SetDamage(15, 19);

			if(Utility.RandomBool())
			{
				Name = NameList.RandomName("Gargoyle Male");
				Female = false;
				Body = 666;
			}
			else
			{
				Name = NameList.RandomName("Gargoyle Female");
				Female = true;
				Body = 667;
			}

			Utility.AssignRandomHair(this, true);
			if(!Female)
				Utility.AssignRandomFacialHair(this, true);

            this.Hue = Race.RandomSkinHue();</pre>

## Duplicated Code. Size: 165

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write((0x7FFFFFFF - i));
					m_Stream.Write((ushort)0);
					m_Stream.Write((byte)0);
					m_Stream.Write((ushort)(i + offset));
					m_Stream.Write((short)0);
					m_Stream.Write((short)0);
					m_Stream.Write(item.Serial);
					m_Stream.Write((short)0);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write((0x7FFFFFFF - i));
					m_Stream.Write((ushort)0);
					m_Stream.Write((byte)0);
					m_Stream.Write((ushort)(i + offset));
					m_Stream.Write((short)0);
					m_Stream.Write((short)0);
					m_Stream.Write((byte)0); // Grid Location?
					m_Stream.Write(item.Serial);</pre>

## Duplicated Code. Size: 165

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Implementors\ContainedCommandImplementor.cs

<pre>public override void Process(Mobile from, BaseCommand command, string[] args)
        {
            if (command.ValidateArgs(this, new CommandEventArgs(from, command.Commands[0], this.GenerateArgString(args), args)))
                from.BeginTarget(-1, command.ObjectTypes == ObjectTypes.All, TargetFlags.None, new TargetStateCallback(OnTarget), new object[] { command, args });
        }</pre>

Fragment 2 in file Scripts\Commands\Generic\Implementors\MultiCommandImplementor.cs

<pre>public override void Process(Mobile from, BaseCommand command, string[] args)
        {
            if (command.ValidateArgs(this, new CommandEventArgs(from, command.Commands[0], this.GenerateArgString(args), args)))
                from.BeginTarget(-1, command.ObjectTypes == ObjectTypes.All, TargetFlags.None, new TargetStateCallback(OnTarget), new object[] { command, args });
        }</pre>

Fragment 3 in file Scripts\Commands\Generic\Implementors\SingleCommandImplementor.cs

<pre>public override void Process(Mobile from, BaseCommand command, string[] args)
        {
            if (command.ValidateArgs(this, new CommandEventArgs(from, command.Commands[0], this.GenerateArgString(args), args)))
                from.BeginTarget(-1, command.ObjectTypes == ObjectTypes.All, TargetFlags.None, new TargetStateCallback(OnTarget), new object[] { command, args });
        }</pre>

## Duplicated Code. Size: 165

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlFire.cs

<pre>public override void OnMovement(MovementEventArgs e )
		{
			base.OnMovement(e);

			if(e.Mobile == null || e.Mobile.AccessLevel > AccessLevel.Player) return;

			if(AttachedTo is Item && (((Item)AttachedTo).Parent == null) && Utility.InRange( e.Mobile.Location, ((Item)AttachedTo).Location, proximityrange ))
			{
				OnTrigger(null, e.Mobile);
			} 
			else
				return;
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlLifeDrain.cs

<pre>public override void OnMovement(MovementEventArgs e )
		{
			base.OnMovement(e);

			if(e.Mobile == null || e.Mobile.AccessLevel > AccessLevel.Player) return;

			if(AttachedTo is Item && (((Item)AttachedTo).Parent == null) && Utility.InRange( e.Mobile.Location, ((Item)AttachedTo).Location, proximityrange ))
			{
				OnTrigger(null, e.Mobile);
			} 
			else
				return;
		}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlLightning.cs

<pre>public override void OnMovement(MovementEventArgs e )
		{
			base.OnMovement(e);

			if(e.Mobile == null || e.Mobile.AccessLevel > AccessLevel.Player) return;

			if(AttachedTo is Item && (((Item)AttachedTo).Parent == null) && Utility.InRange( e.Mobile.Location, ((Item)AttachedTo).Location, proximityrange ))
			{
				OnTrigger(null, e.Mobile);
			} 
			else
				return;
		}</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlManaDrain.cs

<pre>public override void OnMovement(MovementEventArgs e )
		{
			base.OnMovement(e);

			if(e.Mobile == null || e.Mobile.AccessLevel > AccessLevel.Player) return;

			if(AttachedTo is Item && (((Item)AttachedTo).Parent == null) && Utility.InRange( e.Mobile.Location, ((Item)AttachedTo).Location, proximityrange ))
			{
				OnTrigger(null, e.Mobile);
			} 
			else
				return;
		}</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlMorph.cs

<pre>public override void OnMovement(MovementEventArgs e )
		{
			base.OnMovement(e);

			if(e.Mobile == null || e.Mobile.AccessLevel > AccessLevel.Player) return;

			if(AttachedTo is Item && (((Item)AttachedTo).Parent == null) && Utility.InRange( e.Mobile.Location, ((Item)AttachedTo).Location, proximityrange ))
			{
				OnTrigger(null, e.Mobile);
			} 
			else
				return;
		}</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlSound.cs

<pre>public override void OnMovement(MovementEventArgs e )
		{
			base.OnMovement(e);

			if(e.Mobile == null || e.Mobile.AccessLevel > AccessLevel.Player) return;

			if(AttachedTo is Item && (((Item)AttachedTo).Parent == null) && Utility.InRange( e.Mobile.Location, ((Item)AttachedTo).Location, proximityrange ))
			{
				OnTrigger(null, e.Mobile);
			} 
			else
				return;
		}</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlStamDrain.cs

<pre>public override void OnMovement(MovementEventArgs e )
		{
			base.OnMovement(e);

			if(e.Mobile == null || e.Mobile.AccessLevel > AccessLevel.Player) return;

			if(AttachedTo is Item && (((Item)AttachedTo).Parent == null) && Utility.InRange( e.Mobile.Location, ((Item)AttachedTo).Location, proximityrange ))
			{
				OnTrigger(null, e.Mobile);
			} 
			else
				return;
		}</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>public int ID
        {
            get
            {
                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("ID"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            return Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                }

                return 0;
            }
        }</pre>

Fragment 2 in file Scripts\Commands\DecorateDelete.cs

<pre>public int ID
        {
            get
            {
                for (int i = 0; i < this.m_Params.Length; ++i)
                {
                    if (this.m_Params[i].StartsWith("ID"))
                    {
                        int indexOf = this.m_Params[i].IndexOf('=');

                        if (indexOf >= 0)
                            return Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                    }
                }

                return 0;
            }
        }</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\HitchingPost.cs

<pre>public bool CheckAccess(Mobile m)
        {
            if (!this.IsLockedDown || m.AccessLevel >= AccessLevel.GameMaster)
                return true;

            BaseHouse house = BaseHouse.FindHouseAt(this);

            if (house != null && house.IsAosRules && (house.Public ? house.IsBanned(m) : !house.HasAccess(m)))
                return false;

            return (house != null && house.HasSecureAccess(m, this.m_Level));
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Spellbooks\Runebook.cs

<pre>public bool CheckAccess(Mobile m)
        {
            if (!this.IsLockedDown || m.AccessLevel >= AccessLevel.GameMaster)
                return true;

            BaseHouse house = BaseHouse.FindHouseAt(this);

            if (house != null && house.IsAosRules && (house.Public ? house.IsBanned(m) : !house.HasAccess(m)))
                return false;

            return (house != null && house.HasSecureAccess(m, this.m_Level));
        }</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\SpinningwheelEastAddon.cs

<pre>public void EndSpin(SpinCallback callback, Mobile from, int hue)
        {
            if (this.m_Timer != null)
                this.m_Timer.Stop();

            this.m_Timer = null;

            foreach (AddonComponent c in this.Components)
            {
                switch ( c.ItemID )
                {
                    case 0x1016:
                    case 0x101A:
                    case 0x101D:
                    case 0x10A5:
                        --c.ItemID;
                        break;
                }
            }

            if (callback != null)
                callback(this, from, hue);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\SpinningwheelSouthAddon.cs

<pre>public void EndSpin(SpinCallback callback, Mobile from, int hue)
        {
            if (this.m_Timer != null)
                this.m_Timer.Stop();

            this.m_Timer = null;

            foreach (AddonComponent c in this.Components)
            {
                switch ( c.ItemID )
                {
                    case 0x1016:
                    case 0x101A:
                    case 0x101D:
                    case 0x10A5:
                        --c.ItemID;
                        break;
                }
            }

            if (callback != null)
                callback(this, from, hue);
        }</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Scout\ScoutFemaleChest.cs

<pre>this.Attributes.BonusDex = 1;
            this.ArmorAttributes.MageArmor = 1;

            this.SetAttributes.BonusDex = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 0x46D;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Scout\ScoutSmallPlateJingasa.cs

<pre>this.Attributes.BonusDex = 1;
            this.ArmorAttributes.MageArmor = 1;

            this.SetAttributes.BonusDex = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 0x46D;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\Notoriety.cs

<pre>PlayerMobile pmFrom = from as PlayerMobile;
            PlayerMobile pmTarg = target as PlayerMobile;

            if (pmFrom == null && from is BaseCreature)
            {
                BaseCreature bcFrom = (BaseCreature)from;

                if (bcFrom.Summoned)
                    pmFrom = bcFrom.SummonMaster as PlayerMobile;
            }

            if (pmTarg == null && target is BaseCreature)
            {
                BaseCreature bcTarg = (BaseCreature)target;

                if (bcTarg.Summoned)
                    pmTarg = bcTarg.SummonMaster as PlayerMobile;
            }</pre>

Fragment 2 in file Scripts\Misc\Notoriety.cs

<pre>PlayerMobile pmFrom = from as PlayerMobile;
            PlayerMobile pmTarg = target as PlayerMobile;

            if (pmFrom == null && from is BaseCreature)
            {
                BaseCreature bcFrom = (BaseCreature)from;

                if (bcFrom.Summoned)
                    pmFrom = bcFrom.SummonMaster as PlayerMobile;
            }

            if (pmTarg == null &&amamp; target is BaseCreature)
            {
                BaseCreature bcTarg = (BaseCreature)target;

                if (bcTarg.Summoned)
                    pmTarg = bcTarg.SummonMaster as PlayerMobile;
            }</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GrayGoblin.cs

<pre>this.SetDamage(5, 7);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 40, 50);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 25, 32);
            this.SetResistance(ResistanceType.Poison, 10, 19);
            this.SetResistance(ResistanceType.Energy, 10, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GrayGoblinMage.cs

<pre>this.SetDamage(5, 7);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 40, 50);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 25, 32);
            this.SetResistance(ResistanceType.Poison, 10, 19);
            this.SetResistance(ResistanceType.Energy, 10, 20);</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Minotaur.cs

<pre>this.SetDamage(11, 20);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 55, 65);
            this.SetResistance(ResistanceType.Fire, 25, 35);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\MinotaurScout.cs

<pre>this.SetDamage(11, 20);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 55, 65);
            this.SetResistance(ResistanceType.Fire, 25, 35);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\SAPixie.cs

<pre>this.SetDamage(9, 15);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 80, 90);
            this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

Fragment 2 in file Scripts\Spells\Spellweaving\Mobiles\ArcaneFey.cs

<pre>this.SetDamage(9, 15);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 80, 90);
            this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\YomotsuPriest.cs

<pre>this.SetDamage(8, 10);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 65, 85);
            this.SetResistance(ResistanceType.Fire, 30, 50);
            this.SetResistance(ResistanceType.Cold, 45, 65);
            this.SetResistance(ResistanceType.Poison, 35, 55);
            this.SetResistance(ResistanceType.Energy, 25, 50);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\YomotsuWarrior.cs

<pre>this.SetDamage(8, 10);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 65, 85);
            this.SetResistance(ResistanceType.Fire, 30, 50);
            this.SetResistance(ResistanceType.Cold, 45, 65);
            this.SetResistance(ResistanceType.Poison, 35, 55);
            this.SetResistance(ResistanceType.Energy, 25, 50);</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\PlayerMobile.cs

<pre>List<BaseHealer> listHealers = new List<BaseHealer>();
                    List<MondainQuester> listQuesters = new List<MondainQuester>();
                    foreach (Mobile m_mobile in World.Mobiles.Values)
                    {
                        MondainQuester mQuester = m_mobile as MondainQuester;
                        if (mQuester != null)
                            listQuesters.Add(mQuester);

                        BaseHealer mHealer = m_mobile as BaseHealer;
                        if (mHealer != null)
                            listHealers.Add(mHealer);
                    }</pre>

Fragment 2 in file Scripts\Mobiles\PlayerMobile.cs

<pre>List<BaseHealer> listHealers = new List<BaseHealer>();
                List<MondainQuester> listQuesters = new List<MondainQuester>();

                foreach (Mobile m_mobile in World.Mobiles.Values)
                {
                    MondainQuester mQuester = m_mobile as MondainQuester;
                    if (mQuester != null)
                        listQuesters.Add(mQuester);

                    BaseHealer mHealer = m_mobile as BaseHealer;
                    if (mHealer != null)
                        listHealers.Add(mHealer);
                }</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Sorcerers\SorcererArms.cs

<pre>this.Attributes.BonusInt = 1;
            this.Attributes.LowerRegCost = 10;

            this.SetAttributes.BonusInt = 6;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.DefendChance = 10;
            this.SetAttributes.LowerManaCost = 5;
            this.SetAttributes.LowerRegCost = 40;

            this.SetHue = 1165;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Sorcerers\SorcererChest.cs

<pre>this.Attributes.BonusInt = 1;
			this.Attributes.LowerRegCost = 10;

            this.SetAttributes.BonusInt = 6;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.DefendChance = 10;
            this.SetAttributes.LowerManaCost = 5;
            this.SetAttributes.LowerRegCost = 40;

            this.SetHue = 1165;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Sorcerers\SorcererLegs.cs

<pre>this.Attributes.BonusInt = 1;
            this.Attributes.LowerRegCost = 10;

            this.SetAttributes.BonusInt = 6;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.DefendChance = 10;
            this.SetAttributes.LowerManaCost = 5;
            this.SetAttributes.LowerRegCost = 40;

            this.SetHue = 1165;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Scout\ScoutArms.cs

<pre>this.Attributes.BonusDex = 1;
			this.ArmorAttributes.MageArmor = 1;

			this.SetAttributes.BonusDex = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1148;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Scout\ScoutChest.cs

<pre>this.Attributes.BonusDex = 1;
            this.ArmorAttributes.MageArmor = 1;

            this.SetAttributes.BonusDex = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1148;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Scout\ScoutCirclet.cs

<pre>this.Attributes.BonusDex = 1;
            this.ArmorAttributes.MageArmor = 1;

            this.SetAttributes.BonusDex = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1148;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Scout\ScoutLegs.cs

<pre>this.Attributes.BonusDex = 1;
            this.ArmorAttributes.MageArmor = 1;

            this.SetAttributes.BonusDex = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1148;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Paladin\PaladinArms.cs

<pre>{
            this.SetHue = 0x47E;			

            this.Attributes.RegenHits = 1;
            this.Attributes.AttackChance = 5;

            this.SetAttributes.ReflectPhysical = 25;
            this.SetAttributes.NightSight = 1;

            this.SetSkillBonuses.SetValues(0, SkillName.Chivalry, 10);

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 2;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Paladin\PaladinChest.cs

<pre>{
            this.SetHue = 0x47E;				

            this.Attributes.RegenHits = 1;
            this.Attributes.AttackChance = 5;

            this.SetAttributes.ReflectPhysical = 25;
            this.SetAttributes.NightSight = 1;

            this.SetSkillBonuses.SetValues(0, SkillName.Chivalry, 10);

            this.SetSelfRepair = 3;			
            this.SetPhysicalBonus = 2;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Paladin\PaladinGloves.cs

<pre>{
            this.SetHue = 0x47E;				

            this.Attributes.RegenHits = 1;
            this.Attributes.AttackChance = 5;

            this.SetAttributes.ReflectPhysical = 25;
            this.SetAttributes.NightSight = 1;

            this.SetSkillBonuses.SetValues(0, SkillName.Chivalry, 10);

            this.SetSelfRepair = 3;			
            this.SetPhysicalBonus = 2;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Paladin\PaladinGorget.cs

<pre>{
            this.SetHue = 0x47E;				

            this.Attributes.RegenHits = 1;
            this.Attributes.AttackChance = 5;

            this.SetAttributes.ReflectPhysical = 25;
            this.SetAttributes.NightSight = 1;

            this.SetSkillBonuses.SetValues(0, SkillName.Chivalry, 10);

            this.SetSelfRepair = 3;			
            this.SetPhysicalBonus = 2;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Paladin\PaladinHelm.cs

<pre>{
            this.SetHue = 0x47E;					

            this.Attributes.RegenHits = 1;
            this.Attributes.AttackChance = 5;

            this.SetAttributes.ReflectPhysical = 25;
            this.SetAttributes.NightSight = 1;

            this.SetSkillBonuses.SetValues(0, SkillName.Chivalry, 10);

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 2;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 6 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Paladin\PaladinLegs.cs

<pre>{
            this.SetHue = 0x47E;			

            this.Attributes.RegenHits = 1;
            this.Attributes.AttackChance = 5;

            this.SetAttributes.ReflectPhysical = 25;
            this.SetAttributes.NightSight = 1;

            this.SetSkillBonuses.SetValues(0, SkillName.Chivalry, 10);

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 2;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

## Duplicated Code. Size: 164

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>{
							if (entry != null)
							{
								Mobile m = entry.Participant;

								if (m == null) continue;

								// try to collect any entry fee
								if (!m_gauntlet.CollectEntryFee(m, m_gauntlet.EntryFee))
									continue;

								// set up the challenge on each player
								XmlPoints a = (XmlPoints)XmlAttach.FindAttachment(m, typeof(XmlPoints));
								if (a != null)
								{
									a.ChallengeGame = m_gauntlet;
								}

								entry.Status = ChallengeStatus.Active;

								m_gauntlet.Participants.Add(entry);

							}
						}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>{
                            if(entry != null)
                            {
                                Mobile m = entry.Participant;

                                if(m == null) continue;

                                // try to collect any entry fee
                                if(!m_gauntlet.CollectEntryFee(m, m_gauntlet.EntryFee))
                                    continue;

                                // set up the challenge on each player
                                XmlPoints a = (XmlPoints)XmlAttach.FindAttachment(m, typeof(XmlPoints));
                                if(a != null)
                                {
                                    a.ChallengeGame = m_gauntlet;
                                }

                                entry.Status = ChallengeStatus.Active;

                                m_gauntlet.Participants.Add(entry);

                            }
                        }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>{
                            if(entry != null)
                            {
                                Mobile m = entry.Participant;

                                if(m == null) continue;

                                // try to collect any entry fee
                                if(!m_gauntlet.CollectEntryFee(m, m_gauntlet.EntryFee))
                                    continue;

                                // set up the challenge on each player
                                XmlPoints a = (XmlPoints)XmlAttach.FindAttachment(m, typeof(XmlPoints));
                                if(a != null)
                                {
                                    a.ChallengeGame = m_gauntlet;
                                }

                                entry.Status = ChallengeStatus.Active;

                                m_gauntlet.Participants.Add(entry);

                            }
                        }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>{
                            if(entry != null)
                            {
                                Mobile m = entry.Participant;

                                if(m == null) continue;

                                // try to collect any entry fee
                                if(!m_gauntlet.CollectEntryFee(m, m_gauntlet.EntryFee))
                                    continue;

                                // set up the challenge on each player
                                XmlPoints a = (XmlPoints)XmlAttach.FindAttachment(m, typeof(XmlPoints));
                                if(a != null)
                                {
                                    a.ChallengeGame = m_gauntlet;
                                }

                                entry.Status = ChallengeStatus.Active;

                                m_gauntlet.Participants.Add(entry);

                            }
                        }</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>{
                            if(entry != null)
                            {
                                Mobile m = entry.Participant;

                                if(m == null) continue;

                                // try to collect any entry fee
                                if(!m_gauntlet.CollectEntryFee(m, m_gauntlet.EntryFee))
                                    continue;

                                // set up the challenge on each player
                                XmlPoints a = (XmlPoints)XmlAttach.FindAttachment(m, typeof(XmlPoints));
                                if(a != null)
                                {
                                    a.ChallengeGame = m_gauntlet;
                                }

                                entry.Status = ChallengeStatus.Active;

                                m_gauntlet.Participants.Add(entry);

                            }
                        }</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>{
                            if(entry != null)
                            {
                                Mobile m = entry.Participant;

                                if(m == null) continue;

                                // try to collect any entry fee
                                if(!m_gauntlet.CollectEntryFee(m, m_gauntlet.EntryFee))
                                    continue;

                                // set up the challenge on each player
                                XmlPoints a = (XmlPoints)XmlAttach.FindAttachment(m, typeof(XmlPoints));
                                if(a != null)
                                {
                                    a.ChallengeGame = m_gauntlet;
                                }

                                entry.Status = ChallengeStatus.Active;

                                m_gauntlet.Participants.Add(entry);

                            }
                        }</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>{
                            if(entry != null)
                            {
                                Mobile m = entry.Participant;

                                if(m == null) continue;

                                // try to collect any entry fee
                                if(!m_gauntlet.CollectEntryFee(m, m_gauntlet.EntryFee))
                                    continue;

                                // set up the challenge on each player
                                XmlPoints a = (XmlPoints)XmlAttach.FindAttachment(m, typeof(XmlPoints));
                                if(a != null)
                                {
                                    a.ChallengeGame = m_gauntlet;
                                }

                                entry.Status = ChallengeStatus.Active;

                                m_gauntlet.Participants.Add(entry);

                            }
                        }</pre>

Fragment 8 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>{
                            if(entry != null)
                            {
                                Mobile m = entry.Participant;

                                if(m == null) continue;

                                // try to collect any entry fee
                                if(!m_gauntlet.CollectEntryFee(m, m_gauntlet.EntryFee))
                                    continue;

                                // set up the challenge on each player
                                XmlPoints a = (XmlPoints)XmlAttach.FindAttachment(m, typeof(XmlPoints));
                                if(a != null)
                                {
                                    a.ChallengeGame = m_gauntlet;
                                }

                                entry.Status = ChallengeStatus.Active;

                                m_gauntlet.Participants.Add(entry);

                            }
                        }</pre>

Fragment 9 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>{
                            if(entry != null)
                            {
                                Mobile m = entry.Participant;

                                if(m == null) continue;

                                // try to collect any entry fee
                                if(!m_gauntlet.CollectEntryFee(m, m_gauntlet.EntryFee))
                                    continue;

                                // set up the challenge on each player
                                XmlPoints a = (XmlPoints)XmlAttach.FindAttachment(m, typeof(XmlPoints));
                                if(a != null)
                                {
                                    a.ChallengeGame = m_gauntlet;
                                }

                                entry.Status = ChallengeStatus.Active;

                                m_gauntlet.Participants.Add(entry);

                            }
                        }</pre>

## Duplicated Code. Size: 163

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\TitlesMenu.cs

<pre>AddHtmlLocalized(225, 220, 160, 16, 1115027, 0xFFFF, false, false); // Paperdoll Name (Suffix)
                    AddHtml(275, 240, 245, 16, Color("#FFFFFF", str), false, false);

                    AddHtmlLocalized(225, 275, 200, 16, 1115035, 0xFFFF, false, false); // Do you wish to apply this title?

                    AddHtmlLocalized(480, 275, 80, 16, 1011046, 0xFFFF, false, false); // APPLY</pre>

Fragment 2 in file Scripts\Gumps\TitlesMenu.cs

<pre>AddHtmlLocalized(225, 220, 160, 16, 1115027, 0xFFFF, false, false); // Paperdoll Name (Suffix)
                    AddHtml(275, 240, 245, 16, Color("#FFFFFF", str), false, false);

                    AddHtmlLocalized(225, 275, 200, 16, 1115035, 0xFFFF, false, false); // Do you wish to apply this title?

                    AddHtmlLocalized(480, 275, 80, 16, 1011046, 0xFFFF, false, false); // APPLY</pre>

## Duplicated Code. Size: 163

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseAxe.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 2:
                    {
                        this.m_ShowUsesRemaining = reader.ReadBool();
                        goto case 1;
                    }
                case 1:
                    {
                        this.m_UsesRemaining = reader.ReadInt();
                        goto case 0;
                    }
                case 0:
                    {
                        if (this.m_UsesRemaining < 1)
                            this.m_UsesRemaining = 150;

                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BasePoleArm.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 2:
                    {
                        this.m_ShowUsesRemaining = reader.ReadBool();
                        goto case 1;
                    }
                case 1:
                    {
                        this.m_UsesRemaining = reader.ReadInt();
                        goto case 0;
                    }
                case 0:
                    {
                        if (this.m_UsesRemaining < 1)
                            this.m_UsesRemaining = 150;

                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 163

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\AcidElemental.cs

<pre>this.SetDamageType(ResistanceType.Physical, 10);
            this.SetDamageType(ResistanceType.Poison, 90);

            this.SetResistance(ResistanceType.Physical, 60, 70);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\PoisonElemental.cs

<pre>this.SetDamageType(ResistanceType.Physical, 10);
            this.SetDamageType(ResistanceType.Poison, 90);

            this.SetResistance(ResistanceType.Physical, 60, 70);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

## Duplicated Code. Size: 163

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Kepetch.cs

<pre>public void Carve(Mobile from, Item item)
        {
            if (!GatheredFur)
            {
                var fur = new KepetchFur(30);

                if (from.Backpack == null || !from.Backpack.TryDropItem(from, fur, false))
                {
                    from.SendLocalizedMessage(1112359); // You would not be able to place the gathered kepetch fur in your backpack!
                    fur.Delete();
                }
                else
                {
                    from.SendLocalizedMessage(1112360); // You place the gathered kepetch fur into your backpack.
                    GatheredFur = true;
                }
            }
            else
                from.SendLocalizedMessage(1112358); // The Kepetch nimbly escapes your attempts to shear its mane.
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\KepetchAmbusher.cs

<pre>public void Carve(Mobile from, Item item)
        {
            if (!GatheredFur)
            {
                var fur = new KepetchFur(30);

                if (from.Backpack == null || !from.Backpack.TryDropItem(from, fur, false))
                {
                    from.SendLocalizedMessage(1112359); // You would not be able to place the gathered kepetch fur in your backpack!
                    fur.Delete();
                }
                else
                {
                    from.SendLocalizedMessage(1112360); // You place the gathered kepetch fur into your backpack.
                    GatheredFur = true;
                }
            }
            else
                from.SendLocalizedMessage(1112358); // The Kepetch nimbly escapes your attempts to shear its mane.
        }</pre>

## Duplicated Code. Size: 163

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\AttendantGuide.cs

<pre>int parent = (child - 1) / 2;
                T temp;

                while (item.CompareTo(this.m_List[parent]) < 0 && child > 0)
                {
                    temp = this.m_List[child];
                    this.m_List[child] = this.m_List[parent];
                    this.m_List[parent] = temp;

                    child = parent;
                    parent = (child - 1) / 2;
                }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\AttendantGuide.cs

<pre>int parent = (child - 1) / 2;
                T temp;

                while (item.CompareTo(this.m_List[parent]) < 0 && child > 0)
                {
                    temp = this.m_List[child];
                    this.m_List[child] = this.m_List[parent];
                    this.m_List[parent] = temp;

                    child = parent;
                    parent = (child - 1) / 2;
                }</pre>

## Duplicated Code. Size: 163

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\SmallSmithBOD.cs

<pre>break;
                            case BulkMaterialType.Bronze:
                                skillReq = 80.0;
                                break;
                            case BulkMaterialType.Gold:
                                skillReq = 85.0;
                                break;
                            case BulkMaterialType.Agapite:
                                skillReq = 90.0;
                                break;
                            case BulkMaterialType.Verite:
                                skillReq = 95.0;
                                break;
                            case BulkMaterialType.Valorite:
                                skillReq = 100.0;
                                break;
                            case BulkMaterialType.Spined:
                                skillReq = 65.0;
                                break;
                            case BulkMaterialType.Horned:
                                skillReq = 80.0;
                                break;
                            case BulkMaterialType.Barbed:
                                skillReq = 99.0;
                                break;</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallTailorBOD.cs

<pre>break;
                            case BulkMaterialType.Bronze:
                                skillReq = 80.0;
                                break;
                            case BulkMaterialType.Gold:
                                skillReq = 85.0;
                                break;
                            case BulkMaterialType.Agapite:
                                skillReq = 90.0;
                                break;
                            case BulkMaterialType.Verite:
                                skillReq = 95.0;
                                break;
                            case BulkMaterialType.Valorite:
                                skillReq = 100.0;
                                break;
                            case BulkMaterialType.Spined:
                                skillReq = 65.0;
                                break;
                            case BulkMaterialType.Horned:
                                skillReq = 80.0;
                                break;
                            case BulkMaterialType.Barbed:
                                skillReq = 99.0;
                                break;</pre>

## Duplicated Code. Size: 163

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Spawners\BountyQuestSpawner.cs

<pre>for(int i = 0; i < 25; i++)
                {
                    int x = Utility.Random(rec.X, rec.Width);
                    int y = Utility.Random(rec.Y, rec.Height);
                    p = new Point3D(x, y, -5);

                    if (gal.CanFit(p, map, gal.ItemID))
                    {
                        spawned = true;
                        break;
                    }
                }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Spawners\BountyQuestSpawner.cs

<pre>for(int i = 0; i < 25; i++)
                {
                    int x = Utility.Random(rec.X, rec.Width);
                    int y = Utility.Random(rec.Y, rec.Height);
                    p = new Point3D(x, y, -5);

                    if (gal.CanFit(p, map, gal.ItemID))
                    {
                        spawned = true;
                        break;
                    }
                }</pre>

## Duplicated Code. Size: 163

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseEscortable.cs

<pre>switch ( Utility.Random( 4 ) )
			{
				case 0: AddItem( new ShortHair( Utility.RandomHairHue() ) ); break;
				case 1: AddItem( new TwoPigTails( Utility.RandomHairHue() ) ); break;
				case 2: AddItem( new ReceedingHair( Utility.RandomHairHue() ) ); break;
				case 3: AddItem( new KrisnaHair( Utility.RandomHairHue() ) ); break;
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingSeekerOfAdventure.cs

<pre>switch ( Utility.Random( 4 ) )
			{
				case 0: AddItem( new ShortHair( Utility.RandomHairHue() ) ); break;
				case 1: AddItem( new TwoPigTails( Utility.RandomHairHue() ) ); break;
				case 2: AddItem( new ReceedingHair( Utility.RandomHairHue() ) ); break;
				case 3: AddItem( new KrisnaHair( Utility.RandomHairHue() ) ); break;
			}</pre>

## Duplicated Code. Size: 163

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>string factionname = null;

					if(r.Killer is PlayerMobile && ((PlayerMobile)r.Killer).FactionPlayerState != null) 
						factionname = ((PlayerMobile)r.Killer).FactionPlayerState.Faction.ToString();
#endif
					// check for any ranking change and update rank date
					if(r.Rank != a.Rank)
					{
						a.WhenRanked = DateTime.UtcNow;
						if(a.Rank > 0)
							a.DeltaRank = a.Rank - r.Rank;
						a.Rank = r.Rank;

					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>string factionname = null;

					if(r.Killer is PlayerMobile && ((PlayerMobile)r.Killer).FactionPlayerState != null) 
						factionname = ((PlayerMobile)r.Killer).FactionPlayerState.Faction.ToString();
#endif
					// check for any ranking change and update rank date
					if(r.Rank != a.Rank)
					{
						a.WhenRanked = DateTime.UtcNow;
						if(a.Rank > 0)
							a.DeltaRank = a.Rank - r.Rank;
						a.Rank = r.Rank;

					}</pre>

## Duplicated Code. Size: 163

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGauntlet.cs

<pre>if(from == null || target == null) return false;

            int frommember = 0;
            int targetmember = 0;

            // go through each teams members list and determine whether the players are on any team list
            if(Participants != null)
            {
                foreach(IChallengeEntry entry in Participants)
                {
                    if(!(entry.Status == ChallengeStatus.Active)) continue;

                    Mobile m = entry.Participant;

                    if(m == from)
                    {
                        frommember = entry.Team;
                    }
                    if(m == target)
                    {
                        targetmember = entry.Team;
                    }
                }
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGauntlet.cs

<pre>if(from == null || target == null) return false;

            int frommember = 0;
            int targetmember = 0;

            // go through each teams members list and determine whether the players are on any team list
            if(Participants != null)
            {
                foreach(IChallengeEntry entry in Participants)
                {
                    if(!(entry.Status == ChallengeStatus.Active)) continue;

                    Mobile m = entry.Participant;

                    if(m == from)
                    {
                        frommember = entry.Team;
                    }
                    if(m == target)
                    {
                        targetmember = entry.Team;
                    }
                }
            }</pre>

## Duplicated Code. Size: 163

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\Rampage.cs

<pre>BuffInfo.AddBuff(Caster, new BuffInfo(BuffIcon.Rampage, 1155929, 1155893, TimeSpan.FromSeconds(60), Caster,
                String.Format("{0}\t{1}\t{1}\t{1}\t{2}\t{3}\t{4}\t{5}",
                (1 + GetMasteryLevel()).ToString(),
                GetMasteryLevel().ToString(),
                c.HitsRegen.ToString(),
                c.StamRegen.ToString(),
                c.SwingSpeed.ToString(),
                c.Focus.ToString()
                )));</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\Rampage.cs

<pre>BuffInfo.AddBuff(Caster, new BuffInfo(BuffIcon.Rampage, 1155929, 1155893, TimeSpan.FromSeconds(60), Caster,
                    String.Format("{0}\t{1}\t{1}\t{1}\t{2}\t{3}\t{4}\t{5}",
                    (1 + GetMasteryLevel()).ToString(),
                    GetMasteryLevel().ToString(),
                    c.HitsRegen.ToString(),
                    c.StamRegen.ToString(),
                    c.SwingSpeed.ToString(),
                    c.Focus.ToString()
                    )));</pre>

## Duplicated Code. Size: 163

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\HighPlainsBoura.cs

<pre>public void Carve(Mobile from, Item item)
        {
            if (!GatheredFur)
            {
                var fur = new BouraFur(30);

                if (from.Backpack == null || !from.Backpack.TryDropItem(from, fur, false))
                {
                    from.SendLocalizedMessage(1112352); // You would not be able to place the gathered boura fur in your backpack!
                    fur.Delete();
                }
                else
                {
                    from.SendLocalizedMessage(1112353); // You place the gathered boura fur into your backpack.
                    GatheredFur = true;
                }
            }
            else
                from.SendLocalizedMessage(1112354); // The boura glares at you and will not let you shear its fur.
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\LowlandBoura.cs

<pre>public void Carve(Mobile from, Item item)
        {
            if (!GatheredFur)
            {
                var fur = new BouraFur(30);

                if (from.Backpack == null || !from.Backpack.TryDropItem(from, fur, false))
                {
                    from.SendLocalizedMessage(1112352); // You would not be able to place the gathered boura fur in your backpack!
                    fur.Delete();
                }
                else
                {
                    from.SendLocalizedMessage(1112353); // You place the gathered boura fur into your backpack.
                    GatheredFur = true;
                }
            }
            else
                from.SendLocalizedMessage(1112354); // The boura glares at you and will not let you shear its fur.
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\RuddyBoura.cs

<pre>public void Carve(Mobile from, Item item)
        {
            if (!GatheredFur)
            {
                var fur = new BouraFur(30);

                if (from.Backpack == null || !from.Backpack.TryDropItem(from, fur, false))
                {
                    from.SendLocalizedMessage(1112352); // You would not be able to place the gathered boura fur in your backpack!
                    fur.Delete();
                }
                else
                {
                    from.SendLocalizedMessage(1112353); // You place the gathered boura fur into your backpack.
                    GatheredFur = true;
                }
            }
            else
                from.SendLocalizedMessage(1112354); // The boura glares at you and will not let you shear its fur.
        }</pre>

## Duplicated Code. Size: 162

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Luck\LuneRouge.cs

<pre>{
			this.Weight = 1.0;
            this.Hue = 1166;

            this.Attributes.Luck = 150;
            this.Attributes.AttackChance = 10;
            this.Attributes.WeaponDamage = 20;

            this.SetHue = 1166;
            this.SetAttributes.Luck = 100;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.WeaponDamage = 20;
            this.SetAttributes.WeaponSpeed = 10;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenStam = 3;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Luck\SoleilRouge.cs

<pre>{
            this.Weight = 1.0;
            this.Hue = 1166;

            this.Attributes.Luck = 150;
            this.Attributes.AttackChance = 10;
            this.Attributes.WeaponDamage = 20;

            this.SetHue = 1166;
            this.SetAttributes.Luck = 100;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.WeaponDamage = 20;
            this.SetAttributes.WeaponSpeed = 10;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenStam = 3;
        }</pre>

## Duplicated Code. Size: 162

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\PileOfGlacialSnow.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (!this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(1042010); // You must have the object in your backpack to use it.
            }
            else if (from.Mounted)
                from.SendLocalizedMessage(1010097); // You cannot use this while mounted.

            else if (from.CanBeginAction(typeof(SnowPile)))
            {
                from.SendLocalizedMessage(1005575); // You carefully pack the snow into a ball...
                from.Target = new SnowTarget(from, this);
            }
            else
            {
                from.SendLocalizedMessage(1005574); // The snow is not ready to be packed yet.  Keep trying.
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\SnowPile.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (!this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(1042010); // You must have the object in your backpack to use it.
            }
            else if (from.Mounted)
                from.SendLocalizedMessage(1010097); // You cannot use this while mounted.

            else if (from.CanBeginAction(typeof(SnowPile)))
            {
                from.SendLocalizedMessage(1005575); // You carefully pack the snow into a ball...
                from.Target = new SnowTarget(from, this);
            }
            else
            {
                from.SendLocalizedMessage(1005574); // The snow is not ready to be packed yet.  Keep trying.
            }
        }</pre>

## Duplicated Code. Size: 162

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\Notoriety.cs

<pre>if (pmFrom.DuelContext != pmTarg.DuelContext && ((pmFrom.DuelContext != null && pmFrom.DuelContext.Started) || (pmTarg.DuelContext != null && pmTarg.DuelContext.Started)))
                    return false;

                if (pmFrom.DuelContext != null && pmFrom.DuelContext == pmTarg.DuelContext && ((pmFrom.DuelContext.StartedReadyCountdown && !pmFrom.DuelContext.Started) || pmFrom.DuelContext.Tied || pmFrom.DuelPlayer.Eliminated || pmTarg.DuelPlayer.Eliminated))
                    return false;</pre>

Fragment 2 in file Scripts\Misc\Notoriety.cs

<pre>if (pmFrom.DuelContext != pmTarg.DuelContext && ((pmFrom.DuelContext != null && pmFrom.DuelContext.Started) || (pmTarg.DuelContext != null && pmTarg.DuelContext.Started)))
                    return false;

                if (pmFrom.DuelContext != null && pmFrom.DuelContext == pmTarg.DuelContext && ((pmFrom.DuelContext.StartedReadyCountdown && !pmFrom.DuelContext.Started) || pmFrom.DuelContext.Tied || pmFrom.DuelPlayer.Eliminated || pmTarg.DuelPlayer.Eliminated))
                    return false;</pre>

## Duplicated Code. Size: 162

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\CommodityBrokerGump.cs

<pre>AddHtmlLocalized(113, 280, 200, 18, 1150332, OrangeColor16, false, false); // Shop Name:
            AddBackground(190, 280, 285, 22, 9350);
			AddTextEntry(191, 280, 285, 20, LabelHueBlue, 0, m_Broker.Plot.ShopName == null ? "" : m_Broker.Plot.ShopName);
			AddButton(480, 280, 4014, 4016, 2, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>AddHtmlLocalized(113, 280, 200, 18, 1150332, OrangeColor16, false, false); // Shop Name:
            AddBackground(190, 280, 285, 22, 9350);
			AddTextEntry(191, 280, 285, 20, LabelHueBlue, 0, m_Broker.Plot.ShopName == null ? "" : m_Broker.Plot.ShopName);
			AddButton(480, 280, 4014, 4016, 2, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 162

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestGumps.cs

<pre>if(args[1].StartsWith("0x"))
								{
									int.TryParse(args[1].Substring(2), NumberStyles.HexNumber, CultureInfo.InvariantCulture, out gumpid);
								} 
								else
								{
									int.TryParse(args[1], out gumpid);
								}
								int.TryParse(args[2], out gx);
								int.TryParse(args[3], out gy);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestGumps.cs

<pre>if(args[1].StartsWith("0x"))
								{
									int.TryParse(args[1].Substring(2), NumberStyles.HexNumber, CultureInfo.InvariantCulture, out gumpid);
								} 
								else
								{
									int.TryParse(args[1], out gumpid);
								}
								int.TryParse(args[2], out gx);
								int.TryParse(args[3], out gy);</pre>

## Duplicated Code. Size: 162

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>public override void OnItemLifted(Mobile from, Item item)
		{
			base.OnItemLifted(from, item);

			if (from is PlayerMobile && PlayerMade && (Owner != null) && (Owner == Creator))
			{
				LootType = LootType.Regular;
			}
			else
				if (from is PlayerMobile && Owner == null)
				{
					Owner = from as PlayerMobile;

					LootType = LootType.Blessed;
					// flag the owner as carrying a questtoken
					Owner.SetFlag(XmlQuest.CarriedXmlQuestFlag, true);
				}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>public override void OnItemLifted(Mobile from, Item item)
        {
            base.OnItemLifted(from, item);

            if (from is PlayerMobile && PlayerMade && (Owner != null) && (Owner == Creator))
            {
                LootType = LootType.Regular;
            }
            else
                if (from is PlayerMobile && Owner == null)
                {
                    Owner = from as PlayerMobile;

                    LootType = LootType.Blessed;
                    // flag the owner as carrying a questtoken
                    Owner.SetFlag(XmlQuest.CarriedXmlQuestFlag, true);
                }
        }</pre>

## Duplicated Code. Size: 162

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGauntlet.cs

<pre>if(Participants != null)
            {
                writer.Write(Participants.Count);

                foreach(ChallengeEntry entry in Participants)
                {
                    writer.Write(entry.Participant);
                    writer.Write(entry.Status.ToString());
                    writer.Write(entry.Accepted);
                    writer.Write(entry.PageBeingViewed);
                    writer.Write(entry.Score);
                }
            } else
            {
                writer.Write((int)0);
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGauntlet.cs

<pre>if(Participants != null)
            {
                writer.Write(Participants.Count);

                foreach(ChallengeEntry entry in Participants)
                {
                    writer.Write(entry.Participant);
                    writer.Write(entry.Status.ToString());
                    writer.Write(entry.Accepted);
                    writer.Write(entry.PageBeingViewed);
                    writer.Write(entry.Score);
                }
            } else
            {
                writer.Write((int)0);
            }</pre>

## Duplicated Code. Size: 162

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>EnsureCapacity(256);

			m_Stream.Write(((IMenu)menu).Serial);
			m_Stream.Write((short)0);

			string question = menu.Question;

			if (question == null)
			{
				m_Stream.Write((byte)0);
			}
			else
			{
				int questionLength = question.Length;
				m_Stream.Write((byte)questionLength);
				m_Stream.WriteAsciiFixed(question, questionLength);
			}</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>EnsureCapacity(256);

			m_Stream.Write(((IMenu)menu).Serial);
			m_Stream.Write((short)0);

			string question = menu.Question;

			if (question == null)
			{
				m_Stream.Write((byte)0);
			}
			else
			{
				int questionLength = question.Length;
				m_Stream.Write((byte)questionLength);
				m_Stream.WriteAsciiFixed(question, questionLength);
			}</pre>

## Duplicated Code. Size: 162

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefBowFletching.cs

<pre>public override int PlayEndingEffect(Mobile from, bool failed, bool lostMaterial, bool toolBroken, int quality, bool makersMark, CraftItem item)
        {
            if (toolBroken)
                from.SendLocalizedMessage(1044038); // You have worn out your tool

            if (failed)
            {
                if (lostMaterial)
                    return 1044043; // You failed to create the item, and some of your materials are lost.
                else
                    return 1044157; // You failed to create the item, but no materials were lost.
            }
            else
            {
                if (quality == 0)
                    return 502785; // You were barely able to make this item.  It's quality is below average.
                else if (makersMark && quality == 2)
                    return 1044156; // You create an exceptional quality item and affix your maker's mark.
                else if (quality == 2)
                    return 1044155; // You create an exceptional quality item.
                else 
                    return 1044154; // You create the item.
            }
        }</pre>

Fragment 2 in file Scripts\Services\Craft\DefCarpentry.cs

<pre>public override int PlayEndingEffect(Mobile from, bool failed, bool lostMaterial, bool toolBroken, int quality, bool makersMark, CraftItem item)
        {
            if (toolBroken)
                from.SendLocalizedMessage(1044038); // You have worn out your tool

            if (failed)
            {
                if (lostMaterial)
                    return 1044043; // You failed to create the item, and some of your materials are lost.
                else
                    return 1044157; // You failed to create the item, but no materials were lost.
            }
            else
            {
                if (quality == 0)
                    return 502785; // You were barely able to make this item.  It's quality is below average.
                else if (makersMark && quality == 2)
                    return 1044156; // You create an exceptional quality item and affix your maker's mark.
                else if (quality == 2)
                    return 1044155; // You create an exceptional quality item.
                else
                    return 1044154; // You create the item.
            }
        }</pre>

Fragment 3 in file Scripts\Services\Craft\DefCartography.cs

<pre>public override int PlayEndingEffect(Mobile from, bool failed, bool lostMaterial, bool toolBroken, int quality, bool makersMark, CraftItem item)
        {
            if (toolBroken)
                from.SendLocalizedMessage(1044038); // You have worn out your tool

            if (failed)
            {
                if (lostMaterial)
                    return 1044043; // You failed to create the item, and some of your materials are lost.
                else
                    return 1044157; // You failed to create the item, but no materials were lost.
            }
            else
            {
                if (quality == 0)
                    return 502785; // You were barely able to make this item.  It's quality is below average.
                else if (makersMark && quality == 2)
                    return 1044156; // You create an exceptional quality item and affix your maker's mark.
                else if (quality == 2)
                    return 1044155; // You create an exceptional quality item.
                else 
                    return 1044154; // You create the item.
            }
        }</pre>

Fragment 4 in file Scripts\Services\Craft\DefCooking.cs

<pre>public override int PlayEndingEffect(Mobile from, bool failed, bool lostMaterial, bool toolBroken, int quality, bool makersMark, CraftItem item)
        {
            if (toolBroken)
                from.SendLocalizedMessage(1044038); // You have worn out your tool

            if (failed)
            {
                if (lostMaterial)
                    return 1044043; // You failed to create the item, and some of your materials are lost.
                else
                    return 1044157; // You failed to create the item, but no materials were lost.
            }
            else
            {
                if (quality == 0)
                    return 502785; // You were barely able to make this item.  It's quality is below average.
                else if (makersMark && quality == 2)
                    return 1044156; // You create an exceptional quality item and affix your maker's mark.
                else if (quality == 2)
                    return 1044155; // You create an exceptional quality item.
                else 
                    return 1044154; // You create the item.
            }
        }</pre>

Fragment 5 in file Scripts\Services\Craft\DefMasonry.cs

<pre>public override int PlayEndingEffect(Mobile from, bool failed, bool lostMaterial, bool toolBroken, int quality, bool makersMark, CraftItem item) 
        { 
            if (toolBroken) 
                from.SendLocalizedMessage(1044038); // You have worn out your tool 

            if (failed) 
            { 
                if (lostMaterial) 
                    return 1044043; // You failed to create the item, and some of your materials are lost. 
                else 
                    return 1044157; // You failed to create the item, but no materials were lost. 
            }
            else 
            { 
                if (quality == 0) 
                    return 502785; // You were barely able to make this item.  It's quality is below average. 
                else if (makersMark && quality == 2) 
                    return 1044156; // You create an exceptional quality item and affix your maker's mark. 
                else if (quality == 2) 
                    return 1044155; // You create an exceptional quality item. 
                else 
                    return 1044154; // You create the item. 
            }
        }</pre>

Fragment 6 in file Scripts\Services\Craft\DefTailoring.cs

<pre>public override int PlayEndingEffect(Mobile from, bool failed, bool lostMaterial, bool toolBroken, int quality, bool makersMark, CraftItem item)
        {
            if (toolBroken)
                from.SendLocalizedMessage(1044038); // You have worn out your tool

            if (failed)
            {
                if (lostMaterial)
                    return 1044043; // You failed to create the item, and some of your materials are lost.
                else
                    return 1044157; // You failed to create the item, but no materials were lost.
            }
            else
            {
                if (quality == 0)
                    return 502785; // You were barely able to make this item.  It's quality is below average.
                else if (makersMark && quality == 2)
                    return 1044156; // You create an exceptional quality item and affix your maker's mark.
                else if (quality == 2)
                    return 1044155; // You create an exceptional quality item.
                else
                    return 1044154; // You create the item.
            }
        }</pre>

Fragment 7 in file Scripts\Services\Craft\DefTinkering.cs

<pre>public override int PlayEndingEffect(Mobile from, bool failed, bool lostMaterial, bool toolBroken, int quality, bool makersMark, CraftItem item)
        {
            if (toolBroken)
                from.SendLocalizedMessage(1044038); // You have worn out your tool

            if (failed)
            {
                if (lostMaterial)
                    return 1044043; // You failed to create the item, and some of your materials are lost.
                else
                    return 1044157; // You failed to create the item, but no materials were lost.
            }
            else
            {
                if (quality == 0)
                    return 502785; // You were barely able to make this item.  It's quality is below average.
                else if (makersMark && quality == 2)
                    return 1044156; // You create an exceptional quality item and affix your maker's mark.
                else if (quality == 2)
                    return 1044155; // You create an exceptional quality item.
                else 
                    return 1044154; // You create the item.
            }
        }</pre>

## Duplicated Code. Size: 161

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Extensions\Compilers\DistinctCompiler.cs

<pre>{
                ConstructorBuilder ctor = typeBuilder.DefineConstructor(
                    MethodAttributes.Public,
                    CallingConventions.Standard,
                    Type.EmptyTypes);

                ILGenerator il = ctor.GetILGenerator();

                // : base()
                il.Emit(OpCodes.Ldarg_0);
                il.Emit(OpCodes.Call, typeof(object).GetConstructor(Type.EmptyTypes));

                // return;
                il.Emit(OpCodes.Ret);
            }
            #endregion

            #region IComparer
            typeBuilder.AddInterfaceImplementation(typeof(IComparer));

            MethodBuilder compareMethod;</pre>

Fragment 2 in file Scripts\Commands\Generic\Extensions\Compilers\SortCompiler.cs

<pre>{
                ConstructorBuilder ctor = typeBuilder.DefineConstructor(
                    MethodAttributes.Public,
                    CallingConventions.Standard,
                    Type.EmptyTypes);

                ILGenerator il = ctor.GetILGenerator();

                // : base()
                il.Emit(OpCodes.Ldarg_0);
                il.Emit(OpCodes.Call, typeof(object).GetConstructor(Type.EmptyTypes));

                // return;
                il.Emit(OpCodes.Ret);
            }
            #endregion

            #region IComparer
            typeBuilder.AddInterfaceImplementation(typeof(IComparer));

            MethodBuilder compareMethod;</pre>

## Duplicated Code. Size: 161

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\FountainOfFortune.cs

<pre>List<Mobile> remove = new List<Mobile>();
            foreach (KeyValuePair<Mobile, DateTime> kvp in m_LuckTable)
            {
                if (kvp.Value < DateTime.UtcNow)
                    remove.Add(kvp.Key);
            }

            remove.ForEach(m =>
                {
                    m_LuckTable.Remove(m);

                    if (m.NetState != null)
                        m.SendLocalizedMessage(1079552); //Your luck just ran out.
                });

            remove.Clear();</pre>

Fragment 2 in file Scripts\Items\Artifacts\Decorative\TenthAnniversarySculpture.cs

<pre>List<Mobile> remove = new List<Mobile>();
            foreach (KeyValuePair<Mobile, DateTime> kvp in m_LuckTable)
            {
                if (kvp.Value < DateTime.UtcNow)
                    remove.Add(kvp.Key);
            }

            remove.ForEach(m =>
            {
                m_LuckTable.Remove(m);

                if (m.NetState != null)
                    m.SendLocalizedMessage(1079552); //Your luck just ran out.
            });

            remove.Clear();</pre>

## Duplicated Code. Size: 161

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\DespiseArtifacts.cs

<pre>{
			Hue = 1154;

			switch(Utility.Random(6))
			{
				case 0: SAAbsorptionAttributes.EaterKinetic = 2; break;
                case 1: SAAbsorptionAttributes.EaterFire = 2; break;
                case 2: SAAbsorptionAttributes.EaterCold = 2; break;
                case 3: SAAbsorptionAttributes.EaterPoison = 2; break;
                case 4: SAAbsorptionAttributes.EaterEnergy = 2; break;
                case 5: SAAbsorptionAttributes.EaterDamage = 2; break;
			}

			Attributes.NightSight = 1;
		}</pre>

Fragment 2 in file Scripts\Items\Artifacts\DespiseArtifacts.cs

<pre>{
			Hue = 1154;

			switch(Utility.Random(6))
			{
                case 0: SAAbsorptionAttributes.EaterKinetic = 2; break;
                case 1: SAAbsorptionAttributes.EaterFire = 2; break;
                case 2: SAAbsorptionAttributes.EaterCold = 2; break;
                case 3: SAAbsorptionAttributes.EaterPoison = 2; break;
                case 4: SAAbsorptionAttributes.EaterEnergy = 2; break;
                case 5: SAAbsorptionAttributes.EaterDamage = 2; break;
			}

			Attributes.NightSight = 1;
		}</pre>

## Duplicated Code. Size: 161

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\BagOfAllReagents.cs

<pre>this.DropItem(new BlackPearl(amount));
            this.DropItem(new Bloodmoss(amount));
            this.DropItem(new Garlic(amount));
            this.DropItem(new Ginseng(amount));
            this.DropItem(new MandrakeRoot(amount));
            this.DropItem(new Nightshade(amount));
            this.DropItem(new SulfurousAsh(amount));</pre>

Fragment 2 in file Scripts\Items\Containers\BagOfReagents.cs

<pre>this.DropItem(new BlackPearl(amount));
            this.DropItem(new Bloodmoss(amount));
            this.DropItem(new Garlic(amount));
            this.DropItem(new Ginseng(amount));
            this.DropItem(new MandrakeRoot(amount));
            this.DropItem(new Nightshade(amount));
            this.DropItem(new SulfurousAsh(amount));</pre>

## Duplicated Code. Size: 161

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\ArcherGuard.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);

			int version = reader.ReadInt();

			switch (version)
			{
				case 0:
					{
						m_Focus = reader.ReadMobile();

						if (m_Focus != null)
						{
							m_AttackTimer = new AttackTimer(this);
							m_AttackTimer.Start();
						}
						else
						{
							m_IdleTimer = new IdleTimer(this);
							m_IdleTimer.Start();
						}

						break;
					}
			}
		}</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\WarriorGuard.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);

			int version = reader.ReadInt();

			switch (version)
			{
				case 0:
					{
						m_Focus = reader.ReadMobile();

						if (m_Focus != null)
						{
							m_AttackTimer = new AttackTimer(this);
							m_AttackTimer.Start();
						}
						else
						{
							m_IdleTimer = new IdleTimer(this);
							m_IdleTimer.Start();
						}

						break;
					}
			}
		}</pre>

## Duplicated Code. Size: 161

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>int x=0;
									int y=0;
									int z=0;
									if(!int.TryParse(keywordargs[3], out x) || !int.TryParse(keywordargs[4], out y) || !int.TryParse(keywordargs[5], out z))
									{ status_str = "Improper effect location format"; }
									eloc1 = new Point3D(x, y, z);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>int x = 0;
										int y = 0;
										int z = 0;
										if(!int.TryParse(keywordargs[3], out x) || !int.TryParse(keywordargs[4], out y) || !int.TryParse(keywordargs[5], out z))
										{ status_str = "Improper effect location format"; }
										eloc1 = new Point3D(x, y, z);</pre>

## Duplicated Code. Size: 161

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlLifeDrain.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);

			int version = reader.ReadInt();
			switch(version)
			{
				case 1:
					// version 1
					Range = reader.ReadInt();
					goto case 0;
				case 0:
					// version 0
					m_Drain = reader.ReadInt();
					Refractory = reader.ReadTimeSpan();
					TimeSpan remaining = reader.ReadTimeSpan();
					m_EndTime = DateTime.UtcNow + remaining;
					break;
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlManaDrain.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);

			int version = reader.ReadInt();
			switch(version)
			{
				case 1:
					// version 1
					Range = reader.ReadInt();
					goto case 0;
				case 0:
					// version 0
					m_Drain = reader.ReadInt();
					Refractory = reader.ReadTimeSpan();
					TimeSpan remaining = reader.ReadTimeSpan();
					m_EndTime = DateTime.UtcNow + remaining;
					break;
			}
		}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlStamDrain.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);

			int version = reader.ReadInt();
			switch(version)
			{
				case 1:
					// version 1
					Range = reader.ReadInt();
					goto case 0;
				case 0:
					// version 0
					m_Drain = reader.ReadInt();
					Refractory = reader.ReadTimeSpan();
					TimeSpan remaining = reader.ReadTimeSpan();
					m_EndTime = DateTime.UtcNow + remaining;
					break;
			}
		}</pre>

## Duplicated Code. Size: 161

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\HuntmasterChallenge\ComplexHuntTrophy.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write((int)0);

            writer.Write(m_Owner);
            writer.Write(m_Measurement);
            writer.Write(m_DateKilled);
            writer.Write(m_Location);
            TextDefinition.Serialize(writer, m_Species);
            writer.Write((int)m_MeasuredBy);
            writer.Write(m_SouthID);
        }</pre>

Fragment 2 in file Scripts\Services\HuntmasterChallenge\ComplexHuntTrophy.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write((int)0);

            writer.Write(m_Owner);
            writer.Write(m_Measurement);
            writer.Write(m_DateKilled);
            writer.Write(m_Location);
            TextDefinition.Serialize(writer, m_Species);
            writer.Write((int)m_MeasuredBy);
            writer.Write(m_SouthID);
        }</pre>

Fragment 3 in file Scripts\Services\HuntmasterChallenge\HuntTrophy.cs

<pre>public override void Serialize(GenericWriter writer)
		{
			base.Serialize(writer);
			writer.Write((int)0);

			writer.Write(m_Owner);
			writer.Write(m_Measurement);
			writer.Write(m_DateKilled);
			writer.Write(m_Location);
			TextDefinition.Serialize(writer, m_Species);
			writer.Write((int)m_MeasuredBy);
            writer.Write(m_SouthID);
		}</pre>

Fragment 4 in file Scripts\Services\HuntmasterChallenge\HuntTrophy.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write((int)0);

            writer.Write(m_Owner);
            writer.Write(m_Measurement);
            writer.Write(m_DateKilled);
            writer.Write(m_Location);
            TextDefinition.Serialize(writer, m_Species);
            writer.Write((int)m_MeasuredBy);
            writer.Write(m_SouthID);
        }</pre>

## Duplicated Code. Size: 161

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Darkwood\DarkwoodChest.cs

<pre>{
            this.Hue = 0x455;							
            this.SetHue = 0x494;

            this.Attributes.BonusHits = 2;		
            this.Attributes.DefendChance = 5;

            this.SetAttributes.ReflectPhysical = 25;
            this.SetAttributes.BonusStr = 10;		
            this.SetAttributes.NightSight = 1;		

            this.SetSelfRepair = 3;			
            this.SetPhysicalBonus = 2;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Darkwood\DarkwoodCrown.cs

<pre>{
            this.Hue = 0x455;							
            this.SetHue = 0x494;

            this.Attributes.BonusHits = 2;		
            this.Attributes.DefendChance = 5;

            this.SetAttributes.ReflectPhysical = 25;
            this.SetAttributes.BonusStr = 10;			
            this.SetAttributes.NightSight = 1;		

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 2;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Darkwood\DarkwoodGauntlets.cs

<pre>{
            this.Hue = 0x455;								
            this.SetHue = 0x494;

            this.Attributes.BonusHits = 2;		
            this.Attributes.DefendChance = 5;

            this.SetAttributes.ReflectPhysical = 25;
            this.SetAttributes.BonusStr = 10;		
            this.SetAttributes.NightSight = 1;		

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 2;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Darkwood\DarkwoodGorget.cs

<pre>{
            this.Hue = 0x455;								
            this.SetHue = 0x494;

            this.Attributes.BonusHits = 2;		
            this.Attributes.DefendChance = 5;

            this.SetAttributes.ReflectPhysical = 25;
            this.SetAttributes.BonusStr = 10;		
            this.SetAttributes.NightSight = 1;		

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 2;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Darkwood\DarkwoodLeggings.cs

<pre>{
            this.Hue = 0x455;							
            this.SetHue = 0x494;

            this.Attributes.BonusHits = 2;		
            this.Attributes.DefendChance = 5;

            this.SetAttributes.ReflectPhysical = 25;
            this.SetAttributes.BonusStr = 10;		
            this.SetAttributes.NightSight = 1;		

            this.SetSelfRepair = 3;			
            this.SetPhysicalBonus = 2;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 6 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Darkwood\DarkwoodPauldrons.cs

<pre>{
            this.Hue = 0x455;				
            this.SetHue = 0x494;

            this.Attributes.BonusHits = 2;		
            this.Attributes.DefendChance = 5;

            this.SetAttributes.ReflectPhysical = 25;
            this.SetAttributes.BonusStr = 10;		
            this.SetAttributes.NightSight = 1;		

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 2;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

## Duplicated Code. Size: 160

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\HeritageTokenGump.cs

<pre>this.AddPage(0);

            this.AddBackground(0, 0, 520, 404, 0x13BE);
            this.AddImageTiled(10, 10, 500, 20, 0xA40);
            this.AddImageTiled(10, 40, 500, 324, 0xA40);
            this.AddImageTiled(10, 374, 500, 20, 0xA40);
            this.AddAlphaRegion(10, 10, 500, 384);</pre>

Fragment 2 in file Scripts\Gumps\PolymorphGump.cs

<pre>this.AddPage(0);

            this.AddBackground(0, 0, 520, 404, 0x13BE);
            this.AddImageTiled(10, 10, 500, 20, 0xA40);
            this.AddImageTiled(10, 40, 500, 324, 0xA40);
            this.AddImageTiled(10, 374, 500, 20, 0xA40);
            this.AddAlphaRegion(10, 10, 500, 384);</pre>

## Duplicated Code. Size: 160

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Guile.cs

<pre>this.SetSkill(SkillName.EvalInt, 108.4, 120.0);
            this.SetSkill(SkillName.Meditation, 109.2, 120.0);

            this.Fame = 21000;
            this.Karma = -21000;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Named\Spite.cs

<pre>this.SetSkill(SkillName.EvalInt, 108.4, 120.0);
            this.SetSkill(SkillName.Meditation, 109.2, 120.0);

            this.Fame = 21000;
            this.Karma = -21000;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 160

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Robe(this.GetRandomHue()));

            int lowHue = this.GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new ThighBoots(lowHue));
            else
                this.AddItem(new Boots(lowHue));

            this.PackGold(200, 250);
        }</pre>

Fragment 2 in file Scripts\Quests\Escortables.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Robe(this.GetRandomHue()));

            int lowHue = this.GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new ThighBoots(lowHue));
            else
                this.AddItem(new Boots(lowHue));

            this.PackGold(200, 250);
        }</pre>

## Duplicated Code. Size: 160

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Virtues\VirtueInfoGump.cs

<pre>this.AddPage(0);

            this.AddImage(30, 40, 2080);
            this.AddImage(47, 77, 2081);
            this.AddImage(47, 147, 2081);
            this.AddImage(47, 217, 2081);
            this.AddImage(47, 267, 2083);
            this.AddImage(70, 213, 2091);

            this.AddPage(1);</pre>

Fragment 2 in file Scripts\Services\Virtues\VirtueStatusGump.cs

<pre>this.AddPage(0);

            this.AddImage(30, 40, 2080);
            this.AddImage(47, 77, 2081);
            this.AddImage(47, 147, 2081);
            this.AddImage(47, 217, 2081);
            this.AddImage(47, 267, 2083);
            this.AddImage(70, 213, 2091);

            this.AddPage(1);</pre>

## Duplicated Code. Size: 160

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>SearchList = searchlist;

				From = from;
				Closable = false;
				Dragable = true;
				AddPage(0);
				AddBackground(10, 200, 200, 130, 5054);
				int count = 0;

				if (SearchList != null)
				{
					for (int i = 0; i < SearchList.Count; i++)
					{
						if (((SearchEntry)SearchList[i]).Selected) count++;
					}
				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>SearchList = searchlist;

				From = from;
				Closable = false;
				Dragable = true;
				AddPage(0);
				AddBackground(10, 200, 200, 130, 5054);
				int count = 0;

				if (SearchList != null)
				{
					for (int i = 0; i < SearchList.Count; i++)
					{
						if (((SearchEntry)SearchList[i]).Selected) count++;
					}
				}</pre>

## Duplicated Code. Size: 160

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGauntlet.cs

<pre>ChallengeEntry entry = new ChallengeEntry();
                    entry.Participant = reader.ReadMobile();
                    string sname = reader.ReadString();
                    // look up the enum by name
                    ChallengeStatus status = ChallengeStatus.None;
                    try{
                    status = (ChallengeStatus)Enum.Parse(typeof(ChallengeStatus), sname);
                    } catch{}
                    entry.Status = status;
                    entry.Accepted = reader.ReadBool();
                    entry.PageBeingViewed = reader.ReadInt();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGauntlet.cs

<pre>ChallengeEntry entry = new ChallengeEntry();
                    entry.Participant = reader.ReadMobile();
                    string sname = reader.ReadString();
                    // look up the enum by name
                    ChallengeStatus status = ChallengeStatus.None;
                    try{
                    status = (ChallengeStatus)Enum.Parse(typeof(ChallengeStatus), sname);
                    } catch{}
                    entry.Status = status;
                    entry.Accepted = reader.ReadBool();
                    entry.PageBeingViewed = reader.ReadInt();</pre>

## Duplicated Code. Size: 160

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SOS.cs

<pre>public static bool ValidateDeepWater(Map map, int x, int y)
        {
            int tileID = map.Tiles.GetLandTile(x, y).ID;
            bool water = false;

            for (int i = 0; !water && i < m_WaterTiles.Length; i += 2)
                water = (tileID >= m_WaterTiles[i] && tileID <= m_WaterTiles[i + 1]);

            return water;
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\SpecialFishingNet.cs

<pre>private static bool ValidateDeepWater(Map map, int x, int y)
        {
            int tileID = map.Tiles.GetLandTile(x, y).ID;
            bool water = false;

            for (int i = 0; !water && i < m_WaterTiles.Length; i += 2)
                water = (tileID >= m_WaterTiles[i] && tileID <= m_WaterTiles[i + 1]);

            return water;
        }</pre>

Fragment 3 in file Scripts\Services\ExploringTheDeep\Items\SpecialSalvageHook.cs

<pre>private static bool ValidateDeepWater(Map map, int x, int y)
        {
            int tileID = map.Tiles.GetLandTile(x, y).ID;
            bool water = false;

            for (int i = 0; !water && i < m_WaterTiles.Length; i += 2)
                water = (tileID >= m_WaterTiles[i] && tileID <= m_WaterTiles[i + 1]);

            return water;
        }</pre>

## Duplicated Code. Size: 160

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\BaseGump.cs

<pre>public static int C16232(int c16)
        {
            c16 &= 0x7FFF;

            int r = (((c16 >> 10) & 0x1F) << 3);
            int g = (((c16 >> 05) & 0x1F) << 3);
            int b = (((c16 >> 00) & 0x1F) << 3);

            return (r << 16) | (g << 8) | (b << 0);
        }</pre>

Fragment 2 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>public static int C16232(int c16)
        {
            c16 &= 0x7FFF;

            int r = (((c16 >> 10) & 0x1F) << 3);
            int g = (((c16 >> 05) & 0x1F) << 3);
            int b = (((c16 >> 00) & 0x1F) << 3);

            return (r << 16) | (g << 8) | (b << 0);
        }</pre>

Fragment 3 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>public static int C16232(int c16)
        {
            c16 &= 0x7FFF;

            int r = (((c16 >> 10) & 0x1F) << 3);
            int g = (((c16 >> 05) & 0x1F) << 3);
            int b = (((c16 >> 00) & 0x1F) << 3);

            return (r << 16) | (g << 8) | (b << 0);
        }</pre>

Fragment 4 in file Scripts\Services\Quests\QuestSystem.cs

<pre>public static int C16232(int c16)
        {
            c16 &= 0x7FFF;

            int r = (((c16 >> 10) & 0x1F) << 3);
            int g = (((c16 >> 05) & 0x1F) << 3);
            int b = (((c16 >> 00) & 0x1F) << 3);

            return (r << 16) | (g << 8) | (b << 0);
        }</pre>

Fragment 5 in file Scripts\Services\Vendor Searching\VendorSearchGump.cs

<pre>public static int C16232(int c16)
        {
            c16 &= 0x7FFF;

            int r = (((c16 >> 10) & 0x1F) << 3);
            int g = (((c16 >> 05) & 0x1F) << 3);
            int b = (((c16 >> 00) & 0x1F) << 3);

            return (r << 16) | (g << 8) | (b << 0);
        }</pre>

## Duplicated Code. Size: 160

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\BaseGump.cs

<pre>public static int C32216(int c32)
        {
            c32 &= 0xFFFFFF;

            int r = (((c32 >> 16) & 0xFF) >> 3);
            int g = (((c32 >> 08) & 0xFF) >> 3);
            int b = (((c32 >> 00) & 0xFF) >> 3);

            return (r << 10) | (g << 5) | (b << 0);
        }</pre>

Fragment 2 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>public static int C32216(int c32)
        {
            c32 &= 0xFFFFFF;

            int r = (((c32 >> 16) & 0xFF) >> 3);
            int g = (((c32 >> 08) & 0xFF) >> 3);
            int b = (((c32 >> 00) & 0xFF) >> 3);

            return (r << 10) | (g << 5) | (b << 0);
        }</pre>

Fragment 3 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>public static int C32216(int c32)
        {
            c32 &= 0xFFFFFF;

            int r = (((c32 >> 16) & 0xFF) >> 3);
            int g = (((c32 >> 08) & 0xFF) >> 3);
            int b = (((c32 >> 00) & 0xFF) >> 3);

            return (r << 10) | (g << 5) | (b << 0);
        }</pre>

Fragment 4 in file Scripts\Services\Quests\QuestSystem.cs

<pre>public static int C32216(int c32)
        {
            c32 &= 0xFFFFFF;

            int r = (((c32 >> 16) & 0xFF) >> 3);
            int g = (((c32 >> 08) & 0xFF) >> 3);
            int b = (((c32 >> 00) & 0xFF) >> 3);

            return (r << 10) | (g << 5) | (b << 0);
        }</pre>

Fragment 5 in file Scripts\Services\Vendor Searching\VendorSearchGump.cs

<pre>public static int C32216(int c32)
        {
            c32 &= 0xFFFFFF;

            int r = (((c32 >> 16) & 0xFF) >> 3);
            int g = (((c32 >> 08) & 0xFF) >> 3);
            int b = (((c32 >> 00) & 0xFF) >> 3);

            return (r << 10) | (g << 5) | (b << 0);
        }</pre>

## Duplicated Code. Size: 159

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Core\Faction.cs

<pre>mob.InvalidateProperties();
                mob.Delta(MobileDelta.Noto);

                if (this.Election.IsCandidate(mob))
                    this.Election.RemoveCandidate(mob);

                if (pl.Finance != null)
                    pl.Finance.Finance = null;

                if (pl.Sheriff != null)
                    pl.Sheriff.Sheriff = null;

                this.Election.RemoveVoter(mob);

                if (this.Commander == mob)
                    this.Commander = null;</pre>

Fragment 2 in file Scripts\Services\Factions\Core\Faction.cs

<pre>mob.InvalidateProperties();
            mob.Delta(MobileDelta.Noto);

            if (this.Election.IsCandidate(mob))
                this.Election.RemoveCandidate(mob);

            this.Election.RemoveVoter(mob);

            if (pl.Finance != null)
                pl.Finance.Finance = null;

            if (pl.Sheriff != null)
                pl.Sheriff.Sheriff = null;

            if (this.Commander == mob)
                this.Commander = null;</pre>

## Duplicated Code. Size: 159

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>break;
                case Aggression.Aggressive:
                    {
                        if (AcquireFocusMob(m_Creature.GetLeashLength(), m_Creature.FightMode, false, false, true))
                        {
                            if (m_Creature.Debug)
                                m_Creature.DebugSay("I have detected {0}, attacking", m_Creature.FocusMob.Name);

                            m_Creature.Combatant = m_Creature.FocusMob;
                            m_Creature.ControlTarget = m_Creature.FocusMob;
                            m_Creature.ControlOrder = OrderType.Attack;
                            Action = ActionType.Combat;
                        }
                        else
                            return base.DoOrderNone();
                    }
                    break;</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>break;
                case Aggression.Aggressive:
                    {
                        if (AcquireFocusMob(m_Creature.GetLeashLength(), m_Creature.FightMode, false, false, true))
                        {
                            if (m_Creature.Debug)
                                m_Creature.DebugSay("I have detected {0}, attacking", m_Creature.FocusMob.Name);

                            m_Creature.Combatant = m_Creature.FocusMob;
                            m_Creature.ControlTarget = m_Creature.FocusMob;
                            m_Creature.ControlOrder = OrderType.Attack;
                            Action = ActionType.Combat;
                        }
                        else
                            return base.DoOrderNone();
                    }
                    break;</pre>

## Duplicated Code. Size: 159

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>{
			if ((m_Index + 4) > m_Buffer.Length)
			{
				Flush();
			}

			m_Buffer[m_Index] = (byte)value;
			m_Buffer[m_Index + 1] = (byte)(value >> 8);
			m_Buffer[m_Index + 2] = (byte)(value >> 16);
			m_Buffer[m_Index + 3] = (byte)(value >> 24);
			m_Index += 4;
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>{
			if ((m_Index + 4) > m_Buffer.Length)
			{
				Flush();
			}

			m_Buffer[m_Index] = (byte)value;
			m_Buffer[m_Index + 1] = (byte)(value >> 8);
			m_Buffer[m_Index + 2] = (byte)(value >> 16);
			m_Buffer[m_Index + 3] = (byte)(value >> 24);
			m_Index += 4;
		}</pre>

## Duplicated Code. Size: 158

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SHTelGenDelete.cs

<pre>public void AddSHTCouple(bool ext1, int x1, int y1, int z1, bool ext2, int x2, int y2, int z2)
            {
                this.AddSHTCouple(Map.Trammel, ext1, x1, y1, z1, ext2, x2, y2, z2);
                this.AddSHTCouple(Map.Felucca, ext1, x1, y1, z1, ext2, x2, y2, z2);
            }</pre>

Fragment 2 in file Scripts\Items\Addons\SHTeleporter.cs

<pre>public void AddSHTCouple(bool ext1, int x1, int y1, int z1, bool ext2, int x2, int y2, int z2)
            {
                this.AddSHTCouple(Map.Trammel, ext1, x1, y1, z1, ext2, x2, y2, z2);
                this.AddSHTCouple(Map.Felucca, ext1, x1, y1, z1, ext2, x2, y2, z2);
            }</pre>

## Duplicated Code. Size: 158

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\ConfirmReleaseGump.cs

<pre>this.AddButton(20, 80, 4005, 4007, 2, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(55, 80, 75, 20, 1011011, false, false); // CONTINUE

            this.AddButton(135, 80, 4005, 4007, 1, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(170, 80, 75, 20, 1011012, false, false); // CANCEL</pre>

Fragment 2 in file Scripts\Services\Factions\Gumps\LeaveFactionGump.cs

<pre>this.AddHtmlLocalized(55, 80, 75, 20, 1011011, false, false); // CONTINUE
            this.AddButton(20, 80, 4005, 4007, 1, GumpButtonType.Reply, 0);

            this.AddHtmlLocalized(170, 80, 75, 20, 1011012, false, false); // CANCEL
            this.AddButton(135, 80, 4005, 4007, 2, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 158

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\ConsoleCommands.cs

<pre>Account a = t.Account as Account;

					if (a == null)
					{
						continue;
					}

					Mobile m = t.Mobile;

					if (m == null)
					{
						continue;
					}

					sub = sub.ToLower();

					if (m.Name.ToLower() != sub.Trim())
					{
						continue;
					}

					NetState m_ns = m.NetState;

					Console.WriteLine("Mobile name: '{0}' Account name: '{1}'", m.Name, a.Username);</pre>

Fragment 2 in file Scripts\Misc\ConsoleCommands.cs

<pre>Account a = t.Account as Account;

					if (a == null)
					{
						continue;
					}

					Mobile m = t.Mobile;

					if (m == null)
					{
						continue;
					}

					sub = sub.ToLower();

					if (m.Name.ToLower() != sub.Trim())
					{
						continue;
					}

					NetState m_ns = m.NetState;

					Console.WriteLine("Mobile name: '{0}' Account name: '{1}'", m.Name, a.Username);</pre>

## Duplicated Code. Size: 158

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // Ringmail (exceptional)
            {
                new int[] { 5000, 10000, 10000, 15000, 15000, 25000, 25000, 50000, 50000 },
                new int[] { 7500, 15000, 15000, 22500, 22500, 37500, 37500, 75000, 75000 },
                new int[] { 10000, 20000, 30000, 30000, 50000, 50000, 100000, 100000, 200000 }
            }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // Platemail (regular)
            {
                new int[] { 5000, 10000, 10000, 15000, 15000, 25000, 25000, 50000, 50000 },
                new int[] { 7500, 15000, 15000, 22500, 22500, 37500, 37500, 75000, 75000 },
                new int[] { 10000, 20000, 30000, 30000, 50000, 50000, 100000, 100000, 200000 }
            }</pre>

## Duplicated Code. Size: 158

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 5-part weapons (exceptional)
            {
                new int[] { 7500, 0, 0, 0, 0, 0, 0, 0, 0 },
                new int[] { 11250, 0, 0, 0, 0, 0, 0, 0, 0 },
                new int[] { 15000, 0, 0, 0, 0, 0, 0, 0, 0 }
            }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 6-part weapons (exceptional)
            {
                new int[] { 7500, 0, 0, 0, 0, 0, 0, 0, 0 },
                new int[] { 11250, 0, 0, 0, 0, 0, 0, 0, 0 },
                new int[] { 15000, 0, 0, 0, 0, 0, 0, 0, 0 }
            }</pre>

## Duplicated Code. Size: 158

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Housing Lotto\Gumps\LottoTrackingGump.cs

<pre>y = 60;

                    AddHtml(10 + x, 40, 80, 20, Color("Player", 0xFFFFFF), false, false);
                    AddHtml(92 + x, 40, 60, 20, Color("Tickets", 0xFFFFFF), false, false);
                    AddHtml(154 + x, 40, 60, 20, Color("Total Gold", 0xFFFFFF), false, false);</pre>

Fragment 2 in file Scripts\Services\New Magincia\Housing Lotto\Gumps\LottoTrackingGump.cs

<pre>y = 60;

                    AddHtml(10 + x, 40, 80, 20, Color("Player", 0xFFFFFF), false, false);
                    AddHtml(92 + x, 40, 60, 20, Color("Tickets", 0xFFFFFF), false, false);
                    AddHtml(154 + x, 40, 60, 20, Color("Total Gold", 0xFFFFFF), false, false);</pre>

## Duplicated Code. Size: 158

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ViceVsVirtue\GuildStats.cs

<pre>public void Serialize(GenericWriter writer)
        {
            writer.Write(0);

            writer.Write(Points);

            writer.Write(Silver);
            writer.Write(Kills);
            writer.Write(Assists);
            writer.Write(Deaths);
            writer.Write(Stolen);
            writer.Write(ViceReturned);
            writer.Write(VirtueReturned);
            writer.Write(Disarmed);
        }</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\GuildStats.cs

<pre>public void Serialize(GenericWriter writer)
        {
            writer.Write(0);

            writer.Write(Points);

            writer.Write(Silver);
            writer.Write(Kills);
            writer.Write(Assists);
            writer.Write(Deaths);
            writer.Write(Stolen);
            writer.Write(ViceReturned);
            writer.Write(VirtueReturned);
            writer.Write(Disarmed);
        }</pre>

## Duplicated Code. Size: 158

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlPropsGump.cs

<pre>if ( o is Mobile )
			{
				return String.Format( "(M) 0x{0:X} \"{1}\"", ((Mobile)o).Serial.Value, ((Mobile)o).Name );
			}
			else if ( o is Item )
			{
				return String.Format( "(I) 0x{0:X}", ((Item)o).Serial );
			}
			else if ( o is Type )
			{
				return ((Type)o).Name;
			}
			else
			{
				return o.ToString();
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlPropsGump.cs

<pre>if ( o is Mobile )
			{
				return String.Format( "(M) 0x{0:X} \"{1}\"", ((Mobile)o).Serial.Value, ((Mobile)o).Name );
			}
			else if ( o is Item )
			{
				return String.Format( "(I) 0x{0:X}", ((Item)o).Serial );
			}
			else if ( o is Type )
			{
				return ((Type)o).Name;
			}
			else
			{
				return o.ToString();
			}</pre>

## Duplicated Code. Size: 158

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Imbuing\Gumps\ImbuingGump.cs

<pre>{
                    if (Imod == 3 || Imod == 4 || Imod == 5 || Imod == 9 || Imod == 10 || Imod == 11 || Imod == 21 || Imod == 23 || (Imod >= 17 && Imod <= 19))
                    {
                        Imbuing.ImbueItem(from, it, Imod, ImodInt);
                        from.SendGump(new ImbuingGump(from));
                        return;
                    }
                    else
                        from.SendMessage("The selected item cannot be Imbued with the last Property..");
                }</pre>

Fragment 2 in file Scripts\Skills\Imbuing\Gumps\ImbuingGump.cs

<pre>{
                    if (Imod == 3 || Imod == 4 || Imod == 5 || Imod == 9 || Imod == 10 || Imod == 11 || Imod == 21 || Imod == 23 || (Imod >= 17 && Imod <= 19))
                    {
                        Imbuing.ImbueItem(from, it, Imod, ImodInt);
                        from.SendGump(new ImbuingGump(from));
                        return;
                    }
                    else
                        from.SendMessage("The selected item cannot be Imbued with the last Property..");
                }</pre>

## Duplicated Code. Size: 158

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCannonDeed.cs

<pre>public void Placement_OnTarget( Mobile from, object targeted )
		{
			IPoint3D p = targeted as IPoint3D;

			if ( p == null )
				return;

			Point3D loc = new Point3D( p );

			if ( p is StaticTarget )
				loc.Z -= TileData.ItemTable[((StaticTarget)p).ItemID & 0x3FFF].CalcHeight; /* NOTE: OSI does not properly normalize Z positioning here.
																							* A side affect is that you can only place on floors (due to the CanFit call).
																							* That functionality may be desired. And so, it's included in this script.
																							*/
			if ( ValidatePlacement( from, loc ) )
				EndPlace(from, loc);
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCatapultDeed.cs

<pre>public void Placement_OnTarget( Mobile from, object targeted )
		{
			IPoint3D p = targeted as IPoint3D;

			if ( p == null )
				return;

			Point3D loc = new Point3D( p );

			if ( p is StaticTarget )
				loc.Z -= TileData.ItemTable[((StaticTarget)p).ItemID & 0x3FFF].CalcHeight; /* NOTE: OSI does not properly normalize Z positioning here.
																							* A side affect is that you can only place on floors (due to the CanFit call).
																							* That functionality may be desired. And so, it's included in this script.
																							*/
			if ( ValidatePlacement( from, loc ) )
				EndPlace(from, loc);
		}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRamDeed.cs

<pre>public void Placement_OnTarget( Mobile from, object targeted )
		{
			IPoint3D p = targeted as IPoint3D;

			if ( p == null )
				return;

			Point3D loc = new Point3D( p );

			if ( p is StaticTarget )
				loc.Z -= TileData.ItemTable[((StaticTarget)p).ItemID & 0x3FFF].CalcHeight; /* NOTE: OSI does not properly normalize Z positioning here.
																							* A side affect is that you can only place on floors (due to the CanFit call).
																							* That functionality may be desired. And so, it's included in this script.
																							*/
			if ( ValidatePlacement( from, loc ) )
				EndPlace(from, loc);
		}</pre>

## Duplicated Code. Size: 157

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SoulStone.cs

<pre>this.m_Stone = stone;

                this.AddBackground(0, 0, 520, 440, 0x13BE);

                this.AddImageTiled(10, 10, 500, 20, 0xA40);
                this.AddImageTiled(10, 40, 500, 360, 0xA40);
                this.AddImageTiled(10, 410, 500, 20, 0xA40);

                this.AddAlphaRegion(10, 10, 500, 420);</pre>

Fragment 2 in file Scripts\Items\Consumables\SoulStone.cs

<pre>this.m_Stone = stone;

                this.AddBackground(0, 0, 520, 440, 0x13BE);

                this.AddImageTiled(10, 10, 500, 20, 0xA40);
                this.AddImageTiled(10, 40, 500, 360, 0xA40);
                this.AddImageTiled(10, 410, 500, 20, 0xA40);

                this.AddAlphaRegion(10, 10, 500, 420);</pre>

## Duplicated Code. Size: 157

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\HireFighter.cs

<pre>this.SpeechHue = Utility.RandomDyedHue();
            this.Hue = Utility.RandomSkinHue();

            if (this.Female = Utility.RandomBool()) 
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");
            }
            else 
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
                this.AddItem(new ShortPants(Utility.RandomNeutralHue()));
            }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HirePaladin.cs

<pre>this.SpeechHue = Utility.RandomDyedHue();
            this.Hue = Utility.RandomSkinHue();

            if (this.Female = Utility.RandomBool()) 
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");
            }
            else 
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
                this.AddItem(new ShortPants(Utility.RandomNeutralHue()));
            }</pre>

## Duplicated Code. Size: 157

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\IronWorker.cs

<pre>{
			SetSkill(SkillName.ArmsLore, 36.0, 68.0);
			SetSkill(SkillName.Blacksmith, 65.0, 88.0);
			SetSkill(SkillName.Fencing, 60.0, 83.0);
			SetSkill(SkillName.Macing, 61.0, 93.0);
			SetSkill(SkillName.Swords, 60.0, 83.0);
			SetSkill(SkillName.Tactics, 60.0, 83.0);
			SetSkill(SkillName.Parry, 61.0, 93.0);
		}</pre>

Fragment 2 in file Scripts\Quests\CloakOfHumility\Mobiles\Sean.cs

<pre>{
            SetSkill(SkillName.ArmsLore, 36.0, 68.0);
            SetSkill(SkillName.Blacksmith, 65.0, 88.0);
            SetSkill(SkillName.Fencing, 60.0, 83.0);
            SetSkill(SkillName.Macing, 61.0, 93.0);
            SetSkill(SkillName.Swords, 60.0, 83.0);
            SetSkill(SkillName.Tactics, 60.0, 83.0);
            SetSkill(SkillName.Parry, 61.0, 93.0);
        }</pre>

## Duplicated Code. Size: 157

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>int dir = GetValueForDirection(direction);

            GalleonHold gHold = AddGalleonHold(new GalleonHold(this, m_HoldItemIDs[dir][0]));

            HoldItem hold1 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][0]));
            HoldItem hold2 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][1]));</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>int dir = GetValueForDirection(direction);

            GalleonHold gHold = AddGalleonHold(new GalleonHold(this, m_HoldItemIDs[dir][0]));

            HoldItem hold1 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][0]));
            HoldItem hold2 = AddHoldTile(new HoldItem(GalleonHold, m_HoldIDs[dir][1]));</pre>

## Duplicated Code. Size: 157

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionDeathKnight.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 30, 50);
            this.SetResistance(ResistanceType.Fire, 30, 50);
            this.SetResistance(ResistanceType.Cold, 30, 50);
            this.SetResistance(ResistanceType.Energy, 30, 50);
            this.SetResistance(ResistanceType.Poison, 30, 50);

            this.VirtualArmor = 24;</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionSorceress.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 30, 50);
            this.SetResistance(ResistanceType.Fire, 30, 50);
            this.SetResistance(ResistanceType.Cold, 30, 50);
            this.SetResistance(ResistanceType.Energy, 30, 50);
            this.SetResistance(ResistanceType.Poison, 30, 50);

            this.VirtualArmor = 24;</pre>

## Duplicated Code. Size: 157

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Quests.cs

<pre>public class InternalObjective : BaseObjective
        {
            public InternalObjective() : base(5)
            {
            }

            public override bool Update(object o)
            {
                CurProgress++;
                return true;
            }

            public override void Serialize(GenericWriter writer)
            {
                base.Serialize(writer);
                writer.Write((int)0); // version
            }

            public override void Deserialize(GenericReader reader)
            {
                base.Deserialize(reader);
                int version = reader.ReadInt();
            }
        }</pre>

Fragment 2 in file Scripts\Quests\Eodon\Valley of One Quest\Quests.cs

<pre>private class InternalObjective : BaseObjective
        {
            public InternalObjective()
                : base(5)
            {
            }

            public override bool Update(object o)
            {
                CurProgress++;
                return true;
            }

            public override void Serialize(GenericWriter writer)
            {
                base.Serialize(writer);

                writer.Write((int)0); // version
            }

            public override void Deserialize(GenericReader reader)
            {
                base.Deserialize(reader);

                int version = reader.ReadInt();
            }
        }</pre>

Fragment 3 in file Scripts\Quests\Eodon\Valley of One Quest\Quests.cs

<pre>public class InternalObjective : BaseObjective
        {
            public InternalObjective()
                : base(5)
            {
            }

            public override bool Update(object o)
            {
                CurProgress++;
                return true;
            }

            public override void Serialize(GenericWriter writer)
            {
                base.Serialize(writer);
                writer.Write((int)0); // version
            }

            public override void Deserialize(GenericReader reader)
            {
                base.Deserialize(reader);
                int version = reader.ReadInt();
            }
        }</pre>

## Duplicated Code. Size: 156

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Noble.cs

<pre>int lowHue = GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new ThighBoots(lowHue));
            else
                this.AddItem(new Boots(lowHue));

            if (!this.Female)
                this.AddItem(new BodySash(lowHue));

            this.AddItem(new Cloak(GetRandomHue()));</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\SeekerOfAdventure.cs

<pre>int lowHue = GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new ThighBoots(lowHue));
            else
                this.AddItem(new Boots(lowHue));

            if (!this.Female)
                this.AddItem(new BodySash(lowHue));

            this.AddItem(new Cloak(GetRandomHue()));</pre>

## Duplicated Code. Size: 156

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestLeaders.cs

<pre>m_attachment = attachment;

				int numberToDisplay = 20;
				int height = numberToDisplay*20 + 65;

				// prepare the page
				AddPage( 0 );

				int width = 740;
#if(FACTIONS)
				width = 790;
#endif

				AddBackground( 0, 0, width, height, 5054 );
				AddAlphaRegion( 0, 0, width, height );
				AddImageTiled( 20, 20, width - 40, height - 45, 0xBBC );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>m_attachment = attachment;

				int numberToDisplay = 20;
				int height = numberToDisplay*20 + 65;

				// prepare the page
				AddPage( 0 );

				int width = 740;
#if(FACTIONS)
				width = 790;
#endif

				AddBackground( 0, 0, width, height, 5054 );
				AddAlphaRegion( 0, 0, width, height );
				AddImageTiled( 20, 20, width - 40, height - 45, 0xBBC );</pre>

## Duplicated Code. Size: 156

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>requiresurface = false;
								int start = -1;
								int end = -1;
								if (positionargs != null && positionargs.Length > 1)
								{
									try
									{
										start = int.Parse(positionargs[1]);
									}
									catch { }
								}
								if (positionargs != null && positionargs.Length > 2)
								{
									try
									{
										end = int.Parse(positionargs[2]);
									}
									catch { }
								}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>requiresurface = false;
								int start = -1;
								int end = -1;
								if (positionargs != null && positionargs.Length > 1)
								{
									try
									{
										start = int.Parse(positionargs[1]);
									}
									catch { }
								}
								if (positionargs != null && positionargs.Length > 2)
								{
									try
									{
										end = int.Parse(positionargs[2]);
									}
									catch { }
								}</pre>

## Duplicated Code. Size: 156

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Glasses\GargishGlasses.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Glasses\Glasses.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version			

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Glasses\ElvenGlasses.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\BandanaBearingTheCrestOfBlackthorn.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\BascinetBearingTheCrestOfBlackthorn.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\CircletBearingTheCrestOfBlackthorn.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 7 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\FeatheredHatBearingTheCrestOfBlackthorn.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 8 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\GargishEarringsBearingTheCrestOfBlackthorn.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 9 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\JesterHatBearingTheCrestOfBlackthorn.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 10 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\NorseHelmBearingTheCrestOfBlackthorn.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 11 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\PlateHelmBearingTheCrestOfBlackthorn.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 12 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\RoyalCircletBearingTheCrestOfBlackthorn.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 13 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\SkullcapBearingTheCrestOfBlackthorn.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 14 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\TricorneHatBearingTheCrestOfBlackthorn.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 15 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\WizardsHatBearingTheCrestOfBlackthorn.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 16 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Loot\BracersofAlchemicalDevastation.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

Fragment 17 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Loot\GargishBracersofAlchemicalDevastation.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            SaveFlag flags = SaveFlag.None;

            SetSaveFlag(ref flags, SaveFlag.WeaponAttributes, !this.m_AosWeaponAttributes.IsEmpty);

            writer.Write((int)flags);

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes.Serialize(writer);
        }</pre>

## Duplicated Code. Size: 155

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\ArcheryButteAddon.cs

<pre>this.PublicOverheadMessage(MessageType.Regular, 0x3B2, 500604, from.Name); // You miss the target altogether.

                    se.Record(0);

                    if (se.Count == 1)
                        this.PublicOverheadMessage(MessageType.Regular, 0x3B2, 1062719, se.Total.ToString());
                    else
                        this.PublicOverheadMessage(MessageType.Regular, 0x3B2, 1042683, String.Format("{0}\t{1}", se.Total, se.Count));

                    return;</pre>

Fragment 2 in file Scripts\Items\Addons\ArcheryButteAddon.cs

<pre>this.PublicOverheadMessage(MessageType.Regular, 0x3B2, 500604, from.Name); // You miss the target altogether.

                    se.Record(0);

                    if (se.Count == 1)
                        this.PublicOverheadMessage(MessageType.Regular, 0x3B2, 1062719, se.Total.ToString());
                    else
                        this.PublicOverheadMessage(MessageType.Regular, 0x3B2, 1042683, String.Format("{0}\t{1}", se.Total, se.Count));

                    return;</pre>

## Duplicated Code. Size: 155

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Wreath.cs

<pre>private void FixMovingCrate()
        {
            if (this.Deleted)
                return;

            if (this.Movable || this.IsLockedDown)
            {
                Item deed = this.Deed;

                if (this.Parent is Item)
                {
                    ((Item)this.Parent).AddItem(deed);
                    deed.Location = this.Location;
                }
                else
                {
                    deed.MoveToWorld(this.Location, this.Map);
                }

                this.Delete();
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\Mistletoe.cs

<pre>private void FixMovingCrate()
        {
            if (this.Deleted)
                return;

            if (this.Movable || this.IsLockedDown)
            {
                Item deed = this.Deed;

                if (this.Parent is Item)
                {
                    ((Item)this.Parent).AddItem(deed);
                    deed.Location = this.Location;
                }
                else
                {
                    deed.MoveToWorld(this.Location, this.Map);
                }

                this.Delete();
            }
        }</pre>

## Duplicated Code. Size: 155

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefInscription.cs

<pre>{
            typeof( BlackPearl ),
			typeof( Bloodmoss ),
			typeof( Garlic ),
			typeof( Ginseng ),
			typeof( MandrakeRoot ),
			typeof( Nightshade ),
			typeof( SulfurousAsh ),	
			typeof( SpidersSilk ),
            typeof( BatWing ),
            typeof( GraveDust ),
            typeof( DaemonBlood ),
            typeof( NoxCrystal ),
            typeof( PigIron ),
			typeof( Bone ),
			typeof( DragonBlood ),
			typeof( FertileDirt ),
			typeof( DaemonBone )			
        }</pre>

Fragment 2 in file Scripts\Spells\Reagent.cs

<pre>{
            typeof(BlackPearl),
            typeof(Bloodmoss),
            typeof(Garlic),
            typeof(Ginseng),
            typeof(MandrakeRoot),
            typeof(Nightshade),
            typeof(SulfurousAsh),
            typeof(SpidersSilk),
            typeof(BatWing),
            typeof(GraveDust),
            typeof(DaemonBlood),
            typeof(NoxCrystal),
            typeof(PigIron),
            typeof(Bone),
            typeof(DragonBlood),
            typeof(FertileDirt),
            typeof(DaemonBone)
        }</pre>

## Duplicated Code. Size: 155

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\Hephaestus.cs

<pre>{
            Hue = 1910;
            Attributes.SpellChanneling = 1;
            Attributes.ReflectPhysical = 15;
            Attributes.DefendChance = 15;
            Attributes.CastSpeed = 1;
            Attributes.LowerManaCost = 8;

            PhysicalBonus = 15;
            ArmorAttributes.SelfRepair = 5;

            SkillBonuses.SetValues(0, SkillName.Parry, 10.0);

            if (antique)
            {
                MaxHitPoints = 250;
                NegativeAttributes.Antique = 1;
            }
            else
                MaxHitPoints = 255;

            HitPoints = MaxHitPoints;
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\Hephaestus.cs

<pre>{
            Hue = 1910;
            Attributes.SpellChanneling = 1;
            Attributes.ReflectPhysical = 15;
            Attributes.DefendChance = 15;
            Attributes.CastSpeed = 1;
            Attributes.LowerManaCost = 8;

            PhysicalBonus = 15;
            ArmorAttributes.SelfRepair = 5;

            SkillBonuses.SetValues(0, SkillName.Parry, 10.0);

            if (antique)
            {
                MaxHitPoints = 250;
                NegativeAttributes.Antique = 1;
            }
            else
                MaxHitPoints = 255;

            HitPoints = MaxHitPoints;
        }</pre>

## Duplicated Code. Size: 155

### Duplicated Fragments:

Fragment 1 in file Server\MultiData.cs

<pre>{
						var newList = new MultiTileEntry[oldList.Length - 1];

						for (int j = 0; j < i; ++j)
						{
							newList[j] = oldList[j];
						}

						for (int j = i + 1; j < oldList.Length; ++j)
						{
							newList[j - 1] = oldList[j];
						}

						m_List = newList;

						break;
					}</pre>

Fragment 2 in file Server\MultiData.cs

<pre>{
						var newList = new MultiTileEntry[oldList.Length - 1];

						for (int j = 0; j < i; ++j)
						{
							newList[j] = oldList[j];
						}

						for (int j = i + 1; j < oldList.Length; ++j)
						{
							newList[j - 1] = oldList[j];
						}

						m_List = newList;

						break;
					}</pre>

## Duplicated Code. Size: 154

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetObjectGump.cs

<pre>this.AddPage(0);

            this.AddBackground(0, 0, BackWidth, BackHeight, BackGumpID);
            this.AddImageTiled(BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), TotalHeight, OffsetGumpID);

            int x = BorderSize + OffsetSize;
            int y = BorderSize + OffsetSize;

            this.AddImageTiled(x, y, EntryWidth, EntryHeight, EntryGumpID);</pre>

Fragment 2 in file Scripts\Gumps\SkillsGump.cs

<pre>this.AddPage(0);

            this.AddBackground(0, 0, BackWidth, BackHeight, BackGumpID);
            this.AddImageTiled(BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), TotalHeight, OffsetGumpID);

            int x = BorderSize + OffsetSize;
            int y = BorderSize + OffsetSize;

            this.AddImageTiled(x, y, EntryWidth, EntryHeight, EntryGumpID);</pre>

## Duplicated Code. Size: 154

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\MilitiaFighter.cs

<pre>switch ( Utility.Random(6) )
            {
                case 0:
                    weapon = new Broadsword();
                    break;
                case 1:
                    weapon = new Cutlass();
                    break;
                case 2:
                    weapon = new Katana();
                    break;
                case 3:
                    weapon = new Longsword();
                    break;
                case 4:
                    weapon = new Scimitar();
                    break;
                default:
                    weapon = new VikingSword();
                    break;
            }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Uzeraan.cs

<pre>switch ( Utility.Random(6) )
                                {
                                    case 0:
                                        weapon = new Broadsword();
                                        break;
                                    case 1:
                                        weapon = new Cutlass();
                                        break;
                                    case 2:
                                        weapon = new Katana();
                                        break;
                                    case 3:
                                        weapon = new Longsword();
                                        break;
                                    case 4:
                                        weapon = new Scimitar();
                                        break;
                                    default:
                                        weapon = new VikingSword();
                                        break;
                                }</pre>

## Duplicated Code. Size: 154

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\ElwoodMcCarrin.cs

<pre>BaseWeapon weapon = Loot.RandomWeapon();

                if (Core.AOS)
                {
                    BaseRunicTool.ApplyAttributesTo(weapon, 2, 20, 30);
                }
                else
                {
                    weapon.DamageLevel = (WeaponDamageLevel)BaseCreature.RandomMinMaxScaled(2, 3);
                    weapon.AccuracyLevel = (WeaponAccuracyLevel)BaseCreature.RandomMinMaxScaled(2, 3);
                    weapon.DurabilityLevel = (WeaponDurabilityLevel)BaseCreature.RandomMinMaxScaled(2, 3);
                }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Grizelda.cs

<pre>BaseWeapon weapon = Loot.RandomWeapon();

                                    if (Core.AOS)
                                    {
                                        BaseRunicTool.ApplyAttributesTo(weapon, 2, 20, 30);
                                    }
                                    else
                                    {
                                        weapon.DamageLevel = (WeaponDamageLevel)BaseCreature.RandomMinMaxScaled(2, 3);
                                        weapon.AccuracyLevel = (WeaponAccuracyLevel)BaseCreature.RandomMinMaxScaled(2, 3);
                                        weapon.DurabilityLevel = (WeaponDurabilityLevel)BaseCreature.RandomMinMaxScaled(2, 3);
                                    }</pre>

## Duplicated Code. Size: 154

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Jun.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Backpack());
            this.AddItem(new SamuraiTabi());
            this.AddItem(new LeatherNinjaPants());
            this.AddItem(new LeatherNinjaHood());
            this.AddItem(new LeatherNinjaBelt());
            this.AddItem(new LeatherNinjaMitts());
            this.AddItem(new LeatherNinjaJacket());
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Ryuichi.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Backpack());
            this.AddItem(new SamuraiTabi());
            this.AddItem(new LeatherNinjaPants());
            this.AddItem(new LeatherNinjaHood());
            this.AddItem(new LeatherNinjaBelt());
            this.AddItem(new LeatherNinjaMitts());
            this.AddItem(new LeatherNinjaJacket());
        }</pre>

## Duplicated Code. Size: 154

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\LargeBOD.cs

<pre>public static BulkMaterialType GetRandomMaterial(BulkMaterialType start, double[] chances)
        {
            double random = Utility.RandomDouble();

            for (int i = 0; i < chances.Length; ++i)
            {
                if (random < chances[i])
                    return (i == 0 ? BulkMaterialType.None : start + (i - 1));

                random -= chances[i];
            }

            return BulkMaterialType.None;
        }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallBOD.cs

<pre>public static BulkMaterialType GetRandomMaterial(BulkMaterialType start, double[] chances)
        {
            double random = Utility.RandomDouble();

            for (int i = 0; i < chances.Length; ++i)
            {
                if (random < chances[i])
                    return (i == 0 ? BulkMaterialType.None : start + (i - 1));

                random -= chances[i];
            }

            return BulkMaterialType.None;
        }</pre>

## Duplicated Code. Size: 154

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>int nentries = reader.ReadInt();

						if (nentries > 0)
						{
							m_Journal = new List<XmlQuest.JournalEntry>();
							for (int i = 0; i < nentries; i++)
							{
								string entryID = reader.ReadString();
								string entryText = reader.ReadString();
								m_Journal.Add(new XmlQuest.JournalEntry(entryID, entryText));
							}
						}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>int nentries = reader.ReadInt();

                        if (nentries > 0)
                        {
                            m_Journal = new List<XmlQuest.JournalEntry>();
                            for (int i = 0; i < nentries; i++)
                            {
                                string entryID = reader.ReadString();
                                string entryText = reader.ReadString();
                                m_Journal.Add(new XmlQuest.JournalEntry(entryID, entryText));
                            }
                        }</pre>

## Duplicated Code. Size: 154

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\Core\Repair.cs

<pre>SkillName skill = this.m_CraftSystem.MainSkill;
                    int toWeaken = 0;

                    if (Core.AOS)
                    {
                        toWeaken = 1;
                    }
                    else if (skill != SkillName.Tailoring)
                    {
                        double skillLevel = (usingDeed) ? this.m_Deed.SkillLevel : from.Skills[skill].Base;

                        if (skillLevel >= 90.0)
                            toWeaken = 1;
                        else if (skillLevel >= 70.0)
                            toWeaken = 2;
                        else
                            toWeaken = 3;
                    }</pre>

Fragment 2 in file Scripts\Services\Craft\Core\Repair.cs

<pre>SkillName skill = this.m_CraftSystem.MainSkill;
                    int toWeaken = 0;

                    if (Core.AOS)
                    {
                        toWeaken = 1;
                    }
                    else if (skill != SkillName.Tailoring)
                    {
                        double skillLevel = (usingDeed) ? this.m_Deed.SkillLevel : from.Skills[skill].Base;

                        if (skillLevel >= 90.0)
                            toWeaken = 1;
                        else if (skillLevel >= 70.0)
                            toWeaken = 2;
                        else
                            toWeaken = 3;
                    }</pre>

Fragment 3 in file Scripts\Services\Craft\Core\Repair.cs

<pre>SkillName skill = this.m_CraftSystem.MainSkill;
                    int toWeaken = 0;

                    if (Core.AOS)
                    {
                        toWeaken = 1;
                    }
                    else if (skill != SkillName.Tailoring)
                    {
                        double skillLevel = (usingDeed) ? this.m_Deed.SkillLevel : from.Skills[skill].Base;

                        if (skillLevel >= 90.0)
                            toWeaken = 1;
                        else if (skillLevel >= 70.0)
                            toWeaken = 2;
                        else
                            toWeaken = 3;
                    }</pre>

Fragment 4 in file Scripts\Services\Craft\Core\Repair.cs

<pre>SkillName skill = this.m_CraftSystem.MainSkill;
                    int toWeaken = 0;

                    if (Core.AOS)
                    {
                        toWeaken = 1;
                    }
                    else if (skill != SkillName.Tailoring)
                    {
                        double skillLevel = (usingDeed) ? this.m_Deed.SkillLevel : from.Skills[skill].Base;

                        if (skillLevel >= 90.0)
                            toWeaken = 1;
                        else if (skillLevel >= 70.0)
                            toWeaken = 2;
                        else
                            toWeaken = 3;
                    }</pre>

## Duplicated Code. Size: 154

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>{
						/*You are attempting to cancel your stall bid of ~1_OLDBID~gp. The bid cannot 
						 *be refunded to your bank account, because your bank box cannot hold the additional 
						 *funds. Your current bank balance is ~4_OLDVAL~gp.<br><br>Your bid status has not 
						 changed.*/
						cliloc1 = 1150575;
						args1 = String.Format("{0}\t{1}\t{2}\t{3}", FormatAmt(oldBid), "", "", FormatAmt(bankBal));

						if(hasbidspecific)
						{
							// You are still bidding on Stall ~2_NEWSTALL~.
							cliloc2 = 1150583;
							args2 = String.Format("{0}\t{1}", "", oldPlot.PlotDef.ID);
						}
						else if(hasbidnextavailable)
						{
							// You are still bidding on the next available stall.
							cliloc2 = 1150581;
							args2 = null;
						}
						else
						{
							cliloc2 = 1150541;
							args2 = "You have no active bids.";
						}
					}</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>{
						/*You are attempting to cancel your stall bid of ~1_OLDBID~gp. The bid cannot 
						 *be refunded to your bank account, because your bank box cannot hold the additional 
						 *funds. Your current bank balance is ~4_OLDVAL~gp.<br><br>Your bid status has not 
						 changed.*/
						cliloc1 = 1150575;
						args1 = String.Format("{0}\t{1}\t{2}\t{3}", FormatAmt(oldBid), "", "", FormatAmt(bankBal));

						if(hasbidspecific)
						{
							// You are still bidding on Stall ~2_NEWSTALL~.
							cliloc2 = 1150583;
							args2 = String.Format("{0}\t{1}", "", oldPlot.PlotDef.ID);
						}
						else if(hasbidnextavailable)
						{
							// You are still bidding on the next available stall.
							cliloc2 = 1150581;
							args2 = null;
						}
						else
						{
							cliloc2 = 1150541;
							args2 = "You have no active bids.";
						}
					}</pre>

Fragment 3 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>{
						/*You are attempting to cancel your stall bid of ~1_OLDBID~gp. The bid cannot 
						 *be refunded to your bank account, because your bank box cannot hold the additional 
						 *funds. Your current bank balance is ~4_OLDVAL~gp.<br><br>Your bid status has not 
						 changed.*/
						cliloc1 = 1150575;
						args1 = String.Format("{0}\t{1}\t{2}\t{3}", FormatAmt(oldBid), "", "", FormatAmt(bankBal));

						if(hasbidspecific)
						{
							// You are still bidding on Stall ~2_NEWSTALL~.
							cliloc2 = 1150583;
							args2 = String.Format("{0}\t{1}", "", oldPlot.PlotDef.ID);
						}
						else if(hasbidnextavailable)
						{
							// You are still bidding on the next available stall.
							cliloc2 = 1150581;
							args2 = null;
						}
						else
						{
							cliloc2 = 1150541;
							args2 = "You have no active bids.";
						}
					}</pre>

Fragment 4 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>{
						/*You are attempting to cancel your stall bid of ~1_OLDBID~gp. The bid cannot 
						 *be refunded to your bank account, because your bank box cannot hold the additional 
						 *funds. Your current bank balance is ~4_OLDVAL~gp.<br><br>Your bid status has not 
						 changed.*/
						cliloc1 = 1150575;
						args1 = String.Format("{0}\t{1}\t{2}\t{3}", FormatAmt(oldBid), "", "", FormatAmt(bankBal));

						if(hasbidspecific)
						{
							// You are still bidding on Stall ~2_NEWSTALL~.
							cliloc2 = 1150583;
							args2 = String.Format("{0}\t{1}", "", oldPlot.PlotDef.ID);
						}
						else if(hasbidnextavailable)
						{
							// You are still bidding on the next available stall.
							cliloc2 = 1150581;
							args2 = null;
						}
						else
						{
							cliloc2 = 1150541;
							args2 = "You have no active bids.";
						}
					}</pre>

## Duplicated Code. Size: 154

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>dictionary = new Dictionary<Point3D, int>();
                dictionary[new Point3D(-1, 0, 0)] = 2272;
                dictionary[new Point3D(0, 0, 0)] = 2272;
                dictionary[new Point3D(2, 0, 0)] = 2272;
                dictionary[new Point3D(1, 0, 0)] = 2272;</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>dictionary = new Dictionary<Point3D, int>();
                dictionary[new Point3D(-1, 0, 0)] = 2272;
                dictionary[new Point3D(0, 0, 0)] = 2272;
                dictionary[new Point3D(2, 0, 0)] = 2272;
                dictionary[new Point3D(1, 0, 0)] = 2272;</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>dictionary = new Dictionary<Point3D, int>();
                dictionary[new Point3D(0, -1, 0)] = 2272;
                dictionary[new Point3D(0, 0, 0)] = 2272;
                dictionary[new Point3D(0, 1, 0)] = 2272;
                dictionary[new Point3D(0, 2, 0)] = 2272;</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>dictionary = new Dictionary<Point3D, int>();
                dictionary[new Point3D(0, -1, 0)] = 2272;
                dictionary[new Point3D(0, 0, 0)] = 2272;
                dictionary[new Point3D(0, 1, 0)] = 2272;
                dictionary[new Point3D(0, 2, 0)] = 2272;</pre>

## Duplicated Code. Size: 153

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DoorGenDelete.cs

<pre>public static bool IsEastFrame(int x, int y, int z)
        {
            StaticTile[] tiles = m_Map.Tiles.GetStaticTiles(x, y);

            for (int i = 0; i < tiles.Length; ++i)
            {
                StaticTile tile = tiles[i];

                if (tile.Z == z && IsEastFrame(tile.ID))
                    return true;
            }

            return false;
        }</pre>

Fragment 2 in file Scripts\Commands\DoorGenerator.cs

<pre>public static bool IsEastFrame(int x, int y, int z)
        {
            StaticTile[] tiles = m_Map.Tiles.GetStaticTiles(x, y);

            for (int i = 0; i < tiles.Length; ++i)
            {
                StaticTile tile = tiles[i];

                if (tile.Z == z && IsEastFrame(tile.ID))
                    return true;
            }

            return false;
        }</pre>

## Duplicated Code. Size: 153

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DoorGenDelete.cs

<pre>public static bool IsSouthFrame(int x, int y, int z)
        {
            StaticTile[] tiles = m_Map.Tiles.GetStaticTiles(x, y);

            for (int i = 0; i < tiles.Length; ++i)
            {
                StaticTile tile = tiles[i];

                if (tile.Z == z && IsSouthFrame(tile.ID))
                    return true;
            }

            return false;
        }</pre>

Fragment 2 in file Scripts\Commands\DoorGenerator.cs

<pre>public static bool IsSouthFrame(int x, int y, int z)
        {
            StaticTile[] tiles = m_Map.Tiles.GetStaticTiles(x, y);

            for (int i = 0; i < tiles.Length; ++i)
            {
                StaticTile tile = tiles[i];

                if (tile.Z == z && IsSouthFrame(tile.ID))
                    return true;
            }

            return false;
        }</pre>

## Duplicated Code. Size: 153

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\HouseGump.cs

<pre>this.AddPage(0);

            this.AddBackground(0, 0, 420, 430, 5054);
            this.AddBackground(10, 10, 400, 410, 3000);

            this.AddButton(20, 388, 4005, 4007, 0, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(55, 388, 300, 20, 1011104, false, false); // Return to previous menu</pre>

Fragment 2 in file Scripts\Gumps\HouseGump.cs

<pre>this.AddPage(0);

            this.AddBackground(0, 0, 420, 430, 5054);
            this.AddBackground(10, 10, 400, 410, 3000);

            this.AddButton(20, 388, 4005, 4007, 0, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(55, 388, 300, 20, 1011104, false, false); // Return to previous menu</pre>

## Duplicated Code. Size: 153

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>{
                            int secs = (int)Math.Max(1, Math.Max(8, defender.Skills[SkillName.EvalInt].Value / 10) - attacker.Skills[SkillName.MagicResist].Value / 10);

                            attacker.Paralyze(TimeSpan.FromSeconds(secs));
                            attacker.PlaySound(0x204);
                            attacker.FixedEffect(0x376A, 6, 1);
                        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>{
                        int secs = (int)Math.Max(1, Math.Max(8, defender.Skills[SkillName.EvalInt].Value / 10) - attacker.Skills[SkillName.MagicResist].Value / 10);

                        attacker.Paralyze(TimeSpan.FromSeconds(secs));
                        attacker.PlaySound(0x204);
                        attacker.FixedEffect(0x376A, 6, 1);
                    }</pre>

## Duplicated Code. Size: 153

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Morganna.cs

<pre>{ 
            this.SetSkill(SkillName.Magery, 120.0, 120.0);
            this.SetSkill(SkillName.MagicResist, 120.0, 120.0);
            this.SetSkill(SkillName.SpiritSpeak, 120.0, 120.0);
            this.SetSkill(SkillName.Swords, 120.0, 120.0);
            this.SetSkill(SkillName.Meditation, 120.0, 120.0);
            this.SetSkill(SkillName.Necromancy, 120.0, 120.0);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Mulcivikh.cs

<pre>{ 
            this.SetSkill(SkillName.Magery, 120.0, 120.0);
            this.SetSkill(SkillName.MagicResist, 120.0, 120.0);
            this.SetSkill(SkillName.SpiritSpeak, 120.0, 120.0);
            this.SetSkill(SkillName.Swords, 120.0, 120.0);
            this.SetSkill(SkillName.Meditation, 120.0, 120.0);
            this.SetSkill(SkillName.Necromancy, 120.0, 120.0);
        }</pre>

## Duplicated Code. Size: 153

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Ranger.cs

<pre>{
            this.SetSkill(SkillName.Camping, 55.0, 78.0);
            this.SetSkill(SkillName.DetectHidden, 65.0, 88.0);
            this.SetSkill(SkillName.Hiding, 45.0, 68.0);
            this.SetSkill(SkillName.Archery, 65.0, 88.0);
            this.SetSkill(SkillName.Tracking, 65.0, 88.0);
            this.SetSkill(SkillName.Veterinary, 60.0, 83.0);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Thief.cs

<pre>{
            this.SetSkill(SkillName.Camping, 55.0, 78.0);
            this.SetSkill(SkillName.DetectHidden, 65.0, 88.0);
            this.SetSkill(SkillName.Hiding, 45.0, 68.0);
            this.SetSkill(SkillName.Archery, 65.0, 88.0);
            this.SetSkill(SkillName.Tracking, 65.0, 88.0);
            this.SetSkill(SkillName.Veterinary, 60.0, 83.0);
        }</pre>

## Duplicated Code. Size: 153

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>int points = this.m_Owner.GetCollectionPoints(this.m_Collection.CollectionID);

            this.AddPage(this.m_Page);

            // title
            this.AddHtmlLocalized(50, 65, 150, 20, 1072843, 0x1, false, false); // Your Reward Points:
            this.AddLabel(230, 65, 0x64, points.ToString());				
            this.AddImageTiled(35, 85, 270, 2, 0x23C5);</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>int points = this.m_Owner.GetCollectionPoints(this.m_Collection.CollectionID);

            this.AddPage(this.m_Page);

            // title
            this.AddHtmlLocalized(50, 65, 150, 20, 1072843, 0x1, false, false); // Your Reward Points:
            this.AddLabel(230, 65, 0x64, points.ToString());

            this.AddImageTiled(35, 85, 270, 2, 0x23C5);</pre>

## Duplicated Code. Size: 153

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Spawners\BountyQuestSpawner.cs

<pre>mapitem = new MapItem();
                mapitem.SetDisplay(5, 5, 5120 - 32, 4096 - 10, 400, 400);

                for (int j = 0; j < SpawnDefinition.PirateTramFelCoursesJhelom[i].Length; j++)
                {
                    Point2D pnt = SpawnDefinition.PirateTramFelCoursesJhelom[i][j];
                    mapitem.AddWorldPin(pnt.X, pnt.Y);
                }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Spawners\BountyQuestSpawner.cs

<pre>mapitem = new MapItem();
                mapitem.SetDisplay(5, 5, 5120 - 32, 4096 - 10, 400, 400);

                for (int j = 0; j < SpawnDefinition.PirateTramFelCoursesJhelom[i].Length; j++)
                {
                    Point2D pnt = SpawnDefinition.PirateTramFelCoursesJhelom[i][j];
                    mapitem.AddWorldPin(pnt.X, pnt.Y);
                }</pre>

## Duplicated Code. Size: 153

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Spawners\BountyQuestSpawner.cs

<pre>mapitem = new MapItem();
                mapitem.SetDisplay(5, 5, 1448 - 32, 1448 - 10, 400, 400);

                for (int j = 0; j < SpawnDefinition.PirateTokunoCourses[i].Length; j++)
                {
                    Point2D pnt = SpawnDefinition.PirateTokunoCourses[i][j];
                    mapitem.AddWorldPin(pnt.X, pnt.Y);
                }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Spawners\BountyQuestSpawner.cs

<pre>mapitem = new MapItem();
                mapitem.SetDisplay(5, 5, 1448 - 32, 1448 - 10, 400, 400);

                for (int j = 0; j < SpawnDefinition.PirateTokunoCourses[i].Length; j++)
                {
                    Point2D pnt = SpawnDefinition.PirateTokunoCourses[i][j];
                    mapitem.AddWorldPin(pnt.X, pnt.Y);
                }</pre>

## Duplicated Code. Size: 153

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 21, 2, 0, 1779, -1, "", 1);// 23
			AddComplexComponent( (BaseAddon) this, 2769, 21, 1, 0, 1779, -1, "", 1);// 24
			AddComplexComponent( (BaseAddon) this, 2769, 20, 2, 0, 1779, -1, "", 1);// 25</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 2, 20, 0, 1779, -1, "", 1);// 325
			AddComplexComponent( (BaseAddon) this, 2769, 2, 21, 0, 1779, -1, "", 1);// 333
			AddComplexComponent( (BaseAddon) this, 2769, 1, 21, 0, 1779, -1, "", 1);// 340</pre>

## Duplicated Code. Size: 153

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\HolyMage.cs

<pre>{
            this.SetSkill(SkillName.EvalInt, 65.0, 88.0);
            this.SetSkill(SkillName.Inscribe, 60.0, 83.0);
            this.SetSkill(SkillName.Magery, 64.0, 100.0);
            this.SetSkill(SkillName.Meditation, 60.0, 83.0);
            this.SetSkill(SkillName.MagicResist, 65.0, 88.0);
            this.SetSkill(SkillName.Wrestling, 36.0, 68.0);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Mage.cs

<pre>{
            this.SetSkill(SkillName.EvalInt, 65.0, 88.0);
            this.SetSkill(SkillName.Inscribe, 60.0, 83.0);
            this.SetSkill(SkillName.Magery, 64.0, 100.0);
            this.SetSkill(SkillName.Meditation, 60.0, 83.0);
            this.SetSkill(SkillName.MagicResist, 65.0, 88.0);
            this.SetSkill(SkillName.Wrestling, 36.0, 68.0);
        }</pre>

Fragment 3 in file Scripts\Services\Factions\Mobiles\Vendors\FactionReagentVendor.cs

<pre>{
            this.SetSkill(SkillName.EvalInt, 65.0, 88.0);
            this.SetSkill(SkillName.Inscribe, 60.0, 83.0);
            this.SetSkill(SkillName.Magery, 64.0, 100.0);
            this.SetSkill(SkillName.Meditation, 60.0, 83.0);
            this.SetSkill(SkillName.MagicResist, 65.0, 88.0);
            this.SetSkill(SkillName.Wrestling, 36.0, 68.0);
        }</pre>

## Duplicated Code. Size: 153

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\AldenArmstrong.cs

<pre>{ 
            this.SetSkill(SkillName.Anatomy, 120.0, 120.0);
            this.SetSkill(SkillName.Parry, 120.0, 120.0);
            this.SetSkill(SkillName.Healing, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Swords, 120.0, 120.0);
            this.SetSkill(SkillName.Focus, 120.0, 120.0);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\AndreasVesalius.cs

<pre>{ 
            this.SetSkill(SkillName.Anatomy, 120.0, 120.0);
            this.SetSkill(SkillName.Parry, 120.0, 120.0);
            this.SetSkill(SkillName.Healing, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Swords, 120.0, 120.0);
            this.SetSkill(SkillName.Focus, 120.0, 120.0);
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Avicenna.cs

<pre>{ 
            this.SetSkill(SkillName.Anatomy, 120.0, 120.0);
            this.SetSkill(SkillName.Parry, 120.0, 120.0);
            this.SetSkill(SkillName.Healing, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Swords, 120.0, 120.0);
            this.SetSkill(SkillName.Focus, 120.0, 120.0);
        }</pre>

Fragment 4 in file Scripts\Mobiles\NPCs\Jockles.cs

<pre>{ 
            this.SetSkill(SkillName.Anatomy, 120.0, 120.0);
            this.SetSkill(SkillName.Parry, 120.0, 120.0);
            this.SetSkill(SkillName.Healing, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Swords, 120.0, 120.0);
            this.SetSkill(SkillName.Focus, 120.0, 120.0);
        }</pre>

Fragment 5 in file Scripts\Mobiles\NPCs\SarsmeaSmythe.cs

<pre>{ 
            this.SetSkill(SkillName.Anatomy, 120.0, 120.0);
            this.SetSkill(SkillName.Parry, 120.0, 120.0);
            this.SetSkill(SkillName.Healing, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Swords, 120.0, 120.0);
            this.SetSkill(SkillName.Focus, 120.0, 120.0);
        }</pre>

## Duplicated Code. Size: 153

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Alefian.cs

<pre>{ 
            this.SetSkill(SkillName.EvalInt, 120.0, 120.0);
            this.SetSkill(SkillName.Inscribe, 120.0, 120.0);
            this.SetSkill(SkillName.Magery, 120.0, 120.0);
            this.SetSkill(SkillName.MagicResist, 120.0, 120.0);
            this.SetSkill(SkillName.Wrestling, 120.0, 120.0);
            this.SetSkill(SkillName.Meditation, 120.0, 120.0);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Dimethro.cs

<pre>{ 
            this.SetSkill(SkillName.EvalInt, 120.0, 120.0);
            this.SetSkill(SkillName.Inscribe, 120.0, 120.0);
            this.SetSkill(SkillName.Magery, 120.0, 120.0);
            this.SetSkill(SkillName.MagicResist, 120.0, 120.0);
            this.SetSkill(SkillName.Wrestling, 120.0, 120.0);
            this.SetSkill(SkillName.Meditation, 120.0, 120.0);
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Gustar.cs

<pre>{ 
            this.SetSkill(SkillName.EvalInt, 120.0, 120.0);
            this.SetSkill(SkillName.Inscribe, 120.0, 120.0);
            this.SetSkill(SkillName.Magery, 120.0, 120.0);
            this.SetSkill(SkillName.MagicResist, 120.0, 120.0);
            this.SetSkill(SkillName.Wrestling, 120.0, 120.0);
            this.SetSkill(SkillName.Meditation, 120.0, 120.0);
        }</pre>

Fragment 4 in file Scripts\Mobiles\NPCs\Jillian.cs

<pre>{ 
            this.SetSkill(SkillName.EvalInt, 120.0, 120.0);
            this.SetSkill(SkillName.Inscribe, 120.0, 120.0);
            this.SetSkill(SkillName.Magery, 120.0, 120.0);
            this.SetSkill(SkillName.MagicResist, 120.0, 120.0);
            this.SetSkill(SkillName.Wrestling, 120.0, 120.0);
            this.SetSkill(SkillName.Meditation, 120.0, 120.0);
        }</pre>

Fragment 5 in file Scripts\Mobiles\NPCs\Kaelynna.cs

<pre>{ 
            this.SetSkill(SkillName.EvalInt, 120.0, 120.0);
            this.SetSkill(SkillName.Inscribe, 120.0, 120.0);
            this.SetSkill(SkillName.Magery, 120.0, 120.0);
            this.SetSkill(SkillName.MagicResist, 120.0, 120.0);
            this.SetSkill(SkillName.Wrestling, 120.0, 120.0);
            this.SetSkill(SkillName.Meditation, 120.0, 120.0);
        }</pre>

Fragment 6 in file Scripts\Mobiles\NPCs\Mithneral.cs

<pre>{ 
            this.SetSkill(SkillName.EvalInt, 120.0, 120.0);
            this.SetSkill(SkillName.Inscribe, 120.0, 120.0);
            this.SetSkill(SkillName.Magery, 120.0, 120.0);
            this.SetSkill(SkillName.MagicResist, 120.0, 120.0);
            this.SetSkill(SkillName.Wrestling, 120.0, 120.0);
            this.SetSkill(SkillName.Meditation, 120.0, 120.0);
        }</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\BaseConflagrationPotion.cs

<pre>SpellHelper.GetSurfaceTop(ref p);

                from.RevealingAction();

                IEntity to;

                if (p is Mobile)
                    to = (Mobile)p;
                else
                    to = new Entity(Serial.Zero, new Point3D(p), from.Map);

                Effects.SendMovingEffect(from, to, 0xF0D, 7, 0, false, false, this.m_Potion.Hue, 0);</pre>

Fragment 2 in file Scripts\Items\Consumables\BaseConfusionBlastPotion.cs

<pre>SpellHelper.GetSurfaceTop(ref p);

                from.RevealingAction();

                IEntity to;

                if (p is Mobile)
                    to = (Mobile)p;
                else
                    to = new Entity(Serial.Zero, new Point3D(p), from.Map);

                Effects.SendMovingEffect(from, to, 0xF0D, 7, 0, false, false, this.m_Potion.Hue, 0);</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\EngravingTools.cs

<pre>this.m_Tool = tool;
                this.m_Target = target;

                this.Closable = true;
                this.Disposable = true;
                this.Dragable = true;
                this.Resizable = false;

                this.AddPage(0);

                this.AddBackground(50, 50, 400, 300, 0xA28);
                this.AddHtmlLocalized(50, 70, 400, 20, 1072359, 0x0, false, false);</pre>

Fragment 2 in file Scripts\Items\Tools\WeaponEngravingTool.cs

<pre>this.m_Tool = tool;
                this.m_Target = target;

                this.Closable = true;
                this.Disposable = true;
                this.Dragable = true;
                this.Resizable = false;

                this.AddBackground(50, 50, 400, 300, 0xA28);

                this.AddPage(0);

                this.AddHtmlLocalized(50, 70, 400, 20, 1072359, 0x0, false, false); // <CENTER>Engraving Tool</CENTER></pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\DeceitBrazier.cs

<pre>int z = this.Map.GetAverageZ(x, y);

                if (this.Map.CanSpawnMobile(new Point2D(x, y), this.Z))
                    return new Point3D(x, y, this.Z);
                else if (this.Map.CanSpawnMobile(new Point2D(x, y), z))
                    return new Point3D(x, y, z);</pre>

Fragment 2 in file Scripts\Multis\Camps\HumanBrigandCamp.cs

<pre>int z = this.Map.GetAverageZ(x, y);

                if (this.Map.CanSpawnMobile(new Point2D(x, y), this.Z))
                    return new Point3D(x, y, this.Z);
                else if (this.Map.CanSpawnMobile(new Point2D(x, y), z))
                    return new Point3D(x, y, z);</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\SlasherOfVeils.cs

<pre>for (int i = 0; i < m_North.Length; i += 2)
            {
                Point3D p = this.Location;

                p.X += m_North[i];
                p.Y += m_North[i + 1];

                IPoint3D po = p as IPoint3D;

                SpellHelper.GetSurfaceTop(ref po);

                Effects.SendLocationEffect(po, this.Map, 0x3E27, 50);
            }</pre>

Fragment 2 in file Scripts\Services\Peerless\BasePeerless.cs

<pre>for (int i = 0; i < m_North.Length; i += 2) 
            {
                Point3D p = this.Location;

                p.X += m_North[i];
                p.Y += m_North[i + 1];

                IPoint3D po = p as IPoint3D;

                SpellHelper.GetSurfaceTop(ref po);

                Effects.SendLocationEffect(po, this.Map, 0x3E27, 50);
            }</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\SlasherOfVeils.cs

<pre>for (int i = 0; i < m_East.Length; i += 2)
            {
                Point3D p = this.Location;

                p.X += m_East[i];
                p.Y += m_East[i + 1];

                IPoint3D po = p as IPoint3D;

                SpellHelper.GetSurfaceTop(ref po);

                Effects.SendLocationEffect(po, this.Map, 0x3E31, 50);
            }</pre>

Fragment 2 in file Scripts\Services\Peerless\BasePeerless.cs

<pre>for (int i = 0; i < m_East.Length; i += 2) 
            {
                Point3D p = this.Location;

                p.X += m_East[i];
                p.Y += m_East[i + 1];

                IPoint3D po = p as IPoint3D;

                SpellHelper.GetSurfaceTop(ref po);

                Effects.SendLocationEffect(po, this.Map, 0x3E31, 50);
            }</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Filbert.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));					
            this.Donations.Add(new CollectionItem(typeof(BlankScroll), 0xEF3, 1044377, 0x0, 1));</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Joy.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));					
            this.Donations.Add(new CollectionItem(typeof(BlankScroll), 0xEF3, 1044377, 0x0, 1));</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Messenger.cs

<pre>if (this.Female)
                this.AddItem(new PlainDress());
            else
                this.AddItem(new Shirt(GetRandomHue()));

            int lowHue = GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new Boots(lowHue));
            else
                this.AddItem(new Shoes(lowHue));</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Peasant.cs

<pre>if (this.Female)
                this.AddItem(new PlainDress());
            else
                this.AddItem(new Shirt(GetRandomHue()));

            int lowHue = GetRandomHue();

            this.AddItem(new ShortPants(lowHue));

            if (this.Female)
                this.AddItem(new Boots(lowHue));
            else
                this.AddItem(new Shoes(lowHue));</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Ninja.cs

<pre>this.SetSkill(SkillName.Swords, 64.0, 85.0);

            this.SpeechHue = Utility.RandomDyedHue();

            this.Hue = Utility.RandomSkinHue();

            if (this.Female = Utility.RandomBool())
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");
            }
            else
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
            }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Samurai.cs

<pre>this.SetSkill(SkillName.Swords, 64.0, 85.0);

            this.SpeechHue = Utility.RandomDyedHue();

            this.Hue = Utility.RandomSkinHue();

            if (this.Female = Utility.RandomBool())
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");
            }
            else
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
            }</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Hawkwind\TimeForLegendsQuest.cs

<pre>AddImage(0, 0, 8000);
            AddImage(20, 37, 8001);
            AddImage(20, 107, 8002);
            AddImage(20, 177, 8001);
            AddImage(20, 247, 8002);
            AddImage(20, 317, 8001);
            AddImage(20, 387, 8002);
            AddImage(20, 457, 8003);</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\Core\SelectMasteryGump.cs

<pre>AddImage(0, 0, 8000);
            AddImage(20, 37, 8001);
            AddImage(20, 107, 8002);
            AddImage(20, 177, 8001);
            AddImage(20, 247, 8002);
            AddImage(20, 317, 8001);
            AddImage(20, 387, 8002);
            AddImage(20, 457, 8003);</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Creatures.cs

<pre>IMount mount = m.Mount;

                if (mount != null)
                {
                    if (m is PlayerMobile)
                        ((PlayerMobile)m).SetMountBlock(BlockMountType.Dazed, TimeSpan.FromSeconds(10), true);
                    else
                        mount.Rider = null;
                }
                else if (m.Flying)
                {
                    ((PlayerMobile)m).SetMountBlock(BlockMountType.Dazed, TimeSpan.FromSeconds(10), true);
                }</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Bosses.cs

<pre>IMount mount = m.Mount;

				if(mount != null)
				{
					if(m is PlayerMobile)
						((PlayerMobile)m).SetMountBlock(BlockMountType.Dazed, TimeSpan.FromSeconds(10), true);
					else
						mount.Rider = null;
				}
				else if (m.Flying)
				{
					((PlayerMobile)m).SetMountBlock(BlockMountType.Dazed, TimeSpan.FromSeconds(10), true);
				}</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\TigerCubEnclosure.cs

<pre>AddButton(453, 245, 10700, 10701, 1, GumpButtonType.Reply, 0); // up

                AddButton(478, 281, 10710, 10711, 2, GumpButtonType.Reply, 0); // right

                AddButton(453, 305, 10720, 10721, 3, GumpButtonType.Reply, 0); // down 

                AddButton(413, 281, 10730, 10731, 4, GumpButtonType.Reply, 0); // left</pre>

Fragment 2 in file Scripts\Services\Underworld\PuzzleRoom\MazePuzzleGump.cs

<pre>AddButton(453, 245, 10700, 10701, 1, GumpButtonType.Reply, 0); // up
            AddButton(478, 281, 10710, 10711, 2, GumpButtonType.Reply, 0); // right
            AddButton(453, 305, 10720, 10721, 3, GumpButtonType.Reply, 0); // down 
            AddButton(413, 281, 10730, 10731, 4, GumpButtonType.Reply, 0); // left</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\BaseCollectionItem.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public long Points
        {
            get
            {
                return this.m_Points;
            }
            set
            { 
                this.m_Points = value; 

                if (this.m_Points < 0)
                    this.m_Points = 0;

                while (this.m_Tier > 0 && this.m_Points < this.PreviousTier)
                    this.DecreaseTier();

                while (this.m_Tier < this.MaxTier && this.m_Points > this.CurrentTier)
                    this.IncreaseTier();

                this.InvalidateProperties(); 
            }
        }</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\BaseCollectionMobile.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public long Points
        {
            get
            {
                return this.m_Points;
            }
            set
            { 
                this.m_Points = value; 

                if (this.m_Points < 0)
                    this.m_Points = 0;

                while (this.m_Tier > 0 && this.m_Points < this.PreviousTier)
                    this.DecreaseTier();

                while (this.m_Tier < this.MaxTier && this.m_Points > this.CurrentTier)
                    this.IncreaseTier();

                this.InvalidateProperties(); 
            }
        }</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\BaseCollectionItem.cs

<pre>public virtual void DonatePet(PlayerMobile player, BaseCreature pet)
        {
            for (int i = 0; i < this.m_Donations.Count; i ++)
                if (this.m_Donations[i].Type == pet.GetType())
                {
                    pet.Delete();
                    this.Donate(player, this.m_Donations[i], 1);
                    return;
                }

            player.SendLocalizedMessage(1073113); // This Collection is not accepting that type of creature.
        }</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\BaseCollectionMobile.cs

<pre>public virtual void DonatePet(PlayerMobile player, BaseCreature pet)
        {
            for (int i = 0; i < this.m_Donations.Count; i ++)
                if (this.m_Donations[i].Type == pet.GetType())
                {
                    pet.Delete();
                    this.Donate(player, this.m_Donations[i], 1);
                    return;
                }

            player.SendLocalizedMessage(1073113); // This Collection is not accepting that type of creature.
        }</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Regions\SeaMarket.cs

<pre>if (player != null && player.Alive && player is PlayerMobile && QuestHelper.GetQuest((PlayerMobile)player, typeof(ProfessionalBountyQuest)) != null)
                    {
                        IPooledEnumerable eable = player.GetMobilesInRange(4);
                        foreach (Mobile mob in eable)
                        {
                            if (mob is BaseVendor || mob is MondainQuester)
                            {
                                TryPirateBlab(player, mob);
                                break;
                            }
                        }
                        eable.Free();
                    }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Regions\SeaMarket.cs

<pre>if (player != null && player.Alive && player is PlayerMobile && QuestHelper.GetQuest((PlayerMobile)player, typeof(ProfessionalBountyQuest)) != null)
                    {
                        IPooledEnumerable eable = player.GetMobilesInRange(4);
                        foreach (Mobile mob in eable)
                        {
                            if (mob is BaseVendor || mob is MondainQuester)
                            {
                                TryPirateBlab(player, mob);
                                break;
                            }
                        }
                        eable.Free();
                    }</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Seventh\EnergyField.cs

<pre>public override bool OnMoveOver(Mobile m)
            {
                int noto;

                if (m is PlayerMobile)
                {
                    noto = Notoriety.Compute(this.m_Caster, m);
                    if (noto == Notoriety.Enemy || noto == Notoriety.Ally)
                        return false;

                    if (m.Map != null && (m.Map.Rules & MapRules.FreeMovement) == 0)
                        return false;
                }
                return base.OnMoveOver(m);
            }</pre>

Fragment 2 in file Scripts\Spells\Third\WallOfStone.cs

<pre>public override bool OnMoveOver(Mobile m)
            {
                int noto;

                if (m is PlayerMobile)
                {
                    noto = Notoriety.Compute(this.m_Caster, m);
                    if (noto == Notoriety.Enemy || noto == Notoriety.Ally)
                        return false;

                    if (m.Map != null && (m.Map.Rules & MapRules.FreeMovement) == 0)
                        return false;
                }
                return base.OnMoveOver(m);
            }</pre>

## Duplicated Code. Size: 152

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\LeatherGloves.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        if (reader.ReadBool())
                        {
                            this.m_CurArcaneCharges = reader.ReadInt();
                            this.m_MaxArcaneCharges = reader.ReadInt();

                            if (this.Hue == 2118)
                                this.Hue = ArcaneGem.DefaultArcaneHue;
                        }

                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        if (reader.ReadBool())
                        {
                            this.m_CurArcaneCharges = reader.ReadInt();
                            this.m_MaxArcaneCharges = reader.ReadInt();

                            if (this.Hue == 2118)
                                this.Hue = ArcaneGem.DefaultArcaneHue;
                        }

                        break;
                    }
            }
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Clothing\Shoes.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        if (reader.ReadBool())
                        {
                            this.m_CurArcaneCharges = reader.ReadInt();
                            this.m_MaxArcaneCharges = reader.ReadInt();

                            if (this.Hue == 2118)
                                this.Hue = ArcaneGem.DefaultArcaneHue;
                        }

                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 151

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Brigand.cs

<pre>if (this.Female = Utility.RandomBool())
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");
                this.AddItem(new Skirt(Utility.RandomNeutralHue()));
            }
            else
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
                this.AddItem(new ShortPants(Utility.RandomNeutralHue()));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ForgottenServant.cs

<pre>if (this.Female = Utility.RandomBool())
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");
                this.AddItem(new Skirt(Utility.RandomNeutralHue()));
            }
            else
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
                this.AddItem(new ShortPants(Utility.RandomNeutralHue()));
            }</pre>

## Duplicated Code. Size: 151

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\SmallSmithBOD.cs

<pre>bool reqExceptional = Utility.RandomBool() || (material == BulkMaterialType.None);

                SmallBulkEntry entry = entries[Utility.Random(entries.Length)];

                this.Hue = hue;
                this.AmountMax = amountMax;
                this.Type = entry.Type;
                this.Number = entry.Number;
                this.Graphic = entry.Graphic;
                this.RequireExceptional = reqExceptional;
                this.Material = material;</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallTailorBOD.cs

<pre>bool reqExceptional = Utility.RandomBool() || (material == BulkMaterialType.None);

                SmallBulkEntry entry = entries[Utility.Random(entries.Length)];

                this.Hue = hue;
                this.AmountMax = amountMax;
                this.Type = entry.Type;
                this.Number = entry.Number;
                this.Graphic = entry.Graphic;
                this.RequireExceptional = reqExceptional;
                this.Material = material;</pre>

## Duplicated Code. Size: 151

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>case 5:
                    {
                        int entries = reader.ReadInt();
                        Mobile m;
                        int damage;
                        for (int i = 0; i < entries; ++i)
                        {
                            m = reader.ReadMobile();
                            damage = reader.ReadInt();

                            if (m == null)
                                continue;

                            this.m_DamageEntries.Add(m, damage);
                        }

                        goto case 4;
                    }
                case 4:</pre>

Fragment 2 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>case 5:
                    {
                        int entries = reader.ReadInt();
                        Mobile m;
                        int damage;
                        for (int i = 0; i < entries; ++i)
                        {
                            m = reader.ReadMobile();
                            damage = reader.ReadInt();

                            if (m == null)
                                continue;

                            this.m_DamageEntries.Add(m, damage);
                        }

                        goto case 4;
                    }
                case 4:</pre>

## Duplicated Code. Size: 151

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>int teamhue = 0;
					if (t.ID > 0)
					{
						teamhue = BaseChallengeGame.TeamColor(t.ID);
					}
					AddLabel(20, yoffset, teamhue, t.ID.ToString());
					AddLabel(75, yoffset, teamhue, t.Members.Count.ToString());
					AddLabel(135, yoffset, teamhue, t.NActive.ToString());</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>int teamhue = 0;
                    if(t.ID > 0)
                    {
                        teamhue = BaseChallengeGame.TeamColor(t.ID);
                    }
        			AddLabel( 20, yoffset, teamhue, t.ID.ToString());
        			AddLabel( 75, yoffset, teamhue, t.Members.Count.ToString());
        			AddLabel( 135, yoffset, teamhue, t.NActive.ToString());</pre>

## Duplicated Code. Size: 151

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetGump.cs

<pre>if (shouldSet)
            {
                try
                {
                    CommandLogging.LogChangeProperty(this.m_Mobile, this.m_Object, this.m_Property.Name, toSet == null ? "(null)" : toSet.ToString());
                    this.m_Property.SetValue(this.m_Object, toSet, null);
                    PropertiesGump.OnValueChanged(this.m_Object, this.m_Property, this.m_Stack);
                }
                catch
                {
                    this.m_Mobile.SendMessage("An exception was caught. The property may not have changed.");
                }
            }</pre>

Fragment 2 in file Scripts\Gumps\Properties\SetObjectGump.cs

<pre>if (shouldSet)
            {
                try
                {
                    CommandLogging.LogChangeProperty(this.m_Mobile, this.m_Object, this.m_Property.Name, toSet == null ? "(null)" : toSet.ToString());
                    this.m_Property.SetValue(this.m_Object, toSet, null);
                    PropertiesGump.OnValueChanged(this.m_Object, this.m_Property, this.m_Stack);
                }
                catch
                {
                    this.m_Mobile.SendMessage("An exception was caught. The property may not have changed.");
                }
            }</pre>

Fragment 3 in file Scripts\Gumps\Properties\SetObjectGump.cs

<pre>if (shouldSet)
                {
                    try
                    {
                        CommandLogging.LogChangeProperty(this.m_Mobile, this.m_Object, this.m_Property.Name, toSet == null ? "(null)" : toSet.ToString());
                        this.m_Property.SetValue(this.m_Object, toSet, null);
                        PropertiesGump.OnValueChanged(this.m_Object, this.m_Property, this.m_Stack);
                    }
                    catch
                    {
                        this.m_Mobile.SendMessage("An exception was caught. The property may not have changed.");
                    }
                }</pre>

## Duplicated Code. Size: 151

### Duplicated Fragments:

Fragment 1 in file Ultima\Art.cs

<pre>BitmapData bd = bmp.LockBits(
								new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.ReadOnly, PixelFormat.Format16bppArgb1555);
							var line = (ushort*)bd.Scan0;
							int delta = bd.Stride >> 1;
							binidx.Write((int)binmul.BaseStream.Position); //lookup
							var length = (int)binmul.BaseStream.Position;</pre>

Fragment 2 in file Ultima\Art.cs

<pre>BitmapData bd = bmp.LockBits(
								new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.ReadOnly, PixelFormat.Format16bppArgb1555);
							var line = (ushort*)bd.Scan0;
							int delta = bd.Stride >> 1;
							binidx.Write((int)binmul.BaseStream.Position); //lookup
							var length = (int)binmul.BaseStream.Position;</pre>

Fragment 3 in file Ultima\Textures.cs

<pre>BitmapData bd = bmp.LockBits(
								new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.ReadOnly, PixelFormat.Format16bppArgb1555);
							var line = (ushort*)bd.Scan0;
							int delta = bd.Stride >> 1;

							binidx.Write((int)binmul.BaseStream.Position); //lookup
							var length = (int)binmul.BaseStream.Position;</pre>

## Duplicated Code. Size: 150

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddImageTiled(20, 25, 200, 2, 10001);
            this.AddImageTiled(20, 45, 200, 2, 10001);
            this.AddImageTiled(20, 70, 200, 2, 10001);
            this.AddImageTiled(20, 95, 200, 2, 10001);
            this.AddImageTiled(20, 120, 200, 2, 10001);</pre>

## Duplicated Code. Size: 150

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Wreath.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                if (this.m_Addon.Deleted)
                    return;

                if (info.ButtonID == 1)
                {
                    if (this.m_From.InRange(this.m_Addon.GetWorldLocation(), 3))
                    {
                        this.m_From.AddToBackpack(this.m_Addon.Deed);
                        this.m_Addon.Delete();
                    }
                    else
                    {
                        this.m_From.SendLocalizedMessage(500295); // You are too far away to do that.
                    }
                }
            }</pre>

Fragment 2 in file Scripts\Items\Decorative\Mistletoe.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                if (this.m_Addon.Deleted)
                    return;

                if (info.ButtonID == 1)
                {
                    if (this.m_From.InRange(this.m_Addon.GetWorldLocation(), 3))
                    {
                        this.m_From.AddToBackpack(this.m_Addon.Deed);
                        this.m_Addon.Delete();
                    }
                    else
                    {
                        this.m_From.SendLocalizedMessage(500295); // You are too far away to do that.
                    }
                }
            }</pre>

## Duplicated Code. Size: 150

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>Mobile active = null, inactive = null;
                    double actPrio = 0.0, inactPrio = 0.0;

                    Mobile comb = this.m_Mobile.Combatant as Mobile;

                    if (comb != null && !comb.Deleted && comb.Alive && !comb.IsDeadBondedPet && this.CanDispel(comb))
                    {
                        active = inactive = comb;
                        actPrio = inactPrio = this.m_Mobile.GetDistanceToSqrt(comb);
                    }</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>Mobile active = null, inactive = null;
                    double actPrio = 0.0, inactPrio = 0.0;

                    Mobile comb = this.m_Mobile.Combatant as Mobile;

                    if (comb != null && !comb.Deleted && comb.Alive && !comb.IsDeadBondedPet && this.CanDispel(comb))
                    {
                        active = inactive = comb;
                        actPrio = inactPrio = this.m_Mobile.GetDistanceToSqrt(comb);
                    }</pre>

## Duplicated Code. Size: 150

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\GrayGoblinMageRenowned.cs

<pre>this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 20, 25);

            this.SetSkill(SkillName.MagicResist, 120.0, 125.0);
            this.SetSkill(SkillName.Tactics, 95.0, 100.0);
            this.SetSkill(SkillName.Wrestling, 100.0, 110.0);</pre>

Fragment 2 in file Scripts\Mobiles\Named\GreenGoblinAlchemistRenowned.cs

<pre>this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 20, 25);

            this.SetSkill(SkillName.MagicResist, 120.0, 125.0);
            this.SetSkill(SkillName.Tactics, 95.0, 100.0);
            this.SetSkill(SkillName.Wrestling, 100.0, 110.0);</pre>

## Duplicated Code. Size: 150

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>private void QuestCompletionAttachment()
		{
			bool complete = IsCompleted;

			// is this quest repeatable
			if ((!Repeatable || NextRepeatable > TimeSpan.Zero) && complete)
			{
				double expiresin = Repeatable ? NextRepeatable.TotalMinutes : 0;

				// then add an attachment indicating that it has already been done
				XmlAttach.AttachTo(Owner, new XmlQuestAttachment(this.Name, expiresin));
			}

			// have quest points been enabled?
			if (XmlQuest.QuestPointsEnabled && complete && !PlayerMade)
			{
				XmlQuestPoints.GiveQuestPoints(Owner, this);
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>private void QuestCompletionAttachment()
        {
            bool complete = IsCompleted;

            // is this quest repeatable
            if ((!Repeatable || NextRepeatable > TimeSpan.Zero) && complete)
            {
                double expiresin = Repeatable ? NextRepeatable.TotalMinutes : 0;

                // then add an attachment indicating that it has already been done
                XmlAttach.AttachTo(Owner, new XmlQuestAttachment(this.Name, expiresin));
            }

            // have quest points been enabled?
            if (XmlQuest.QuestPointsEnabled && complete && !PlayerMade)
            {
                XmlQuestPoints.GiveQuestPoints(Owner, this);
            }
        }</pre>

## Duplicated Code. Size: 150

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\EnglishText.cs

<pre>Add(200229, "Challenge");
            Add(200230, "LMS");
            Add(200231, "Deathmatch");
            Add(200232, "KotH");
            Add(200233, "DeathBall");
            Add(200234, "Team LMS");
            Add(200235, "Team DMatch");
            Add(200236, "Team DBall");
            Add(200237, "Team KotH");
            Add(200238, "CTF");</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\SpanishText.cs

<pre>Add(200229, "Challenge");
            Add(200230, "LMS");
            Add(200231, "Deathmatch");
            Add(200232, "KotH");
            Add(200233, "DeathBall");
            Add(200234, "Team LMS");
            Add(200235, "Team DMatch");
            Add(200236, "Team DBall");
            Add(200237, "Team KotH");
            Add(200238, "CTF");</pre>

## Duplicated Code. Size: 150

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\EnglishText.cs

<pre>Add(200622, "Base");
            Add(200623, "CTF Team Status");
            Add(200630, "Team Deathball Challenge");
            Add(200631, "Deathball Team Status");

            Add(200640, "Faction");
            Add(200649, "Location: {0}");
            Add(200650, "{0} is occupied");

            Add(200660, "Cancel");
            Add(200661, "Duel here");
            Add(100670, "{0} is in combat.");</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\SpanishText.cs

<pre>Add(200622, "Base");
            Add(200623, "CTF Team Status");
            Add(200630, "Team Deathball Challenge");
            Add(200631, "Deathball Team Status");

            Add(200640, "Faction");
            Add(200649, "Location: {0}");
            Add(200650, "{0} is occupied");

            Add(200660, "Cancel");
            Add(200661, "Duel here");
            Add(100670, "{0} is in combat.");</pre>

## Duplicated Code. Size: 150

### Duplicated Fragments:

Fragment 1 in file Server\Utility.cs

<pre>{
					int c = input.ReadByte();

					bytes.Append(c.ToString("X2"));

					if (j != 7)
					{
						bytes.Append(' ');
					}
					else
					{
						bytes.Append("  ");
					}

					if (c >= 0x20 && c < 0x80)
					{
						chars.Append((char)c);
					}
					else
					{
						chars.Append('.');
					}
				}</pre>

Fragment 2 in file Server\Utility.cs

<pre>{
						int c = input.ReadByte();

						bytes.Append(c.ToString("X2"));

						if (j != 7)
						{
							bytes.Append(' ');
						}
						else
						{
							bytes.Append("  ");
						}

						if (c >= 0x20 && c < 0x80)
						{
							chars.Append((char)c);
						}
						else
						{
							chars.Append('.');
						}
					}</pre>

## Duplicated Code. Size: 150

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Knights\KnightsFemalePlateChest.cs

<pre>this.Attributes.BonusHits = 1;

            this.SetAttributes.BonusHits = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1150;
            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Knights\KnightsPlateChest.cs

<pre>this.Attributes.BonusHits = 1;

            this.SetAttributes.BonusHits = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1150;
            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Knights\KnightsPlateLegs.cs

<pre>this.Attributes.BonusHits = 1;

            this.SetAttributes.BonusHits = 6;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.AttackChance = 10;
            this.SetAttributes.DefendChance = 10;

            this.SetHue = 1150;

            this.SetPhysicalBonus = 28;
            this.SetFireBonus = 28;
            this.SetColdBonus = 28;
            this.SetPoisonBonus = 28;
            this.SetEnergyBonus = 28;</pre>

## Duplicated Code. Size: 150

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Assassin\AssassinArms.cs

<pre>{
            this.SetHue = 0x455;

            this.Attributes.BonusStam = 2;
            this.Attributes.WeaponSpeed = 5;		

            this.SetSkillBonuses.SetValues(0, SkillName.Stealth, 30);

            this.SetSelfRepair = 3;

            this.SetAttributes.BonusDex = 12;

            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 4;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Assassin\AssassinChest.cs

<pre>{
            this.SetHue = 0x455;

            this.Attributes.BonusStam = 2;
            this.Attributes.WeaponSpeed = 5;		

            this.SetSkillBonuses.SetValues(0, SkillName.Stealth, 30);

            this.SetSelfRepair = 3;

            this.SetAttributes.BonusDex = 12;

            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 4;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Assassin\AssassinGloves.cs

<pre>{
            this.SetHue = 0x455;

            this.Attributes.BonusStam = 2;
            this.Attributes.WeaponSpeed = 5;		

            this.SetSkillBonuses.SetValues(0, SkillName.Stealth, 30);

            this.SetSelfRepair = 3;

            this.SetAttributes.BonusDex = 12;

            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 4;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Assassin\AssassinLegs.cs

<pre>{
            this.SetHue = 0x455;

            this.Attributes.BonusStam = 2;
            this.Attributes.WeaponSpeed = 5;		

            this.SetSkillBonuses.SetValues(0, SkillName.Stealth, 30);

            this.SetSelfRepair = 3;

            this.SetAttributes.BonusDex = 12;

            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 4;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

## Duplicated Code. Size: 150

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Hunter\HuntersArms.cs

<pre>{
            this.SetHue = 0x483;

            this.Attributes.RegenHits = 1;
            this.Attributes.Luck = 50;

            this.SetAttributes.BonusDex = 10;

            this.SetSkillBonuses.SetValues(0, SkillName.Stealth, 40);

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 4;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Hunter\HuntersGloves.cs

<pre>{
            this.SetHue = 0x483;

            this.Attributes.RegenHits = 1;
            this.Attributes.Luck = 50;

            this.SetAttributes.BonusDex = 10;

            this.SetSkillBonuses.SetValues(0, SkillName.Stealth, 40);

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 4;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Hunter\HuntersLegs.cs

<pre>{
            this.SetHue = 0x483;

            this.Attributes.RegenHits = 1;
            this.Attributes.Luck = 50;

            this.SetAttributes.BonusDex = 10;

            this.SetSkillBonuses.SetValues(0, SkillName.Stealth, 40);

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 4;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Hunter\HuntersTunic.cs

<pre>{
            this.SetHue = 0x483;

            this.Attributes.RegenHits = 1;
            this.Attributes.Luck = 50;

            this.SetAttributes.BonusDex = 10;

            this.SetSkillBonuses.SetValues(0, SkillName.Stealth, 40);

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 4;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

## Duplicated Code. Size: 150

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Grizzle\GrizzleGauntlets.cs

<pre>{
            this.SetHue = 0x278;

            this.ArmorAttributes.MageArmor = 1;
            this.Attributes.BonusHits = 5;
            this.Attributes.NightSight = 1;

            this.SetAttributes.DefendChance = 10;
            this.SetAttributes.BonusStr = 12;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Grizzle\GrizzleGreaves.cs

<pre>{
            this.SetHue = 0x278;

            this.ArmorAttributes.MageArmor = 1;
            this.Attributes.BonusHits = 5;
            this.Attributes.NightSight = 1;

            this.SetAttributes.DefendChance = 10;
            this.SetAttributes.BonusStr = 12;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Grizzle\GrizzleHelm.cs

<pre>{
            this.SetHue = 0x278;

            this.ArmorAttributes.MageArmor = 1;
            this.Attributes.BonusHits = 5;
            this.Attributes.NightSight = 1;

            this.SetAttributes.DefendChance = 10;
            this.SetAttributes.BonusStr = 12;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Grizzle\GrizzleTunic.cs

<pre>{
            this.SetHue = 0x278;

            this.ArmorAttributes.MageArmor = 1;
            this.Attributes.BonusHits = 5;
            this.Attributes.NightSight = 1;

            this.SetAttributes.DefendChance = 10;
            this.SetAttributes.BonusStr = 12;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Grizzle\GrizzleVambraces.cs

<pre>{
            this.SetHue = 0x278;

            this.ArmorAttributes.MageArmor = 1;
            this.Attributes.BonusHits = 5;
            this.Attributes.NightSight = 1;

            this.SetAttributes.DefendChance = 10;
            this.SetAttributes.BonusStr = 12;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 5;
        }</pre>

## Duplicated Code. Size: 150

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Necromancer\DeathArms.cs

<pre>{
            this.SetHue = 0x455;			

            this.Attributes.RegenHits = 1;
            this.Attributes.RegenMana = 1;

            this.SetAttributes.LowerManaCost = 10;

            this.SetSkillBonuses.SetValues(0, SkillName.Necromancy, 10);

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 4;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Necromancer\DeathBoneHelm.cs

<pre>{
            this.SetHue = 0x455;			

            this.Attributes.RegenHits = 1;
            this.Attributes.RegenMana = 1;

            this.SetAttributes.LowerManaCost = 10;

            this.SetSkillBonuses.SetValues(0, SkillName.Necromancy, 10);

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 4;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Necromancer\DeathChest.cs

<pre>{
            this.SetHue = 0x455;			

            this.Attributes.RegenHits = 1;
            this.Attributes.RegenMana = 1;

            this.SetAttributes.LowerManaCost = 10;

            this.SetSkillBonuses.SetValues(0, SkillName.Necromancy, 10);

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 4;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Necromancer\DeathGloves.cs

<pre>{
            this.SetHue = 0x455;			

            this.Attributes.RegenHits = 1;
            this.Attributes.RegenMana = 1;

            this.SetAttributes.LowerManaCost = 10;

            this.SetSkillBonuses.SetValues(0, SkillName.Necromancy, 10);

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 4;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Necromancer\DeathLegs.cs

<pre>{
            this.SetHue = 0x455;			

            this.Attributes.RegenHits = 1;
            this.Attributes.RegenMana = 1;

            this.SetAttributes.LowerManaCost = 10;

            this.SetSkillBonuses.SetValues(0, SkillName.Necromancy, 10);

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 4;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

## Duplicated Code. Size: 149

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddLabel(110, 255, 200, "4/4");
            this.AddButton(10, 255, 0xFAE, 0xFB0, 0, GumpButtonType.Page, 3);

            //Ok, Cancel
            this.AddButton(55, 280, 247, 249, 1, GumpButtonType.Reply, 0);
            this.AddButton(125, 280, 241, 243, 0, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddLabel(110, 255, 200, "4/4");
            this.AddButton(10, 255, 0xFAE, 0xFB0, 0, GumpButtonType.Page, 3);

            //Ok, Cancel
            this.AddButton(55, 280, 247, 249, 1, GumpButtonType.Reply, 0);
            this.AddButton(125, 280, 241, 243, 0, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 149

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>if (m != comb && m.Combatant == this.m_Mobile && this.m_Mobile.InRange(m, Core.ML ? 10 : 12) && this.CanDispel(m))
                    {
                        double prio = this.m_Mobile.GetDistanceToSqrt(m);

                        if (active == null || prio < activePrio)
                        {
                            active = m;
                            activePrio = prio;

                            if (activePrio <= 2)
                                return active;
                        }
                    }</pre>

Fragment 2 in file Scripts\Mobiles\AI\MageAI.cs

<pre>if (m != comb && m.Combatant == this.m_Mobile && this.m_Mobile.InRange(m, Core.ML ? 10 : 12) && this.CanDispel(m))
                    {
                        double prio = this.m_Mobile.GetDistanceToSqrt(m);

                        if (active == null || prio < activePrio)
                        {
                            active = m;
                            activePrio = prio;

                            if (activePrio <= 2)
                                return active;
                        }
                    }</pre>

## Duplicated Code. Size: 149

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DeepSeaSerpent.cs

<pre>this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 15, 20);

            this.SetSkill(SkillName.MagicResist, 60.1, 75.0);
            this.SetSkill(SkillName.Tactics, 60.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 70.0);

            this.Fame = 6000;
            this.Karma = -6000;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SeaSerpent.cs

<pre>this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 15, 20);

            this.SetSkill(SkillName.MagicResist, 60.1, 75.0);
            this.SetSkill(SkillName.Tactics, 60.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 70.0);

            this.Fame = 6000;
            this.Karma = -6000;</pre>

## Duplicated Code. Size: 149

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\EarthElemental.cs

<pre>this.Fame = 3500;
            this.Karma = -3500;

            this.VirtualArmor = 34;
            this.ControlSlots = 2;

            this.PackItem(new FertileDirt(Utility.RandomMinMax(1, 4)));
            this.PackItem(new MandrakeRoot());

            Item ore = new IronOre(5);
            ore.ItemID = 0x19B7;
            this.PackItem(ore);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\EnragedEarthElemental.cs

<pre>this.Fame = 3500;
            this.Karma = -3500;

            this.VirtualArmor = 34;
            this.ControlSlots = 2;

            this.PackItem(new FertileDirt(Utility.RandomMinMax(1, 4)));
            this.PackItem(new MandrakeRoot());

            Item ore = new IronOre(5);
            ore.ItemID = 0x19B7;
            this.PackItem(ore);</pre>

## Duplicated Code. Size: 149

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\Core\CraftItem.cs

<pre>m_ResHue = 0;
				m_ResAmount = 0;
				m_System = craftSystem;

				if (IsQuantityType(types))
				{
					index = ConsumeQuantity(ourPack, types, amounts);
				}
                else if (IsPlantHueType(types))
                {
                    index = ConsumeQuantityByPlantHue(from, craftSystem, ourPack, types, amounts);
                }
                else
                {
                    index = ourPack.ConsumeTotalGrouped(types, amounts, true, OnResourceConsumed, CheckHueGrouping);
                }</pre>

Fragment 2 in file Scripts\Services\Craft\Core\CraftItem.cs

<pre>m_ResHue = 0;
				m_ResAmount = 0;
				m_System = craftSystem;

				if (IsQuantityType(types))
				{
					index = ConsumeQuantity(ourPack, types, amounts);
				}
                else if (IsPlantHueType(types))
                {
                    index = ConsumeQuantityByPlantHue(from, craftSystem, ourPack, types, amounts);
                }
                else
                {
                    index = ourPack.ConsumeTotalGrouped(types, amounts, true, OnResourceConsumed, CheckHueGrouping);
                }</pre>

## Duplicated Code. Size: 149

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>switch (d)
            {
                case Direction.North:
                    xOffset = 0; yOffset = -1; break;
                case Direction.South:
                    xOffset = 0; yOffset = 1; break;
                case Direction.West:
                    xOffset = -1; yOffset = 0; break;
                case Direction.East:
                    xOffset = 1; yOffset = 0; break;
            }

            int xo = xOffset;
            int yo = yOffset;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\BaseShipCaptain.cs

<pre>switch (d)
            {
                case Direction.North:
                    xOffset = 0; yOffset = -1; break;
                case Direction.South:
                    xOffset = 0; yOffset = 1; break;
                case Direction.West:
                    xOffset = -1; yOffset = 0; break;
                case Direction.East:
                    xOffset = 1; yOffset = 0; break;
            }

            int xo = xOffset;
            int yo = yOffset;</pre>

## Duplicated Code. Size: 149

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>shooter.DoHarmful(toHit);
                    AOS.Damage(toHit, shooter, damage, info.PhysicalDamage, info.FireDamage, info.ColdDamage, info.PoisonDamage, info.EnergyDamage);
                    Effects.SendLocationEffect(toHit.Location, toHit.Map, Utility.RandomBool() ? 14000 : 14013, 15, 10);
                    Effects.PlaySound(toHit.Location, toHit.Map, 0x207);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>shooter.DoHarmful(toHit);
                    AOS.Damage(toHit, shooter, damage, info.PhysicalDamage, info.FireDamage, info.ColdDamage, info.PoisonDamage, info.EnergyDamage);
                    Effects.SendLocationEffect(toHit.Location, toHit.Map, Utility.RandomBool() ? 14000 : 14013, 15, 10);
                    Effects.PlaySound(toHit.Location, toHit.Map, 0x207);</pre>

## Duplicated Code. Size: 149

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Ninjitsu\AnimalForm.cs

<pre>public override bool CheckCast()
		{
			if (!Caster.CanBeginAction(typeof(PolymorphSpell)))
			{
				Caster.SendLocalizedMessage(1061628); // You can't do that while polymorphed.
				return false;
			}
			else if (TransformationSpellHelper.UnderTransformation(Caster))
			{
				Caster.SendLocalizedMessage(1063219); // You cannot mimic an animal while in that form.
				return false;
			}
			else if (DisguiseTimers.IsDisguised(Caster))
			{
				Caster.SendLocalizedMessage(1061631); // You can't do that while disguised.
				return false;
			}

			return base.CheckCast();
		}</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\WhiteTigerForm.cs

<pre>public override bool CheckCast()
        {
            if (!Caster.CanBeginAction(typeof(PolymorphSpell)))
            {
                Caster.SendLocalizedMessage(1061628); // You can't do that while polymorphed.
                return false;
            }
            else if (TransformationSpellHelper.UnderTransformation(Caster))
            {
                Caster.SendLocalizedMessage(1063219); // You cannot mimic an animal while in that form.
                return false;
            }
            else if (DisguiseTimers.IsDisguised(Caster))
            {
                Caster.SendLocalizedMessage(1061631); // You can't do that while disguised.
                return false;
            }

            return base.CheckCast();
        }</pre>

## Duplicated Code. Size: 149

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>if (GetSaveFlag(flags, SaveFlag.IntWeight))
                            {
                                weight = reader.ReadEncodedInt();
                            }
                            else if (GetSaveFlag(flags, SaveFlag.WeightNot1or0))
                            {
                                weight = reader.ReadDouble();
                            }
                            else if (GetSaveFlag(flags, SaveFlag.WeightIs0))
                            {
                                weight = 0.0;
                            }
                            else
                            {
                                weight = 1.0;
                            }

                            if (weight != DefaultWeight)
                            {
                                AcquireCompactInfo().m_Weight = weight;
                            }</pre>

Fragment 2 in file Server\Item.cs

<pre>if (GetSaveFlag(flags, SaveFlag.IntWeight))
                        {
                            weight = reader.ReadEncodedInt();
                        }
                        else if (GetSaveFlag(flags, SaveFlag.WeightNot1or0))
                        {
                            weight = reader.ReadDouble();
                        }
                        else if (GetSaveFlag(flags, SaveFlag.WeightIs0))
                        {
                            weight = 0.0;
                        }
                        else
                        {
                            weight = 1.0;
                        }

                        if (weight != DefaultWeight)
                        {
                            AcquireCompactInfo().m_Weight = weight;
                        }</pre>

## Duplicated Code. Size: 149

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>BuyItemState bis = list[i];

				m_Stream.Write(bis.MySerial);
				m_Stream.Write((ushort)bis.ItemID);
				m_Stream.Write((byte)0); //itemid offset
				m_Stream.Write((ushort)bis.Amount);
				m_Stream.Write((short)(i + 1)); //x
				m_Stream.Write((short)1); //y</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>BuyItemState bis = list[i];

				m_Stream.Write(bis.MySerial);
				m_Stream.Write((ushort)bis.ItemID);
				m_Stream.Write((byte)0); //itemid offset
				m_Stream.Write((ushort)bis.Amount);
				m_Stream.Write((short)(i + 1)); //x
				m_Stream.Write((short)1); //y</pre>

## Duplicated Code. Size: 149

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\SAPropEffects.cs

<pre>public static bool IsImmune(Mobile m)
        {
            if (_Immunity == null)
                return false;

            List<Mobile> list = new List<Mobile>(_Immunity.Keys);

            foreach (Mobile mob in list)
            {
                if (_Immunity[mob] < DateTime.UtcNow)
                    _Immunity.Remove(mob);
            }

            ColUtility.Free(list);

            return _Immunity.ContainsKey(m);
        }</pre>

Fragment 2 in file Scripts\Abilities\SAPropEffects.cs

<pre>public static bool IsImmune(Mobile m)
        {
            if (_Immunity == null)
                return false;

            List<Mobile> list = new List<Mobile>(_Immunity.Keys);

            foreach (Mobile mob in list)
            {
                if (_Immunity[mob] < DateTime.UtcNow)
                    _Immunity.Remove(mob);
            }

            ColUtility.Free(list);

            return _Immunity.ContainsKey(m);
        }</pre>

Fragment 3 in file Scripts\Abilities\SAPropEffects.cs

<pre>public static bool IsImmune(Mobile m)
        {
            if (_Immunity == null)
                return false;

            List<Mobile> list = new List<Mobile>(_Immunity.Keys);

            foreach (Mobile mob in list)
            {
                if (_Immunity[mob] < DateTime.UtcNow)
                    _Immunity.Remove(mob);
            }

            ColUtility.Free(list);

            return _Immunity.ContainsKey(m);
        }</pre>

## Duplicated Code. Size: 149

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>private void AddColoredText(int x, int y, int width, int height, string text, int color)
        {
            if (color == 0)
                this.AddHtml(x, y, width, height, text, false, false);
            else
                this.AddHtml(x, y, width, height, this.Color(text, color), false, false);
        }</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>private void AddColoredText(int x, int y, int width, int height, string text, int color)
        {
            if (color == 0)
                this.AddHtml(x, y, width, height, text, false, false);
            else
                this.AddHtml(x, y, width, height, this.Color(text, color), false, false);
        }</pre>

Fragment 3 in file Scripts\Services\ConPVP\Tournament.cs

<pre>private void AddColoredText(int x, int y, int width, int height, string text, int color)
        {
            if (color == 0)
                this.AddHtml(x, y, width, height, text, false, false);
            else
                this.AddHtml(x, y, width, height, this.Color(text, color), false, false);
        }</pre>

## Duplicated Code. Size: 148

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SignGenDelete.cs

<pre>SignEntry e = list[i];
                    Map[] maps = null;

                    switch ( e.m_Map )
                    {
                        case 0:
                            maps = brit;
                            break; // Trammel and Felucca
                        case 1:
                            maps = fel;
                            break;  // Felucca
                        case 2:
                            maps = tram;
                            break; // Trammel
                        case 3:
                            maps = ilsh;
                            break; // Ilshenar
                        case 4:
                            maps = malas;
                            break; // Malas
                        case 5:
                            maps = tokuno;
                            break; // Tokuno Islands
                    }</pre>

Fragment 2 in file Scripts\Commands\SignParser.cs

<pre>SignEntry e = list[i];
                Map[] maps = null;

                switch ( e.m_Map )
                {
                    case 0:
                        maps = brit;
                        break; // Trammel and Felucca
                    case 1:
                        maps = fel;
                        break;  // Felucca
                    case 2:
                        maps = tram;
                        break; // Trammel
                    case 3:
                        maps = ilsh;
                        break; // Ilshenar
                    case 4:
                        maps = malas;
                        break; // Malas
                    case 5:
                        maps = tokuno;
                        break; // Tokuno Islands
                }</pre>

## Duplicated Code. Size: 148

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Luck\EtoileBleue.cs

<pre>{
			this.Weight = 1.0;
            this.Hue = 1165;

            this.Attributes.Luck = 150;
            this.Attributes.CastSpeed = 1;
            this.Attributes.CastRecovery = 1;

            this.SetHue = 1165;
            this.SetAttributes.Luck = 100;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.CastSpeed = 1;
            this.SetAttributes.CastRecovery = 4;
		}</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Luck\NovoBleue.cs

<pre>{
            this.Weight = 1.0;
            this.Hue = 1165;

            this.Attributes.Luck = 150;
            this.Attributes.CastSpeed = 1;
            this.Attributes.CastRecovery = 1;

            this.SetHue = 1165;
            this.SetAttributes.Luck = 100;
            this.SetAttributes.RegenHits = 2;
            this.SetAttributes.RegenMana = 2;
            this.SetAttributes.CastSpeed = 1;
            this.SetAttributes.CastRecovery = 4;
		}</pre>

## Duplicated Code. Size: 148

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\BaseHarvestTool.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_Crafter = reader.ReadMobile();
                        this.m_Quality = (ToolQuality)reader.ReadInt();
                        goto case 0;
                    }
                case 0:
                    {
                        this.m_UsesRemaining = reader.ReadInt();
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Tools\BaseTool.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_Crafter = reader.ReadMobile();
                        this.m_Quality = (ToolQuality)reader.ReadInt();
                        goto case 0;
                    }
                case 0:
                    {
                        this.m_UsesRemaining = reader.ReadInt();
                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 148

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\BlightOfTheTundra.cs

<pre>{
            Attributes.BonusStr = 5;
            Attributes.RegenStam = 10;
            Attributes.AttackChance = 15;
            Attributes.WeaponSpeed = 45;
            Attributes.WeaponDamage = 50;

            Slayer = BaseRunicTool.GetRandomSlayer();

            WeaponAttributes.ResistColdBonus = 15;
            AosElementDamages.Fire = 100;
            Hue = 1165;

            if (antique)
            {
                MaxHitPoints = 250;
                NegativeAttributes.Antique = 1;
            }
            else
                MaxHitPoints = 255;

            HitPoints = MaxHitPoints;
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\BlightOfTheTundra.cs

<pre>{
            Attributes.BonusStr = 5;
            Attributes.RegenStam = 10;
            Attributes.AttackChance = 15;
            Attributes.WeaponSpeed = 45;
            Attributes.WeaponDamage = 50;

            Slayer = BaseRunicTool.GetRandomSlayer();

            WeaponAttributes.ResistColdBonus = 15;
            AosElementDamages.Fire = 100;
            Hue = 1165;

            if (antique)
            {
                MaxHitPoints = 250;
                NegativeAttributes.Antique = 1;
            }
            else
                MaxHitPoints = 255;

            HitPoints = MaxHitPoints;
        }</pre>

## Duplicated Code. Size: 148

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ViceVsVirtue\Gumps\GuildLeaderboardGump.cs

<pre>public override void OnResponse(NetState state, RelayInfo info)
        {
            switch (info.ButtonID)
            {
                default: break;
                case 1:
                case 2:
                case 3:
                    Filter f = (Filter)info.ButtonID - 1;
                    User.SendGump(new GuildLeaderboardGump(User, f));
                    break;
                case 4:
                    User.SendGump(new ViceVsVirtueLeaderboardGump(User));
                    break;
            }
        }</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\Gumps\LeaderboardGump.cs

<pre>public override void OnResponse(NetState state, RelayInfo info)
        {
            switch (info.ButtonID)
            {
                default: break;
                case 1:
                case 2:
                case 3:
                    Filter f = (Filter)info.ButtonID - 1;
                    User.SendGump(new ViceVsVirtueLeaderboardGump(User, f));
                    break;
                case 4:
                    User.SendGump(new GuildLeaderboardGump(User));
                    break;
            }
        }</pre>

## Duplicated Code. Size: 148

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlGetAttachGump.cs

<pre>From = from;
			Closable = false;
			Dragable = true;
			AddPage( 0 );
			AddBackground( 10, 200, 200, 130, 5054 );
			int count = 0;
			if(selectall)
			{
				count = allcount;
			} else
			{
				for(int i =0;i<SelectedList.Length;i++){
					if(SelectedList[i]) count++;
				}
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlEdit.cs

<pre>From = from;
				Closable = false;
				Dragable = true;
				AddPage( 0 );
				AddBackground( 10, 200, 200, 130, 5054 );
				int count = 0;
				if(selectall)
				{
					count = allcount;
				} 
				else
				{
					for(int i =0;i<SelectedList.Length;i++)
					{
						if(SelectedList[i]) count++;
					}
				}</pre>

## Duplicated Code. Size: 148

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGauntlet.cs

<pre>public void RespawnWithPenalty(ChallengeEntry entry)
		{
            if(entry == null) return;

            SubtractScore(entry);

            // move the participant to the gauntlet
            if(entry.Participant != null)
            {
                entry.Participant.MoveToWorld(this.Location, this.Map);
                entry.Participant.PlaySound( 0x214 );
				entry.Participant.FixedEffect( 0x376A, 10, 16 );
				GameBroadcast(100401, entry.Participant.Name);  // "{0} was penalized."
            }
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGauntlet.cs

<pre>public void RespawnWithPenalty(ChallengeEntry entry)
		{
            if(entry == null) return;

            SubtractScore(entry);

            // move the participant to the gauntlet
            if(entry.Participant != null)
            {
                entry.Participant.MoveToWorld(this.Location, this.Map);
                entry.Participant.PlaySound( 0x214 );
				entry.Participant.FixedEffect( 0x376A, 10, 16 );
				GameBroadcast(100401, entry.Participant.Name);  // "{0} was penalized."
            }
		}</pre>

## Duplicated Code. Size: 148

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Ninjitsu\Backstab.cs

<pre>public override bool OnBeforeSwing(Mobile attacker, Mobile defender)
        {
            bool valid = this.Validate(attacker) && this.CheckMana(attacker, true);

            if (valid)
            {
                attacker.BeginAction(typeof(Stealth));
                Timer.DelayCall(TimeSpan.FromSeconds(5.0), delegate { attacker.EndAction(typeof(Stealth)); });
            }

            return valid;
        }</pre>

Fragment 2 in file Scripts\Spells\Ninjitsu\SurpriseAttack.cs

<pre>public override bool OnBeforeSwing(Mobile attacker, Mobile defender)
        {
            bool valid = this.Validate(attacker) && this.CheckMana(attacker, true);

            if (valid)
            {
                attacker.BeginAction(typeof(Stealth));
                Timer.DelayCall(TimeSpan.FromSeconds(5.0), delegate { attacker.EndAction(typeof(Stealth)); });
            }

            return valid;
        }</pre>

## Duplicated Code. Size: 148

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>if (!item.IsVirtualItem)
                {
                    UpdateTotal(item, TotalType.Gold, -item.TotalGold);
                    UpdateTotal(item, TotalType.Items, -(item.TotalItems + 1));
                    UpdateTotal(item, TotalType.Weight, -(item.TotalWeight + item.PileWeight));
                }

                item.Parent = null;

                item.OnRemoved(this);
                OnItemRemoved(item);</pre>

Fragment 2 in file Server\Mobile.cs

<pre>if (!item.IsVirtualItem)
				{
					UpdateTotal(item, TotalType.Gold, -item.TotalGold);
					UpdateTotal(item, TotalType.Items, -(item.TotalItems + 1));
					UpdateTotal(item, TotalType.Weight, -(item.TotalWeight + item.PileWeight));
				}

				item.Parent = null;

				item.OnRemoved(this);
				OnItemRemoved(item);</pre>

## Duplicated Code. Size: 148

### Duplicated Fragments:

Fragment 1 in file Ultima\Gumps.cs

<pre>var bmp = new Bitmap(width, height, PixelFormat.Format16bppArgb1555);
			BitmapData bd = bmp.LockBits(
				new Rectangle(0, 0, width, height), ImageLockMode.WriteOnly, PixelFormat.Format16bppArgb1555);

			if (m_StreamBuffer == null || m_StreamBuffer.Length < length)
			{
				m_StreamBuffer = new byte[length];
			}
			stream.Read(m_StreamBuffer, 0, length);</pre>

Fragment 2 in file Ultima\Light.cs

<pre>if (m_StreamBuffer == null || m_StreamBuffer.Length < length)
			{
				m_StreamBuffer = new byte[length];
			}
			stream.Read(m_StreamBuffer, 0, length);

			var bmp = new Bitmap(width, height, PixelFormat.Format16bppArgb1555);
			BitmapData bd = bmp.LockBits(
				new Rectangle(0, 0, width, height), ImageLockMode.WriteOnly, PixelFormat.Format16bppArgb1555);</pre>

## Duplicated Code. Size: 147

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>{
                            switch (Utility.Random(8))
                            {
                                case 0: neg.Prized = 1; break;
                                case 1: neg.Antique = 1; break;
                                case 2:
                                case 3: neg.Massive = 1; break;
                                case 4:
                                case 5: neg.Unwieldly = 1; break;
                                case 6:
                                case 7: attrs.Luck = -100; break;
                            }

                            return 100;
                        }</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>{
                            switch (Utility.Random(8))
                            {
                                case 0: neg.Prized = 1; break;
                                case 1: neg.Antique = 1; break;
                                case 2:
                                case 3: neg.Massive = 1; break;
                                case 4:
                                case 5: neg.Unwieldly = 1; break;
                                case 6:
                                case 7: attrs.Luck = -100; break;
                            }

                            return 100;
                        }</pre>

## Duplicated Code. Size: 147

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Chivalry\RemoveCurse.cs

<pre>BuffInfo.RemoveBuff(m, BuffIcon.Clumsy);
                    BuffInfo.RemoveBuff(m, BuffIcon.FeebleMind);
                    BuffInfo.RemoveBuff(m, BuffIcon.Weaken);
                    BuffInfo.RemoveBuff(m, BuffIcon.Curse);
                    BuffInfo.RemoveBuff(m, BuffIcon.MassCurse);
                    BuffInfo.RemoveBuff(m, BuffIcon.MortalStrike);
                    BuffInfo.RemoveBuff(m, BuffIcon.Mindrot);</pre>

Fragment 2 in file Scripts\Spells\Mysticism\SpellDefinitions\CleansingWindsSpell.cs

<pre>BuffInfo.RemoveBuff(m, BuffIcon.Clumsy);
                    BuffInfo.RemoveBuff(m, BuffIcon.FeebleMind);
                    BuffInfo.RemoveBuff(m, BuffIcon.Weaken);
                    BuffInfo.RemoveBuff(m, BuffIcon.Curse);
                    BuffInfo.RemoveBuff(m, BuffIcon.MassCurse);
                    BuffInfo.RemoveBuff( m, BuffIcon.MortalStrike );
                    BuffInfo.RemoveBuff ( m, BuffIcon.Mindrot );</pre>

Fragment 3 in file Scripts\Spells\Skill Masteries\Rejuvinate.cs

<pre>BuffInfo.RemoveBuff(m, BuffIcon.Clumsy);
                        BuffInfo.RemoveBuff(m, BuffIcon.FeebleMind);
                        BuffInfo.RemoveBuff(m, BuffIcon.Weaken);
                        BuffInfo.RemoveBuff(m, BuffIcon.Curse);
                        BuffInfo.RemoveBuff(m, BuffIcon.MassCurse);
                        BuffInfo.RemoveBuff(m, BuffIcon.MortalStrike);
                        BuffInfo.RemoveBuff(m, BuffIcon.Mindrot);</pre>

## Duplicated Code. Size: 147

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>tile2.Location = new Point3D(X - 2, Y - 3, Z);   //Left Front
                        tile3.Location = new Point3D(X + 2, Y - 3, Z);   //Right Front
                        tile4.Location = new Point3D(X - 2, Y + 2, Z);   //Left Center
                        tile5.Location = new Point3D(X + 2, Y + 2, Z);   //Right Center
                        break;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>tile2.Location = new Point3D(X + 2, Y + 3, Z);   //Left Front
                        tile3.Location = new Point3D(X - 2, Y + 3, Z);   //Right Front
                        tile4.Location = new Point3D(X + 2, Y - 2, Z);   //Left Center
                        tile5.Location = new Point3D(X - 2, Y - 2, Z);   //Right Center
                        break;</pre>

Fragment 3 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>tile2.Location = new Point3D(X + 3, Y - 2, Z);   //Left Front
                        tile3.Location = new Point3D(X + 3, Y + 2, Z);   //Right Front
                        tile4.Location = new Point3D(X - 2, Y - 2, Z);   //Left Center
                        tile5.Location = new Point3D(X - 2, Y + 2, Z);   //Right Center
                        break;</pre>

Fragment 4 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>tile2.Location = new Point3D(X - 3, Y + 2, Z);   //Left Front
                        tile3.Location = new Point3D(X - 3, Y - 2, Z);   //Right Front
                        tile4.Location = new Point3D(X + 2, Y + 2, Z);   //Left Center
                        tile5.Location = new Point3D(X + 2, Y - 2, Z);   //Right Center
                        break;</pre>

## Duplicated Code. Size: 146

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>{
            string x, y, z;

            this.Pop(out x, ref line);
            this.Pop(out y, ref line);
            this.Pop(out z, ref line);

            this.m_Location = new Point3D(Utility.ToInt32(x), Utility.ToInt32(y), Utility.ToInt32(z));
            this.m_Extra = line;
        }</pre>

Fragment 2 in file Scripts\Commands\DecorateMag.cs

<pre>{
            string x, y, z;

            this.Pop(out x, ref line);
            this.Pop(out y, ref line);
            this.Pop(out z, ref line);

            this.m_Location = new Point3D(Utility.ToInt32(x), Utility.ToInt32(y), Utility.ToInt32(z));
            this.m_Extra = line;
        }</pre>

## Duplicated Code. Size: 146

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\Loot.cs

<pre>{
            typeof( NetherBoltScroll ),	    typeof( HealingStoneScroll ),	typeof( PurgeMagicScroll ),	        typeof( EnchantScroll ),
			typeof( SleepScroll ),	        typeof( EagleStrikeScroll ),   typeof( AnimatedWeaponScroll ),		typeof( StoneFormScroll ),
			typeof( SpellTriggerScroll ),	typeof( MassSleepScroll ),	    typeof( CleansingWindsScroll ),		typeof( BombardScroll ),
			typeof( SpellPlagueScroll ),    typeof( HailStormScroll ),      typeof( NetherCycloneScroll ),      typeof( RisingColossusScroll )
        }</pre>

Fragment 2 in file Scripts\Misc\Loot.cs

<pre>{
			typeof(NetherBoltScroll), typeof(HealingStoneScroll), typeof(PurgeMagicScroll), typeof(EagleStrikeScroll),
			typeof(AnimatedWeaponScroll), typeof(StoneFormScroll), typeof(SpellTriggerScroll), typeof(CleansingWindsScroll),
			typeof(BombardScroll), typeof(SpellPlagueScroll), typeof(HailStormScroll), typeof(NetherCycloneScroll),
			typeof(RisingColossusScroll), typeof(SleepScroll), typeof(MassSleepScroll), typeof(EnchantScroll)
		}</pre>

## Duplicated Code. Size: 146

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Cougar.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 20, 25);
            this.SetResistance(ResistanceType.Fire, 5, 10);
            this.SetResistance(ResistanceType.Cold, 10, 15);
            this.SetResistance(ResistanceType.Poison, 5, 10);

            this.SetSkill(SkillName.MagicResist, 15.1, 30.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Panther.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 20, 25);
            this.SetResistance(ResistanceType.Fire, 5, 10);
            this.SetResistance(ResistanceType.Cold, 10, 15);
            this.SetResistance(ResistanceType.Poison, 5, 10);

            this.SetSkill(SkillName.MagicResist, 15.1, 30.0);</pre>

## Duplicated Code. Size: 146

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\EscortableMage.cs

<pre>[Constructable]
        public EscortableMage()
        {
            this.Title = "the mage";

            this.SetSkill(SkillName.EvalInt, 80.0, 100.0);
            this.SetSkill(SkillName.Inscribe, 80.0, 100.0);
            this.SetSkill(SkillName.Magery, 80.0, 100.0);
            this.SetSkill(SkillName.Meditation, 80.0, 100.0);
            this.SetSkill(SkillName.MagicResist, 80.0, 100.0);
        }</pre>

Fragment 2 in file Scripts\Quests\Escortables.cs

<pre>[Constructable]
        public EscortableMage()
        {
            this.Title = "the mage";

            this.SetSkill(SkillName.EvalInt, 80.0, 100.0);
            this.SetSkill(SkillName.Inscribe, 80.0, 100.0);
            this.SetSkill(SkillName.Magery, 80.0, 100.0);
            this.SetSkill(SkillName.Meditation, 80.0, 100.0);
            this.SetSkill(SkillName.MagicResist, 80.0, 100.0);
        }</pre>

## Duplicated Code. Size: 146

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Discipline.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(SackFlour), "sack of flour", 1, 0x1039));
            this.AddObjective(new ObtainObjective(typeof(JarHoney), "jar of honey", 10, 0x9EC));
            this.AddObjective(new ObtainObjective(typeof(FishSteak), "fish steak", 20, 0x97B));		

            this.AddReward(new BaseReward(1074872)); // The opportunity to learn the ways of the Arcanist.
        }</pre>

Fragment 2 in file Scripts\Quests\Spellweaving.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(SackFlour), "sack of flour", 1, 0x1039));
            this.AddObjective(new ObtainObjective(typeof(JarHoney), "jar of honey", 10, 0x9EC));
            this.AddObjective(new ObtainObjective(typeof(FishSteak), "fish steak", 20, 0x97B));		

            this.AddReward(new BaseReward(1074872)); // The opportunity to learn the ways of the Arcanist.
        }</pre>

## Duplicated Code. Size: 146

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Creatures.cs

<pre>SetResistance(ResistanceType.Physical, 65, 80);
            SetResistance(ResistanceType.Fire, 60, 80);
            SetResistance(ResistanceType.Cold, 50, 60);
            SetResistance(ResistanceType.Poison, 100);
            SetResistance(ResistanceType.Energy, 40, 50);

            SetSkill(SkillName.Anatomy, 25.1, 50.0);
            SetSkill(SkillName.MagicResist, 150.0);</pre>

Fragment 2 in file Scripts\Quests\Eodon\Valley of One Quest\Creatures.cs

<pre>SetResistance(ResistanceType.Physical, 65, 80);
            SetResistance(ResistanceType.Fire, 60, 80);
            SetResistance(ResistanceType.Cold, 50, 60);
            SetResistance(ResistanceType.Poison, 100);
            SetResistance(ResistanceType.Energy, 40, 50);

            SetSkill(SkillName.Anatomy, 25.1, 50.0);
            SetSkill(SkillName.MagicResist, 150.0);</pre>

## Duplicated Code. Size: 146

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>{
                if (this.m_Level == 0)
                {
                    if (Mon is LavaSnake || Mon is LavaLizard || Mon is FireAnt)
                        return true;
                }
                else if (this.m_Level == 1)
                {
                    if (Mon is LavaSerpent || Mon is HellCat || Mon is HellHound)
                        return true;
                }
                else if (this.m_Level == 2)
                {
                    if (Mon is FireDaemon || Mon is LavaElemental)
                        return true;
                }
            }</pre>

Fragment 2 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>{
                if (this.m_Level == 0)
                {
                    if (Mon is LavaSnake || Mon is LavaLizard || Mon is FireAnt)
                        return true;
                }
                else if (this.m_Level == 1)
                {
                    if (Mon is LavaSerpent || Mon is HellCat || Mon is HellHound)
                        return true;
                }
                else if (this.m_Level == 2)
                {
                    if (Mon is FireDaemon || Mon is LavaElemental)
                        return true;
                }
            }</pre>

## Duplicated Code. Size: 146

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>spawner.SpawnRange = spawnrange;
									spawner.m_PlayerCreated = true;

									spawner.LastModifiedBy = fromname;
									spawner.FirstModifiedBy = fromname;
									spawner.MoveToWorld(new Point3D(x, y, z), spawnmap);
									if (spawner.Map == Map.Internal)
									{
										badspawnercount++;
										spawner.Delete();
										from.SendMessage("Bad spawn at line {1}: {0}", line, linenumber);
										return;
									}
									spawnercount++;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>spawner.SpawnRange = spawnrange;
									spawner.m_PlayerCreated = true;

									spawner.LastModifiedBy = fromname;
									spawner.FirstModifiedBy = fromname;
									spawner.MoveToWorld(new Point3D(x, y, z), spawnmap);
									if (spawner.Map == Map.Internal)
									{
										badspawnercount++;
										spawner.Delete();
										from.SendMessage("Bad spawn at line {1}: {0}", line, linenumber);
										return;
									}
									spawnercount++;</pre>

## Duplicated Code. Size: 146

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGauntlet.cs

<pre>base.Serialize( writer );

            writer.Write( (int) 0 ); // version

            writer.Write(m_Challenger);
            writer.Write(m_GameLocked);
            writer.Write(m_GameInProgress);
            writer.Write(m_TotalPurse);
            writer.Write(m_EntryFee);
            writer.Write(m_ArenaSize);
            writer.Write(m_Winner);
            writer.Write(m_TargetScore);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGauntlet.cs

<pre>base.Serialize( writer );

            writer.Write( (int) 0 ); // version

            writer.Write(m_Challenger);
            writer.Write(m_GameLocked);
            writer.Write(m_GameInProgress);
            writer.Write(m_TotalPurse);
            writer.Write(m_EntryFee);
            writer.Write(m_ArenaSize);
            writer.Write(m_Winner);
            writer.Write(m_TargetScore);</pre>

## Duplicated Code. Size: 146

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Clothing\Cloaks.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_LabelNumber = reader.ReadInt();
                        this.m_IsRewardItem = reader.ReadBool();
                        break;
                    }
            }

            if (this.Parent is Mobile)
                ((Mobile)this.Parent).VirtualArmorMod += 2;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_LabelNumber = reader.ReadInt();
                        this.m_IsRewardItem = reader.ReadBool();
                        break;
                    }
            }

            if (this.Parent is Mobile)
                ((Mobile)this.Parent).VirtualArmorMod += 2;
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_LabelNumber = reader.ReadInt();
                        this.m_IsRewardItem = reader.ReadBool();
                        break;
                    }
            }

            if (this.Parent is Mobile)
                ((Mobile)this.Parent).VirtualArmorMod += 2;
        }</pre>

## Duplicated Code. Size: 146

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
									string subgroupstr = keywordargs[1];
									string spawnerstr = null;
									if (keywordargs.Length > 2)
									{
										spawnerstr = keywordargs[1];
										subgroupstr = keywordargs[2];
									}
									if (spawnerstr != null)
									{
										targetspawner = FindSpawnerByName(spawner, spawnerstr);
									}
									if(!int.TryParse(subgroupstr, out subgroup))
										subgroup=-1;
								}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
									string subgroupstr = keywordargs[1];
									string spawnerstr = null;
									if (keywordargs.Length > 2)
									{
										spawnerstr = keywordargs[1];
										subgroupstr = keywordargs[2];
									}
									if (spawnerstr != null)
									{
										targetspawner = FindSpawnerByName(spawner, spawnerstr);
									}
									if(!int.TryParse(subgroupstr, out subgroup))
										subgroup = -1;
								}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
									string subgroupstr = keywordargs[1];
									string spawnerstr = null;
									if (keywordargs.Length > 2)
									{
										spawnerstr = keywordargs[1];
										subgroupstr = keywordargs[2];
									}
									if (spawnerstr != null)
									{
										targetspawner = FindSpawnerByName(spawner, spawnerstr);
									}
									if(!int.TryParse(subgroupstr, out subgroup))
										subgroup = -1;
								}</pre>

## Duplicated Code. Size: 145

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\TaxidermyKit.cs

<pre>int version = reader.ReadInt();

			switch ( version )
			{
				case 1:
				{
					m_Hunter = reader.ReadMobile();
					m_AnimalWeight = reader.ReadInt();
					goto case 0;
				}
				case 0:
				{
					m_WestID = reader.ReadInt();
					m_NorthID = reader.ReadInt();
					m_DeedNumber = reader.ReadInt();
					m_AddonNumber = reader.ReadInt();
					break;
				}
			}</pre>

Fragment 2 in file Scripts\Items\Consumables\TaxidermyKit.cs

<pre>int version = reader.ReadInt();

			switch ( version )
			{
				case 1:
				{
					m_Hunter = reader.ReadMobile();
					m_AnimalWeight = reader.ReadInt();
					goto case 0;
				}
				case 0:
				{
					m_WestID = reader.ReadInt();
					m_NorthID = reader.ReadInt();
					m_DeedNumber = reader.ReadInt();
					m_AddonNumber = reader.ReadInt();
					break;
				}
			}</pre>

## Duplicated Code. Size: 145

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\FishingPole.cs

<pre>if (m_BaitType != null)
            {
                object label = FishInfo.GetFishLabel(m_BaitType);
                if (label is int)
                    list.Add(1116468, String.Format("#{0}", (int)label)); //baited to attract: ~1_val~
                else if (label is string)
                    list.Add(1116468, (string)label);

                list.Add(1116466, m_BaitUses.ToString());
            }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\LobsterTrap.cs

<pre>if (m_BaitType != null)
            {
                object label = FishInfo.GetFishLabel(m_BaitType);
                if (label is int)
                    list.Add(1116468, String.Format("#{0}", (int)label)); //baited to attract: ~1_val~
                else if (label is string)
                    list.Add(1116468, (string)label);

                list.Add(1116466, m_BaitUses.ToString());
            }</pre>

## Duplicated Code. Size: 145

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\ArenaGump.cs

<pre>{
            this.AddBackground(this.m_ColumnX, 12, width, 20, 0x242C);
            this.AddImageTiled(this.m_ColumnX + 2, 14, width - 4, 16, 0x2430);

            if (name != null)
                this.AddBorderedText(this.m_ColumnX, 13, width, this.Center(name), 0xFFFFFF, 0);

            this.m_ColumnX += width;
        }</pre>

Fragment 2 in file Scripts\Services\ConPVP\Preferences.cs

<pre>{
            this.AddBackground(this.m_ColumnX, 12, width, 20, 0x242C);
            this.AddImageTiled(this.m_ColumnX + 2, 14, width - 4, 16, 0x2430);

            if (name != null)
                this.AddBorderedText(this.m_ColumnX, 13, width, this.Center(name), 0xFFFFFF, 0);

            this.m_ColumnX += width;
        }</pre>

## Duplicated Code. Size: 145

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Artifacts.cs

<pre>{
			SkillBonuses.SetValues( 0, SkillName.Parry, 10.0 );
			Attributes.BonusStr = 10;
			Attributes.BonusStam = 10;
			Attributes.RegenHits = 5;
			Attributes.WeaponSpeed = 10;

            SetProtection(typeof(BaseEodonTribesman), new TextDefinition(1156291), 60);

			PhysicalBonus = 4;
			FireBonus = 4;
			ColdBonus = 4;
			PoisonBonus = 4;
			EnergyBonus = 3;
		}</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Artifacts.cs

<pre>{
			SkillBonuses.SetValues( 0, SkillName.Parry, 10.0 );
			Attributes.BonusStr = 10;
			Attributes.BonusStam = 10;
			Attributes.RegenHits = 5;
			Attributes.WeaponSpeed = 10;

            SetProtection(typeof(BaseEodonTribesman), new TextDefinition(1156291), 60);

			PhysicalBonus = 4;
			FireBonus = 4;
			ColdBonus = 4;
			PoisonBonus = 4;
			EnergyBonus = 3;
		}</pre>

## Duplicated Code. Size: 145

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (!i.Deleted && CheckNameMatch(targetname, i.Name) && (typestr == null ||
						(itemtype != null && targettype != null && (itemtype.Equals(targettype) || itemtype.IsSubclassOf(targettype)))))
					{
						if (proptest == null || CheckPropertyString(null, i, proptest, null, out status_str))
						nearbylist.Add(i);
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (!i.Deleted && CheckNameMatch(targetname, i.Name) && (typestr == null ||
								(itemtype != null && targettype != null && (itemtype.Equals(targettype) || itemtype.IsSubclassOf(targettype)))))
							{
								if (proptest == null || CheckPropertyString(null, i, proptest, null, out status_str))
								nearbylist.Add(i);
							}</pre>

## Duplicated Code. Size: 145

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestLeaders.cs

<pre>string filter = null;
				if(m_attachment != null)
					filter = m_attachment.guildFilter;

				AddImageTiled( 140, height - 20, 160, 19, 0xBBC );
				AddTextEntry( 140, height - 20, 160, 19, 0, 200, filter );

				AddButton( 20, height - 20, 0x15E1, 0x15E5, 200, GumpButtonType.Reply, 0 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>string filter = null;
				if(m_attachment != null)
					filter = m_attachment.guildFilter;

				AddImageTiled( 140, height - 20, 160, 19, 0xBBC );
				AddTextEntry( 140, height - 20, 160, 19, 0, 200, filter );

				AddButton( 20, height - 20, 0x15E1, 0x15E5, 200, GumpButtonType.Reply, 0 );</pre>

## Duplicated Code. Size: 145

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestLeaders.cs

<pre>string nfilter = null;
				if(m_attachment != null)
					nfilter = m_attachment.nameFilter;

				AddImageTiled( 440, height - 20, 160, 19, 0xBBC );
				AddTextEntry( 440, height - 20, 160, 19, 0, 100, nfilter );

				AddButton( 320, height - 20, 0x15E1, 0x15E5, 100, GumpButtonType.Reply, 0 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>string nfilter = null;
				if(m_attachment != null)
					nfilter = m_attachment.nameFilter;

				AddImageTiled( 440, height - 20, 160, 19, 0xBBC );
				AddTextEntry( 440, height - 20, 160, 19, 0, 100, nfilter );

				AddButton( 320, height - 20, 0x15E1, 0x15E5, 100, GumpButtonType.Reply, 0 );</pre>

## Duplicated Code. Size: 145

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketHandlers.cs

<pre>state.Send(new ClientVersionReq());

				state.BlockAllPackets = true;

				EventSink.InvokeCharacterCreated(args);

				Mobile m = args.Mobile;

				if (m != null)
				{
					state.Mobile = m;
					m.NetState = state;
					new LoginTimer(state, m).Start();
				}
				else
				{
					state.BlockAllPackets = false;
					state.Dispose();
				}</pre>

Fragment 2 in file Server\Network\PacketHandlers.cs

<pre>state.Send(new ClientVersionReq());

				state.BlockAllPackets = true;

				EventSink.InvokeCharacterCreated(args);

				Mobile m = args.Mobile;

				if (m != null)
				{
					state.Mobile = m;
					m.NetState = state;
					new LoginTimer(state, m).Start();
				}
				else
				{
					state.BlockAllPackets = false;
					state.Dispose();
				}</pre>

## Duplicated Code. Size: 145

### Duplicated Fragments:

Fragment 1 in file Ultima\Gumps.cs

<pre>BitmapData bd = bmp.LockBits(
								new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.ReadOnly, PixelFormat.Format16bppArgb1555);
							var line = (ushort*)bd.Scan0;
							int delta = bd.Stride >> 1;

							binidx.Write((int)fsmul.Position); //lookup
							var length = (int)fsmul.Position;</pre>

Fragment 2 in file Ultima\Light.cs

<pre>BitmapData bd = bmp.LockBits(
								new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.ReadOnly, PixelFormat.Format16bppArgb1555);
							var line = (ushort*)bd.Scan0;
							int delta = bd.Stride >> 1;

							binidx.Write((int)fsmul.Position); //lookup
							var length = (int)fsmul.Position;</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SpecialFishingNet.cs

<pre>this.m_InUse = true;
                this.Movable = false;
                this.MoveToWorld(p, map);

                SpellHelper.Turn(from, p);
                from.Animate(12, 5, 1, true, false, 0);

                Effects.SendLocationEffect(p, map, 0x352D, 16, 4);
                Effects.PlaySound(p, map, 0x364);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\SpecialSalvageHook.cs

<pre>this.m_InUse = true;
                this.Movable = false;
                this.MoveToWorld(p, map);

                SpellHelper.Turn(from, p);
                from.Animate(12, 5, 1, true, false, 0);

                Effects.SendLocationEffect(p, map, 0x352D, 16, 4);
                Effects.PlaySound(p, map, 0x364);</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if (GetSaveFlag(sflags, SetFlag.LastEquipped))
                writer.Write((bool)this.m_LastEquipped);

            if (GetSaveFlag(sflags, SetFlag.SetEquipped))
                writer.Write((bool)this.m_SetEquipped);

            if (GetSaveFlag(sflags, SetFlag.SetSelfRepair))
                writer.WriteEncodedInt((int)this.m_SetSelfRepair);

            // Version 7
            SaveFlag flags = SaveFlag.None;</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if (GetSaveFlag(sflags, SetFlag.LastEquipped))
                writer.Write((bool)this.m_LastEquipped);

            if (GetSaveFlag(sflags, SetFlag.SetEquipped))
                writer.Write((bool)this.m_SetEquipped);

            if (GetSaveFlag(sflags, SetFlag.SetSelfRepair))
                writer.WriteEncodedInt((int)this.m_SetSelfRepair);
            #endregion

            // Version 5
            SaveFlag flags = SaveFlag.None;</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\Teleporter.cs

<pre>public virtual bool CanTeleport(Mobile m)
		{
			if (!m_Creatures && !m.Player)
			{
				return false;
			}
			else if (m_CriminalCheck && m.Criminal)
			{
				m.SendLocalizedMessage(1005561, "", 0x22); // Thou'rt a criminal and cannot escape so easily.
				return false;
			}
			else if (m_CombatCheck && SpellHelper.CheckCombat(m))
			{
				m.SendLocalizedMessage(1005564, "", 0x22); // Wouldst thou flee during the heat of battle??
				return false;
			}

			return true;
		}</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\Teleporter\Whirlpool.cs

<pre>public virtual bool CanTeleport(Mobile m)
        {
            if (!m_Creatures && !m.Player)
            {
                return false;
            }
            else if (m_CriminalCheck && m.Criminal)
            {
                m.SendLocalizedMessage(1005561, "", 0x22); // Thou'rt a criminal and cannot escape so easily.
                return false;
            }
            else if (m_CombatCheck && SpellHelper.CheckCombat(m))
            {
                m.SendLocalizedMessage(1005564, "", 0x22); // Wouldst thou flee during the heat of battle??
                return false;
            }

            return true;
        }</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Serado.cs

<pre>Mobile target = null;

                if (attacker is BaseCreature)
                {
                    Mobile m = ((BaseCreature)attacker).GetMaster();

                    if (m != null)
                        target = m;
                }

                if (target == null || !target.InRange(this, 25))
                    target = attacker;

                this.Animate(10, 4, 1, true, false, 0);</pre>

Fragment 2 in file Scripts\Mobiles\Named\Putrefier.cs

<pre>Mobile target = null;

                if (attacker is BaseCreature)
                {
                    Mobile m = ((BaseCreature)attacker).GetMaster();

                    if (m != null)
                        target = m;
                }

                if (target == null || !target.InRange(this, 25))
                    target = attacker;

                this.Animate(10, 4, 1, true, false, 0);</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\JukaMage.cs

<pre>Container bag = new Bag();

            int count = Utility.RandomMinMax(10, 20);

            for (int i = 0; i < count; ++i)
            {
                Item item = Loot.RandomReagent();

                if (item == null)
                    continue;

                if (!bag.TryDropItem(this, item, false))
                    item.Delete();
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\MeerCaptain.cs

<pre>Container bag = new Bag();

            int count = Utility.RandomMinMax(10, 20);

            for (int i = 0; i < count; ++i)
            {
                Item item = Loot.RandomReagent();

                if (item == null)
                    continue;

                if (!bag.TryDropItem(this, item, false))
                    item.Delete();
            }</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\HireFighter.cs

<pre>switch( Utility.Random(5) )
            {
                case 0:
                    break;
                case 1:
                    this.AddItem(new Bascinet());
                    break;
                case 2:
                    this.AddItem(new CloseHelm());
                    break;
                case 3:
                    this.AddItem(new NorseHelm());
                    break;
                case 4:
                    this.AddItem(new Helmet());
                    break;
            }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HirePaladin.cs

<pre>switch( Utility.Random(5) )
            {
                case 0:
                    break;
                case 1:
                    this.AddItem(new Bascinet());
                    break;
                case 2:
                    this.AddItem(new CloseHelm());
                    break;
                case 3:
                    this.AddItem(new NorseHelm());
                    break;
                case 4:
                    this.AddItem(new Helmet());
                    break;
            }</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\BaseCollectionItem.cs

<pre>for (int i = reader.ReadInt(); i > 0; i --)
            {
                List<object> list = new List<object>();

                for (int j = reader.ReadInt(); j > 0; j --)
                    list.Add(QuestReader.Object(reader));

                this.m_Tiers.Add(list);
            }</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\BaseCollectionMobile.cs

<pre>for (int i = reader.ReadInt(); i > 0; i--)
				{
					List<object> list = new List<object>();

					for (int j = reader.ReadInt(); j > 0; j--)
						list.Add(QuestReader.Object(reader));

					this.m_Tiers.Add(list);
				}</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>hold1.Location = new Point3D(X + 1, Y + 8, Z);
                    hold2.Location = new Point3D(X - 1, Y + 8, Z);
                    hold3.Location = new Point3D(X + 1, Y + 9, Z);
                    hold4.Location = new Point3D(X - 1, Y + 9, Z);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>hold1.Location = new Point3D(X + 8,  Y - 1, Z);
                    hold2.Location = new Point3D(X + 8,  Y + 1, Z);
                    hold3.Location = new Point3D(X + 9,  Y - 1, Z);
                    hold4.Location = new Point3D(X + 9,  Y + 1, Z);</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>hold1.Location = new Point3D(X - 1, Y - 8, Z);
                    hold2.Location = new Point3D(X + 1, Y - 8, Z);
                    hold3.Location = new Point3D(X - 1, Y - 9, Z);
                    hold4.Location = new Point3D(X + 1, Y - 9, Z);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>hold1.Location = new Point3D(X - 8,  Y + 1, Z);
                    hold2.Location = new Point3D(X - 8,  Y - 1, Z);
                    hold3.Location = new Point3D(X - 9,  Y + 1, Z);
                    hold4.Location = new Point3D(X - 9,  Y - 1, Z);</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>fill1.Location = new Point3D(X - 2, Y +  8, Z);
                    fill2.Location = new Point3D(X - 2, Y +  7, Z);
                    fill3.Location = new Point3D(X - 2, Y +  6, Z);
                    fill4.Location = new Point3D(X - 2, Y +  5, Z);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>fill1.Location = new Point3D(X + 2, Y - 8, Z);
                    fill2.Location = new Point3D(X + 2, Y - 7, Z);
                    fill3.Location = new Point3D(X + 2, Y - 6, Z);
                    fill4.Location = new Point3D(X + 2, Y - 5, Z);</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ViceVsVirtue\VvVBattle.cs

<pre>Teams = new List<BattleTeam>();

            KillCooldown = new Dictionary<Mobile, DateTime>();
            Messages = new List<string>();
            Altars = new List<VvVAltar>();
            Traps = new List<VvVTrap>();
            Warned = new List<Mobile>();
            Turrets = new List<CannonTurret>();</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\VvVBattle.cs

<pre>Altars = new List<VvVAltar>();
            KillCooldown = new Dictionary<Mobile, DateTime>();
            Messages = new List<string>();
            Traps = new List<VvVTrap>();
            Warned = new List<Mobile>();
            Turrets = new List<CannonTurret>();
            Teams = new List<BattleTeam>();</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>public bool HasEntryFee(Mobile m)
        {
                Container bank = m.BankBox;
                int total = 0;

                if(bank != null)
                {
    				Item[] goldlist = bank.FindItemsByType( typeof(Gold), true );

    				if( goldlist != null )
    				{
    					foreach( Gold g in goldlist )
    						total += g.Amount;
    				}
                }
                return (total >= m_gauntlet.EntryFee);
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>public bool HasEntryFee(Mobile m)
        {
                Container bank = m.BankBox;
                int total = 0;

                if(bank != null)
                {
    				Item[] goldlist = bank.FindItemsByType( typeof(Gold), true );

    				if( goldlist != null )
    				{
    					foreach( Gold g in goldlist )
    						total += g.Amount;
    				}
                }
                return (total >= m_gauntlet.EntryFee);
        }</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\GenericBuy.cs

<pre>for (int i = 0; i < this.m_Mobiles.Count; ++i)
                    this.m_Mobiles[i].Delete();

                this.m_Mobiles.Clear();

                for (int i = this.Items.Count - 1; i >= 0; --i)
                    if (i < this.Items.Count)
                        this.Items[i].Delete();</pre>

Fragment 2 in file Scripts\VendorInfo\GenericBuy.cs

<pre>for (int i = 0; i < this.m_Mobiles.Count; ++i)
                    this.m_Mobiles[i].Delete();

                this.m_Mobiles.Clear();

                for (int i = this.Items.Count - 1; i >= 0; --i)
                    if (i < this.Items.Count)
                        this.Items[i].Delete();</pre>

## Duplicated Code. Size: 144

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketReader.cs

<pre>{
			StringBuilder sb = new StringBuilder();

			int c;

			while ((m_Index + 1) < m_Size && (c = (m_Data[m_Index++] | (m_Data[m_Index++] << 8))) != 0)
			{
				if (IsSafeChar(c))
				{
					sb.Append((char)c);
				}
			}

			return sb.ToString();
		}</pre>

Fragment 2 in file Server\Network\PacketReader.cs

<pre>{
			StringBuilder sb = new StringBuilder();

			int c;

			while ((m_Index + 1) < m_Size && (c = ((m_Data[m_Index++] << 8) | m_Data[m_Index++])) != 0)
			{
				if (IsSafeChar(c))
				{
					sb.Append((char)c);
				}
			}

			return sb.ToString();
		}</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Add.cs

<pre>props = new string[remains / 2, 2];

                        remains /= 2;

                        for (int j = 0; j < remains; ++j)
                        {
                            props[j, 0] = args[i + (j * 2) + 1];
                            props[j, 1] = args[i + (j * 2) + 2];
                        }</pre>

Fragment 2 in file Scripts\Services\Spawner\Spawner.cs

<pre>props = new string[remains / 2, 2];

                        remains /= 2;

                        for (int j = 0; j < remains; ++j)
                        {
                            props[j, 0] = args[i + (j * 2) + 1];
                            props[j, 1] = args[i + (j * 2) + 2];
                        }</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\SacrificialAltar.cs

<pre>if (this.TotalItems >= 50)
            {
                this.SendLocalizedMessageTo(from, 501478); // The trash is full!  Emptying!
                this.Empty();
            }
            else
            {
                this.SendLocalizedMessageTo(from, 1010442); // The item will be deleted in three minutes

                if (this.m_Timer != null)
                    this.m_Timer.Stop();

                this.m_Timer = Timer.DelayCall(TimeSpan.FromMinutes(3), new TimerCallback(Empty));
            }

            return true;</pre>

Fragment 2 in file Scripts\Items\Addons\SacrificialAltar.cs

<pre>if (this.TotalItems >= 50)
            {
                this.SendLocalizedMessageTo(from, 501478); // The trash is full!  Emptying!
                this.Empty();
            }
            else
            {
                this.SendLocalizedMessageTo(from, 1010442); // The item will be deleted in three minutes

                if (this.m_Timer != null)
                    this.m_Timer.Stop();

                this.m_Timer = Timer.DelayCall(TimeSpan.FromMinutes(3), new TimerCallback(Empty));
            }

            return true;</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\SpinningwheelEastAddon.cs

<pre>public void BeginSpin(SpinCallback callback, Mobile from, int hue)
        {
            this.m_Timer = new SpinTimer(this, callback, from, hue);
            this.m_Timer.Start();

            foreach (AddonComponent c in this.Components)
            {
                switch ( c.ItemID )
                {
                    case 0x1015:
                    case 0x1019:
                    case 0x101C:
                    case 0x10A4:
                        ++c.ItemID;
                        break;
                }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Addons\SpinningwheelSouthAddon.cs

<pre>public void BeginSpin(SpinCallback callback, Mobile from, int hue)
        {
            this.m_Timer = new SpinTimer(this, callback, from, hue);
            this.m_Timer.Start();

            foreach (AddonComponent c in this.Components)
            {
                switch ( c.ItemID )
                {
                    case 0x1015:
                    case 0x1019:
                    case 0x101C:
                    case 0x10A4:
                        ++c.ItemID;
                        break;
                }
            }
        }</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\Notoriety.cs

<pre>Guild sourceGuild = GetGuildFor(source.Guild as Guild, source);
                Guild targetGuild = GetGuildFor(target.Guild as Guild, target.Owner);

                if (sourceGuild != null && targetGuild != null)
                {
                    if (sourceGuild == targetGuild || sourceGuild.IsAlly(targetGuild))
                        return Notoriety.Ally;
                    else if (sourceGuild.IsEnemy(targetGuild))
                        return Notoriety.Enemy;
                }</pre>

Fragment 2 in file Scripts\Misc\Notoriety.cs

<pre>Guild sourceGuild = GetGuildFor(source.Guild as Guild, source);
                Guild targetGuild = GetGuildFor(target.Guild as Guild, target.Owner);

                if (sourceGuild != null && targetGuild != null)
                {
                    if (sourceGuild == targetGuild || sourceGuild.IsAlly(targetGuild))
                        return Notoriety.Ally;
                    else if (sourceGuild.IsEnemy(targetGuild))
                        return Notoriety.Enemy;
                }</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>public void Run(Direction d)
        {
            if ((this.m_Mobile.Spell != null && this.m_Mobile.Spell.IsCasting) || this.m_Mobile.Paralyzed || this.m_Mobile.Frozen || this.m_Mobile.DisallowAllMoves)
                return;

            this.m_Mobile.Direction = d | Direction.Running;

            if (!this.DoMove(this.m_Mobile.Direction, true))
                this.OnFailedMove();
        }</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>public void Run(Direction d)
        {
            if ((this.m_Mobile.Spell != null && this.m_Mobile.Spell.IsCasting) || this.m_Mobile.Paralyzed || this.m_Mobile.Frozen || this.m_Mobile.DisallowAllMoves)
                return;

            this.m_Mobile.Direction = d | Direction.Running;

            if (!this.DoMove(this.m_Mobile.Direction, true))
                this.OnFailedMove();
        }</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\OrcishLord.cs

<pre>SetDamage(4, 14);

            SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 25, 35);
            SetResistance(ResistanceType.Fire, 30, 40);
            SetResistance(ResistanceType.Cold, 20, 30);
            SetResistance(ResistanceType.Poison, 30, 40);
            SetResistance(ResistanceType.Energy, 30, 40);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\OrcishMage.cs

<pre>SetDamage(4, 14);

            SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 25, 35);
            SetResistance(ResistanceType.Fire, 30, 40);
            SetResistance(ResistanceType.Cold, 20, 30);
            SetResistance(ResistanceType.Poison, 30, 40);
            SetResistance(ResistanceType.Energy, 30, 40);</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\ReadyGump.cs

<pre>ArrayList parts = context.Participants;

            int height = 25 + 20;

            for (int i = 0; i < parts.Count; ++i)
            {
                Participant p = (Participant)parts[i];

                height += 4;

                if (p.Players.Length > 1)
                    height += 22;

                height += (p.Players.Length * 22);
            }</pre>

Fragment 2 in file Scripts\Services\ConPVP\ReadyUpGump.cs

<pre>ArrayList parts = context.Participants;

                int height = 25 + 20;

                for (int i = 0; i < parts.Count; ++i)
                {
                    Participant p = (Participant)parts[i];

                    height += 4;

                    if (p.Players.Length > 1)
                        height += 22;

                    height += (p.Players.Length * 22);
                }</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>this.Closable = false;

            this.AddPage(0);

            //AddBackground( 0, 0, 400, 220, 9150 );
            this.AddBackground(1, 1, 398, height, 3600);
            //AddBackground( 16, 15, 369, 189, 9100 );

            this.AddImageTiled(16, 15, 369, height - 29, 3604);
            this.AddAlphaRegion(16, 15, 369, height - 29);

            this.AddImage(215, -43, 0xEE40);</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>this.Closable = false;

            this.AddPage(0);

            this.AddBackground(1, 1, 398, height, 3600);

            this.AddImageTiled(16, 15, 369, height - 29, 3604);
            this.AddAlphaRegion(16, 15, 369, height - 29);

            this.AddImage(215, -43, 0xEE40);</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\DupresChampion.cs

<pre>if (Utility.RandomDouble() < 0.1)
            {
                switch (Utility.Random(4))
                {
                    case 0:
                        PackItem(new ExodusSummoningRite());
                        break;
                    case 1:
                        PackItem(new ExodusSacrificalDagger());
                        break;
                    case 2:
                        PackItem(new RobeofRite());
                        break;
                    case 3:
                        PackItem(new ExodusSummoningAlter());
                        break;
                }
            }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusMinionLord.cs

<pre>if (Utility.RandomDouble() < 0.1)
            {
                switch (Utility.Random(4))
                {
                    case 0:
                        PackItem(new ExodusSummoningRite());
                        break;
                    case 1:
                        PackItem(new ExodusSacrificalDagger());
                        break;
                    case 2:
                        PackItem(new RobeofRite());
                        break;
                    case 3:
                        PackItem(new ExodusSummoningAlter());
                        break;
                }
            }</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\TreasuresOfTokuno\TreasuresOfTokuno.cs

<pre>killer.PlaySound(0x5B4);
                    pm.SendLocalizedMessage(1062317); // For your valor in combating the fallen beast, a special artifact has been bestowed on you.

                    if (!pm.PlaceInBackpack(i))
                    {
                        if (pm.BankBox != null && pm.BankBox.TryDropItem(killer, i, false))
                            pm.SendLocalizedMessage(1079730); // The item has been placed into your bank box.
                        else
                        {
                            pm.SendLocalizedMessage(1072523); // You find an artifact, but your backpack and bank are too full to hold it.
                            i.MoveToWorld(pm.Location, pm.Map);
                        }
                    }</pre>

Fragment 2 in file Scripts\Services\Virtue Artifacts\VirtueArtifactsSystem.cs

<pre>killer.PlaySound(0x5B4);
                    pm.SendLocalizedMessage(1062317); // For your valor in combating the fallen beast, a special artifact has been bestowed on you.

                    if (!pm.PlaceInBackpack(i))
                    {
                        if (pm.BankBox != null && pm.BankBox.TryDropItem(killer, i, false))
                            pm.SendLocalizedMessage(1079730); // The item has been placed into your bank box.
                        else
                        {
                            pm.SendLocalizedMessage(1072523); // You find an artifact, but your backpack and bank are too full to hold it.
                            i.MoveToWorld(pm.Location, pm.Map);
                        }
                    }</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Seventh\EnergyField.cs

<pre>this.Movable = false;
                this.Light = LightType.Circle300;

                this.MoveToWorld(loc, map);

                this.m_Caster = caster;

                if (caster.InLOS(this))
                    this.Visible = true;
                else
                    this.Delete();

                if (this.Deleted)
                    return;

                this.m_Timer = new InternalTimer(this, duration);
                this.m_Timer.Start();</pre>

Fragment 2 in file Scripts\Spells\Sixth\ParalyzeField.cs

<pre>this.Movable = false;
                this.Light = LightType.Circle300;

                this.MoveToWorld(loc, map);

                if (caster.InLOS(this))
                    this.Visible = true;
                else
                    this.Delete();

                if (this.Deleted)
                    return;

                this.m_Caster = caster;

                this.m_Timer = new InternalTimer(this, duration);
                this.m_Timer.Start();</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\ArenaGump.cs

<pre>private void AddColoredText(int x, int y, int width, string text, int color)
        {
            if (color == 0)
                this.AddHtml(x, y, width, 20, text, false, false);
            else
                this.AddHtml(x, y, width, 20, this.Color(text, color), false, false);
        }</pre>

Fragment 2 in file Scripts\Services\ConPVP\LadderGump.cs

<pre>private void AddColoredText(int x, int y, int width, string text, int color)
        {
            if (color == 0)
                this.AddHtml(x, y, width, 20, text, false, false);
            else
                this.AddHtml(x, y, width, 20, this.Color(text, color), false, false);
        }</pre>

Fragment 3 in file Scripts\Services\ConPVP\Preferences.cs

<pre>private void AddColoredText(int x, int y, int width, string text, int color)
        {
            if (color == 0)
                this.AddHtml(x, y, width, 20, text, false, false);
            else
                this.AddHtml(x, y, width, 20, this.Color(text, color), false, false);
        }</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBHolyMage.cs

<pre>this.Add(new GenericBuyInfo(typeof(ScribesPen), 8, 10, 0xFBF, 0));
                this.Add(new GenericBuyInfo(typeof(BlankScroll), 5, 20, 0x0E34, 0));

                this.Add(new GenericBuyInfo("1041072", typeof(MagicWizardsHat), 11, 10, 0x1718, Utility.RandomDyedHue()));</pre>

Fragment 2 in file Scripts\VendorInfo\SBMage.cs

<pre>this.Add(new GenericBuyInfo(typeof(ScribesPen), 8, 10, 0xFBF, 0));

                this.Add(new GenericBuyInfo(typeof(BlankScroll), 5, 20, 0x0E34, 0));

                this.Add(new GenericBuyInfo("1041072", typeof(MagicWizardsHat), 11, 10, 0x1718, Utility.RandomDyedHue()));</pre>

Fragment 3 in file Scripts\VendorInfo\SBNecromancer.cs

<pre>this.Add(new GenericBuyInfo("1041072", typeof(MagicWizardsHat), 11, 10, 0x1718, Utility.RandomDyedHue()));
                this.Add(new GenericBuyInfo(typeof(ScribesPen), 8, 10, 0xFBF, 0));
                this.Add(new GenericBuyInfo(typeof(BlankScroll), 5, 20, 0x0E34, 0));</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Ultima\RadarCol.cs

<pre>private static int ConvertStringToInt(string text)
		{
			int result;
			if (text.Contains("0x"))
			{
				string convert = text.Replace("0x", "");
				int.TryParse(convert, NumberStyles.HexNumber, null, out result);
			}
			else
			{
				int.TryParse(text, NumberStyles.Integer, null, out result);
			}

			return result;
		}</pre>

Fragment 2 in file Ultima\SpeechList.cs

<pre>public static int ConvertStringToInt(string text)
		{
			int result;
			if (text.Contains("0x"))
			{
				string convert = text.Replace("0x", "");
				int.TryParse(convert, NumberStyles.HexNumber, null, out result);
			}
			else
			{
				int.TryParse(text, NumberStyles.Integer, null, out result);
			}

			return result;
		}</pre>

Fragment 3 in file Ultima\TileData.cs

<pre>public static int ConvertStringToInt(string text)
		{
			int result;
			if (text.Contains("0x"))
			{
				string convert = text.Replace("0x", "");
				int.TryParse(convert, NumberStyles.HexNumber, null, out result);
			}
			else
			{
				int.TryParse(text, NumberStyles.Integer, null, out result);
			}

			return result;
		}</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\LeatherGloves.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            if (this.IsArcane)
            {
                writer.Write(true);
                writer.Write((int)this.m_CurArcaneCharges);
                writer.Write((int)this.m_MaxArcaneCharges);
            }
            else
            {
                writer.Write(false);
            }
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\Cloaks.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            if (this.IsArcane)
            {
                writer.Write(true);
                writer.Write((int)this.m_CurArcaneCharges);
                writer.Write((int)this.m_MaxArcaneCharges);
            }
            else
            {
                writer.Write(false);
            }
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            if (this.IsArcane)
            {
                writer.Write(true);
                writer.Write((int)this.m_CurArcaneCharges);
                writer.Write((int)this.m_MaxArcaneCharges);
            }
            else
            {
                writer.Write(false);
            }
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Clothing\Shoes.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            if (this.IsArcane)
            {
                writer.Write(true);
                writer.Write((int)this.m_CurArcaneCharges);
                writer.Write((int)this.m_MaxArcaneCharges);
            }
            else
            {
                writer.Write(false);
            }
        }</pre>

## Duplicated Code. Size: 143

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BlackSolenQueen.cs

<pre>public void EndAcidBreath(Mobile m)
        {
            if (m == null || m.Deleted || !m.Alive || !Alive)
                return;

            if (0.2 >= Utility.RandomDouble())
                m.ApplyPoison(this, Poison.Greater);

            AOS.Damage(m, Utility.RandomMinMax(100, 120), 0, 0, 0, 100, 0);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BlackSolenWarrior.cs

<pre>public void EndAcidBreath(Mobile m)
        {
            if (m == null || m.Deleted || !m.Alive || !Alive)
                return;

            if (0.2 >= Utility.RandomDouble())
                m.ApplyPoison(this, Poison.Greater);

            AOS.Damage(m, Utility.RandomMinMax(100, 120), 0, 0, 0, 100, 0);
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\RedSolenQueen.cs

<pre>public void EndAcidBreath(Mobile m)
        {
            if (m == null || m.Deleted || !m.Alive || !Alive)
                return;

            if (0.2 >= Utility.RandomDouble())
                m.ApplyPoison(this, Poison.Greater);

            AOS.Damage(m, Utility.RandomMinMax(100, 120), 0, 0, 0, 100, 0);
        }</pre>

Fragment 4 in file Scripts\Mobiles\Normal\RedSolenWarrior.cs

<pre>public void EndAcidBreath(Mobile m)
        {
            if (m == null || m.Deleted || !m.Alive || !Alive)
                return;

            if (0.2 >= Utility.RandomDouble())
                m.ApplyPoison(this, Poison.Greater);

            AOS.Damage(m, Utility.RandomMinMax(100, 120), 0, 0, 0, 100, 0);
        }</pre>

## Duplicated Code. Size: 142

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AdminGump.cs

<pre>public void AddTextField(int x, int y, int width, int height, int index)
        {
            this.AddBackground(x - 2, y - 2, width + 4, height + 4, 0x2486);
            this.AddTextEntry(x + 2, y + 2, width - 4, height - 4, 0, index, "");
        }</pre>

Fragment 2 in file Scripts\Gumps\BanDurationGump.cs

<pre>public void AddTextField(int x, int y, int width, int height, int index)
        {
            this.AddBackground(x - 2, y - 2, width + 4, height + 4, 0x2486);
            this.AddTextEntry(x + 2, y + 2, width - 4, height - 4, 0, index, "");
        }</pre>

## Duplicated Code. Size: 142

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\RewardBag.cs

<pre>{
                    switch ( Utility.Random(4) )
                    {
                        case 0:
                            this.DropItem(Reward.Armor());
                            break;	
                        case 1:
                            this.DropItem(Reward.RangedWeapon());
                            break;
                        case 2:
                            this.DropItem(Reward.Weapon());
                            break;
                        case 3:
                            this.DropItem(Reward.Jewlery());
                            break;
                    }
                }</pre>

Fragment 2 in file Scripts\Items\Containers\RewardBox.cs

<pre>{ 
                switch ( Utility.Random(4) )
                {
                    case 0:
                        this.DropItem(Reward.Armor());
                        break;
                    case 1:
                        this.DropItem(Reward.RangedWeapon());
                        break;
                    case 2:
                        this.DropItem(Reward.Weapon());
                        break;
                    case 3:
                        this.DropItem(Reward.Jewlery());
                        break;	
                }
            }</pre>

## Duplicated Code. Size: 142

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Armor Refinement\Items.cs

<pre>public void GetSubCraftType()
        {
            switch (m_CraftType)
            {
                case RefinementCraftType.Blacksmith:
                    m_SubCraftType = (RefinementSubCraftType)Utility.RandomMinMax(4, 9); break;
                case RefinementCraftType.Tailor:
                    m_SubCraftType = (RefinementSubCraftType)Utility.RandomMinMax(0, 3); break;
                case RefinementCraftType.Carpenter:
                    m_SubCraftType = (RefinementSubCraftType)Utility.RandomMinMax(10, 11); break;
            }
        }</pre>

Fragment 2 in file Scripts\Services\Armor Refinement\Items.cs

<pre>public void GetSubCraftType()
        {
            switch (m_CraftType)
            {
                case RefinementCraftType.Blacksmith:
                    m_SubCraftType = (RefinementSubCraftType)Utility.RandomMinMax(4, 9); break;
                case RefinementCraftType.Tailor:
                    m_SubCraftType = (RefinementSubCraftType)Utility.RandomMinMax(0, 3); break;
                case RefinementCraftType.Carpenter:
                    m_SubCraftType = (RefinementSubCraftType)Utility.RandomMinMax(10, 11); break;
            }
        }</pre>

## Duplicated Code. Size: 142

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainQuestGump.cs

<pre>if (this.m_Offer)
                    this.AddHtmlLocalized(130, 45, 270, 16, 1049010, 0xFFFFFF, false, false); // Quest Offer
                else
                    this.AddHtmlLocalized(130, 45, 270, 16, 1046026, 0xFFFFFF, false, false); // Quest Log

                this.AddHtmlObject(160, 70, 200, 40, this.m_Quest.Title, DarkGreen, false, false);</pre>

Fragment 2 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainQuestGump.cs

<pre>if (this.m_Offer)
                this.AddHtmlLocalized(130, 45, 270, 16, 1049010, 0xFFFFFF, false, false); // Quest Offer
            else
                this.AddHtmlLocalized(130, 45, 270, 16, 1046026, 0xFFFFFF, false, false); // Quest Log	

            this.AddHtmlObject(160, 70, 200, 40, this.m_Quest.Title, DarkGreen, false, false);</pre>

## Duplicated Code. Size: 142

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (keywordargs.Length < 4)
				{
					return "Invalid ATTACHMENT format";
				}
				// syntax is ATTACHMENT,type,name,propname

				string apropname = keywordargs[3];
				string aname = keywordargs[2];
				Type attachtype = SpawnerType.GetType(keywordargs[1]);

				// allow empty string specifications to be used to indicate a null string which will match any name
				if (aname == "") aname = null;

				List<XmlAttachment> attachments = XmlAttach.FindAttachments(o, attachtype, aname);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (keywordargs.Length < 4)
				{
					return "Invalid ATTACHMENT format";
				}

				string apropname = keywordargs[3];
				string aname = keywordargs[2];
				Type attachtype = SpawnerType.GetType(keywordargs[1]);

				// allow empty string specifications to be used to indicate a null string which will match any name
				if (aname == "") aname = null;

				List<XmlAttachment> attachments = XmlAttach.FindAttachments(o, attachtype, aname);</pre>

## Duplicated Code. Size: 142

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGauntlet.cs

<pre>if(Participants == null || !GameInProgress) return;

            int leftstanding = 0;

            TeamInfo winner = null;

            ArrayList teams = GetTeams();

            foreach(TeamInfo t in teams)
            {
                if(!HasValidMembers(t)) continue;

                if(t.Score >= TargetScore)
                {
                    winner = t;
                    leftstanding = 1;
                    break;
                }
                leftstanding++;
                winner = t;

            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGauntlet.cs

<pre>if(Participants == null || !GameInProgress) return;

            int leftstanding = 0;

            TeamInfo winner = null;

            ArrayList teams = GetTeams();

            foreach(TeamInfo t in teams)
            {
                if(!HasValidMembers(t)) continue;

                if(t.Score >= TargetScore)
                {
                    winner = t;
                    leftstanding = 1;
                    break;
                }
                leftstanding++;
                winner = t;

            }</pre>

## Duplicated Code. Size: 142

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Mysticism\SpellDefinitions\SpellTriggerSpell.cs

<pre>AddPage(0);

                AddBackground(0, 0, 520, 404, 0x13BE);

                AddImageTiled(10, 10, 500, 20, 0xA40);
                AddImageTiled(10, 40, 500, 324, 0xA40);
                AddImageTiled(10, 374, 500, 20, 0xA40);
                AddAlphaRegion(10, 10, 500, 384);</pre>

Fragment 2 in file Scripts\Spells\Ninjitsu\AnimalForm.cs

<pre>AddPage(0);

				AddBackground(0, 0, 520, 404, 0x13BE);
				AddImageTiled(10, 10, 500, 20, 0xA40);
				AddImageTiled(10, 40, 500, 324, 0xA40);
				AddImageTiled(10, 374, 500, 20, 0xA40);
				AddAlphaRegion(10, 10, 500, 384);</pre>

## Duplicated Code. Size: 142

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>if (!item.IsVirtualItem)
            {
                UpdateTotal(item, TotalType.Gold, item.TotalGold);
                UpdateTotal(item, TotalType.Items, item.TotalItems + 1);
                UpdateTotal(item, TotalType.Weight, item.TotalWeight + item.PileWeight);
            }

            item.Delta(ItemDelta.Update);

            item.OnAdded(this);
            OnItemAdded(item);</pre>

Fragment 2 in file Server\Mobile.cs

<pre>if (!item.IsVirtualItem)
			{
				UpdateTotal(item, TotalType.Gold, item.TotalGold);
				UpdateTotal(item, TotalType.Items, item.TotalItems + 1);
				UpdateTotal(item, TotalType.Weight, item.TotalWeight + item.PileWeight);
			}

			item.Delta(ItemDelta.Update);

			item.OnAdded(this);
			OnItemAdded(item);</pre>

## Duplicated Code. Size: 142

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Glasses\GargishGlasses.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Glasses\Glasses.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Glasses\ElvenGlasses.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\BandanaBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\BascinetBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\CircletBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 7 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\FeatheredHatBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 8 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\GargishEarringsBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 9 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\JesterHatBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 10 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\NorseHelmBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 11 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\PlateHelmBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 12 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\RoyalCircletBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 13 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\SkullcapBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 14 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\TricorneHatBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 15 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\WizardsHatBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 16 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Loot\BracersofAlchemicalDevastation.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

Fragment 17 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Loot\GargishBracersofAlchemicalDevastation.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            SaveFlag flags = (SaveFlag)reader.ReadInt();

            if (GetSaveFlag(flags, SaveFlag.WeaponAttributes))
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this, reader);
            else
                this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
        }</pre>

## Duplicated Code. Size: 141

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\goldcarpetAddon.cs

<pre>ac = new AddonComponent( 2778 );
			AddComponent( ac, -1, 0, 0 );
			ac = new AddonComponent( 2778 );
			AddComponent( ac, -1, 1, 0 );
			ac = new AddonComponent( 2778 );
			AddComponent( ac, 0, 1, 0 );
			ac = new AddonComponent( 2778 );</pre>

Fragment 2 in file Scripts\Items\Addons\goldcarpetAddon.cs

<pre>ac = new AddonComponent( 2778 );
			AddComponent( ac, 0, -1, 0 );
			ac = new AddonComponent( 2778 );
			AddComponent( ac, 1, -1, 0 );
			ac = new AddonComponent( 2778 );
			AddComponent( ac, 1, 0, 0 );
			ac = new AddonComponent( 2778 );</pre>

## Duplicated Code. Size: 141

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\TaxidermyKit.cs

<pre>hunter = fish.Fisher;
                                        weight = (int)fish.Weight;
                                        DateTime dateCaught = fish.DateCaught;

                                        from.AddToBackpack(new FishTrophyDeed(weight, hunter, dateCaught, m_Table[i].DeedNumber, m_Table[i].AddonNumber, m_Table[i].NorthID));

                                        fish.Delete();
                                        m_Kit.Delete();
                                        return;</pre>

Fragment 2 in file Scripts\Items\Consumables\TaxidermyKit.cs

<pre>hunter = fish.Fisher;
                                        weight = (int)fish.Weight;
                                        DateTime dateCaught = fish.DateCaught;

                                        from.AddToBackpack(new FishTrophyDeed(weight, hunter, dateCaught, m_Table[i].DeedNumber, m_Table[i].AddonNumber, m_Table[i].NorthID));

                                        fish.Delete();
                                        m_Kit.Delete();
                                        return;</pre>

## Duplicated Code. Size: 141

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if (this.IsSetItem && !this.m_SetEquipped)
            {
                list.Add(1072378); // <br>Only when full set is present:				
                this.GetSetProperties(list);
            }

            if (m_ItemPower != ItemPower.None)
            {
                if (m_ItemPower <= ItemPower.LegendaryArtifact)
                    list.Add(1151488 + ((int)m_ItemPower - 1));
                else
                    list.Add(1152281 + ((int)m_ItemPower - 9));
            }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if (this.IsSetItem && !this.m_SetEquipped)
            {
                list.Add(1072378); // <br>Only when full set is present:				
                this.GetSetProperties(list);
            }
            #endregion

            if (m_ItemPower != ItemPower.None)
            {
                if (m_ItemPower <= ItemPower.LegendaryArtifact)
                    list.Add(1151488 + ((int)m_ItemPower - 1));
                else
                    list.Add(1152281 + ((int)m_ItemPower - 9));
            }</pre>

## Duplicated Code. Size: 141

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\PackHorse.cs

<pre>this.Fame = 0;
            this.Karma = 200;

            this.VirtualArmor = 16;

            this.Tamable = true;
            this.ControlSlots = 1;
            this.MinTameSkill = 11.1;

            Container pack = this.Backpack;

            if (pack != null)
                pack.Delete();

            pack = new StrongBackpack();
            pack.Movable = false;

            this.AddItem(pack);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\PackLlama.cs

<pre>this.Fame = 0;
            this.Karma = 200;

            this.VirtualArmor = 16;

            this.Tamable = true;
            this.ControlSlots = 1;
            this.MinTameSkill = 11.1;

            Container pack = this.Backpack;

            if (pack != null)
                pack.Delete();

            pack = new StrongBackpack();
            pack.Movable = false;

            this.AddItem(pack);</pre>

## Duplicated Code. Size: 141

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\SerpentsFangAssassin.cs

<pre>this.Female = Utility.RandomBool();
            this.Race = Race.Human;
            this.Hue = this.Race.RandomSkinHue();
            this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();
            this.Race.RandomFacialHair(this);

            this.AddItem(new ThighBoots(0x51D));</pre>

Fragment 2 in file Scripts\Mobiles\Normal\TigersClawThief.cs

<pre>this.Female = Utility.RandomBool();
            this.Race = Race.Human;
            this.Hue = this.Race.RandomSkinHue();
            this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();
            this.Race.RandomFacialHair(this);

            this.AddItem(new ThighBoots(0x51D));</pre>

## Duplicated Code. Size: 141

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\HireRanger.cs

<pre>this.AddItem(new RangerChest());
            this.AddItem(new RangerArms());
            this.AddItem(new RangerGloves());
            this.AddItem(new RangerGorget());
            this.AddItem(new RangerLegs());

            this.PackItem(new Arrow(20));
            this.PackGold(10, 75);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HireRangerArcher.cs

<pre>this.AddItem(new RangerChest());
            this.AddItem(new RangerArms());
            this.AddItem(new RangerGloves());
            this.AddItem(new RangerGorget());
            this.AddItem(new RangerLegs());

            this.PackItem(new Arrow(20));
            this.PackGold(10, 75);</pre>

## Duplicated Code. Size: 141

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Deeds.cs

<pre>if (reg.IsPartOf(typeof(TempNoHousingRegion)))
                    from.SendLocalizedMessage(501270); // Lord British has decreed a 'no build' period, thus you cannot build this house at this time.
                else if (reg.IsPartOf(typeof(TreasureRegion)) || reg.IsPartOf(typeof(HouseRegion)))
                    from.SendLocalizedMessage(1043287); // The house could not be created here.  Either something is blocking the house, or the house would not be on valid terrain.
                else if (reg.IsPartOf(typeof(HouseRaffleRegion)))
                    from.SendLocalizedMessage(1150493); // You must have a deed for this plot of land in order to build here.
                else
                    from.SendLocalizedMessage(501265); // Housing can not be created in this area.</pre>

Fragment 2 in file Scripts\Multis\HousePlacementTool.cs

<pre>if (reg.IsPartOf(typeof(TempNoHousingRegion)))
                    from.SendLocalizedMessage(501270); // Lord British has decreed a 'no build' period, thus you cannot build this house at this time.
                else if (reg.IsPartOf(typeof(TreasureRegion)) || reg.IsPartOf(typeof(HouseRegion)))
                    from.SendLocalizedMessage(1043287); // The house could not be created here.  Either something is blocking the house, or the house would not be on valid terrain.
                else if (reg.IsPartOf(typeof(HouseRaffleRegion)))
                    from.SendLocalizedMessage(1150493); // You must have a deed for this plot of land in order to build here.
                else
                    from.SendLocalizedMessage(501265); // Housing can not be created in this area.</pre>

## Duplicated Code. Size: 141

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlPoison.cs

<pre>get
            {
                if (this.p_level < 1)
                {
                    return Poison.Lesser;
                }
                else if (this.p_level == 1)
                {
                    return Poison.Regular;
                }
                else if (this.p_level == 2)
                {
                    return Poison.Greater;
                }
                else if (this.p_level == 3)
                {
                    return Poison.Deadly;
                }
                else if (this.p_level > 3)
                {
                    return Poison.Lethal;
                }
                else
                {
                    return Poison.Regular;
                }
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlPoison.cs

<pre>get
            {
                if (this.p_level < 1)
                {
                    return Poison.Lesser;
                }
                else if (this.p_level == 1)
                {
                    return Poison.Regular;
                }
                else if (this.p_level == 2)
                {
                    return Poison.Greater;
                }
                else if (this.p_level == 3)
                {
                    return Poison.Deadly;
                }
                else if (this.p_level > 3)
                {
                    return Poison.Lethal;
                }
                else
                {
                    return Poison.Regular;
                }
            }</pre>

## Duplicated Code. Size: 141

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>if(klist != null && klist.Count > 0)
			{
				for(int j=0;j<klist.Count;j++)
				{
					if(((AggressorInfo)klist[j]).Attacker == source || ((AggressorInfo)klist[j]).Defender == source)
					{
						klist.Remove(klist[j]);
						break;
					}
				}
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>if(klist != null && klist.Count > 0)
			{
				for(int j=0;j<klist.Count;j++)
				{
					if(((AggressorInfo)klist[j]).Attacker == source || ((AggressorInfo)klist[j]).Defender == source)
					{
						klist.Remove(klist[j]);
						break;
					}
				}
			}</pre>

## Duplicated Code. Size: 141

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void WriteDeltaTime(DateTime value)
		{
			long ticks = value.Ticks;
			long now = DateTime.UtcNow.Ticks;

			TimeSpan d;

			try
			{
				d = new TimeSpan(ticks - now);
			}
			catch
			{
				if (ticks < now)
				{
					d = TimeSpan.MaxValue;
				}
				else
				{
					d = TimeSpan.MaxValue;
				}
			}

			Write(d);
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void WriteDeltaTime(DateTime value)
		{
			long ticks = value.Ticks;
			long now = DateTime.UtcNow.Ticks;

			TimeSpan d;

			try
			{
				d = new TimeSpan(ticks - now);
			}
			catch
			{
				if (ticks < now)
				{
					d = TimeSpan.MaxValue;
				}
				else
				{
					d = TimeSpan.MaxValue;
				}
			}

			Write(d);
		}</pre>

## Duplicated Code. Size: 141

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public TimeSpan GameTOD
		{
			get
			{
				int hours;
				int minutes;

				Server.Items.Clock.GetTime(this.Map, this.Location.X, this.Location.Y, out  hours, out  minutes);
				return (new DateTime(DateTime.UtcNow.Year,DateTime.UtcNow.Month,DateTime.UtcNow.Day,hours, minutes,0).TimeOfDay);
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public TimeSpan GameTOD
		{
			get
			{
				int hours;
				int minutes;

				Server.Items.Clock.GetTime(this.Map, this.Location.X, this.Location.Y, out  hours, out  minutes);
				return (new DateTime(DateTime.UtcNow.Year,DateTime.UtcNow.Month,DateTime.UtcNow.Day,hours, minutes,0).TimeOfDay);
			}
		}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>public TimeSpan GameTOD
		{
			get
			{
				int hours;
				int minutes;

				Server.Items.Clock.GetTime(this.Map, this.Location.X, this.Location.Y, out  hours, out  minutes);
				return (new DateTime(DateTime.UtcNow.Year, DateTime.UtcNow.Month, DateTime.UtcNow.Day, hours, minutes, 0).TimeOfDay);
			}
		}</pre>

## Duplicated Code. Size: 140

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Docs.cs

<pre>html.WriteLine("      <style type=\"text/css\">");
				html.WriteLine("      body { background-color: white; font-family: Tahoma; color: #000000; }");
				html.WriteLine("      a, a:visited { color: #000000; }");
				html.WriteLine("      a:active, a:hover { color: #808080; }");
				html.WriteLine("      table { width: 100%; }");
				html.WriteLine("      </style>");
				html.WriteLine("      <link rel=\"stylesheet\" type=\"text/css\" href=\"styles.css\" />");
				html.WriteLine("   </head>");
				html.WriteLine("   <body>");
				html.WriteLine("      <h4><a href=\"index.html\">Back to the index</a></h4>");</pre>

Fragment 2 in file Scripts\Commands\Docs.cs

<pre>html.WriteLine("      <style type=\"text/css\">");
				html.WriteLine("      body { background-color: white; font-family: Tahoma; color: #000000; }");
				html.WriteLine("      a, a:visited { color: #000000; }");
				html.WriteLine("      a:active, a:hover { color: #808080; }");
				html.WriteLine("      table { width: 100%; }");
				html.WriteLine("      </style>");
				html.WriteLine("      <link rel=\"stylesheet\" type=\"text/css\" href=\"styles.css\" />");
				html.WriteLine("   </head>");
				html.WriteLine("   <body>");
				html.WriteLine("      <h4><a href=\"index.html\">Back to the index</a></h4>");</pre>

## Duplicated Code. Size: 140

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Wreath.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                if (this.m_Deed.Deleted)
                    return;

                switch( info.ButtonID )
                {
                    case 1:
                        this.m_Deed.PlaceAddon(this.m_From, this.m_Loc, false, true);
                        break;
                    case 2:
                        this.m_Deed.PlaceAddon(this.m_From, this.m_Loc, true, false);
                        break;
                }
            }</pre>

Fragment 2 in file Scripts\Items\Decorative\Mistletoe.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                if (this.m_Deed.Deleted)
                    return;

                switch( info.ButtonID )
                {
                    case 1:
                        this.m_Deed.PlaceAddon(this.m_From, this.m_Loc, false, true);
                        break;
                    case 2:
                        this.m_Deed.PlaceAddon(this.m_From, this.m_Loc, true, false);
                        break;
                }
            }</pre>

## Duplicated Code. Size: 140

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\BaseStatuette.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                Mobile from = sender.Mobile;

                if (info.ButtonID == 1)
                {
                    bool newValue = !this.m_Statuette.TurnedOn;
                    this.m_Statuette.TurnedOn = newValue;

                    if (newValue && !this.m_Statuette.IsLockedDown)
                        from.SendLocalizedMessage(502693); // Remember, this only works when locked down.
                }
                else
                {
                    from.SendLocalizedMessage(502694); // Cancelled action.
                }
            }</pre>

Fragment 2 in file Scripts\Items\Decorative\MonsterStatuette.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                Mobile from = sender.Mobile;

                if (info.ButtonID == 1)
                {
                    bool newValue = !this.m_Statuette.TurnedOn;
                    this.m_Statuette.TurnedOn = newValue;

                    if (newValue && !this.m_Statuette.IsLockedDown)
                        from.SendLocalizedMessage(502693); // Remember, this only works when locked down.
                }
                else
                {
                    from.SendLocalizedMessage(502694); // Cancelled action.
                }
            }</pre>

## Duplicated Code. Size: 140

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x3709, 15, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x208);
                    Effects.SendBoltEffect(m, true, 0);</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x3709, 15, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x208);
                    Effects.SendBoltEffect(m, true, 0);</pre>

## Duplicated Code. Size: 140

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGauntlet.cs

<pre>case 0:
                m_Challenger = reader.ReadMobile();

                m_Organizers.Add(m_Challenger);

                m_GameLocked = reader.ReadBool();
                m_GameInProgress = reader.ReadBool();
                m_TotalPurse = reader.ReadInt();
                m_EntryFee = reader.ReadInt();
                m_ArenaSize = reader.ReadInt();
                m_Winner = reader.ReadMobile();
                m_TargetScore = reader.ReadInt();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGauntlet.cs

<pre>case 0:
                m_Challenger = reader.ReadMobile();

                m_Organizers.Add(m_Challenger);

                m_GameLocked = reader.ReadBool();
                m_GameInProgress = reader.ReadBool();
                m_TotalPurse = reader.ReadInt();
                m_EntryFee = reader.ReadInt();
                m_ArenaSize = reader.ReadInt();
                m_Winner = reader.ReadMobile();
                m_TargetScore = reader.ReadInt();</pre>

## Duplicated Code. Size: 139

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\TOTGreaterArtifacts.cs

<pre>set
            {
                this.m_Type = value;

                int v = (int)this.m_Type;

                if (v >= 0 && v < m_Table.Length)
                {
                    this.Hue = m_Table[v][0];
                    this.Label = m_Table[v][1];
                }
                else
                {
                    this.Hue = 0;
                    this.Label = -1;
                }
            }</pre>

Fragment 2 in file Scripts\Items\Artifacts\TOTLesserArtifacts.cs

<pre>set
            {
                this.m_Type = value;

                int v = (int)this.m_Type;

                if (v >= 0 && v < m_Table.Length)
                {
                    this.Hue = m_Table[v][0];
                    this.Label = m_Table[v][1];
                }
                else
                {
                    this.Hue = 0;
                    this.Label = -1;
                }
            }</pre>

## Duplicated Code. Size: 139

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\DragonBardingDeed.cs

<pre>if (makersMark)
                this.Crafter = from;

            Type resourceType = typeRes;

            if (resourceType == null)
                resourceType = craftItem.Resources.GetAt(0).ItemType;

            this.Resource = CraftResources.GetFromType(resourceType);

            CraftContext context = craftSystem.GetContext(from);

            if (context != null && context.DoNotColor)
                this.Hue = 0;

            return quality;</pre>

Fragment 2 in file Scripts\Items\Decorative\CraftableFurniture.cs

<pre>if (makersMark)
                this.Crafter = from;

            Type resourceType = typeRes;

            if (resourceType == null)
                resourceType = craftItem.Resources.GetAt(0).ItemType;

            this.Resource = CraftResources.GetFromType(resourceType);

            CraftContext context = craftSystem.GetContext(from);

            if (context != null && context.DoNotColor)
                this.Hue = 0;

            return quality;</pre>

## Duplicated Code. Size: 139

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Corpses\Corpse.cs

<pre>int count = reader.ReadInt();

						for (int i = 0; i < count; ++i)
						{
							Item item = reader.ReadItem();

							if (reader.ReadBool())
							{
								SetRestoreInfo(item, reader.ReadPoint3D());
							}
							else if (item != null)
							{
								SetRestoreInfo(item, item.Location);
							}
						}</pre>

Fragment 2 in file Scripts\Items\Decorative\Corpses\Corpse.cs

<pre>int count = reader.ReadInt();

						for (int i = 0; i < count; ++i)
						{
							Item item = reader.ReadItem();

							if (reader.ReadBool())
							{
								SetRestoreInfo(item, reader.ReadPoint3D());
							}
							else if (item != null)
							{
								SetRestoreInfo(item, item.Location);
							}
						}</pre>

## Duplicated Code. Size: 139

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>if (m != comb && m.Combatant == this.m_Mobile && this.m_Mobile.InRange(m, 12) && this.CanDispel(m))
                    {
                        double prio = this.m_Mobile.GetDistanceToSqrt(m);

                        if (active == null || prio < activePrio)
                        {
                            active = m;
                            activePrio = prio;

                            if (activePrio <= 2)
                                return active;
                        }
                    }</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>if (m != comb && m.Combatant == this.m_Mobile && this.m_Mobile.InRange(m, 12) && this.CanDispel(m))
                    {
                        double prio = this.m_Mobile.GetDistanceToSqrt(m);

                        if (active == null || prio < activePrio)
                        {
                            active = m;
                            activePrio = prio;

                            if (activePrio <= 2)
                                return active;
                        }
                    }</pre>

## Duplicated Code. Size: 139

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GreaterMongbat.cs

<pre>this.SetDamage(5, 7);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 25);

            this.SetSkill(SkillName.MagicResist, 15.1, 30.0);
            this.SetSkill(SkillName.Tactics, 35.1, 50.0);
            this.SetSkill(SkillName.Wrestling, 20.1, 35.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\StrongMongbat.cs

<pre>this.SetDamage(5, 7);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 25);

            this.SetSkill(SkillName.MagicResist, 15.1, 30.0);
            this.SetSkill(SkillName.Tactics, 35.1, 50.0);
            this.SetSkill(SkillName.Wrestling, 20.1, 35.0);</pre>

## Duplicated Code. Size: 139

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>public virtual void OfferResurrection(Mobile m)
        {
            this.Direction = this.GetDirectionTo(m);
            this.Say(501224); // Thou hast strayed from the path of virtue, but thou still deservest a second chance.

            m.PlaySound(0x214);
            m.FixedEffect(0x376A, 10, 16);

            m.CloseGump(typeof(ResurrectGump));
            m.SendGump(new ResurrectGump(m, ResurrectMessage.Healer));
        }</pre>

Fragment 2 in file Scripts\Quests\Escortables.cs

<pre>public virtual void OfferResurrection(Mobile m)
        {
            this.Direction = this.GetDirectionTo(m);
            this.Say(501224); // Thou hast strayed from the path of virtue, but thou still deservest a second chance.

            m.PlaySound(0x214);
            m.FixedEffect(0x376A, 10, 16);

            m.CloseGump(typeof(ResurrectGump));
            m.SendGump(new ResurrectGump(m, ResurrectMessage.Healer));
        }</pre>

## Duplicated Code. Size: 139

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\VeteranRewards\DaviesLocker.cs

<pre>int count = reader.ReadInt();
            for (int i = 0; i < count; i++)
            {
                switch (reader.ReadInt())
                {
                    case 0:
                        m_Entries.Add(new SOSEntry(reader));
                        break;
                    case 1:
                        m_Entries.Add(new TreasureMapEntry(reader));
                        break;
                    case 2: break;
                }
            }</pre>

Fragment 2 in file Scripts\Services\VeteranRewards\DaviesLocker.cs

<pre>int count = reader.ReadInt();
            for (int i = 0; i < count; i++)
            {
                switch (reader.ReadInt())
                {
                    case 0:
                        m_Entries.Add(new SOSEntry(reader));
                        break;
                    case 1:
                        m_Entries.Add(new TreasureMapEntry(reader));
                        break;
                    case 2: break;
                }
            }</pre>

## Duplicated Code. Size: 139

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AdminGump.cs

<pre>if (results.Count == 1)
                                        from.SendGump(new AdminGump(from, AdminGumpPage.AccountDetails_Information, 0, null, "One match found.", results[0]));
                                    else
                                        from.SendGump(new AdminGump(from, AdminGumpPage.Accounts, 0, results, (results.Count == 0 ? "Nothing matched your search terms." : null), new ArrayList()));

                                    break;</pre>

Fragment 2 in file Scripts\Gumps\AdminGump.cs

<pre>if (results.Count == 1)
                                        from.SendGump(new AdminGump(from, AdminGumpPage.AccountDetails_Information, 0, null, "One match found.", results[0]));
                                    else
                                        from.SendGump(new AdminGump(from, AdminGumpPage.Accounts, 0, results, (results.Count == 0 ? "Nothing matched your search terms." : null), new ArrayList()));

                                    break;</pre>

Fragment 3 in file Scripts\Gumps\AdminGump.cs

<pre>if (results.Count == 1)
                                        from.SendGump(new AdminGump(from, AdminGumpPage.AccountDetails_Information, 0, null, "One match found.", results[0]));
                                    else
                                        from.SendGump(new AdminGump(from, AdminGumpPage.Accounts, 0, results, (results.Count == 0 ? "Nothing matched your search terms." : null), new ArrayList()));

                                    break;</pre>

Fragment 4 in file Scripts\Gumps\AdminGump.cs

<pre>if (results.Count == 1)
                                        from.SendGump(new AdminGump(from, AdminGumpPage.AccountDetails_Information, 0, null, "One match found.", results[0]));
                                    else
                                        from.SendGump(new AdminGump(from, AdminGumpPage.Accounts, 0, results, (results.Count == 0 ? "Nothing matched your search terms." : null), new ArrayList()));

                                    break;</pre>

## Duplicated Code. Size: 138

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\SerpentArrow.cs

<pre>if (dist >= 3.0)
                    total -= (dist - 3.0) * 10.0;

                if (total >= 200.0 && 1 > Utility.Random(10))
                    level = 3;
                else if (total > (Core.AOS ? 170.1 : 170.0))
                    level = 2;
                else if (total > (Core.AOS ? 130.1 : 130.0))
                    level = 1;
                else
                    level = 0;</pre>

Fragment 2 in file Scripts\Spells\Third\Poison.cs

<pre>if (dist >= 3.0)
                            total -= (dist - 3.0) * 10.0;

                        if (total >= 200.0 && 1 > Utility.Random(10))
                            level = 3;
                        else if (total > (Core.AOS ? 170.1 : 170.0))
                            level = 2;
                        else if (total > (Core.AOS ? 130.1 : 130.0))
                            level = 1;
                        else
                            level = 0;</pre>

## Duplicated Code. Size: 138

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\CategorizedAddGump.cs

<pre>x += PrevWidth + OffsetSize;

            int emptyWidth = TotalWidth - (PrevWidth * 2) - NextWidth - (OffsetSize * 5) - (OldStyle ? SetWidth + OffsetSize : 0);

            if (!OldStyle)
                this.AddImageTiled(x - (OldStyle ? OffsetSize : 0), y, emptyWidth + (OldStyle ? OffsetSize * 2 : 0), EntryHeight, EntryGumpID);</pre>

Fragment 2 in file Scripts\Gumps\Go\GoGump.cs

<pre>x += PrevWidth + OffsetSize;

            int emptyWidth = TotalWidth - (PrevWidth * 2) - NextWidth - (OffsetSize * 5) - (OldStyle ? SetWidth + OffsetSize : 0);

            if (!OldStyle)
                this.AddImageTiled(x - (OldStyle ? OffsetSize : 0), y, emptyWidth + (OldStyle ? OffsetSize * 2 : 0), EntryHeight, EntryGumpID);</pre>

## Duplicated Code. Size: 138

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\HouseGump.cs

<pre>if (this.m_House.Deleted)
                return;

            Mobile from = sender.Mobile;

            bool isCombatRestricted = this.m_House.IsCombatRestricted(from);

            bool isOwner = this.m_House.IsOwner(from);
            bool isCoOwner = isOwner || this.m_House.IsCoOwner(from);
            bool isFriend = isCoOwner || this.m_House.IsFriend(from);</pre>

Fragment 2 in file Scripts\Gumps\HouseGumpAOS.cs

<pre>if (this.m_House.Deleted)
                return;

            Mobile from = sender.Mobile;

            bool isCombatRestricted = this.m_House.IsCombatRestricted(from);

            bool isOwner = this.m_House.IsOwner(from);
            bool isCoOwner = isOwner || this.m_House.IsCoOwner(from);
            bool isFriend = isCoOwner || this.m_House.IsFriend(from);</pre>

## Duplicated Code. Size: 138

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\FlourMillEastAddon.cs

<pre>private int[] FindItemTable(int itemID)
        {
            for (int i = 0; i < m_StageTable.Length; ++i)
            {
                int[] itemTable = m_StageTable[i];

                for (int j = 0; j < itemTable.Length; ++j)
                {
                    if (itemTable[j] == itemID)
                        return itemTable;
                }
            }

            return null;
        }</pre>

Fragment 2 in file Scripts\Items\Addons\FlourMillSouthAddon.cs

<pre>private int[] FindItemTable(int itemID)
        {
            for (int i = 0; i < m_StageTable.Length; ++i)
            {
                int[] itemTable = m_StageTable[i];

                for (int j = 0; j < itemTable.Length; ++j)
                {
                    if (itemTable[j] == itemID)
                        return itemTable;
                }
            }

            return null;
        }</pre>

## Duplicated Code. Size: 138

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\TaxidermyKit.cs

<pre>public override void OnDoubleClick( Mobile from )
		{
			BaseHouse house = BaseHouse.FindHouseAt( this );

			if ( house != null && house.IsCoOwner( from ) )
			{
				if ( from.InRange( GetWorldLocation(), 1 ) )
				{
					from.AddToBackpack( this.Deed );
					Delete();
				}
				else
				{
					from.SendLocalizedMessage( 500295 ); // You are too far away to do that.
				}
			}
		}</pre>

Fragment 2 in file Scripts\Services\HuntmasterChallenge\HuntTrophy.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            BaseHouse house = BaseHouse.FindHouseAt(this);

            if (house != null && house.IsCoOwner(from))
            {
                if (from.InRange(GetWorldLocation(), 1))
                {
                    from.AddToBackpack(this.Deed);
                    Delete();
                }
                else
                {
                    from.SendLocalizedMessage(500295); // You are too far away to do that.
                }
            }
        }</pre>

## Duplicated Code. Size: 138

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\AnimalAI.cs

<pre>if (this.AcquireFocusMob(this.m_Mobile.RangePerception, this.m_Mobile.FightMode, false, false, true))
            {
                if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("I have detected {0}, attacking", this.m_Mobile.FocusMob.Name);

                this.m_Mobile.Combatant = this.m_Mobile.FocusMob;
                this.Action = ActionType.Combat;
            }
            else
            {
                base.DoActionWander();
            }</pre>

Fragment 2 in file Scripts\Mobiles\AI\MeleeAI.cs

<pre>if (this.AcquireFocusMob(this.m_Mobile.RangePerception, this.m_Mobile.FightMode, false, false, true))
            {
                if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("I have detected {0}, attacking", this.m_Mobile.FocusMob.Name);

                this.m_Mobile.Combatant = this.m_Mobile.FocusMob;
                this.Action = ActionType.Combat;
            }
            else
            {
                base.DoActionWander();
            }</pre>

## Duplicated Code. Size: 138

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MeleeAI.cs

<pre>if (this.AcquireFocusMob(this.m_Mobile.RangePerception, this.m_Mobile.FightMode, false, false, true))
            {
                if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("I have detected {0}, attacking", this.m_Mobile.FocusMob.Name);

                this.m_Mobile.Combatant = this.m_Mobile.FocusMob;
                this.Action = ActionType.Combat;
            }
            else
            {
                base.DoActionGuard();
            }</pre>

Fragment 2 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>if (this.AcquireFocusMob(this.m_Mobile.RangePerception, this.m_Mobile.FightMode, false, false, true))
            {
                if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("I have detected {0}, attacking", this.m_Mobile.FocusMob.Name);

                this.m_Mobile.Combatant = this.m_Mobile.FocusMob;
                this.Action = ActionType.Combat;
            }
            else
            {
                base.DoActionGuard();
            }</pre>

## Duplicated Code. Size: 138

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GargishOutcast.cs

<pre>AddImmovableItem(new GargishClothChest(Utility.RandomNeutralHue()));
            AddImmovableItem(new GargishClothArms(Utility.RandomNeutralHue()));
            AddImmovableItem(new GargishClothLegs(Utility.RandomNeutralHue()));
            AddImmovableItem(new GargishClothKilt(Utility.RandomNeutralHue()));

            if (Utility.RandomBool())
                AddImmovableItem(new GargishRobe());</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GargishRouser.cs

<pre>AddImmovableItem(new GargishClothChest(Utility.RandomNeutralHue()));
            AddImmovableItem(new GargishClothArms(Utility.RandomNeutralHue()));
            AddImmovableItem(new GargishClothLegs(Utility.RandomNeutralHue()));
            AddImmovableItem(new GargishClothKilt(Utility.RandomNeutralHue()));

			if(Utility.RandomBool())
                AddImmovableItem(new GargishRobe());</pre>

## Duplicated Code. Size: 138

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\GypsyBanker.cs

<pre>base.InitOutfit();

			switch (Utility.Random(4))
			{
				case 0:
					AddItem(new JesterHat(Utility.RandomBrightHue()));
					break;
				case 1:
					AddItem(new Bandana(Utility.RandomBrightHue()));
					break;
				case 2:
					AddItem(new SkullCap(Utility.RandomBrightHue()));
					break;
			}</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\GypsyMaiden.cs

<pre>base.InitOutfit();

			switch (Utility.Random(4))
			{
				case 0:
					AddItem(new JesterHat(Utility.RandomBrightHue()));
					break;
				case 1:
					AddItem(new Bandana(Utility.RandomBrightHue()));
					break;
				case 2:
					AddItem(new SkullCap(Utility.RandomBrightHue()));
					break;
			}</pre>

## Duplicated Code. Size: 138

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>break;
				case EodonTribe.Sakkhra:
                    SetWearable(new StuddedChest(), 2118);
                    SetWearable(new LeatherArms(), 2106);
                    SetWearable(new LeatherGloves(), 2106);
                    SetWearable(new SkullCap(), 2118);
                    SetWearable(new RingmailLegs(), 2106);
                    SetWearable(new ThighBoots(), 2106);</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>break;
                case EodonTribe.Sakkhra:
                    SetWearable(new StuddedChest(), 2118);
                    SetWearable(new LeatherArms(), 2106);
                    SetWearable(new LeatherGloves(), 2106);
                    SetWearable(new SkullCap(), 2118);
                    SetWearable(new RingmailLegs(), 2106);
                    SetWearable(new ThighBoots(), 2106);</pre>

## Duplicated Code. Size: 138

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\CommodityBrokerGump.cs

<pre>AddBackground(190, 330, 285, 22, 9350);
			AddTextEntry(191, 330, 285, 20, LabelHueBlue, 2, "");
            AddButton(480, 330, 4014, 4016, 4, GumpButtonType.Reply, 0);

            AddButton(150, 365, 4005, 4007, 5, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>AddBackground(190, 330, 285, 22, 9350);
			AddTextEntry(191, 330, 285, 20, LabelHueBlue, 2, "");
            AddButton(480, 330, 4014, 4016, 4, GumpButtonType.Reply, 0);

			AddButton(150, 365, 4005, 4007, 5, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 138

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestLeaders.cs

<pre>xf.WriteEndElement();

					xf.WriteStartElement( "Guild" );
					xf.WriteString( guildname );
					xf.WriteEndElement();
#if(FACTIONS)
					xf.WriteStartElement( "Faction" );
					xf.WriteString( factionname );
					xf.WriteEndElement();
#endif
					xf.WriteStartElement( "Points" );
					xf.WriteString( a.Points.ToString() );
					xf.WriteEndElement();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>xf.WriteEndElement();

					xf.WriteStartElement( "Guild" );
					xf.WriteString( guildname );
					xf.WriteEndElement();
#if(FACTIONS)
					xf.WriteStartElement( "Faction" );
					xf.WriteString( factionname );
					xf.WriteEndElement();
#endif
					xf.WriteStartElement( "Points" );
					xf.WriteString( a.Points.ToString() );
					xf.WriteEndElement();</pre>

## Duplicated Code. Size: 138

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\BaseHealer.cs

<pre>public virtual void OfferHeal(PlayerMobile m)
        {
            this.Direction = this.GetDirectionTo(m);

            if (m.CheckYoungHealTime())
            {
                this.Say(501229); // You look like you need some healing my child.

                m.PlaySound(0x1F2);
                m.FixedEffect(0x376A, 9, 32);

                m.Hits = m.HitsMax;
            }
            else
            {
                this.Say(501228); // I can do no more for you at this time.
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>public virtual void OfferHeal(PlayerMobile m)
        {
            this.Direction = this.GetDirectionTo(m);

            if (m.CheckYoungHealTime())
            {
                this.Say(501229); // You look like you need some healing my child.

                m.PlaySound(0x1F2);
                m.FixedEffect(0x376A, 9, 32);

                m.Hits = m.HitsMax;
            }
            else
            {
                this.Say(501228); // I can do no more for you at this time.
            }
        }</pre>

Fragment 3 in file Scripts\Quests\Escortables.cs

<pre>public virtual void OfferHeal(PlayerMobile m)
        {
            this.Direction = this.GetDirectionTo(m);

            if (m.CheckYoungHealTime())
            {
                this.Say(501229); // You look like you need some healing my child.

                m.PlaySound(0x1F2);
                m.FixedEffect(0x376A, 9, 32);

                m.Hits = m.HitsMax;
            }
            else
            {
                this.Say(501228); // I can do no more for you at this time.
            }
        }</pre>

## Duplicated Code. Size: 137

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Corpses\Packets.cs

<pre>m_Stream.Write(HairInfo.FakeSerial(beheld.Owner) - 2);
				m_Stream.Write((ushort)beheld.Hair.ItemID);
				m_Stream.Write((byte)0); // signed, itemID offset
				m_Stream.Write((ushort)1);
				m_Stream.Write((short)0);
				m_Stream.Write((short)0);</pre>

Fragment 2 in file Scripts\Items\Decorative\Corpses\Packets.cs

<pre>m_Stream.Write(HairInfo.FakeSerial(beheld.Owner) - 2);
				m_Stream.Write((ushort)beheld.Hair.ItemID);
				m_Stream.Write((byte)0); // signed, itemID offset
				m_Stream.Write((ushort)1);
				m_Stream.Write((short)0);
				m_Stream.Write((short)0);</pre>

## Duplicated Code. Size: 137

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Corpses\Packets.cs

<pre>m_Stream.Write(FacialHairInfo.FakeSerial(beheld.Owner) - 2);
				m_Stream.Write((ushort)beheld.FacialHair.ItemID);
				m_Stream.Write((byte)0); // signed, itemID offset
				m_Stream.Write((ushort)1);
				m_Stream.Write((short)0);
				m_Stream.Write((short)0);</pre>

Fragment 2 in file Scripts\Items\Decorative\Corpses\Packets.cs

<pre>m_Stream.Write(FacialHairInfo.FakeSerial(beheld.Owner) - 2);
				m_Stream.Write((ushort)beheld.FacialHair.ItemID);
				m_Stream.Write((byte)0); // signed, itemID offset
				m_Stream.Write((ushort)1);
				m_Stream.Write((short)0);
				m_Stream.Write((short)0);</pre>

## Duplicated Code. Size: 137

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\MedusaLairAltar.cs

<pre>public override bool OnDragDrop(Mobile from, Item dropped)
        { 
            if (this.m_Altar == null)
                return false;

            if (this.m_Altar.Activated)
            { 
                from.SendLocalizedMessage(1075213); // The master of this realm has already been summoned and is engaged in combat.  Your opportunity will come after he has squashed the current batch of intruders!
                return false;
            }

            if (!this.m_Altar.TryDrop(from, dropped, this.m_ID))
            {
                from.SendLocalizedMessage(1072682); // This is not the proper key.
                return false;
            }
            else
                return true;
        }</pre>

Fragment 2 in file Scripts\Items\Functional\StygianDragonAltar.cs

<pre>public override bool OnDragDrop(Mobile from, Item dropped)
        { 
            if (this.m_Altar == null)
                return false;

            if (this.m_Altar.Activated)
            { 
                from.SendLocalizedMessage(1075213); // The master of this realm has already been summoned and is engaged in combat.  Your opportunity will come after he has squashed the current batch of intruders!
                return false;
            }

            if (!this.m_Altar.TryDrop(from, dropped, this.m_ID))
            {
                from.SendLocalizedMessage(1072682); // This is not the proper key.
                return false;
            }
            else
                return true;
        }</pre>

## Duplicated Code. Size: 137

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DemonKnight.cs

<pre>this.SetMana(5000);

            this.SetDamage(17, 21);

            this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Poison, 20);
            this.SetDamageType(ResistanceType.Energy, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Void Creatures\UsagralemBallem.cs

<pre>this.SetMana(5000);

            this.SetDamage(17, 21);

            this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Poison, 20);
            this.SetDamageType(ResistanceType.Energy, 20);</pre>

## Duplicated Code. Size: 137

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GreenGoblinScout.cs

<pre>private void TryToDetectHidden()
		{
			Mobile m = FindTarget();

			if (m != null)
			{
				if (Core.TickCount >= NextSkillTime && UseSkill(SkillName.DetectHidden))
				{
					Target targ = Target;

					if (targ != null)
					{
						targ.Invoke(this, this);
					}

					Effects.PlaySound(Location, Map, 0x340);
				}
			}
		}</pre>

Fragment 2 in file Scripts\Mobiles\Normal\OrcScout.cs

<pre>private void TryToDetectHidden()
		{
			Mobile m = FindTarget();

			if (m != null)
			{
				if (Core.TickCount >= NextSkillTime && UseSkill(SkillName.DetectHidden))
				{
					Target targ = Target;

					if (targ != null)
					{
						targ.Invoke(this, this);
					}

					Effects.PlaySound(Location, Map, 0x340);
				}
			}
		}</pre>

## Duplicated Code. Size: 137

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Slith.cs

<pre>if (Utility.RandomDouble() < 0.05)
            {
                c.DropItem(new SlithEye());
            }

            if (Utility.RandomDouble() < 0.25)
            {
                switch (Utility.Random(2))
                {
                    case 0:
                        c.DropItem(new AncientPotteryFragments());
                        break;
                    case 1:
                        c.DropItem(new TatteredAncientScroll());
                        break;
                }
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\StoneSlith.cs

<pre>if (Utility.RandomDouble() < 0.05)
            {
                c.DropItem(new SlithEye());
            }

            if (Utility.RandomDouble() < 0.25)
            {
                switch (Utility.Random(2))
                {
                    case 0:
                        c.DropItem(new AncientPotteryFragments());
                        break;
                    case 1:
                        c.DropItem(new TatteredAncientScroll());
                        break;
                }
            }</pre>

## Duplicated Code. Size: 137

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Creatures.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                Static = new Static(this.ItemID + 1);
                Static.MoveToWorld(this.Location, this.Map);

                IPooledEnumerable eable = this.Map.GetMobilesInRange(this.Location, 0);

                foreach (Mobile m in eable)
                {
                    OnMoveOver(m);
                }
                eable.Free();
            }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Creatures\Cora.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                Static = new Static(this.ItemID + 1);
                Static.MoveToWorld(this.Location, this.Map);

                IPooledEnumerable eable = this.Map.GetMobilesInRange(this.Location, 0);

                foreach (Mobile m in eable)
                {
                    OnMoveOver(m);
                }
                eable.Free();
            }</pre>

## Duplicated Code. Size: 137

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\VeteranRewards\DaviesLocker.cs

<pre>writer.Write(m_Entries.Count);
            foreach (DaviesLockerEntry entry in m_Entries)
            {
                if (entry is SOSEntry)
                    writer.Write((int)0);
                else if (entry is TreasureMapEntry)
                    writer.Write((int)1);
                else
                {
                    writer.Write((int)2);
                    continue;
                }

                entry.Serialize(writer);
            }</pre>

Fragment 2 in file Scripts\Services\VeteranRewards\DaviesLocker.cs

<pre>writer.Write(m_Entries.Count);
            foreach (DaviesLockerEntry entry in m_Entries)
            {
                if (entry is SOSEntry)
                    writer.Write((int)0);
                else if (entry is TreasureMapEntry)
                    writer.Write((int)1);
                else
                {
                    writer.Write((int)2);
                    continue;
                }

                entry.Serialize(writer);
            }</pre>

## Duplicated Code. Size: 137

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\Attachments\XmlSockets.cs

<pre>if(from == null) return 0;

			double skill = 0;

			// with a difficulty of 120
			// at 120, chance of adding 1 socket is 15%, 2 sockets is 2%, 3 is 0%
			//
			// with a difficulty of 100
			// at skill level of 100, adding 1 socket has a probability of success of 15%, 2 sockets is 0%
			// at 120, chance of adding 1 socket is 55%, 2 sockets is 42%, 3 is 29%, 4 is 16% , 5 is 3%, 6 is 0%
			//
			// with a difficulty of 70
			// at skill level of 100, adding 1 socket has a probability of success of 75%, 2 sockets is 60%, 3 sockets is 45%, etc.
			// at 120, chance of adding 1 socket is 100%, 2 sockets is 100%, 3 sockets is 85%, etc.
			//
			try
			{
				skill = from.Skills[requiredSkill].Value;
			} 
			catch{}

			if((int)(skill - difficulty) < 0) return 0;

			int successchance = (int)(2*(skill - difficulty) + 15 - (nsockets-1)*13);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\Attachments\XmlSockets.cs

<pre>if(from == null) return 0;

			double skill = 0;

			// with a difficulty of 120
			// at 120, chance of adding 1 socket is 15%, 2 sockets is 2%, 3 is 0%
			//
			// with a difficulty of 100
			// at skill level of 100, adding 1 socket has a probability of success of 15%, 2 sockets is 0%
			// at 120, chance of adding 1 socket is 55%, 2 sockets is 42%, 3 is 29%, 4 is 16% , 5 is 3%, 6 is 0%
			//
			// with a difficulty of 70
			// at skill level of 100, adding 1 socket has a probability of success of 75%, 2 sockets is 60%, 3 sockets is 45%, etc.
			// at 120, chance of adding 1 socket is 100%, 2 sockets is 100%, 3 sockets is 85%, etc.
			//
			try
			{
				skill = from.Skills[requiredSkill].Value;
			} 
			catch{}

			if((int)(skill - difficulty) < 0) return 0;

			int successchance = (int)(2*(skill - difficulty) + 15 - (nsockets-1)*13);</pre>

## Duplicated Code. Size: 137

### Duplicated Fragments:

Fragment 1 in file Server\Gumps\GumpButton.cs

<pre>public override void AppendTo( IGumpWriter disp )
		{
			disp.AppendLayout( m_LayoutName );
			disp.AppendLayout( m_X );
			disp.AppendLayout( m_Y );
			disp.AppendLayout( m_ID1 );
			disp.AppendLayout( m_ID2 );
			disp.AppendLayout( (int)m_Type );
			disp.AppendLayout( m_Param );
			disp.AppendLayout( m_ButtonID );
		}</pre>

Fragment 2 in file Server\Gumps\KRGumpButton.cs

<pre>public override void AppendTo( IGumpWriter disp )
		{
			disp.AppendLayout( m_LayoutName );
			disp.AppendLayout( m_X );
			disp.AppendLayout( m_Y );
			disp.AppendLayout( m_ID1 );
			disp.AppendLayout( m_ID2 );
			disp.AppendLayout( (int) m_Type );
			disp.AppendLayout( m_Param );
			disp.AppendLayout( m_ButtonID );
		}</pre>

## Duplicated Code. Size: 137

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Betrayer.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.05 > Utility.RandomDouble())
            {
                if (!this.IsParagon)
                {
                    if (0.75 > Utility.RandomDouble())
                        c.DropItem(DawnsMusicGear.RandomCommon);
                    else
                        c.DropItem(DawnsMusicGear.RandomUncommon);
                }
                else
                    c.DropItem(DawnsMusicGear.RandomRare);
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Golem.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.05 > Utility.RandomDouble())
            {
                if (!this.IsParagon)
                {
                    if (0.75 > Utility.RandomDouble())
                        c.DropItem(DawnsMusicGear.RandomCommon);
                    else
                        c.DropItem(DawnsMusicGear.RandomUncommon);
                }
                else
                    c.DropItem(DawnsMusicGear.RandomRare);
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\Juggernaut.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.05 > Utility.RandomDouble())
            {
                if (!this.IsParagon)
                {
                    if (0.75 > Utility.RandomDouble())
                        c.DropItem(DawnsMusicGear.RandomCommon);
                    else
                        c.DropItem(DawnsMusicGear.RandomUncommon);
                }
                else
                    c.DropItem(DawnsMusicGear.RandomRare);
            }
        }</pre>

## Duplicated Code. Size: 137

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\BrideGroom.cs

<pre>private static int GetRandomHue()
        {
            switch ( Utility.Random(6) )
            {
                default:
                case 0:
                    return 0;
                case 1:
                    return Utility.RandomBlueHue();
                case 2:
                    return Utility.RandomGreenHue();
                case 3:
                    return Utility.RandomRedHue();
                case 4:
                    return Utility.RandomYellowHue();
                case 5:
                    return Utility.RandomNeutralHue();
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Merchant.cs

<pre>private static int GetRandomHue()
        {
            switch( Utility.Random(6) )
            {
                default:
                case 0:
                    return 0;
                case 1:
                    return Utility.RandomBlueHue();
                case 2:
                    return Utility.RandomGreenHue();
                case 3:
                    return Utility.RandomRedHue();
                case 4:
                    return Utility.RandomYellowHue();
                case 5:
                    return Utility.RandomNeutralHue();
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Messenger.cs

<pre>private static int GetRandomHue()
        {
            switch ( Utility.Random(6) )
            {
                default:
                case 0:
                    return 0;
                case 1:
                    return Utility.RandomBlueHue();
                case 2:
                    return Utility.RandomGreenHue();
                case 3:
                    return Utility.RandomRedHue();
                case 4:
                    return Utility.RandomYellowHue();
                case 5:
                    return Utility.RandomNeutralHue();
            }
        }</pre>

Fragment 4 in file Scripts\Mobiles\NPCs\Noble.cs

<pre>private static int GetRandomHue()
        {
            switch ( Utility.Random(6) )
            {
                default:
                case 0:
                    return 0;
                case 1:
                    return Utility.RandomBlueHue();
                case 2:
                    return Utility.RandomGreenHue();
                case 3:
                    return Utility.RandomRedHue();
                case 4:
                    return Utility.RandomYellowHue();
                case 5:
                    return Utility.RandomNeutralHue();
            }
        }</pre>

Fragment 5 in file Scripts\Mobiles\NPCs\Peasant.cs

<pre>private static int GetRandomHue()
        {
            switch ( Utility.Random(6) )
            {
                default:
                case 0:
                    return 0;
                case 1:
                    return Utility.RandomBlueHue();
                case 2:
                    return Utility.RandomGreenHue();
                case 3:
                    return Utility.RandomRedHue();
                case 4:
                    return Utility.RandomYellowHue();
                case 5:
                    return Utility.RandomNeutralHue();
            }
        }</pre>

Fragment 6 in file Scripts\Mobiles\NPCs\SeekerOfAdventure.cs

<pre>private static int GetRandomHue()
        {
            switch ( Utility.Random(6) )
            {
                default:
                case 0:
                    return 0;
                case 1:
                    return Utility.RandomBlueHue();
                case 2:
                    return Utility.RandomGreenHue();
                case 3:
                    return Utility.RandomRedHue();
                case 4:
                    return Utility.RandomYellowHue();
                case 5:
                    return Utility.RandomNeutralHue();
            }
        }</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingSeekerOfAdventure.cs

<pre>private static int GetRandomHue()
		{
			switch ( Utility.Random( 6 ) )
			{
				default:
				case 0: return 0;
				case 1: return Utility.RandomBlueHue();
				case 2: return Utility.RandomGreenHue();
				case 3: return Utility.RandomRedHue();
				case 4: return Utility.RandomYellowHue();
				case 5: return Utility.RandomNeutralHue();
			}
		}</pre>

Fragment 8 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\XmlQuestNPC.cs

<pre>private static int GetRandomHue()
        {
            switch ( Utility.Random( 6 ) )
            {
                default:
                case 0: return 0;
                case 1: return Utility.RandomBlueHue();
                case 2: return Utility.RandomGreenHue();
                case 3: return Utility.RandomRedHue();
                case 4: return Utility.RandomYellowHue();
                case 5: return Utility.RandomNeutralHue();
            }
        }</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddCheck(182, 48, 210, 211, false, 125);
            this.AddCheck(182, 73, 210, 211, false, 126);
            this.AddCheck(182, 98, 210, 211, false, 127);
            this.AddCheck(182, 123, 210, 211, false, 128);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddCheck(182, 48, 210, 211, false, 125);
            this.AddCheck(182, 73, 210, 211, false, 126);
            this.AddCheck(182, 98, 210, 211, false, 127);
            this.AddCheck(182, 123, 210, 211, false, 128);</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\FlourMillEastAddon.cs

<pre>public override void OnComponentUsed(AddonComponent c, Mobile from)
        {
            if (!from.InRange(this.GetWorldLocation(), 4) || !from.InLOS(this))
                from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
            else if (!this.IsFull)
                from.SendLocalizedMessage(500997); // You need more wheat to make a sack of flour.
            else
                this.StartWorking(from);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\FlourMillSouthAddon.cs

<pre>public override void OnComponentUsed(AddonComponent c, Mobile from)
        {
            if (!from.InRange(this.GetWorldLocation(), 4) || !from.InLOS(this))
                from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
            else if (!this.IsFull)
                from.SendLocalizedMessage(500997); // You need more wheat to make a sack of flour.
            else
                this.StartWorking(from);
        }</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SpecialFishingNet.cs

<pre>switch ( Utility.Random(4) )
                {
                    default:
                    case 0:
                        spawn = new SeaSerpent();
                        break;
                    case 1:
                        spawn = new DeepSeaSerpent();
                        break;
                    case 2:
                        spawn = new WaterElemental();
                        break;
                    case 3:
                        spawn = new Kraken();
                        break;
                }

                this.Spawn(p, map, spawn);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\SpecialSalvageHook.cs

<pre>switch (Utility.Random(4))
                    {
                        default:
                        case 0:
                            spawn = new SeaSerpent();
                            break;
                        case 1:
                            spawn = new DeepSeaSerpent();
                            break;
                        case 2:
                            spawn = new WaterElemental();
                            break;
                        case 3:
                            spawn = new Kraken();
                            break;
                    }

                    this.Spawn(p, map, spawn);</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Spellbooks\Spellbook.cs

<pre>if (m_Slayer != SlayerName.None)
			{
				SlayerEntry entry = SlayerGroup.GetEntryByName(m_Slayer);
				if (entry != null)
				{
					list.Add(entry.Title);
				}
			}

			if (m_Slayer2 != SlayerName.None)
			{
				SlayerEntry entry = SlayerGroup.GetEntryByName(m_Slayer2);
				if (entry != null)
				{
					list.Add(entry.Title);
				}
			}</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if (m_Slayer != SlayerName.None)
			{
				SlayerEntry entry = SlayerGroup.GetEntryByName(m_Slayer);
				if (entry != null)
				{
					list.Add(entry.Title);
				}
			}

			if (m_Slayer2 != SlayerName.None)
			{
				SlayerEntry entry = SlayerGroup.GetEntryByName(m_Slayer2);
				if (entry != null)
				{
					list.Add(entry.Title);
				}
			}</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\BaseDecayingItem.cs

<pre>if (Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);</pre>

Fragment 2 in file Scripts\Services\Underworld\PuzzleRoom\MastermindPuzzleItem.cs

<pre>if (Name == null)
                    parent.SendLocalizedMessage(1072515, "#" + LabelNumber); // The ~1_name~ expired...
                else
                    parent.SendLocalizedMessage(1072515, Name); // The ~1_name~ expired...

                Effects.SendLocationParticles(EffectItem.Create(parent.Location, parent.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(parent.Location, parent.Map, 0x201);</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>{
                if (m == this || !CanBeHarmful(m))
                    continue;

                if (m is BaseCreature && (((BaseCreature)m).Controlled || ((BaseCreature)m).Summoned || ((BaseCreature)m).Team != this.Team))
                    list.Add(m);
                else if (m.Player)
                    list.Add(m);
            }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Mobiles\Charybdis.cs

<pre>{
                if (m == this || !CanBeHarmful(m))
                    continue;

                if (m is BaseCreature && (((BaseCreature)m).Controlled || ((BaseCreature)m).Summoned || ((BaseCreature)m).Team != this.Team))
                    list.Add(m);
                else if (m.Player)
                    list.Add(m);
            }</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Ridgeback.cs

<pre>this.BaseSoundID = 0x3F3;

            this.SetStr(58, 100);
            this.SetDex(56, 75);
            this.SetInt(16, 30);

            this.SetHits(41, 54);
            this.SetMana(0);

            this.SetDamage(3, 5);

            this.SetDamageType(ResistanceType.Physical, 100);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SavageRidgeback.cs

<pre>this.BaseSoundID = 0x3F3;

            this.SetStr(58, 100);
            this.SetDex(56, 75);
            this.SetInt(16, 30);

            this.SetHits(41, 54);
            this.SetMana(0);

            this.SetDamage(3, 5);

            this.SetDamageType(ResistanceType.Physical, 100);</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\LargeBODAcceptGump.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
        {
            if (info.ButtonID == 1) // Ok
            {
                if (this.m_From.PlaceInBackpack(this.m_Deed))
                {
                    this.m_From.SendLocalizedMessage(1045152); // The bulk order deed has been placed in your backpack.
                }
                else
                {
                    this.m_From.SendLocalizedMessage(1045150); // There is not enough room in your backpack for the deed.
                    this.m_Deed.Delete();
                }
            }
            else
            {
                this.m_Deed.Delete();
            }
        }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallBODAcceptGump.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
        {
            if (info.ButtonID == 1) // Ok
            {
                if (this.m_From.PlaceInBackpack(this.m_Deed))
                {
                    this.m_From.SendLocalizedMessage(1045152); // The bulk order deed has been placed in your backpack.
                }
                else
                {
                    this.m_From.SendLocalizedMessage(1045150); // There is not enough room in your backpack for the deed.
                    this.m_Deed.Delete();
                }
            }
            else
            {
                this.m_Deed.Delete();
            }
        }</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Gumps\FinanceGump.cs

<pre>int financeUpkeep = town.FinanceUpkeep;
            int sheriffUpkeep = town.SheriffUpkeep;
            int dailyIncome = town.DailyIncome;
            int netCashFlow = town.NetCashFlow;

            this.AddHtmlLocalized(20, 30, 300, 25, 1011524, false, false); // FINANCE STATEMENT

            this.AddHtmlLocalized(20, 80, 300, 25, 1011538, false, false); // Current total money for town : </pre>

Fragment 2 in file Scripts\Services\Factions\Gumps\SheriffGump.cs

<pre>int financeUpkeep = town.FinanceUpkeep;
            int sheriffUpkeep = town.SheriffUpkeep;
            int dailyIncome = town.DailyIncome;
            int netCashFlow = town.NetCashFlow;

            this.AddHtmlLocalized(20, 30, 300, 25, 1011524, false, false); // FINANCE STATEMENT

            this.AddHtmlLocalized(20, 80, 300, 25, 1011538, false, false); // Current total money for town : </pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionPaladin.cs

<pre>this.SetResistance(ResistanceType.Physical, 40, 60);
            this.SetResistance(ResistanceType.Fire, 40, 60);
            this.SetResistance(ResistanceType.Cold, 40, 60);
            this.SetResistance(ResistanceType.Energy, 40, 60);
            this.SetResistance(ResistanceType.Poison, 40, 60);

            this.VirtualArmor = 32;</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionWizard.cs

<pre>this.SetResistance(ResistanceType.Physical, 40, 60);
            this.SetResistance(ResistanceType.Fire, 40, 60);
            this.SetResistance(ResistanceType.Cold, 40, 60);
            this.SetResistance(ResistanceType.Energy, 40, 60);
            this.SetResistance(ResistanceType.Poison, 40, 60);

            this.VirtualArmor = 32;</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>if (this.m_Creatures != null)
                        {
                            for (int i = 0; i < this.m_Creatures.Count; ++i)
                            {
                                Mobile mob = this.m_Creatures[i];

                                if (!mob.Player)
                                    mob.Delete();
                            }

                            this.m_Creatures.Clear();
                        }

                        this.Stop();
                        this.BeginRestart(m_RestartDelay);</pre>

Fragment 2 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>if (this.m_Creatures != null)
            {
                for (int i = 0; i < this.m_Creatures.Count; ++i)
                {
                    Mobile mob = this.m_Creatures[i];

                    if (!mob.Player)
                        mob.Delete();
                }

                this.m_Creatures.Clear();
            }

            this.Stop();
            this.BeginRestart(m_RestartDelay);</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>if (GetSaveFlag(flags, SaveFlag.Direction))
                        {
                            m_Direction = (Direction)reader.ReadByte();
                        }

                        if (GetSaveFlag(flags, SaveFlag.Bounce))
                        {
                            AcquireCompactInfo().m_Bounce = BounceInfo.Deserialize(reader);
                        }

                        if (GetSaveFlag(flags, SaveFlag.LootType))
                        {
                            m_LootType = (LootType)reader.ReadByte();
                        }</pre>

Fragment 2 in file Server\Item.cs

<pre>if (GetSaveFlag(flags, SaveFlag.Direction))
                        {
                            m_Direction = (Direction)reader.ReadByte();
                        }

                        if (GetSaveFlag(flags, SaveFlag.Bounce))
                        {
                            AcquireCompactInfo().m_Bounce = BounceInfo.Deserialize(reader);
                        }

                        if (GetSaveFlag(flags, SaveFlag.LootType))
                        {
                            m_LootType = (LootType)reader.ReadByte();
                        }</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>if (Core.HS && ns != null && ns.ExtendedStatus)
			{
				type = 6;
				EnsureCapacity(121);
			}
			else if (Core.ML && ns != null && ns.SupportsExpansion(Expansion.ML))
			{
				type = 5;
				EnsureCapacity(91);
			}
			else
			{
				type = Core.AOS ? 4 : 3;
				EnsureCapacity(88);
			}</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>if (Core.HS && ns != null && ns.ExtendedStatus)
            {
                type = 6;
                EnsureCapacity(121);
            }
            else if (Core.ML && ns != null && ns.SupportsExpansion(Expansion.ML))
            {
                type = 5;
                EnsureCapacity(91);
            }
            else
            {
                type = Core.AOS ? 4 : 3;
                EnsureCapacity(88);
            }</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetPoint2DGump.cs

<pre>if ( shouldSet )
			{
				try
				{
					CommandLogging.LogChangeProperty( m_Mobile, m_Object, m_Property.Name, toSet.ToString() );
					m_Property.SetValue( m_Object, toSet, null );
				}
				catch
				{
					m_Mobile.SendMessage( "An exception was caught. The property may not have changed." );
				}
			}

			if ( shouldSend )
				m_Mobile.SendGump( new XmlPropertiesGump( m_Mobile, m_Object, m_Stack, m_List, m_Page ) );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetPoint3DGump.cs

<pre>if ( shouldSet )
			{
				try
				{
					CommandLogging.LogChangeProperty( m_Mobile, m_Object, m_Property.Name, toSet.ToString() );
					m_Property.SetValue( m_Object, toSet, null );
				}
				catch
				{
					m_Mobile.SendMessage( "An exception was caught. The property may not have changed." );
				}
			}

			if ( shouldSend )
				m_Mobile.SendGump( new XmlPropertiesGump( m_Mobile, m_Object, m_Stack, m_List, m_Page ) );</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetTimeSpanGump.cs

<pre>if ( shouldSet )
			{
				try
				{
					CommandLogging.LogChangeProperty( m_Mobile, m_Object, m_Property.Name, toSet.ToString() );
					m_Property.SetValue( m_Object, toSet, null );
				}
				catch
				{
					m_Mobile.SendMessage( "An exception was caught. The property may not have changed." );
				}
			}

			if ( shouldSend )
				m_Mobile.SendGump( new XmlPropertiesGump( m_Mobile, m_Object, m_Stack, m_List, m_Page ) );</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>AddButton( 20, height - 35, 0xFAB, 0xFAD, 1, GumpButtonType.Reply, 0 );
            AddLabel( 55, height - 35, 0, XmlPoints.GetText(from, 200532) );  // "Refresh"

            if(gauntlet.GameInProgress)
            {
                AddLabel( 150, height - 35, 68, XmlPoints.GetText(from, 200533));  // "Game is in progress!"
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>AddButton( 20, height - 35, 0xFAB, 0xFAD, 1, GumpButtonType.Reply, 0 );
            AddLabel( 55, height - 35, 0, XmlPoints.GetText(from, 200532) );  // "Refresh"

            if(gauntlet.GameInProgress)
            {
                AddLabel( 150, height - 35, 68, XmlPoints.GetText(from, 200533));  // "Game is in progress!"
            }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>AddButton( 20, height - 35, 0xFAB, 0xFAD, 1, GumpButtonType.Reply, 0 );
            AddLabel( 55, height - 35, 0, XmlPoints.GetText(from, 200532) );  // "Refresh"

            if(gauntlet.GameInProgress)
            {
                AddLabel( 150, height - 35, 68, XmlPoints.GetText(from, 200533));  // "Game is in progress!"
            }</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Ultima\Art.cs

<pre>if (((cmp == null) || (newchecksum == null)) || (cmp.Length != newchecksum.Length))
				{
					return false;
				}
				bool valid = true;
				for (int j = 0; j < cmp.Length; ++j)
				{
					if (cmp[j] != newchecksum[j])
					{
						valid = false;
						break;
					}
				}</pre>

Fragment 2 in file Ultima\Art.cs

<pre>if (((cmp == null) || (newchecksum == null)) || (cmp.Length != newchecksum.Length))
				{
					return false;
				}
				bool valid = true;
				for (int j = 0; j < cmp.Length; ++j)
				{
					if (cmp[j] != newchecksum[j])
					{
						valid = false;
						break;
					}
				}</pre>

Fragment 3 in file Ultima\Textures.cs

<pre>if (((cmp == null) || (newchecksum == null)) || (cmp.Length != newchecksum.Length))
				{
					return false;
				}
				bool valid = true;
				for (int j = 0; j < cmp.Length; ++j)
				{
					if (cmp[j] != newchecksum[j])
					{
						valid = false;
						break;
					}
				}</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Acolyte\GreymistArms.cs

<pre>{
            this.SetHue = 0xCB;

            this.Attributes.BonusMana = 2;
            this.Attributes.SpellDamage = 2;

            this.SetAttributes.Luck = 100;
            this.SetAttributes.NightSight = 1;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 3;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 3;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Acolyte\GreymistChest.cs

<pre>{
            this.SetHue = 0xCB;		

            this.Attributes.BonusMana = 2;
            this.Attributes.SpellDamage = 2;

            this.SetAttributes.Luck = 100;
            this.SetAttributes.NightSight = 1;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 3;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 3;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Acolyte\GreymistGloves.cs

<pre>{
            this.SetHue = 0xCB;			

            this.Attributes.BonusMana = 2;
            this.Attributes.SpellDamage = 2;

            this.SetAttributes.Luck = 100;
            this.SetAttributes.NightSight = 1;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 3;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 3;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Acolyte\GreymistLegs.cs

<pre>{
            this.SetHue = 0xCB;		

            this.Attributes.BonusMana = 2;
            this.Attributes.SpellDamage = 2;

            this.SetAttributes.Luck = 100;
            this.SetAttributes.NightSight = 1;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 3;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 3;
        }</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Mage\LeafweaveChest.cs

<pre>{
            this.SetHue = 0x47E;

            this.Attributes.RegenMana = 1;
            this.ArmorAttributes.MageArmor = 1;

            this.SetAttributes.BonusInt = 10;
            this.SetAttributes.SpellDamage = 15;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 4;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Mage\LeafweaveGloves.cs

<pre>{
            this.SetHue = 0x47E;

            this.Attributes.RegenMana = 1;
            this.ArmorAttributes.MageArmor = 1;

            this.SetAttributes.BonusInt = 10;
            this.SetAttributes.SpellDamage = 15;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 4;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Mage\LeafweaveLegs.cs

<pre>{
            this.SetHue = 0x47E;

            this.Attributes.RegenMana = 1;
            this.ArmorAttributes.MageArmor = 1;

            this.SetAttributes.BonusInt = 10;
            this.SetAttributes.SpellDamage = 15;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 4;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Mage\LeafweavePauldrons.cs

<pre>{
            this.SetHue = 0x47E;

            this.Attributes.RegenMana = 1;
            this.ArmorAttributes.MageArmor = 1;

            this.SetAttributes.BonusInt = 10;
            this.SetAttributes.SpellDamage = 15;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 4;
            this.SetFireBonus = 5;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 4;
            this.SetEnergyBonus = 4;
        }</pre>

## Duplicated Code. Size: 136

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Myrmidon\MyrmidonArms.cs

<pre>{
            this.SetHue = 0x331;

            this.Attributes.BonusStr = 1;
            this.Attributes.BonusHits = 2;

            this.SetAttributes.Luck = 500;
            this.SetAttributes.NightSight = 1;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 3;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 3;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Myrmidon\MyrmidonBascinet.cs

<pre>{
            this.SetHue = 0x331;

            this.Attributes.BonusStr = 1;
            this.Attributes.BonusHits = 2;

            this.SetAttributes.Luck = 500;
            this.SetAttributes.NightSight = 1;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 3;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 3;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Myrmidon\MyrmidonChest.cs

<pre>{
            this.SetHue = 0x331;

            this.Attributes.BonusStr = 1;
            this.Attributes.BonusHits = 2;

            this.SetAttributes.Luck = 500;
            this.SetAttributes.NightSight = 1;

            this.SetSelfRepair = 3;

            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 3;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 3;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Myrmidon\MyrmidonGloves.cs

<pre>{
            this.SetHue = 0x331;

            this.Attributes.BonusStr = 1;
            this.Attributes.BonusHits = 2;

            this.SetAttributes.Luck = 500;
            this.SetAttributes.NightSight = 1;

            this.SetSelfRepair = 3;			
            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 3;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 3;
        }</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Myrmidon\MyrmidonGorget.cs

<pre>{
            this.SetHue = 0x331;

            this.Attributes.BonusStr = 1;
            this.Attributes.BonusHits = 2;

            this.SetAttributes.Luck = 500;
            this.SetAttributes.NightSight = 1;

            this.SetSelfRepair = 3;			
            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 3;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 3;
        }</pre>

Fragment 6 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Myrmidon\MyrmidonLegs.cs

<pre>{
            this.SetHue = 0x331;

            this.Attributes.BonusStr = 1;
            this.Attributes.BonusHits = 2;

            this.SetAttributes.Luck = 500;
            this.SetAttributes.NightSight = 1;

            this.SetSelfRepair = 3;			
            this.SetPhysicalBonus = 3;
            this.SetFireBonus = 3;
            this.SetColdBonus = 3;
            this.SetPoisonBonus = 3;
            this.SetEnergyBonus = 3;
        }</pre>

## Duplicated Code. Size: 135

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Docs.cs

<pre>var cmd = cmds[0];
					var aliases = new string[cmds.Length - 1];

					for (var j = 0; j < aliases.Length; ++j)
					{
						aliases[j] = cmds[j + 1];
					}

					desc = desc.Replace("<", "&lt;").Replace(">", "&gt;");</pre>

Fragment 2 in file Scripts\Commands\Docs.cs

<pre>var cmd = cmds[0];
					var aliases = new string[cmds.Length - 1];

					for (var j = 0; j < aliases.Length; ++j)
					{
						aliases[j] = cmds[j + 1];
					}

					desc = desc.Replace("<", "&lt;").Replace(">", "&gt;");</pre>

## Duplicated Code. Size: 135

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetListOptionGump.cs

<pre>int x = BorderSize + OffsetSize;
			int y = BorderSize + OffsetSize + ((index + 1) * (EntryHeight + OffsetSize));

			AddImageTiled(x, y, EntryWidth, EntryHeight, EntryGumpID);
			AddLabelCropped(x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, str);

			x += EntryWidth + OffsetSize;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetListOptionGump.cs

<pre>int x = BorderSize + OffsetSize;
			int y = BorderSize + OffsetSize + ((index + 1) * (EntryHeight + OffsetSize));

			AddImageTiled( x, y, EntryWidth, EntryHeight, EntryGumpID );
			AddLabelCropped( x + TextOffsetX, y, EntryWidth - TextOffsetX, EntryHeight, TextHue, str );

			x += EntryWidth + OffsetSize;</pre>

## Duplicated Code. Size: 135

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Books\BaseBook.cs

<pre>Mobile from = state.Mobile;
            BaseBook book = World.FindItem(pvSrc.ReadInt32()) as BaseBook;

            if (book == null || !book.Writable || !from.InRange(book.GetWorldLocation(), 1) || !book.IsAccessibleTo(from))
                return;

            pvSrc.Seek(4, SeekOrigin.Current); // Skip flags and page count</pre>

Fragment 2 in file Scripts\Items\Books\BaseBook.cs

<pre>Mobile from = state.Mobile;
            BaseBook book = World.FindItem(pvSrc.ReadInt32()) as BaseBook;

            if (book == null || !book.Writable || !from.InRange(book.GetWorldLocation(), 1) || !book.IsAccessibleTo(from))
                return;

            pvSrc.Seek(4, SeekOrigin.Current); // Skip flags and page count</pre>

## Duplicated Code. Size: 135

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Corpses\Packets.cs

<pre>m_Stream.Write((byte)0); // signed, itemID offset
					m_Stream.Write((ushort)child.Amount);
					m_Stream.Write((short)child.X);
					m_Stream.Write((short)child.Y);
					m_Stream.Write(beheld.Serial);
					m_Stream.Write((ushort)child.Hue);

					++written;</pre>

Fragment 2 in file Scripts\Items\Decorative\Corpses\Packets.cs

<pre>m_Stream.Write((ushort)child.Amount);
					m_Stream.Write((short)child.X);
					m_Stream.Write((short)child.Y);
					m_Stream.Write((byte)0); // Grid Location?
					m_Stream.Write(beheld.Serial);
					m_Stream.Write((ushort)child.Hue);

					++written;</pre>

## Duplicated Code. Size: 135

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\DungeonWallAndVineAddon.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.Parent == null && Utility.InRange(this.Location, m.Location, 3) && !Utility.InRange(this.Location, oldLocation, 3) && m is PlayerMobile)
            {
                if (m.X > this.X)
                    m.SendLocalizedMessage(1111665); // You notice something odd about the vines covering the wall.
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\StoneWallAndVineAddon.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.Parent == null && Utility.InRange(this.Location, m.Location, 3) && !Utility.InRange(this.Location, oldLocation, 3) && m is PlayerMobile)
            {
                if (m.X > this.X)
                    m.SendLocalizedMessage(1111665); // You notice something odd about the vines covering the wall.
            }
        }</pre>

## Duplicated Code. Size: 135

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ExodusOverseer.cs

<pre>this.SetDamage(13, 19);

            this.SetDamageType(ResistanceType.Physical, 50);
            this.SetDamageType(ResistanceType.Energy, 50);

            this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 40, 60);
            this.SetResistance(ResistanceType.Cold, 25, 35);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusDrone.cs

<pre>this.SetDamage(13, 19);

            this.SetDamageType(ResistanceType.Physical, 50);
            this.SetDamageType(ResistanceType.Energy, 50);

            this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 40, 60);
            this.SetResistance(ResistanceType.Cold, 25, 35);</pre>

## Duplicated Code. Size: 135

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Mardoth.cs

<pre>if (Core.AOS)
                                {
                                    BaseRunicTool.ApplyAttributesTo(weapon, 3, 20, 40);
                                }
                                else
                                {
                                    weapon.DamageLevel = (WeaponDamageLevel)BaseCreature.RandomMinMaxScaled(2, 4);
                                    weapon.AccuracyLevel = (WeaponAccuracyLevel)BaseCreature.RandomMinMaxScaled(2, 4);
                                    weapon.DurabilityLevel = (WeaponDurabilityLevel)BaseCreature.RandomMinMaxScaled(2, 4);
                                }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Uzeraan.cs

<pre>if (Core.AOS)
                                {
                                    BaseRunicTool.ApplyAttributesTo(weapon, 3, 20, 40);
                                }
                                else
                                {
                                    weapon.DamageLevel = (WeaponDamageLevel)BaseCreature.RandomMinMaxScaled(2, 4);
                                    weapon.AccuracyLevel = (WeaponAccuracyLevel)BaseCreature.RandomMinMaxScaled(2, 4);
                                    weapon.DurabilityLevel = (WeaponDurabilityLevel)BaseCreature.RandomMinMaxScaled(2, 4);
                                }</pre>

## Duplicated Code. Size: 135

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\SmallSmithBOD.cs

<pre>int amountMax;

                if (theirSkill >= 70.1)
                    amountMax = Utility.RandomList(10, 15, 20, 20);
                else if (theirSkill >= 50.1)
                    amountMax = Utility.RandomList(10, 15, 15, 20);
                else
                    amountMax = Utility.RandomList(10, 10, 15, 20);

                BulkMaterialType material = BulkMaterialType.None;</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallTailorBOD.cs

<pre>int amountMax;

                if (theirSkill >= 70.1)
                    amountMax = Utility.RandomList(10, 15, 20, 20);
                else if (theirSkill >= 50.1)
                    amountMax = Utility.RandomList(10, 15, 15, 20);
                else
                    amountMax = Utility.RandomList(10, 10, 15, 20);

                BulkMaterialType material = BulkMaterialType.None;</pre>

## Duplicated Code. Size: 135

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Encounters.cs

<pre>ConvertOffset(ref pnt);
            item.MoveToWorld(pnt, Map.TerMur);
            Items.Add(item);

            item = new PurifyingFlames();
            pnt = new Point3D(-4, 2, 8);
            ConvertOffset(ref pnt);
            item.MoveToWorld(pnt, Map.TerMur);
            Items.Add(item);</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Encounters.cs

<pre>ConvertOffset(ref pnt);
            item.MoveToWorld(pnt, Map.TerMur);
            Items.Add(item);

            item = new PurifyingFlames();
            pnt = new Point3D(2, -4, 8);
            ConvertOffset(ref pnt);
            item.MoveToWorld(pnt, Map.TerMur);
            Items.Add(item);</pre>

## Duplicated Code. Size: 135

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\SmeltersTalisman.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            int left = 0;
            if (DateTime.UtcNow < Expires)
                left = (int)(Expires - DateTime.UtcNow).TotalSeconds;

            list.Add(1060584, UsesRemaining.ToString()); // uses remaining: ~1_val~
            list.Add(1072517, left.ToString()); // Lifespan: ~1_val~ seconds
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\WoodsmanTalisman.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            int left = 0;
            if (DateTime.UtcNow < Expires)
                left = (int)(Expires - DateTime.UtcNow).TotalSeconds;

            list.Add(1060584, UsesRemaining.ToString()); // uses remaining: ~1_val~
            list.Add(1072517, left.ToString()); // Lifespan: ~1_val~ seconds
        }</pre>

## Duplicated Code. Size: 135

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ViceVsVirtue\GuildStats.cs

<pre>Points = reader.ReadDouble();

            Silver = reader.ReadInt();
            Kills = reader.ReadInt();
            Assists = reader.ReadInt();
            Deaths = reader.ReadInt();
            Stolen = reader.ReadInt();
            ViceReturned = reader.ReadInt();
            VirtueReturned = reader.ReadInt();
            Disarmed = reader.ReadInt();</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\GuildStats.cs

<pre>Points = reader.ReadDouble();

            Silver = reader.ReadInt();
            Kills = reader.ReadInt();
            Assists = reader.ReadInt();
            Deaths = reader.ReadInt();
            Stolen = reader.ReadInt();
            ViceReturned = reader.ReadInt();
            VirtueReturned = reader.ReadInt();
            Disarmed = reader.ReadInt();</pre>

## Duplicated Code. Size: 135

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Quest\TyballsShadow.cs

<pre>List<DamageStore> rights = GetLootingRights();
                List<Mobile> toGive = new List<Mobile>();

                for (int i = rights.Count - 1; i >= 0; --i)
                {
                    DamageStore ds = rights[i];
                    if (ds.m_HasRight)
                        toGive.Add(ds.m_Mobile);
                }</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\BaseChampion.cs

<pre>List<DamageStore> rights = GetLootingRights();
                List<Mobile> toGive = new List<Mobile>();

                for (int i = rights.Count - 1; i >= 0; --i)
                {
                    DamageStore ds = rights[i];

                    if (ds.m_HasRight)
                        toGive.Add(ds.m_Mobile);
                }</pre>

Fragment 3 in file Scripts\Mobiles\Bosses\Harrower\Harrower.cs

<pre>List<Mobile> toGive = new List<Mobile>();
            List<DamageStore> rights = GetLootingRights();

            for (int i = rights.Count - 1; i >= 0; --i)
            {
                DamageStore ds = rights[i];

                if (ds.m_HasRight)
                    toGive.Add(ds.m_Mobile);
            }</pre>

## Duplicated Code. Size: 135

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\CauldronOfTransmutation.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            Expires = reader.ReadDateTime();

            if (Expires < DateTime.UtcNow)
                Decay();
            else
                m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), CheckDecay);
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\MagicFishFinder.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            Expires = reader.ReadDateTime();

            if (Expires < DateTime.UtcNow)
                Decay();
            else
                m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), CheckDecay);
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\TemporaryForge.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            Expires = reader.ReadDateTime();

            if (Expires < DateTime.UtcNow)
                Decay();
            else
                m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), CheckDecay);
        }</pre>

## Duplicated Code. Size: 134

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\CommodityDeed.cs

<pre>string args;

                if (this.m_Commodity.Name == null)
                    args = String.Format("#{0}\t{1}", (this.m_Commodity is ICommodity) ? ((ICommodity)this.m_Commodity).DescriptionNumber : this.m_Commodity.LabelNumber, this.m_Commodity.Amount);
                else
                    args = String.Format("{0}\t{1}", this.m_Commodity.Name, this.m_Commodity.Amount);</pre>

Fragment 2 in file Scripts\Items\Consumables\CommodityDeed.cs

<pre>string args;

                if (this.m_Commodity.Name == null)
                    args = String.Format("#{0}\t{1}", (this.m_Commodity is ICommodity) ? ((ICommodity)this.m_Commodity).DescriptionNumber : this.m_Commodity.LabelNumber, this.m_Commodity.Amount);
                else
                    args = String.Format("{0}\t{1}", this.m_Commodity.Name, this.m_Commodity.Amount);</pre>

## Duplicated Code. Size: 134

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SpecialFishingNet.cs

<pre>if (this.Deleted || this.m_InUse)
                return;

            IPoint3D p3D = obj as IPoint3D;

            if (p3D == null)
                return;

            Map map = from.Map;

            if (map == null || map == Map.Internal)
                return;

            int x = p3D.X, y = p3D.Y, z = map.GetAverageZ(x, y); // OSI just takes the targeted Z</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\SpecialSalvageHook.cs

<pre>if (this.Deleted || this.m_InUse)
                return;

            IPoint3D p3D = obj as IPoint3D;

            if (p3D == null)
                return;

            Map map = from.Map;

            if (map == null || map == Map.Internal)
                return;

            int x = p3D.X, y = p3D.Y, z = map.GetAverageZ(x, y); // OSI just takes the targeted Z</pre>

## Duplicated Code. Size: 134

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\MondainsLegacy.cs

<pre>public static bool FindItem(Point3D p, Map map, Item test)
        {
            IPooledEnumerable eable = map.GetItemsInRange(p);

            foreach (Item item in eable)
            {
                if (item.Z == p.Z && item.ItemID == test.ItemID)
                {
                    eable.Free();
                    return true;
                }
            }

            eable.Free();
            return false;
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\TimeOfLegends.cs

<pre>public static bool FindItem(Point3D p, Map map, Item test)
        {
            IPooledEnumerable eable = map.GetItemsInRange(p);

            foreach (Item item in eable)
            {
                if (item.Z == p.Z && item.ItemID == test.ItemID)
                {
                    eable.Free();
                    return true;
                }
            }

            eable.Free();
            return false;
        }</pre>

## Duplicated Code. Size: 134

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>if (this.AcquireFocusMob(this.m_Mobile.RangePerception, this.m_Mobile.FightMode, false, false, true))
                {
                    this.m_Mobile.Combatant = this.m_Mobile.FocusMob;
                    this.m_Mobile.FocusMob = null;
                }
                else if (!this.m_Mobile.InRange(c, this.m_Mobile.RangePerception * 3))
                {
                    this.m_Mobile.Combatant = null;
                }</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>if (this.AcquireFocusMob(this.m_Mobile.RangePerception, this.m_Mobile.FightMode, false, false, true))
                {
                    this.m_Mobile.Combatant = this.m_Mobile.FocusMob;
                    this.m_Mobile.FocusMob = null;
                }
                else if (!this.m_Mobile.InRange(c, this.m_Mobile.RangePerception * 3))
                {
                    this.m_Mobile.Combatant = null;
                }</pre>

## Duplicated Code. Size: 134

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MeleeAI.cs

<pre>if (this.AcquireFocusMob(this.m_Mobile.RangePerception, this.m_Mobile.FightMode, false, false, true))
                {
                    this.m_Mobile.Combatant = this.m_Mobile.FocusMob;
                    this.m_Mobile.FocusMob = null;
                }
                else if (!this.m_Mobile.InRange(combatant, this.m_Mobile.RangePerception * 3))
                {
                    this.m_Mobile.Combatant = null;
                }</pre>

Fragment 2 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>if (this.AcquireFocusMob(this.m_Mobile.RangePerception, this.m_Mobile.FightMode, false, false, true))
                {
                    this.m_Mobile.Combatant = this.m_Mobile.FocusMob;
                    this.m_Mobile.FocusMob = null;
                }
                else if (!this.m_Mobile.InRange(combatant, this.m_Mobile.RangePerception * 3))
                {
                    this.m_Mobile.Combatant = null;
                }</pre>

## Duplicated Code. Size: 134

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\SeaHorse.cs

<pre>this.InitStats(Utility.Random(50, 30), Utility.Random(50, 30), 10);
            this.Skills[SkillName.MagicResist].Base = 25.0 + (Utility.RandomDouble() * 5.0);
            this.Skills[SkillName.Wrestling].Base = 35.0 + (Utility.RandomDouble() * 10.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SilverSteed.cs

<pre>this.InitStats(Utility.Random(50, 30), Utility.Random(50, 30), 10);
            this.Skills[SkillName.MagicResist].Base = 25.0 + (Utility.RandomDouble() * 5.0);
            this.Skills[SkillName.Wrestling].Base = 35.0 + (Utility.RandomDouble() * 10.0);</pre>

## Duplicated Code. Size: 134

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string currentvalue = "0";
										try
										{
											string[] arglist2 = ParseString(tmpvalue, 2, "=");
											string[] arglist3 = ParseString(arglist2[1], 2, " ");
											currentvalue = arglist3[0].Trim();
										}
										catch { }
										string tmpstr = currentvalue;
										// should use the actual ptype info to do the multiplication.  Maybe later.
										double d0,d1;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string currentvalue = "0";
										try
										{
											string[] arglist2 = ParseString(tmpvalue, 2, "=");
											string[] arglist3 = ParseString(arglist2[1], 2, " ");
											currentvalue = arglist3[0].Trim();
										}
										catch { }
										string tmpstr = currentvalue;

										// should use the actual ptype info to do the addition.  Maybe later.
										double d0,d1;</pre>

## Duplicated Code. Size: 134

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\CommandUndead.cs

<pre>bc.PlaySound(0x5C4);
                            bc.Allured = true;

                            Container pack = bc.Backpack;

                            if (pack != null)
                            {
                                for (int i = pack.Items.Count - 1; i >= 0; --i)
                                {
                                    if (i >= pack.Items.Count)
                                        continue;

                                    pack.Items[i].Delete();
                                }
                            }</pre>

Fragment 2 in file Scripts\Spells\Spellweaving\DryadAllure.cs

<pre>bc.PlaySound(0x5C4);
                        bc.Allured = true;

                        Container pack = bc.Backpack;

                        if (pack != null)
                        {
                            for (int i = pack.Items.Count - 1; i >= 0; --i)
                            {
                                if (i >= pack.Items.Count)
                                    continue;

                                pack.Items[i].Delete();
                            }
                        }</pre>

## Duplicated Code. Size: 134

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\AnkhOfSacrifice.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.m_IsRewardItem && !RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.   
        }</pre>

Fragment 2 in file Scripts\Items\Addons\MiningCart.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.m_IsRewardItem && !RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.
        }</pre>

Fragment 3 in file Scripts\Items\Addons\MinotaurStatue.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.m_IsRewardItem && !RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.    
        }</pre>

Fragment 4 in file Scripts\Items\Addons\TreeStump.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.m_IsRewardItem && !RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.
        }</pre>

## Duplicated Code. Size: 134

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Harrower\Harrower.cs

<pre>public void GiveArtifact(Mobile to, Item artifact)
        {
            if (to == null || artifact == null)
                return;

			to.PlaySound(0x5B4);

            Container pack = to.Backpack;

            if (pack == null || !pack.TryDropItem(to, artifact, false))
                artifact.Delete();
            else
                to.SendLocalizedMessage(1062317); // For your valor in combating the fallen beast, a special artifact has been bestowed on you.
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseRenowned.cs

<pre>public void GiveArtifact(Mobile to, Item artifact)
        {
            if (to == null || artifact == null)
                return;

			to.PlaySound(0x5B4);

            Container pack = to.Backpack;

            if (pack == null || !pack.TryDropItem(to, artifact, false))
                artifact.Delete();
            else
                to.SendLocalizedMessage(1062317); // For your valor in combating the fallen beast, a special artifact has been bestowed on you.
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\BaseSABosses.cs

<pre>public void GiveArtifact(Mobile to, Item artifact)
        {
            if (to == null || artifact == null)
                return;

			to.PlaySound(0x5B4);

            Container pack = to.Backpack;

            if (pack == null || !pack.TryDropItem(to, artifact, false))
                artifact.Delete();
            else
                to.SendLocalizedMessage(1062317); // For your valor in combating the fallen beast, a special artifact has been bestowed on you.
        }</pre>

Fragment 4 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>public void GiveArtifact(Mobile to, Item artifact)
        {
            if (to == null || artifact == null)
                return;

			to.PlaySound(0x5B4);

            Container pack = to.Backpack;

            if (pack == null || !pack.TryDropItem(to, artifact, false))
                artifact.Delete();
            else
                to.SendLocalizedMessage(1062317); // For your valor in combating the fallen beast, a special artifact has been bestowed on you.
        }</pre>

## Duplicated Code. Size: 134

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Brazier.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.m_IsRewardItem && !RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1042038); // You must have the object in your backpack to use it.
        }</pre>

Fragment 2 in file Scripts\Items\Addons\DecorativeShield.cs

<pre>public override void OnDoubleClick(Mobile from)
        { 
            if (this.m_IsRewardItem && !RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1042038); // You must have the object in your backpack to use it.          	
        }</pre>

Fragment 3 in file Scripts\Items\Addons\PottedCactus.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.m_IsRewardItem && !RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1042038); // You must have the object in your backpack to use it.
        }</pre>

Fragment 4 in file Scripts\Items\Addons\StoneAnkh.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.m_IsRewardItem && !RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1042038); // You must have the object in your backpack to use it.    
        }</pre>

Fragment 5 in file Scripts\Items\Addons\WallBanner.cs

<pre>public override void OnDoubleClick(Mobile from)
        { 
            if (this.m_IsRewardItem && !RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1042038); // You must have the object in your backpack to use it.          	
        }</pre>

## Duplicated Code. Size: 134

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\Granite.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (!CraftResources.IsStandard(this.m_Resource))
            {
                int num = CraftResources.GetLocalizationNumber(this.m_Resource);

                if (num > 0)
                    list.Add(num);
                else
                    list.Add(CraftResources.GetName(this.m_Resource));
            }
        }</pre>

Fragment 2 in file Scripts\Items\Resource\Hides.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (!CraftResources.IsStandard(this.m_Resource))
            {
                int num = CraftResources.GetLocalizationNumber(this.m_Resource);

                if (num > 0)
                    list.Add(num);
                else
                    list.Add(CraftResources.GetName(this.m_Resource));
            }
        }</pre>

Fragment 3 in file Scripts\Items\Resource\Ingots.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (!CraftResources.IsStandard(this.m_Resource))
            {
                int num = CraftResources.GetLocalizationNumber(this.m_Resource);

                if (num > 0)
                    list.Add(num);
                else
                    list.Add(CraftResources.GetName(this.m_Resource));
            }
        }</pre>

Fragment 4 in file Scripts\Items\Resource\Leathers.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (!CraftResources.IsStandard(this.m_Resource))
            {
                int num = CraftResources.GetLocalizationNumber(this.m_Resource);

                if (num > 0)
                    list.Add(num);
                else
                    list.Add(CraftResources.GetName(this.m_Resource));
            }
        }</pre>

Fragment 5 in file Scripts\Items\Resource\Ore.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (!CraftResources.IsStandard(this.m_Resource))
            {
                int num = CraftResources.GetLocalizationNumber(this.m_Resource);

                if (num > 0)
                    list.Add(num);
                else
                    list.Add(CraftResources.GetName(this.m_Resource));
            }
        }</pre>

## Duplicated Code. Size: 134

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ExodusMinion.cs

<pre>public void SendEBolt(Mobile to)
        {
            this.MovingParticles(to, 0x379F, 7, 0, false, true, 0xBE3, 0xFCB, 0x211);
            to.PlaySound(0x229);
            this.DoHarmful(to);
            AOS.Damage(to, this, 50, 0, 0, 0, 0, 100);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ExodusOverseer.cs

<pre>public void SendEBolt(Mobile to)
        {
            this.MovingParticles(to, 0x379F, 7, 0, false, true, 0xBE3, 0xFCB, 0x211);
            to.PlaySound(0x229);
            this.DoHarmful(to);
            AOS.Damage(to, this, 50, 0, 0, 0, 0, 100);
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusDrone.cs

<pre>public void SendEBolt(Mobile to)
        {
            this.MovingParticles(to, 0x379F, 7, 0, false, true, 0xBE3, 0xFCB, 0x211);
            to.PlaySound(0x229);
            this.DoHarmful(to);
            AOS.Damage(to, this, 50, 0, 0, 0, 0, 100);
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusJuggernaut.cs

<pre>public void SendEBolt(Mobile to)
        {
            this.MovingParticles(to, 0x379F, 7, 0, false, true, 0xBE3, 0xFCB, 0x211);
            to.PlaySound(0x229);
            this.DoHarmful(to);
            AOS.Damage(to, this, 50, 0, 0, 0, 0, 100);
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusMinionLord.cs

<pre>public void SendEBolt(Mobile to)
        {
            this.MovingParticles(to, 0x379F, 7, 0, false, true, 0xBE3, 0xFCB, 0x211);
            to.PlaySound(0x229);
            this.DoHarmful(to);
            AOS.Damage(to, this, 50, 0, 0, 0, 0, 100);
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusSentinel.cs

<pre>public void SendEBolt(Mobile to)
        {
            this.MovingParticles(to, 0x379F, 7, 0, false, true, 0xBE3, 0xFCB, 0x211);
            to.PlaySound(0x229);
            this.DoHarmful(to);
            AOS.Damage(to, this, 50, 0, 0, 0, 0, 100);
        }</pre>

## Duplicated Code. Size: 133

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SHTelGenDelete.cs

<pre>public static SHTeleporter FindSHTeleporter(Map map, Point3D p)
            {
                IPooledEnumerable eable = map.GetItemsInRange(p, 0);

                foreach (Item item in eable)
                {
                    if (item is SHTeleporter && item.Z == p.Z)
                    {
                        eable.Free();
                        return (SHTeleporter)item;
                    }
                }

                eable.Free();
                return null;
            }</pre>

Fragment 2 in file Scripts\Items\Addons\SHTeleporter.cs

<pre>public static SHTeleporter FindSHTeleporter(Map map, Point3D p)
            {
                IPooledEnumerable eable = map.GetItemsInRange(p, 0);

                foreach (Item item in eable)
                {
                    if (item is SHTeleporter && item.Z == p.Z)
                    {
                        eable.Free();
                        return (SHTeleporter)item;
                    }
                }

                eable.Free();
                return null;
            }</pre>

## Duplicated Code. Size: 133

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetPoint2DGump.cs

<pre>public InternalTarget(PropertyInfo prop, Mobile mobile, object o, Stack stack, int page, ArrayList list)
                : base(-1, true, TargetFlags.None)
            {
                this.m_Property = prop;
                this.m_Mobile = mobile;
                this.m_Object = o;
                this.m_Stack = stack;
                this.m_Page = page;
                this.m_List = list;
            }</pre>

Fragment 2 in file Scripts\Gumps\Properties\SetPoint3DGump.cs

<pre>public InternalTarget(PropertyInfo prop, Mobile mobile, object o, Stack stack, int page, ArrayList list)
                : base(-1, true, TargetFlags.None)
            {
                this.m_Property = prop;
                this.m_Mobile = mobile;
                this.m_Object = o;
                this.m_Stack = stack;
                this.m_Page = page;
                this.m_List = list;
            }</pre>

## Duplicated Code. Size: 133

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\BaseConflagrationPotion.cs

<pre>if (this.Deleted || map == null)
                return;

            this.Consume();

            // Check if any other players are using this potion
            for (int i = 0; i < this.m_Users.Count; i ++)
            {
                ThrowTarget targ = this.m_Users[i].Target as ThrowTarget;

                if (targ != null && targ.Potion == this)
                    Target.Cancel(from);
            }</pre>

Fragment 2 in file Scripts\Items\Consumables\BaseConfusionBlastPotion.cs

<pre>if (this.Deleted || map == null)
                return;

            this.Consume();

            // Check if any other players are using this potion
            for (int i = 0; i < this.m_Users.Count; i ++)
            {
                ThrowTarget targ = this.m_Users[i].Target as ThrowTarget;

                if (targ != null && targ.Potion == this)
                    Target.Cancel(from);
            }</pre>

## Duplicated Code. Size: 133

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\ArcherAI.cs

<pre>public override bool DoActionGuard()
		{
			if (AcquireFocusMob(m_Mobile.RangePerception, m_Mobile.FightMode, false, false, true))
			{
				if (m_Mobile.Debug)
				{
					m_Mobile.DebugSay("I have detected {0}, attacking", m_Mobile.FocusMob.Name);
				}

				m_Mobile.Combatant = m_Mobile.FocusMob;
				Action = ActionType.Combat;
			}
			else
			{
				base.DoActionGuard();
			}

			return true;
		}</pre>

Fragment 2 in file Scripts\Mobiles\AI\OrcScoutAI.cs

<pre>public override bool DoActionGuard()
		{
			if (AcquireFocusMob(m_Mobile.RangePerception, m_Mobile.FightMode, false, false, true))
			{
				if (m_Mobile.Debug)
				{
					m_Mobile.DebugSay("I have detected {0}, attacking", m_Mobile.FocusMob.Name);
				}

				m_Mobile.Combatant = m_Mobile.FocusMob;
				Action = ActionType.Combat;
			}
			else
			{
				base.DoActionGuard();
			}

			return true;
		}</pre>

## Duplicated Code. Size: 133

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\BaseShipCaptain.cs

<pre>if (this.Female = Utility.RandomBool())
            {
                Body = 0x191;
                Name = NameList.RandomName("female");
                AddItem(new Skirt(Utility.RandomNeutralHue()));
            }
            else
            {
                Body = 0x190;
                Name = NameList.RandomName("male");
                AddItem(new ShortPants(Utility.RandomNeutralHue()));
            }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\MerchantCrew.cs

<pre>if (this.Female = Utility.RandomBool())
            {
                Body = 0x191;
                Name = NameList.RandomName("female");
                AddItem(new Skirt(Utility.RandomNeutralHue()));
            }
            else
            {
                Body = 0x190;
                Name = NameList.RandomName("male");
                AddItem(new ShortPants(Utility.RandomNeutralHue()));
            }</pre>

## Duplicated Code. Size: 133

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (o == null)
			{
				return "Null object";
			}

			Type ptype = null;
			object po = null;
			Type type = o.GetType();

			PropertyInfo[] props = type.GetProperties(BindingFlags.Static | BindingFlags.Instance | BindingFlags.Public);

			// parse the strings of the form property.attribute into two parts
			// first get the property
			string[] arglist = ParseString(name, 2, ".");</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (o == null)
			{
				return "Null object";
			}

			Type ptype = null;
			object po = null;
			Type type = o.GetType();

			PropertyInfo[] props = type.GetProperties(BindingFlags.Static | BindingFlags.Instance | BindingFlags.Public);

			// parse the strings of the form property.attribute into two parts
			// first get the property
			string[] arglist = ParseString(name, 2, ".");</pre>

## Duplicated Code. Size: 133

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestLeaders.cs

<pre>if(state == null || state.Mobile == null || info == null) return;
				// Get the current name
				if(m_attachment != null)
				{
					TextRelay entry = info.GetTextEntry( 200 );
					if(entry != null)
						m_attachment.guildFilter = entry.Text;

					entry = info.GetTextEntry( 100 );
					if(entry != null)
						m_attachment.nameFilter = entry.Text;
				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>if(state == null || state.Mobile == null || info == null) return;
				// Get the current name
				if(m_attachment != null)
				{
					TextRelay entry = info.GetTextEntry( 200 );
					if(entry != null)
						m_attachment.guildFilter = entry.Text;

					entry = info.GetTextEntry( 100 );
					if(entry != null)
						m_attachment.nameFilter = entry.Text;
				}</pre>

## Duplicated Code. Size: 133

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGauntlet.cs

<pre>if(Participants == null || !GameInProgress) return;

            int leftstanding = 0;
            Mobile winner = null;

            foreach(IChallengeEntry entry in Participants)
            {
                // either being the last participant left
                if(entry.Status == ChallengeStatus.Active)
                {
                    leftstanding++;
                    winner = entry.Participant;
                }

                // or reaching the target score
                if(entry.Score >= TargetScore)
                {
                    winner = entry.Participant;
                    leftstanding = 1;
                    break;
                }
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGauntlet.cs

<pre>if(Participants == null || !GameInProgress) return;

            int leftstanding = 0;
            Mobile winner = null;

            foreach(IChallengeEntry entry in Participants)
            {
                // either being the last participant left
                if(entry.Status == ChallengeStatus.Active)
                {
                    leftstanding++;
                    winner = entry.Participant;
                }

                // or reaching the target score
                if(entry.Score >= TargetScore)
                {
                    winner = entry.Participant;
                    leftstanding = 1;
                    break;
                }
            }</pre>

## Duplicated Code. Size: 133

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\Core\SkillMasteryPrimer.cs

<pre>Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 4, from.Y - 6, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0xAA8, 0, 9502, 1, 0, (EffectLayer)255, 0x100);</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\Core\SkillMasteryPrimer.cs

<pre>Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(from.X - 6, from.Y - 4, from.Z + 15), from.Map), from, 0x36D4, 7, 0, false, true, 0xAA8, 0, 9502, 1, 0, (EffectLayer)255, 0x100);</pre>

## Duplicated Code. Size: 133

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\Whispering.cs

<pre>Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(m.X - 4, m.Y - 6, m.Z + 15), m.Map), m, 0x36D4, 7, 0, false, true, 1494, 0, 9502, 1, 0, (EffectLayer)255, 0x100);</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\Whispering.cs

<pre>Effects.SendMovingParticles(new Entity(Serial.Zero, new Point3D(m.X - 6, m.Y - 4, m.Z + 15), m.Map), m, 0x36D4, 7, 0, false, true, 1494, 0, 9502, 1, 0, (EffectLayer)255, 0x100);</pre>

## Duplicated Code. Size: 133

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Daemon.cs

<pre>{
                case 0:
                    PackItem(new LichFormScroll());
                    break;
                case 1:
                    PackItem(new PoisonStrikeScroll());
                    break;
                case 2:
                    PackItem(new StrangleScroll());
                    break;
                case 3:
                    PackItem(new VengefulSpiritScroll());
                    break;
                case 4:
                    PackItem(new WitherScroll());
                    break;
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Lich.cs

<pre>{
                case 0: PackItem(new LichFormScroll()); break;
                case 1: PackItem(new PoisonStrikeScroll()); break;
                case 2: PackItem(new StrangleScroll()); break;
                case 3: PackItem(new VengefulSpiritScroll()); break;
				case 4: PackItem(new WitherScroll()); break;
			}</pre>

Fragment 3 in file Scripts\Mobiles\Normal\LichLord.cs

<pre>{
                case 0: PackItem(new LichFormScroll()); break;
                case 1: PackItem(new PoisonStrikeScroll()); break;
                case 2: PackItem(new StrangleScroll()); break;
                case 3: PackItem(new VengefulSpiritScroll()); break;
				case 4: PackItem(new WitherScroll()); break;
			}</pre>

## Duplicated Code. Size: 133

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>AddImage(0, 0, 8000);
            AddImage(20, 37, 8001);
            AddImage(20, 107, 8002);
            AddImage(20, 177, 8001);
            AddImage(20, 247, 8002);
            AddImage(20, 317, 8001);
            AddImage(20, 387, 8003);</pre>

Fragment 2 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>AddImage(0, 0, 8000);
            AddImage(20, 37, 8001);
            AddImage(20, 107, 8002);
            AddImage(20, 177, 8001);
            AddImage(20, 247, 8002);
            AddImage(20, 317, 8001);
            AddImage(20, 387, 8003);</pre>

Fragment 3 in file Scripts\Services\LoyaltySystem\LoyaltyRatingGump.cs

<pre>AddImage(0, 0, 8000);
            AddImage(20, 37, 8001);
            AddImage(20, 107, 8002);
            AddImage(20, 177, 8001);
            AddImage(20, 247, 8002);
            AddImage(20, 317, 8001);
            AddImage(20, 387, 8003);</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\PropsGump.cs

<pre>if (o == null)
			{
				return "-null-";
			}

			if (o is string)
			{
				return String.Format("\"{0}\"", o);
			}

			if (o is bool)
			{
				return o.ToString();
			}

			if (o is char)
			{
				return String.Format("0x{0:X} '{1}'", (int)(char)o, (char)o);
			}</pre>

Fragment 2 in file Scripts\Gumps\Properties\PropsGump.cs

<pre>if (o == null)
			{
				return "-null-";
			}

			if (o is string)
			{
				return String.Format("\"{0}\"", o);
			}

			if (o is bool)
			{
				return o.ToString();
			}

			if (o is char)
			{
				return String.Format("0x{0:X} '{1}'", (int)(char)o, (char)o);
			}</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if (checkSkills)
			{
				attacker.CheckSkill(SkillName.Tactics, 0.0, attacker.Skills[SkillName.Tactics].Cap);
					// Passively check tactics for gain
				attacker.CheckSkill(SkillName.Anatomy, 0.0, attacker.Skills[SkillName.Anatomy].Cap);
					// Passively check Anatomy for gain

				if (Type == WeaponType.Axe)
				{
					attacker.CheckSkill(SkillName.Lumberjacking, 0.0, 100.0); // Passively check Lumberjacking for gain
				}
			}</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if (checkSkills)
			{
				attacker.CheckSkill(SkillName.Tactics, 0.0, attacker.Skills[SkillName.Tactics].Cap);
					// Passively check tactics for gain
				attacker.CheckSkill(SkillName.Anatomy, 0.0, attacker.Skills[SkillName.Anatomy].Cap);
					// Passively check Anatomy for gain

				if (Type == WeaponType.Axe)
				{
					attacker.CheckSkill(SkillName.Lumberjacking, 0.0, 100.0); // Passively check Lumberjacking for gain
				}
			}</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Camps\OrcCamp.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_Prisoner = reader.ReadMobile();
                        break;
                    }
                case 0:
                    {
                        this.m_Prisoner = reader.ReadMobile();
                        reader.ReadItem();
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Multis\Camps\RatCamp.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_Prisoner = reader.ReadMobile();
                        break;
                    }
                case 0:
                    {
                        this.m_Prisoner = reader.ReadMobile();
                        reader.ReadItem();
                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Assistants.cs

<pre>pvSrc.Trace(state);

						if (state == null || state.Mobile == null || !state.Running)
						{
							return;
						}

						Mobile m = state.Mobile;

						if (!_Dictionary.ContainsKey(m))
						{
							return;
						}

						Timer t = _Dictionary[m];

						if (t != null)
						{
							t.Stop();
						}</pre>

Fragment 2 in file Scripts\Services\Assistants.cs

<pre>pvSrc.Trace(state);

				if (state == null || state.Mobile == null || !state.Running)
				{
					return;
				}

				Mobile m = state.Mobile;

				if (!_Dictionary.ContainsKey(m))
				{
					return;
				}

				Timer t = _Dictionary[m];

				if (t != null)
				{
					t.Stop();
				}</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\AcceptDuelGump.cs

<pre>this.AddHtml(22 - 1, 22, 294, 20, this.Color(this.Center("Duel Challenge"), BlackColor32), false, false);
            this.AddHtml(22 + 1, 22, 294, 20, this.Color(this.Center("Duel Challenge"), BlackColor32), false, false);</pre>

Fragment 2 in file Scripts\Services\ConPVP\AcceptDuelGump.cs

<pre>this.AddHtml(22, 22 - 1, 294, 20, this.Color(this.Center("Duel Challenge"), BlackColor32), false, false);
            this.AddHtml(22, 22 + 1, 294, 20, this.Color(this.Center("Duel Challenge"), BlackColor32), false, false);</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\BeginGump.cs

<pre>this.AddHtml(22 - 1, 22, 294, 20, this.Color(this.Center("Duel Countdown"), BlackColor32), false, false);
            this.AddHtml(22 + 1, 22, 294, 20, this.Color(this.Center("Duel Countdown"), BlackColor32), false, false);</pre>

Fragment 2 in file Scripts\Services\ConPVP\BeginGump.cs

<pre>this.AddHtml(22, 22 - 1, 294, 20, this.Color(this.Center("Duel Countdown"), BlackColor32), false, false);
            this.AddHtml(22, 22 + 1, 294, 20, this.Color(this.Center("Duel Countdown"), BlackColor32), false, false);</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Myrmidex Invasion\BattleSpawner.cs

<pre>foreach (Point2D[] pss in ps)
                {
                    foreach (Point2D p in pss)
                    {
                        var st = new Static(14089);
                        st.Hue = hue;
                        st.MoveToWorld(new Point3D(p.X, p.Y, Map.TerMur.GetAverageZ(p.X, p.Y)), Map.TerMur);
                    }
                }</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Myrmidex Invasion\BattleSpawner.cs

<pre>foreach (Point2D[] pss in ps)
                {
                    foreach (Point2D p in pss)
                    {
                        var st = new Static(14089);
                        st.Hue = hue;
                        st.MoveToWorld(new Point3D(p.X, p.Y, Map.TerMur.GetAverageZ(p.X, p.Y)), Map.TerMur);
                    }
                }</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionKnight.cs

<pre>this.AddItem(this.Immovable(this.Rehued(new PlateArms(), 2125)));
            this.AddItem(this.Immovable(this.Rehued(new PlateGloves(), 2125)));

            this.AddItem(this.Immovable(this.Rehued(new BodySash(), 1254)));</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionPaladin.cs

<pre>this.AddItem(this.Immovable(this.Rehued(new PlateArms(), 2125)));
            this.AddItem(this.Immovable(this.Rehued(new PlateGloves(), 2125)));

            this.AddItem(this.Immovable(this.Rehued(new BodySash(), 1254)));</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>SetResistance(ResistanceType.Physical, 50, 65);
            SetResistance(ResistanceType.Fire, 35, 45);
            SetResistance(ResistanceType.Cold, 35, 45);
            SetResistance(ResistanceType.Poison, 45, 55);
            SetResistance(ResistanceType.Energy, 25, 35);

            SetSkill(SkillName.MagicResist, 40, 70);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>SetResistance(ResistanceType.Physical, 50, 65);
            SetResistance(ResistanceType.Fire, 35, 45);
            SetResistance(ResistanceType.Cold, 35, 45);
            SetResistance(ResistanceType.Poison, 45, 55);
            SetResistance(ResistanceType.Energy, 25, 35);

            SetSkill(SkillName.MagicResist, 40, 70);</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>SetResistance( ResistanceType.Fire, 50, 60 );
			SetResistance( ResistanceType.Cold, 50, 60 );
			SetResistance( ResistanceType.Poison, 50, 60 );
			SetResistance( ResistanceType.Energy, 50, 60 );

			SetSkill( SkillName.MagicResist, 125, 140 );
			SetSkill( SkillName.Tactics, 100, 120 );</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>SetResistance(ResistanceType.Fire, 50, 60);
            SetResistance(ResistanceType.Cold, 50, 60);
            SetResistance(ResistanceType.Poison, 50, 60);
            SetResistance(ResistanceType.Energy, 50, 60);

            SetSkill(SkillName.MagicResist, 125, 140);
            SetSkill(SkillName.Tactics, 100, 120);</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGauntlet.cs

<pre>base.Serialize( writer );

            writer.Write( (int) 0 ); // version

            writer.Write(m_Challenger);
            writer.Write(m_GameLocked);
            writer.Write(m_GameInProgress);
            writer.Write(m_TotalPurse);
            writer.Write(m_EntryFee);
            writer.Write(m_ArenaSize);
            writer.Write(m_Winner);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGauntlet.cs

<pre>base.Serialize( writer );

            writer.Write( (int) 0 ); // version

            writer.Write(m_Challenger);
            writer.Write(m_GameLocked);
            writer.Write(m_GameInProgress);
            writer.Write(m_TotalPurse);
            writer.Write(m_EntryFee);
            writer.Write(m_ArenaSize);
            writer.Write(m_Winner);</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGauntlet.cs

<pre>base.Serialize( writer );

            writer.Write( (int) 0 ); // version

            writer.Write(m_Challenger);
            writer.Write(m_GameLocked);
            writer.Write(m_GameInProgress);
            writer.Write(m_TotalPurse);
            writer.Write(m_EntryFee);
            writer.Write(m_ArenaSize);
            writer.Write(m_TargetScore);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGauntlet.cs

<pre>base.Serialize( writer );

            writer.Write( (int) 0 ); // version

            writer.Write(m_Challenger);
            writer.Write(m_GameLocked);
            writer.Write(m_GameInProgress);
            writer.Write(m_TotalPurse);
            writer.Write(m_EntryFee);
            writer.Write(m_ArenaSize);
            writer.Write(m_TargetScore);</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBlacksmith.cs

<pre>this.Add(new GenericBuyInfo(typeof(RingmailChest), 121, 20, 0x13ec, 0));
                this.Add(new GenericBuyInfo(typeof(RingmailLegs), 90, 20, 0x13F0, 0));
                this.Add(new GenericBuyInfo(typeof(RingmailArms), 85, 20, 0x13EE, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBRingmailArmor.cs

<pre>this.Add(new GenericBuyInfo(typeof(RingmailChest), 121, 20, 0x13ec, 0));
                this.Add(new GenericBuyInfo(typeof(RingmailLegs), 90, 20, 0x13F0, 0));
                this.Add(new GenericBuyInfo(typeof(RingmailArms), 85, 20, 0x13EE, 0));</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBCook.cs

<pre>this.Add(new GenericBuyInfo(typeof(CookedBird), 17, 20, 0x9B7, 0));
                this.Add(new GenericBuyInfo(typeof(LambLeg), 8, 20, 0x160A, 0));
                this.Add(new GenericBuyInfo(typeof(ChickenLeg), 5, 20, 0x1608, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBProvisioner.cs

<pre>this.Add(new GenericBuyInfo(typeof(LambLeg), 8, 20, 0x160A, 0));
                this.Add(new GenericBuyInfo(typeof(ChickenLeg), 5, 20, 0x1608, 0));
                this.Add(new GenericBuyInfo(typeof(CookedBird), 17, 20, 0x9B7, 0));</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBHerbalist.cs

<pre>this.Add(new GenericBuyInfo(typeof(Ginseng), 3, 20, 0xF85, 0)); 
                this.Add(new GenericBuyInfo(typeof(Garlic), 3, 20, 0xF84, 0)); 
                this.Add(new GenericBuyInfo(typeof(MandrakeRoot), 3, 20, 0xF86, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBNecromancer.cs

<pre>this.Add( new GenericBuyInfo( typeof( MandrakeRoot ), 3, 20, 0xF86, 0 ) );
				this.Add( new GenericBuyInfo( typeof( Garlic ), 3, 20, 0xF84, 0 ) );
				this.Add( new GenericBuyInfo( typeof( Ginseng ), 3, 20, 0xF85, 0 ) );</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBProvisioner.cs

<pre>this.Add(new GenericBuyInfo(typeof(Torch), 8, 20, 0xF6B, 0));
                this.Add(new GenericBuyInfo(typeof(Lantern), 2, 20, 0xA25, 0));

                //TODO: Oil Flask @ 8GP

                this.Add(new GenericBuyInfo(typeof(Lockpick), 12, 20, 0x14FC, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBThief.cs

<pre>this.Add(new GenericBuyInfo(typeof(Torch), 8, 20, 0xF6B, 0));
                this.Add(new GenericBuyInfo(typeof(Lantern), 2, 20, 0xA25, 0));
                //Add( new GenericBuyInfo( typeof( OilFlask ), 8, 20, 0x####, 0 ) );
                this.Add(new GenericBuyInfo(typeof(Lockpick), 12, 20, 0x14FC, 0));</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Server\Gumps\GumpHtmlLocalized.cs

<pre>{
					disp.AppendLayout( m_LayoutNameColor );

					disp.AppendLayout( m_X );
					disp.AppendLayout( m_Y );
					disp.AppendLayout( m_Width );
					disp.AppendLayout( m_Height );
					disp.AppendLayout( m_Number );
					disp.AppendLayout( m_Background );
					disp.AppendLayout( m_Scrollbar );
					disp.AppendLayout( m_Color );

					break;
				}</pre>

Fragment 2 in file Server\Gumps\KRGumpHtmlLocalized.cs

<pre>{
						disp.AppendLayout( m_LayoutNameColor );
						disp.AppendLayout( m_X );
						disp.AppendLayout( m_Y );
						disp.AppendLayout( m_Width );
						disp.AppendLayout( m_Height );
						disp.AppendLayout( m_Number );
						disp.AppendLayout( m_Background );
						disp.AppendLayout( m_Scrollbar );
						disp.AppendLayout( m_Color );

						break;
					}</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>string type;

				if (guild.Type >= 0 && (int)guild.Type < m_GuildTypes.Length)
				{
					type = m_GuildTypes[(int)guild.Type];
				}
				else
				{
					type = "";
				}

				string title = GuildTitle;

				if (title == null)
				{
					title = "";
				}
				else
				{
					title = title.Trim();
				}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>string title = GuildTitle;
					string type;

					if (title == null)
					{
						title = "";
					}
					else
					{
						title = title.Trim();
					}

					if (guild.Type >= 0 && (int)guild.Type < m_GuildTypes.Length)
					{
						type = m_GuildTypes[(int)guild.Type];
					}
					else
					{
						type = "";
					}</pre>

## Duplicated Code. Size: 132

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write(beheld.Serial);
			m_Stream.Write((short)beheld.Body);
			m_Stream.Write((short)beheld.X);
			m_Stream.Write((short)beheld.Y);
			m_Stream.Write((sbyte)beheld.Z);
			m_Stream.Write((byte)beheld.Direction);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write(beheld.Serial);
			m_Stream.Write((short)beheld.Body);
			m_Stream.Write((short)beheld.X);
			m_Stream.Write((short)beheld.Y);
			m_Stream.Write((sbyte)beheld.Z);
			m_Stream.Write((byte)beheld.Direction);</pre>

## Duplicated Code. Size: 131

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if (!this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(502437); // Items you wish to cut must be in your backpack.
                return false;
            }

            if (Ethics.Ethic.IsImbued(this))
            {
                from.SendLocalizedMessage(502440); // Scissors can not be used on that to produce anything.
                return false;
            }

            CraftSystem system = DefTailoring.CraftSystem;

            CraftItem item = system.CraftItems.SearchFor(this.GetType());</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if (!this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(502437); // Items you wish to cut must be in your backpack.
                return false;
            }

            if (Ethics.Ethic.IsImbued(this))
            {
                from.SendLocalizedMessage(502440); // Scissors can not be used on that to produce anything.
                return false;
            }

            CraftSystem system = DefTailoring.CraftSystem;

            CraftItem item = system.CraftItems.SearchFor(this.GetType());</pre>

## Duplicated Code. Size: 131

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>Mobile owner = ControlMaster;

                if (owner == null || owner.Deleted || owner.Map != Map || !owner.InRange(this, 12) || !CanSee(owner) ||
                    !InLOS(owner))
                {
                    if (OwnerAbandonTime == DateTime.MinValue)
                    {
                        OwnerAbandonTime = DateTime.UtcNow;
                    }
                }
                else
                {
                    OwnerAbandonTime = DateTime.MinValue;
                }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>Mobile owner = ControlMaster;

            if (owner == null || owner.Deleted || owner.Map != Map || !owner.InRange(this, 12) || !CanSee(owner) || !InLOS(owner))
            {
                if (OwnerAbandonTime == DateTime.MinValue)
                {
                    OwnerAbandonTime = DateTime.UtcNow;
                }
            }
            else
            {
                OwnerAbandonTime = DateTime.MinValue;
            }</pre>

## Duplicated Code. Size: 131

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Regions.cs

<pre>public override bool OnBeginSpellCast(Mobile from, ISpell s)
        {
            if ((s is TeleportSpell || s is GateTravelSpell || s is RecallSpell || s is MarkSpell || s is SacredJourneySpell) && from.IsPlayer())
            {
                from.SendLocalizedMessage(500015); // You do not have that spell!
                return false;
            }
            else
            {
                return base.OnBeginSpellCast(from, s);
            }
        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Regions.cs

<pre>public override bool OnBeginSpellCast(Mobile from, ISpell s)
        {
            if ((s is TeleportSpell || s is GateTravelSpell || s is RecallSpell || s is MarkSpell || s is SacredJourneySpell) && from.IsPlayer())
            {
                from.SendLocalizedMessage(500015); // You do not have that spell!
                return false;
            }
            else
            {
                return base.OnBeginSpellCast(from, s);
            }
        }</pre>

## Duplicated Code. Size: 131

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Plants\EmptyTheBowlGump.cs

<pre>private void DrawBackground()
        {
            this.AddBackground(50, 50, 200, 150, 0xE10);

            this.AddItem(45, 45, 0xCEF);
            this.AddItem(45, 118, 0xCF0);

            this.AddItem(211, 45, 0xCEB);
            this.AddItem(211, 118, 0xCEC);
        }</pre>

Fragment 2 in file Scripts\Services\Plants\MainPlantGump.cs

<pre>private void DrawBackground()
        {
            this.AddBackground(50, 50, 200, 150, 0xE10);

            this.AddItem(45, 45, 0xCEF);
            this.AddItem(45, 118, 0xCF0);

            this.AddItem(211, 45, 0xCEB);
            this.AddItem(211, 118, 0xCEC);
        }</pre>

## Duplicated Code. Size: 131

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Underworld\ExperimentalRoom\Region.cs

<pre>if (from == null || from.Map == null)
                return;

            int x = Utility.RandomMinMax(m_Entrance.X, m_Entrance.X + m_Entrance.Width);
            int y = Utility.RandomMinMax(m_Entrance.Y, m_Entrance.Y + m_Entrance.Height);
            int z = from.Map.GetAverageZ(x, y);</pre>

Fragment 2 in file Scripts\Services\Underworld\Maze of Death\Region.cs

<pre>if(from == null || from.Map == null)
				return;

			int x = Utility.RandomMinMax(m_Entrance.X, m_Entrance.X + m_Entrance.Width);
			int y = Utility.RandomMinMax(m_Entrance.Y, m_Entrance.Y + m_Entrance.Height);
			int z = from.Map.GetAverageZ(x, y);</pre>

## Duplicated Code. Size: 131

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ViceVsVirtue\Items\Rewards\VvVWands.cs

<pre>public override void Serialize(GenericWriter writer)
		{
			base.Serialize(writer);
			writer.Write(0);

            if (this.IsArcane)
            {
                writer.Write(true);
                writer.Write((int)m_CurArcaneCharges);
                writer.Write((int)m_MaxArcaneCharges);
            }
            else
            {
                writer.Write(false);
            }
		}</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\Items\Rewards\VvVWands.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            if (this.IsArcane)
            {
                writer.Write(true);
                writer.Write((int)m_CurArcaneCharges);
                writer.Write((int)m_MaxArcaneCharges);
            }
            else
            {
                writer.Write(false);
            }
        }</pre>

## Duplicated Code. Size: 131

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlGetAttachGump.cs

<pre>{

						// dont allow individual selection with the selectall button selected
						if(m_SelectionList != null && m_SearchList != null && !SelectAll)
						{
							for(int i = 0; i < MaxEntries;i++)
							{
								if(i < m_SelectionList.Length){
									// only toggle the selection list entries for things that actually have entries
									if((m_SearchList.Count - DisplayFrom > i)) {
										m_SelectionList[i] = !m_SelectionList[i];
									}
								} else
								{
									break;
								}
							}
						}
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlEdit.cs

<pre>{

						// dont allow individual selection with the selectall button selected
						if(m_SelectionList != null && m_SearchList != null && !SelectAll)
						{
							for(int i = 0; i < MaxEntries;i++)
							{
								if(i < m_SelectionList.Length)
								{
									// only toggle the selection list entries for things that actually have entries
									if((m_SearchList.Count - DisplayFrom > i)) 
									{
										m_SelectionList[i] = !m_SelectionList[i];
									}
								} 
								else 
								{
									break;
								}
							}
						}
					}</pre>

## Duplicated Code. Size: 131

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>if (criteria.Dosearchwithattach && TestAttach(i))
						{
							hasattach = true;
						}
						if (criteria.Dosearchwithattach && !hasattach) continue;

						// check for condition
						if (criteria.Dosearchcondition && (criteria.Searchcondition != null))
						{
							// check the property test
							hascondition = BaseXmlSpawner.CheckPropertyString(null, i, criteria.Searchcondition, null, out status_str);
						}
						if (criteria.Dosearchcondition && !hascondition) continue;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>if (criteria.Dosearchwithattach && TestAttach(i))
						{
							hasattach = true;
						}
						if (criteria.Dosearchwithattach && !hasattach) continue;

						// check for condition
						if (criteria.Dosearchcondition && (criteria.Searchcondition != null))
						{
							// check the property test
							hascondition = BaseXmlSpawner.CheckPropertyString(null, i, criteria.Searchcondition, null, out status_str);
						}
						if (criteria.Dosearchcondition && !hascondition) continue;</pre>

## Duplicated Code. Size: 131

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>break;

				case 40:
					// match length
					double dval = 0;
					tr = info.GetTextEntry(40);
					if (tr != null)
					{
						try { dval = double.Parse(tr.Text); }
						catch { }
					}
					m_gauntlet.MatchLength = TimeSpan.FromMinutes(dval);

					m_gauntlet.ResetAcceptance();

					// update all the gumps
					RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>break;

                case 40:
                    // match length
                    double dval = 0;
                    tr = info.GetTextEntry( 40 );
                    if(tr != null)
                    {
                        try{dval = double.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.MatchLength = TimeSpan.FromMinutes(dval);

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>break;

                case 40:
                    // match length
                    double dval = 0;
                    tr = info.GetTextEntry( 40 );
                    if(tr != null)
                    {
                        try{dval = double.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.MatchLength = TimeSpan.FromMinutes(dval);

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

## Duplicated Code. Size: 131

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int HitPoints
        {
            get 
            {
                return this.m_HitPoints;
            }
            set 
            {
                if (value != this.m_HitPoints && this.MaxHitPoints > 0)
                {
                    this.m_HitPoints = value;

                    if (this.m_HitPoints < 0)
                        this.Delete();
                    else if (this.m_HitPoints > this.MaxHitPoints)
                        this.m_HitPoints = this.MaxHitPoints;

                    this.InvalidateProperties();
                }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int HitPoints
        {
            get 
            {
                return this.m_HitPoints;
            }
            set 
            {
                if (value != this.m_HitPoints && this.MaxHitPoints > 0)
                {
                    this.m_HitPoints = value;

                    if (this.m_HitPoints < 0)
                        this.Delete();
                    else if (this.m_HitPoints > this.MaxHitPoints)
                        this.m_HitPoints = this.MaxHitPoints;

                    this.InvalidateProperties();
                }
            }
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int HitPoints
        {
            get 
            {
                return this.m_HitPoints;
            }
            set 
            {
                if (value != this.m_HitPoints && this.MaxHitPoints > 0)
                {
                    this.m_HitPoints = value;

                    if (this.m_HitPoints < 0)
                        this.Delete();
                    else if (this.m_HitPoints > this.MaxHitPoints)
                        this.m_HitPoints = this.MaxHitPoints;

                    this.InvalidateProperties();
                }
            }
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Talismans\BaseTalisman.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int HitPoints
        {
            get
            {
                return this.m_HitPoints;
            }
            set
            {
                if (value != this.m_HitPoints && this.MaxHitPoints > 0)
                {
                    this.m_HitPoints = value;

                    if (this.m_HitPoints < 0)
                        this.Delete();
                    else if (this.m_HitPoints > this.MaxHitPoints)
                        this.m_HitPoints = this.MaxHitPoints;

                    this.InvalidateProperties();
                }
            }
        }</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Add.cs

<pre>string[] subArgs = new string[e.Length - 5];

                for (int i = 0; i < subArgs.Length; ++i)
                    subArgs[i] = e.Arguments[i + 5];

                Add.Invoke(e.Mobile, p, p2, subArgs, null, outline, false);</pre>

Fragment 2 in file Scripts\Commands\Add.cs

<pre>string[] subArgs = new string[e.Length - 5];

                for (int i = 0; i < subArgs.Length; ++i)
                    subArgs[i] = e.Arguments[i + 5];

                Add.Invoke(e.Mobile, p, p2, subArgs, null, outline, false);</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BaseAddon.cs

<pre>{
            if (this.Deleted)
                return;

            this.m_Components.Add(c);

            c.Addon = this;
            c.Offset = new Point3D(x, y, z);
            c.MoveToWorld(new Point3D(this.X + x, this.Y + y, this.Z + z), this.Map);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\BaseAddonContainer.cs

<pre>{
            if (this.Deleted)
                return;

            this.m_Components.Add(c);

            c.Addon = this;
            c.Offset = new Point3D(x, y, z);
            c.MoveToWorld(new Point3D(this.X + x, this.Y + y, this.Z + z), this.Map);
        }</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\Equivocation.cs

<pre>{
            this.Attributes.BalancedWeapon = 1;

            this.Slayer2 = BaseRunicTool.GetRandomSlayer();
            this.Attributes.AttackChance = 10;
            this.Attributes.RegenHits = 6;
            this.Attributes.Brittle = 1;
            this.Attributes.WeaponSpeed = 35;
            this.Attributes.WeaponDamage = 50;
            this.WeaponAttributes.HitCurse = 15;

            this.Hue = 1365;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\Equivocation.cs

<pre>{
            this.Attributes.BalancedWeapon = 1;

            this.Slayer2 = BaseRunicTool.GetRandomSlayer();
            this.Attributes.AttackChance = 10;
            this.Attributes.RegenHits = 6;
            this.Attributes.Brittle = 1;
            this.Attributes.WeaponSpeed = 35;
            this.Attributes.WeaponDamage = 50;
            this.WeaponAttributes.HitCurse = 15;

            this.Hue = 1365;
        }</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\Pincer.cs

<pre>{
            this.Hue = 2500;

            this.Attributes.BalancedWeapon = 1;
            this.Slayer2 = BaseRunicTool.GetRandomSlayer();
            this.SetSkillBonuses.SetValues(0, SkillName.Lumberjacking, 10);
            this.WeaponAttributes.HitLeechHits = 87;
            this.Attributes.RegenStam = 6;
            this.Attributes.RegenMana = 6;
            this.Attributes.WeaponDamage = 40;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\Pincer.cs

<pre>{
            this.Hue = 2500;

            this.Attributes.BalancedWeapon = 1;
            this.Slayer2 = BaseRunicTool.GetRandomSlayer();
            this.SetSkillBonuses.SetValues(0, SkillName.Lumberjacking, 10);
            this.WeaponAttributes.HitLeechHits = 87;
            this.Attributes.RegenStam = 6;
            this.Attributes.RegenMana = 6;
            this.Attributes.WeaponDamage = 40;
        }</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Abscess.cs

<pre>this.SetDamageType(ResistanceType.Physical, 60);
            this.SetDamageType(ResistanceType.Fire, 10);
            this.SetDamageType(ResistanceType.Cold, 10);
            this.SetDamageType(ResistanceType.Poison, 10);
            this.SetDamageType(ResistanceType.Energy, 10);

            this.SetResistance(ResistanceType.Physical, 65, 75);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Hydra.cs

<pre>this.SetDamageType(ResistanceType.Physical, 60);
            this.SetDamageType(ResistanceType.Fire, 10);
            this.SetDamageType(ResistanceType.Cold, 10);
            this.SetDamageType(ResistanceType.Poison, 10);
            this.SetDamageType(ResistanceType.Energy, 10);

            this.SetResistance(ResistanceType.Physical, 65, 75);</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Imp.cs

<pre>PackItem(new BloodOathScroll()); break;
                case 1: PackItem(new CorpseSkinScroll()); break;
                case 2: PackItem(new CurseWeaponScroll()); break;
                case 3: PackItem(new EvilOmenScroll()); break;
				case 4: PackItem(new HorrificBeastScroll()); break;
				case 5:</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RatmanMage.cs

<pre>break;
                case 1: PackItem(new BloodOathScroll()); break;
                case 2: PackItem(new CorpseSkinScroll()); break;
                case 3: PackItem(new CurseWeaponScroll()); break;
				case 4: PackItem(new EvilOmenScroll()); break;
				case 5: PackItem(new HorrificBeastScroll());</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\MilitiaFighter.cs

<pre>public override bool IsEnemy(Mobile m)
        {
            if (m.Player || m is BaseVendor)
                return false;

            if (m is BaseCreature)
            {
                BaseCreature bc = (BaseCreature)m;

                Mobile master = bc.GetMaster();
                if (master != null)
                    return this.IsEnemy(master);
            }

            return m.Karma < 0;
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\MilitiaCanoneer.cs

<pre>public override bool IsEnemy(Mobile m)
        {
            if (m.Player || m is BaseVendor)
                return false;

            if (m is BaseCreature)
            {
                BaseCreature bc = (BaseCreature)m;

                Mobile master = bc.GetMaster();
                if (master != null)
                    return this.IsEnemy(master);
            }

            return m.Karma < 0;
        }</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Ridgeback.cs

<pre>this.SetSkill(SkillName.MagicResist, 25.3, 40.0);
            this.SetSkill(SkillName.Tactics, 29.3, 44.0);
            this.SetSkill(SkillName.Wrestling, 35.1, 45.0);

            this.Fame = 300;
            this.Karma = 0;

            this.Tamable = true;
            this.ControlSlots = 1;
            this.MinTameSkill = 83.1;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SavageRidgeback.cs

<pre>this.SetSkill(SkillName.MagicResist, 25.3, 40.0);
            this.SetSkill(SkillName.Tactics, 29.3, 44.0);
            this.SetSkill(SkillName.Wrestling, 35.1, 45.0);

            this.Fame = 300;
            this.Karma = 0;

            this.Tamable = true;
            this.ControlSlots = 1;
            this.MinTameSkill = 83.1;</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Boats\Plank.cs

<pre>map.CanFit( x, y, z, 16, false, false ) && !Server.Spells.SpellHelper.CheckMulti( new Point3D( x, y, z ), map ) && !Region.Find( new Point3D( x, y, z ), map ).IsPartOf( typeof( Factions.StrongholdRegion ) )</pre>

Fragment 2 in file Scripts\Multis\Boats\Plank.cs

<pre>map.CanFit( x, y, z, 16, false, false ) && !Server.Spells.SpellHelper.CheckMulti( new Point3D( x, y, z ), map ) && !Region.Find( new Point3D( x, y, z ), map ).IsPartOf( typeof( Factions.StrongholdRegion ) )</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Mobiles\Guards\GuardAI.cs

<pre>if (m != comb && m.Combatant == m_Mobile && m_Mobile.InRange(m, 12) && CanDispel(m))
					{
						double prio = m_Mobile.GetDistanceToSqrt(m);

						if (active == null || prio < activePrio)
						{
							active = m;
							activePrio = prio;

							if (activePrio <= 2)
							{
								return active;
							}
						}
					}</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\GuardAI.cs

<pre>if (m != comb && m.Combatant == m_Mobile && m_Mobile.InRange(m, 12) && CanDispel(m))
					{
						double prio = m_Mobile.GetDistanceToSqrt(m);

						if (active == null || prio < activePrio)
						{
							active = m;
							activePrio = prio;

							if (activePrio <= 2)
							{
								return active;
							}
						}
					}</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Quests\Items\QuestItem.cs

<pre>if (ret && !this.Accepted && this.Parent != from.Backpack)
            {
                if (from.IsStaff())
                {
                    return true;
                }
                else if (!(from is PlayerMobile) || this.CanDrop((PlayerMobile)from))
                {
                    return true;
                }
                else
                {
                    from.SendLocalizedMessage(1049343); // You can only drop quest items into the top-most level of your backpack while you still need them for your quest.
                    return false;
                }
            }
            else
            {
                return ret;
            }</pre>

Fragment 2 in file Scripts\Services\Quests\Items\QuestItem.cs

<pre>if (ret && !this.Accepted && this.Parent != from.Backpack)
            {
                if (from.IsStaff())
                {
                    return true;
                }
                else if (!(from is PlayerMobile) || this.CanDrop((PlayerMobile)from))
                {
                    return true;
                }
                else
                {
                    from.SendLocalizedMessage(1049343); // You can only drop quest items into the top-most level of your backpack while you still need them for your quest.
                    return false;
                }
            }
            else
            {
                return ret;
            }</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketWriter.cs

<pre>{
			m_Buffer[0] = (byte)(value >> 24);
			m_Buffer[1] = (byte)(value >> 16);
			m_Buffer[2] = (byte)(value >> 8);
			m_Buffer[3] = (byte)value;

			m_Stream.Write(m_Buffer, 0, 4);
		}</pre>

Fragment 2 in file Server\Network\PacketWriter.cs

<pre>{
			m_Buffer[0] = (byte)(value >> 24);
			m_Buffer[1] = (byte)(value >> 16);
			m_Buffer[2] = (byte)(value >> 8);
			m_Buffer[3] = (byte)value;

			m_Stream.Write(m_Buffer, 0, 4);
		}</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>if (m_Mobile.Combatant is Mobile && !m_Mobile.Combatant.Deleted &&
                m_Mobile.Combatant.Alive && (!(m_Mobile.Combatant is Mobile) || !((Mobile)m_Mobile.Combatant).IsDeadBondedPet))
			{
				m_Mobile.Warmode = true;
				m_Mobile.Direction = m_Mobile.GetDirectionTo(m_Mobile.Combatant);
			}
			else
			{
				m_Mobile.Warmode = false;
			}</pre>

Fragment 2 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>if (m_Mobile.Combatant is Mobile && !m_Mobile.Combatant.Deleted && 
                            m_Mobile.Combatant.Alive && (!(m_Mobile.Combatant is Mobile) || !((Mobile)m_Mobile.Combatant).IsDeadBondedPet))
						{
							m_Mobile.Warmode = true;
							m_Mobile.Direction = m_Mobile.GetDirectionTo(m_Mobile.Combatant);
						}
						else
						{
							m_Mobile.Warmode = false;
						}</pre>

Fragment 3 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>if (m_Mobile.Combatant is Mobile && !m_Mobile.Combatant.Deleted &&
                        m_Mobile.Combatant.Alive && (!(m_Mobile.Combatant is Mobile) || !((Mobile)m_Mobile.Combatant).IsDeadBondedPet))
					{
						m_Mobile.Warmode = true;
						m_Mobile.Direction = m_Mobile.GetDirectionTo(m_Mobile.Combatant);
					}
					else
					{
						m_Mobile.Warmode = false;
					}</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>for (int i = 0; i < remaining.Count; ++i)
                        {
                            if (remaining[i] != advanced)
                                this.m_Undefeated.Remove(remaining[i]);
                        }

                        if (advanced != null)
                            sb.AppendFormat("In accordance with the rules, {0} {1} advanced.", advanced.NameList, advanced.Players.Count == 1 ? "is" : "are");

                        break;</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>for (int i = 0; i < remaining.Count; ++i)
                        {
                            if (remaining[i] != advanced)
                                this.m_Undefeated.Remove(remaining[i]);
                        }

                        if (advanced != null)
                            sb.AppendFormat("In accordance with the rules, {0} {1} advanced.", advanced.NameList, advanced.Players.Count == 1 ? "is" : "are");

                        break;</pre>

Fragment 3 in file Scripts\Services\ConPVP\Tournament.cs

<pre>for (int i = 0; i < remaining.Count; ++i)
                        {
                            if (remaining[i] != advanced)
                                this.m_Undefeated.Remove(remaining[i]);
                        }

                        if (advanced != null)
                            sb.AppendFormat("In accordance with the rules, {0} {1} advanced.", advanced.NameList, advanced.Players.Count == 1 ? "is" : "are");

                        break;</pre>

## Duplicated Code. Size: 130

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\FukiyaDarts.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_UsesRemaining = reader.ReadInt();

                        this.m_Poison = Poison.Deserialize(reader);
                        this.m_PoisonCharges = reader.ReadInt();

                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\Shuriken.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_UsesRemaining = reader.ReadInt();

                        this.m_Poison = Poison.Deserialize(reader);
                        this.m_PoisonCharges = reader.ReadInt();

                        break;
                    }
            }
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Clothing\LeatherNinjaBelt.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_UsesRemaining = reader.ReadInt();

                        this.m_Poison = Poison.Deserialize(reader);
                        this.m_PoisonCharges = reader.ReadInt();

                        break;
                    }
            }
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Weapons\Fukiya.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_UsesRemaining = reader.ReadInt();

                        this.m_Poison = Poison.Deserialize(reader);
                        this.m_PoisonCharges = reader.ReadInt();

                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 129

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\BleedAttack.cs

<pre>int damage = Utility.RandomMinMax(level, level * 2);

                if (!m.Player)
                    damage *= 2;

                m.PlaySound(0x133);
                AOS.Damage(m, from, damage, false, 0, 0, 0, 0, 0, 0, 100, false, false, false);</pre>

Fragment 2 in file Scripts\Abilities\SAPropEffects.cs

<pre>int damage = Utility.RandomMinMax(level, level * 2);

                if (!m.Player)
                    damage *= 2;

                m.PlaySound(0x133);
                AOS.Damage(m, from, damage, false, 0, 0, 0, 0, 0, 0, 100, false, false, false);</pre>

## Duplicated Code. Size: 129

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\BaseRunicTool.cs

<pre>break;
                    case 15:
                        ApplyAttribute(primary, min, max, AosAttribute.LowerManaCost, 1, 8);
                        break;
                    case 16:
                        ApplyAttribute(primary, min, max, AosAttribute.LowerRegCost, 1, 20);
                        break;
                    case 17:
                        ApplyAttribute(primary, min, max, AosAttribute.Luck, 1, 100);</pre>

Fragment 2 in file Scripts\Items\Tools\BaseRunicTool.cs

<pre>ApplyAttribute(primary, min, max, AosAttribute.LowerManaCost, 1, 8);
                        break;
                    case 15:
                        ApplyAttribute(primary, min, max, AosAttribute.LowerRegCost, 1, 20);
                        break;
                    case 16:
                        ApplyAttribute(primary, min, max, AosAttribute.Luck, 1, 100);
                        break;
                    case 17:</pre>

## Duplicated Code. Size: 129

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\HouseFoundation.cs

<pre>this.Write((byte)size);
                this.Write((byte)deflatedLength);
                this.Write((byte)(((size >> 4) & 0xF0) | ((deflatedLength >> 8) & 0xF)));
                this.Write(m_DeflatedBuffer, 0, deflatedLength);

                totalLength += 4 + deflatedLength;</pre>

Fragment 2 in file Scripts\Multis\HouseFoundation.cs

<pre>this.Write((byte)size);
                this.Write((byte)deflatedLength);
                this.Write((byte)(((size >> 4) & 0xF0) | ((deflatedLength >> 8) & 0xF)));
                this.Write(m_DeflatedBuffer, 0, deflatedLength);

                totalLength += 4 + deflatedLength;</pre>

## Duplicated Code. Size: 129

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Mobile\BrigandCannibal.cs

<pre>this.SetStr(68, 95);
            this.SetDex(81, 95);
            this.SetInt(110, 115);

            this.SetHits(2058, 2126);
            this.SetMana(552, 553);

            this.SetDamage(10, 23);

            this.SetDamageType(ResistanceType.Physical, 100);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Mobile\BrigandCannibalMage.cs

<pre>this.SetStr(68, 95);
            this.SetDex(81, 95);
            this.SetInt(110, 115);

            this.SetHits(2058, 2126);
            this.SetMana(552, 553);

            this.SetDamage(10, 23);

            this.SetDamageType(ResistanceType.Physical, 100);</pre>

## Duplicated Code. Size: 129

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new NamedInfoCol[] // armor
                    {
                        new NamedInfoCol(AosElementAttribute.Physical, ResistTable),
                        new NamedInfoCol(AosElementAttribute.Fire, ResistTable),
                        new NamedInfoCol(AosElementAttribute.Cold, ResistTable),
                        new NamedInfoCol(AosElementAttribute.Poison, ResistTable),
                        new NamedInfoCol(AosElementAttribute.Energy, ResistTable),
                        new NamedInfoCol("RandomEater", EaterTable),
                    }</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new NamedInfoCol[]
                    {
                        new NamedInfoCol(AosElementAttribute.Physical, ResistTable),
                        new NamedInfoCol(AosElementAttribute.Fire, ResistTable),
                        new NamedInfoCol(AosElementAttribute.Cold, ResistTable),
                        new NamedInfoCol(AosElementAttribute.Poison, ResistTable),
                        new NamedInfoCol(AosElementAttribute.Energy, ResistTable),
                        new NamedInfoCol("RandomEater", EaterTable),
                    }</pre>

## Duplicated Code. Size: 129

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write((byte)0);
			m_Stream.Write((short)item.Amount);
			m_Stream.Write((short)item.X);
			m_Stream.Write((short)item.Y);
			m_Stream.Write(m.Serial);
			m_Stream.Write((short)item.Hue);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write((short)item.Amount);
			m_Stream.Write((short)item.X);
			m_Stream.Write((short)item.Y);
			m_Stream.Write((byte)0); // Grid Location?
			m_Stream.Write(m.Serial);
			m_Stream.Write((short)item.Hue);</pre>

## Duplicated Code. Size: 129

### Duplicated Fragments:

Fragment 1 in file Ultima\Art.cs

<pre>int length, extra;
			bool patched;
			Stream stream = m_FileIndex.Seek(index, out length, out extra, out patched);
			if (stream == null)
			{
				return null;
			}
			var buffer = new byte[length];
			stream.Read(buffer, 0, length);
			stream.Close();
			return buffer;</pre>

Fragment 2 in file Ultima\Art.cs

<pre>int length, extra;
			bool patched;
			Stream stream = m_FileIndex.Seek(index, out length, out extra, out patched);
			if (stream == null)
			{
				return null;
			}
			var buffer = new byte[length];
			stream.Read(buffer, 0, length);
			stream.Close();
			return buffer;</pre>

## Duplicated Code. Size: 129

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>{
                        if(entry != null)
                        {
                            Mobile m = entry.Participant;

                            if(m == null) continue;

                            if(!m_gauntlet.CheckQualify(m))
                            {
                                complete = false;
                                break;
                            }

                            if(!entry.Accepted)
                            {
                                XmlPoints.SendText(m_gauntlet.Challenger, 100539, m.Name);  // "{0} has not accepted yet."
                                complete = false;
                                break;
                            }
                        }
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>{
                        if(entry != null)
                        {
                            Mobile m = entry.Participant;

                            if(m == null) continue;

                            if(!m_gauntlet.CheckQualify(m))
                            {
                                complete = false;
                                break;
                            }

                            if(!entry.Accepted)
                            {
                                XmlPoints.SendText(m_gauntlet.Challenger, 100539, m.Name);  // "{0} has not accepted yet."
                                complete = false;
                                break;
                            }
                        }
                    }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>{
                        if(entry != null)
                        {
                            Mobile m = entry.Participant;

                            if(m == null) continue;

                            if(!m_gauntlet.CheckQualify(m))
                            {
                                complete = false;
                                break;
                            }

                            if(!entry.Accepted)
                            {
                                XmlPoints.SendText(m_gauntlet.Challenger, 100539, m.Name);  // "{0} has not accepted yet."
                                complete = false;
                                break;
                            }
                        }
                    }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>{
                        if(entry != null)
                        {
                            Mobile m = entry.Participant;

                            if(m == null) continue;

                            if(!m_gauntlet.CheckQualify(m))
                            {
                                complete = false;
                                break;
                            }

                            if(!entry.Accepted)
                            {
                                XmlPoints.SendText(m_gauntlet.Challenger, 100539, m.Name);  // "{0} has not accepted yet."
                                complete = false;
                                break;
                            }
                        }
                    }</pre>

## Duplicated Code. Size: 129

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\CloakOfHumility\Mobiles\Jason.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = false;
            this.Race = Race.Human;
            this.Body = 0x190;

            this.Hue = Race.RandomSkinHue();
            this.HairItemID = Race.RandomHair(false);
            this.HairHue = Race.RandomHairHue();
        }</pre>

Fragment 2 in file Scripts\Quests\CloakOfHumility\Mobiles\Kevin.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = false;
            this.Race = Race.Human;
            this.Body = 0x190;

            this.Hue = Race.RandomSkinHue();
            this.HairItemID = Race.RandomHair(false);
            this.HairHue = Race.RandomHairHue();
        }</pre>

Fragment 3 in file Scripts\Quests\CloakOfHumility\Mobiles\Nelson.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = false;
            this.Race = Race.Human;
            this.Body = 0x190;

            this.Hue = Race.RandomSkinHue();
            this.HairItemID = Race.RandomHair(false);
            this.HairHue = Race.RandomHairHue();
        }</pre>

Fragment 4 in file Scripts\Quests\CloakOfHumility\Mobiles\Sean.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = false;
            this.Race = Race.Human;
            this.Body = 0x190;

            this.Hue = Race.RandomSkinHue();
            this.HairItemID = Race.RandomHair(false);
            this.HairHue = Race.RandomHairHue();
        }</pre>

Fragment 5 in file Scripts\Quests\CloakOfHumility\Mobiles\Walton.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = false;
            this.Race = Race.Human;
            this.Body = 0x190;

            this.Hue = Race.RandomSkinHue();
            this.HairItemID = Race.RandomHair(false);
            this.HairHue = Race.RandomHairHue();
        }</pre>

## Duplicated Code. Size: 128

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if ((prop = this.ArtifactRarity) > 0)
                list.Add(1061078, prop.ToString()); // artifact rarity ~1_val~

            if (m_TalismanProtection != null && !m_TalismanProtection.IsEmpty && m_TalismanProtection.Amount > 0)
                list.Add(1072387, "{0}\t{1}", m_TalismanProtection.Name != null ? m_TalismanProtection.Name.ToString() : "Unknown", m_TalismanProtection.Amount); // ~1_NAME~ Protection: +~2_val~%</pre>

Fragment 2 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>if ((prop = this.ArtifactRarity) > 0)
                list.Add(1061078, prop.ToString()); // artifact rarity ~1_val~

            if (m_TalismanProtection != null && !m_TalismanProtection.IsEmpty && m_TalismanProtection.Amount > 0)
                list.Add(1072387, "{0}\t{1}", m_TalismanProtection.Name != null ? m_TalismanProtection.Name.ToString() : "Unknown", m_TalismanProtection.Amount); // ~1_NAME~ Protection: +~2_val~%</pre>

## Duplicated Code. Size: 128

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\BaseRunicTool.cs

<pre>CraftResourceInfo resInfo = CraftResources.GetInfo(this.m_Resource);

            if (resInfo == null)
                return;

            CraftAttributeInfo attrs = resInfo.AttributeInfo;

            if (attrs == null)
                return;

            int attributeCount = Utility.RandomMinMax(attrs.RunicMinAttributes, attrs.RunicMaxAttributes);
            int min = attrs.RunicMinIntensity;
            int max = attrs.RunicMaxIntensity;</pre>

Fragment 2 in file Scripts\Items\Tools\BaseRunicTool.cs

<pre>CraftResourceInfo resInfo = CraftResources.GetInfo(this.m_Resource);

            if (resInfo == null)
                return;

            CraftAttributeInfo attrs = resInfo.AttributeInfo;

            if (attrs == null)
                return;

            int attributeCount = Utility.RandomMinMax(attrs.RunicMinAttributes, attrs.RunicMaxAttributes);
            int min = attrs.RunicMinIntensity;
            int max = attrs.RunicMaxIntensity;</pre>

## Duplicated Code. Size: 128

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\MasterJonath.cs

<pre>this.PackReg(7);
            this.PackReg(7);
            this.PackReg(8);

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Named\MasterTheophilus.cs

<pre>this.PackReg(7);
            this.PackReg(7);
            this.PackReg(8);

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 128

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Mobiles\Corgul\SoulboundPirateCaptain.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 45, 55);
            SetResistance(ResistanceType.Fire, 45, 55);
            SetResistance(ResistanceType.Cold, 45, 55);
            SetResistance(ResistanceType.Poison, 45, 55);
            SetResistance(ResistanceType.Energy, 45, 55);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\BaseShipCaptain.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 45, 55);
            SetResistance(ResistanceType.Fire, 45, 55);
            SetResistance(ResistanceType.Cold, 45, 55);
            SetResistance(ResistanceType.Poison, 45, 55);
            SetResistance(ResistanceType.Energy, 45, 55);</pre>

## Duplicated Code. Size: 128

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Mobiles\Corgul\SoulboundSpellSlinger.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 30, 40);
            SetResistance(ResistanceType.Fire, 30, 40);
            SetResistance(ResistanceType.Cold, 30, 40);
            SetResistance(ResistanceType.Poison, 30, 40);
            SetResistance(ResistanceType.Energy, 30, 40);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Mobiles\Corgul\SoulboundSwashbuckler.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 30, 40);
            SetResistance(ResistanceType.Fire, 30, 40);
            SetResistance(ResistanceType.Cold, 30, 40);
            SetResistance(ResistanceType.Poison, 30, 40);
            SetResistance(ResistanceType.Energy, 30, 40);</pre>

## Duplicated Code. Size: 128

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCatapult.cs

<pre>case 0:
						case 4:
							m_weapon.DisplayLaunch(0);
							break;
						case 1:
						case 3:
							m_weapon.DisplayLaunch(1);
							break;
						case 2:
							m_weapon.DisplayLaunch(2);
							// launch sounds
							Effects.PlaySound(m_weapon, m_weapon.Map, 0x4C9);
							Effects.PlaySound(m_weapon, m_weapon.Map, 0x2B2);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>case 0:
						case 4:
							m_weapon.DisplayLaunch(0);
							break;
						case 1:
						case 3:
							m_weapon.DisplayLaunch(1);
							break;
						case 2:
							m_weapon.DisplayLaunch(2);
							// launch sounds
							Effects.PlaySound(m_weapon, m_weapon.Map, 0x4C9);
							Effects.PlaySound(m_weapon, m_weapon.Map, 0x2B2);</pre>

## Duplicated Code. Size: 128

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketReader.cs

<pre>{
			StringBuilder sb = new StringBuilder();

			int c;

			while ((m_Index + 1) < m_Size && (c = (m_Data[m_Index++] | (m_Data[m_Index++] << 8))) != 0)
			{
				sb.Append((char)c);
			}

			return sb.ToString();
		}</pre>

Fragment 2 in file Server\Network\PacketReader.cs

<pre>{
			StringBuilder sb = new StringBuilder();

			int c;

			while ((m_Index + 1) < m_Size && (c = ((m_Data[m_Index++] << 8) | m_Data[m_Index++])) != 0)
			{
				sb.Append((char)c);
			}

			return sb.ToString();
		}</pre>

## Duplicated Code. Size: 128

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketReader.cs

<pre>if (isSafe)
			{
				return s;
			}

			StringBuilder sb = new StringBuilder(s.Length);

			for (int i = 0; i < s.Length; ++i)
			{
				if (IsSafeChar(s[i]))
				{
					sb.Append(s[i]);
				}
			}

			return sb.ToString();</pre>

Fragment 2 in file Server\Network\PacketReader.cs

<pre>if (isSafe)
			{
				return s;
			}

			StringBuilder sb = new StringBuilder(s.Length);

			for (int i = 0; i < s.Length; ++i)
			{
				if (IsSafeChar(s[i]))
				{
					sb.Append(s[i]);
				}
			}

			return sb.ToString();</pre>

## Duplicated Code. Size: 128

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\EtherealWarrior.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 80, 90);
            SetResistance(ResistanceType.Fire, 40, 50);
            SetResistance(ResistanceType.Cold, 40, 50);
            SetResistance(ResistanceType.Poison, 40, 50);
            SetResistance(ResistanceType.Energy, 40, 50);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Pixie.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 80, 90);
            SetResistance(ResistanceType.Fire, 40, 50);
            SetResistance(ResistanceType.Cold, 40, 50);
            SetResistance(ResistanceType.Poison, 40, 50);
            SetResistance(ResistanceType.Energy, 40, 50);</pre>

Fragment 3 in file Scripts\Mobiles\Normal\RenegadeChangeling.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 80, 90 );
			SetResistance( ResistanceType.Fire, 40, 50 );
			SetResistance( ResistanceType.Cold, 40, 50 );
			SetResistance( ResistanceType.Poison, 40, 50 );
			SetResistance( ResistanceType.Energy, 40, 50 );</pre>

## Duplicated Code. Size: 128

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\HighPlainsBoura.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 50, 60);
            SetResistance(ResistanceType.Fire, 35, 40);
            SetResistance(ResistanceType.Cold, 10, 20);
            SetResistance(ResistanceType.Poison, 30, 40);
            SetResistance(ResistanceType.Energy, 30, 40);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\LowlandBoura.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 50, 60);
            SetResistance(ResistanceType.Fire, 35, 40);
            SetResistance(ResistanceType.Cold, 10, 20);
            SetResistance(ResistanceType.Poison, 30, 40);
            SetResistance(ResistanceType.Energy, 30, 40);</pre>

Fragment 3 in file Scripts\Mobiles\Normal\RuddyBoura.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 50, 60);
            SetResistance(ResistanceType.Fire, 35, 40);
            SetResistance(ResistanceType.Cold, 10, 20);
            SetResistance(ResistanceType.Poison, 30, 40);
            SetResistance(ResistanceType.Energy, 30, 40);</pre>

## Duplicated Code. Size: 127

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\TitlesMenu.cs

<pre>if ((int)title == 1154017 && CityLoyaltySystem.HasCustomTitle(User, out cust))
                        {
                            AddHtmlLocalized(275, 240, 245, 16, 1154017, cust, 0xFFFF, false, false);
                        } 
                        else
                            AddHtmlLocalized(275, 240, 160, 32, (int)title, 0xFFFF, false, false);</pre>

Fragment 2 in file Scripts\Gumps\TitlesMenu.cs

<pre>if (title == 1154017 && CityLoyaltySystem.HasCustomTitle(User, out cust))
                    {
                        AddHtmlLocalized(275, 240, 245, 16, 1154017, cust, 0xFFFF, false, false);
                    }
                    else
                        AddHtmlLocalized(275, 240, 160, 32, (int)title, 0xFFFF, false, false);</pre>

## Duplicated Code. Size: 127

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>public override bool CheckPropertyConfliction(Mobile m)
        {
            if (base.CheckPropertyConfliction(m))
                return true;

            if (this.Layer == Layer.Pants)
                return (m.FindItemOnLayer(Layer.InnerLegs) != null);

            if (this.Layer == Layer.Shirt)
                return (m.FindItemOnLayer(Layer.InnerTorso) != null);

            return false;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>public override bool CheckPropertyConfliction(Mobile m)
        {
            if (base.CheckPropertyConfliction(m))
                return true;

            if (this.Layer == Layer.Pants)
                return (m.FindItemOnLayer(Layer.InnerLegs) != null);

            if (this.Layer == Layer.Shirt)
                return (m.FindItemOnLayer(Layer.InnerTorso) != null);

            return false;
        }</pre>

## Duplicated Code. Size: 127

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if (this.DisplayLootType)
            {
                if (this.LootType == LootType.Blessed)
                    attrs.Add(new EquipInfoAttribute(1038021)); // blessed
                else if (this.LootType == LootType.Cursed)
                    attrs.Add(new EquipInfoAttribute(1049643)); // cursed
            }

            #region Factions
            if (this.m_FactionState != null)
                attrs.Add(new EquipInfoAttribute(1041350)); // faction item</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if (this.DisplayLootType)
            {
                if (this.LootType == LootType.Blessed)
                    attrs.Add(new EquipInfoAttribute(1038021)); // blessed
                else if (this.LootType == LootType.Cursed)
                    attrs.Add(new EquipInfoAttribute(1049643)); // cursed
            }

            #region Factions
            if (this.m_FactionState != null)
                attrs.Add(new EquipInfoAttribute(1041350)); // faction item</pre>

## Duplicated Code. Size: 127

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Instruments\BaseInstrument.cs

<pre>BaseCreature bc = targ as BaseCreature;

            if (IsMageryCreature(bc))
                val += 100;

            if (IsFireBreathingCreature(bc))
                val += 100;

            if (IsPoisonImmune(bc))
                val += 100;

            if (targ is VampireBat || targ is VampireBatFamiliar)
                val += 100;

            val += GetPoisonLevel(bc) * 20;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlLevelItem\LevelItemManager.cs

<pre>BaseCreature bc = targ as BaseCreature;

			if ( IsMageryCreature( bc ) )
				val += 100;

			if ( IsFireBreathingCreature( bc ) )
				val += 100;

			if ( IsPoisonImmune( bc ) )
				val += 100;

			if ( targ is VampireBat || targ is VampireBatFamiliar )
				val += 100;

			val += GetPoisonLevel( bc ) * 20;</pre>

## Duplicated Code. Size: 127

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\PaladinAI.cs

<pre>if ( m != comb && m.Combatant == m_Mobile && m_Mobile.InRange( m, 12 ) && CanDispel( m ) )
				{
					double prio = m_Mobile.GetDistanceToSqrt( m );

					if ( active == null || prio < activePrio )
					{
						active = m;
						activePrio = prio;

						if ( activePrio <= 2 )
							return active;
					}
				}</pre>

Fragment 2 in file Scripts\Mobiles\AI\PaladinAI.cs

<pre>if ( m != comb && m.Combatant == m_Mobile && m_Mobile.InRange( m, 12 ) && CanDispel( m ) )
				{
					double prio = m_Mobile.GetDistanceToSqrt( m );

					if ( active == null || prio < activePrio )
					{
						active = m;
						activePrio = prio;

						if ( activePrio <= 2 )
							return active;
					}
				}</pre>

## Duplicated Code. Size: 127

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\HighPlainsBoura.cs

<pre>public static void GiveVArtifactTo(Mobile m)
        {
            var item = (Item) Activator.CreateInstance(VArtifacts[Utility.Random(VArtifacts.Length)]);
			m.PlaySound(0x5B4);

            if (m.AddToBackpack(item))
                m.SendLocalizedMessage(1062317);
                    // For your valor in combating the fallen beast, a special artifact has been bestowed on you.
            else
                m.SendMessage("As your backpack is full, your reward has been placed at your feet.");
            {
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\StoneSlith.cs

<pre>public static void GiveVArtifactTo(Mobile m)
        {
            var item = (Item) Activator.CreateInstance(VArtifacts[Utility.Random(VArtifacts.Length)]);
			m.PlaySound(0x5B4);

            if (m.AddToBackpack(item))
                m.SendLocalizedMessage(1062317);
                    // For your valor in combating the fallen beast, a special artifact has been bestowed on you.
            else
                m.SendMessage("As your backpack is full, your reward has been placed at your feet.");
            {
            }
        }</pre>

## Duplicated Code. Size: 127

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Reports\Rendering\HtmlRenderer.cs

<pre>html.RenderEndTag();

            html.AddAttribute("rel", "stylesheet");
            html.AddAttribute(HtmlAttr.Type, "text/css");
            html.AddAttribute(HtmlAttr.Href, "styles.css");
            html.RenderBeginTag(HtmlTag.Link);
            html.RenderEndTag();

            html.RenderEndTag();

            html.RenderBeginTag(HtmlTag.Body);</pre>

Fragment 2 in file Scripts\Services\Reports\Rendering\HtmlRenderer.cs

<pre>html.RenderEndTag();

            html.AddAttribute("rel", "stylesheet");
            html.AddAttribute(HtmlAttr.Type, "text/css");
            html.AddAttribute(HtmlAttr.Href, "styles.css");
            html.RenderBeginTag(HtmlTag.Link);
            html.RenderEndTag();

            html.RenderEndTag();

            html.RenderBeginTag(HtmlTag.Body);</pre>

## Duplicated Code. Size: 127

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestLeaders.cs

<pre>xloc += 177;
						AddLabel( xloc, y, 0, guildname );
#if(FACTIONS)
						xloc += 35;
						AddLabelCropped( xloc, y, 60, 21, 0, factionname );
						xloc += 15;
#endif
						xloc += 50;
						AddLabel( xloc, y, 0, a.Points.ToString() );
						xloc += 50;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>xloc += 177;
						AddLabel( xloc, y, 0, guildname );
#if(FACTIONS)
						xloc += 35;
						AddLabelCropped( xloc, y, 60, 21, 0, factionname );
						xloc += 15;
#endif
						xloc += 50;
						AddLabel( xloc, y, 0, a.Points.ToString() );
						xloc += 50;</pre>

## Duplicated Code. Size: 127

### Duplicated Fragments:

Fragment 1 in file Server\Persistence\DynamicSaveStrategy.cs

<pre>private void SaveTypeDatabase(string path, List<Type> types)
        {
            BinaryFileWriter bfw = new BinaryFileWriter(path, false);

            bfw.Write(types.Count);

            foreach (Type type in types)
            {
                bfw.Write(type.FullName);
            }

            bfw.Flush();

            bfw.Close();
        }</pre>

Fragment 2 in file Server\Persistence\ParallelSaveStrategy.cs

<pre>private void SaveTypeDatabase(string path, List<Type> types)
        {
            BinaryFileWriter bfw = new BinaryFileWriter(path, false);

            bfw.Write(types.Count);

            foreach (Type type in types)
            {
                bfw.Write(type.FullName);
            }

            bfw.Flush();

            bfw.Close();
        }</pre>

## Duplicated Code. Size: 127

### Duplicated Fragments:

Fragment 1 in file Ultima\AnimationEdit.cs

<pre>var bmp = new Bitmap(width, height, PixelFormat.Format16bppArgb1555);
				BitmapData bd = bmp.LockBits(
					new Rectangle(0, 0, width, height), ImageLockMode.WriteOnly, PixelFormat.Format16bppArgb1555);
				var line = (ushort*)bd.Scan0;
				int delta = bd.Stride >> 1;</pre>

Fragment 2 in file Ultima\Animations.cs

<pre>var bmp = new Bitmap(width, height, PixelFormat.Format16bppArgb1555);
			BitmapData bd = bmp.LockBits(
				new Rectangle(0, 0, width, height), ImageLockMode.WriteOnly, PixelFormat.Format16bppArgb1555);
			var line = (ushort*)bd.Scan0;
			int delta = bd.Stride >> 1;</pre>

## Duplicated Code. Size: 127

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Harrower\Harrower.cs

<pre>public virtual void RegisterDamageTo(Mobile m)
        {
            if (m == null)
                return;

            foreach (DamageEntry de in m.DamageEntries)
            {
                Mobile damager = de.Damager;

                Mobile master = damager.GetDamageMaster(m);

                if (master != null)
                    damager = master;

                this.RegisterDamage(damager, de.DamageGiven);
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseRenowned.cs

<pre>public virtual void RegisterDamageTo(Mobile m)
        {
            if (m == null)
                return;

            foreach (DamageEntry de in m.DamageEntries)
            {
                Mobile damager = de.Damager;

                Mobile master = damager.GetDamageMaster(m);

                if (master != null)
                    damager = master;

                this.RegisterDamage(damager, de.DamageGiven);
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\BaseSABosses.cs

<pre>public virtual void RegisterDamageTo(Mobile m)
        {
            if (m == null)
                return;

            foreach (DamageEntry de in m.DamageEntries)
            {
                Mobile damager = de.Damager;

                Mobile master = damager.GetDamageMaster(m);

                if (master != null)
                    damager = master;

                this.RegisterDamage(damager, de.DamageGiven);
            }
        }</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Navery\Navrey.cs

<pre>public static void DistributeArtifact(Mobile to, Item artifact)
        {
            if (to == null || artifact == null)
                return;

            Container pack = to.Backpack;

            if (pack == null || !pack.TryDropItem(to, artifact, false))
                to.BankBox.DropItem(artifact);

            to.SendLocalizedMessage(502088); // A special gift has been placed in your backpack.
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ClockworkExodus.cs

<pre>public static void DistributeArtifact(Mobile to, Item artifact)
        {
            if (to == null || artifact == null)
                return;

            Container pack = to.Backpack;

            if (pack == null || !pack.TryDropItem(to, artifact, false))
                to.BankBox.DropItem(artifact);

            to.SendLocalizedMessage(502088); // A special gift has been placed in your backpack.
		}</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>if (EvilOmenSpell.TryEndEffect(this))
            {
                poison = PoisonImpl.IncreaseLevel(poison);
            }

            ApplyPoisonResult result = base.ApplyPoison(from, poison);

            if (from != null && result == ApplyPoisonResult.Poisoned && PoisonTimer is PoisonImpl.PoisonTimer)
            {
                (PoisonTimer as PoisonImpl.PoisonTimer).From = from;
            }

            return result;</pre>

Fragment 2 in file Scripts\Mobiles\PlayerMobile.cs

<pre>if (EvilOmenSpell.TryEndEffect(this))
			{
				poison = PoisonImpl.IncreaseLevel(poison);
			}

			ApplyPoisonResult result = base.ApplyPoison(from, poison);

			if (from != null && result == ApplyPoisonResult.Poisoned && PoisonTimer is PoisonImpl.PoisonTimer)
			{
				(PoisonTimer as PoisonImpl.PoisonTimer).From = from;
			}

			return result;</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Gorrow.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Backpack());
            this.AddItem(new Shoes(0x1BB));
            this.AddItem(new LongPants(0x901));
            this.AddItem(new Tunic(0x70A));
            this.AddItem(new Cloak(0x675));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Neville.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Backpack());
            this.AddItem(new Shoes(0x1BB));
            this.AddItem(new LongPants(0x901));
            this.AddItem(new Tunic(0x70A));
            this.AddItem(new Cloak(0x675));
        }</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Questers.cs

<pre>SetWearable(new ChainLegs(), 2576);
            SetWearable(new DragonChest(), 2576);
            SetWearable(new DragonArms(), 2576);
            SetWearable(new MetalShield(), 2576);
            SetWearable(new Circlet(), 2576);
            SetWearable(new JinBaori(), 2592);</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>SetWearable(new ChainLegs(), 2576);
                    SetWearable(new DragonChest(), 2576);
                    SetWearable(new DragonArms(), 2576);
                    SetWearable(new MetalShield(), 2576);
                    SetWearable(new Circlet(), 2576);
                    SetWearable(new JinBaori(), 2592);</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Questers.cs

<pre>SetWearable(new BoneChest(), 2407);
            SetWearable(new LeatherNinjaPants(), 2407);
            SetWearable(new StuddedHiroSode(), 2407);
            SetWearable(new BoneGloves(), 2407);
            SetWearable(new StuddedGorget(), 2407);
            SetWearable(new Boots(), 2407);</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>SetWearable(new BoneChest(), 2407);
                    SetWearable(new LeatherNinjaPants(), 2407);
                    SetWearable(new StuddedHiroSode(), 2407);
                    SetWearable(new BoneGloves(), 2407);
                    SetWearable(new StuddedGorget(), 2407);
                    SetWearable(new Boots(), 2407);</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CleanUpBritannia\Items\Steward.cs

<pre>if (state is Mobile && from is Steward && ((Mobile) state) == ((Steward) from).Owner)
            {
                ((Steward) from).InvalidateProperties();
                ((Mobile) state).SendGump(new StewardGump(((Mobile) state), ((Steward) from)));
            }</pre>

Fragment 2 in file Scripts\Services\CleanUpBritannia\Items\Steward.cs

<pre>if (state is Mobile && from is Steward && ((Mobile) state) == ((Steward) from).Owner)
            {
                ((Steward) from).InvalidateProperties();
                ((Mobile) state).SendGump(new StewardGump(((Mobile) state), ((Steward) from)));
            }</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\BaseCollectionItem.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public long PreviousTier
        {
            get
            {
                if (this.m_Tier > 2)
                {
                    long tier = this.m_StartTier * 2;

                    for (int i = 0; i < this.m_Tier - 2; i ++)
                        tier += (i + 3) * this.m_NextTier;				

                    return tier; 
                }

                return this.m_StartTier * this.m_Tier;
            }
        }</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\BaseCollectionMobile.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public long PreviousTier
        {
            get
            {
                if (this.m_Tier > 2)
                {
                    long tier = this.m_StartTier * 2;

                    for (int i = 0; i < this.m_Tier - 2; i ++)
                        tier += (i + 3) * this.m_NextTier;				

                    return tier; 
                }

                return this.m_StartTier * this.m_Tier;
            }
        }</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>if (this.m_Page > 1)
            {
                this.AddButton(150, 335, 0x15E3, 0x15E7, (int)Buttons.Next, GumpButtonType.Page, this.m_Page - 1);
                this.AddHtmlLocalized(170, 335, 60, 20, 1074880, 0x1, false, false); // Previous			
            }

            this.m_Page += 1;</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>if (this.m_Page > 1)
            {
                this.AddButton(150, 335, 0x15E3, 0x15E7, (int)Buttons.Next, GumpButtonType.Page, this.m_Page - 1);
                this.AddHtmlLocalized(170, 335, 60, 20, 1074880, 0x1, false, false); // Previous			
            }

            this.m_Page += 1;</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Reports\Rendering\HtmlRenderer.cs

<pre>TimeZone tz = TimeZone.CurrentTimeZone;
            bool isDaylight = tz.IsDaylightSavingTime(this.m_TimeStamp);
            TimeSpan utcOffset = tz.GetUtcOffset(this.m_TimeStamp);

            html.Write("Snapshot taken at {0:d} {0:t}. All times are {1}.", this.m_TimeStamp, tz.StandardName);
            html.RenderEndTag();

            html.RenderEndTag();

            html.RenderEndTag();</pre>

Fragment 2 in file Scripts\Services\Reports\Rendering\HtmlRenderer.cs

<pre>TimeZone tz = TimeZone.CurrentTimeZone;
            bool isDaylight = tz.IsDaylightSavingTime(this.m_TimeStamp);
            TimeSpan utcOffset = tz.GetUtcOffset(this.m_TimeStamp);

            html.Write("Snapshot taken at {0:d} {0:t}. All times are {1}.", this.m_TimeStamp, tz.StandardName);
            html.RenderEndTag();

            html.RenderEndTag();

            html.RenderEndTag();</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ViceVsVirtue\ViceVsVirtueSystem.cs

<pre>if (((FeyLeggings)item).PhysicalBonus != 3)
                    ((FeyLeggings)item).PhysicalBonus = 3;

                if (((FeyLeggings)item).FireBonus != 3)
                    ((FeyLeggings)item).FireBonus = 3;

                if (((FeyLeggings)item).ColdBonus != 3)
                    ((FeyLeggings)item).ColdBonus = 3;</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\ViceVsVirtueSystem.cs

<pre>if (((RuneBeetleCarapace)item).PhysicalBonus != 3)
                    ((RuneBeetleCarapace)item).PhysicalBonus = 3;

                if (((RuneBeetleCarapace)item).FireBonus != 3)
                    ((RuneBeetleCarapace)item).FireBonus = 3;

                if (((RuneBeetleCarapace)item).ColdBonus != 3)
                    ((RuneBeetleCarapace)item).ColdBonus = 3;</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>private static List<string> LoadCreaturesName(XmlElement node)
		{
			List<string> names = new List<string>();

			if (node != null)
			{
				foreach (XmlElement ele in node.GetElementsByTagName("creaturename"))
				{
					if (ele != null)
						names.Add(ele.InnerText);
				}
			}
			return names;
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Support\SpawnerExporter.cs

<pre>private static List<string> LoadCreaturesName(XmlElement node)
		{
			List<string> names = new List<string>();

			if ( node != null )
			{
				foreach ( XmlElement ele in node.GetElementsByTagName( "creaturename" ) )
				{
					if ( ele != null )
						names.Add( ele.InnerText );
				}
			}

			return names;
		}</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>if (criteria.Dosearchrange && TestRange(i, criteria.Searchrange, criteria.Currentmap, criteria.Currentloc))
						{
							hasrange = true;
						}
						if (criteria.Dosearchrange && !hasrange) continue;

						// check for region
						if (criteria.Dosearchregion && TestRegion(i, criteria.Searchregion))
						{
							hasregion = true;
						}
						if (criteria.Dosearchregion && !hasregion) continue;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>if (criteria.Dosearchrange && TestRange(i, criteria.Searchrange, criteria.Currentmap, criteria.Currentloc))
						{
							hasrange = true;
						}
						if (criteria.Dosearchrange && !hasrange) continue;

						// check for region
						if (criteria.Dosearchregion && TestRegion(i, criteria.Searchregion))
						{
							hasregion = true;
						}
						if (criteria.Dosearchregion && !hasregion) continue;</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Server\Gumps\GumpCheck.cs

<pre>public override void AppendTo( IGumpWriter disp )
		{
			disp.AppendLayout( m_LayoutName );
			disp.AppendLayout( m_X );
			disp.AppendLayout( m_Y );
			disp.AppendLayout( m_ID1 );
			disp.AppendLayout( m_ID2 );
			disp.AppendLayout( m_InitialState );
			disp.AppendLayout( m_SwitchID );

			disp.Switches++;
		}</pre>

Fragment 2 in file Server\Gumps\GumpRadio.cs

<pre>public override void AppendTo( IGumpWriter disp )
		{
			disp.AppendLayout( m_LayoutName );
			disp.AppendLayout( m_X );
			disp.AppendLayout( m_Y );
			disp.AppendLayout( m_ID1 );
			disp.AppendLayout( m_ID2 );
			disp.AppendLayout( m_InitialState );
			disp.AppendLayout( m_SwitchID );

			disp.Switches++;
		}</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BoneDemon.cs

<pre>this.SetResistance(ResistanceType.Physical, 75);
            this.SetResistance(ResistanceType.Fire, 60);
            this.SetResistance(ResistanceType.Cold, 90);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 60);

            this.SetSkill(SkillName.DetectHidden, 80.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DarknightCreeper.cs

<pre>this.SetResistance(ResistanceType.Physical, 60);
            this.SetResistance(ResistanceType.Fire, 60);
            this.SetResistance(ResistanceType.Cold, 100);
            this.SetResistance(ResistanceType.Poison, 90);
            this.SetResistance(ResistanceType.Energy, 75);

            this.SetSkill(SkillName.DetectHidden, 80.0);</pre>

Fragment 3 in file Scripts\Mobiles\Normal\Impaler.cs

<pre>this.SetResistance(ResistanceType.Physical, 90);
            this.SetResistance(ResistanceType.Fire, 60);
            this.SetResistance(ResistanceType.Cold, 75);
            this.SetResistance(ResistanceType.Poison, 60);
            this.SetResistance(ResistanceType.Energy, 100);

            this.SetSkill(SkillName.DetectHidden, 80.0);</pre>

## Duplicated Code. Size: 126

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\BaseVendor.cs

<pre>public virtual int GetRandomHue()
		{
			switch (Utility.Random(5))
			{
				default:
				case 0:
					return Utility.RandomBlueHue();
				case 1:
					return Utility.RandomGreenHue();
				case 2:
					return Utility.RandomRedHue();
				case 3:
					return Utility.RandomYellowHue();
				case 4:
					return Utility.RandomNeutralHue();
			}
		}</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GalleonPilot.cs

<pre>public virtual int GetRandomHue()
        {
            switch (Utility.Random(5))
            {
                default:
                case 0: return Utility.RandomBlueHue();
                case 1: return Utility.RandomGreenHue();
                case 2: return Utility.RandomRedHue();
                case 3: return Utility.RandomYellowHue();
                case 4: return Utility.RandomNeutralHue();
            }
        }</pre>

Fragment 3 in file Scripts\Services\New Magincia\Magincia Bazaar\Mobiles\BaseBizaarBroker.cs

<pre>public virtual int GetRandomHue()
		{
			switch ( Utility.Random( 5 ) )
			{
				default:
				case 0: return Utility.RandomBlueHue();
				case 1: return Utility.RandomGreenHue();
				case 2: return Utility.RandomRedHue();
				case 3: return Utility.RandomYellowHue();
				case 4: return Utility.RandomNeutralHue();
			}
		}</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>this.AddHtmlLocalized(195, 292, 160, 18, 1015327, 0x421F, false, false); // Male

                    this.AddButton(160, 310, 0xFA5, 0xFA7, 1, GumpButtonType.Reply, 0);
                    this.AddHtmlLocalized(195, 312, 160, 18, 1015328, 0x7FFF, false, false); // Female</pre>

Fragment 2 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>this.AddHtmlLocalized(195, 292, 160, 18, 1015327, 0x421F, false, false); // Male

                    this.AddButton(160, 310, 0xFA5, 0xFA7, 1, GumpButtonType.Reply, 0);
                    this.AddHtmlLocalized(195, 312, 160, 18, 1015328, 0x7FFF, false, false); // Female</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\StandardOfChaos.cs

<pre>this.Name = ("Standard Of Chaos");

            this.Hue = 2209;

            this.WeaponAttributes.HitHarm = 30;	
            this.WeaponAttributes.HitFireball = 20;	
            this.WeaponAttributes.HitLightning = 10;
            this.WeaponAttributes.HitLowerDefend = 40;
            this.Attributes.WeaponSpeed = 30;
            this.Attributes.WeaponDamage = -40;
            this.Attributes.CastSpeed = 1;</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\StandardOfChaosG.cs

<pre>this.Name = ("Standard Of Chaos");

            this.Hue = 2209;

            this.WeaponAttributes.HitHarm = 30;	
            this.WeaponAttributes.HitFireball = 20;	
            this.WeaponAttributes.HitLightning = 10;
            this.WeaponAttributes.HitLowerDefend = 40;
            this.Attributes.WeaponSpeed = 30;
            this.Attributes.WeaponDamage = -40;
            this.Attributes.CastSpeed = 1;</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\Board.cs

<pre>public override void GetProperties( ObjectPropertyList list )
		{
			base.GetProperties( list );

			if ( !CraftResources.IsStandard( m_Resource ) )
			{
				int num = CraftResources.GetLocalizationNumber( m_Resource );

				if ( num > 0 )
					list.Add( num );
				else
					list.Add( CraftResources.GetName( m_Resource ) );
			}
		}</pre>

Fragment 2 in file Scripts\Items\Resource\Log.cs

<pre>public override void GetProperties( ObjectPropertyList list )
		{
			base.GetProperties( list );

			if ( !CraftResources.IsStandard( m_Resource ) )
			{
				int num = CraftResources.GetLocalizationNumber( m_Resource );

				if ( num > 0 )
					list.Add( num );
				else
					list.Add( CraftResources.GetName( m_Resource ) );
			}
		}</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>bool flee = false;

                    if (this.m_Mobile.Hits < c.Hits)
                    {
                        // We are more hurt than them
                        int diff = c.Hits - this.m_Mobile.Hits;

                        flee = (Utility.Random(0, 100) > (10 + diff)); // (10 + diff)% chance to flee
                    }
                    else
                    {
                        flee = Utility.Random(0, 100) > 10; // 10% chance to flee
                    }</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>bool flee = false;

                    if (this.m_Mobile.Hits < c.Hits)
                    {
                        // We are more hurt than them
                        int diff = c.Hits - this.m_Mobile.Hits;

                        flee = (Utility.Random(0, 100) > (10 + diff)); // (10 + diff)% chance to flee
                    }
                    else
                    {
                        flee = Utility.Random(0, 100) > 10; // 10% chance to flee
                    }</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\FireDaemonRenowned.cs

<pre>this.SetSkill(SkillName.Tactics, 86.9, 95.5);
            this.SetSkill(SkillName.Wrestling, 42.2, 98.8);
            this.SetSkill(SkillName.Magery, 97.1, 100.8);
            this.SetSkill(SkillName.EvalInt, 91.1, 91.8);
            this.SetSkill(SkillName.Meditation, 45.4, 94.1);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\FireDaemon.cs

<pre>this.SetSkill(SkillName.Tactics, 86.9, 95.5);
            this.SetSkill(SkillName.Wrestling, 42.2, 98.8);
            this.SetSkill(SkillName.Magery, 97.1, 100.8);
            this.SetSkill(SkillName.EvalInt, 91.1, 91.8);
            this.SetSkill(SkillName.Meditation, 45.4, 94.1);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\AirElemental.cs

<pre>this.SetSkill(SkillName.EvalInt, 60.1, 75.0);
            this.SetSkill(SkillName.Magery, 60.1, 75.0);
            this.SetSkill(SkillName.MagicResist, 60.1, 75.0);
            this.SetSkill(SkillName.Tactics, 60.1, 80.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 80.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Efreet.cs

<pre>this.SetSkill(SkillName.EvalInt, 60.1, 75.0);
            this.SetSkill(SkillName.Magery, 60.1, 75.0);
            this.SetSkill(SkillName.MagicResist, 60.1, 75.0);
            this.SetSkill(SkillName.Tactics, 60.1, 80.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 80.0);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BlackSolenQueen.cs

<pre>public void Carve(Mobile from, Item item)
        {
            Effects.PlaySound(GetWorldLocation(), Map, 0x027);
            Effects.SendLocationEffect(GetWorldLocation(), Map, 0x3728, 10, 10, 0, 0);

            from.SendMessage("You destroy the egg sac.");
            Delete();
            m_Timer.Stop();
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RedSolenQueen.cs

<pre>public void Carve(Mobile from, Item item)
        {
            Effects.PlaySound(GetWorldLocation(), Map, 0x027);
            Effects.SendLocationEffect(GetWorldLocation(), Map, 0x3728, 10, 10, 0, 0);

            from.SendMessage("You destroy the egg sac.");
            Delete();
            m_Timer.Stop();
        }</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Dolphin.cs

<pre>this.SetResistance(ResistanceType.Poison, 10, 15);
            this.SetResistance(ResistanceType.Energy, 10, 15);

            this.SetSkill(SkillName.MagicResist, 15.1, 20.0);
            this.SetSkill(SkillName.Tactics, 19.2, 29.0);
            this.SetSkill(SkillName.Wrestling, 19.2, 29.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\PackLlama.cs

<pre>this.SetResistance(ResistanceType.Poison, 10, 15);
            this.SetResistance(ResistanceType.Energy, 10, 15);

            this.SetSkill(SkillName.MagicResist, 15.1, 20.0);
            this.SetSkill(SkillName.Tactics, 19.2, 29.0);
            this.SetSkill(SkillName.Wrestling, 19.2, 29.0);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GolemController.cs

<pre>this.SetResistance(ResistanceType.Physical, 30, 40);
            this.SetResistance(ResistanceType.Fire, 25, 35);
            this.SetResistance(ResistanceType.Cold, 35, 45);
            this.SetResistance(ResistanceType.Poison, 5, 15);
            this.SetResistance(ResistanceType.Energy, 15, 25);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GoreFiend.cs

<pre>this.SetResistance(ResistanceType.Physical, 35, 45);
            this.SetResistance(ResistanceType.Fire, 25, 35);
            this.SetResistance(ResistanceType.Cold, 15, 25);
            this.SetResistance(ResistanceType.Poison, 5, 15);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\HordeMinion.cs

<pre>this.SetInt(11, 25);

            this.SetHits(10, 24);

            this.SetDamage(5, 10);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 20);
            this.SetResistance(ResistanceType.Fire, 5, 10);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ShadowWisp.cs

<pre>this.SetInt(11, 25);

            this.SetHits(10, 24);

            this.SetDamage(5, 10);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 20);
            this.SetResistance(ResistanceType.Fire, 5, 10);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\MountainGoat.cs

<pre>this.SetResistance(ResistanceType.Poison, 10, 15);
            this.SetResistance(ResistanceType.Energy, 10, 15);

            this.SetSkill(SkillName.MagicResist, 25.1, 30.0);
            this.SetSkill(SkillName.Tactics, 29.3, 44.0);
            this.SetSkill(SkillName.Wrestling, 29.3, 44.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\PackHorse.cs

<pre>this.SetResistance(ResistanceType.Poison, 10, 15);
            this.SetResistance(ResistanceType.Energy, 10, 15);

            this.SetSkill(SkillName.MagicResist, 25.1, 30.0);
            this.SetSkill(SkillName.Tactics, 29.3, 44.0);
            this.SetSkill(SkillName.Wrestling, 29.3, 44.0);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\RevenantLion.cs

<pre>this.SetResistance(ResistanceType.Physical, 40, 60);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 55, 65);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ShadowDweller.cs

<pre>this.SetResistance(ResistanceType.Physical, 40, 60);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 55, 65);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\RidableLlama.cs

<pre>this.SetResistance(ResistanceType.Poison, 5, 10);
            this.SetResistance(ResistanceType.Energy, 5, 10);

            this.SetSkill(SkillName.MagicResist, 15.1, 20.0);
            this.SetSkill(SkillName.Tactics, 19.2, 29.0);
            this.SetSkill(SkillName.Wrestling, 19.2, 29.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Walrus.cs

<pre>this.SetResistance(ResistanceType.Poison, 5, 10);
            this.SetResistance(ResistanceType.Energy, 5, 10);

            this.SetSkill(SkillName.MagicResist, 15.1, 20.0);
            this.SetSkill(SkillName.Tactics, 19.2, 29.0);
            this.SetSkill(SkillName.Wrestling, 19.2, 29.0);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Hamato.cs

<pre>this.SetSkill(SkillName.Anatomy, 120.0, 120.0);
            this.SetSkill(SkillName.Parry, 120.0, 120.0);
            this.SetSkill(SkillName.Healing, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Swords, 120.0, 120.0);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\TylAriadne.cs

<pre>this.SetSkill(SkillName.Anatomy, 120.0, 120.0);
            this.SetSkill(SkillName.Parry, 120.0, 120.0);
            this.SetSkill(SkillName.Healing, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Swords, 120.0, 120.0);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Neil.cs

<pre>this.SetSkill(SkillName.Blacksmith, 65.0, 88.0);
            this.SetSkill(SkillName.Fencing, 45.0, 68.0);
            this.SetSkill(SkillName.Macing, 45.0, 68.0);
            this.SetSkill(SkillName.Swords, 45.0, 68.0);
            this.SetSkill(SkillName.Tactics, 36.0, 68.0);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Weaponsmith.cs

<pre>this.SetSkill(SkillName.Blacksmith, 65.0, 88.0);
            this.SetSkill(SkillName.Fencing, 45.0, 68.0);
            this.SetSkill(SkillName.Macing, 45.0, 68.0);
            this.SetSkill(SkillName.Swords, 45.0, 68.0);
            this.SetSkill(SkillName.Tactics, 36.0, 68.0);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Summons\SummonedDaemon.cs

<pre>this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 50, 60);
            this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 70, 80);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

Fragment 2 in file Scripts\Mobiles\Summons\SummonedWaterElemental.cs

<pre>this.SetResistance(ResistanceType.Physical, 50, 60);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 70, 80);
            this.SetResistance(ResistanceType.Poison, 45, 55);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>int length = m_Creature.GetLeashLength();
                        IPoint3D p = m_Creature.Orb.Anchor as IPoint3D;

                        if (p == null)
                            p = m_Creature.ControlMaster;

                        Mobile combatant = m_Creature.Combatant != null ? m_Creature.Combatant as Mobile : m_Creature.ControlMaster.Combatant != null ? m_Creature.ControlMaster.Combatant as Mobile : null;</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>int length = m_Creature.GetLeashLength();
                        IPoint3D p = m_Creature.Orb.Anchor as IPoint3D;

                        if (p == null)
                            p = m_Creature.ControlMaster;

                        Mobile combatant = m_Creature.Combatant != null ? m_Creature.Combatant as Mobile : m_Creature.ControlMaster.Combatant != null ? m_Creature.ControlMaster.Combatant as Mobile : null;</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestLeaders.cs

<pre>count++;

						TimeSpan timeranked = DateTime.UtcNow - a.WhenRanked;

						int days = (int)timeranked.TotalDays;
						int hours = (int)(timeranked.TotalHours - days*24);
						int mins = (int)(timeranked.TotalMinutes - ((int)timeranked.TotalHours)*60);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>count++;

						TimeSpan timeranked = DateTime.UtcNow - a.WhenRanked;

						int days = (int)timeranked.TotalDays;
						int hours = (int)(timeranked.TotalHours - days*24);
						int mins = (int)(timeranked.TotalMinutes - ((int)timeranked.TotalHours)*60);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGauntlet.cs

<pre>case 0:
                m_Challenger = reader.ReadMobile();

                m_Organizers.Add(m_Challenger);

                m_GameLocked = reader.ReadBool();
                m_GameInProgress = reader.ReadBool();
                m_TotalPurse = reader.ReadInt();
                m_EntryFee = reader.ReadInt();
                m_ArenaSize = reader.ReadInt();
                m_TargetScore = reader.ReadInt();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGauntlet.cs

<pre>case 0:
                m_Challenger = reader.ReadMobile();

                m_Organizers.Add(m_Challenger);

                m_GameLocked = reader.ReadBool();
                m_GameInProgress = reader.ReadBool();
                m_TotalPurse = reader.ReadInt();
                m_EntryFee = reader.ReadInt();
                m_ArenaSize = reader.ReadInt();
                m_TargetScore = reader.ReadInt();</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Server\World.cs

<pre>BaseModule module = data as BaseModule;

					bool match = true;
					string name = module.Name.ToLower();

					for (int i = 0; i < keywords.Length; i++)
					{
						if (name.IndexOf(keywords[i]) == -1)
						{
							match = false;
						}
					}</pre>

Fragment 2 in file Server\World.cs

<pre>BaseModule module = data as BaseModule;

					bool match = true;
					string name = module.Name.ToLower();

					for (int i = 0; i < keywords.Length; i++)
					{
						if (name.IndexOf(keywords[i]) == -1)
						{
							match = false;
						}
					}</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\LysanderGathenwale.cs

<pre>this.SetResistance(ResistanceType.Physical, 35, 45);
            this.SetResistance(ResistanceType.Fire, 25, 30);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 25, 35);
            this.SetResistance(ResistanceType.Energy, 25, 35);</pre>

Fragment 2 in file Scripts\Mobiles\Named\MorgBergen.cs

<pre>this.SetResistance(ResistanceType.Physical, 35, 45);
            this.SetResistance(ResistanceType.Fire, 25, 30);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 25, 35);
            this.SetResistance(ResistanceType.Energy, 25, 35);</pre>

Fragment 3 in file Scripts\Mobiles\Normal\KhaldunZealot.cs

<pre>this.SetResistance(ResistanceType.Physical, 35, 45);
            this.SetResistance(ResistanceType.Fire, 25, 30);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 25, 35);
            this.SetResistance(ResistanceType.Energy, 25, 35);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Kraken.cs

<pre>this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 10, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\StoneGargoyle.cs

<pre>this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

Fragment 3 in file Scripts\Mobiles\Normal\StoneHarpy.cs

<pre>this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>this.AddSpellAttack(typeof(Spells.First.MagicArrowSpell));
            this.AddSpellAttack(typeof(Spells.First.WeakenSpell));
            this.AddSpellAttack(typeof(Spells.Third.FireballSpell));
            this.AddSpellDefense(typeof(Spells.Third.WallOfStoneSpell));
            this.AddSpellDefense(typeof(Spells.First.HealSpell));</pre>

Fragment 2 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>this.AddSpellAttack(typeof(Spells.First.MagicArrowSpell));
            this.AddSpellAttack(typeof(Spells.First.WeakenSpell));
            this.AddSpellAttack(typeof(Spells.Third.FireballSpell));
            this.AddSpellDefense(typeof(Spells.Third.WallOfStoneSpell));
            this.AddSpellDefense(typeof(Spells.First.HealSpell));</pre>

Fragment 3 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>this.AddSpellAttack(typeof(Spells.First.MagicArrowSpell));
            this.AddSpellAttack(typeof(Spells.First.WeakenSpell));
            this.AddSpellAttack(typeof(Spells.Third.FireballSpell));
            this.AddSpellDefense(typeof(Spells.Third.WallOfStoneSpell));
            this.AddSpellDefense(typeof(Spells.First.HealSpell));</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>((AddonComponent)Components[0]).ItemID = LaunchIDArray[0];
						((AddonComponent)Components[1]).ItemID = LaunchIDArray[0];
						((AddonComponent)Components[3]).ItemID = 1;
						((AddonComponent)Components[4]).ItemID = 1;
						break;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>((AddonComponent)Components[0]).ItemID = 1;
						((AddonComponent)Components[1]).ItemID = LaunchIDArray[0];
						((AddonComponent)Components[3]).ItemID = LaunchIDArray[0];
						((AddonComponent)Components[4]).ItemID = 1;
						break;</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>((AddonComponent)Components[0]).ItemID = 1;
						((AddonComponent)Components[1]).ItemID = 1;
						((AddonComponent)Components[3]).ItemID = LaunchIDArray[0];
						((AddonComponent)Components[4]).ItemID = LaunchIDArray[0];
						break;</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Ultima\Multis.cs

<pre>int centerx = m_Max.X - (int)(Math.Round((m_Max.X - m_Min.X) / 2.0));
						int centery = m_Max.Y - (int)(Math.Round((m_Max.Y - m_Min.Y) / 2.0));

						m_Min = m_Max = Point.Empty;</pre>

Fragment 2 in file Ultima\Multis.cs

<pre>int centerx = m_Max.X - (int)(Math.Round((m_Max.X - m_Min.X) / 2.0));
							int centery = m_Max.Y - (int)(Math.Round((m_Max.Y - m_Min.Y) / 2.0));

							m_Min = m_Max = Point.Empty;</pre>

Fragment 3 in file Ultima\Multis.cs

<pre>int centerx = m_Max.X - (int)(Math.Round((m_Max.X - m_Min.X) / 2.0));
			int centery = m_Max.Y - (int)(Math.Round((m_Max.Y - m_Min.Y) / 2.0));

			m_Min = m_Max = Point.Empty;</pre>

## Duplicated Code. Size: 125

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>break;

				case 10:
					// Entry fee
					int val = 0;
					TextRelay tr = info.GetTextEntry(10);
					if (tr != null)
					{
						try { val = int.Parse(tr.Text); }
						catch { }
					}
					m_gauntlet.EntryFee = val;

					m_gauntlet.ResetAcceptance();

					// update all the gumps
					RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>break;

                case 10:
                    // Entry fee
                    int val = 0;
                    TextRelay tr = info.GetTextEntry( 10 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.EntryFee = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>break;

                case 10:
                    // Entry fee
                    int val = 0;
                    TextRelay tr = info.GetTextEntry( 10 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.EntryFee = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>break;

                case 10:
                    // Entry fee
                    int val = 0;
                    TextRelay tr = info.GetTextEntry( 10 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.EntryFee = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>break;

                case 10:
                    // Entry fee
                    int val = 0;
                    TextRelay tr = info.GetTextEntry( 10 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.EntryFee = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>break;

                case 10:
                    // Entry fee
                    int val = 0;
                    TextRelay tr = info.GetTextEntry( 10 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.EntryFee = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>break;

                case 10:
                    // Entry fee
                    int val = 0;
                    TextRelay tr = info.GetTextEntry( 10 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.EntryFee = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 8 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>break;

                case 10:
                    // Entry fee
                    int val = 0;
                    TextRelay tr = info.GetTextEntry( 10 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.EntryFee = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 9 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>break;

                case 10:
                    // Entry fee
                    int val = 0;
                    TextRelay tr = info.GetTextEntry( 10 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.EntryFee = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

## Duplicated Code. Size: 124

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\TitlesMenu.cs

<pre>AddHtml(275, 240, 245, 16, Color("#FFFFFF", title), false, false);
                    AddHtmlLocalized(225, 275, 200, 16, 1115035, 0xFFFF, false, false); // Do you wish to apply this title?

                    AddHtmlLocalized(480, 275, 80, 16, 1011046, 0xFFFF, false, false); // APPLY</pre>

Fragment 2 in file Scripts\Gumps\TitlesMenu.cs

<pre>AddHtml(275, 240, 245, 16, Color("#FFFFFF", title), false, false);

                    AddHtmlLocalized(225, 275, 200, 16, 1115035, 0xFFFF, false, false); // Do you wish to apply this title?

                    AddHtmlLocalized(480, 275, 80, 16, 1011046, 0xFFFF, false, false); // APPLY</pre>

## Duplicated Code. Size: 124

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\GiantWebs.cs

<pre>int count = 4;
            bool leftToRight = true;

            for (int i = 0; i < count; ++i)
                this.AddComponent(new AddonComponent(itemID++), leftToRight ? i : count - 1 - i, -(leftToRight ? i : count - 1 - i), 0);</pre>

Fragment 2 in file Scripts\Items\Addons\GiantWebs.cs

<pre>int count = 4;
            bool leftToRight = true;

            for (int i = 0; i < count; ++i)
                this.AddComponent(new AddonComponent(itemID++), leftToRight ? i : count - 1 - i, -(leftToRight ? i : count - 1 - i), 0);</pre>

## Duplicated Code. Size: 124

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\GiantWebs.cs

<pre>int count = 4;
            bool leftToRight = false;

            for (int i = 0; i < count; ++i)
                this.AddComponent(new AddonComponent(itemID++), leftToRight ? i : count - 1 - i, -(leftToRight ? i : count - 1 - i), 0);</pre>

Fragment 2 in file Scripts\Items\Addons\GiantWebs.cs

<pre>int count = 4;
            bool leftToRight = false;

            for (int i = 0; i < count; ++i)
                this.AddComponent(new AddonComponent(itemID++), leftToRight ? i : count - 1 - i, -(leftToRight ? i : count - 1 - i), 0);</pre>

## Duplicated Code. Size: 124

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\Bola.cs

<pre>EtherealMount.StopMounting(from);

                if (Core.AOS)
                {
                    Item one = from.FindItemOnLayer(Layer.OneHanded);
                    Item two = from.FindItemOnLayer(Layer.TwoHanded);

                    if (one != null)
                        from.AddToBackpack(one);

                    if (two != null)
                        from.AddToBackpack(two);
                }</pre>

Fragment 2 in file Scripts\Items\Consumables\Bola.cs

<pre>EtherealMount.StopMounting(from);

                        if (Core.AOS)
                        {
                            Item one = from.FindItemOnLayer(Layer.OneHanded);
                            Item two = from.FindItemOnLayer(Layer.TwoHanded);

                            if (one != null)
                                from.AddToBackpack(one);

                            if (two != null)
                                from.AddToBackpack(two);
                        }</pre>

## Duplicated Code. Size: 124

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\TrapableContainer.cs

<pre>private void SendMessageTo(Mobile to, int number, int hue)
        {
            if (this.Deleted || !to.CanSee(this))
                return;

            to.Send(new Network.MessageLocalized(this.Serial, this.ItemID, Network.MessageType.Regular, hue, 3, number, "", ""));
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Items\WrongBedrolls.cs

<pre>private void SendMessageTo(Mobile to, int number, int hue)
        {
            if (this.Deleted || !to.CanSee(this))
                return;

            to.Send(new Network.MessageLocalized(this.Serial, this.ItemID, Network.MessageType.Regular, hue, 3, number, "", ""));
        }</pre>

## Duplicated Code. Size: 124

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\TrapableContainer.cs

<pre>private void SendMessageTo(Mobile to, string text, int hue)
        {
            if (this.Deleted || !to.CanSee(this))
                return;

            to.Send(new Network.UnicodeMessage(this.Serial, this.ItemID, Network.MessageType.Regular, hue, 3, "ENU", "", text));
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Items\WrongBedrolls.cs

<pre>private void SendMessageTo(Mobile to, string text, int hue)
        {
            if (this.Deleted || !to.CanSee(this))
                return;

            to.Send(new Network.UnicodeMessage(this.Serial, this.ItemID, Network.MessageType.Regular, hue, 3, "ENU", "", text));
        }</pre>

## Duplicated Code. Size: 124

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\AcidWall.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (from.InRange(this.GetWorldLocation(), 1))
            {
                from.SendMessage("You try to examine the strange wall but the vines get in your way.");
            }
            else if (!from.InRange(this.GetWorldLocation(), 1))
            {
                from.SendMessage("I can't reach that.");
            }
            base.OnDoubleClick(from);
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\AcidWall1.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (from.InRange(this.GetWorldLocation(), 1))
            {
                from.SendMessage("You try to examine the strange wall but the vines get in your way.");
            }
            else if (!from.InRange(this.GetWorldLocation(), 1))
            {
                from.SendMessage("I can't reach that.");
            }
            base.OnDoubleClick(from);
        }</pre>

## Duplicated Code. Size: 124

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\ChickenCoop.cs

<pre>m_From = from;
                m_List = list;

                from.CloseGump(typeof(ClaimListGump));

                AddPage(0);

                AddBackground(0, 0, 325, 50 + (list.Count * 20), 9250);
                AddAlphaRegion(5, 5, 315, 40 + (list.Count * 20));</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\AnimalTrainer.cs

<pre>m_From = from;
				m_List = list;

				from.CloseGump(typeof(ClaimListGump));

				AddPage(0);

				AddBackground(0, 0, 325, 50 + (list.Count * 20), 9250);
				AddAlphaRegion(5, 5, 315, 40 + (list.Count * 20));</pre>

## Duplicated Code. Size: 124

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\BaseChampion.cs

<pre>public virtual Item GetArtifact()
        {
            double random = Utility.RandomDouble();
            if (0.05 >= random)
                return this.CreateArtifact(this.UniqueList);
            else if (0.15 >= random)
                return this.CreateArtifact(this.SharedList);
            else if (0.30 >= random)
                return this.CreateArtifact(this.DecorativeList);
            return null;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\Harrower\Harrower.cs

<pre>public Item GetArtifact()
        {
            double random = Utility.RandomDouble();
            if (0.05 >= random)
                return this.CreateArtifact(this.UniqueList);
            else if (0.15 >= random)
                return this.CreateArtifact(this.SharedList);
            else if (0.30 >= random)
                return this.CreateArtifact(this.DecorativeList);
            return null;
        }</pre>

## Duplicated Code. Size: 124

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>this.m_Pyramid = new TournyPyramid();
                        this.m_Ruleset = new Ruleset(RulesetLayout.Root);
                        this.m_Ruleset.ApplyDefault(this.m_Ruleset.Layout.Defaults[0]);
                        this.m_Participants = new ArrayList();
                        this.m_Undefeated = new ArrayList();
                        this.m_Arenas = new ArrayList();</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>this.m_Pyramid = new TournyPyramid();
            this.m_Ruleset = new Ruleset(RulesetLayout.Root);
            this.m_Ruleset.ApplyDefault(this.m_Ruleset.Layout.Defaults[0]);
            this.m_Participants = new ArrayList();
            this.m_Undefeated = new ArrayList();
            this.m_Arenas = new ArrayList();</pre>

## Duplicated Code. Size: 124

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Mobiles\BaseSeaChampion.cs

<pre>public virtual void RegisterDamageTo(Mobile m)
        {
            if (m == null)
                return;

            foreach (DamageEntry de in m.DamageEntries)
            {
                Mobile damager = de.Damager;

                Mobile master = damager.GetDamageMaster(m);

                if (master != null)
                    damager = master;

                RegisterDamage(damager, de.DamageGiven);
            }
        }</pre>

Fragment 2 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>public virtual void RegisterDamageTo(Mobile m)
        {
            if (m == null)
                return;

            foreach (DamageEntry de in m.DamageEntries)
            {
                Mobile damager = de.Damager;

                Mobile master = damager.GetDamageMaster(m);

                if (master != null)
                    damager = master;

                RegisterDamage(damager, de.DamageGiven);
            }
        }</pre>

## Duplicated Code. Size: 124

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlPropsGump.cs

<pre>{
				Serial s = (Serial)o;

				if ( s.IsValid )
				{
					if ( s.IsItem )
					{
						return String.Format( "(I) 0x{0:X}", s.Value );
					}
					else if ( s.IsMobile )
					{
						return String.Format( "(M) 0x{0:X}", s.Value );
					}
				}

				return String.Format( "(?) 0x{0:X}", s.Value );
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlPropsGump.cs

<pre>{
				Serial s = (Serial)o;

				if ( s.IsValid )
				{
					if ( s.IsItem )
					{
						return String.Format( "(I) 0x{0:X}", s.Value );
					}
					else if ( s.IsMobile )
					{
						return String.Format( "(M) 0x{0:X}", s.Value );
					}
				}

				return String.Format( "(?) 0x{0:X}", s.Value );
			}</pre>

## Duplicated Code. Size: 124

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Agralem.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Backpack());

            this.AddItem(new GargishClothChest(Utility.RandomNeutralHue()));
            this.AddItem(new GargishClothKilt(Utility.RandomNeutralHue()));
            this.AddItem(new GargishClothLegs(Utility.RandomNeutralHue()));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Naxatillor.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Backpack());

            this.AddItem(new GargishClothChest(Utility.RandomNeutralHue()));
            this.AddItem(new GargishClothKilt(Utility.RandomNeutralHue()));
            this.AddItem(new GargishClothLegs(Utility.RandomNeutralHue()));
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Valem.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Backpack());

            this.AddItem(new GargishClothChest(Utility.RandomNeutralHue()));
            this.AddItem(new GargishClothKilt(Utility.RandomNeutralHue()));
            this.AddItem(new GargishClothLegs(Utility.RandomNeutralHue()));
        }</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>public void Pop(out string v, ref string line)
        {
            int space = line.IndexOf(' ');

            if (space >= 0)
            {
                v = line.Substring(0, space++);
                line = line.Substring(space);
            }
            else
            {
                v = line;
                line = "";
            }
        }</pre>

Fragment 2 in file Scripts\Commands\DecorateMag.cs

<pre>public void Pop(out string v, ref string line)
        {
            int space = line.IndexOf(' ');

            if (space >= 0)
            {
                v = line.Substring(0, space++);
                line = line.Substring(space);
            }
            else
            {
                v = line;
                line = "";
            }
        }</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Implementors\IPAddressCommandImplementor.cs

<pre>Extensions ext = Extensions.Parse(from, ref args);

                bool items, mobiles;

                if (!this.CheckObjectTypes(from, command, ext, out items, out mobiles))
                    return;

                if (!mobiles) // sanity check
                {
                    command.LogFailure("This command does not support items.");
                    return;
                }

                ArrayList list = new ArrayList();</pre>

Fragment 2 in file Scripts\Commands\Generic\Implementors\OnlineCommandImplementor.cs

<pre>Extensions ext = Extensions.Parse(from, ref args);

                bool items, mobiles;

                if (!this.CheckObjectTypes(from, command, ext, out items, out mobiles))
                    return;

                if (!mobiles) // sanity check
                {
                    command.LogFailure("This command does not support items.");
                    return;
                }

                ArrayList list = new ArrayList();</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\AcidSlime.cs

<pre>{
            this.Hue = 0x3F;
            this.Movable = false;
            this.m_MinDamage = minDamage;
            this.m_MaxDamage = maxDamage;
            this.m_Created = DateTime.UtcNow;
            this.m_Duration = duration;
            this.m_Timer = Timer.DelayCall(TimeSpan.Zero, TimeSpan.FromSeconds(1), new TimerCallback(OnTick));
        }</pre>

Fragment 2 in file Scripts\Items\Internal\PoolOfAcid.cs

<pre>{
            this.Hue = 0x3F;
            this.Movable = false;

            this.m_MinDamage = minDamage;
            this.m_MaxDamage = maxDamage;
            this.m_Created = DateTime.UtcNow;
            this.m_Duration = duration;

            this.m_Timer = Timer.DelayCall(TimeSpan.Zero, TimeSpan.FromSeconds(1), new TimerCallback(OnTick));
        }</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\AOS.cs

<pre>private int GetIndex(uint mask)
        {
            int index = 0;
            uint ourNames = this.m_Names;
            uint currentBit = 1;

            while (currentBit != mask)
            {
                if ((ourNames & currentBit) != 0)
                    ++index;

                if (currentBit == 0x80000000)
                    return -1;

                currentBit <<= 1;
            }

            return index;
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlAosAttributes.cs

<pre>private int GetIndex(uint mask)
        {
            int index = 0;
            uint ourNames = this.m_Names;
            uint currentBit = 1;

            while (currentBit != mask)
            {
                if ((ourNames & currentBit) != 0)
                    ++index;

                if (currentBit == 0x80000000)
                    return -1;

                currentBit <<= 1;
            }

            return index;
        }</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Harrower\HarrowerTentacles.cs

<pre>this.SetDamage(13, 20);

            this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Poison, 20);
            this.SetDamageType(ResistanceType.Energy, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Mimic.cs

<pre>this.SetDamage(13, 20);

            this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Poison, 20);
            this.SetDamageType(ResistanceType.Energy, 20);</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\EvilMageLord.cs

<pre>switch (Utility.Random(16))
            {
                case 0: PackItem(new BloodOathScroll()); break;
                case 1: PackItem(new CurseWeaponScroll()); break;
                case 2: PackItem(new StrangleScroll()); break;
                case 3: PackItem(new LichFormScroll()); break;
			}</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Mobile\Archmage.cs

<pre>switch (Utility.Random(16))
            {
                case 0: PackItem(new BloodOathScroll()); break;
                case 1: PackItem(new CurseWeaponScroll()); break;
                case 2: PackItem(new StrangleScroll()); break;
                case 3: PackItem(new LichFormScroll()); break;
			}</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Executioner.cs

<pre>this.SetSkill(SkillName.MagicResist, 83.5, 92.5);
            this.SetSkill(SkillName.Swords, 125.0);
            this.SetSkill(SkillName.Tactics, 125.0);
            this.SetSkill(SkillName.Lumberjacking, 125.0);

            this.Fame = 5000;
            this.Karma = -5000;

            this.VirtualArmor = 40;</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Mobile\DemonicJailor.cs

<pre>this.SetSkill(SkillName.MagicResist, 83.5, 92.5);
            this.SetSkill(SkillName.Swords, 125.0);
            this.SetSkill(SkillName.Tactics, 125.0);
            this.SetSkill(SkillName.Lumberjacking, 125.0);

            this.Fame = 5000;
            this.Karma = -5000;

            this.VirtualArmor = 40;</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Ferret.cs

<pre>this.SetResistance(ResistanceType.Energy, 20, 25);

            this.SetSkill(SkillName.MagicResist, 4.0);
            this.SetSkill(SkillName.Tactics, 4.0);
            this.SetSkill(SkillName.Wrestling, 4.0);

            this.Tamable = true;
            this.ControlSlots = 1;
            this.MinTameSkill = -21.3;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Squirrel.cs

<pre>this.SetResistance(ResistanceType.Energy, 20, 25);

            this.SetSkill(SkillName.MagicResist, 4.0);
            this.SetSkill(SkillName.Tactics, 4.0);
            this.SetSkill(SkillName.Wrestling, 4.0);

            this.Tamable = true;	
            this.ControlSlots = 1;
            this.MinTameSkill = -21.3;</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\PlayerVendor.cs

<pre>if (!this.m_Vendor.CanInteractWith(from, true))
                    return;

                string name = text.Trim();

                if (!NameVerification.Validate(name, 1, 20, true, true, true, 0, NameVerification.Empty))
                {
                    this.m_Vendor.SayTo(from, "That name is unacceptable.");
                    return;
                }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\PlayerVendor.cs

<pre>if (!this.m_Vendor.CanInteractWith(from, true))
                    return;

                string name = text.Trim();

                if (!NameVerification.Validate(name, 1, 20, true, true, true, 0, NameVerification.Empty))
                {
                    this.m_Vendor.SayTo(from, "That name is unacceptable.");
                    return;
                }</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>double minXDist = Math.Min(bc.GetDistanceToSqrt(xWall1), bc.GetDistanceToSqrt(xWall2));
                        double minYDist = Math.Min(bc.GetDistanceToSqrt(yWall1), bc.GetDistanceToSqrt(yWall2));

                        bc.RangeHome = (int)Math.Min(minXDist, minYDist);</pre>

Fragment 2 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>double minXDist = Math.Min(bc.GetDistanceToSqrt(xWall1), bc.GetDistanceToSqrt(xWall2));
                        double minYDist = Math.Min(bc.GetDistanceToSqrt(yWall1), bc.GetDistanceToSqrt(yWall2));

                        bc.RangeHome = (int)Math.Min(minXDist, minYDist);</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void AlterSpellDamageFrom(Mobile from, ref int damage)
        {
            if (from is BaseCreature && (((BaseCreature)from).Summoned || ((BaseCreature)from).Controlled))
                damage /= 2;

            if (NextTeleport < DateTime.UtcNow)
                DoTeleport(from);

            base.AlterSpellDamageFrom(from, ref damage);
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void AlterSpellDamageFrom(Mobile from, ref int damage)
        {
            if (from is BaseCreature && (((BaseCreature)from).Summoned || ((BaseCreature)from).Controlled))
                damage /= 2;

            if (NextTeleport < DateTime.UtcNow)
                DoTeleport(from);

            base.AlterSpellDamageFrom(from, ref damage);
        }</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void AlterMeleeDamageFrom(Mobile from, ref int damage)
        {
            if (from is BaseCreature && (((BaseCreature)from).Summoned || ((BaseCreature)from).Controlled))
                damage /= 2;

            if (NextTeleport < DateTime.UtcNow)
                DoTeleport(from);

            base.AlterMeleeDamageFrom(from, ref damage);
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void AlterMeleeDamageFrom(Mobile from, ref int damage)
        {
            if (from is BaseCreature && (((BaseCreature)from).Summoned || ((BaseCreature)from).Controlled))
                damage /= 2;

            if (NextTeleport < DateTime.UtcNow)
                DoTeleport(from);

            base.AlterMeleeDamageFrom(from, ref damage);
        }</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
								if (arglist[1] != null && arglist[1].Length > 0 && arglist[1][0] == '@')
								{
									arglist = ParseSlashArgs(substitutedtypeName, 2);
									msgText = arglist[1].Substring(1);
								}
								else
									msgText = arglist[1];
							}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
								if (arglist[1] != null && arglist[1].Length > 0 && arglist[1][0] == '@')
								{
									arglist = ParseSlashArgs(substitutedtypeName, 2);
									msgText = arglist[1].Substring(1);
								}
								else
									msgText = arglist[1];
							}</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>public override void Serialize( GenericWriter writer )
		{
			base.Serialize( writer );

			writer.Write( (int) 7 ); // version

			// version 7
			writer.Write( m_EItemID);
			writer.Write( m_Duration);
			writer.Write( m_Offset);
			writer.Write( m_EHue);

			// version 6
			writer.Write( m_TalkText);

			// Version 5
			// all serialized data now handled by the XmlDialog attachment

		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>public override void Serialize( GenericWriter writer )
		{
			base.Serialize( writer );

			writer.Write( (int) 7 ); // version

			// version 7
			writer.Write( m_EItemID);
			writer.Write( m_Duration);
			writer.Write( m_Offset);
			writer.Write( m_EHue);

			// version 6
			writer.Write( m_TalkText);

			// Version 5
			// all serialized data now handled by the XmlDialog attachment

		}</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>int count = int.Parse(GetText(node["count"], "1"));
			int homeRange = int.Parse(GetText(node["homerange"], "4"));
			int walkingRange = int.Parse(GetText(node["walkingrange"], "-1"));</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Support\SpawnerExporter.cs

<pre>int count = int.Parse( GetText( node["count"], "1" ) );
			int homeRange = int.Parse( GetText( node["homerange"], "4" ) );

			int walkingRange = int.Parse(GetText(node["walkingrange"], "-1"));</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>Point3D loc = item.Location;
				if (item.Parent != null && item.RootParent != null)
				{
					if (item.RootParent is Mobile)
					{
						loc = ((Mobile)item.RootParent).Location;
					}
					else
						if (item.RootParent is Container)
						{
							loc = ((Container)item.RootParent).Location;
						}

				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>Point3D loc = item.Location;
				if (item.Parent != null && item.RootParent != null)
				{
					if (item.RootParent is Mobile)
					{
						loc = ((Mobile)item.RootParent).Location;
					}
					else
						if (item.RootParent is Container)
						{
							loc = ((Container)item.RootParent).Location;
						}

				}</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Fifth\PoisonField.cs

<pre>{
                                if ((m.Z + 16) > this.m_Item.Z && (this.m_Item.Z + 12) > m.Z && (!Core.AOS || m != caster) && SpellHelper.ValidIndirectTarget(caster, m) && caster.CanBeHarmful(m, false))
                                    m_Queue.Enqueue(m);
                            }</pre>

Fragment 2 in file Scripts\Spells\Fourth\FireField.cs

<pre>{
                                if ((m.Z + 16) > this.m_Item.Z && (this.m_Item.Z + 12) > m.Z && (!Core.AOS || m != caster) && SpellHelper.ValidIndirectTarget(caster, m) && caster.CanBeHarmful(m, false))
                                    m_Queue.Enqueue(m);
                            }</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Ultima\Animations.cs

<pre>FileIndex fileIndex;
			int index;
			GetFileIndex(body, action, direction, fileType, out fileIndex, out index);

			int length, extra;
			bool patched;
			Stream stream = fileIndex.Seek(index, out length, out extra, out patched);

			if (stream == null)
			{
				return null;
			}</pre>

Fragment 2 in file Ultima\Animations.cs

<pre>FileIndex fileIndex;
			int index;
			GetFileIndex(body, action, direction, fileType, out fileIndex, out index);

			int length, extra;
			bool patched;

			Stream stream = fileIndex.Seek(index, out length, out extra, out patched);

			if (stream == null)
			{
				return null;
			}</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\GuildCandidatesGump.cs

<pre>public override void OnResponse(NetState state, RelayInfo info)
        {
            if (GuildGump.BadMember(this.m_Mobile, this.m_Guild))
                return;

            if (info.ButtonID == 1)
            {
                GuildGump.EnsureClosed(this.m_Mobile);
                this.m_Mobile.SendGump(new GuildGump(this.m_Mobile, this.m_Guild));
            }
        }</pre>

Fragment 2 in file Scripts\Gumps\Guilds\GuildRosterGump.cs

<pre>public override void OnResponse(NetState state, RelayInfo info)
        {
            if (GuildGump.BadMember(this.m_Mobile, this.m_Guild))
                return;

            if (info.ButtonID == 1)
            {
                GuildGump.EnsureClosed(this.m_Mobile);
                this.m_Mobile.SendGump(new GuildGump(this.m_Mobile, this.m_Guild));
            }
        }</pre>

Fragment 3 in file Scripts\Gumps\Guilds\GuildWarGump.cs

<pre>public override void OnResponse(NetState state, RelayInfo info)
        {
            if (GuildGump.BadMember(this.m_Mobile, this.m_Guild))
                return;

            if (info.ButtonID == 1)
            {
                GuildGump.EnsureClosed(this.m_Mobile);
                this.m_Mobile.SendGump(new GuildGump(this.m_Mobile, this.m_Guild));
            }
        }</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\FukiyaDarts.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            list.Add(1060584, this.m_UsesRemaining.ToString()); // uses remaining: ~1_val~

            if (this.m_Poison != null && this.m_PoisonCharges > 0)
                list.Add(1062412 + this.m_Poison.Level, this.m_PoisonCharges.ToString());
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\Shuriken.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            list.Add(1060584, this.m_UsesRemaining.ToString()); // uses remaining: ~1_val~

            if (this.m_Poison != null && this.m_PoisonCharges > 0)
                list.Add(1062412 + this.m_Poison.Level, this.m_PoisonCharges.ToString());
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Weapons\Fukiya.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            list.Add(1060584, this.m_UsesRemaining.ToString()); // uses remaining: ~1_val~

            if (this.m_Poison != null && this.m_PoisonCharges > 0)
                list.Add(1062412 + this.m_Poison.Level, this.m_PoisonCharges.ToString());
        }</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\SlasherOfVeils.cs

<pre>this.SetDamage(10, 15);

            this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Poison, 20);
            this.SetDamageType(ResistanceType.Energy, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Void Creatures\Ballem.cs

<pre>this.SetDamage(10, 15);

            this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Poison, 20);
            this.SetDamageType(ResistanceType.Energy, 20);</pre>

Fragment 3 in file Scripts\Mobiles\Void Creatures\Relanord.cs

<pre>this.SetDamage(10, 15);

            this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Poison, 20);
            this.SetDamageType(ResistanceType.Energy, 20);</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>if (xOffset == 0)
                                    newPoint = new Point3D(pnt.X + (xOffset + i), pnt.Y + (yOffset * currentRange), pnt.Z);
                                else
                                    newPoint = new Point3D(pnt.X + (xOffset * currentRange), pnt.Y + (yOffset + i), pnt.Z);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>if (xOffset == 0)
                                    newPoint = new Point3D(pnt.X + (xOffset + i), pnt.Y + (yOffset * currentRange), pnt.Z);
                                else
                                    newPoint = new Point3D(pnt.X + (xOffset * currentRange), pnt.Y + (yOffset + i), pnt.Z);</pre>

Fragment 3 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\BaseShipCaptain.cs

<pre>if (xOffset == 0)
                        newPoint = new Point3D(pnt.X + (xOffset + i), pnt.Y + (yOffset * currentRange), pnt.Z);
                    else
                        newPoint = new Point3D(pnt.X + (xOffset * currentRange), pnt.Y + (yOffset + i), pnt.Z);</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>public override bool CheckTeach(SkillName skill, Mobile from)
        {
            if (!base.CheckTeach(skill, from))
                return false;

            return (skill == SkillName.Anatomy) ||
                   (skill == SkillName.Camping) ||
                   (skill == SkillName.Forensics) ||
                   (skill == SkillName.Healing) ||
                   (skill == SkillName.SpiritSpeak);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\EvilWanderingHealer.cs

<pre>public override bool CheckTeach(SkillName skill, Mobile from)
        {
            if (!base.CheckTeach(skill, from))
                return false;

            return (skill == SkillName.Anatomy) ||
                   (skill == SkillName.Camping) ||
                   (skill == SkillName.Forensics) ||
                   (skill == SkillName.Healing) ||
                   (skill == SkillName.SpiritSpeak);
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\WanderingHealer.cs

<pre>public override bool CheckTeach(SkillName skill, Mobile from)
        {
            if (!base.CheckTeach(skill, from))
                return false;

            return (skill == SkillName.Anatomy) ||
                   (skill == SkillName.Camping) ||
                   (skill == SkillName.Forensics) ||
                   (skill == SkillName.Healing) ||
                   (skill == SkillName.SpiritSpeak);
        }</pre>

Fragment 4 in file Scripts\Quests\Escortables.cs

<pre>public override bool CheckTeach(SkillName skill, Mobile from)
        {
            if (!base.CheckTeach(skill, from))
                return false;

            return (skill == SkillName.Anatomy) ||
                   (skill == SkillName.Camping) ||
                   (skill == SkillName.Forensics) ||
                   (skill == SkillName.Healing) ||
                   (skill == SkillName.SpiritSpeak);
        }</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\LargeBODAcceptGump.cs

<pre>public static int GetMaterialNumberFor(BulkMaterialType material)
        {
            if (material >= BulkMaterialType.DullCopper && material <= BulkMaterialType.Valorite)
                return 1045142 + (int)(material - BulkMaterialType.DullCopper);
            else if (material >= BulkMaterialType.Spined && material <= BulkMaterialType.Barbed)
                return 1049348 + (int)(material - BulkMaterialType.Spined);

            return 0;
        }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\LargeBODGump.cs

<pre>public static int GetMaterialNumberFor(BulkMaterialType material)
        {
            if (material >= BulkMaterialType.DullCopper && material <= BulkMaterialType.Valorite)
                return 1045142 + (int)(material - BulkMaterialType.DullCopper);
            else if (material >= BulkMaterialType.Spined && material <= BulkMaterialType.Barbed)
                return 1049348 + (int)(material - BulkMaterialType.Spined);

            return 0;
        }</pre>

Fragment 3 in file Scripts\Services\BulkOrders\SmallBODAcceptGump.cs

<pre>public static int GetMaterialNumberFor(BulkMaterialType material)
        {
            if (material >= BulkMaterialType.DullCopper && material <= BulkMaterialType.Valorite)
                return 1045142 + (int)(material - BulkMaterialType.DullCopper);
            else if (material >= BulkMaterialType.Spined && material <= BulkMaterialType.Barbed)
                return 1049348 + (int)(material - BulkMaterialType.Spined);

            return 0;
        }</pre>

Fragment 4 in file Scripts\Services\BulkOrders\SmallBODGump.cs

<pre>public static int GetMaterialNumberFor(BulkMaterialType material)
        {
            if (material >= BulkMaterialType.DullCopper && material <= BulkMaterialType.Valorite)
                return 1045142 + (int)(material - BulkMaterialType.DullCopper);
            else if (material >= BulkMaterialType.Spined && material <= BulkMaterialType.Barbed)
                return 1049348 + (int)(material - BulkMaterialType.Spined);

            return 0;
        }</pre>

## Duplicated Code. Size: 123

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Ansikart.cs

<pre>public override void InitOutfit()
        { 
            this.AddItem(new Backpack());		
            this.AddItem(new Boots());
            this.AddItem(new LongPants(0x6C7));
            this.AddItem(new FancyShirt(0x6BB));
            this.AddItem(new Cloak(0x59));		
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Aurvidlem.cs

<pre>public override void InitOutfit()
        { 
            this.AddItem(new Backpack());		
            this.AddItem(new Boots());
            this.AddItem(new LongPants(0x6C7));
            this.AddItem(new FancyShirt(0x6BB));
            this.AddItem(new Cloak(0x59));		
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Belulah.cs

<pre>public override void InitOutfit()
        { 
            this.AddItem(new Backpack());		
            this.AddItem(new Boots());
            this.AddItem(new LongPants(0x6C7));
            this.AddItem(new FancyShirt(0x6BB));
            this.AddItem(new Cloak(0x59));		
        }</pre>

Fragment 4 in file Scripts\Mobiles\NPCs\Beninort.cs

<pre>public override void InitOutfit()
        { 
            this.AddItem(new Backpack());		
            this.AddItem(new Boots());
            this.AddItem(new LongPants(0x6C7));
            this.AddItem(new FancyShirt(0x6BB));
            this.AddItem(new Cloak(0x59));		
        }</pre>

Fragment 5 in file Scripts\Mobiles\NPCs\Thepem.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Backpack());
            this.AddItem(new Boots());
            this.AddItem(new LongPants(0x6C7));
            this.AddItem(new FancyShirt(0x6BB));
            this.AddItem(new Cloak(0x59));
        }</pre>

Fragment 6 in file Scripts\Mobiles\NPCs\Zosilem.cs

<pre>public override void InitOutfit()
        { 
            this.AddItem(new Backpack());		
            this.AddItem(new Boots());
            this.AddItem(new LongPants(0x6C7));
            this.AddItem(new FancyShirt(0x6BB));
            this.AddItem(new Cloak(0x59));		
        }</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Add.cs

<pre>PropertyInfo thisProp = null;

                    string propName = props[i, 0];

                    for (int j = 0; thisProp == null && j < allProps.Length; ++j)
                    {
                        if (Insensitive.Equals(propName, allProps[j].Name))
                            thisProp = allProps[j];
                    }</pre>

Fragment 2 in file Scripts\Services\Spawner\Spawner.cs

<pre>PropertyInfo thisProp = null;

                    string propName = props[i, 0];

                    for (int j = 0; thisProp == null && j < allProps.Length; ++j)
                    {
                        if (Insensitive.Equals(propName, allProps[j].Name))
                            thisProp = allProps[j];
                    }</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Implementors\ContainedCommandImplementor.cs

<pre>if (!BaseCommand.IsAccessible(from, targeted))
            {
                from.SendMessage("That is not accessible.");
                return;
            }

            object[] states = (object[])state;
            BaseCommand command = (BaseCommand)states[0];
            string[] args = (string[])states[1];</pre>

Fragment 2 in file Scripts\Commands\Generic\Implementors\SingleCommandImplementor.cs

<pre>if (!BaseCommand.IsAccessible(from, targeted))
            {
                from.SendMessage("That is not accessible.");
                return;
            }

            object[] states = (object[])state;
            BaseCommand command = (BaseCommand)states[0];
            string[] args = (string[])states[1];</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SpecialFishingNet.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_InUse = reader.ReadBool();

                        if (this.m_InUse)
                            this.Delete();

                        break;
                    }
            }

            this.Stackable = false;
        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\SpecialSalvageHook.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch (version)
            {
                case 1:
                    {
                        this.m_InUse = reader.ReadBool();

                        if (this.m_InUse)
                            this.Delete();

                        break;
                    }
            }

            this.Stackable = false;
        }</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\BaseHarvestTool.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((Mobile)this.m_Crafter);
            writer.Write((int)this.m_Quality);

            writer.Write((int)this.m_UsesRemaining);
        }</pre>

Fragment 2 in file Scripts\Items\Tools\BaseTool.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((Mobile)this.m_Crafter);
            writer.Write((int)this.m_Quality);

            writer.Write((int)this.m_UsesRemaining);
        }</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DullCopperElemental.cs

<pre>this.BaseSoundID = 268;

            this.SetStr(226, 255);
            this.SetDex(126, 145);
            this.SetInt(71, 92);

            this.SetHits(136, 153);

            this.SetDamage(9, 16);

            this.SetDamageType(ResistanceType.Physical, 100);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GoldenElemental.cs

<pre>this.BaseSoundID = 268;

            this.SetStr(226, 255);
            this.SetDex(126, 145);
            this.SetInt(71, 92);

            this.SetHits(136, 153);

            this.SetDamage(9, 16);

            this.SetDamageType(ResistanceType.Physical, 100);</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Deeds.cs

<pre>for (int i = 0; i < toMove.Count; ++i)
                            {
                                object o = toMove[i];

                                if (o is Mobile)
                                    ((Mobile)o).Location = house.BanLocation;
                                else if (o is Item)
                                    ((Item)o).Location = house.BanLocation;
                            }</pre>

Fragment 2 in file Scripts\Multis\HousePlacementTool.cs

<pre>for (int i = 0; i < toMove.Count; ++i)
                            {
                                object o = toMove[i];

                                if (o is Mobile)
                                    ((Mobile)o).Location = house.BanLocation;
                                else if (o is Item)
                                    ((Item)o).Location = house.BanLocation;
                            }</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Armor Refinement\Items.cs

<pre>private bool CheckSkill(Mobile from)
        {
            SkillName check = SkillName.Blacksmith;

            switch (m_CraftType)
            {
                case RefinementCraftType.Blacksmith: break;
                case RefinementCraftType.Tailor: check = SkillName.Tailoring; break;
                case RefinementCraftType.Carpenter: check = SkillName.Carpentry; break;
            }

            return from.Skills[check].Value >= 100;
        }</pre>

Fragment 2 in file Scripts\Services\Armor Refinement\Items.cs

<pre>private bool CheckSkill(Mobile from)
        {
            SkillName check = SkillName.Blacksmith;

            switch (m_CraftType)
            {
                case RefinementCraftType.Blacksmith: break;
                case RefinementCraftType.Tailor: check = SkillName.Tailoring; break;
                case RefinementCraftType.Carpenter: check = SkillName.Carpentry; break;
            }

            return from.Skills[check].Value >= 100;
        }</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\Core\CraftGumpItem.cs

<pre>CraftSubResCol res = (this.m_CraftItem.UseSubRes2 ? this.m_CraftSystem.CraftSubRes2 : this.m_CraftSystem.CraftSubRes);
            int resIndex = -1;

            CraftContext context = this.m_CraftSystem.GetContext(this.m_From);

            if (context != null)
                resIndex = (this.m_CraftItem.UseSubRes2 ? context.LastResourceIndex2 : context.LastResourceIndex);</pre>

Fragment 2 in file Scripts\Services\Craft\Core\CraftGumpItem.cs

<pre>CraftContext context = this.m_CraftSystem.GetContext(this.m_From);

            CraftSubResCol res = (this.m_CraftItem.UseSubRes2 ? this.m_CraftSystem.CraftSubRes2 : this.m_CraftSystem.CraftSubRes);
            int resIndex = -1;

            if (context != null)
                resIndex = (this.m_CraftItem.UseSubRes2 ? context.LastResourceIndex2 : context.LastResourceIndex);</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>Hue = 33960; break;
                case EodonTribe.Barrab:
                    Female = true;
                    Body = 0x191;
                    HairItemID = 0x203B;
                    Hue = 34214; break;
                case EodonTribe.Barako:
                    Female = Utility.RandomBool();
                    Body = Female ? 0x191 : 0x190;
                    HairItemID = 0x203C;
                    Hue = 35187; break;
                case EodonTribe.Urali:</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>Hue = 33960; break;
                case EodonTribe.Barrab:
                    Female = true;
                    Body = 0x191;
                    HairItemID = 0x203B;
                    Hue = 34214; break;
                case EodonTribe.Barako:
                    Female = Utility.RandomBool();
                    Body = Female ? 0x191 : 0x190;
                    HairItemID = 0x203C;
                    Hue = 35187; break;
                case EodonTribe.Urali:</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\MiniChampionSystem\MiniChampType.cs

<pre>new Type[][]
				{																										
					new Type[]{ typeof( LavaSnake ), typeof( LavaLizard ), typeof( FireAnt ) },															// Level 1
					new Type[]{ typeof( LavaSerpent ), typeof( HellCat ), typeof( HellHound ) },														// Level 2
					new Type[]{ typeof( FireDaemon ), typeof( LavaElemental ) }																			// Level 3
				}</pre>

Fragment 2 in file Scripts\Services\MiniChampionSystem\MiniChampType.cs

<pre>new Type[][]
				{																										
					new Type[]{ typeof( LavaSnake ), typeof( LavaLizard ), typeof( FireAnt ) },															// Level 1
					new Type[]{ typeof( LavaSerpent ), typeof( HellCat ), typeof( HellHound ) },														// Level 2
					new Type[]{ typeof( FireDaemon ), typeof( LavaElemental ) }																			// Level 3
				}</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>int length = m_Creature.GetLeashLength();
                        IPoint3D p = m_Creature.Orb.Anchor as IPoint3D;

                        if (p == null)
                            p = m_Creature;

                        Mobile combatant = m_Creature.Combatant != null ? m_Creature.Combatant as Mobile : m_Creature.ControlMaster.Combatant != null ? m_Creature.ControlMaster.Combatant as Mobile : null;</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\AI.cs

<pre>int length = m_Creature.GetLeashLength();
                        IPoint3D p = m_Creature.Orb.Anchor as IPoint3D;

                        if (p == null)
                            p = m_Creature;

                        Mobile combatant = m_Creature.Combatant != null ? m_Creature.Combatant as Mobile : m_Creature.ControlMaster.Combatant != null ? m_Creature.ControlMaster.Combatant as Mobile : null;</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>dictionary = new Dictionary<Point3D, int>();
                dictionary[new Point3D(-1, 0, 0)] = 1059;
                dictionary[new Point3D(0, 0, 0)] = 1059;
                dictionary[new Point3D(1, 0, 0)] = 1059;</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>dictionary = new Dictionary<Point3D, int>();
                dictionary[new Point3D(-1, 0, 0)] = 1059;
                dictionary[new Point3D(0, 0, 0)] = 1059;
                dictionary[new Point3D(1, 0, 0)] = 1059;</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>int hue = m.Hue;

			if (m.SolidHueOverride >= 0)
			{
				hue = m.SolidHueOverride;
			}

			m_Stream.Write(m.Serial);
			m_Stream.Write((short)m.Body);
			m_Stream.Write((byte)0);
			m_Stream.Write((short)hue);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>int hue = m.Hue;

			if (m.SolidHueOverride >= 0)
			{
				hue = m.SolidHueOverride;
			}

			m_Stream.Write(m.Serial);
			m_Stream.Write((short)m.Body);
			m_Stream.Write((byte)0);
			m_Stream.Write((short)hue);</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Healer.cs

<pre>public override bool CheckResurrect(Mobile m)
        {
            if (m.Criminal)
            {
                this.Say(501222); // Thou art a criminal.  I shall not resurrect thee.
                return false;
            }
            else if (m.Kills >= 5)
            {
                this.Say(501223); // Thou'rt not a decent and good person. I shall not resurrect thee.
                return false;
            }
            else if (m.Karma < 0)
            {
                this.Say(501224); // Thou hast strayed from the path of virtue, but thou still deservest a second chance.
            }

            return true;
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\WanderingHealer.cs

<pre>public override bool CheckResurrect(Mobile m)
        {
            if (m.Criminal)
            {
                this.Say(501222); // Thou art a criminal.  I shall not resurrect thee.
                return false;
            }
            else if (m.Kills >= 5)
            {
                this.Say(501223); // Thou'rt not a decent and good person. I shall not resurrect thee.
                return false;
            }
            else if (m.Karma < 0)
            {
                this.Say(501224); // Thou hast strayed from the path of virtue, but thou still deservest a second chance.
            }

            return true;
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Creatures\AgentoftheCrown.cs

<pre>public override bool CheckResurrect(Mobile m)
        {
            if (m.Criminal)
            {
                this.Say(501222); // Thou art a criminal.  I shall not resurrect thee.
                return false;
            }
            else if (m.Kills >= 5)
            {
                this.Say(501223); // Thou'rt not a decent and good person. I shall not resurrect thee.
                return false;
            }
            else if (m.Karma < 0)
            {
                this.Say(501224); // Thou hast strayed from the path of virtue, but thou still deservest a second chance.
            }

            return true;
        }</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DolphinRug.cs

<pre>{
            m_NextUse = nextuse;

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );
		}</pre>

Fragment 2 in file Scripts\Items\Addons\DolphinRug.cs

<pre>{
            m_NextUse = nextuse;

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent(new AddonComponent(m_AddOnSimpleComponents[i, 0]), m_AddOnSimpleComponents[i, 1], m_AddOnSimpleComponents[i, 2], m_AddOnSimpleComponents[i, 3]);
        }</pre>

Fragment 3 in file Scripts\Items\Addons\RoseRug.cs

<pre>{
            m_NextUse = nextuse;

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );
		}</pre>

Fragment 4 in file Scripts\Items\Addons\RoseRug.cs

<pre>{
            m_NextUse = nextuse;

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent(new AddonComponent(m_AddOnSimpleComponents[i, 0]), m_AddOnSimpleComponents[i, 1], m_AddOnSimpleComponents[i, 2], m_AddOnSimpleComponents[i, 3]);
        }</pre>

Fragment 5 in file Scripts\Items\Addons\SkullRug.cs

<pre>{
            m_NextUse = nextuse;

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );
		}</pre>

Fragment 6 in file Scripts\Items\Addons\SkullRug.cs

<pre>{
            m_NextUse = nextuse;

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent(new AddonComponent(m_AddOnSimpleComponents[i, 0]), m_AddOnSimpleComponents[i, 1], m_AddOnSimpleComponents[i, 2], m_AddOnSimpleComponents[i, 3]);
        }</pre>

## Duplicated Code. Size: 122

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (item != null)
										{
											if (equip && m != null)
											{
												if (!m.EquipItem(item)) pack.DropItem(item);
											}
											else
												pack.DropItem(item);
											// could call applyobjectstringproperties on a nested propertylist here to set item attributes
											if (itemargstring != null)
											{
												ApplyObjectStringProperties(spawner, itemargstring, item, trigmob, refobject, out status_str);
											}
										}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (item != null)
										{
											if (equip && m != null)
											{
												if (!m.EquipItem(item)) pack.DropItem(item);
											}
											else
												pack.DropItem(item);
											// could call applyobjectstringproperties on a nested propertylist here to set item attributes
											if (itemargstring != null)
											{
												ApplyObjectStringProperties(spawner, itemargstring, item, trigmob, refobject, out status_str);
											}
										}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (item != null)
										{
											if (equip && m != null)
											{
												if (!m.EquipItem(item)) pack.DropItem(item);
											}
											else
												pack.DropItem(item);
											// could call applyobjectstringproperties on a nested propertylist here to set item attributes
											if (itemargstring != null)
											{
												ApplyObjectStringProperties(spawner, itemargstring, item, trigmob, refobject, out status_str);
											}
										}</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (item != null)
										{
											if (equip && m != null)
											{
												if (!m.EquipItem(item)) pack.DropItem(item);
											}
											else
												pack.DropItem(item);
											// could call applyobjectstringproperties on a nested propertylist here to set item attributes
											if (itemargstring != null)
											{
												ApplyObjectStringProperties(spawner, itemargstring, item, trigmob, refobject, out status_str);
											}
										}</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (item != null)
										{
											if (equip && m != null)
											{
												if (!m.EquipItem(item)) pack.DropItem(item);
											}
											else
												pack.DropItem(item);
											// could call applyobjectstringproperties on a nested propertylist here to set item attributes
											if (itemargstring != null)
											{
												ApplyObjectStringProperties(spawner, itemargstring, item, trigmob, refobject, out status_str);
											}
										}</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (item != null)
										{
											if (equip && m != null)
											{
												if (!m.EquipItem(item)) pack.DropItem(item);
											}
											else
												pack.DropItem(item);
											// could call applyobjectstringproperties on a nested propertylist here to set item attributes
											if (itemargstring != null)
											{
												ApplyObjectStringProperties(spawner, itemargstring, item, trigmob, refobject, out status_str);
											}
										}</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SHTelGenDelete.cs

<pre>this.AddSHTCouple(false, 5727, 1894, 0, false, 5756, 1794, 0);
                this.AddSHTCouple(false, 5784, 1929, 0, false, 5700, 1929, 0);

                tele1 = this.AddSHT(Map.Trammel, false, 5711, 1952, 0);</pre>

Fragment 2 in file Scripts\Items\Addons\SHTeleporter.cs

<pre>this.AddSHTCouple(false, 5727, 1894, 0, false, 5756, 1794, 0);
                this.AddSHTCouple(false, 5784, 1929, 0, false, 5700, 1929, 0);

                tele1 = this.AddSHT(Map.Trammel, false, 5711, 1952, 0);</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\CrashGuard.cs

<pre>private static void CopyFile(string rootOrigin, string rootBackup, string path)
        {
            string originPath = Combine(rootOrigin, path);
            string backupPath = Combine(rootBackup, path);

            try
            {
                if (File.Exists(originPath))
                    File.Copy(originPath, backupPath);
            }
            catch
            {
            }
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>private static void CopyFile(string rootOrigin, string rootBackup, string path)
			{
				string originPath = Combine(rootOrigin, path);
				string backupPath = Combine(rootBackup, path);

				try
				{
					if (File.Exists(originPath))
						File.Copy(originPath, backupPath);
				}
				catch
				{
				}
			}</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Chiikkaha.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 40, 45);
            this.SetResistance(ResistanceType.Fire, 10, 20);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 10, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RatmanMage.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 40, 45);
            this.SetResistance(ResistanceType.Fire, 10, 20);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 10, 20);</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\CorporealBrume.cs

<pre>this.SetResistance(ResistanceType.Physical, 100);
            this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 50, 60);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

Fragment 2 in file Scripts\Mobiles\Void Creatures\Anlorzen.cs

<pre>this.SetResistance(ResistanceType.Physical, 40, 50);
            this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 30, 50);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 40, 60);</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Gregorio.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 10, 15);
            this.SetResistance(ResistanceType.Fire, 10, 15);
            this.SetResistance(ResistanceType.Poison, 10, 15);
            this.SetResistance(ResistanceType.Energy, 10, 15);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\MercutioTheUnsavory.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 10, 15);
            this.SetResistance(ResistanceType.Fire, 10, 15);
            this.SetResistance(ResistanceType.Poison, 10, 15);
            this.SetResistance(ResistanceType.Energy, 10, 15);</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\MeerMage.cs

<pre>this.SetSkill(SkillName.EvalInt, 100.0);
            this.SetSkill(SkillName.Magery, 70.1, 80.0);
            this.SetSkill(SkillName.Meditation, 85.1, 95.0);
            this.SetSkill(SkillName.MagicResist, 80.1, 100.0);
            this.SetSkill(SkillName.Tactics, 70.1, 90.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ShadowDweller.cs

<pre>this.SetSkill(SkillName.EvalInt, 100.0);
            this.SetSkill(SkillName.Magery, 70.1, 80.0);
            this.SetSkill(SkillName.Meditation, 85.1, 95.0);
            this.SetSkill(SkillName.MagicResist, 80.1, 100.0);
            this.SetSkill(SkillName.Tactics, 70.1, 90.0);</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Minotaur.cs

<pre>this.Fame = 5000;
            this.Karma = -5000;

            this.VirtualArmor = 28; // Don't know what it should be

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\MinotaurScout.cs

<pre>this.Fame = 5000;
            this.Karma = -5000;

            this.VirtualArmor = 28; // Don't know what it should be

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\GBBigglesby.cs

<pre>if (quest.Completed)
                    {
                        quest.OnCompleted();
                        pm.SendGump(new MondainQuestGump(quest, MondainQuestGump.Section.Complete, false, true));
                    }
                    else
                    {
                        pm.SendGump(new MondainQuestGump(quest, MondainQuestGump.Section.InProgress, false));
                        quest.InProgress();
                    }

                    return true;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\ProfessionalBountyQuest.cs

<pre>if(quest.Completed)
                   {
                       quest.OnCompleted();
                       pm.SendGump( new MondainQuestGump( quest, MondainQuestGump.Section.Complete, false, true ) );
                   }
                   else
                   {
                       pm.SendGump( new MondainQuestGump( quest, MondainQuestGump.Section.InProgress, false ) );
                       quest.InProgress();
                   }

                   return true;</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Gumps\FinanceGump.cs

<pre>this.m_From = from;
            this.m_Faction = faction;
            this.m_Town = town;

            this.AddPage(0);

            this.AddBackground(0, 0, 320, 410, 5054);
            this.AddBackground(10, 10, 300, 390, 3000);

            #region General
            this.AddPage(1);</pre>

Fragment 2 in file Scripts\Services\Factions\Gumps\SheriffGump.cs

<pre>this.m_From = from;
            this.m_Faction = faction;
            this.m_Town = town;

            this.AddPage(0);

            this.AddBackground(0, 0, 320, 410, 5054);
            this.AddBackground(10, 10, 300, 390, 3000);

            #region General
            this.AddPage(1);</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Ultima\TileData.cs

<pre>m_Weight = mulstruct.weight;
			m_Quality = mulstruct.quality;
			m_Quantity = mulstruct.quantity;
			m_Value = mulstruct.value;
			m_Height = mulstruct.height;
			m_Animation = mulstruct.anim;
			m_Hue = mulstruct.hue;
			m_StackOffset = mulstruct.stackingoffset;
			m_MiscData = mulstruct.miscdata;
			m_Unk2 = mulstruct.unk2;
			m_Unk3 = mulstruct.unk3;</pre>

Fragment 2 in file Ultima\TileData.cs

<pre>m_Weight = mulstruct.weight;
			m_Quality = mulstruct.quality;
			m_Quantity = mulstruct.quantity;
			m_Value = mulstruct.value;
			m_Height = mulstruct.height;
			m_Animation = mulstruct.anim;
			m_Hue = mulstruct.hue;
			m_StackOffset = mulstruct.stackingoffset;
			m_MiscData = mulstruct.miscdata;
			m_Unk2 = mulstruct.unk2;
			m_Unk3 = mulstruct.unk3;</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Camps\BankerCamp.cs

<pre>BaseDoor west, east;

            this.AddItem(west = new LightWoodGate(DoorFacing.WestCW), -4, 4, 7);
            this.AddItem(east = new LightWoodGate(DoorFacing.EastCCW), -3, 4, 7);

            west.Link = east;
            east.Link = west;</pre>

Fragment 2 in file Scripts\Multis\Camps\HealerCamp.cs

<pre>BaseDoor west, east;

            this.AddItem(west = new LightWoodGate(DoorFacing.WestCW), -4, 4, 7);
            this.AddItem(east = new LightWoodGate(DoorFacing.EastCCW), -3, 4, 7);

            west.Link = east;
            east.Link = west;</pre>

Fragment 3 in file Scripts\Multis\Camps\MageCamp.cs

<pre>BaseDoor west, east;

            this.AddItem(west = new LightWoodGate(DoorFacing.WestCW), -4, 4, 7);
            this.AddItem(east = new LightWoodGate(DoorFacing.EastCCW), -3, 4, 7);

            west.Link = east;
            east.Link = west;</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>Mobile from = this;
			Item item = from.Holding;

			bool valid = (item != null && item.HeldBy == from && item.Map == Map.Internal);

			from.Holding = null;

			if (!valid)
			{
				return false;
			}

			bool bounced = true;

			item.SetLastMoved();</pre>

Fragment 2 in file Server\Mobile.cs

<pre>Mobile from = this;
			Item item = from.Holding;

			bool valid = (item != null && item.HeldBy == from && item.Map == Map.Internal);

			from.Holding = null;

			if (!valid)
			{
				return false;
			}

			bool bounced = true;

			item.SetLastMoved();</pre>

Fragment 3 in file Server\Mobile.cs

<pre>Mobile from = this;
			Item item = from.Holding;

			bool valid = (item != null && item.HeldBy == from && item.Map == Map.Internal);

			from.Holding = null;

			if (!valid)
			{
				return false;
			}

			bool bounced = true;

			item.SetLastMoved();</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>var eable = m_Map.GetClientsInRange(m_Location);

				foreach (NetState state in eable)
				{
					if (state.Mobile.CanSee(this) && (noLineOfSight || state.Mobile.InLOS(this)))
					{
						state.Send(p);
					}
				}

				Packet.Release(p);

				eable.Free();</pre>

Fragment 2 in file Server\Mobile.cs

<pre>var eable = m_Map.GetClientsInRange(m_Location);

				foreach (NetState state in eable)
				{
					if (state.Mobile.CanSee(this) && (noLineOfSight || state.Mobile.InLOS(this)))
					{
						state.Send(p);
					}
				}

				Packet.Release(p);

				eable.Free();</pre>

Fragment 3 in file Server\Mobile.cs

<pre>var eable = m_Map.GetClientsInRange(m_Location);

				foreach (NetState state in eable)
				{
					if (state.Mobile.CanSee(this) && (noLineOfSight || state.Mobile.InLOS(this)))
					{
						state.Send(p);
					}
				}

				Packet.Release(p);

				eable.Free();</pre>

## Duplicated Code. Size: 121

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>break;

				case 100:

					// add to Participants
					if (m_gauntlet.Participants == null)
						m_gauntlet.Participants = new ArrayList();

					if (MaxTeamSize > 0 && m_gauntlet.Participants.Count >= MaxTeamSize)
					{
						XmlPoints.SendText(state.Mobile, 100535);     // "Challenge is full!"
					}
					else
					{
						state.Mobile.Target = new MemberTarget(m_gauntlet, m_gauntlet.Participants);
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>break;

                case 100:

                    // add to Participants
                    if(m_gauntlet.Participants == null)
                        m_gauntlet.Participants = new ArrayList();

                    if(MaxTeamSize > 0 && m_gauntlet.Participants.Count >= MaxTeamSize)
                    {
                        XmlPoints.SendText(state.Mobile, 100535);     // "Challenge is full!"
                    } else
                    {
                        state.Mobile.Target = new MemberTarget(m_gauntlet, m_gauntlet.Participants);
                    }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>break;

                case 100:

                    // add to Participants
                    if(m_gauntlet.Participants == null)
                        m_gauntlet.Participants = new ArrayList();

                    if(MaxTeamSize > 0 && m_gauntlet.Participants.Count >= MaxTeamSize)
                    {
                        XmlPoints.SendText(state.Mobile, 100535);     // "Challenge is full!"
                    } else
                    {
                        state.Mobile.Target = new MemberTarget(m_gauntlet, m_gauntlet.Participants);
                    }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>break;

                case 100:

                    // add to Participants
                    if(m_gauntlet.Participants == null)
                        m_gauntlet.Participants = new ArrayList();

                    if(MaxTeamSize > 0 && m_gauntlet.Participants.Count >= MaxTeamSize)
                    {
                        XmlPoints.SendText(state.Mobile, 100535);     // "Challenge is full!"
                    } else
                    {
                        state.Mobile.Target = new MemberTarget(m_gauntlet, m_gauntlet.Participants);
                    }</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>break;

                case 100:

                    // add to Participants
                    if(m_gauntlet.Participants == null)
                        m_gauntlet.Participants = new ArrayList();

                    if(MaxTeamSize > 0 && m_gauntlet.Participants.Count >= MaxTeamSize)
                    {
                        XmlPoints.SendText(state.Mobile, 100535);     // "Challenge is full!"
                    } else
                    {
                        state.Mobile.Target = new MemberTarget(m_gauntlet, m_gauntlet.Participants);
                    }</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>break;

                case 100:

                    // add to Participants
                    if(m_gauntlet.Participants == null)
                        m_gauntlet.Participants = new ArrayList();

                    if(MaxTeamSize > 0 && m_gauntlet.Participants.Count >= MaxTeamSize)
                    {
                        XmlPoints.SendText(state.Mobile, 100535);     // "Challenge is full!"
                    } else
                    {
                        state.Mobile.Target = new MemberTarget(m_gauntlet, m_gauntlet.Participants);
                    }</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>break;

                case 100:

                    // add to Participants
                    if(m_gauntlet.Participants == null)
                        m_gauntlet.Participants = new ArrayList();

                    if(MaxTeamSize > 0 && m_gauntlet.Participants.Count >= MaxTeamSize)
                    {
                        XmlPoints.SendText(state.Mobile, 100535);     // "Challenge is full!"
                    } else
                    {
                        state.Mobile.Target = new MemberTarget(m_gauntlet, m_gauntlet.Participants);
                    }</pre>

Fragment 8 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>break;

                case 100:

                    // add to Participants
                    if(m_gauntlet.Participants == null)
                        m_gauntlet.Participants = new ArrayList();

                    if(MaxTeamSize > 0 && m_gauntlet.Participants.Count >= MaxTeamSize)
                    {
                        XmlPoints.SendText(state.Mobile, 100535);     // "Challenge is full!"
                    } else
                    {
                        state.Mobile.Target = new MemberTarget(m_gauntlet, m_gauntlet.Participants);
                    }</pre>

Fragment 9 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>break;

                case 100:

                    // add to Participants
                    if(m_gauntlet.Participants == null)
                        m_gauntlet.Participants = new ArrayList();

                    if(MaxTeamSize > 0 && m_gauntlet.Participants.Count >= MaxTeamSize)
                    {
                        XmlPoints.SendText(state.Mobile, 100535);     // "Challenge is full!"
                    } else
                    {
                        state.Mobile.Target = new MemberTarget(m_gauntlet, m_gauntlet.Participants);
                    }</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\GuillotineComponent.cs

<pre>private void Activate(object obj)
        {
            object[] param = (object[])obj;

            if (param[0] is AddonComponent && param[1] is Mobile)
                this.Activate((AddonComponent)param[0], (Mobile)param[1]);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\IronMaiden.cs

<pre>private void Activate(object obj)
        {
            object[] param = (object[])obj;

            if (param[0] is AddonComponent && param[1] is Mobile)
                this.Activate((AddonComponent)param[0], (Mobile)param[1]);
        }</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\TreasureChestMod.cs

<pre>for( int i = Utility.Random( 1, 2 ); i > 1; i-- )
				AddLoot( Loot.RandomClothing() );

			for( int i = Utility.Random( 1, 2 ); i > 1; i-- )
                AddLoot(Loot.RandomJewelry());</pre>

Fragment 2 in file Scripts\Items\Containers\TreasureChestMod.cs

<pre>for( int i = Utility.Random( 1, 2 ); i > 1; i-- )
				AddLoot( Loot.RandomClothing() );

			for( int i = Utility.Random( 1, 2 ); i > 1; i-- )
				AddLoot( Loot.RandomJewelry() );</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if (GetSaveFlag(sflags, SetFlag.LastEquipped))
                            this.m_LastEquipped = reader.ReadBool();

                        if (GetSaveFlag(sflags, SetFlag.SetEquipped))
                            this.m_SetEquipped = reader.ReadBool();

                        if (GetSaveFlag(sflags, SetFlag.SetSelfRepair))
                            this.m_SetSelfRepair = reader.ReadEncodedInt();

                        goto case 5;</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if (GetSaveFlag(sflags, SetFlag.LastEquipped))
                            this.m_LastEquipped = reader.ReadBool();

                        if (GetSaveFlag(sflags, SetFlag.SetEquipped))
                            this.m_SetEquipped = reader.ReadBool();

                        if (GetSaveFlag(sflags, SetFlag.SetSelfRepair))
                            this.m_SetSelfRepair = reader.ReadEncodedInt();
                        #endregion

                        goto case 5;</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GargoyleDestroyer.cs

<pre>public void ThrowHatchet(Mobile to)
        {
            int damage = 50;
            this.MovingEffect(to, 0xF43, 10, 0, false, false);
            this.DoHarmful(to);
            AOS.Damage(to, this, damage, 100, 0, 0, 0, 0);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GargoyleGuardian.cs

<pre>public void ThrowHatchet(Mobile to)
        {
            int damage = 50;
            this.MovingEffect(to, 0xF43, 10, 0, false, false);
            this.DoHarmful(to);
            AOS.Damage(to, this, damage, 100, 0, 0, 0, 0);
        }</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\PlagueSpawn.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            for (int i = 0; i < list.Count; ++i)
            {
                if (list[i] is ContextMenus.PaperdollEntry)
                    list.RemoveAt(i--);
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RestlessSoul.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            for (int i = 0; i < list.Count; ++i)
            {
                if (list[i] is ContextMenus.PaperdollEntry)
                    list.RemoveAt(i--);
            }
        }</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Aelorn.cs

<pre>this.AddItem(new PlateChest());
            this.AddItem(new PlateLegs());
            this.AddItem(new PlateGloves());
            this.AddItem(new PlateArms());
            this.AddItem(new PlateGorget());
            this.AddItem(new OrderShield());</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Jockles.cs

<pre>this.AddItem(new PlateChest());
            this.AddItem(new PlateLegs());
            this.AddItem(new PlateGloves());
            this.AddItem(new PlateArms());
            this.AddItem(new PlateGorget());
            this.AddItem(new OrderShield());</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\LargeBODAcceptGump.cs

<pre>this.AddHtmlLocalized(40, 48, 350, 20, 1045135, 0x7FFF, false, false); // Ah!  Thanks for the goods!  Would you help me out?

            this.AddHtmlLocalized(40, 72, 210, 20, 1045138, 0x7FFF, false, false); // Amount to make:
            this.AddLabel(250, 72, 1152, deed.AmountMax.ToString());</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallBODAcceptGump.cs

<pre>this.AddHtmlLocalized(40, 48, 350, 20, 1045135, 0x7FFF, false, false); // Ah!  Thanks for the goods!  Would you help me out?

            this.AddHtmlLocalized(40, 72, 210, 20, 1045138, 0x7FFF, false, false); // Amount to make:
            this.AddLabel(250, 72, 1152, deed.AmountMax.ToString());</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Trading\TradeSystem.cs

<pre>if ((surface || impassable) && (staticTiles[i].Z + id.CalcHeight) > z && (z + height) > staticTiles[i].Z)
                    return false;
                else if (surface && !impassable && z == (staticTiles[i].Z + id.CalcHeight))
                    hasSurface = true;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>if ((surface || impassable) && (staticTiles[i].Z + id.CalcHeight) > z && (z + height) > staticTiles[i].Z)
					return false;
				else if (surface && !impassable && z == (staticTiles[i].Z + id.CalcHeight))
					hasSurface = true;</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Mobiles\BaseSeaChampion.cs

<pre>public void GiveArtifact(Mobile to, Item artifact)
        {
            if (to == null || artifact == null)
                return;

            Container pack = to.Backpack;

            if (pack == null || !pack.TryDropItem(to, artifact, false))
                artifact.Delete();
            else
                to.SendLocalizedMessage(1062317); // For your valor in combating the fallen beast, a special artifact has been bestowed on you.
        }</pre>

Fragment 2 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>public void GiveArtifact(Mobile to, Item artifact)
        {
            if (to == null || artifact == null)
                return;

            Container pack = to.Backpack;

            if (pack == null || !pack.TryDropItem(to, artifact, false))
                artifact.Delete();
            else
                to.SendLocalizedMessage(1062317); // For your valor in combating the fallen beast, a special artifact has been bestowed on you.
        }</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\ExodusSacrificalDagger.cs

<pre>RobeofRite robe = from.FindItemOnLayer(Layer.OuterTorso) as RobeofRite;
            ExodusSacrificalDagger dagger = from.FindItemOnLayer(Layer.OneHanded) as ExodusSacrificalDagger;

            bool alter = false;

            foreach (Item item in GetItemsInRange(5))
            {
                if (item is ExodusTomeAltar)
                {
                    alter = true;
                    break;
                }
            }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\ExodusSummoningRite.cs

<pre>RobeofRite robe = from.FindItemOnLayer(Layer.OuterTorso) as RobeofRite;
                ExodusSacrificalDagger dagger = from.FindItemOnLayer(Layer.OneHanded) as ExodusSacrificalDagger;

                bool alter = false;

                foreach (Item item in GetItemsInRange(5))
                {
                    if (item is ExodusTomeAltar)
                    {
                        alter = true;
                        break;
                    }
                }</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\StaffRunebook\Rune.cs

<pre>public void FindCounts()
        {
            int runebookCount = 0, runeCount = 0;
            for (int i = 0; i < this.Runes.Count; i++)
                if (this.Runes[i].IsRunebook)
                    runebookCount++;
                else
                    runeCount++;

            this.RunebookCount = runebookCount;
            this.RuneCount = runeCount;
        }</pre>

Fragment 2 in file Scripts\Services\StaffRunebook\RuneAccount.cs

<pre>public void FindCounts()
        {
            int runebookCount = 0, runeCount = 0;
            for (int i = 0; i < this.Runes.Count; i++)
                if (this.Runes[i].IsRunebook)
                    runebookCount++;
                else
                    runeCount++;

            this.RunebookCount = runebookCount;
            this.RuneCount = runeCount;
        }</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if ((andposition > 0 && orposition <= 0) || (andposition > 0 && andposition < orposition))
				{
					// and operator
					return (first && second);
				}
				else
					if ((orposition > 0 && andposition <= 0) || (orposition > 0 && orposition < andposition))
					{
						// or operator
						return (first || second);
					}
					else
					{
						// should never get here
						return false;
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if ((andposition > 0 && orposition <= 0) || (andposition > 0 && andposition < orposition))
				{
					// and operator
					return (first && second);
				}
				else if ((orposition > 0 && andposition <= 0) || (orposition > 0 && orposition < andposition))
				{
					// or operator
					return (first || second);
				}
				else
				{
					// should never get here
					return false;
				}</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlLevelItem\ItemExperienceGump.cs

<pre>{
								attrvalue = ((BaseJewel)m_Item).Resistances[LevelAttributes.m_ElementAttributes[index].m_Attribute];
								if (attrvalue < LevelAttributes.m_ElementAttributes[index].m_MaxValue)
								{
                            		((BaseJewel)m_Item).Resistances[LevelAttributes.m_ElementAttributes[index].m_Attribute] += 1;
                            		levitem.Points -= cost;
								}
							}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlLevelItem\ItemExperienceGump.cs

<pre>{
								attrvalue = ((BaseClothing)m_Item).Resistances[LevelAttributes.m_ElementAttributes[index].m_Attribute];
								if (attrvalue < LevelAttributes.m_ElementAttributes[index].m_MaxValue)
								{
                            		((BaseClothing)m_Item).Resistances[LevelAttributes.m_ElementAttributes[index].m_Attribute] += 1;
                            		levitem.Points -= cost;
								}
							}</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Ultima\Art.cs

<pre>if (m_Removed[index])
			{
				return false;
			}
			if (m_Cache[index] != null)
			{
				return true;
			}

			int length, extra;
			bool patched;
			Stream stream = m_FileIndex.Seek(index, out length, out extra, out patched);

			if (stream == null)
			{
				return false;
			}</pre>

Fragment 2 in file Ultima\Light.cs

<pre>if (m_Removed[index])
			{
				return false;
			}
			if (m_Cache[index] != null)
			{
				return true;
			}

			int length, extra;
			bool patched;

			Stream stream = m_FileIndex.Seek(index, out length, out extra, out patched);

			if (stream == null)
			{
				return false;
			}</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ChampionSystem\ChampionAltar.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_Spawn = reader.ReadItem() as ChampionSpawn;

                        if (this.m_Spawn == null)
                            this.Delete();

                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Services\ChampionSystem\ChampionPlatform.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_Spawn = reader.ReadItem() as ChampionSpawn;

                        if (this.m_Spawn == null)
                            this.Delete();

                        break;
                    }
            }
        }</pre>

Fragment 3 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_Spawn = reader.ReadItem() as ChampionSpawn;

                        if (this.m_Spawn == null)
                            this.Delete();

                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\FukiyaDarts.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_UsesRemaining);

            Poison.Serialize(this.m_Poison, writer);
            writer.Write((int)this.m_PoisonCharges);
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\Shuriken.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_UsesRemaining);

            Poison.Serialize(this.m_Poison, writer);
            writer.Write((int)this.m_PoisonCharges);
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Clothing\LeatherNinjaBelt.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);

            writer.Write((int)this.m_UsesRemaining);

            Poison.Serialize(this.m_Poison, writer);
            writer.Write((int)this.m_PoisonCharges);
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Weapons\Fukiya.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);

            writer.Write((int)this.m_UsesRemaining);

            Poison.Serialize(this.m_Poison, writer);
            writer.Write((int)this.m_PoisonCharges);
        }</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlLevelItem\ItemExperienceGump.cs

<pre>{
								attrvalue = ((BaseWeapon)m_Item).Attributes[LevelAttributes.m_Attributes[index].m_Attribute];
								if (attrvalue < LevelAttributes.m_Attributes[index].m_MaxValue)
								{
									((BaseWeapon)m_Item).Attributes[LevelAttributes.m_Attributes[index].m_Attribute] += 1;
									levitem.Points -= cost;
								}
							}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlLevelItem\ItemExperienceGump.cs

<pre>{
								attrvalue = ((BaseArmor)m_Item).Attributes[LevelAttributes.m_Attributes[index].m_Attribute];
								if (attrvalue < LevelAttributes.m_Attributes[index].m_MaxValue)
								{
									((BaseArmor)m_Item).Attributes[LevelAttributes.m_Attributes[index].m_Attribute] += 1;
									levitem.Points -= cost;
								}
							}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlLevelItem\ItemExperienceGump.cs

<pre>{
								attrvalue = ((BaseJewel)m_Item).Attributes[LevelAttributes.m_Attributes[index].m_Attribute];
								if (attrvalue < LevelAttributes.m_Attributes[index].m_MaxValue)
								{
									((BaseJewel)m_Item).Attributes[LevelAttributes.m_Attributes[index].m_Attribute] += 1;
									levitem.Points -= cost;
								}
							}</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlLevelItem\ItemExperienceGump.cs

<pre>{
								attrvalue = ((BaseClothing)m_Item).Attributes[LevelAttributes.m_Attributes[index].m_Attribute];
								if (attrvalue < LevelAttributes.m_Attributes[index].m_MaxValue)
								{
									((BaseClothing)m_Item).Attributes[LevelAttributes.m_Attributes[index].m_Attribute] += 1;
									levitem.Points -= cost;
								}
							}</pre>

## Duplicated Code. Size: 120

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\DuelContextGump.cs

<pre>public void AddGoldenButton(int x, int y, int bid)
        {
            this.AddButton(x, y, 0xD2, 0xD2, bid, GumpButtonType.Reply, 0);
            this.AddButton(x + 3, y + 3, 0xD8, 0xD8, bid, GumpButtonType.Reply, 0);
        }</pre>

Fragment 2 in file Scripts\Services\ConPVP\ParticipantGump.cs

<pre>public void AddGoldenButton(int x, int y, int bid)
        {
            this.AddButton(x, y, 0xD2, 0xD2, bid, GumpButtonType.Reply, 0);
            this.AddButton(x + 3, y + 3, 0xD8, 0xD8, bid, GumpButtonType.Reply, 0);
        }</pre>

Fragment 3 in file Scripts\Services\ConPVP\ReadyUpGump.cs

<pre>public void AddGoldenButton(int x, int y, int bid)
        {
            this.AddButton(x, y, 0xD2, 0xD2, bid, GumpButtonType.Reply, 0);
            this.AddButton(x + 3, y + 3, 0xD8, 0xD8, bid, GumpButtonType.Reply, 0);
        }</pre>

Fragment 4 in file Scripts\Services\ConPVP\RulesetGump.cs

<pre>public void AddGoldenButton(int x, int y, int bid)
        {
            this.AddButton(x, y, 0xD2, 0xD2, bid, GumpButtonType.Reply, 0);
            this.AddButton(x + 3, y + 3, 0xD8, 0xD8, bid, GumpButtonType.Reply, 0);
        }</pre>

Fragment 5 in file Scripts\Services\ConPVP\Tournament.cs

<pre>public void AddGoldenButton(int x, int y, int bid)
        {
            this.AddButton(x, y, 0xD2, 0xD2, bid, GumpButtonType.Reply, 0);
            this.AddButton(x + 3, y + 3, 0xD8, 0xD8, bid, GumpButtonType.Reply, 0);
        }</pre>

## Duplicated Code. Size: 119

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>public static Item FindByID(int id)
        {
            if (m_List == null)
                return null;

            for (int j = 0; j < m_List.Count; ++j)
            {
                DecorationList list = (DecorationList)m_List[j];

                if (list.ID == id)
                    return list.Constructed;
            }

            return null;
        }</pre>

Fragment 2 in file Scripts\Commands\DecorateDelete.cs

<pre>public static Item FindByID(int id)
        {
            if (m_List == null)
                return null;

            for (int j = 0; j < m_List.Count; ++j)
            {
                DecorationList list = (DecorationList)m_List[j];

                if (list.ID == id)
                    return list.Constructed;
            }

            return null;
        }</pre>

## Duplicated Code. Size: 119

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\TrashBarrel.cs

<pre>if (this.TotalItems >= 50)
            {
                this.Empty(501478); // The trash is full!  Emptying!
            }
            else
            {
                this.SendLocalizedMessageTo(from, 1010442); // The item will be deleted in three minutes

                if (this.m_Timer != null)
                    this.m_Timer.Stop();
                else
                    this.m_Timer = new EmptyTimer(this);

                this.m_Timer.Start();
            }

            return true;</pre>

Fragment 2 in file Scripts\Items\Containers\TrashBarrel.cs

<pre>if (this.TotalItems >= 50)
            {
                this.Empty(501478); // The trash is full!  Emptying!
            }
            else
            {
                this.SendLocalizedMessageTo(from, 1010442); // The item will be deleted in three minutes

                if (this.m_Timer != null)
                    this.m_Timer.Stop();
                else
                    this.m_Timer = new EmptyTimer(this);

                this.m_Timer.Start();
            }

            return true;</pre>

## Duplicated Code. Size: 119

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>bool isOwner = (from == m_Mobile.ControlMaster);
			bool isFriend = (!isOwner && m_Mobile.IsPetFriend(from));

			if (!isOwner && !isFriend)
			{
				return;
			}
			else if (isFriend && order != OrderType.Follow && order != OrderType.Stay && order != OrderType.Stop)
			{
				return;
			}</pre>

Fragment 2 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>bool isOwner = (from == m_Mobile.ControlMaster);
			bool isFriend = (!isOwner && m_Mobile.IsPetFriend(from));

			if (!isOwner && !isFriend)
			{
				return;
			}
			else if (isFriend && order != OrderType.Follow && order != OrderType.Stay && order != OrderType.Stop)
			{
				return;
			}</pre>

## Duplicated Code. Size: 119

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Mongbat.cs

<pre>this.Name = "a mongbat";
            this.Body = 39;
            this.BaseSoundID = 422;

            this.SetStr(6, 10);
            this.SetDex(26, 38);
            this.SetInt(6, 14);

            this.SetHits(4, 6);
            this.SetMana(0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\StrongMongbat.cs

<pre>this.Name = "a mongbat";
            this.Body = 39;
            this.BaseSoundID = 422;

            this.SetStr(6, 10);
            this.SetDex(26, 38);
            this.SetInt(6, 14);

            this.SetHits(4, 6);
            this.SetMana(0);</pre>

## Duplicated Code. Size: 119

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\HireMage.cs

<pre>this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();
            this.Race.RandomFacialHair(this);

            this.SetStr(61, 75);
            this.SetDex(81, 95);
            this.SetInt(86, 100);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HireThief.cs

<pre>this.HairItemID = this.Race.RandomHair(this.Female);
            this.HairHue = this.Race.RandomHairHue();
            this.Race.RandomFacialHair(this);

            this.SetStr(81, 95);
            this.SetDex(86, 100);
            this.SetInt(61, 75);</pre>

## Duplicated Code. Size: 119

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BasketWeaving\NaturalDye.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public PlantPigmentHue PigmentHue
        {
            get
            {
                return this.m_Hue;
            }
            set
            {
                this.m_Hue = value;
                // set any invalid pigment hue to Plain
                if (this.m_Hue != PlantPigmentHueInfo.GetInfo(this.m_Hue).PlantPigmentHue)
                    this.m_Hue = PlantPigmentHue.Plain;
                this.Hue = PlantPigmentHueInfo.GetInfo(this.m_Hue).Hue;
                this.InvalidateProperties();
            }
        }</pre>

Fragment 2 in file Scripts\Services\BasketWeaving\PlantPigment.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public PlantPigmentHue PigmentHue
        {
            get
            {
                return this.m_Hue;
            }
            set
            {
                this.m_Hue = value;
                //set any invalid pigment hue to Plain
                if (this.m_Hue != PlantPigmentHueInfo.GetInfo(this.m_Hue).PlantPigmentHue)
                    this.m_Hue = PlantPigmentHue.Plain;
                this.Hue = PlantPigmentHueInfo.GetInfo(this.m_Hue).Hue;
                this.InvalidateProperties();
            }
        }</pre>

## Duplicated Code. Size: 119

### Duplicated Fragments:

Fragment 1 in file Ultima\Gumps.cs

<pre>if (m_Removed[index])
			{
				return null;
			}
			if (m_Cache[index] != null)
			{
				return m_Cache[index];
			}
			int length, extra;
			Stream stream = m_FileIndex.Seek(index, out length, out extra, out patched);
			if (stream == null)
			{
				return null;
			}</pre>

Fragment 2 in file Ultima\Textures.cs

<pre>if (m_Removed[index])
			{
				return null;
			}
			if (m_Cache[index] != null)
			{
				return m_Cache[index];
			}

			int length, extra;
			Stream stream = m_FileIndex.Seek(index, out length, out extra, out patched);
			if (stream == null)
			{
				return null;
			}</pre>

## Duplicated Code. Size: 119

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\AOS.cs

<pre>public int ExtendedGetValue(int bitmask)
        {
            int value = this.GetValue(bitmask);

            XmlAosAttributes xaos = (XmlAosAttributes)XmlAttach.FindAttachment(this.Owner, typeof(XmlAosAttributes));

            if (xaos != null)
            {
                value += xaos.GetValue(bitmask);
            }

            return (value);
        }</pre>

Fragment 2 in file Scripts\Misc\AOS.cs

<pre>public int ExtendedGetValue(int bitmask)
        {
            int value = this.GetValue(bitmask);

            XmlAosAttributes xaos = (XmlAosAttributes)XmlAttach.FindAttachment(this.Owner, typeof(XmlAosAttributes));

            if (xaos != null)
            {
                value += xaos.GetValue(bitmask);
            }

            return (value);
        }</pre>

Fragment 3 in file Scripts\Misc\AOS.cs

<pre>public int ExtendedGetValue(int bitmask)
        {
            int value = this.GetValue(bitmask);

            XmlAosAttributes xaos = (XmlAosAttributes)XmlAttach.FindAttachment(this.Owner, typeof(XmlAosAttributes));

            if (xaos != null)
            {
                value += xaos.GetValue(bitmask);
            }

            return (value);
        }</pre>

Fragment 4 in file Scripts\Misc\AOS.cs

<pre>public int ExtendedGetValue(int bitmask)
        {
            int value = this.GetValue(bitmask);

            XmlAosAttributes xaos = (XmlAosAttributes)XmlAttach.FindAttachment(this.Owner, typeof(XmlAosAttributes));

            if (xaos != null)
            {
                value += xaos.GetValue(bitmask);
            }

            return (value);
        }</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\LightningArrow.cs

<pre>if (!this.Validate(attacker))
                return;

            ClearCurrentAbility(attacker);

            Map map = attacker.Map;

            if (map == null)
                return;

            BaseWeapon weapon = attacker.Weapon as BaseWeapon;

            if (weapon == null)
                return;

            if (!this.CheckMana(attacker, true))
                return;</pre>

Fragment 2 in file Scripts\Abilities\WhirlwindAttack.cs

<pre>if (!this.Validate(attacker))
                return;

            ClearCurrentAbility(attacker);

            Map map = attacker.Map;

            if (map == null)
                return;

            BaseWeapon weapon = attacker.Weapon as BaseWeapon;

            if (weapon == null)
                return;

            if (!this.CheckMana(attacker, true))
                return;</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\GuildListGump.cs

<pre>this.m_Mobile = from;
            this.m_Guild = guild;

            this.Dragable = false;

            this.AddPage(0);
            this.AddBackground(0, 0, 550, 440, 5054);
            this.AddBackground(10, 10, 530, 420, 3000);

            this.Design();</pre>

Fragment 2 in file Scripts\Gumps\Guilds\GuildMobileListGump.cs

<pre>this.m_Mobile = from;
            this.m_Guild = guild;

            this.Dragable = false;

            this.AddPage(0);
            this.AddBackground(0, 0, 550, 440, 5054);
            this.AddBackground(10, 10, 530, 420, 3000);

            this.Design();</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetBodyGump.cs

<pre>this.AddHtml(x + 0, y - 1, 108, 21, this.Center(entry.DisplayName), false, false);
                    this.AddHtml(x + 0, y + 1, 108, 21, this.Center(entry.DisplayName), false, false);</pre>

Fragment 2 in file Scripts\Gumps\Properties\SetBodyGump.cs

<pre>this.AddHtml(x - 1, y + 0, 108, 21, this.Center(entry.DisplayName), false, false);
                    this.AddHtml(x + 1, y + 0, 108, 21, this.Center(entry.DisplayName), false, false);</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\BagOfNecromancerReagents.cs

<pre>{
            this.DropItem(new BatWing(amount));
            this.DropItem(new GraveDust(amount));
            this.DropItem(new DaemonBlood(amount));
            this.DropItem(new NoxCrystal(amount));
            this.DropItem(new PigIron(amount));
        }</pre>

Fragment 2 in file Scripts\Items\Containers\BagOfNecroReagents.cs

<pre>{
            this.DropItem(new BatWing(amount));
            this.DropItem(new GraveDust(amount));
            this.DropItem(new DaemonBlood(amount));
            this.DropItem(new NoxCrystal(amount));
            this.DropItem(new PigIron(amount));
        }</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x376A, 15, effHue, 0); //0x47D );
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 492);</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z + 1), m.Map, 0x376A, 15, effHue, 0); //0x47D );
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 492);</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>Point3D randomPoint = new Point3D(this.m_Mobile.X - teleRange + Utility.Random(teleRange * 2 + 1), this.m_Mobile.Y - teleRange + Utility.Random(teleRange * 2 + 1), 0);

                    LandTarget lt = new LandTarget(randomPoint, map);</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>Point3D randomPoint = new Point3D(this.m_Mobile.X - teleRange + Utility.Random(teleRange * 2 + 1), this.m_Mobile.Y - teleRange + Utility.Random(teleRange * 2 + 1), 0);

                    LandTarget lt = new LandTarget(randomPoint, map);</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>y += 8;
            this.AddImageTiled(32, y - 1, 264, 1, 9107);
            this.AddImageTiled(42, y + 1, 264, 1, 9157);
            y += 8;

            this.AddRadio(24, y, 9727, 9730, true, 1);</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>y += 8;
            this.AddImageTiled(32, y - 1, 264, 1, 9107);
            this.AddImageTiled(42, y + 1, 264, 1, 9157);
            y += 8;

            this.AddRadio(24, y, 9727, 9730, true, 1);</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GalleonPilot.cs

<pre>switch (Utility.Random(3))
                {
                    case 0: EquipItem(new FancyShirt(GetRandomHue())); break;
                    case 1: EquipItem(new Doublet(GetRandomHue())); break;
                    case 2: EquipItem(new Shirt(GetRandomHue())); break;
                }</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Mobiles\BaseBizaarBroker.cs

<pre>switch (Utility.Random(3))
			{
				case 0: EquipItem(new FancyShirt(GetRandomHue())); break;
				case 1: EquipItem(new Doublet(GetRandomHue())); break;
				case 2: EquipItem(new Shirt(GetRandomHue())); break;
			}</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Mobiles.cs

<pre>int x = this.X;
                int y = this.Y;

                Movement.Movement.Offset(d, ref x, ref y);

                Point3D p = new Point3D(x, y, this.Map.GetAverageZ(x, y));
                int z = p.Z;</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Mobiles.cs

<pre>int x = this.X;
                int y = this.Y;

                Movement.Movement.Offset(d, ref x, ref y);

                Point3D p = new Point3D(x, y, this.Map.GetAverageZ(x, y));
                int z = p.Z;</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\Region.cs

<pre>if (!IsInStartRegion(m.Location) && m is BaseCreature && !(m is DespiseCreature) && !(m is CorruptedWisp) && !(m is EnsorcledWisp) && (((BaseCreature)m).Controlled || ((BaseCreature)m).Summoned))
            {
                KickPet(m);
            }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\Region.cs

<pre>if (!IsInStartRegion(m.Location) && m is BaseCreature && !(m is DespiseCreature) && !(m is CorruptedWisp) && !(m is EnsorcledWisp) && (((BaseCreature)m).Controlled || ((BaseCreature)m).Summoned))
            {
                KickPet(m);
            }</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>int serial = -1;
										bool converterror = false;
										try { serial = Convert.ToInt32(itemkeywordargs[1], 16); }
										catch { status_str = "Invalid ITEM args : " + itemtypestr; converterror = true; }

										if (converterror) return false;

										Item item = World.FindItem(serial);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>int serial = -1;
									bool converterror = false;
									try { serial = Convert.ToInt32(itemkeywordargs[1], 16); }
									catch { status_str = "Invalid ITEM args : " + itemtypestr; converterror = true; }

									if (converterror) return false;

									Item item = World.FindItem(serial);</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>public void DisplayHighlight()
		{
			if(EItemID > 0)
			{
				 //SendOffsetTargetEffect(this, new Point3D(Location.X + EOffset.X, Location.Y + EOffset.Y, Location.Z + EOffset.Z), EItemID, 10, EDuration, EHue, 0);
				Effects.SendLocationEffect(new Point3D(Location.X + EOffset.X, Location.Y + EOffset.Y, Location.Z + EOffset.Z), Map, EItemID, EDuration, EHue, 0);

				lasteffect = DateTime.UtcNow;

			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>private void DisplayHighlight()
		{
			if(EItemID > 0)
			{
				Effects.SendLocationEffect(new Point3D(Location.X + EOffset.X, Location.Y + EOffset.Y, Location.Z + EOffset.Z), Map, EItemID, EDuration, EHue, 0);
				lasteffect = DateTime.UtcNow;
			}
		}</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\WriteMulti.cs

<pre>{
								int x = s.X - from.X;
								int y = s.Y - from.Y;
								int z = s.Z - from.Z;
								int ID = s.ID;
								op.WriteLine("{0} {1} {2} {3} {4}", ID, x, y, z, 1);
							}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\WriteMulti.cs

<pre>{
								int x = s.X - from.X;
								int y = s.Y - from.Y;
								int z = s.Z - from.Z;
								int ID = s.ID;
								op.WriteLine("{0} {1} {2} {3} {4}", ID, x, y, z, 1);
							}</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Server\Gumps\GumpHtmlLocalized.cs

<pre>{
					disp.AppendLayout( m_LayoutNamePlain );

					disp.AppendLayout( m_X );
					disp.AppendLayout( m_Y );
					disp.AppendLayout( m_Width );
					disp.AppendLayout( m_Height );
					disp.AppendLayout( m_Number );
					disp.AppendLayout( m_Background );
					disp.AppendLayout( m_Scrollbar );

					break;
				}</pre>

Fragment 2 in file Server\Gumps\KRGumpHtmlLocalized.cs

<pre>{
						disp.AppendLayout( m_LayoutNamePlain );
						disp.AppendLayout( m_X );
						disp.AppendLayout( m_Y );
						disp.AppendLayout( m_Width );
						disp.AppendLayout( m_Height );
						disp.AppendLayout( m_Number );
						disp.AppendLayout( m_Background );
						disp.AppendLayout( m_Scrollbar );

						break;
					}</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>{
			if (m_Enabled && max != 0)
			{
				stream.Write((short)m_Maximum);
				stream.Write((short)((cur * m_Maximum) / max));
			}
			else
			{
				stream.Write((short)max);
				stream.Write((short)cur);
			}
		}</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>{
			if (m_Enabled && max != 0)
			{
				stream.Write((short)((cur * m_Maximum) / max));
				stream.Write((short)m_Maximum);
			}
			else
			{
				stream.Write((short)cur);
				stream.Write((short)max);
			}
		}</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\AbyssalCloth.cs

<pre>public override void OnSingleClick(Mobile from)
        {
            int number = (this.Amount == 1) ? 1049124 : 1049123;

            from.Send(new MessageLocalized(this.Serial, this.ItemID, MessageType.Regular, 0x3B2, 3, number, "", this.Amount.ToString()));
        }</pre>

Fragment 2 in file Scripts\Items\Resource\Cloth.cs

<pre>public override void OnSingleClick(Mobile from)
        {
            int number = (this.Amount == 1) ? 1049124 : 1049123;

            from.Send(new MessageLocalized(this.Serial, this.ItemID, MessageType.Regular, 0x3B2, 3, number, "", this.Amount.ToString()));
        }</pre>

Fragment 3 in file Scripts\Items\Resource\UncutCloth.cs

<pre>public override void OnSingleClick(Mobile from)
        {
            int number = (this.Amount == 1) ? 1049124 : 1049123;

            from.Send(new MessageLocalized(this.Serial, this.ItemID, MessageType.Regular, 0x3B2, 3, number, "", this.Amount.ToString()));
        }</pre>

## Duplicated Code. Size: 118

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Mobiles\Corgul\SoulboundPirateRaider.cs

<pre>public override WeaponAbility GetWeaponAbility()
        {
            Item weapon = FindItemOnLayer(Layer.TwoHanded);

            if (weapon == null)
                return null;

            if (weapon is BaseWeapon)
            {
                if (Utility.RandomBool())
                    return ((BaseWeapon)weapon).PrimaryAbility;
                else
                    return ((BaseWeapon)weapon).SecondaryAbility;
            }
            return null;
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\MerchantCrew.cs

<pre>public override WeaponAbility GetWeaponAbility()
        {
            Item weapon = FindItemOnLayer(Layer.TwoHanded);

            if (weapon == null)
                return null;

            if (weapon is BaseWeapon)
            {
                if (Utility.RandomBool())
                    return ((BaseWeapon)weapon).PrimaryAbility;
                else
                    return ((BaseWeapon)weapon).SecondaryAbility;
            }
            return null;
        }</pre>

Fragment 3 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\PirateCrew.cs

<pre>public override WeaponAbility GetWeaponAbility()
        {
            Item weapon = FindItemOnLayer(Layer.TwoHanded);

            if (weapon == null)
                return null;

            if (weapon is BaseWeapon)
            {
                if (Utility.RandomBool())
                    return ((BaseWeapon)weapon).PrimaryAbility;
                else
                    return ((BaseWeapon)weapon).SecondaryAbility;
            }
            return null;
        }</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DoorGenDelete.cs

<pre>if (id > list[list.Length - 1])
                return false;

            for (int i = 0; i < list.Length; ++i)
            {
                int delta = id - list[i];

                if (delta < 0)
                    return false;
                else if (delta == 0)
                    return true;
            }</pre>

Fragment 2 in file Scripts\Commands\DoorGenerator.cs

<pre>if (id > list[list.Length - 1])
                return false;

            for (int i = 0; i < list.Length; ++i)
            {
                int delta = id - list[i];

                if (delta < 0)
                    return false;
                else if (delta == 0)
                    return true;
            }</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DisturbingPortrait.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (Utility.InRange(this.Location, from.Location, 2))
                Effects.PlaySound(this.Location, this.Map, Utility.RandomMinMax(0x567, 0x568));
            else
                from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
        }</pre>

Fragment 2 in file Scripts\Items\Addons\UnsettlingPortrait.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (Utility.InRange(this.Location, from.Location, 2))
                Effects.PlaySound(this.Location, this.Map, Utility.RandomMinMax(0x567, 0x568));
            else
                from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
        }</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseEvilCreatures.cs

<pre>private bool CanDoHeal(Mobile toHeal)
        {
            if (toHeal is DespiseCreature && ((DespiseCreature)toHeal).Alignment == Alignment)
                return true;

            return toHeal is PlayerMobile && ((toHeal.Karma < 0 && Alignment == Alignment.Evil) || (toHeal.Karma > 0 && Alignment == Alignment.Good));
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DespiseGoodCreatures.cs

<pre>private bool CanDoHeal(Mobile toHeal)
        {
            if (toHeal is DespiseCreature && ((DespiseCreature)toHeal).Alignment == Alignment)
                return true;

            return toHeal is PlayerMobile && ((toHeal.Karma < 0 && Alignment == Alignment.Evil) || (toHeal.Karma > 0 && Alignment == Alignment.Good));
        }</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\HouseFoundation.cs

<pre>int deflatedLength = m_DeflatedBuffer.Length;
                ZLibError ce = Compression.Pack(m_DeflatedBuffer, ref deflatedLength, inflatedBuffer, size, ZLibQuality.Default);

                if (ce != ZLibError.Okay)
                {
                    Console.WriteLine("ZLib error: {0} (#{1})", ce, (int)ce);
                    deflatedLength = 0;
                    size = 0;
                }</pre>

Fragment 2 in file Scripts\Multis\HouseFoundation.cs

<pre>int deflatedLength = m_DeflatedBuffer.Length;
                ZLibError ce = Compression.Pack(m_DeflatedBuffer, ref deflatedLength, inflatedBuffer, size, ZLibQuality.Default);

                if (ce != ZLibError.Okay)
                {
                    Console.WriteLine("ZLib error: {0} (#{1})", ce, (int)ce);
                    deflatedLength = 0;
                    size = 0;
                }</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>public override void OnClick()
			{
				Mobile from = Owner.From;

				if ( m_NPC == null || m_NPC.Deleted || !from.CheckAlive() || m_NPC.DialogAttachment == null )
					return;

				// process the talk text
				//m_NPC.DialogAttachment.ProcessSpeech(from, m_NPC.TalkText);
				from.DoSpeech(m_NPC.TalkText,new int[] {},MessageType.Regular,from.SpeechHue);
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>public override void OnClick()
			{
				Mobile from = Owner.From;

				if ( m_NPC == null || m_NPC.Deleted || !from.CheckAlive() || m_NPC.DialogAttachment == null )
					return;

				// process the talk text
				//m_NPC.DialogAttachment.ProcessSpeech(from, m_NPC.TalkText);
				from.DoSpeech(m_NPC.TalkText,new int[] {},MessageType.Regular,from.SpeechHue);
			}</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>DataSet ds = new DataSet(SpawnDataSetName);

			// Read in the file
			//ds.ReadXml( e.Arguments[0].ToString() );
			bool fileerror = false;
			try
			{
				ds.ReadXml(fs);
			}
			catch
			{
				if (from != null)
					from.SendMessage(33, "Error reading xml file {0}", filename); fileerror = true;
			}
			// close the file
			fs.Close();
			if (fileerror) return;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>DataSet ds = new DataSet(SpawnDataSetName);

			// Read in the file
			bool fileerror = false;
			try
			{
				ds.ReadXml(fs);
			}
			catch
			{
				if (from != null)
					from.SendMessage(33, "Error reading xml file {0}", filename);
				fileerror = true;
			}
			// close the file
			fs.Close();
			if (fileerror) return;</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\WriteMulti.cs

<pre>string dirname;
			if (System.IO.Directory.Exists(XmlSpawner.XmlSpawnDir) && filename != null && !filename.StartsWith("/") && !filename.StartsWith("\\"))
			{
				// put it in the defaults directory if it exists
				dirname = String.Format("{0}/{1}", XmlSpawner.XmlSpawnDir, filename);
			}
			else
			{
				// otherwise just put it in the main installation dir
				dirname = filename;
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>string dirname;
			if (System.IO.Directory.Exists(XmlSpawner.XmlSpawnDir) && filename != null && !filename.StartsWith("/") && !filename.StartsWith("\\"))
			{
				// put it in the defaults directory if it exists
				dirname = String.Format("{0}/{1}", XmlSpawner.XmlSpawnDir, filename);
			}
			else
			{
				// otherwise just put it in the main installation dir
				dirname = filename;
			}</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Discordance.cs

<pre>for (int i = 0; i < targ.Skills.Length; ++i)
								{
									if (targ.Skills[i].Value > 0)
									{
										mods.Add(new DefaultSkillMod((SkillName)i, true, targ.Skills[i].Value * scalar));
									}
								}</pre>

Fragment 2 in file Scripts\Skills\Discordance.cs

<pre>for (int i = 0; i < targ.Skills.Length; ++i)
								{
									if (targ.Skills[i].Value > 0)
									{
										mods.Add(new DefaultSkillMod((SkillName)i, true, targ.Skills[i].Value * scalar));
									}
								}</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Lumberjacking.cs

<pre>public override bool CheckResources(Mobile from, Item tool, HarvestDefinition def, Map map, Point3D loc, bool timed)
        {
            if (HarvestMap.CheckMapOnHarvest(from, loc, def) == null)
                return base.CheckResources(from, tool, def, map, loc, timed);

            return true;
        }</pre>

Fragment 2 in file Scripts\Skills\Mining.cs

<pre>public override bool CheckResources(Mobile from, Item tool, HarvestDefinition def, Map map, Point3D loc, bool timed)
        {
            if (HarvestMap.CheckMapOnHarvest(from, loc, def) == null)
                return base.CheckResources(from, tool, def, map, loc, timed);

            return true;
        }</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>Type ourType = GetType();
			m_TypeRef = World.m_MobileTypes.IndexOf(ourType);

			if (m_TypeRef == -1)
			{
				World.m_MobileTypes.Add(ourType);
				m_TypeRef = World.m_MobileTypes.Count - 1;
			}

			Timer.DelayCall(EventSink.InvokeMobileCreated, new MobileCreatedEventArgs(this));</pre>

Fragment 2 in file Server\Mobile.cs

<pre>Type ourType = GetType();
			m_TypeRef = World.m_MobileTypes.IndexOf(ourType);

			if (m_TypeRef == -1)
			{
				World.m_MobileTypes.Add(ourType);
				m_TypeRef = World.m_MobileTypes.Count - 1;
			}

			Timer.DelayCall(EventSink.InvokeMobileCreated, new MobileCreatedEventArgs(this));</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Ultima\Art.cs

<pre>int start = length;
							length = (int)binmul.BaseStream.Position - length;
							binidx.Write(length);
							binidx.Write(0);
							bmp.UnlockBits(bd);
							var s = new CheckSums
							{
								pos = start,
								length = length,
								checksum = checksum,
								index = index
							};</pre>

Fragment 2 in file Ultima\Art.cs

<pre>int start = length;
							length = (int)binmul.BaseStream.Position - length;
							binidx.Write(length);
							binidx.Write(0);
							bmp.UnlockBits(bd);
							var s = new CheckSums
							{
								pos = start,
								length = length,
								checksum = checksum,
								index = index
							};</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DungeonHitchingPost.cs

<pre>pet.SetControlMaster(from);

                        if (pet.Summoned)
                            pet.SummonMaster = from;

                        pet.ControlTarget = from;
                        pet.ControlOrder = OrderType.Follow;

                        pet.MoveToWorld(from.Location, from.Map);

                        pet.IsStabled = false;

                        if (Core.SE)
                            pet.Loyalty = BaseCreature.MaxLoyalty; // Wonderfully Happy</pre>

Fragment 2 in file Scripts\Items\Addons\HitchingPost.cs

<pre>pet.SetControlMaster(from);

                        if (pet.Summoned)
                            pet.SummonMaster = from;

                        pet.ControlTarget = from;
                        pet.ControlOrder = OrderType.Follow;

                        pet.MoveToWorld(from.Location, from.Map);

                        pet.IsStabled = false;

                        if (Core.SE)
                            pet.Loyalty = BaseCreature.MaxLoyalty; // Wonderfully Happy</pre>

Fragment 3 in file Scripts\Items\Functional\ChickenCoop.cs

<pre>pet.SetControlMaster(from);

                    if (pet.Summoned)
                        pet.SummonMaster = from;

                    pet.ControlTarget = from;
                    pet.ControlOrder = OrderType.Follow;

                    pet.MoveToWorld(from.Location, from.Map);

                    pet.IsStabled = false;

                    if (Core.SE)
                        pet.Loyalty = BaseCreature.MaxLoyalty; // Wonderfully Happy</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Dardens Set\DardensBustier.cs

<pre>{
            AbsorptionAttributes.EaterKinetic = 2;
            Attributes.BonusStr = 4;
            Attributes.BonusHits = 4;
            Attributes.LowerRegCost = 15;

            SetAttributes.BonusMana = 15;
            SetAttributes.LowerManaCost = 20;
            SetSelfRepair = 3;

            SetPhysicalBonus = 6;
            SetFireBonus = 7;
            SetColdBonus = 7;
            SetPoisonBonus = 7;
            SetEnergyBonus = 7;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Dardens Set\DardensHelm.cs

<pre>{
            AbsorptionAttributes.EaterKinetic = 2;
            Attributes.BonusStr = 4;
            Attributes.BonusHits = 4;
            Attributes.LowerRegCost = 15;

            SetAttributes.BonusMana = 15;
            SetAttributes.LowerManaCost = 20;
            SetSelfRepair = 3;

            SetPhysicalBonus = 6;
            SetFireBonus = 7;
            SetColdBonus = 7;
            SetPoisonBonus = 7;
            SetEnergyBonus = 7;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Dardens Set\DardensLegs.cs

<pre>{
            AbsorptionAttributes.EaterKinetic = 2;
            Attributes.BonusStr = 4;
            Attributes.BonusHits = 4;
            Attributes.LowerRegCost = 15;

            SetAttributes.BonusMana = 15;
            SetAttributes.LowerManaCost = 20;
            SetSelfRepair = 3;

            SetPhysicalBonus = 6;
            SetFireBonus = 7;
            SetColdBonus = 7;
            SetPoisonBonus = 7;
            SetEnergyBonus = 7;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Dardens Set\DardensSleeves.cs

<pre>{
            AbsorptionAttributes.EaterKinetic = 2;
            Attributes.BonusStr = 4;
            Attributes.BonusHits = 4;
            Attributes.LowerRegCost = 15;

            SetAttributes.BonusMana = 15;
            SetAttributes.LowerManaCost = 20;
            SetSelfRepair = 3;

            SetPhysicalBonus = 6;
            SetFireBonus = 7;
            SetColdBonus = 7;
            SetPoisonBonus = 7;
            SetEnergyBonus = 7;
		}</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Dardens Set\DardensTunic.cs

<pre>{
            AbsorptionAttributes.EaterKinetic = 2;
			Attributes.BonusStr = 4;
			Attributes.BonusHits = 4;
			Attributes.LowerRegCost = 15;

			SetAttributes.BonusMana = 15;
			SetAttributes.LowerManaCost = 20;
            SetSelfRepair = 3;

            SetPhysicalBonus = 6;
            SetFireBonus = 7;
            SetColdBonus = 7;
            SetPoisonBonus = 7;
            SetEnergyBonus = 7;
		}</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>break;

				case 30:
					// target score
					val = 0;
					tr = info.GetTextEntry(30);
					if (tr != null)
					{
						try { val = int.Parse(tr.Text); }
						catch { }
					}
					m_gauntlet.TargetScore = val;

					m_gauntlet.ResetAcceptance();

					// update all the gumps
					RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>break;

                case 30:
                    // target score
                    val = 0;
                    tr = info.GetTextEntry( 30 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.TargetScore = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>break;

                case 30:
                    // target score
                    val = 0;
                    tr = info.GetTextEntry( 30 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.TargetScore = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>break;

                case 30:
                    // target score
                    val = 0;
                    tr = info.GetTextEntry( 30 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.TargetScore = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>break;

                case 30:
                    // target score
                    val = 0;
                    tr = info.GetTextEntry( 30 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.TargetScore = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>break;

                case 30:
                    // target score
                    val = 0;
                    tr = info.GetTextEntry( 30 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.TargetScore = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>break;

                case 30:
                    // target score
                    val = 0;
                    tr = info.GetTextEntry( 30 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.TargetScore = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Alorons Set\AloronsBustier.cs

<pre>{
            AbsorptionAttributes.EaterCold = 2;
            Attributes.BonusDex = 4;
            Attributes.BonusStam = 4;
            Attributes.RegenStam = 3;

            SetAttributes.BonusMana = 15;
            SetAttributes.LowerManaCost = 20;
            SetSelfRepair = 3;

            SetPhysicalBonus = 8;
            SetFireBonus = 8;
            SetColdBonus = 9;
            SetPoisonBonus = 8;
            SetEnergyBonus = 8;
		}</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Alorons Set\AloronsGorget.cs

<pre>{
            AbsorptionAttributes.EaterCold = 2;
            Attributes.BonusDex = 4;
            Attributes.BonusStam = 4;
            Attributes.RegenStam = 3;

            SetAttributes.BonusMana = 15;
            SetAttributes.LowerManaCost = 20;
            SetSelfRepair = 3;

            SetPhysicalBonus = 8;
            SetFireBonus = 8;
            SetColdBonus = 9;
            SetPoisonBonus = 8;
            SetEnergyBonus = 8;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Alorons Set\AloronsHelm.cs

<pre>{
            AbsorptionAttributes.EaterCold = 2;
            Attributes.BonusDex = 4;
            Attributes.BonusStam = 4;
            Attributes.RegenStam = 3;

            SetAttributes.BonusMana = 15;
            SetAttributes.LowerManaCost = 20;
            SetSelfRepair = 3;

            SetPhysicalBonus = 8;
            SetFireBonus = 8;
            SetColdBonus = 9;
            SetPoisonBonus = 8;
            SetEnergyBonus = 8;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Alorons Set\AloronsLegs.cs

<pre>{
            AbsorptionAttributes.EaterCold = 2;
            Attributes.BonusDex = 4;
            Attributes.BonusStam = 4;
            Attributes.RegenStam = 3;

            SetAttributes.BonusMana = 15;
            SetAttributes.LowerManaCost = 20;
            SetSelfRepair = 3;

            SetPhysicalBonus = 8;
            SetFireBonus = 8;
            SetColdBonus = 9;
            SetPoisonBonus = 8;
            SetEnergyBonus = 8;
		}</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Alorons Set\AloronsLongSkirt.cs

<pre>{
            AbsorptionAttributes.EaterCold = 2;
            Attributes.BonusDex = 4;
            Attributes.BonusStam = 4;
            Attributes.RegenStam = 3;

            SetAttributes.BonusMana = 15;
            SetAttributes.LowerManaCost = 20;
            SetSelfRepair = 3;

            SetPhysicalBonus = 8;
            SetFireBonus = 8;
            SetColdBonus = 9;
            SetPoisonBonus = 8;
            SetEnergyBonus = 8;
		}</pre>

Fragment 6 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Alorons Set\AloronsShorts.cs

<pre>{
            AbsorptionAttributes.EaterCold = 2;
            Attributes.BonusDex = 4;
            Attributes.BonusStam = 4;
            Attributes.RegenStam = 3;

            SetAttributes.BonusMana = 15;
            SetAttributes.LowerManaCost = 20;
            SetSelfRepair = 3;

            SetPhysicalBonus = 8;
            SetFireBonus = 8;
            SetColdBonus = 9;
            SetPoisonBonus = 8;
            SetEnergyBonus = 8;
		}</pre>

Fragment 7 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Alorons Set\AloronsSkirt.cs

<pre>{
            AbsorptionAttributes.EaterCold = 2;
            Attributes.BonusDex = 4;
            Attributes.BonusStam = 4;
            Attributes.RegenStam = 3;

            SetAttributes.BonusMana = 15;
            SetAttributes.LowerManaCost = 20;
            SetSelfRepair = 3;

            SetPhysicalBonus = 8;
            SetFireBonus = 8;
            SetColdBonus = 9;
            SetPoisonBonus = 8;
            SetEnergyBonus = 8;
        }</pre>

Fragment 8 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Alorons Set\AloronsTunic.cs

<pre>{
            AbsorptionAttributes.EaterCold = 2;
            Attributes.BonusDex = 4;
            Attributes.BonusStam = 4;
            Attributes.RegenStam = 3;

            SetAttributes.BonusMana = 15;
            SetAttributes.LowerManaCost = 20;
            SetSelfRepair = 3;

            SetPhysicalBonus = 8;
            SetFireBonus = 8;
            SetColdBonus = 9;
            SetPoisonBonus = 8;
            SetEnergyBonus = 8;
        }</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Reports\Objects\Charts\ChartItemCollection.cs

<pre>/// <summary>
            /// Advances the enumerator to the next queue of the enumeration, if one is currently available.
            /// </summary>
            /// <returns>true, if the enumerator was succesfully advanced to the next queue; false, if the enumerator has reached the end of the enumeration.</returns>
            public bool MoveNext()
            {
                if ((this._index <
                     (this._collection.Count - 1)))
                {
                    this._index = (this._index + 1);
                    this._currentElement = this._collection[this._index];
                    return true;
                }
                this._index = this._collection.Count;
                return false;
            }</pre>

Fragment 2 in file Scripts\Services\Reports\Objects\Reports\ItemValueCollection.cs

<pre>/// <summary>
            /// Advances the enumerator to the next queue of the enumeration, if one is currently available.
            /// </summary>
            /// <returns>true, if the enumerator was succesfully advanced to the next queue; false, if the enumerator has reached the end of the enumeration.</returns>
            public bool MoveNext()
            {
                if ((this._index <
                     (this._collection.Count - 1)))
                {
                    this._index = (this._index + 1);
                    this._currentElement = this._collection[this._index];
                    return true;
                }
                this._index = this._collection.Count;
                return false;
            }</pre>

Fragment 3 in file Scripts\Services\Reports\Objects\Reports\ReportColumnCollection.cs

<pre>/// <summary>
            /// Advances the enumerator to the next queue of the enumeration, if one is currently available.
            /// </summary>
            /// <returns>true, if the enumerator was succesfully advanced to the next queue; false, if the enumerator has reached the end of the enumeration.</returns>
            public bool MoveNext()
            {
                if ((this._index <
                     (this._collection.Count - 1)))
                {
                    this._index = (this._index + 1);
                    this._currentElement = this._collection[this._index];
                    return true;
                }
                this._index = this._collection.Count;
                return false;
            }</pre>

Fragment 4 in file Scripts\Services\Reports\Objects\Reports\ReportItemCollection.cs

<pre>/// <summary>
            /// Advances the enumerator to the next queue of the enumeration, if one is currently available.
            /// </summary>
            /// <returns>true, if the enumerator was succesfully advanced to the next queue; false, if the enumerator has reached the end of the enumeration.</returns>
            public bool MoveNext()
            {
                if ((this._index <
                     (this._collection.Count - 1)))
                {
                    this._index = (this._index + 1);
                    this._currentElement = this._collection[this._index];
                    return true;
                }
                this._index = this._collection.Count;
                return false;
            }</pre>

Fragment 5 in file Scripts\Services\Reports\Objects\Snapshots\SnapshotCollection.cs

<pre>/// <summary>
            /// Advances the enumerator to the next queue of the enumeration, if one is currently available.
            /// </summary>
            /// <returns>true, if the enumerator was succesfully advanced to the next queue; false, if the enumerator has reached the end of the enumeration.</returns>
            public bool MoveNext()
            {
                if ((this._index <
                     (this._collection.Count - 1)))
                {
                    this._index = (this._index + 1);
                    this._currentElement = this._collection[this._index];
                    return true;
                }
                this._index = this._collection.Count;
                return false;
            }</pre>

Fragment 6 in file Scripts\Services\Reports\Objects\Staffing\PageInfoCollection.cs

<pre>/// <summary>
            /// Advances the enumerator to the next queue of the enumeration, if one is currently available.
            /// </summary>
            /// <returns>true, if the enumerator was succesfully advanced to the next queue; false, if the enumerator has reached the end of the enumeration.</returns>
            public bool MoveNext()
            {
                if ((this._index <
                     (this._collection.Count - 1)))
                {
                    this._index = (this._index + 1);
                    this._currentElement = this._collection[this._index];
                    return true;
                }
                this._index = this._collection.Count;
                return false;
            }</pre>

Fragment 7 in file Scripts\Services\Reports\Objects\Staffing\QueueStatusCollection.cs

<pre>/// <summary>
            /// Advances the enumerator to the next queue of the enumeration, if one is currently available.
            /// </summary>
            /// <returns>true, if the enumerator was succesfully advanced to the next queue; false, if the enumerator has reached the end of the enumeration.</returns>
            public bool MoveNext()
            {
                if ((this._index <
                     (this._collection.Count - 1)))
                {
                    this._index = (this._index + 1);
                    this._currentElement = this._collection[this._index];
                    return true;
                }
                this._index = this._collection.Count;
                return false;
            }</pre>

Fragment 8 in file Scripts\Services\Reports\Objects\Staffing\ResponseInfoCollection.cs

<pre>/// <summary>
            /// Advances the enumerator to the next queue of the enumeration, if one is currently available.
            /// </summary>
            /// <returns>true, if the enumerator was succesfully advanced to the next queue; false, if the enumerator has reached the end of the enumeration.</returns>
            public bool MoveNext()
            {
                if ((this._index <
                     (this._collection.Count - 1)))
                {
                    this._index = (this._index + 1);
                    this._currentElement = this._collection[this._index];
                    return true;
                }
                this._index = this._collection.Count;
                return false;
            }</pre>

Fragment 9 in file Scripts\Services\Reports\Persistence\PersistableObjectCollection.cs

<pre>/// <summary>
            /// Advances the enumerator to the next queue of the enumeration, if one is currently available.
            /// </summary>
            /// <returns>true, if the enumerator was succesfully advanced to the next queue; false, if the enumerator has reached the end of the enumeration.</returns>
            public bool MoveNext()
            {
                if ((this._index <
                     (this._collection.Count - 1)))
                {
                    this._index = (this._index + 1);
                    this._currentElement = this._collection[this._index];
                    return true;
                }
                this._index = this._collection.Count;
                return false;
            }</pre>

## Duplicated Code. Size: 117

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>break;

				case 20:
					// arena size
					val = 0;
					tr = info.GetTextEntry(20);
					if (tr != null)
					{
						try { val = int.Parse(tr.Text); }
						catch { }
					}
					m_gauntlet.ArenaSize = val;

					m_gauntlet.ResetAcceptance();

					// update all the gumps
					RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>break;

                case 20:
                    // arena size
                    val = 0;
                    tr = info.GetTextEntry( 20 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.ArenaSize = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>break;

                case 20:
                    // arena size
                    val = 0;
                    tr = info.GetTextEntry( 20 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.ArenaSize = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>break;

                case 20:
                    // arena size
                    val = 0;
                    tr = info.GetTextEntry( 20 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.ArenaSize = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>break;

                case 20:
                    // arena size
                    val = 0;
                    tr = info.GetTextEntry( 20 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.ArenaSize = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>break;

                case 20:
                    // arena size
                    val = 0;
                    tr = info.GetTextEntry( 20 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.ArenaSize = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>break;

                case 20:
                    // arena size
                    val = 0;
                    tr = info.GetTextEntry( 20 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.ArenaSize = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 8 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>break;

                case 20:
                    // arena size
                    val = 0;
                    tr = info.GetTextEntry( 20 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.ArenaSize = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 9 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>break;

                case 20:
                    // arena size
                    val = 0;
                    tr = info.GetTextEntry( 20 );
                    if(tr != null)
                    {
                        try{val = int.Parse(tr.Text); } catch{}
                    }
                    m_gauntlet.ArenaSize = val;

                    m_gauntlet.ResetAcceptance();

                    // update all the gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Extensions\Compilers\DistinctCompiler.cs

<pre>emitter.MarkLabel(end);

                emitter.LoadLocal(v);
                emitter.Return();

                typeBuilder.DefineMethodOverride(
                    emitter.Method,
                    typeof(IComparer).GetMethod(
                        "Compare",
                        new Type[]
                        {
                            typeof(object),
                            typeof(object)
                        }));

                compareMethod = emitter.Method;</pre>

Fragment 2 in file Scripts\Commands\Generic\Extensions\Compilers\SortCompiler.cs

<pre>emitter.MarkLabel(end);

                emitter.LoadLocal(v);
                emitter.Return();

                typeBuilder.DefineMethodOverride(
                    emitter.Method,
                    typeof(IComparer).GetMethod(
                        "Compare",
                        new Type[]
                        {
                            typeof(object),
                            typeof(object)
                        }));

                compareMethod = emitter.Method;</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SHTelGenDelete.cs

<pre>this.AddSHTCouple(false, 5919, 2021, 0, true, 1724, 814, 0);

                tele1 = this.AddSHT(Map.Trammel, false, 5654, 1791, 0);
                tele2 = this.AddSHT(Map.Trammel, true, 730, 1451, 0);</pre>

Fragment 2 in file Scripts\Items\Addons\SHTeleporter.cs

<pre>this.AddSHTCouple(false, 5919, 2021, 0, true, 1724, 814, 0);

                tele1 = this.AddSHT(Map.Trammel, false, 5654, 1791, 0);
                tele2 = this.AddSHT(Map.Trammel, true, 730, 1451, 0);</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Virtue\HumilityCloak.cs

<pre>{
            this.LootType = LootType.Blessed;
            this.Weight = 6.0;
            this.SetHue = 0;
            this.Hue = 0x226;

            this.SetSelfRepair = 5;			
            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 5;
            this.SetEnergyBonus = 5;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Virtue\SpiritualityHelm.cs

<pre>{ 
            this.LootType = LootType.Blessed;
            this.Weight = 6.0;
            this.SetHue = 0;
            this.Hue = 0x226;

            this.SetSelfRepair = 5;

            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 5;
            this.SetEnergyBonus = 5;
        }</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\TOTGreaterArtifacts.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = (this.InheritsItem ? 0 : reader.ReadInt()); // Required for BasePigmentsOfTokuno insertion

            switch ( version )
            {
                case 1:
                    this.Type = (PigmentType)reader.ReadEncodedInt();
                    break;
                case 0:
                    break;
            }
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\TOTLesserArtifacts.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = (this.InheritsItem ? 0 : reader.ReadInt()); // Required for BasePigmentsOfTokuno insertion

            switch ( version )
            {
                case 1:
                    this.Type = (LesserPigmentType)reader.ReadEncodedInt();
                    break;
                case 0:
                    break;
            }
        }</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\BaseConfusionBlastPotion.cs

<pre>public static void AddDelay(Mobile m)
        {
            Timer timer = m_Delay[m] as Timer;

            if (timer != null)
                timer.Stop();

            m_Delay[m] = Timer.DelayCall(TimeSpan.FromSeconds(60), new TimerStateCallback(EndDelay_Callback), m);	
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\BaseExplodingTarPotion.cs

<pre>public static void AddDelay( Mobile m )
		{
			Timer timer = m_Delay[ m ] as Timer;

			if ( timer != null )
				timer.Stop();

			m_Delay[ m ] = Timer.DelayCall( TimeSpan.FromSeconds( 60 ), new TimerStateCallback( EndDelay_Callback ), m );	
		}</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseAxe.cs

<pre>!Core.AOS && defender is Mobile && (attacker.Player || attacker.Body.IsHuman) && this.Layer == Layer.TwoHanded && (attacker.Skills[SkillName.Anatomy].Value / 400.0) >= Utility.RandomDouble() && Engines.ConPVP.DuelContext.AllowSpecialAbility(attacker, "Concussion Blow", false)</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BasePoleArm.cs

<pre>!Core.AOS && defender is Mobile && (attacker.Player || attacker.Body.IsHuman) && this.Layer == Layer.TwoHanded && (attacker.Skills[SkillName.Anatomy].Value / 400.0) >= Utility.RandomDouble() && Engines.ConPVP.DuelContext.AllowSpecialAbility(attacker, "Concussion Blow", false)</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\MedusaLairAltar.cs

<pre>public bool TryDrop(Mobile from, Item item, int id)
        {
            if (id >= 0 && id < this.Keys.Length && item != null)
            {
                if (item.GetType() == this.Keys[id])
                    return this.OnDragDrop(from, item);
            }

            return false;
        }</pre>

Fragment 2 in file Scripts\Items\Functional\StygianDragonAltar.cs

<pre>public bool TryDrop(Mobile from, Item item, int id)
        {
            if (id >= 0 && id < this.Keys.Length && item != null)
            {
                if (item.GetType() == this.Keys[id])
                    return this.OnDragDrop(from, item);
            }

            return false;
        }</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\TownCrier.cs

<pre>for (int i = this.m_Entries.Count - 1; this.m_Entries != null && i >= 0; --i)
            {
                if (i >= this.m_Entries.Count)
                    continue;

                TownCrierEntry tce = this.m_Entries[i];

                if (tce.Expired)
                    this.RemoveEntry(tce);
            }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\TownCrier.cs

<pre>for (int i = this.m_Entries.Count - 1; this.m_Entries != null && i >= 0; --i)
            {
                if (i >= this.m_Entries.Count)
                    continue;

                TownCrierEntry tce = this.m_Entries[i];

                if (tce.Expired)
                    this.RemoveEntry(tce);
            }</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\PlayerMobile.cs

<pre>int startX = foundation.X + foundation.Components.Min.X + 1;
			int startY = foundation.Y + foundation.Components.Min.Y + 1;
			int endX = startX + foundation.Components.Width - 1;
			int endY = startY + foundation.Components.Height - 2;</pre>

Fragment 2 in file Scripts\Mobiles\PlayerMobile.cs

<pre>int startX = foundation.X + foundation.Components.Min.X + 1;
			int startY = foundation.Y + foundation.Components.Min.Y + 1;
			int endX = startX + foundation.Components.Width - 1;
			int endY = startY + foundation.Components.Height - 2;</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>if (color == -1 && match.Context != null && match.Winner == part)
                                        txt = this.Color(txt, 0x336633);
                                    else if (color == -1 && match.Context != null)
                                        txt = this.Color(txt, 0x663333);

                                    sb.Append(txt);</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>if (color == -1 && match.Context != null && match.Winner == part)
                                        txt = this.Color(txt, 0x336633);
                                    else if (color == -1 && match.Context != null)
                                        txt = this.Color(txt, 0x663333);

                                    sb.Append(txt);</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\CommodityBrokerGump.cs

<pre>AddHtmlLocalized(215, 100, 200, 18, 1150328, GreenColor16, false, false); // OWNER MENU

			AddButton(150, 150, 4005, 4007, 1, GumpButtonType.Reply, 0);
			AddHtmlLocalized(190, 150, 200, 18, 1150392, OrangeColor16, false, false); // INFORMATION</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>AddHtmlLocalized(215, 100, 200, 18, 1150328, GreenColor16, false, false); // Owner Menu

			AddButton(150, 150, 4005, 4007, 1, GumpButtonType.Reply, 0);
			AddHtmlLocalized(190, 150, 200, 18, 1150392, OrangeColor16, false, false); // INFORMATION</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlFire.cs

<pre>public override void Serialize( GenericWriter writer )
		{
			base.Serialize(writer);

			writer.Write( (int) 1 );
			// version 1
			writer.Write(proximityrange);
			// version 0
			writer.Write(m_Damage);
			writer.Write(m_Refractory);
			writer.Write(m_EndTime - DateTime.UtcNow);

		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlLightning.cs

<pre>public override void Serialize( GenericWriter writer )
		{
			base.Serialize(writer);

			writer.Write( (int) 1 );
			// version 1
			writer.Write(proximityrange);
			// version 0
			writer.Write(m_Damage);
			writer.Write(m_Refractory);
			writer.Write(m_EndTime - DateTime.UtcNow);

		}</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>public override void GetContextMenuEntries( Mobile from, List<ContextMenuEntry> list )
		{
			if ( from.Alive )
			{
				if ( TalkText != null && TalkText.Length > 0 && DialogAttachment != null)
				{
					list.Add( new TalkEntry( this ) );
				}
			}

			base.GetContextMenuEntries( from, list );
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
		{
			if ( from.Alive )
			{
				if ( TalkText != null && TalkText.Length > 0 && DialogAttachment != null)
				{
					list.Add( new TalkEntry( this ) );
				}
			}

			base.GetContextMenuEntries( from, list );
		}</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\QuestLogGump.cs

<pre>for ( int i = index; i >= 0 && i < list.Count; ++i )
			{
				object obj = list[i];

					int add;

					add = 1;

					if ( (slots + add) > 10 )
						break;

					slots += add;

				++count;
			}

			return count;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestBookGump.cs

<pre>for ( int i = index; i >= 0 && i < list.Count; ++i )
			{
				object obj = list[i];

					int add;

					add = 1;

					if ( (slots + add) > 10 )
						break;

					slots += add;

				++count;
			}

			return count;</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>AddLabel( 220, 130, 0, String.Format(XmlPoints.GetText(from, 200508), viewpage+1, (int)(m_WorkingList.Count/PlayersPerPage)+1)); // "Page: {0}/{1}"

                AddLabel( 160, 130, 0, XmlPoints.GetText(from, 200591));  // "Team"</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>AddLabel( 220, 130, 0, String.Format(XmlPoints.GetText(from, 200508), viewpage+1, (int)(m_WorkingList.Count/PlayersPerPage)+1)); // "Page: {0}/{1}"

                AddLabel( 160, 130, 0, XmlPoints.GetText(from, 200591));  // "Team"</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>public override void OnClick()
            {
                this.m_Item.BlessedFor = null;
                this.m_Item.BlessedBy = null;

                Container pack = this.m_From.Backpack;

                if (pack != null)
                {
                    pack.DropItem(new PersonalBlessDeed(this.m_From));
                    this.m_From.SendLocalizedMessage(1062200); // A personal bless deed has been placed in your backpack.
                }
            }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>public override void OnClick()
            {
                this.m_Item.BlessedFor = null;
                this.m_Item.BlessedBy = null;

                Container pack = this.m_From.Backpack;

                if (pack != null)
                {
                    pack.DropItem(new PersonalBlessDeed(this.m_From));
                    this.m_From.SendLocalizedMessage(1062200); // A personal bless deed has been placed in your backpack.
                }
            }</pre>

Fragment 3 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>public override void OnClick()
            {
                this.m_Item.BlessedFor = null;
                this.m_Item.BlessedBy = null;

                Container pack = this.m_From.Backpack;

                if (pack != null)
                {
                    pack.DropItem(new PersonalBlessDeed(this.m_From));
                    this.m_From.SendLocalizedMessage(1062200); // A personal bless deed has been placed in your backpack.
                }
            }</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlLifeDrain.cs

<pre>public override void Serialize( GenericWriter writer )
		{
			base.Serialize(writer);

			writer.Write( (int) 1 );
			// version 1
			writer.Write(proximityrange);
			// version 0
			writer.Write(m_Drain);
			writer.Write(m_Refractory);
			writer.Write(m_EndTime - DateTime.UtcNow);

		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlManaDrain.cs

<pre>public override void Serialize( GenericWriter writer )
		{
			base.Serialize(writer);

			writer.Write( (int) 1 );
			// version 1
			writer.Write(proximityrange);
			// version 0
			writer.Write(m_Drain);
			writer.Write(m_Refractory);
			writer.Write(m_EndTime - DateTime.UtcNow);

		}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlStamDrain.cs

<pre>public override void Serialize( GenericWriter writer )
		{
			base.Serialize(writer);

			writer.Write( (int) 1 );
			// version 1
			writer.Write(proximityrange);
			// version 0
			writer.Write(m_Drain);
			writer.Write(m_Refractory);
			writer.Write(m_EndTime - DateTime.UtcNow);

		}</pre>

## Duplicated Code. Size: 116

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\CloakOfDeathBase\EpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\CloakOfDeathBase\GargishEpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\CloakOfLifeBase\EpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\CloakOfLifeBase\GargishEpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\CloakOfPowerBase\EpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\CloakOfPowerBase\GargishEpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

Fragment 7 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\CloakOfSilenceBase\EpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

Fragment 8 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\CloakOfSilenceBase\GargishEpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

Fragment 9 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\ConjurersGarbBase\EpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

Fragment 10 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\ConjurersGarbBase\GargishEpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

Fragment 11 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MysticsGarbBase\EpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

Fragment 12 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MysticsGarbBase\GargishEpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

Fragment 13 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\ShroudOfTheCondemnedBase\EpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

Fragment 14 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\ShroudOfTheCondemnedBase\GargishEpauletteBearingTheCrestOfBlackthorn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
            {
                if (Parent is Mobile)
                {
                    ((Mobile)Parent).AddToBackpack(this);
                }

                Layer = Layer.OuterTorso;
            }
        }</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseAxe.cs

<pre>((Mobile)defender).SendMessage("You receive a concussion blow!");
                    ((Mobile)defender).AddStatMod(new StatMod(StatType.Int, "Concussion", -(((Mobile)defender).RawInt / 2), TimeSpan.FromSeconds(30.0)));

                    attacker.SendMessage("You deliver a concussion blow!");</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BasePoleArm.cs

<pre>((Mobile)defender).SendMessage("You receive a concussion blow!");
                    ((Mobile)defender).AddStatMod(new StatMod(StatType.Int, "Concussion", -(((Mobile)defender).RawInt / 2), TimeSpan.FromSeconds(30.0)));

                    attacker.SendMessage("You deliver a concussion blow!");</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\RunicSewingKit.cs

<pre>string v = " ";

            if (!CraftResources.IsStandard(this.Resource))
            {
                int num = CraftResources.GetLocalizationNumber(this.Resource);

                if (num > 0)
                    v = String.Format("#{0}", num);
                else
                    v = CraftResources.GetName(this.Resource);
            }</pre>

Fragment 2 in file Scripts\Items\Tools\RunicSewingKit.cs

<pre>string v = " ";

            if (!CraftResources.IsStandard(this.Resource))
            {
                int num = CraftResources.GetLocalizationNumber(this.Resource);

                if (num > 0)
                    v = String.Format("#{0}", num);
                else
                    v = CraftResources.GetName(this.Resource);
            }</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Silvani.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            defender.Damage(Utility.Random(20, 10), this);
            defender.Stam -= Utility.Random(20, 10);
            defender.Mana -= Utility.Random(20, 10);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Named\Twaulo.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            defender.Damage(Utility.Random(20, 10), this);
            defender.Stam -= Utility.Random(20, 10);
            defender.Mana -= Utility.Random(20, 10);
        }</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Armorer.cs

<pre>this.m_SBInfos.Add(new SBMetalShields());
                        this.m_SBInfos.Add(new SBPlateArmor());
                        this.m_SBInfos.Add(new SBHelmetArmor());
                        this.m_SBInfos.Add(new SBChainmailArmor());
                        this.m_SBInfos.Add(new SBRingmailArmor());</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Armorer.cs

<pre>this.m_SBInfos.Add(new SBMetalShields());
                        this.m_SBInfos.Add(new SBPlateArmor());
                        this.m_SBInfos.Add(new SBHelmetArmor());
                        this.m_SBInfos.Add(new SBChainmailArmor());
                        this.m_SBInfos.Add(new SBRingmailArmor());</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\MansionGuard.cs

<pre>this.AddItem(new PlateChest());
            this.AddItem(new PlateArms());
            this.AddItem(new PlateGloves());
            this.AddItem(new PlateLegs());

            Utility.AssignRandomHair(this);
            Utility.AssignRandomFacialHair(this, this.HairHue);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\MilitiaCanoneer.cs

<pre>Utility.AssignRandomHair(this);
            Utility.AssignRandomFacialHair(this, this.HairHue);

            this.AddItem(new PlateChest());
            this.AddItem(new PlateArms());
            this.AddItem(new PlateGloves());
            this.AddItem(new PlateLegs());</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\PlayerMobile.cs

<pre>AddButton(6, 116, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
				AddHtmlLocalized(40, 118, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL

				AddButton(114, 116, 0xFA5, 0xFA7, 1, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Mobiles\PlayerMobile.cs

<pre>AddButton(6, 116, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                AddHtmlLocalized(40, 118, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL

                AddButton(114, 116, 0xFA5, 0xFA7, 1, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\BaseHouse.cs

<pre>BaseDoor door = this.m_Doors[i] as BaseDoor;
                Point3D p = door.Location;

                if (door.Open)
                    p = new Point3D(p.X - door.Offset.X, p.Y - door.Offset.Y, p.Z - door.Offset.Z);</pre>

Fragment 2 in file Scripts\Multis\BaseHouse.cs

<pre>BaseDoor door = this.m_Doors[i] as BaseDoor;
                Point3D p = door.Location;

                if (door.Open)
                    p = new Point3D(p.X - door.Offset.X, p.Y - door.Offset.Y, p.Z - door.Offset.Z);</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Boats\BaseBoat.cs

<pre>((Mobile)m_TillerMan).Location = new Point3D(X + (((Mobile)m_TillerMan).X - old.X), Y + (((Mobile)m_TillerMan).Y - old.Y), Z + (((Mobile)m_TillerMan).Z - old.Z));</pre>

Fragment 2 in file Scripts\Multis\Boats\BaseBoat.cs

<pre>((Item)m_TillerMan).Location = new Point3D(X + (((Item)m_TillerMan).X - old.X), Y + (((Item)m_TillerMan).Y - old.Y), Z + (((Item)m_TillerMan).Z - old.Z));</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\HouseFoundation.cs

<pre>writer.Write((ushort)ent.m_ItemID);
                writer.Write((short)ent.m_OffsetX);
                writer.Write((short)ent.m_OffsetY);
                writer.Write((short)ent.m_OffsetZ);
                writer.Write((int)ent.m_Flags);</pre>

Fragment 2 in file Server\MultiData.cs

<pre>writer.Write(ent.m_ItemID);
				writer.Write(ent.m_OffsetX);
				writer.Write(ent.m_OffsetY);
				writer.Write(ent.m_OffsetZ);
				writer.Write(ent.m_Flags);</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\LargeBulkEntry.cs

<pre>if (m_Cache == null)
                m_Cache = new Hashtable();

            Hashtable table = (Hashtable)m_Cache[type];

            if (table == null)
                m_Cache[type] = table = new Hashtable();

            SmallBulkEntry[] entries = (SmallBulkEntry[])table[name];</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallBulkEntry.cs

<pre>if (m_Cache == null)
                m_Cache = new Hashtable();

            Hashtable table = (Hashtable)m_Cache[type];

            if (table == null)
                m_Cache[type] = table = new Hashtable();

            SmallBulkEntry[] entries = (SmallBulkEntry[])table[name];</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Gumps\FinanceGump.cs

<pre>this.AddHtmlLocalized(20, 210, 200, 25, 1011518, false, false); // Current Silver :
                this.AddLabel(230, 210, 0x44, town.Silver.ToString("N0")); // NOTE: Added 'N0'

                this.AddHtmlLocalized(20, 240, 200, 25, 1011519, false, false); // Current Payroll :</pre>

Fragment 2 in file Scripts\Services\Factions\Gumps\SheriffGump.cs

<pre>this.AddHtmlLocalized(20, 210, 200, 25, 1011518, false, false); // Current Silver : 
                this.AddLabel(230, 210, 0x44, town.Silver.ToString("N0")); // NOTE: Added 'N0'

                this.AddHtmlLocalized(20, 240, 200, 25, 1011519, false, false); // Current Payroll : </pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\PointsSystems\BlackthornData.cs

<pre>if (!damager.PlaceInBackpack(i))
                        {
                            if (damager.BankBox != null && damager.BankBox.TryDropItem(damager, i, false))
                                damager.SendLocalizedMessage(1079730); // The item has been placed into your bank box.
                            else
                            {
                                damager.SendLocalizedMessage(1072523); // You find an artifact, but your backpack and bank are too full to hold it.
                                i.MoveToWorld(damager.Location, damager.Map);
                            }
                        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\InvasionSpawner\InvasionController.cs

<pre>if (!damager.PlaceInBackpack(i))
                            {
                                if (damager.BankBox != null && damager.BankBox.TryDropItem(damager, i, false))
                                    damager.SendLocalizedMessage(1079730); // The item has been placed into your bank box.
                                else
                                {
                                    damager.SendLocalizedMessage(1072523); // You find an artifact, but your backpack and bank are too full to hold it.
                                    i.MoveToWorld(damager.Location, damager.Map);
                                }
                            }</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusArchZealot.cs

<pre>AddHtmlLocalized(155, 360, 250, 24, 1153682, White, false, false);
            AddButton(125, 360, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 7);//The Keys?

            AddButton(325, 390, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusArchZealot.cs

<pre>AddHtmlLocalized(155, 360, 250, 24, 1153682, White, false, false);
            AddButton(125, 360, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 7);//The Keys?

            AddButton(325, 390, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>XmlSaveItem si = (XmlSaveItem)XmlAttach.FindAttachment(invoker, typeof(XmlSaveItem), "Taken");

									if (si == null)
									{
										XmlAttach.AttachTo(invoker, new XmlSaveItem("Taken", savedItem, triggermob));
									}
									else
									{
										si.SavedItem = savedItem;
										si.WasOwnedBy = triggermob;
									}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>XmlSaveItem si = (XmlSaveItem)XmlAttach.FindAttachment(invoker, typeof(XmlSaveItem), "Taken");

								if (si == null)
								{
									XmlAttach.AttachTo(invoker, new XmlSaveItem("Taken", savedItem, triggermob));
								}
								else
								{
									si.SavedItem = savedItem;
									si.WasOwnedBy = triggermob;
								}</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlGetAttachGump.cs

<pre>{
						int i = info.ButtonID - 4000;
						// dont allow individual selection with the selectall button selected
						if(m_SelectionList != null && i >= 0  && i < m_SelectionList.Length && !SelectAll){
							// only toggle the selection list entries for things that actually have entries
							if(m_SearchList != null && (m_SearchList.Count - DisplayFrom > i)) {
								m_SelectionList[i] = !m_SelectionList[i];
							}
						}
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlEdit.cs

<pre>{
						int i = info.ButtonID - 4000;
						// dont allow individual selection with the selectall button selected
						if(m_SelectionList != null && i >= 0  && i < m_SelectionList.Length && !SelectAll)
						{
							// only toggle the selection list entries for things that actually have entries
							if(m_SearchList != null && (m_SearchList.Count - DisplayFrom > i)) 
							{
								m_SelectionList[i] = !m_SelectionList[i];
							}
						}
					}</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>if ( !from.InRange( GetWorldLocation(), 2 ) || !from.InLOS(this))
			{
				from.SendLocalizedMessage( 500446 ); // That is too far away.
				return;
			}
			// animate and change state
			int newstate = State+1;
			if(newstate > 1) newstate = 0;

			// carry out the switch actions
			Activate(from, newstate, null);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>if ( !from.InRange( GetWorldLocation(), 2 ) || !from.InLOS(this))
			{
				from.SendLocalizedMessage( 500446 ); // That is too far away.
				return;
			}
			// animate and change state
			int newstate = State+1;
			if(newstate > 1) newstate = 0;

			// carry out the switch actions
			Activate(from, newstate, null);</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetPoint2DGump.cs

<pre>public InternalTarget( PropertyInfo prop, Mobile mobile, object o, Stack stack, int page, ArrayList list ) : base( -1, true, TargetFlags.None )
#endif
			{
				m_Property = prop;
				m_Mobile = mobile;
				m_Object = o;
				m_Stack = stack;
				m_Page = page;
				m_List = list;
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetPoint3DGump.cs

<pre>public InternalTarget( PropertyInfo prop, Mobile mobile, object o, Stack stack, int page, ArrayList list ) : base( -1, true, TargetFlags.None )
#endif
			{
				m_Property = prop;
				m_Mobile = mobile;
				m_Object = o;
				m_Stack = stack;
				m_Page = page;
				m_List = list;
			}</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>if(m != null)
                    {
                        AddLabel( 40, yoffset, 0, m.Name);

                        AddLabel( 225, yoffset, texthue, statusmsg);

                        if(m_gauntlet.GameInProgress)
                        {
                            AddLabel( 13, yoffset, 0, entry.Score.ToString());
                        }
                    }

                    yoffset += y_inc;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>if(m != null)
                    {
                        AddLabel( 40, yoffset, 0, m.Name);

                        AddLabel( 225, yoffset, texthue, statusmsg);

                        if(m_gauntlet.GameInProgress)
                        {
                            AddLabel( 13, yoffset, 0, entry.Score.ToString());
                        }
                    }

                    yoffset += y_inc;</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\BoxOfTransmutation.cs

<pre>Type t = null;
                    // make sure they are all of the same type
                    foreach(Item s in slist)
                    {
                        if(t == null)
                        {
                            t = ((SmallBOD)s).GetType();
                        } else
                        {
                            if(t != ((SmallBOD)s).GetType())
                            {
                                from.SendMessage("All BODs must be of the same type");
                                return;
                            }
                        }
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\BoxOfTransmutation.cs

<pre>Type t = null;
                    // make sure they are all of the same type
                    foreach(Item s in slist)
                    {
                        if(t == null)
                        {
                            t = ((LargeBOD)s).GetType();
                        } else
                        {
                            if(t != ((LargeBOD)s).GetType())
                            {
                                from.SendMessage("All BODs must be of the same type");
                                return;
                            }
                        }
                    }</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Chivalry\CleanseByFire.cs

<pre>chanceToCure /= 100;

                    if (chanceToCure > Utility.Random(100))
                    {
                        if (m.CurePoison(this.Caster))
                        {
                            if (this.Caster != m)
                                this.Caster.SendLocalizedMessage(1010058); // You have cured the target of all poisons!

                            m.SendLocalizedMessage(1010059); // You have been cured of all poisons.
                        }
                    }
                    else
                    {
                        m.SendLocalizedMessage(1010060); // You have failed to cure your target!
                    }</pre>

Fragment 2 in file Scripts\Spells\Second\Cure.cs

<pre>chanceToCure /= 100;

                    if (chanceToCure > Utility.Random(100))
                    {
                        if (m.CurePoison(this.Caster))
                        {
                            if (this.Caster != m)
                                this.Caster.SendLocalizedMessage(1010058); // You have cured the target of all poisons!

                            m.SendLocalizedMessage(1010059); // You have been cured of all poisons.
                        }
                    }
                    else
                    {
                        m.SendLocalizedMessage(1010060); // You have failed to cure your target!
                    }</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBAlchemist.cs

<pre>this.Add(typeof(NightSightPotion), 7);
                this.Add(typeof(AgilityPotion), 7);
                this.Add(typeof(StrengthPotion), 7);
                this.Add(typeof(RefreshPotion), 7);
                this.Add(typeof(LesserCurePotion), 7);</pre>

Fragment 2 in file Scripts\VendorInfo\SBHolyMage.cs

<pre>this.Add(typeof(NightSightPotion), 7);
                this.Add(typeof(AgilityPotion), 7);
                this.Add(typeof(StrengthPotion), 7);
                this.Add(typeof(RefreshPotion), 7);
                this.Add(typeof(LesserCurePotion), 7);</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBlacksmith.cs

<pre>this.Add(typeof(Buckler), 25);
                this.Add(typeof(BronzeShield), 33);
                this.Add(typeof(MetalShield), 60);
                this.Add(typeof(MetalKiteShield), 62);
                this.Add(typeof(HeaterShield), 115);</pre>

Fragment 2 in file Scripts\VendorInfo\SBMetalShields.cs

<pre>this.Add(typeof(Buckler), 25);
                this.Add(typeof(BronzeShield), 33);
                this.Add(typeof(MetalShield), 60);
                this.Add(typeof(MetalKiteShield), 62);
                this.Add(typeof(HeaterShield), 115);</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBlacksmith.cs

<pre>this.Add(typeof(PlateArms), 94);
                this.Add(typeof(PlateChest), 121);
                this.Add(typeof(PlateGloves), 72);
                this.Add(typeof(PlateGorget), 52);
                this.Add(typeof(PlateLegs), 109);</pre>

Fragment 2 in file Scripts\VendorInfo\SBPlateArmor.cs

<pre>this.Add(typeof(PlateArms), 94);
                this.Add(typeof(PlateChest), 121);
                this.Add(typeof(PlateGloves), 72);
                this.Add(typeof(PlateGorget), 52);
                this.Add(typeof(PlateLegs), 109);</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBlacksmith.cs

<pre>this.Add(typeof(FemaleStuddedChest), 25);
                this.Add(typeof(LeatherShorts), 14);
                this.Add(typeof(LeatherSkirt), 11);
                this.Add(typeof(LeatherBustierArms), 11);
                this.Add(typeof(StuddedBustierArms), 27);</pre>

Fragment 2 in file Scripts\VendorInfo\SBLeatherArmor.cs

<pre>this.Add(typeof(FemaleStuddedChest), 25);
                this.Add(typeof(LeatherShorts), 14);
                this.Add(typeof(LeatherSkirt), 11);
                this.Add(typeof(LeatherBustierArms), 11);
                this.Add(typeof(StuddedBustierArms), 27);</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>if (parent.KeepsItemsOnDeath)
            {
                return DeathMoveResult.MoveToBackpack;
            }
            else if (CheckBlessed(parent))
            {
                return DeathMoveResult.MoveToBackpack;
            }
            else if (CheckNewbied() && parent.Kills < 5)
            {
                return DeathMoveResult.MoveToBackpack;
            }
            else if (parent.Player && Nontransferable)
            {
                return DeathMoveResult.MoveToBackpack;
            }
            else
            {
                return DeathMoveResult.MoveToCorpse;
            }</pre>

Fragment 2 in file Server\Item.cs

<pre>if (parent.KeepsItemsOnDeath)
            {
                return DeathMoveResult.MoveToBackpack;
            }
            else if (CheckBlessed(parent))
            {
                return DeathMoveResult.MoveToBackpack;
            }
            else if (CheckNewbied() && parent.Kills < 5)
            {
                return DeathMoveResult.MoveToBackpack;
            }
            else if (parent.Player && Nontransferable)
            {
                return DeathMoveResult.MoveToBackpack;
            }
            else
            {
                return DeathMoveResult.MoveToCorpse;
            }</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>CharacterListFlags flags = ExpansionInfo.CoreExpansion.CharacterListFlags;

			if (count > 6)
			{
				flags |= (CharacterListFlags.SeventhCharacterSlot | CharacterListFlags.SixthCharacterSlot);
			}
				// 7th Character Slot - TODO: Is SixthCharacterSlot Required?
			else if (count == 6)
			{
				flags |= CharacterListFlags.SixthCharacterSlot; // 6th Character Slot
			}
			else if (a.Limit == 1)
			{
				flags |= (CharacterListFlags.SlotLimit & CharacterListFlags.OneCharacterSlot); // Limit Characters & One Character
			}</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>CharacterListFlags flags = ExpansionInfo.CoreExpansion.CharacterListFlags;

			if (count > 6)
			{
				flags |= (CharacterListFlags.SeventhCharacterSlot | CharacterListFlags.SixthCharacterSlot);
			}
				// 7th Character Slot - TODO: Is SixthCharacterSlot Required?
			else if (count == 6)
			{
				flags |= CharacterListFlags.SixthCharacterSlot; // 6th Character Slot
			}
			else if (a.Limit == 1)
			{
				flags |= (CharacterListFlags.SlotLimit & CharacterListFlags.OneCharacterSlot); // Limit Characters & One Character
			}</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\BaseChampion.cs

<pre>for (int i = 0; i < toGive.Count; ++i)
            {
                int rand = Utility.Random(toGive.Count);
                Mobile hold = toGive[i];
                toGive[i] = toGive[rand];
                toGive[rand] = hold;
            }</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\BaseChampion.cs

<pre>for (int i = 0; i < toGive.Count; ++i)
            {
                int rand = Utility.Random(toGive.Count);
                Mobile hold = toGive[i];
                toGive[i] = toGive[rand];
                toGive[rand] = hold;
            }</pre>

Fragment 3 in file Scripts\Mobiles\Bosses\Harrower\Harrower.cs

<pre>for (int i = 0; i < toGive.Count; ++i)
            {
                int rand = Utility.Random(toGive.Count);
                Mobile hold = toGive[i];
                toGive[i] = toGive[rand];
                toGive[rand] = hold;
            }</pre>

## Duplicated Code. Size: 115

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\BritannianInfantry.cs

<pre>public override bool PlayerRangeSensitive
        {
            get
            {
                if (this.Region != null && this.Region.IsPartOf(typeof(BattleRegion)))
                {
                    if (((BattleRegion)this.Region).Spawner != null)
                        return !((BattleRegion)this.Region).Spawner.HasPlayers();
                }

                return base.PlayerRangeSensitive;
            }
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>public override bool PlayerRangeSensitive
        {
            get
            {
                if (this.Region != null && this.Region.IsPartOf(typeof(BattleRegion)))
                {
                    if (((BattleRegion)this.Region).Spawner != null)
                        return !((BattleRegion)this.Region).Spawner.HasPlayers();
                }

                return base.PlayerRangeSensitive;
            }
        }</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\MyrmidexDrone.cs

<pre>public override bool PlayerRangeSensitive
        {
            get
            {
                if (this.Region != null && this.Region.IsPartOf(typeof(BattleRegion)))
                {
                    if (((BattleRegion)this.Region).Spawner != null)
                        return !((BattleRegion)this.Region).Spawner.HasPlayers();
                }

                return base.PlayerRangeSensitive;
            }
        }</pre>

Fragment 4 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\MyrmidexWarrior.cs

<pre>public override bool PlayerRangeSensitive
        {
            get
            {
                if (this.Region != null && this.Region.IsPartOf(typeof(BattleRegion)))
                {
                    if (((BattleRegion)this.Region).Spawner != null)
                        return !((BattleRegion)this.Region).Spawner.HasPlayers();
                }

                return base.PlayerRangeSensitive;
            }
        }</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\SQ3Gump.cs

<pre>this.AddTextEntry(137, 252, 257, 20, 1142, 0, @"Persistence");
            this.AddTextEntry(0, 0, 200, 20, 1142, 0, @"");
            this.AddTextEntry(136, 307, 258, 20, 1142, 0, @"Control");</pre>

Fragment 2 in file Scripts\Gumps\SQ4Gump.cs

<pre>this.AddTextEntry(137, 252, 257, 20, 1142, 0, @"Control");
            this.AddTextEntry(0, 0, 200, 20, 1142, 0, @"");
            this.AddTextEntry(136, 307, 258, 20, 1142, 0, @"Persistence");</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BallotBox.cs

<pre>if (this.m_Box.Deleted || !this.m_Box.IsOwner(from))
                    return;

                if (from.Map != this.m_Box.Map || !from.InRange(this.m_Box.GetWorldLocation(), 2))
                {
                    from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
                    return;
                }</pre>

Fragment 2 in file Scripts\Items\Addons\BallotBox.cs

<pre>if (this.m_Box.Deleted || !this.m_Box.IsOwner(from))
                    return;

                if (from.Map != this.m_Box.Map || !from.InRange(this.m_Box.GetWorldLocation(), 2))
                {
                    from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
                    return;
                }</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\FountainOfFortune.cs

<pre>AddComponent(new AddonComponent(itemID++), -2, +1, 0);
            AddComponent(new AddonComponent(itemID++), -1, +1, 0);
            AddComponent(new AddonComponent(itemID++), +0, +1, 0);</pre>

Fragment 2 in file Scripts\Items\Addons\FountainOfFortune.cs

<pre>AddComponent(new AddonComponent(itemID++), +1, +0, 0);
            AddComponent(new AddonComponent(itemID++), +1, -1, 0);
            AddComponent(new AddonComponent(itemID++), +1, -2, 0);</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\MedusaNest.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                this.AddComponent(new AddonComponent(m_AddOnSimpleComponents[i, 0]), m_AddOnSimpleComponents[i, 1], m_AddOnSimpleComponents[i, 2], m_AddOnSimpleComponents[i, 3]);</pre>

Fragment 2 in file Scripts\Items\Addons\PotteryWheelAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                this.AddComponent(new AddonComponent(m_AddOnSimpleComponents[i, 0]), m_AddOnSimpleComponents[i, 1], m_AddOnSimpleComponents[i, 2], m_AddOnSimpleComponents[i, 3]);</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Books\BaseBook.cs

<pre>string title = book.Title == null ? "" : book.Title;
            string author = book.Author == null ? "" : book.Author;

            byte[] titleBuffer = Utility.UTF8.GetBytes(title);
            byte[] authorBuffer = Utility.UTF8.GetBytes(author);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlTextEntryBook.cs

<pre>string title = book.Title == null ? "" : book.Title;
			string author = book.Author == null ? "" : book.Author;

			byte[] titleBuffer = Utility.UTF8.GetBytes( title );
			byte[] authorBuffer = Utility.UTF8.GetBytes( author );</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Books\Note.cs

<pre>AddImage( 0, 0, 9380 );
				AddImage( 114, 0, 9381 );
                AddImage( 171, 0, 9382 );
                AddImage( 0, 140, 9386 );
                AddImage( 114, 140, 9387 );
                AddImage( 171, 140, 9388 );</pre>

Fragment 2 in file Scripts\Services\New Magincia\Housing Lotto\Items\WritOfLease.cs

<pre>AddImage(0, 0, 9380);
                AddImage(114, 0, 9381);
                AddImage(171, 0, 9382);
                AddImage(0, 140, 9386);
                AddImage(114, 140, 9387);
                AddImage(171, 140, 9388);</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Corpses\Corpse.cs

<pre>if (item != this && IsCriminalAction(from))
			{
				from.CriminalAction(true);
			}

			if (!m_Looters.Contains(from))
			{
				m_Looters.Add(from);
			}

			if (m_InstancedItems != null && m_InstancedItems.ContainsKey(item))
			{
				m_InstancedItems.Remove(item);
			}</pre>

Fragment 2 in file Scripts\Items\Decorative\Corpses\Corpse.cs

<pre>if (item != this && IsCriminalAction(from))
			{
				from.CriminalAction(true);
			}

			if (!m_Looters.Contains(from))
			{
				m_Looters.Add(from);
			}

			if (m_InstancedItems != null && m_InstancedItems.ContainsKey(item))
			{
				m_InstancedItems.Remove(item);
			}</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\DungeonWallAndVineAddon.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (from.X > this.X)
            {
                from.SendLocalizedMessage(1111659); // You try to examine the strange wall but the vines get in your way.
            }
            else
            {
                this.Z += -22;
                Timer.DelayCall(TimeSpan.FromSeconds(15.0), delegate()
                {
                    this.Z += 22;
                });
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\StoneWallAndVineAddon.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (from.X > this.X)
            {
                from.SendLocalizedMessage(1111659); // You try to examine the strange wall but the vines get in your way.
            }
            else
            {
                this.Z += -22;
                Timer.DelayCall(TimeSpan.FromSeconds(15.0), delegate()
                {
                    this.Z += 22;
                });
            }
        }</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if (GetSaveFlag(flags, SaveFlag.MaxHitPoints))
                            this.m_MaxHitPoints = reader.ReadEncodedInt();

                        if (GetSaveFlag(flags, SaveFlag.HitPoints))
                            this.m_HitPoints = reader.ReadEncodedInt();

                        if (GetSaveFlag(flags, SaveFlag.Crafter))
                            this.m_Crafter = reader.ReadMobile();</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if (GetSaveFlag(flags, SaveFlag.MaxHitPoints))
                            this.m_MaxHitPoints = reader.ReadEncodedInt();

                        if (GetSaveFlag(flags, SaveFlag.HitPoints))
                            this.m_HitPoints = reader.ReadEncodedInt();

                        if (GetSaveFlag(flags, SaveFlag.Crafter))
                            this.m_Crafter = reader.ReadMobile();</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\BulletinBoards.cs

<pre>string poster = this.SafeString(msg.PostedName);
            string subject = this.SafeString(msg.Subject);
            string time = this.SafeString(msg.GetTimeAsString());

            this.EnsureCapacity(22 + poster.Length + subject.Length + time.Length);</pre>

Fragment 2 in file Scripts\Items\Functional\BulletinBoards.cs

<pre>string poster = this.SafeString(msg.PostedName);
            string subject = this.SafeString(msg.Subject);
            string time = this.SafeString(msg.GetTimeAsString());

            this.EnsureCapacity(22 + poster.Length + subject.Length + time.Length);</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z), m.Map, 0x37C4, 15, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x1E2);</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X, m.Y, m.Z), m.Map, 0x37C4, 15, effHue, 0);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x1E2);</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Medusa.cs

<pre>public Item CloneItem(Item item)
        {
            Item cloned = new Item(item.ItemID);
            cloned.Layer = item.Layer;
            cloned.Name = item.Name;
            cloned.Hue = item.Hue;
            cloned.Weight = item.Weight;
            cloned.Movable = false;

            return cloned;
        }</pre>

Fragment 2 in file Scripts\Services\VeteranRewards\Character Statue Maker\CharacterStatue.cs

<pre>public Item CloneItem(Item item)
        {
            Item cloned = new Item(item.ItemID);
            cloned.Layer = item.Layer;
            cloned.Name = item.Name;
            cloned.Hue = item.Hue;
            cloned.Weight = item.Weight;
            cloned.Movable = false;

            return cloned;
        }</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\MonstrousInterredGrizzle.cs

<pre>this.PackResources(8);
            this.PackTalismans(5);

            for (int i = 0; i < Utility.RandomMinMax(1, 6); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\Travesty.cs

<pre>this.PackTalismans(5);
            this.PackResources(8);

            for (int i = 0; i < Utility.RandomMinMax(1, 6); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\LadySabrix.cs

<pre>this.SetDamage(15, 22);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 40, 50);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 30, 39);</pre>

Fragment 2 in file Scripts\Mobiles\Named\Silk.cs

<pre>this.SetDamage(15, 22);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 40, 50);
            this.SetResistance(ResistanceType.Fire, 30, 39);
            this.SetResistance(ResistanceType.Cold, 30, 40);</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\MinionOfScelestus.cs

<pre>private Type[] m_Types = new Type[]
		{
			typeof(ChallengeRite), 			typeof(AnthenaeumDecree), 		typeof(LetterFromTheKing),
			typeof(OnTheVoid),				typeof(ShilaxrinarsMemorial),	typeof(ToTheHighScholar),
			typeof(ToTheHighBroodmother),	typeof(ReplyToTheHighScholar),	typeof(AccessToTheIsle),
			typeof(InMemory)
		};</pre>

Fragment 2 in file Scripts\Quests\JourneyToTheAthenaeumIsleQuest.cs

<pre>private Type[] m_Types = new Type[]
			{
				typeof(ChallengeRite), 			typeof(AnthenaeumDecree), 		typeof(LetterFromTheKing),
				typeof(OnTheVoid),				typeof(ShilaxrinarsMemorial),	typeof(ToTheHighScholar),
				typeof(ToTheHighBroodmother),	typeof(ReplyToTheHighScholar),	typeof(AccessToTheIsle),
				typeof(InMemory)
			};</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Banker.cs

<pre>Item item;
                if (amount < 5000)
                {
                    item = new Gold(amount);
                    amount = 0;
                }
                else if (amount <= 1000000)
                {
                    item = new BankCheck(amount);
                    amount = 0;
                }
                else
                {
                    item = new BankCheck(1000000);
                    amount -= 1000000;
                }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Banker.cs

<pre>Item item;

                if (amount < 5000)
                {
                    item = new Gold(amount);
                    amount = 0;
                }
                else if (amount <= 1000000)
                {
                    item = new BankCheck(amount);
                    amount = 0;
                }
                else
                {
                    item = new BankCheck(1000000);
                    amount -= 1000000;
                }</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Deeds.cs

<pre>ArrayList toMove;
                Point3D center = new Point3D(p.X - this.m_Offset.X, p.Y - this.m_Offset.Y, p.Z - this.m_Offset.Z);
                HousePlacementResult res = HousePlacement.Check(from, this.m_MultiID, center, out toMove);</pre>

Fragment 2 in file Scripts\Multis\HousePlacementTool.cs

<pre>ArrayList toMove;
            Point3D center = new Point3D(p.X - this.m_Offset.X, p.Y - this.m_Offset.Y, p.Z - this.m_Offset.Z);
            HousePlacementResult res = HousePlacement.Check(from, this.m_MultiID, center, out toMove);</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\HuntmasterChallenge\ComplexHuntTrophy.cs

<pre>m_SouthID = id;
            m_Owner = name;
            m_Species = species;
            m_Location = location;
            m_DateKilled = killed;
            m_MeasuredBy = measuredBy;
            m_Measurement = measurement;

            //TODO: CHeck this
            switch (measuredBy)
            {
                case MeasuredBy.Weight:
                    Weight = measurement;
                    break;
                case MeasuredBy.Length:
                case MeasuredBy.Wingspan:
                    Weight = 5.0;
                    break;
            }</pre>

Fragment 2 in file Scripts\Services\HuntmasterChallenge\HuntTrophy.cs

<pre>m_SouthID = id;
            //ItemID = id;
            m_Owner = name;
			m_Species = species;
			m_Location = location;
			m_DateKilled = killed;
			m_MeasuredBy = measuredBy;
            m_Measurement = measurement;

			switch(measuredBy)
			{
				case MeasuredBy.Weight:
					Weight = measurement;
					break;
				case MeasuredBy.Length:
				case MeasuredBy.Wingspan:
					Weight = 5.0;
					break;
			}</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\HuntmasterChallenge\HuntTrophy.cs

<pre>base.GetProperties(list);

            list.Add(1155708, m_Owner != null ? m_Owner : "Unknown"); // Hunter: ~1_NAME~
            list.Add(1155709, m_DateKilled); // Date of Kill: ~1_DATE~

			if(m_Location != null)
                list.Add(1061114, m_Location); // Location: ~1_val~

            list.Add(1155718, m_Species.ToString());</pre>

Fragment 2 in file Scripts\Services\HuntmasterChallenge\HuntTrophy.cs

<pre>base.GetProperties(list);

            list.Add(1155708, m_Owner != null ? m_Owner : "Unknown"); // Hunter: ~1_NAME~
            list.Add(1155709, m_DateKilled); // Date of Kill: ~1_DATE~

            if (m_Location != null)
                list.Add(1061114, m_Location); // Location: ~1_val~

            list.Add(1155718, m_Species.ToString());</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Creatures\AgentoftheCrown.cs

<pre>PlayerMobile pm = sender.Mobile as PlayerMobile;

            Item item = ((ItemTileButtonInfo)buttonInfo).Item;

            if (!(pm != null && item.IsChildOf(pm.Backpack) && pm.InRange(this.m_Collector.Location, 7)))
                return;

            item.Delete();</pre>

Fragment 2 in file Scripts\Services\TreasuresOfTokuno\TreasuresOfTokuno.cs

<pre>PlayerMobile pm = sender.Mobile as PlayerMobile;

            Item item = ((ItemTileButtonInfo)buttonInfo).Item;

            if (!(pm != null && item.IsChildOf(pm.Backpack) && pm.InRange(this.m_Collector.Location, 7)))
                return;

            item.Delete();</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>SetSkill(SkillName.MagicResist, 65, 85);
            SetSkill(SkillName.Tactics, 65, 85);
            SetSkill(SkillName.Wrestling, 65, 85);

            Fame = 3500;
            Karma = -3500;

            PackReg(1, 2);
            PackGem(1, 2);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>SetSkill(SkillName.MagicResist, 65, 85);
            SetSkill(SkillName.Tactics, 65, 85);
            SetSkill(SkillName.Wrestling, 65, 85);

            Fame = 3500;
            Karma = -3500;

            PackReg(1, 2);
            PackGem(1, 2);</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
					string aname = objstr[1];
					Type atype = null;
					if (objstr.Length > 2)
					{
						atype = SpawnerType.GetType(objstr[2]);
					}

					// try to find the attachment on the mob
					if (XmlAttach.FindAttachmentOnMobile(m, atype, aname) != null)
						return false;
					else
						return true;
				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
					string aname = objstr[1];
					Type atype = null;
					if (objstr.Length > 2)
					{
						atype = SpawnerType.GetType(objstr[2]);
					}
					// try to find the attachment on the mob
					if (XmlAttach.FindAttachmentOnMobile(m, atype, aname) != null)
						return true;
					else
						return false;
				}</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>string dirname;

			if (System.IO.Directory.Exists(XmlSpawner.XmlSpawnDir) && filename != null && !filename.StartsWith("/") && !filename.StartsWith("\\"))
			{
				// put it in the defaults directory if it exists
				dirname = String.Format("{0}/{1}", XmlSpawnDir, filename);
			}
			else
			{
				// otherwise just put it in the main installation dir
				dirname = filename;
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>string dirname;
			if (System.IO.Directory.Exists(XmlSpawner.XmlSpawnDir) && filename != null && !filename.StartsWith("/") && !filename.StartsWith("\\"))
			{
				// put it in the defaults directory if it exists
				dirname = String.Format("{0}/{1}", XmlSpawnDir, filename);
			}
			else
			{
				// otherwise just put it in the main installation dir
				dirname = filename;
			}</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomAttacks.cs

<pre>string name, string description, SpecialAttacks id, int icon, IconTypes itype, TimeSpan duration,
            int mana, int stam, int hits, int karma, int minstr, int mindex, int minint,
            SkillName [] skills, int [] minlevel, Type [] reagents, int [] quantity</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomAttacks.cs

<pre>string name, string description, SpecialAttacks id, int icon, IconTypes itype, TimeSpan duration,
        int mana, int stam, int hits, int karma, int minstr, int mindex, int minint,
        SkillName [] skills, int [] minlevel, Type [] reagents, int [] quantity</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomDefenses.cs

<pre>string name, string description, SpecialDefenses id, int icon, IconTypes itype, TimeSpan duration,
            int mana, int stam, int hits, int karma, int minstr, int mindex, int minint,
            SkillName [] skills, int [] minlevel, Type [] reagents, int [] quantity</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomDefenses.cs

<pre>string name, string description, SpecialDefenses id, int icon, IconTypes itype, TimeSpan duration,
        int mana, int stam, int hits, int karma, int minstr, int mindex, int minint,
        SkillName [] skills, int [] minlevel, Type [] reagents, int [] quantity</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>AddImageTiled( 15, height - 110, 320, 20, 0xdb3 );

                AddButton( 130, height - 35, 0xFA8, 0xFAA, 100, GumpButtonType.Reply, 0 );
                AddLabel( 170, height - 35, 0, XmlPoints.GetText(from, 200528) );      // "Add"</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>AddImageTiled( 15, height - 110, 320, 20, 0xdb3 );

                AddButton( 130, height - 35, 0xFA8, 0xFAA, 100, GumpButtonType.Reply, 0 );
                AddLabel( 170, height - 35, 0, XmlPoints.GetText(from, 200528) );      // "Add"</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCatapult.cs

<pre>for (int i = 0; i < CatapultNorth.Length; i++)
			{
				AddComponent(new SiegeComponent(0, Name), 0, 0, 0);
			}

			// assign the facing
			if (facing < 0) facing = 3;
			if (facing > 3) facing = 0;
			Facing = facing;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>for (int i = 0; i < CatapultNorth.Length; i++)
			{
				AddComponent(new SiegeComponent(0, Name), 0, 0, 0);
			}

			// assign the facing
			if (facing < 0) facing = 3;
			if (facing > 3) facing = 0;
			Facing = facing;</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\BardSpells\Despair.cs

<pre>public override void OnCast()
		{
			BardSpell spell = SkillMasterySpell.GetSpell(Caster, this.GetType()) as BardSpell;

			if(spell != null)
			{
				spell.Expire();
                Caster.SendLocalizedMessage(1115774); //You halt your spellsong.
			}
			else
			{
				Caster.Target = new InternalTarget(this);
			}
		}</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\BardSpells\Tribulation.cs

<pre>public override void OnCast()
		{
            BardSpell spell = SkillMasterySpell.GetSpell(Caster, this.GetType()) as BardSpell;

			if(spell != null)
			{
				spell.Expire();
                Caster.SendLocalizedMessage(1115774); //You halt your spellsong.
			}
			else
			{
				Caster.Target = new InternalTarget(this);
			}
		}</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            if (this.BlessedFor == from && this.BlessedBy == from && this.RootParent == from)
            {
                list.Add(new UnBlessEntry(from, this));
            }
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            if (this.BlessedFor == from && this.BlessedBy == from && this.RootParent == from)
            {
                list.Add(new UnBlessEntry(from, this));
            }
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            if (this.BlessedFor == from && this.BlessedBy == from && this.RootParent == from)
            {
                list.Add(new UnBlessEntry(from, this));
            }
        }</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Mobiles\CityHerald.cs

<pre>Body = Female ? 0x191 : 0x190;
            HairItemID = Race.RandomHair(Female);
            FacialHairItemID = Race.RandomFacialHair(Female);
            HairHue = Race.RandomHairHue();
            Hue = Race.RandomSkinHue();

            SetStr(150);
            SetInt(50);
            SetDex(150);</pre>

Fragment 2 in file Scripts\Services\City Loyalty System\Mobiles\GuardCaptain.cs

<pre>Body = Female ? 0x191 : 0x190;
            HairItemID = Race.RandomHair(Female);
            FacialHairItemID = Race.RandomFacialHair(Female);
            HairHue = Race.RandomHairHue();
            Hue = Race.RandomSkinHue();

            SetStr(150);
            SetInt(50);
            SetDex(150);</pre>

Fragment 3 in file Scripts\Services\City Loyalty System\Trading\Mobiles\TradeMinister.cs

<pre>Body = Female ? 0x191 : 0x190;
            HairItemID = Race.RandomHair(Female);
            FacialHairItemID = Race.RandomFacialHair(Female);
            HairHue = Race.RandomHairHue();
            Hue = Race.RandomSkinHue();

            SetStr(150);
            SetInt(50);
            SetDex(150);</pre>

## Duplicated Code. Size: 114

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\BelfryAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\FountainAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\OrchardAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

Fragment 4 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\ArmorBazaarAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

Fragment 5 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\CarpenterBazaarAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

Fragment 6 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\CrystalBazaarAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

Fragment 7 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\GenericBazaarAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

Fragment 8 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\MarbleStairBazaarAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

Fragment 9 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\MetalArmourBazzarAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

Fragment 10 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\Provisioner2BazaarAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

Fragment 11 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\ProvisionerBazaarAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

Fragment 12 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\SmithBazaarAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

Fragment 13 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\StableBazaarAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

Fragment 14 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\WoodBenchBazaarAddon.cs

<pre>{

            for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );

		}</pre>

## Duplicated Code. Size: 113

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DawnsMusicBox\DawnsMusicBox.cs

<pre>writer.Write((int)this.m_Tracks.Count);

            for (int i = 0; i < this.m_Tracks.Count; i++)
                writer.Write((int)this.m_Tracks[i]);

            writer.Write((int)this.m_Level);</pre>

Fragment 2 in file Scripts\Items\Addons\DawnsMusicBox\RewardVersion\DawnsMusicBox.cs

<pre>writer.Write(this.m_Tracks.Count);

            for (int i = 0; i < this.m_Tracks.Count; i++)
                writer.Write((int)this.m_Tracks[i]);

            writer.Write((int)this.m_Level);</pre>

## Duplicated Code. Size: 113

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\HangingSkeleton.cs

<pre>{
                BaseHouse house = BaseHouse.FindHouseAt(this);  

                if (house != null && house.IsOwner(from))
                {
                    from.CloseGump(typeof(RewardDemolitionGump));
                    from.SendGump(new RewardDemolitionGump(this, 1049783)); // Do you wish to re-deed this decoration?
                }
                else
                    from.SendLocalizedMessage(1049784); // You can only re-deed this decoration if you are the house owner or originally placed the decoration.
            }</pre>

Fragment 2 in file Scripts\Items\Addons\StoneAnkh.cs

<pre>{
                BaseHouse house = BaseHouse.FindHouseAt(this);  

                if (house != null && house.IsOwner(from))
                {
                    from.CloseGump(typeof(RewardDemolitionGump));
                    from.SendGump(new RewardDemolitionGump(this, 1049783)); // Do you wish to re-deed this decoration?
                }
                else
                    from.SendLocalizedMessage(1049784); // You can only re-deed this decoration if you are the house owner or originally placed the decoration.
            }</pre>

## Duplicated Code. Size: 113

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\SeedBox\SeedBox.cs

<pre>{
                case SecureLevel.Owner: return house.IsOwner(from);
                case SecureLevel.CoOwners: return house.IsCoOwner(from);
                case SecureLevel.Friends: return house.IsFriend(from);
                case SecureLevel.Anyone: return true;
                case SecureLevel.Guild: return house.IsGuildMember(from);
            }</pre>

Fragment 2 in file Scripts\Items\Tools\ChestOfSending.cs

<pre>{
                case SecureLevel.Owner: return house.IsOwner(from);
                case SecureLevel.CoOwners: return house.IsCoOwner(from);
                case SecureLevel.Friends: return house.IsFriend(from);
				case SecureLevel.Anyone: return true;
                case SecureLevel.Guild: return house.IsGuildMember(from);
			}</pre>

## Duplicated Code. Size: 113

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\AOS.cs

<pre>writer.Write((uint)this.m_Names);
            writer.WriteEncodedInt((int)this.m_Values.Length);

            for (int i = 0; i < this.m_Values.Length; ++i)
                writer.WriteEncodedInt((int)this.m_Values[i]);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlAosAttributes.cs

<pre>writer.Write((uint)this.m_Names);
            writer.WriteEncodedInt((int)this.m_Values.Length);

            for (int i = 0; i < this.m_Values.Length; ++i)
                writer.WriteEncodedInt((int)this.m_Values[i]);</pre>

## Duplicated Code. Size: 113

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Kepetch.cs

<pre>public override void OnCarve(Mobile from, Corpse corpse, Item with)
        {
            base.OnCarve(from, corpse, with);

            if (!GatheredFur)
            {
                from.SendLocalizedMessage(1112765); // You shear it, and the fur is now on the corpse.
                corpse.AddCarvedItem(new KepetchFur(15), from);
                GatheredFur = true;
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\KepetchAmbusher.cs

<pre>public override void OnCarve(Mobile from, Corpse corpse, Item with)
        {
            base.OnCarve(from, corpse, with);

            if (!GatheredFur)
            {
                from.SendLocalizedMessage(1112765); // You shear it, and the fur is now on the corpse.
                corpse.AddCarvedItem(new KepetchFur(15), from);
                GatheredFur = true;
            }
        }</pre>

## Duplicated Code. Size: 113

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\PlayerVendor.cs

<pre>if (!Core.AOS)
                this.NameHue = 0x35;

            if (this.Female = Utility.RandomBool())
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");
            }
            else
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
            }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\TownCrier.cs

<pre>if (!Core.AOS)
                this.NameHue = 0x35;

            if (this.Female = Utility.RandomBool())
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");
            }
            else
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
            }</pre>

## Duplicated Code. Size: 113

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\PlayerMobile.cs

<pre>if (rx >= 0 && ry >= 0)
			{
				ret = Direction.West;
			}
			else if (rx >= 0 && ry < 0)
			{
				ret = Direction.South;
			}
			else if (rx < 0 && ry < 0)
			{
				ret = Direction.East;
			}
			else
			{
				ret = Direction.North;
			}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>if (rx >= 0 && ry >= 0)
			{
				ret = Direction.West;
			}
			else if (rx >= 0 && ry < 0)
			{
				ret = Direction.South;
			}
			else if (rx < 0 && ry < 0)
			{
				ret = Direction.East;
			}
			else
			{
				ret = Direction.North;
			}</pre>

## Duplicated Code. Size: 113

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlGetAttachGump.cs

<pre>if(str != null){
					string [] arglist = str.Split('.');
					ystr = arglist[arglist.Length-1];
				}
				 if(Dsort)
				 return String.Compare(ystr, xstr, true);
				 else
				 return String.Compare(xstr, ystr, true);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>if (str != null)
				{
					string[] arglist = str.Split('.');
					ystr = arglist[arglist.Length - 1];
				}
				if (Dsort)
					return String.Compare(ystr, xstr, true);
				else
					return String.Compare(xstr, ystr, true);</pre>

## Duplicated Code. Size: 113

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlAdd.cs

<pre>string filename;
					if(defs.DefsExt != null && defs.DefsExt.Length > 0)
					{
						filename = String.Format("{0}-{1}-{2}",defs.AccountName, defs.PlayerName, defs.DefsExt);
					} 
					else 
					{
						filename = String.Format("{0}-{1}",defs.AccountName, defs.PlayerName);
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlAdd.cs

<pre>string filename;
					if(defs.DefsExt != null && defs.DefsExt.Length > 0)
					{
						filename = String.Format("{0}-{1}-{2}",defs.AccountName, defs.PlayerName, defs.DefsExt);
					} 
					else 
					{
						filename = String.Format("{0}-{1}",defs.AccountName, defs.PlayerName);
					}</pre>

## Duplicated Code. Size: 113

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\HighPlainsBoura.cs

<pre>public override void OnCarve(Mobile from, Corpse corpse, Item with)
        {
            base.OnCarve(from, corpse, with);

            if (!GatheredFur)
            {
                from.SendLocalizedMessage(1112765); // You shear it, and the fur is now on the corpse.
                corpse.AddCarvedItem(new BouraFur(15), from);
                GatheredFur = true;
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\LowlandBoura.cs

<pre>public override void OnCarve(Mobile from, Corpse corpse, Item with)
        {
            base.OnCarve(from, corpse, with);

            if (!GatheredFur)
            {
                from.SendLocalizedMessage(1112765); // You shear it, and the fur is now on the corpse.
                corpse.AddCarvedItem(new BouraFur(15), from);
                GatheredFur = true;
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\RuddyBoura.cs

<pre>public override void OnCarve(Mobile from, Corpse corpse, Item with)
        {
            base.OnCarve(from, corpse, with);

            if (!GatheredFur)
            {
                from.SendLocalizedMessage(1112765); // You shear it, and the fur is now on the corpse.
                corpse.AddCarvedItem(new BouraFur(15), from);
                GatheredFur = true;
            }
        }</pre>

## Duplicated Code. Size: 113

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\YomotsuElder.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (0.1 > Utility.RandomDouble())
            {
                /* Maniacal laugh
                * Cliloc: 1070840
                * Effect: Type: "3" From: "0x57D4F5B" To: "0x0" ItemId: "0x37B9" ItemIdName: "glow" FromLocation: "(884 715, 10)" ToLocation: "(884 715, 10)" Speed: "10" Duration: "5" FixedDirection: "True" Explode: "False"
                * Paralyzes for 4 seconds, or until hit
                */
                defender.FixedEffect(0x37B9, 10, 5);
                defender.SendLocalizedMessage(1070840); // You are frozen as the creature laughs maniacally.

                defender.Paralyze(TimeSpan.FromSeconds(4.0));
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\YomotsuPriest.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender)
        {
            base.OnGaveMeleeAttack(defender);

            if (0.1 > Utility.RandomDouble())
            {
                /* Maniacal laugh
                * Cliloc: 1070840
                * Effect: Type: "3" From: "0x57D4F5B" To: "0x0" ItemId: "0x37B9" ItemIdName: "glow" FromLocation: "(884 715, 10)" ToLocation: "(884 715, 10)" Speed: "10" Duration: "5" FixedDirection: "True" Explode: "False"
                * Paralyzes for 4 seconds, or until hit
                */
                defender.FixedEffect(0x37B9, 10, 5);
                defender.SendLocalizedMessage(1070840); // You are frozen as the creature laughs maniacally.

                defender.Paralyze(TimeSpan.FromSeconds(4.0));
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\YomotsuWarrior.cs

<pre>public override void OnGaveMeleeAttack(Mobile defender) 
        {
            base.OnGaveMeleeAttack(defender);

            if (0.1 > Utility.RandomDouble())
            {
                /* Maniacal laugh
                * Cliloc: 1070840
                * Effect: Type: "3" From: "0x57D4F5B" To: "0x0" ItemId: "0x37B9" ItemIdName: "glow" FromLocation: "(884 715, 10)" ToLocation: "(884 715, 10)" Speed: "10" Duration: "5" FixedDirection: "True" Explode: "False"
                * Paralyzes for 4 seconds, or until hit
                */
                defender.FixedEffect(0x37B9, 10, 5);
                defender.SendLocalizedMessage(1070840); // You are frozen as the creature laughs maniacally.

                defender.Paralyze(TimeSpan.FromSeconds(4.0));
            }
        }</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Docs.cs

<pre>css.WriteLine("body { background-color: #FFFFFF; font-family: verdana, arial; font-size: 11px; }");
				css.WriteLine("a { color: #28435E; }");
				css.WriteLine("a:hover { color: #4878A9; }");
				css.WriteLine("td.header { background-color: #9696AA; font-weight: bold; font-size: 12px; }");
				css.WriteLine("td.lentry { background-color: #D7D7EB; width: 10%; }");
				css.WriteLine("td.rentry { background-color: #FFFFFF; width: 90%; }");
				css.WriteLine("td.entry { background-color: #FFFFFF; }");
				css.WriteLine("td { font-size: 11px; }");</pre>

Fragment 2 in file Scripts\Services\Reports\Rendering\HtmlRenderer.cs

<pre>css.WriteLine("body { background-color: #FFFFFF; font-family: verdana, arial; font-size: 11px; }");
                css.WriteLine("a { color: #28435E; }");
                css.WriteLine("a:hover { color: #4878A9; }");
                css.WriteLine("td.header { background-color: #9696AA; font-weight: bold; font-size: 12px; }");
                css.WriteLine("td.lentry { background-color: #D7D7EB; width: 10%; }");
                css.WriteLine("td.rentry { background-color: #FFFFFF; width: 90%; }");
                css.WriteLine("td.entry { background-color: #FFFFFF; }");
                css.WriteLine("td { font-size: 11px; }");</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Docs.cs

<pre>html.WriteLine("      <style type=\"text/css\">");
				html.WriteLine("      body { background-color: white; font-family: Tahoma; color: #000000; }");
				html.WriteLine("      a, a:visited { color: #000000; }");
				html.WriteLine("      a:active, a:hover { color: #808080; }");
				html.WriteLine("      </style>");
				html.WriteLine("      <link rel=\"stylesheet\" type=\"text/css\" href=\"../styles.css\" />");
				html.WriteLine("   </head>");
				html.WriteLine("   <body>");</pre>

Fragment 2 in file Scripts\Commands\Docs.cs

<pre>html.WriteLine("      <style type=\"text/css\">");
				html.WriteLine("      body { background-color: white; font-family: Tahoma; color: #000000; }");
				html.WriteLine("      a, a:visited { color: #000000; }");
				html.WriteLine("      a:active, a:hover { color: #808080; }");
				html.WriteLine("      </style>");
				html.WriteLine("      <link rel=\"stylesheet\" type=\"text/css\" href=\"../styles.css\" />");
				html.WriteLine("   </head>");
				html.WriteLine("   <body>");</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SpecialBeardDye.cs

<pre>this.AddPage(0);
            this.AddBackground(150, 60, 350, 358, 2600);
            this.AddBackground(170, 104, 110, 270, 5100);
            this.AddHtmlLocalized(230, 75, 200, 20, 1011013, false, false);		// Hair Color Selection Menu</pre>

Fragment 2 in file Scripts\Items\Consumables\SpecialHairDye.cs

<pre>this.AddPage(0);
            this.AddBackground(150, 60, 350, 358, 2600);
            this.AddBackground(170, 104, 110, 270, 5100);
            this.AddHtmlLocalized(230, 75, 200, 20, 1011013, false, false);		// Hair Color Selection Menu</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>case DoorType.LeftMetalDoor_S_In: return 1156080;
                    case DoorType.RightMetalDoor_S_In: return 1156081;
                    case DoorType.LeftMetalDoor_E_In: return 1156352;
                    case DoorType.RightMetalDoor_E_In: return 1156353;
                    case DoorType.LeftMetalDoor_S_Out: return 1156350;
                    case DoorType.RightMetalDoor_S_Out: return 1156351;
                    case DoorType.LeftMetalDoor_E_Out: return 1156082;
                    case DoorType.RightMetalDoor_E_Out: return 1156083;</pre>

Fragment 2 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>case DoorType.LeftMetalDoor_S_In: return 1156080;
                    case DoorType.RightMetalDoor_S_In: return 1156081;
                    case DoorType.LeftMetalDoor_E_In: return 1156352;
                    case DoorType.RightMetalDoor_E_In: return 1156353;
                    case DoorType.LeftMetalDoor_S_Out: return 1156350;
                    case DoorType.RightMetalDoor_S_Out: return 1156351;
                    case DoorType.LeftMetalDoor_E_Out: return 1156082;
                    case DoorType.RightMetalDoor_E_Out: return 1156083;</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\CorrosiveSlime.cs

<pre>this.Body = 51;
            this.BaseSoundID = 456;

            this.Hue = Utility.RandomSlimeHue();

            this.SetStr(22, 34);
            this.SetDex(16, 21);
            this.SetInt(16, 20);

            this.SetHits(15, 19);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Slime.cs

<pre>this.Body = 51;
            this.BaseSoundID = 456;

            this.Hue = Utility.RandomSlimeHue();

            this.SetStr(22, 34);
            this.SetDex(16, 21);
            this.SetInt(16, 20);

            this.SetHits(15, 19);</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>{
				gWidth = gWidths.Sum();
				int tab = 0;
				gTab = new int[gWidths.Length];
				for (int i = 0; i < gWidths.Length; ++i)
				{
					gTab[i] = tab;
					tab += gWidths[i];
				}
			}</pre>

Fragment 2 in file Scripts\Services\ChampionSystem\ChampionSystem.cs

<pre>{
				gWidth = gWidths.Sum();
				int tab = 0;
				gTab = new int[gWidths.Length];
				for(int i = 0; i < gWidths.Length; ++i)
				{
					gTab[i] = tab;
					tab += gWidths[i];
				}
			}</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\PickRulesetGump.cs

<pre>this.AddBackground(0, 0, 260, height, 9250);
            this.AddBackground(10, 10, 240, height - 20, 0xDAC);

            this.AddHtml(35, 25, 190, 20, this.Center("Rules"), false, false);</pre>

Fragment 2 in file Scripts\Services\ConPVP\ReadyUpGump.cs

<pre>this.AddBackground(0, 0, 260, height, 9250);
                this.AddBackground(10, 10, 240, height - 20, 0xDAC);

                this.AddHtml(35, 25, 190, 20, this.Center("Rules"), false, false);</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomAttacks.cs

<pre>ChainTime = duration;
                Icon = icon;
                IconType = itype;
                ManaReq = mana;
                StamReq = stam;
                HitsReq = hits;
                KarmaReq = karma;
                StrReq = minstr;
                DexReq = mindex;
                IntReq = minint;
                Reagents = reagents;
                Quantity = quantity;
                Skills = skills;
                MinSkillLevel = minlevel;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomDefenses.cs

<pre>ChainTime = duration;
                Icon = icon;
                IconType = itype;
                ManaReq = mana;
                StamReq = stam;
                HitsReq = hits;
                KarmaReq = karma;
                StrReq = minstr;
                DexReq = mindex;
                IntReq = minint;
                Reagents = reagents;
                Quantity = quantity;
                Skills = skills;
                MinSkillLevel = minlevel;</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Server\ScriptCompiler.cs

<pre>string fileName = kvp.Key;
					var list = kvp.Value;

					string fullPath = Path.GetFullPath(fileName);
					string usedPath = Uri.UnescapeDataString(scriptRootUri.MakeRelativeUri(new Uri(fullPath)).OriginalString);

					Console.WriteLine(" + {0}:", usedPath);</pre>

Fragment 2 in file Server\ScriptCompiler.cs

<pre>string fileName = kvp.Key;
					var list = kvp.Value;

					string fullPath = Path.GetFullPath(fileName);
					string usedPath = Uri.UnescapeDataString(scriptRootUri.MakeRelativeUri(new Uri(fullPath)).OriginalString);

					Console.WriteLine(" + {0}:", usedPath);</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Axem.cs

<pre>public override void InitOutfit()
        {
            AddItem(new Backpack());

            AddItem(new GargishClothChest(Utility.RandomNeutralHue()));
            AddItem(new GargishClothKilt(Utility.RandomNeutralHue()));
            AddItem(new GargishClothLegs(Utility.RandomNeutralHue()));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Laifem.cs

<pre>public override void InitOutfit()
        {
            AddItem(new Backpack());

            AddItem(new GargishClothChest(Utility.RandomNeutralHue()));
            AddItem(new GargishClothKilt(Utility.RandomNeutralHue()));
            AddItem(new GargishClothLegs(Utility.RandomNeutralHue()));
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Sliem.cs

<pre>public override void InitOutfit()
        {
            AddItem(new Backpack());

            AddItem(new GargishClothChest(Utility.RandomNeutralHue()));
            AddItem(new GargishClothKilt(Utility.RandomNeutralHue()));
            AddItem(new GargishClothLegs(Utility.RandomNeutralHue()));
        }</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainQuestGump.cs

<pre>this.AddHtmlLocalized(130, 45, 270, 16, 3006156, 0xFFFFFF, false, false); // Quest Conversation
                this.AddImage(140, 110, 0x4B9);
                this.AddHtmlObject(160, 70, 200, 40, this.m_Quest.Title, DarkGreen, false, false);</pre>

Fragment 2 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainQuestGump.cs

<pre>this.AddHtmlLocalized(130, 45, 270, 16, 3006156, 0xFFFFFF, false, false); // Quest Conversation				
            this.AddImage(140, 110, 0x4B9);
            this.AddHtmlObject(160, 70, 200, 40, this.m_Quest.Title, DarkGreen, false, false);</pre>

Fragment 3 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainQuestGump.cs

<pre>this.AddHtmlLocalized(130, 45, 270, 16, 3006156, 0xFFFFFF, false, false); // Quest Conversation
            this.AddImage(140, 110, 0x4B9);
            this.AddHtmlObject(160, 70, 200, 40, this.m_Quest.Title, DarkGreen, false, false);</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\BoxOfTransmutation.cs

<pre>BaseSocketAugmentation augment = null;
                    if(Items.Count > 0)
                    {
                        augment = Items[0] as BaseSocketAugmentation;
                    }

                    if(augment == null) return;

                    // make sure they are all the same
                    foreach(Item i in Items)
                    {
                        if(augment.GetType() != i.GetType()) return;
                    }

                    // take the ingredients
                    ConsumeAll();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\BoxOfTransmutation.cs

<pre>BaseSocketAugmentation augment = null;
                    if(Items.Count > 0)
                    {
                        augment = Items[0] as BaseSocketAugmentation;
                    }

                    if(augment == null) return;

                    // make sure they are all the same
                    foreach(Item i in Items)
                    {
                        if(augment.GetType() != i.GetType()) return;
                    }

                    // take the ingredients
                    ConsumeAll();</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\BoxOfTransmutation.cs

<pre>BaseSocketAugmentation augment = null;
                    if(Items.Count > 0)
                    {
                        augment = Items[0] as BaseSocketAugmentation;
                    }

                    if(augment == null) return;

                    // make sure they are all the same
                    foreach(Item i in Items)
                    {
                        if(augment.GetType() != i.GetType()) return;
                    }

                    // take the ingredients
                    ConsumeAll();</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write((short)m.X);
			m_Stream.Write((short)m.Y);
			m_Stream.Write((short)0);
			m_Stream.Write((byte)m.Direction);
			m_Stream.Write((sbyte)m.Z);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write((short)m.X);
			m_Stream.Write((short)m.Y);
			m_Stream.Write((short)0);
			m_Stream.Write((byte)m.Direction);
			m_Stream.Write((sbyte)m.Z);</pre>

Fragment 3 in file Server\Network\Packets.cs

<pre>m_Stream.Write((short)m.X);
			m_Stream.Write((short)m.Y);
			m_Stream.Write((short)m.Z);
			m_Stream.Write((byte)m.Direction);
			m_Stream.Write((byte)0);</pre>

## Duplicated Code. Size: 112

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\ArmorPierce.cs

<pre>public override bool CheckSkills(Mobile from)
        {
            if (this.GetSkill(from, SkillName.Ninjitsu) < 50.0 && this.GetSkill(from, SkillName.Bushido) < 50.0)
            {
                from.SendLocalizedMessage(1063347, "50"); // You need ~1_SKILL_REQUIREMENT~ Bushido or Ninjitsu skill to perform that attack!
                return false;
            }

            return base.CheckSkills(from);
        }</pre>

Fragment 2 in file Scripts\Abilities\Block.cs

<pre>public override bool CheckSkills(Mobile from)
        {
            if (this.GetSkill(from, SkillName.Ninjitsu) < 50.0 && this.GetSkill(from, SkillName.Bushido) < 50.0)
            {
                from.SendLocalizedMessage(1063347, "50"); // You need ~1_SKILL_REQUIREMENT~ Bushido or Ninjitsu skill to perform that attack!
                return false;
            }

            return base.CheckSkills(from);
        }</pre>

Fragment 3 in file Scripts\Abilities\DefenseMastery.cs

<pre>public override bool CheckSkills(Mobile from)
        {
            if (this.GetSkill(from, SkillName.Ninjitsu) < 50.0 && this.GetSkill(from, SkillName.Bushido) < 50.0)
            {
                from.SendLocalizedMessage(1063347, "50"); // You need ~1_SKILL_REQUIREMENT~ Bushido or Ninjitsu skill to perform that attack!
                return false;
            }

            return base.CheckSkills(from);
        }</pre>

Fragment 4 in file Scripts\Abilities\DoubleShot.cs

<pre>public override bool CheckSkills(Mobile from)
        {
            if (this.GetSkill(from, SkillName.Ninjitsu) < 50.0 && this.GetSkill(from, SkillName.Bushido) < 50.0)
            {
                from.SendLocalizedMessage(1063347, "50"); // You need ~1_SKILL_REQUIREMENT~ Bushido or Ninjitsu skill to perform that attack!
                return false;
            }

            return base.CheckSkills(from);
        }</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>if (this.m_Params[i].StartsWith("ResetDelay"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                resetDelay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                        }</pre>

Fragment 2 in file Scripts\Commands\Decorate.cs

<pre>if (this.m_Params[i].StartsWith("ResetDelay"))
                        {
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                resetDelay = TimeSpan.Parse(this.m_Params[i].Substring(++indexOf));
                        }</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\HouseTransferGump.cs

<pre>this.Closable = false;

            this.AddPage(0);

            this.AddBackground(0, 0, 420, 280, 5054);

            this.AddImageTiled(10, 10, 400, 20, 2624);
            this.AddAlphaRegion(10, 10, 400, 20);</pre>

Fragment 2 in file Scripts\Items\Internal\Moongate.cs

<pre>this.Closable = false;

                this.AddPage(0);

                this.AddBackground(0, 0, 420, 280, 5054);

                this.AddImageTiled(10, 10, 400, 20, 2624);
                this.AddAlphaRegion(10, 10, 400, 20);</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetDateTimeGump.cs

<pre>AddPage(0);

			AddBackground(0, 0, BackWidth, BackHeight, BackGumpID);
			AddImageTiled(BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), TotalHeight, OffsetGumpID);

			AddRect(0, prop.Name, 0, -1);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetTimeSpanGump.cs

<pre>AddPage( 0 );

			AddBackground( 0, 0, BackWidth, BackHeight, BackGumpID );
			AddImageTiled( BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), TotalHeight, OffsetGumpID );

			AddRect( 0, prop.Name, 0, -1 );</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if ((prop = this.ComputeStatReq(StatType.Str)) > 0)
                list.Add(1061170, prop.ToString()); // strength requirement ~1_val~

            if (this.m_HitPoints >= 0 && this.m_MaxHitPoints > 0)
                list.Add(1060639, "{0}\t{1}", this.m_HitPoints, this.m_MaxHitPoints); // durability ~1_val~ / ~2_val~</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if ((prop = this.ComputeStatReq(StatType.Str)) > 0)
                list.Add(1061170, prop.ToString()); // strength requirement ~1_val~

            if (this.m_HitPoints >= 0 && this.m_MaxHitPoints > 0)
                list.Add(1060639, "{0}\t{1}", this.m_HitPoints, this.m_MaxHitPoints); // durability ~1_val~ / ~2_val~</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\HellHound.cs

<pre>this.SetStr(102, 150);
            this.SetDex(81, 105);
            this.SetInt(36, 60);

            this.SetHits(66, 125);

            this.SetDamage(11, 17);

            this.SetDamageType(ResistanceType.Physical, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Icehound.cs

<pre>this.SetStr(102, 150);
            this.SetDex(81, 105);
            this.SetInt(36, 60);

            this.SetHits(66, 125);

            this.SetDamage(11, 17);

            this.SetDamageType(ResistanceType.Physical, 20);</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Boats\BaseBoat.cs

<pre>if (message is string)
            {
                if (m_TillerMan is Mobile)
                    ((Mobile)m_TillerMan).Say((string)message);
                else if (m_TillerMan is Server.Items.TillerMan)
                    ((Server.Items.TillerMan)m_TillerMan).Say(1060658, (string)message);
            }</pre>

Fragment 2 in file Scripts\Multis\Boats\BaseBoat.cs

<pre>if (message is string)
            {
                if (m_TillerMan is Mobile)
                    ((Mobile)m_TillerMan).Say((string)message);
                else if (m_TillerMan is Server.Items.TillerMan)
                    ((Server.Items.TillerMan)m_TillerMan).Say(1060658, (string)message);
            }</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>AddButton(100, 285, 2103, 2104, 1, GumpButtonType.Reply, 0);

            AddHtmlLocalized(115, 300, 150, 16, 1152889, false, false); // Cancel
            AddButton(100, 305, 2103, 2104, 2, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>AddButton(100, 285, 2103, 2104, 1, GumpButtonType.Reply, 0);

            AddHtmlLocalized(115, 300, 150, 16, 1152889, false, false); // Cancel
            AddButton(100, 305, 2103, 2104, 2, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefCartography.cs

<pre>AddRes(index, typeof(TreasureMap), 1073498, 5, 1073499);
            AddRes(index, typeof(TreasureMap), 1073500, 3, 1073501);
            AddRes(index, typeof(TreasureMap), 1073502, 1, 1073503);
            AddResCallback(index, ConsumeTatteredWallMapRes);</pre>

Fragment 2 in file Scripts\Services\Craft\DefCartography.cs

<pre>AddRes(index, typeof(TreasureMap), 1073498, 5, 1073499);
            AddRes(index, typeof(TreasureMap), 1073500, 3, 1073501);
            AddRes(index, typeof(TreasureMap), 1073502, 1, 1073503);
            AddResCallback(index, ConsumeTatteredWallMapRes);</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainQuestGump.cs

<pre>offset += 16;

                            if (this.ReturnTo() != null)
                            {
                                this.AddHtmlLocalized(103, offset, 120, 16, 1074782, 0x15F90, false, false); // Return to	
                                this.AddLabel(223, offset, 0x481, this.ReturnTo());  // %return to%		

                                offset += 16;
                            }</pre>

Fragment 2 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainQuestGump.cs

<pre>offset += 16;

                            if (this.ReturnTo() != null)
                            {
                                this.AddHtmlLocalized(103, offset, 120, 16, 1074782, 0x15F90, false, false); // Return to	
                                this.AddLabel(223, offset, 0x481, this.ReturnTo());  // %return to%

                                offset += 16;
                            }</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>var altar = new ShameAltar(typeof(QuartzElemental), new Point3D(5490, 19, -25), new Point3D(5514, 10, 5), new Point3D(5387, 11, 30), 10);
                WeakEntityCollection.Add("newshame", altar);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>var altar = new ShameAltar(typeof(QuartzElemental), new Point3D(5490, 19, -25), new Point3D(5514, 10, 5), new Point3D(5387, 11, 30), 10);
                WeakEntityCollection.Add("newshame", altar);</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Items\CorrosiveAsh.cs

<pre>{
                from.Backpack.ConsumeTotal(new Type[] { typeof(CursedOilstone), typeof(CorrosiveAsh) },
                                           new int[] { 1, 1 });

                this.Consume();

                from.AddToBackpack(new WhetstoneOfEnervation());
                from.SendLocalizedMessage(1151812); // You have managed to form the items into a rancid smelling, crag covered, hardened lump. In a moment of prescience, you realize what it must be named. The Whetstone of Enervation!
            }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Items\QuartzGrit.cs

<pre>{
                from.Backpack.ConsumeTotal(new Type[] { typeof(CursedOilstone), typeof(CorrosiveAsh) },
                                           new int[] { 1, 1 });

                this.Consume();

                from.AddToBackpack(new WhetstoneOfEnervation());
                from.SendLocalizedMessage(1151812); // You have managed to form the items into a rancid smelling, crag covered, hardened lump. In a moment of prescience, you realize what it must be named. The Whetstone of Enervation!
            }</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusArchZealot.cs

<pre>AddImage(430, 9, 10441);
            AddImageTiled(40, 38, 17, 391, 9263);
            AddImage(6, 25, 10421);
            AddImage(34, 12, 10420);
            AddImageTiled(94, 25, 342, 15, 10304);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolderGumps.cs

<pre>AddImage(430, 9, 10441);
            AddImageTiled(40, 38, 17, 391, 9263);
            AddImage(6, 25, 10421);
            AddImage(34, 12, 10420);
            AddImageTiled(94, 25, 342, 15, 10304); // top border</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>public void CheckRewardItem()
		{
			// go through all reward items and delete anything that is movable.  This blocks any exploits where players might
			// try to add items themselves
			if (m_RewardItem != null && !m_RewardItem.Deleted && m_RewardItem is Container)
			{
				foreach (Item i in ((Container)m_RewardItem).FindItemsByType(typeof(Item), true))
				{
					if (i.Movable)
					{
						i.Delete();
					}
				}
			}

		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>public void CheckRewardItem()
        {
            // go through all reward items and delete anything that is movable.  This blocks any exploits where players might
            // try to add items themselves
            if (m_RewardItem != null && !m_RewardItem.Deleted && m_RewardItem is Container)
            {
                foreach (Item i in ((Container)m_RewardItem).FindItemsByType(typeof(Item), true))
                {
                    if (i.Movable)
                    {
                        i.Delete();
                    }
                }
            }

        }</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>for(int x=ToDelete.Count - 1; x>=0; --x)//BaseXmlSpawner.KeywordTag i in ToDelete)
			{
				BaseXmlSpawner.KeywordTag i = ToDelete[x];
				if (i != null && !i.Deleted)
				{
					i.Delete();
				}
			}

			// Check if anything has been removed
			if (removed == true)
				InvalidateProperties();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>for(int x=ToDelete.Count - 1; x>=0; --x)//BaseXmlSpawner.KeywordTag i in ToDelete)
			{
				BaseXmlSpawner.KeywordTag i = ToDelete[x];
				if (i != null && !i.Deleted)
				{
					i.Delete();
				}
			}

			// Check if anything has been removed
			if (removed == true)
				InvalidateProperties();</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>AddLabel(20, 40, 0, XmlPoints.GetText(from, 200591));    // "Team"
				AddLabel(75, 40, 0, XmlPoints.GetText(from, 200596));    // "Members"
				AddLabel(135, 40, 0, XmlPoints.GetText(from, 200597));    // "Active"</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>AddLabel( 20, 40, 0, XmlPoints.GetText(from, 200591));    // "Team"
    			AddLabel( 75, 40, 0, XmlPoints.GetText(from, 200596));    // "Members"
    			AddLabel( 135, 40, 0, XmlPoints.GetText(from, 200597));    // "Active"</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Server\Point3DList.cs

<pre>if ((m_Count + 1) > m_List.Length)
			{
				var old = m_List;
				m_List = new Point3D[old.Length * 2];

				for (int i = 0; i < old.Length; ++i)
				{
					m_List[i] = old[i];
				}
			}</pre>

Fragment 2 in file Server\Point3DList.cs

<pre>if ((m_Count + 1) > m_List.Length)
			{
				var old = m_List;
				m_List = new Point3D[old.Length * 2];

				for (int i = 0; i < old.Length; ++i)
				{
					m_List[i] = old[i];
				}
			}</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Beetle.cs

<pre>public override bool OnDragDrop(Mobile from, Item item)
        {
            if (this.CheckFeed(from, item))
                return true;

            if (PackAnimal.CheckAccess(this, from))
            {
                this.AddToBackpack(item);
                return true;
            }

            return base.OnDragDrop(from, item);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\PackHorse.cs

<pre>public override bool OnDragDrop(Mobile from, Item item)
        {
            if (this.CheckFeed(from, item))
                return true;

            if (PackAnimal.CheckAccess(this, from))
            {
                this.AddToBackpack(item);
                return true;
            }

            return base.OnDragDrop(from, item);
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\PackLlama.cs

<pre>public override bool OnDragDrop(Mobile from, Item item)
        {
            if (this.CheckFeed(from, item))
                return true;

            if (PackAnimal.CheckAccess(this, from))
            {
                this.AddToBackpack(item);
                return true;
            }

            return base.OnDragDrop(from, item);
        }</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>if (this.m_Creatures != null)
            {
                for (int i = 0; i < this.m_Creatures.Count; ++i)
                {
                    Mobile mob = this.m_Creatures[i];

                    if (!mob.Player)
                        mob.Delete();
                }

                this.m_Creatures.Clear();
            }</pre>

Fragment 2 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>if (this.m_Creatures != null)
                            {
                                for (int i = 0; i < this.m_Creatures.Count; ++i)
                                {
                                    Mobile mob = this.m_Creatures[i];

                                    if (!mob.Player)
                                        mob.Delete();
                                }

                                this.m_Creatures.Clear();
                            }</pre>

Fragment 3 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>if (this.m_Creatures != null)
            {
                for (int i = 0; i < this.m_Creatures.Count; ++i)
                {
                    Mobile mob = this.m_Creatures[i];

                    if (!mob.Player)
                        mob.Delete();
                }

                this.m_Creatures.Clear();
            }</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.Parent == null && Utility.InRange(this.Location, m.Location, 1) && !Utility.InRange(this.Location, oldLocation, 1))
                Ankhs.Resurrect(m, this);
        }</pre>

Fragment 2 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
            {
                if (this.Parent == null && Utility.InRange(this.Location, m.Location, 1) && !Utility.InRange(this.Location, oldLocation, 1))
                    Ankhs.Resurrect(m, this);
            }</pre>

Fragment 3 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.Parent == null && Utility.InRange(this.Location, m.Location, 1) && !Utility.InRange(this.Location, oldLocation, 1))
                Ankhs.Resurrect(m, this);
        }</pre>

Fragment 4 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
            {
                if (this.Parent == null && Utility.InRange(this.Location, m.Location, 1) && !Utility.InRange(this.Location, oldLocation, 1))
                    Ankhs.Resurrect(m, this);
            }</pre>

Fragment 5 in file Scripts\Services\BasketWeaving\SilverSapling.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (this.Parent == null && Utility.InRange(this.Location, m.Location, 1) && !Utility.InRange(this.Location, oldLocation, 1))
                Ankhs.Resurrect(m, this);
        }</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>break;
				case 12:
					// page up
					// try doing the default for non-participants
					int nplayers = 0;
					if (m_gauntlet.Participants != null)
						nplayers = m_gauntlet.Participants.Count;

					int page = viewpage + 1;
					if (page > (int)(nplayers / PlayersPerPage))
					{
						page = (int)(nplayers / PlayersPerPage);
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>break;
                case 12:
                    // page up
                    // try doing the default for non-participants
                    int nplayers = 0;
                    if(m_gauntlet.Participants != null)
                        nplayers = m_gauntlet.Participants.Count;

                    int page = viewpage+1;
                    if(page > (int)(nplayers/PlayersPerPage))
                    {
                        page = (int)(nplayers/PlayersPerPage);
                    }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>break;
                case 12:
                    // page up
                    // try doing the default for non-participants
                    int nplayers = 0;
                    if(m_gauntlet.Participants != null)
                        nplayers = m_gauntlet.Participants.Count;

                    int page = viewpage+1;
                    if(page > (int)(nplayers/PlayersPerPage))
                    {
                        page = (int)(nplayers/PlayersPerPage);
                    }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>break;
                case 12:
                    // page up
                    // try doing the default for non-participants
                    int nplayers = 0;
                    if(m_gauntlet.Participants != null)
                        nplayers = m_gauntlet.Participants.Count;

                    int page = viewpage+1;
                    if(page > (int)(nplayers/PlayersPerPage))
                    {
                        page = (int)(nplayers/PlayersPerPage);
                    }</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>break;
                case 12:
                    // page up
                    // try doing the default for non-participants
                    int nplayers = 0;
                    if(m_gauntlet.Participants != null)
                        nplayers = m_gauntlet.Participants.Count;

                    int page = viewpage+1;
                    if(page > (int)(nplayers/PlayersPerPage))
                    {
                        page = (int)(nplayers/PlayersPerPage);
                    }</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>break;
                case 12:
                    // page up
                    // try doing the default for non-participants
                    int nplayers = 0;
                    if(m_gauntlet.Participants != null)
                        nplayers = m_gauntlet.Participants.Count;

                    int page = viewpage+1;
                    if(page > (int)(nplayers/PlayersPerPage))
                    {
                        page = (int)(nplayers/PlayersPerPage);
                    }</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>break;
                case 12:
                    // page up
                    // try doing the default for non-participants
                    int nplayers = 0;
                    if(m_gauntlet.Participants != null)
                        nplayers = m_gauntlet.Participants.Count;

                    int page = viewpage+1;
                    if(page > (int)(nplayers/PlayersPerPage))
                    {
                        page = (int)(nplayers/PlayersPerPage);
                    }</pre>

Fragment 8 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>break;
                case 12:
                    // page up
                    // try doing the default for non-participants
                    int nplayers = 0;
                    if(m_gauntlet.Participants != null)
                        nplayers = m_gauntlet.Participants.Count;

                    int page = viewpage+1;
                    if(page > (int)(nplayers/PlayersPerPage))
                    {
                        page = (int)(nplayers/PlayersPerPage);
                    }</pre>

Fragment 9 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>break;
                case 12:
                    // page up
                    // try doing the default for non-participants
                    int nplayers = 0;
                    if(m_gauntlet.Participants != null)
                        nplayers = m_gauntlet.Participants.Count;

                    int page = viewpage+1;
                    if(page > (int)(nplayers/PlayersPerPage))
                    {
                        page = (int)(nplayers/PlayersPerPage);
                    }</pre>

## Duplicated Code. Size: 111

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\GeoffreyCampAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\BarAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 4 in file Scripts\Services\ExploringTheDeep\Addons\CousteauPerronAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent(new AddonComponent(m_AddOnSimpleComponents[i, 0]), m_AddOnSimpleComponents[i, 1], m_AddOnSimpleComponents[i, 2], m_AddOnSimpleComponents[i, 3]);</pre>

Fragment 5 in file Scripts\Services\FireCasino\TentBrownAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 6 in file Scripts\Services\FireCasino\TentWhiteAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 7 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\Alchemist2BazaarAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 8 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\ArtistBazaarAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 9 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\CarpetedStairBazaarAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 10 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\DistilleryBazaarAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 11 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\EvilBazaarAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 12 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\FishermanBazaarAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 13 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\JewelerBazaarAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 14 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\LeatherArmourBazaarAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 15 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\PillowBazaarAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 16 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\ScribeBazaarAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 17 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\Tailor2BazaarAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

Fragment 18 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\TailorBazaarAddon.cs

<pre>for (int i = 0; i < m_AddOnSimpleComponents.Length / 4; i++)
                AddComponent( new AddonComponent( m_AddOnSimpleComponents[i,0] ), m_AddOnSimpleComponents[i,1], m_AddOnSimpleComponents[i,2], m_AddOnSimpleComponents[i,3] );</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X , m.Y + 1, m.Z), m.Map, 0x374A, 15);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x1f7);</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(m.X , m.Y + 1, m.Z), m.Map, 0x374A, 15);
                    Effects.PlaySound(new Point3D(m.X, m.Y, m.Z), m.Map, 0x1f7);</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\InhumanSpeech.cs

<pre>response.Replace(responseWord[0], Char.ToUpper(responseWord[0]), 0, 1);
                            response.Replace(secondResponseWord[0], Char.ToUpper(secondResponseWord[0]), responseWord.Length + 2, 1);
                            break;</pre>

Fragment 2 in file Scripts\Misc\InhumanSpeech.cs

<pre>response.Replace(responseWord[0], Char.ToUpper(responseWord[0]), 0, 1);
                            response.Replace(secondResponseWord[0], Char.ToUpper(secondResponseWord[0]), responseWord.Length + 2, 1);
                            break;</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\PrimevalLich.cs

<pre>AOS.Damage(m, this, (int)damage, 0, 0, 100, 0, 0);

                if (m.Alive && m.Body.IsHuman && !m.Mounted)
                    m.Animate(20, 7, 1, true, false, 0); // take hit</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Mobiles\Corgul\CorgulTheSoulbinder.cs

<pre>AOS.Damage(m, this, (int)damage, 100, 0, 0, 0, 0);
                if (m.Alive && m.Body.IsHuman && !m.Mounted)
                    m.Animate(20, 7, 1, true, false, 0);</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>if (amount > disruptThreshold)
            {
                BandageContext c = BandageContext.GetContext(this);

                if (c != null)
                {
                    c.Slip();
                }
            }

            if (Confidence.IsRegenerating(this))
            {
                Confidence.StopRegenerating(this);
            }

            WeightOverloading.FatigueOnDamage(this, amount);</pre>

Fragment 2 in file Scripts\Mobiles\PlayerMobile.cs

<pre>if (amount > disruptThreshold)
			{
				BandageContext c = BandageContext.GetContext(this);

				if (c != null)
				{
					c.Slip();
				}
			}

			if (Confidence.IsRegenerating(this))
			{
				Confidence.StopRegenerating(this);
			}

			WeightOverloading.FatigueOnDamage(this, amount);</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseRenowned.cs

<pre>public Item CreateArtifact(Type[] list)
        {
            if (list.Length == 0)
                return null;

            int random = Utility.Random(list.Length);

            Type type = list[random];

            Item artifact = Loot.Construct(type);

            return artifact;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseSABosses.cs

<pre>public Item CreateArtifact(Type[] list)
        {
            if (list.Length == 0)
                return null;

            int random = Utility.Random(list.Length);

            Type type = list[random];

            Item artifact = Loot.Construct(type);

            return artifact;
        }</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\CrystalLatticeSeeker.cs

<pre>this.Fame = 17000;
            this.Karma = -17000;

            for (int i = 0; i < Utility.RandomMinMax(0, 2); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\CrystalVortex.cs

<pre>this.Fame = 17000;
            this.Karma = -17000;

            for (int i = 0; i < Utility.RandomMinMax(0, 2); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\FetidEssence.cs

<pre>this.Fame = 3700;  // Guessed
            this.Karma = -3700;  // Guessed

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\InterredGrizzle .cs

<pre>this.Fame = 3700;  // Guessed
            this.Karma = -3700;  // Guessed

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\OrcBomber.cs

<pre>SetResistance(ResistanceType.Physical, 25, 35);
            SetResistance(ResistanceType.Fire, 30, 40);
            SetResistance(ResistanceType.Cold, 15, 25);
            SetResistance(ResistanceType.Poison, 15, 20);
            SetResistance(ResistanceType.Energy, 25, 30);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\OrcScout.cs

<pre>SetResistance(ResistanceType.Physical, 25, 35);
			SetResistance(ResistanceType.Fire, 30, 40);
			SetResistance(ResistanceType.Cold, 15, 25);
			SetResistance(ResistanceType.Poison, 15, 20);
			SetResistance(ResistanceType.Energy, 25, 30);</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Raptor.cs

<pre>SetResistance(ResistanceType.Physical, 45, 50);
			SetResistance(ResistanceType.Fire, 50, 60);
			SetResistance(ResistanceType.Cold, 40, 50);
			SetResistance(ResistanceType.Poison, 20, 30);
			SetResistance(ResistanceType.Energy, 30, 40);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingDrake.cs

<pre>SetResistance( ResistanceType.Physical, 45, 50 );
			SetResistance( ResistanceType.Fire, 50, 60 );
			SetResistance( ResistanceType.Cold, 40, 50 );
			SetResistance( ResistanceType.Poison, 20, 30 );
			SetResistance( ResistanceType.Energy, 30, 40 );</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\ArcherGuard.cs

<pre>private class AvengeTimer : Timer
		{
			private readonly Mobile m_Focus;

			public AvengeTimer(Mobile focus)
				: base(TimeSpan.FromSeconds(2.5), TimeSpan.FromSeconds(1.0), 3)
				// After 2.5 seconds, one guard will spawn every 1.0 second, three times
			{
				m_Focus = focus;
			}

			protected override void OnTick()
			{
				Spawn(m_Focus, m_Focus, 1, true);
			}
		}</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\WarriorGuard.cs

<pre>private class AvengeTimer : Timer
		{
			private readonly Mobile m_Focus;

			public AvengeTimer(Mobile focus)
				: base(TimeSpan.FromSeconds(2.5), TimeSpan.FromSeconds(1.0), 3)
			{
				m_Focus = focus;
			}

			protected override void OnTick()
			{
				Spawn(m_Focus, m_Focus, 1, true);
			}
		}</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\PlayerMobile.cs

<pre>if (m_Values == null)
				{
					m_Values = new TitleInfo[ChampionSpawnInfo.Table.Length];
				}

				if (index < 0 || index >= m_Values.Length || value <= 0)
				{
					return;
				}

				if (m_Values[index] == null)
				{
					m_Values[index] = new TitleInfo();
				}</pre>

Fragment 2 in file Scripts\Mobiles\PlayerMobile.cs

<pre>if (m_Values == null)
				{
					m_Values = new TitleInfo[ChampionSpawnInfo.Table.Length];
				}

				if (index < 0 || index >= m_Values.Length || value <= 0)
				{
					return;
				}

				if (m_Values[index] == null)
				{
					m_Values[index] = new TitleInfo();
				}</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\Core\CraftGump.cs

<pre>if (craftItem.NameNumber > 0)
                        this.AddHtmlLocalized(255, 63 + (index * 20), 220, 18, craftItem.NameNumber, LabelColor, false, false);
                    else
                        this.AddLabel(255, 60 + (index * 20), LabelHue, craftItem.NameString);</pre>

Fragment 2 in file Scripts\Services\Craft\Core\CraftGump.cs

<pre>if (craftItem.NameNumber > 0)
                    this.AddHtmlLocalized(255, 63 + (index * 20), 220, 18, craftItem.NameNumber, LabelColor, false, false);
                else
                    this.AddLabel(255, 60 + (index * 20), LabelHue, craftItem.NameString);</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, -2, -18, 0, 1779, -1, "", 1);// 1773
			AddComplexComponent( (BaseAddon) this, 2769, -1, -18, 0, 1779, -1, "", 1);// 1775</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, -18, -1, 0, 1779, -1, "", 1);// 2052
			AddComplexComponent( (BaseAddon) this, 2769, -18, -2, 0, 1779, -1, "", 1);// 2053</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGauntlet.cs

<pre>case 0:
                m_Challenger = reader.ReadMobile();

                m_Organizers.Add(m_Challenger);

                m_GameLocked = reader.ReadBool();
                m_GameInProgress = reader.ReadBool();
                m_TotalPurse = reader.ReadInt();
                m_EntryFee = reader.ReadInt();
                m_ArenaSize = reader.ReadInt();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGauntlet.cs

<pre>case 0:
                m_Challenger = reader.ReadMobile();

                m_Organizers.Add(m_Challenger);

                m_GameLocked = reader.ReadBool();
                m_GameInProgress = reader.ReadBool();
                m_TotalPurse = reader.ReadInt();
                m_EntryFee = reader.ReadInt();
                m_ArenaSize = reader.ReadInt();</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>{
                        AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10116, GumpButtonType.Reply, 0);
                        AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075617, LabelColor, false, false);       //Faster Casting
                        yOffset += 1;
                    }</pre>

Fragment 2 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>{
                        AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10116, GumpButtonType.Reply, 0);
                        AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1075617, LabelColor, false, false);       //Faster Casting
                        yOffset += 1;
                    }</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Fifth\MagicReflect.cs

<pre>ResistanceMod[] mods = (ResistanceMod[])m_Table[m];

                if (mods != null)
                {
                    for (int i = 0; i < mods.Length; ++i)
                        m.RemoveResistanceMod(mods[i]);
                }

                m_Table.Remove(m);</pre>

Fragment 2 in file Scripts\Spells\First\ReactiveArmor.cs

<pre>ResistanceMod[] mods = (ResistanceMod[])m_Table[m];

                if (mods != null)
                {
                    for (int i = 0; i < mods.Length; ++i)
                        m.RemoveResistanceMod(mods[i]);
                }

                m_Table.Remove(m);</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write((short)i);

				int range = e.Range;

				if (range == -1)
				{
					range = 18;
				}

				CMEFlags flags = (e.Enabled && menu.From.InRange(p, range)) ? CMEFlags.None : CMEFlags.Disabled;</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write((short)i);

                int range = e.Range;

				if (range == -1)
				{
					range = 18;
				}

				CMEFlags flags = (e.Enabled && menu.From.InRange(p, range)) ? CMEFlags.None : CMEFlags.Disabled;</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\LadyJennifyr.cs

<pre>this.Fame = 18000;
            this.Karma = -18000;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Named\LadyMarai.cs

<pre>this.Fame = 18000;
            this.Karma = -18000;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 3 in file Scripts\Mobiles\Named\SirPatrick.cs

<pre>this.Fame = 18000;
            this.Karma = -18000;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\LadyLissith.cs

<pre>this.Fame = 18900;
            this.Karma = -18900;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Named\LadySabrix.cs

<pre>this.Fame = 18900;
            this.Karma = -18900;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 3 in file Scripts\Mobiles\Named\Silk.cs

<pre>this.Fame = 18900;
            this.Karma = -18900;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Betrayer.cs

<pre>private void Recover_Callback(object state)
        {
            Mobile defender = state as Mobile;

            if (defender != null)
            {
                defender.Frozen = false;
                defender.Combatant = null;
                defender.LocalOverheadMessage(MessageType.Regular, 0x3B2, false, "You recover your senses.");
            }

            this.m_Stunning = false;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Golem.cs

<pre>private void Recover_Callback(object state)
        {
            Mobile defender = state as Mobile;

            if (defender != null)
            {
                defender.Frozen = false;
                defender.Combatant = null;
                defender.LocalOverheadMessage(MessageType.Regular, 0x3B2, false, "You recover your senses.");
            }

            this.m_Stunning = false;
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\Juggernaut.cs

<pre>private void Recover_Callback(object state)
        {
            Mobile defender = state as Mobile;

            if (defender != null)
            {
                defender.Frozen = false;
                defender.Combatant = null;
                defender.LocalOverheadMessage(MessageType.Regular, 0x3B2, false, "You recover your senses.");
            }

            this.m_Stunning = false;
        }</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>object x = null;
				object y = null;
				if (e1 is SearchEntry)
					x = ((SearchEntry)e1).Object;
				if (e2 is SearchEntry)
					y = ((SearchEntry)e2).Object;

				string xstr = null;
				string ystr = null;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>object x = null;
				object y = null;
				if (e1 is SearchEntry)
					x = ((SearchEntry)e1).Object;
				if (e2 is SearchEntry)
					y = ((SearchEntry)e2).Object;

				string xstr = null;
				string ystr = null;</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>object x = null;
				object y = null;
				if (e1 is SearchEntry)
					x = ((SearchEntry)e1).Object;
				if (e2 is SearchEntry)
					y = ((SearchEntry)e2).Object;

				string xstr = null;
				string ystr = null;</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Irk.cs

<pre>this.Fame = 21000;
            this.Karma = -21000;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Named\Malefic.cs

<pre>this.Fame = 21000;
            this.Karma = -21000;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 3 in file Scripts\Mobiles\Named\Pyre.cs

<pre>this.Fame = 21000;
            this.Karma = -21000;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 4 in file Scripts\Mobiles\Normal\Virulent.cs

<pre>this.Fame = 21000;
            this.Karma = -21000;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 110

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefAlchemy.cs

<pre>public override int CanCraft(Mobile from, BaseTool tool, Type itemType)
        {
            int num = 0;

            if (tool == null || tool.Deleted || tool.UsesRemaining <= 0)
                return 1044038; // You have worn out your tool!
            else if (!tool.CheckAccessible(from, ref num))
                return num; // The tool must be on your person to use.

            return 0;
        }</pre>

Fragment 2 in file Scripts\Services\Craft\DefBowFletching.cs

<pre>public override int CanCraft(Mobile from, BaseTool tool, Type itemType)
        {
            int num = 0;

            if (tool == null || tool.Deleted || tool.UsesRemaining <= 0)
                return 1044038; // You have worn out your tool!
            else if (!tool.CheckAccessible(from, ref num))
                return num; // The tool must be on your person to use.

            return 0;
        }</pre>

Fragment 3 in file Scripts\Services\Craft\DefCarpentry.cs

<pre>public override int CanCraft(Mobile from, BaseTool tool, Type itemType)
        {
            int num = 0;

            if (tool == null || tool.Deleted || tool.UsesRemaining <= 0)
                return 1044038; // You have worn out your tool!
            else if (!tool.CheckAccessible(from, ref num))
                return num; // The tool must be on your person to use.

            return 0;
        }</pre>

Fragment 4 in file Scripts\Services\Craft\DefCartography.cs

<pre>public override int CanCraft(Mobile from, BaseTool tool, Type itemType)
        {
            int num = 0;

            if (tool == null || tool.Deleted || tool.UsesRemaining <= 0)
                return 1044038; // You have worn out your tool!
            else if (!tool.CheckAccessible(from, ref num))
                return num; // The tool must be on your person to use.

            return 0;
        }</pre>

Fragment 5 in file Scripts\Services\Craft\DefCooking.cs

<pre>public override int CanCraft(Mobile from, BaseTool tool, Type itemType)
        {
            int num = 0;

            if (tool == null || tool.Deleted || tool.UsesRemaining <= 0)
                return 1044038; // You have worn out your tool!
            else if (!tool.CheckAccessible(from, ref num))
                return num; // The tool must be on your person to use.

            return 0;
        }</pre>

Fragment 6 in file Scripts\Services\Craft\DefTailoring.cs

<pre>public override int CanCraft(Mobile from, BaseTool tool, Type itemType)
        {
            int num = 0;

            if (tool == null || tool.Deleted || tool.UsesRemaining <= 0)
                return 1044038; // You have worn out your tool!
            else if (!tool.CheckAccessible(from, ref num))
                return num; // The tool must be on your person to use.

            return 0;
        }</pre>

## Duplicated Code. Size: 109

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\GuildAdminCandidatesGump.cs

<pre>GuildGump.EnsureClosed(this.m_Mobile);

                                    if (this.m_Guild.Candidates.Count > 0)
                                        this.m_Mobile.SendGump(new GuildAdminCandidatesGump(this.m_Mobile, this.m_Guild));
                                    else
                                        this.m_Mobile.SendGump(new GuildmasterGump(this.m_Mobile, this.m_Guild));</pre>

Fragment 2 in file Scripts\Gumps\Guilds\GuildAdminCandidatesGump.cs

<pre>GuildGump.EnsureClosed(this.m_Mobile);

                                    if (this.m_Guild.Candidates.Count > 0)
                                        this.m_Mobile.SendGump(new GuildAdminCandidatesGump(this.m_Mobile, this.m_Guild));
                                    else
                                        this.m_Mobile.SendGump(new GuildmasterGump(this.m_Mobile, this.m_Guild));</pre>

## Duplicated Code. Size: 109

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Instruments\BaseInstrument.cs

<pre>ArrayList attrs = new ArrayList();

            if (this.DisplayLootType)
            {
                if (this.LootType == LootType.Blessed)
                    attrs.Add(new EquipInfoAttribute(1038021)); // blessed
                else if (this.LootType == LootType.Cursed)
                    attrs.Add(new EquipInfoAttribute(1049643)); // cursed
            }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWand.cs

<pre>ArrayList attrs = new ArrayList();

            if (this.DisplayLootType)
            {
                if (this.LootType == LootType.Blessed)
                    attrs.Add(new EquipInfoAttribute(1038021)); // blessed
                else if (this.LootType == LootType.Cursed)
                    attrs.Add(new EquipInfoAttribute(1049643)); // cursed
            }</pre>

## Duplicated Code. Size: 109

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>c == null || c.Deleted || !c.Alive || (c is Mobile && ((Mobile)c).IsDeadBondedPet) || !this.m_Mobile.CanSee(c) || !this.m_Mobile.CanBeHarmful(c, false) || c.Map != this.m_Mobile.Map</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>c == null || c.Deleted || !c.Alive || (c is Mobile && ((Mobile)c).IsDeadBondedPet) || !this.m_Mobile.CanSee(c) || !this.m_Mobile.CanBeHarmful(c, false) || c.Map != this.m_Mobile.Map</pre>

## Duplicated Code. Size: 109

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Guardian.cs

<pre>this.Hue = Utility.RandomSkinHue(); 

            if (this.Female = Utility.RandomBool()) 
            { 
                this.Body = 0x191; 
                this.Name = NameList.RandomName("female"); 
            }
            else 
            { 
                this.Body = 0x190; 
                this.Name = NameList.RandomName("male"); 
            }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Artist.cs

<pre>this.Hue = Utility.RandomSkinHue();

            if (this.Female = Utility.RandomBool())
            {
                this.Body = 0x191;
                this.Name = NameList.RandomName("female");
            }
            else
            {
                this.Body = 0x190;
                this.Name = NameList.RandomName("male");
            }</pre>

## Duplicated Code. Size: 109

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\EvilHealer.cs

<pre>public override bool CheckTeach(SkillName skill, Mobile from)
        {
            if (!base.CheckTeach(skill, from))
                return false;

            return (skill == SkillName.Forensics) ||
                   (skill == SkillName.Healing) ||
                   (skill == SkillName.SpiritSpeak) ||
                   (skill == SkillName.Swords);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Healer.cs

<pre>public override bool CheckTeach(SkillName skill, Mobile from)
        {
            if (!base.CheckTeach(skill, from))
                return false;

            return (skill == SkillName.Forensics) ||
                   (skill == SkillName.Healing) ||
                   (skill == SkillName.SpiritSpeak) ||
                   (skill == SkillName.Swords);
        }</pre>

## Duplicated Code. Size: 109

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\HouseFoundation.cs

<pre>int itemID = pvSrc.ReadInt32();
                int x = pvSrc.ReadInt32();
                int y = pvSrc.ReadInt32();
                int z = pvSrc.ReadInt32();

                // Verify component is deletable
                DesignState design = context.Foundation.DesignState;
                MultiComponentList mcl = design.Components;</pre>

Fragment 2 in file Scripts\Multis\HouseFoundation.cs

<pre>int itemID = pvSrc.ReadInt32();
                int x = pvSrc.ReadInt32();
                int y = pvSrc.ReadInt32();
                int z = pvSrc.ReadInt32();

                // Verify component is deletable
                DesignState design = context.Foundation.DesignState;
                MultiComponentList mcl = design.Components;</pre>

## Duplicated Code. Size: 109

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>var altar = new ShameAltar(typeof(FlameElemental), new Point3D(5604, 102, 5), new Point3D(5514, 147, 25), new Point3D(5571, 115, 3), 20);
                WeakEntityCollection.Add("newshame", altar);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>var altar = new ShameAltar(typeof(FlameElemental), new Point3D(5604, 102, 5), new Point3D(5514, 147, 25), new Point3D(5571, 115, 3), 20);
                WeakEntityCollection.Add("newshame", altar);</pre>

## Duplicated Code. Size: 109

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>var altar = new ShameAltar(typeof(WindElemental), new Point3D(5538, 170, 5), new Point3D(5513, 176, 5), new Point3D(5618, 223, 0), 30);
                WeakEntityCollection.Add("newshame", altar);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>var altar = new ShameAltar(typeof(WindElemental), new Point3D(5538, 170, 5), new Point3D(5513, 176, 5), new Point3D(5618, 223, 0), 30);
                WeakEntityCollection.Add("newshame", altar);</pre>

## Duplicated Code. Size: 109

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\StaffRunebook\Rune.cs

<pre>public void RemoveRune(int index, bool pageIndex)
        {
            if (this.Runes[index].IsRunebook)
                this.RunebookCount--;
            else
                this.RuneCount--;

            if (pageIndex && this.PageIndex == index)
                this.PageIndex = -1;

            this.Runes.RemoveAt(index);
        }</pre>

Fragment 2 in file Scripts\Services\StaffRunebook\RuneAccount.cs

<pre>public void RemoveRune(int index, bool pageIndex)
        {
            if (this.Runes[index].IsRunebook)
                this.RunebookCount--;
            else
                this.RuneCount--;

            if (pageIndex && this.PageIndex == index)
                this.PageIndex = -1;

            this.Runes.RemoveAt(index);
        }</pre>

## Duplicated Code. Size: 109

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>{
							if (Owner == null)
							{
								Owner = parentOfTarget as PlayerMobile;

								LootType = LootType.Blessed;

								// flag the owner as carrying a questtoken
								Owner.SetFlag(XmlQuest.CarriedXmlQuestFlag, true);
							}
							else
								if ((parentOfTarget as PlayerMobile != Owner) || (target is BankBox))
								{
									// tried to give it to another player or placed it in the players bankbox. try to return it to the owners pack
									Owner.AddToBackpack(this);

								}
						}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>{
                            if (Owner == null)
                            {
                                Owner = parentOfTarget as PlayerMobile;

                                LootType = LootType.Blessed;

                                // flag the owner as carrying a questtoken
                                Owner.SetFlag(XmlQuest.CarriedXmlQuestFlag, true);
                            }
                            else
                                if ((parentOfTarget as PlayerMobile != Owner) || (target is BankBox))
                                {
                                    // tried to give it to another player or placed it in the players bankbox. try to return it to the owners pack
                                    Owner.AddToBackpack(this);
                                    /*
                                    // this has been added to a player who is not the owner so invalidate it
                                    WasMoved = true;

                                    CheckOwnerFlag();

                                    Invalidate();
                                    */

                                }
                        }</pre>

## Duplicated Code. Size: 109

### Duplicated Fragments:

Fragment 1 in file Server\World.cs

<pre>int typeID = idxReader.ReadInt32();
							int serial = idxReader.ReadInt32();
							long pos = idxReader.ReadInt64();
							int length = idxReader.ReadInt32();

							var objs = types[typeID];

							if (objs == null)
							{
								continue;
							}</pre>

Fragment 2 in file Server\World.cs

<pre>int typeID = idxReader.ReadInt32();
							int serial = idxReader.ReadInt32();
							long pos = idxReader.ReadInt64();
							int length = idxReader.ReadInt32();

							var objs = types[typeID];

							if (objs == null)
							{
								continue;
							}</pre>

## Duplicated Code. Size: 109

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusDrone.cs

<pre>this.Fame = 18000;
            this.Karma = -18000;
            this.VirtualArmor = 65;

            this.PackItem(new PowerCrystal());
            this.PackItem(new ArcaneGem());
            this.PackItem(new ClockworkAssembly());

            this.m_FieldActive = this.CanUseField;</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusJuggernaut.cs

<pre>this.Fame = 18000;
            this.Karma = -18000;
            this.VirtualArmor = 65;

            this.PackItem(new PowerCrystal());
            this.PackItem(new ArcaneGem());
            this.PackItem(new ClockworkAssembly());

            this.m_FieldActive = this.CanUseField;</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusSentinel.cs

<pre>this.Fame = 18000;
            this.Karma = -18000;
            this.VirtualArmor = 65;

            this.PackItem(new PowerCrystal());
            this.PackItem(new ArcaneGem());
            this.PackItem(new ClockworkAssembly());

            this.m_FieldActive = this.CanUseField;</pre>

## Duplicated Code. Size: 109

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>SetResistance(ResistanceType.Physical, 20, 30);
                    SetResistance(ResistanceType.Fire, 100);
                    SetResistance(ResistanceType.Cold, 10, 20);
                    SetResistance(ResistanceType.Poison, 40, 50);
                    SetResistance(ResistanceType.Energy, 40, 50);
                    break;</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>SetResistance(ResistanceType.Physical, 20, 30);
                    SetResistance(ResistanceType.Fire, 10, 20);
                    SetResistance(ResistanceType.Cold, 100);
                    SetResistance(ResistanceType.Poison, 40, 50);
                    SetResistance(ResistanceType.Energy, 40, 50);
                    break;</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>SetResistance(ResistanceType.Physical, 20, 30);
                    SetResistance(ResistanceType.Fire, 40, 50);
                    SetResistance(ResistanceType.Cold, 40, 50);
                    SetResistance(ResistanceType.Poison, 100);
                    SetResistance(ResistanceType.Energy, 10, 20);
                    break;</pre>

Fragment 4 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>SetResistance(ResistanceType.Physical, 20, 30);
                    SetResistance(ResistanceType.Fire, 40, 50);
                    SetResistance(ResistanceType.Cold, 40, 50);
                    SetResistance(ResistanceType.Poison, 10, 20);
                    SetResistance(ResistanceType.Energy, 100);
                    break;</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SignGenDelete.cs

<pre>foreach (Item item in eable)
            {
                if (item is Sign && item.Z == location.Z && item.ItemID == itemID)
                    m_ToDelete.Enqueue(item);
            }

            eable.Free();

            while (m_ToDelete.Count > 0)
                m_ToDelete.Dequeue().Delete();</pre>

Fragment 2 in file Scripts\Commands\SignParser.cs

<pre>foreach (Item item in eable)
            {
                if (item is Sign && item.Z == location.Z && item.ItemID == itemID)
                    m_ToDelete.Enqueue(item);
            }

            eable.Free();

            while (m_ToDelete.Count > 0)
                m_ToDelete.Dequeue().Delete();</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\GuildAdminCandidatesGump.cs

<pre>PlayerState guildState = PlayerState.Find(this.m_Guild.Leader);
                                    PlayerState targetState = PlayerState.Find(m);

                                    Faction guildFaction = (guildState == null ? null : guildState.Faction);
                                    Faction targetFaction = (targetState == null ? null : targetState.Faction);</pre>

Fragment 2 in file Scripts\Gumps\Guilds\RecruitTarget.cs

<pre>PlayerState guildState = PlayerState.Find(this.m_Guild.Leader);
                PlayerState targetState = PlayerState.Find(m);

                Faction guildFaction = (guildState == null ? null : guildState.Faction);
                Faction targetFaction = (targetState == null ? null : targetState.Faction);</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\CaptainJohnesBlade.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            pois = 75; cold = 25;
            phys = nrgy = chaos = direct = fire = 0;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\CaptainJohnesBlade.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            pois = 75; cold = 25;
            phys = nrgy = chaos = direct = fire = 0;
        }</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\Pincer.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = 30; fire = 70;
            cold = nrgy = chaos = direct = pois = 0;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\Pincer.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = 30; fire = 70;
            cold = nrgy = chaos = direct = pois = 0;
        }</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\PvPWarnTeleporter.cs

<pre>AddImageTiled(15, 205, 365, 1, 0x2393);
            AddImageTiled(15, 14, 1, 190, 0x2391);
            AddImageTiled(0, 0, 395, 1, 0x23C5);
            AddImageTiled(394, 0, 1, 217, 0x23C3);</pre>

Fragment 2 in file Scripts\Services\InstancedPeerless\ConfirmExitInstanceGump.cs

<pre>AddImageTiled( 15, 205, 365, 1, 0x2393 );
			AddImageTiled( 15, 14, 1, 190, 0x2391 );
			AddImageTiled( 0, 0, 395, 1, 0x23C5 );
			AddImageTiled( 394, 0, 1, 217, 0x23C3 );</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\Teleporter.cs

<pre>Map map = m_MapDest;

			if (map == null || map == Map.Internal)
			{
				map = m.Map;
			}

			Point3D p = m_PointDest;

			if (p == Point3D.Zero)
			{
				p = m.Location;
			}

			BaseCreature.TeleportPets(m, p, map);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\Teleporter\Whirlpool.cs

<pre>Map map = m_MapDest;

            if (map == null || map == Map.Internal)
            {
                map = m.Map;
            }

            Point3D p = m_PointDest;

            if (p == Point3D.Zero)
            {
                p = m.Location;
            }

            BaseCreature.TeleportPets(m, p, map);</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>(targ.Range == -1 || this.m_Mobile.InRange(p, targ.Range)) && this.m_Mobile.InLOS(lt) && map.CanSpawnMobile(px + x, py + y, lt.Z) && !SpellHelper.CheckMulti(p, map)</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>(targ.Range == -1 || this.m_Mobile.InRange(p, targ.Range)) && this.m_Mobile.InLOS(lt) && map.CanSpawnMobile(px + x, py + y, lt.Z) && !SpellHelper.CheckMulti(p, map)</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>if (Skills[name].Base > Skills[name].Cap)
            {
                if (Core.SE)
                {
                    SkillsCap += (Skills[name].BaseFixedPoint - Skills[name].CapFixedPoint);
                }

                Skills[name].Cap = Skills[name].Base;
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>if (Skills[name].Base > Skills[name].Cap)
            {
                if (Core.SE)
                {
                    SkillsCap += (Skills[name].BaseFixedPoint - Skills[name].CapFixedPoint);
                }

                Skills[name].Cap = Skills[name].Base;
            }</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Barreraak.cs

<pre>public override void InitOutfit()
        {
            AddItem(new Backpack());
            AddItem(new Boots());
            AddItem(new LongPants(0x6C7));
            AddItem(new FancyShirt(0x6BB));
            AddItem(new Cloak(0x59));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Xenrr.cs

<pre>public override void InitOutfit()
        {
            AddItem(new Backpack());
            AddItem(new Boots());
            AddItem(new LongPants(0x6C7));
            AddItem(new FancyShirt(0x6BB));
            AddItem(new Cloak(0x59));
        }</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\AmbitiousSolenQueen\Conversations.cs

<pre>public override void ChildSerialize(GenericWriter writer)
        {
            writer.WriteEncodedInt((int)0); // version

            writer.Write((bool)this.m_BagOfSending);
            writer.Write((bool)this.m_PowderOfTranslocation);
            writer.Write((bool)this.m_Gold);
        }</pre>

Fragment 2 in file Scripts\Quests\AmbitiousSolenQueen\Objectives.cs

<pre>public override void ChildSerialize(GenericWriter writer)
        {
            writer.WriteEncodedInt((int)0); // version

            writer.Write((bool)this.m_BagOfSending);
            writer.Write((bool)this.m_PowderOfTranslocation);
            writer.Write((bool)this.m_Gold);
        }</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\GatheringOfEvidence.cs

<pre>this.AddObjective(new ObtainObjective(typeof(VoidCrystalOfCorruptedArcaneEssence), "Void Crystal of Corrupted Arcane Essence", 1));
            this.AddObjective(new ObtainObjective(typeof(VoidCrystalOfCorruptedSpiritualEssence), "Void Crystal of Corrupted Spiritual Essence", 1));
            this.AddObjective(new ObtainObjective(typeof(VoidCrystalOfCorruptedMysticalEssence), "Void Crystal of Corrupted Mystical Essence", 1));</pre>

Fragment 2 in file Scripts\Quests\GatheringOfEvidence.cs

<pre>this.AddObjective(new ObtainObjective(typeof(VoidCrystalOfCorruptedArcaneEssence), "Void Crystal of Corrupted Arcane Essence", 1));
            this.AddObjective(new ObtainObjective(typeof(VoidCrystalOfCorruptedSpiritualEssence), "Void Crystal of Corrupted Spiritual Essence", 1));
            this.AddObjective(new ObtainObjective(typeof(VoidCrystalOfCorruptedMysticalEssence), "Void Crystal of Corrupted Mystical Essence", 1));</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\BaseCollectionItem.cs

<pre>list.Add(1072819, this.m_Tier.ToString()); // Current Tier: ~1_TIER~
            list.Add(1072820, this.m_Points.ToString()); // Current Points: ~1_POINTS~
            list.Add(1072821, this.m_Tier > this.MaxTier ? 0.ToString() : this.CurrentTier.ToString()); // Points until next tier: ~1_POINTS~</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\BaseCollectionMobile.cs

<pre>list.Add(1072819, this.m_Tier.ToString()); // Current Tier: ~1_TIER~
            list.Add(1072820, this.m_Points.ToString()); // Current Points: ~1_POINTS~
            list.Add(1072821, this.m_Tier > this.MaxTier ? 0.ToString() : this.CurrentTier.ToString()); // Points until next tier: ~1_POINTS~</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>hold6.Location = new Point3D(X - 1, Y + 7, Z);
                    hold7.Location = new Point3D(X + 1, Y + 6, Z);
                    hold8.Location = new Point3D(X - 1, Y + 6, Z);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>hold6.Location = new Point3D(X + 7, Y - 1, Z);
                    hold7.Location = new Point3D(X + 6, Y - 1, Z);
                    hold8.Location = new Point3D(X + 6, Y + 1, Z);</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>hold6.Location = new Point3D(X + 1, Y - 7, Z);
                    hold7.Location = new Point3D(X - 1, Y - 6, Z);
                    hold8.Location = new Point3D(X + 1, Y - 6, Z);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>hold6.Location = new Point3D(X - 7, Y + 1, Z);
                    hold7.Location = new Point3D(X - 6, Y + 1, Z);
                    hold8.Location = new Point3D(X - 6, Y - 1, Z);</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GargishGalleon.cs

<pre>default:
                case Direction.North:
                    if (x == this.X && y < this.Y)
                        return ShipPosition.Bow;
                    if (x > this.X && y < this.Y)
                        return ShipPosition.BowStarboard;
                    if (x < this.X && y < this.Y)
                        return ShipPosition.BowPort;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>default:
                case Direction.North:
                    if (x == this.X && y < this.Y)
                        return ShipPosition.Bow;
                    if (x > this.X && y < this.Y)
                        return ShipPosition.BowStarboard;
                    if (x < this.X && y < this.Y)
                        return ShipPosition.BowPort;</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Spawners\BountyQuestSpawner.cs

<pre>Point2D[] course = def.GetRandomWaypoints();
                gal.BoatCourse = new BoatCourse(gal, new List<Point2D>(def.GetRandomWaypoints()));

                gal.NextNavPoint = 0;
                gal.StartCourse(false, false);

                FillHold(gal);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Spawners\BountyQuestSpawner.cs

<pre>Point2D[] course = def.GetRandomWaypoints();
                gal.BoatCourse = new BoatCourse(gal, new List<Point2D>(def.GetRandomWaypoints()));

                gal.NextNavPoint = 0;
                gal.StartCourse(false, false);

                FillHold(gal);</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, -9, 0, 0, 1779, -1, "", 1);// 1514
			AddComplexComponent( (BaseAddon) this, 2769, -9, -1, 0, 1779, -1, "", 1);// 1515</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, -1, -9, 0, 1779, -1, "", 1);// 1700
			AddComplexComponent( (BaseAddon) this, 2769, 0, -9, 0, 1779, -1, "", 1);// 1702</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Paragon.cs

<pre>(Math.Max(10, 100 * (0.83 - Math.Round(Math.Log(Math.Round(fame / 6000, 3) + 0.001, 10), 3))) * (100 - Math.Sqrt(m.Luck)) / 100.0)</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlParagon\XmlParagon.cs

<pre>(Math.Max(10, 100 * (0.83 - Math.Round(Math.Log(Math.Round(fame / 6000, 3) + 0.001, 10), 3))) * (100 - Math.Sqrt(m.Luck)) / 100.0)</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Underworld\ExperimentalRoom\Region.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(loc, from.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 2023);
            Effects.SendLocationParticles(EffectItem.Create(p, from.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 5023);</pre>

Fragment 2 in file Scripts\Services\Underworld\PuzzleRoom\PuzzleBox.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(loc, from.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 2023);
                    Effects.SendLocationParticles(EffectItem.Create(p, from.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 5023);</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuest.cs

<pre>if (objectivestr == null) return false;

			string[] arglist = BaseXmlSpawner.ParseString(objectivestr, 5, ",");
			int targetcount = 1;
			bool found = false;
			bool checkprop = true;
			string status_str = null;

			string typestr = null;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuest.cs

<pre>if (objectivestr == null) return false;

			// format for the objective string will be KILL,mobtype[,count][,proptest] or KILLNAMED,mobname[,type][,count][,proptest]
			string[] arglist = BaseXmlSpawner.ParseString(objectivestr, 5, ",");
			int targetcount = 1;
			bool found = false;
			bool checkprop = true;
			string status_str = null;

			string typestr = null;</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>bool badspawn = false;
							int x = 0;
							int y = 0;
							int z = 0;
							int map = 0;
							double mindelay = 0;
							double maxdelay = 0;
							int homerange = 0;
							int spawnrange = 0;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>bool badspawn = false;
							int x = 0;
							int y = 0;
							int z = 0;
							int map = 0;
							double mindelay = 0;
							double maxdelay = 0;
							int homerange = 0;
							int spawnrange = 0;</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawnerGumps.cs

<pre>book.FillTextEntryBook(text);

									// put the book at the location of the player so that it can be opened, but drop it below visible range
									book.Visible = false;
									book.Movable = false;
									book.MoveToWorld(new Point3D(state.Mobile.Location.X, state.Mobile.Location.Y, state.Mobile.Location.Z - 100), state.Mobile.Map);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlEdit.cs

<pre>book.FillTextEntryBook(text);

						// put the book at the location of the player so that it can be opened, but drop it below visible range
						book.Visible = false;
						book.Movable = false;
						book.MoveToWorld(new Point3D(state.Mobile.Location.X,state.Mobile.Location.Y,state.Mobile.Location.Z-100), state.Mobile.Map);</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGauntlet.cs

<pre>public override void OnKillPlayer(Mobile killer, Mobile killed)
        {
            if(killer == null) return;

            // find the player in the participants list and announce it
            if(m_Participants != null)
            {

                foreach(ChallengeEntry entry in m_Participants)
                {
                    if(entry.Status == ChallengeStatus.Active && entry.Participant == killer)
                    {
                        AddScore(entry);
                    }
                }
            }
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGauntlet.cs

<pre>public override void OnKillPlayer(Mobile killer, Mobile killed)
        {
            if(killer == null) return;

            // find the player in the participants list and announce it
            if(m_Participants != null)
            {

                foreach(ChallengeEntry entry in m_Participants)
                {
                    if(entry.Status == ChallengeStatus.Active && entry.Participant == killer)
                    {
                        AddScore(entry);
                    }
                }
            }
        }</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void WriteItemSet<T>(HashSet<T> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(item => item.Deleted);
			}

			Write(set.Count);

			foreach (Item item in set)
			{
				Write(item);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void WriteItemSet<T>(HashSet<T> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(item => item.Deleted);
			}

			Write(set.Count);

			foreach (Item item in set)
			{
				Write(item);
			}
		}</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void WriteMobileSet<T>(HashSet<T> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(mob => mob.Deleted);
			}

			Write(set.Count);

			foreach (Mobile mob in set)
			{
				Write(mob);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void WriteMobileSet<T>(HashSet<T> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(mob => mob.Deleted);
			}

			Write(set.Count);

			foreach (Mobile mob in set)
			{
				Write(mob);
			}
		}</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void WriteGuildSet<T>(HashSet<T> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(guild => guild.Disbanded);
			}

			Write(set.Count);

			foreach (BaseGuild guild in set)
			{
				Write(guild);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void WriteGuildSet<T>(HashSet<T> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(guild => guild.Disbanded);
			}

			Write(set.Count);

			foreach (BaseGuild guild in set)
			{
				Write(guild);
			}
		}</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestBook.cs

<pre>private void CheckOwnerFlag()
        {
            if(Owner != null && !Owner.Deleted)
            {
                // need to check to see if any other questtoken items are owned
                // search the Owners top level pack for an xmlquest
                List<Item> list = XmlQuest.FindXmlQuest(Owner);

                if(list == null || list.Count == 0)
                {
                    // if none remain then flag the ower as having none
                    Owner.SetFlag(XmlQuest.CarriedXmlQuestFlag,false);
                }

            }
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>private void CheckOwnerFlag()
		{
			if (Owner != null && !Owner.Deleted)
			{
				// need to check to see if any other questtoken items are owned
				// search the Owners top level pack for an xmlquest
				List<Item> list = XmlQuest.FindXmlQuest(Owner);

				if (list == null || list.Count == 0)
				{

					// if none remain then flag the ower as having none
					Owner.SetFlag(XmlQuest.CarriedXmlQuestFlag, false);
				}
			}

		}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>private void CheckOwnerFlag()
        {
            if (Owner != null && !Owner.Deleted)
            {
                // need to check to see if any other questtoken items are owned
                // search the Owners top level pack for an xmlquesttoken
                List<Item> list = XmlQuest.FindXmlQuest(Owner);

                if (list == null || list.Count == 0)
                {

                    // if none remain then flag the ower as having none
                    Owner.SetFlag(XmlQuest.CarriedXmlQuestFlag, false);
                }
            }

        }</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBarkeeper.cs

<pre>this.Add(new GenericBuyInfo("a barkeep contract", typeof(BarkeepContract), 1252, 20, 0x14F0, 0));
                if (Multis.BaseHouse.NewVendorSystem)
                    this.Add(new GenericBuyInfo("1062332", typeof(VendorRentalContract), 1252, 20, 0x14F0, 0x672));</pre>

Fragment 2 in file Scripts\VendorInfo\SBInnKeeper.cs

<pre>this.Add(new GenericBuyInfo("a barkeep contract", typeof(BarkeepContract), 1252, 20, 0x14F0, 0));

                if (Multis.BaseHouse.NewVendorSystem)
                    this.Add(new GenericBuyInfo("1062332", typeof(VendorRentalContract), 1252, 20, 0x14F0, 0x672));</pre>

Fragment 3 in file Scripts\VendorInfo\SBTavernKeeper.cs

<pre>this.Add(new GenericBuyInfo("a barkeep contract", typeof(BarkeepContract), 1252, 20, 0x14F0, 0));

                if (Multis.BaseHouse.NewVendorSystem)
                    this.Add(new GenericBuyInfo("1062332", typeof(VendorRentalContract), 1252, 20, 0x14F0, 0x672));</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ChaosDragoon.cs

<pre>public override void AlterMeleeDamageTo(Mobile to, ref int damage)
        {
            if (to is Dragon || to is WhiteWyrm || to is SwampDragon || to is Drake || to is Nightmare || to is Hiryu || to is LesserHiryu || to is Daemon)
                damage *= 3;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ChaosDragoonElite.cs

<pre>public override void AlterMeleeDamageTo(Mobile to, ref int damage)
        {
            if (to is Dragon || to is WhiteWyrm || to is SwampDragon || to is Drake || to is Nightmare || to is Hiryu || to is LesserHiryu || to is Daemon)
                damage *= 3;
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\Savage.cs

<pre>public override void AlterMeleeDamageTo(Mobile to, ref int damage)
        {
            if (to is Dragon || to is WhiteWyrm || to is SwampDragon || to is Drake || to is Nightmare || to is Hiryu || to is LesserHiryu || to is Daemon)
                damage *= 3;
        }</pre>

Fragment 4 in file Scripts\Mobiles\Normal\SavageRider.cs

<pre>public override void AlterMeleeDamageTo(Mobile to, ref int damage)
        {
            if (to is Dragon || to is WhiteWyrm || to is SwampDragon || to is Drake || to is Nightmare || to is Hiryu || to is LesserHiryu || to is Daemon)
                damage *= 3;
        }</pre>

## Duplicated Code. Size: 108

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>{
                        if(entry != null)
                        {
                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed++;

                                if(entry.PageBeingViewed > (int)(nplayers/PlayersPerPage)) entry.PageBeingViewed=(int)(nplayers/PlayersPerPage);
                                page = entry.PageBeingViewed;
                                break;

                            }
                        }
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>{
                        if(entry != null)
                        {
                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed++;

                                if(entry.PageBeingViewed > (int)(nplayers/PlayersPerPage)) entry.PageBeingViewed=(int)(nplayers/PlayersPerPage);
                                page = entry.PageBeingViewed;
                                break;

                            }
                        }
                    }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>{
                        if(entry != null)
                        {
                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed++;

                                if(entry.PageBeingViewed > (int)(nplayers/PlayersPerPage)) entry.PageBeingViewed=(int)(nplayers/PlayersPerPage);
                                page = entry.PageBeingViewed;
                                break;

                            }
                        }
                    }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>{
                        if(entry != null)
                        {
                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed++;

                                if(entry.PageBeingViewed > (int)(nplayers/PlayersPerPage)) entry.PageBeingViewed=(int)(nplayers/PlayersPerPage);

                                page = entry.PageBeingViewed;
                                break;

                            }
                        }
                    }</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Accounting\AccountHandler.cs

<pre>Utility.PushColor(ConsoleColor.DarkRed);
                Console.WriteLine("Login: {0}: Past IP limit threshold", e.State);
                Utility.PopColor();

                using (StreamWriter op = new StreamWriter("ipLimits.log", true))
                    op.WriteLine("{0}\tPast IP limit threshold\t{1}", e.State, DateTime.UtcNow);

                return;</pre>

Fragment 2 in file Scripts\Accounting\AccountHandler.cs

<pre>Utility.PushColor(ConsoleColor.DarkRed);
                Console.WriteLine("Login: {0}: Past IP limit threshold", e.State);
                Utility.PopColor();

                using (StreamWriter op = new StreamWriter("ipLimits.log", true))
                    op.WriteLine("{0}\tPast IP limit threshold\t{1}", e.State, DateTime.UtcNow);

                return;</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Docs.cs

<pre>do
					{
						append.Append('[');

						for (var i = 1; i < realType.GetArrayRank(); ++i)
						{
							append.Append(',');
						}

						append.Append(']');

						realType = realType.GetElementType();
					}
					while (realType.IsArray);</pre>

Fragment 2 in file Scripts\Commands\Docs.cs

<pre>do
				{
					append.Append('[');

					for (var i = 1; i < realType.GetArrayRank(); ++i)
					{
						append.Append(',');
					}

					append.Append(']');

					realType = realType.GetElementType();
				}
				while (realType.IsArray);</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\GuildWarAdminGump.cs

<pre>this.m_Mobile = from;
            this.m_Guild = guild;

            this.Dragable = false;

            this.AddPage(0);
            this.AddBackground(0, 0, 550, 440, 5054);
            this.AddBackground(10, 10, 530, 420, 3000);</pre>

Fragment 2 in file Scripts\Gumps\Guilds\GuildWarGump.cs

<pre>this.m_Mobile = from;
            this.m_Guild = guild;

            this.Dragable = false;

            this.AddPage(0);
            this.AddBackground(0, 0, 550, 440, 5054);
            this.AddBackground(10, 10, 530, 420, 3000);</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Cannon.cs

<pre>this.Disposable = true;
                this.Dragable = true;
                this.Resizable = false;

                this.AddPage(0);

                this.AddBackground(0, 0, 291, 133, 0x13BE);
                this.AddImageTiled(5, 5, 280, 100, 0xA40);</pre>

Fragment 2 in file Scripts\Items\Tools\WeaponEngravingTool.cs

<pre>this.Disposable = true;
                this.Dragable = true;
                this.Resizable = false;

                this.AddPage(0);

                this.AddBackground(0, 0, 291, 133, 0x13BE);
                this.AddImageTiled(5, 5, 280, 100, 0xA40);</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Navery\Navrey.cs

<pre>public static void DistributeRandomArtifact(BaseCreature bc, Type[] typelist)
        {
            int random = Utility.Random(typelist.Length);
            Item item = Loot.Construct(typelist[random]);
            DistributeArtifact(DemonKnight.FindRandomPlayer(bc), item);
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ClockworkExodus.cs

<pre>public static void DistributeRandomArtifact(BaseCreature bc, Type[] typelist)
        {
            int random = Utility.Random(typelist.Length);
            Item item = Loot.Construct(typelist[random]);
            DistributeArtifact(DemonKnight.FindRandomPlayer(bc), item);
        }</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\SlasherOfVeils.cs

<pre>if (m is BaseCreature && (((BaseCreature)m).Controlled || ((BaseCreature)m).Summoned || ((BaseCreature)m).Team != this.Team))
                    list.Add(m);
                else if (m.Player)
                    list.Add(m);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\Shadowlord.cs

<pre>if (m is BaseCreature && (((BaseCreature)m).Controlled || ((BaseCreature)m).Summoned || ((BaseCreature)m).Team != this.Team))
                    list.Add(m);
                else if (m.Player)
                    list.Add(m);</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\LargeBOD.cs

<pre>if (this.Weight == 0.0)
                this.Weight = 1.0;

            if (Core.AOS && this.ItemID == 0x14EF)
                this.ItemID = 0x2258;

            if (this.Parent == null && this.Map == Map.Internal && this.Location == Point3D.Zero)
                this.Delete();</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallBOD.cs

<pre>if (this.Weight == 0.0)
                this.Weight = 1.0;

            if (Core.AOS && this.ItemID == 0x14EF)
                this.ItemID = 0x2258;

            if (this.Parent == null && this.Map == Map.Internal && this.Location == Point3D.Zero)
                this.Delete();</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(PlateChest), 1025141, 1, 1044253);
            AddRes(index, typeof(CloseHelm), 1025128, 1, 1044253);
            AddRes(index, typeof(Broadsword), 1015055, 1, 1044253);
            ForceNonExceptional(index);</pre>

Fragment 2 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(PlateChest), 1025141, 1, 1044253);
            AddRes(index, typeof(CloseHelm), 1025128, 1, 1044253);
            AddRes(index, typeof(Broadsword), 1015055, 1, 1044253);
            ForceNonExceptional(index);</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Pathing\FastMovement.cs

<pre>{
						MovementPool.AcquireMoveCache(ref list, itemsRight);

						if (!Check(map, m, list, xRight, yRight, startTop, startZ, m != null && m.CanSwim, m != null && m.CantWalk, out hold))
						{
							moveIsOk = false;
						}
					}</pre>

Fragment 2 in file Scripts\Services\Pathing\FastMovement.cs

<pre>{
						MovementPool.AcquireMoveCache(ref list, itemsRight);

                        if (!Check(map, m, list, xRight, yRight, startTop, startZ, m != null && m.CanSwim, m != null && m.CantWalk, out hold))
						{
							moveIsOk = false;
						}
					}</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.33 > Utility.RandomDouble() && Region.Find(c.Location, c.Map).IsPartOf("Shame"))
                c.DropItem(new ShameCrystal(3));
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.33 > Utility.RandomDouble() && Region.Find(c.Location, c.Map).IsPartOf("Shame"))
                c.DropItem(new ShameCrystal(3));
        }</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.10 > Utility.RandomDouble() && Region.Find(c.Location, c.Map).IsPartOf("Shame"))
                c.DropItem(new ShameCrystal(5));
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.10 > Utility.RandomDouble() && Region.Find(c.Location, c.Map).IsPartOf("Shame"))
                c.DropItem(new ShameCrystal(5));
        }</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketHandlers.cs

<pre>state.Send(new MobileUpdateOld(m));

				state.Send(new MobileIncomingOld(m, m));
				//state.Send( new MobileAttributes( m ) );
				state.Send(new MobileStatus(m, m));
				state.Send(Network.SetWarMode.Instantiate(m.Warmode));</pre>

Fragment 2 in file Server\Network\PacketHandlers.cs

<pre>state.Send(new MobileUpdateOld(m));
				//state.Send( new MobileAttributes( m ) );
				state.Send(new MobileStatus(m, m));
				state.Send(Network.SetWarMode.Instantiate(m.Warmode));
				state.Send(new MobileIncomingOld(m, m));</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\GuildChangeTypeGump.cs

<pre>this.m_Mobile = from;
            this.m_Guild = guild;

            this.Dragable = false;

            this.AddPage(0);
            this.AddBackground(0, 0, 550, 400, 5054);
            this.AddBackground(10, 10, 530, 380, 3000);</pre>

Fragment 2 in file Scripts\Gumps\Guilds\GuildCharterGump.cs

<pre>this.m_Mobile = from;
            this.m_Guild = guild;

            this.Dragable = false;

            this.AddPage(0);
            this.AddBackground(0, 0, 550, 400, 5054);
            this.AddBackground(10, 10, 530, 380, 3000);</pre>

Fragment 3 in file Scripts\Gumps\Guilds\GuildmasterGump.cs

<pre>this.m_Mobile = from;
            this.m_Guild = guild;

            this.Dragable = false;

            this.AddPage(0);
            this.AddBackground(0, 0, 550, 400, 5054);
            this.AddBackground(10, 10, 530, 380, 3000);</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\LadyJennifyr.cs

<pre>public override void OnDeath( Container c )
        {
            base.OnDeath( c );

            if ( Utility.RandomDouble() < 0.15 )
            c.DropItem( new DisintegratingThesisNotes() );

            if ( Utility.RandomDouble() < 0.1 )
            c.DropItem( new ParrotItem() );
        }</pre>

Fragment 2 in file Scripts\Mobiles\Named\LadyMarai.cs

<pre>public override void OnDeath( Container c )
        {
            base.OnDeath( c );

            if ( Utility.RandomDouble() < 0.15 )
            c.DropItem( new DisintegratingThesisNotes() );

            if ( Utility.RandomDouble() < 0.1 )
            c.DropItem( new ParrotItem() );
        }</pre>

Fragment 3 in file Scripts\Mobiles\Named\MasterMikael.cs

<pre>public override void OnDeath( Container c )
        {
            base.OnDeath( c );

            if ( Utility.RandomDouble() < 0.15 )
            c.DropItem( new DisintegratingThesisNotes() );

            if ( Utility.RandomDouble() < 0.1 )
            c.DropItem( new ParrotItem() );
        }</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.33 > Utility.RandomDouble() && Region.Find(c.Location, c.Map).IsPartOf("Shame"))
                c.DropItem(new ShameCrystal(5));
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.33 > Utility.RandomDouble() && Region.Find(c.Location, c.Map).IsPartOf("Shame"))
                c.DropItem(new ShameCrystal(5));
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.33 > Utility.RandomDouble() && Region.Find(c.Location, c.Map).IsPartOf("Shame"))
                c.DropItem(new ShameCrystal(5));
        }</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10122, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1079766, LabelColor, false, false);       //Spell Channeling
                    yOffset += 1;</pre>

Fragment 2 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10122, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1079766, LabelColor, false, false);       //Spell Channeling
                    yOffset += 1;</pre>

Fragment 3 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10122, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1079766, LabelColor, false, false);       //Spell Channeling 
                    yOffset += 1;</pre>

## Duplicated Code. Size: 107

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Encounters.cs

<pre>int x = Utility.RandomMinMax(rec.X, rec.X + rec.Width);
				int y = Utility.RandomMinMax(rec.Y, rec.Y + rec.Height);
				int z = Map.TerMur.GetAverageZ(x, y);</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Encounters.cs

<pre>int x = Utility.RandomMinMax(rec.X, rec.X + rec.Width);
				int y = Utility.RandomMinMax(rec.Y, rec.Y + rec.Height);
				int z = Map.TerMur.GetAverageZ(x, y);</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Encounters.cs

<pre>int x = Utility.RandomMinMax(rec.X, rec.X + rec.Width);
            int y = Utility.RandomMinMax(rec.Y, rec.Y + rec.Height);
            int z = Map.TerMur.GetAverageZ(x, y);</pre>

Fragment 4 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Encounters.cs

<pre>int x = Utility.RandomMinMax(rec.X, rec.X + rec.Width);
				int y = Utility.RandomMinMax(rec.Y, rec.Y + rec.Height);
				int z = Map.TerMur.GetAverageZ(x, y);</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\Feint.cs

<pre>public override bool CheckSkills( Mobile from )
		{
			if( GetSkill( from, SkillName.Ninjitsu ) < 50.0  && GetSkill( from, SkillName.Bushido ) < 50.0 )
			{
				from.SendLocalizedMessage( 1063347, "50" ); // You need ~1_SKILL_REQUIREMENT~ Bushido or Ninjitsu skill to perform that attack!
				return false;
			}

			return base.CheckSkills( from );
		}</pre>

Fragment 2 in file Scripts\Abilities\FrenziedWhirlwind.cs

<pre>public override bool CheckSkills(Mobile from)
        {
            if (GetSkill(from, SkillName.Ninjitsu) < 50.0 && GetSkill(from, SkillName.Bushido) < 50.0)
            {
                from.SendLocalizedMessage(1063347, "50"); // You need ~1_SKILL_REQUIREMENT~ Bushido or Ninjitsu skill to perform that attack!
                return false;
            }

            return base.CheckSkills(from);
        }</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\Teleporter.cs

<pre>public virtual void StartTeleport(Mobile m)
		{

            if (m.Holding != null)
            {
                m.SendLocalizedMessage(1071955); // You cannot teleport while dragging an object.
                return;
            } 
            else if (m_Delay == TimeSpan.Zero)
			{
				DoTeleport(m);
			}
			else
			{
				Timer.DelayCall(m_Delay, DoTeleport, m);
			}
		}</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\Teleporter\Whirlpool.cs

<pre>public virtual void StartTeleport(Mobile m)
        {
            if (m.Holding != null)
            {
                m.SendLocalizedMessage(1071955); // You cannot teleport while dragging an object.
                return;
            }
            else if (m_Delay == TimeSpan.Zero)
            {
                DoTeleport(m);
            }
            else
            {
                Timer.DelayCall(m_Delay, DoTeleport, m);
            }
        }</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DeathWatchBeetle.cs

<pre>Mobile combatant = this.Combatant as Mobile;

            if (combatant == null || combatant.Deleted || combatant.Map != this.Map || !this.InRange(combatant, 12) || !this.CanBeHarmful(combatant) || !this.InLOS(combatant))
                return;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SandVortex.cs

<pre>Mobile combatant = this.Combatant as Mobile;

            if (combatant == null || combatant.Deleted || combatant.Map != this.Map || !this.InRange(combatant, 12) || !this.CanBeHarmful(combatant) || !this.InLOS(combatant))
                return;</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\MoundOfMaggots.cs

<pre>this.SetDex(61, 70);
            this.SetInt(10);

            this.SetMana(0);

            this.SetDamage(3, 9);

            this.SetDamageType(ResistanceType.Physical, 50);
            this.SetDamageType(ResistanceType.Poison, 50);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Mobile\GooeyMaggots.cs

<pre>this.SetDex(61, 70);
            this.SetInt(10);

            this.SetMana(0);

            this.SetDamage(3, 9);

            this.SetDamageType(ResistanceType.Physical, 50);
            this.SetDamageType(ResistanceType.Poison, 50);</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\OrcBomber.cs

<pre>SetSkill(SkillName.MagicResist, 70.1, 85.0);
            SetSkill(SkillName.Swords, 60.1, 85.0);
            SetSkill(SkillName.Tactics, 75.1, 90.0);
            SetSkill(SkillName.Wrestling, 60.1, 85.0);

            Fame = 2500;
            Karma = -2500;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\OrcishLord.cs

<pre>SetSkill(SkillName.MagicResist, 70.1, 85.0);
            SetSkill(SkillName.Swords, 60.1, 85.0);
            SetSkill(SkillName.Tactics, 75.1, 90.0);
            SetSkill(SkillName.Wrestling, 60.1, 85.0);

            Fame = 2500;
            Karma = -2500;</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Andric.cs

<pre>this.AddItem(item);

            item = new LeatherGloves();
            item.Hue = 0x1BB;
            this.AddItem(item);

            item = new LeatherChest();
            item.Hue = 0x1BB;
            this.AddItem(item);

            item = new LeatherArms();</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Kashiel.cs

<pre>this.AddItem(item);

            item = new LeatherGloves();
            item.Hue = 0x1BB;
            this.AddItem(item);

            item = new LeatherChest();
            item.Hue = 0x1BB;
            this.AddItem(item);

            item = new LeatherArms();</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Ethics\Evil\Mobiles\UnholyFamiliar.cs

<pre>public override string ApplyNameSuffix(string suffix)
        {
            if (suffix.Length == 0)
                suffix = Ethic.Evil.Definition.Adjunct.String;
            else
                suffix = String.Concat(suffix, " ", Ethic.Evil.Definition.Adjunct.String);

            return base.ApplyNameSuffix(suffix);
        }</pre>

Fragment 2 in file Scripts\Services\Ethics\Evil\Mobiles\UnholySteed.cs

<pre>public override string ApplyNameSuffix(string suffix)
        {
            if (suffix.Length == 0)
                suffix = Ethic.Evil.Definition.Adjunct.String;
            else
                suffix = String.Concat(suffix, " ", Ethic.Evil.Definition.Adjunct.String);

            return base.ApplyNameSuffix(suffix);
        }</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Ethics\Hero\Mobiles\HolyFamiliar.cs

<pre>public override string ApplyNameSuffix(string suffix)
        {
            if (suffix.Length == 0)
                suffix = Ethic.Hero.Definition.Adjunct.String;
            else
                suffix = String.Concat(suffix, " ", Ethic.Hero.Definition.Adjunct.String);

            return base.ApplyNameSuffix(suffix);
        }</pre>

Fragment 2 in file Scripts\Services\Ethics\Hero\Mobiles\HolySteed.cs

<pre>public override string ApplyNameSuffix(string suffix)
        {
            if (suffix.Length == 0)
                suffix = Ethic.Hero.Definition.Adjunct.String;
            else
                suffix = String.Concat(suffix, " ", Ethic.Hero.Definition.Adjunct.String);

            return base.ApplyNameSuffix(suffix);
        }</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Spawners\CharybdisSpawner.cs

<pre>t.Z == -5 && ((t.ID >= 0xA8 && t.ID <= 0xAB) || (t.ID >= 0x136 && t.ID <= 0x137)) && !Spells.SpellHelper.CheckMulti(new Point3D(tx, ty, -5), map)</pre>

Fragment 2 in file Scripts\Skills\Fishing.cs

<pre>t.Z == -5 && ((t.ID >= 0xA8 && t.ID <= 0xAB) || (t.ID >= 0x136 && t.ID <= 0x137)) && !Spells.SpellHelper.CheckMulti(new Point3D(tx, ty, -5), map)</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 19, -1, 0, 1779, -1, "", 1);// 150
			AddComplexComponent( (BaseAddon) this, 2769, 19, -2, 0, 1779, -1, "", 1);// 151</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, -2, 19, 0, 1779, -1, "", 1);// 1063
			AddComplexComponent( (BaseAddon) this, 2769, -1, 19, 0, 1779, -1, "", 1);// 1098</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 1, -6, 0, 1779, -1, "", 1);// 888
			AddComplexComponent( (BaseAddon) this, 2769, 2, -6, 0, 1779, -1, "", 1);// 891</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, -6, 2, 0, 1779, -1, "", 1);// 1245
			AddComplexComponent( (BaseAddon) this, 2769, -6, 1, 0, 1779, -1, "", 1);// 1246</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 2, -16, 0, 1779, -1, "", 1);// 944
			AddComplexComponent( (BaseAddon) this, 2769, 1, -16, 0, 1779, -1, "", 1);// 950</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, -16, 2, 0, 1779, -1, "", 1);// 1900
			AddComplexComponent( (BaseAddon) this, 2769, -16, 1, 0, 1779, -1, "", 1);// 1901</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 2, -21, 0, 1779, -1, "", 1);// 951
			AddComplexComponent( (BaseAddon) this, 2769, 1, -18, 0, 1779, -1, "", 1);// 952</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 2, -18, 0, 1779, -1, "", 1);// 963
			AddComplexComponent( (BaseAddon) this, 2769, 1, -21, 0, 1779, -1, "", 1);// 967</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\FireCasino\TentBrownAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 497, 0, 3, 0, 1118, -1, "", 1);// 26
			AddComplexComponent( (BaseAddon) this, 2778, -2, -1, 0, 0, -1, "decorative golden rug", 1);// 27</pre>

Fragment 2 in file Scripts\Services\FireCasino\TentBrownAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2778, -1, 0, 0, 0, -1, "decorative golden rug", 1);// 32
			AddComplexComponent( (BaseAddon) this, 497, -2, 3, 0, 1118, -1, "", 1);// 33</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\MondainsLegacyQuests\BaseQuestItem.cs

<pre>{
                    BaseQuest quest = QuestHelper.RandomQuest(player, new Type[] { chain.CurrentQuest }, this);

                    if (quest != null)
                    {
                        player.CloseGump(typeof(MondainQuestGump));
                        player.SendGump(new MondainQuestGump(quest));
                        return;
                    }
                }</pre>

Fragment 2 in file Scripts\Services\MondainsLegacyQuests\MondainQuester.cs

<pre>{
                    BaseQuest quest = QuestHelper.RandomQuest(player, new Type[] { chain.CurrentQuest }, this);

                    if (quest != null)
                    {
                        player.CloseGump(typeof(MondainQuestGump));
                        player.SendGump(new MondainQuestGump(quest));
                        return;
                    }
                }</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>string[] typeargs = strEntry.Split(",".ToCharArray(), 2);
								string typestr = null;
								string namestr = strEntry;

								if (typeargs.Length > 1)
								{
									namestr = typeargs[0];
									typestr = typeargs[1];
								}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>string[] typeargs = strEntry.Split(",".ToCharArray(), 2);
								string typestr = null;
								string namestr = strEntry;

								if (typeargs.Length > 1)
								{
									namestr = typeargs[0];
									typestr = typeargs[1];
								}</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlMobFactions\MobFactionsRewardGump.cs

<pre>AddLabel( 70, y+3, texthue, r.Name);

        			// display the cost
        			AddLabel( x_creditoffset, y+3, texthue, r.Cost.ToString() );

        			// display the item
        			if(r.ItemID > 0)
                        AddItem(x_creditoffset+60, y, r.ItemID);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\PointsRewardGump.cs

<pre>AddLabel( 70, y+3, texthue, r.Name);

        			// display the cost
        			AddLabel( x_creditoffset, y+3, texthue, r.Cost.ToString() );

        			// display the item
        			if(r.ItemID > 0)
                        AddItem(x_creditoffset+60, y, r.ItemID);</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Eighth\EnergyVortex.cs

<pre>public override bool CheckCast()
        {
            if (!base.CheckCast())
                return false;

            if ((this.Caster.Followers + (Core.SE ? 2 : 1)) > this.Caster.FollowersMax)
            {
                this.Caster.SendLocalizedMessage(1049645); // You have too many followers to summon that creature.
                return false;
            }

            return true;
        }</pre>

Fragment 2 in file Scripts\Spells\Fifth\BladeSpirits.cs

<pre>public override bool CheckCast()
        {
            if (!base.CheckCast())
                return false;

            if ((this.Caster.Followers + (Core.SE ? 2 : 1)) > this.Caster.FollowersMax)
            {
                this.Caster.SendLocalizedMessage(1049645); // You have too many followers to summon that creature.
                return false;
            }

            return true;
        }</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Fifth\PoisonField.cs

<pre>{
                            this.m_Caster = reader.ReadMobile();

                            goto case 0;
                        }
                    case 0:
                        {
                            this.m_End = reader.ReadDeltaTime();

                            this.m_Timer = new InternalTimer(this, TimeSpan.Zero, true, true);
                            this.m_Timer.Start();

                            break;
                        }</pre>

Fragment 2 in file Scripts\Spells\Fourth\FireField.cs

<pre>{
                            this.m_Caster = reader.ReadMobile();

                            goto case 0;
                        }
                    case 0:
                        {
                            this.m_End = reader.ReadDeltaTime();

                            this.m_Timer = new InternalTimer(this, TimeSpan.Zero, true, true);
                            this.m_Timer.Start();

                            break;
                        }</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Server\TileMatrixPatch.cs

<pre>int blockID = indexReader.ReadInt32();
							int blockX = blockID / matrix.BlockHeight;
							int blockY = blockID % matrix.BlockHeight;

							int offset = lookupReader.ReadInt32();
							int length = lookupReader.ReadInt32();
							lookupReader.ReadInt32(); // Extra</pre>

Fragment 2 in file Ultima\TileMatrixPatch.cs

<pre>int blockID = indexReader.ReadInt32();
						int blockX = blockID / matrix.BlockHeight;
						int blockY = blockID % matrix.BlockHeight;

						int offset = lookupReader.ReadInt32();
						int length = lookupReader.ReadInt32();
						lookupReader.ReadInt32(); // Extra</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>this.AddButton(10, 70 + i * 20, 0xFA5, 0xFA7, 0x100 | i, GumpButtonType.Reply, 0);
                        this.AddHtmlLocalized(45, 72 + i * 20, 110, 18, hair.Name, 0x7FFF, false, false);</pre>

Fragment 2 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>this.AddButton(10, 70 + i * 20, 0xFA5, 0xFA7, 0x100 | i, GumpButtonType.Reply, 0);
                        this.AddHtmlLocalized(45, 72 + i * 20, 110, 18, hair.Name, 0x7FFF, false, false);</pre>

Fragment 3 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>this.AddButton(10, 70 + i * 20, 0xFA5, 0xFA7, 0x100 | i, GumpButtonType.Reply, 0);
                    this.AddHtmlLocalized(45, 72 + i * 20, 110, 18, hair.Name, 0x7FFF, false, false);</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Banner.cs

<pre>IPoint3D p = targeted as IPoint3D;
                        Map map = from.Map;

                        if (p == null || map == null)
                            return;

                        Point3D p3d = new Point3D(p);
                        ItemData id = TileData.ItemTable[this.m_ItemID & TileData.MaxItemValue];</pre>

Fragment 2 in file Scripts\Items\Addons\DecorativeShield.cs

<pre>IPoint3D p = targeted as IPoint3D;
                        Map map = from.Map;

                        if (p == null || map == null)
                            return;

                        Point3D p3d = new Point3D(p);
                        ItemData id = TileData.ItemTable[this.m_ItemID & TileData.MaxItemValue];</pre>

Fragment 3 in file Scripts\Items\Addons\HangingSkeleton.cs

<pre>IPoint3D p = targeted as IPoint3D;
                        Map map = from.Map;

                        if (p == null || map == null)
                            return;

                        Point3D p3d = new Point3D(p);
                        ItemData id = TileData.ItemTable[this.m_ItemID & TileData.MaxItemValue];</pre>

Fragment 4 in file Scripts\Services\CleanUpBritannia\Items\DragonHead.cs

<pre>IPoint3D p = targeted as IPoint3D;
                        Map map = from.Map;

                        if (p == null || map == null)
                            return;

                        Point3D p3d = new Point3D(p);
                        ItemData id = TileData.ItemTable[this.m_ItemID & TileData.MaxItemValue];</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\DecorativeShardShields.cs

<pre>IPoint3D p = targeted as IPoint3D;
                        Map map = from.Map;

                        if (p == null || map == null)
                            return;

                        Point3D p3d = new Point3D(p);
                        ItemData id = TileData.ItemTable[this.m_ItemID & TileData.MaxItemValue];</pre>

## Duplicated Code. Size: 106

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BrokenBed.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                if (this.m_Deed == null || this.m_Deed.Deleted || info.ButtonID == 0)
                    return;

                this.m_Deed.m_East = (info.ButtonID != 1);
                this.m_Deed.SendTarget(sender.Mobile);
            }</pre>

Fragment 2 in file Scripts\Items\Addons\BrokenVanity.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                if (this.m_Deed == null || this.m_Deed.Deleted || info.ButtonID == 0)
                    return;

                this.m_Deed.m_East = (info.ButtonID != 1);
                this.m_Deed.SendTarget(sender.Mobile);
            }</pre>

Fragment 3 in file Scripts\Items\Addons\Curtains.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                if (this.m_Deed == null || this.m_Deed.Deleted || info.ButtonID == 0)
                    return;

                this.m_Deed.m_East = (info.ButtonID != 1);
                this.m_Deed.SendTarget(sender.Mobile);
            }</pre>

Fragment 4 in file Scripts\Items\Addons\HangingAxes.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                if (this.m_Deed == null || this.m_Deed.Deleted || info.ButtonID == 0)
                    return;

                this.m_Deed.m_East = (info.ButtonID != 1);
                this.m_Deed.SendTarget(sender.Mobile);
            }</pre>

Fragment 5 in file Scripts\Items\Addons\HangingSwords.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                if (this.m_Deed == null || this.m_Deed.Deleted || info.ButtonID == 0)
                    return;

                this.m_Deed.m_East = (info.ButtonID != 1);
                this.m_Deed.SendTarget(sender.Mobile);
            }</pre>

Fragment 6 in file Scripts\Items\Addons\Statue.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                if (this.m_Deed == null || this.m_Deed.Deleted || info.ButtonID == 0)
                    return;

                this.m_Deed.m_East = (info.ButtonID != 1);
                this.m_Deed.SendTarget(sender.Mobile);
            }</pre>

Fragment 7 in file Scripts\Items\Addons\UnmadeBed.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                if (this.m_Deed == null || this.m_Deed.Deleted || info.ButtonID == 0)
                    return;

                this.m_Deed.m_East = (info.ButtonID != 1);
                this.m_Deed.SendTarget(sender.Mobile);
            }</pre>

Fragment 8 in file Scripts\Items\Addons\WoodenCoffin.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                if (this.m_Deed == null || this.m_Deed.Deleted || info.ButtonID == 0)
                    return;

                this.m_Deed.m_East = (info.ButtonID != 1);
                this.m_Deed.SendTarget(sender.Mobile);
            }</pre>

Fragment 9 in file Scripts\Items\Containers\Vanity.cs

<pre>public override void OnResponse(NetState sender, RelayInfo info)
            {
                if (this.m_Deed == null || this.m_Deed.Deleted || info.ButtonID == 0)
                    return;

                this.m_Deed.m_East = (info.ButtonID != 1);
                this.m_Deed.SendTarget(sender.Mobile);
            }</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\HelpInfo.cs

<pre>string cmd = cmds[0];
                string[] aliases = new string[cmds.Length - 1];

                for (int j = 0; j < aliases.Length; ++j)
                    aliases[j] = cmds[j + 1];</pre>

Fragment 2 in file Scripts\Commands\HelpInfo.cs

<pre>string cmd = cmds[0];
                string[] aliases = new string[cmds.Length - 1];

                for (int j = 0; j < aliases.Length; ++j)
                    aliases[j] = cmds[j + 1];</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\GreenThorns.cs

<pre>int x = this.Location.X + Utility.RandomMinMax(-1, 1);
                int y = this.Location.Y + Utility.RandomMinMax(-1, 1);
                int z = this.Map.GetAverageZ(x, y);</pre>

Fragment 2 in file Scripts\Items\Consumables\GreenThorns.cs

<pre>int x = this.Location.X + Utility.RandomMinMax(-1, 1);
                int y = this.Location.Y + Utility.RandomMinMax(-1, 1);
                int z = this.Map.GetAverageZ(x, y);</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\Omni AI\AITester.cs

<pre>this.SetResistance(ResistanceType.Physical, 50);
            this.SetResistance(ResistanceType.Fire, 50);
            this.SetResistance(ResistanceType.Cold, 50);
            this.SetResistance(ResistanceType.Poison, 50);
            this.SetResistance(ResistanceType.Energy, 50);</pre>

Fragment 2 in file Scripts\Services\PlayerZombies.cs

<pre>this.SetResistance(ResistanceType.Fire, 50);
            this.SetResistance(ResistanceType.Energy, 50);
            this.SetResistance(ResistanceType.Physical, 50);
            this.SetResistance(ResistanceType.Cold, 50);
            this.SetResistance(ResistanceType.Poison, 50);</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BlackBear.cs

<pre>this.SetSkill(SkillName.Tactics, 40.1, 60.0);
            this.SetSkill(SkillName.Wrestling, 40.1, 60.0);

            this.Fame = 450;
            this.Karma = 0;

            this.VirtualArmor = 24;

            this.Tamable = true;
            this.ControlSlots = 1;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BrownBear.cs

<pre>this.SetSkill(SkillName.Tactics, 40.1, 60.0);
            this.SetSkill(SkillName.Wrestling, 40.1, 60.0);

            this.Fame = 450;
            this.Karma = 0;

            this.VirtualArmor = 24;

            this.Tamable = true;
            this.ControlSlots = 1;</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseCreature.cs

<pre>if (strRaise > RawStr)
                SetStr(Math.Min(StrMax, strRaise));

            if (dexRaise > RawDex)
                SetDex(Math.Min(DexMax, dexRaise));

            if (intRaise > RawInt)
                SetInt(Math.Min(IntMax, intRaise));</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Creatures\CovetousCreature.cs

<pre>if (strRaise > RawStr)
                SetStr(Math.Min(StrMax, strRaise));

            if (dexRaise > RawDex)
                SetDex(Math.Min(DexMax, dexRaise));

            if (intRaise > RawInt)
                SetInt(Math.Min(IntMax, intRaise));</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>{
                this.m_From.SendGump(new ConfirmSignupGump(this.m_From, this.m_Registrar, this.m_Tournament, this.m_Players));

                if (this.m_Registrar != null)
                    this.m_Registrar.PrivateOverheadMessage(MessageType.Regular,
                        0x22, false, "They ignore your invitation.", from.NetState);
            }</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>{
                    this.m_From.SendGump(new ConfirmSignupGump(this.m_From, this.m_Registrar, this.m_Tournament, this.m_Players));

                    if (this.m_Registrar != null)
                        this.m_Registrar.PrivateOverheadMessage(MessageType.Regular,
                            0x22, false, "They ignore your invitation.", from.NetState);
                }</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>{
                    this.m_From.SendGump(new ConfirmSignupGump(this.m_From, this.m_Registrar, this.m_Tournament, this.m_Players));

                    if (this.m_Registrar != null)
                        this.m_Registrar.PrivateOverheadMessage(MessageType.Regular,
                            0x22, false, "They are already assigned to another duel.", from.NetState);
                }</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>{
                    this.m_From.SendGump(new ConfirmSignupGump(this.m_From, this.m_Registrar, this.m_Tournament, this.m_Players));

                    if (this.m_Registrar != null)
                        this.m_Registrar.PrivateOverheadMessage(MessageType.Regular,
                            0x22, false, "They are already assigned to another duel.", from.NetState);
                }</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>{
                    this.m_From.SendGump(new ConfirmSignupGump(this.m_From, this.m_Registrar, this.m_Tournament, this.m_Players));

                    if (this.m_Registrar != null)
                        this.m_Registrar.PrivateOverheadMessage(MessageType.Regular,
                            0x22, false, "You have already named them as a team member.", from.NetState);
                }</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>{
                    this.m_From.SendGump(new ConfirmSignupGump(this.m_From, this.m_Registrar, this.m_Tournament, this.m_Players));

                    if (this.m_Registrar != null)
                        this.m_Registrar.PrivateOverheadMessage(MessageType.Regular,
                            0x22, false, "You have already named them as a team member.", from.NetState);
                }</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>{
                    this.m_From.SendGump(new ConfirmSignupGump(this.m_From, this.m_Registrar, this.m_Tournament, this.m_Players));

                    if (this.m_Registrar != null)
                        this.m_Registrar.PrivateOverheadMessage(MessageType.Regular,
                            0x22, false, "They have already entered this tournament.", from.NetState);
                }</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>{
                    this.m_From.SendGump(new ConfirmSignupGump(this.m_From, this.m_Registrar, this.m_Tournament, this.m_Players));

                    if (this.m_Registrar != null)
                        this.m_Registrar.PrivateOverheadMessage(MessageType.Regular,
                            0x22, false, "They have already entered this tournament.", from.NetState);
                }</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>{
                    this.m_From.SendGump(new ConfirmSignupGump(this.m_From, this.m_Registrar, this.m_Tournament, this.m_Players));

                    if (this.m_Registrar != null)
                        this.m_Registrar.PrivateOverheadMessage(MessageType.Regular,
                            0x22, false, "Your team is full.", from.NetState);
                }</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>{
                    this.m_From.SendGump(new ConfirmSignupGump(this.m_From, this.m_Registrar, this.m_Tournament, this.m_Players));

                    if (this.m_Registrar != null)
                        this.m_Registrar.PrivateOverheadMessage(MessageType.Regular,
                            0x22, false, "Your team is full.", from.NetState);
                }</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\MerchantCrew.cs

<pre>{
                ChangeAIType(AIType.AI_Mage);
                SetSkill(SkillName.Magery, 100.0, 120.0);
                SetSkill(SkillName.EvalInt, 100.0, 120.0);
                SetSkill(SkillName.Meditation, 100.0, 120.0);
                SetSkill(SkillName.MagicResist, 100.0, 120.0);
            }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\PirateCrew.cs

<pre>{
                ChangeAIType(AIType.AI_Mage);
                SetSkill(SkillName.Magery, 100.0, 120.0);
                SetSkill(SkillName.EvalInt, 100.0, 120.0);
                SetSkill(SkillName.Meditation, 100.0, 120.0);
                SetSkill(SkillName.MagicResist, 100.0, 120.0);
            }</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>surface = id.Surface;
				impassable = id.Impassable;
				if (checkmob)
				{
					wet = (id.Flags & TileFlag.Wet) != 0;
					// dont allow wateronly creatures on land
					if (cantwalk && !wet)
						impassable = true;
					// allow water creatures on water
					if (canswim && wet)
					{
						surface = true;
						impassable = false;
					}
				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>surface = id.Surface;
					impassable = id.Impassable;
					if (checkmob)
					{
						wet = (id.Flags & TileFlag.Wet) != 0;
						// dont allow wateronly creatures on land
						if (cantwalk && !wet)
							impassable = true;
						// allow water creatures on water
						if (canswim && wet)
						{
							surface = true;
							impassable = false;
						}
					}</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>var eable = m_Map.GetClientsInRange(m_Location);

				foreach (NetState state in eable)
				{
					if (state != m_NetState && state.Mobile.CanSee(this))
					{
						state.Send(p);
					}
				}

				Packet.Release(p);

				eable.Free();</pre>

Fragment 2 in file Server\Mobile.cs

<pre>var eable = m_Map.GetClientsInRange(m_Location);

				foreach (NetState state in eable)
				{
					if (state != m_NetState && state.Mobile.CanSee(this))
					{
						state.Send(p);
					}
				}

				Packet.Release(p);

				eable.Free();</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketHandlers.cs

<pre>new SkillNameValue[4]
					{
						new SkillNameValue((SkillName)is1, vs1), new SkillNameValue((SkillName)is2, vs2),
						new SkillNameValue((SkillName)is3, vs3), new SkillNameValue((SkillName)is4, vs4),
					}</pre>

Fragment 2 in file Server\Network\PacketHandlers.cs

<pre>new SkillNameValue[4]
                    {
                        new SkillNameValue( (SkillName)is1, vs1 ),
                        new SkillNameValue( (SkillName)is2, vs2 ),
                        new SkillNameValue( (SkillName)is3, vs3 ),
                        new SkillNameValue( (SkillName)is4, vs4 ),
                    }</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Server\World.cs

<pre>if (!Directory.Exists("Saves/Mobiles/"))
			{
				Directory.CreateDirectory("Saves/Mobiles/");
			}

			if (!Directory.Exists("Saves/Items/"))
			{
				Directory.CreateDirectory("Saves/Items/");
			}

			if (!Directory.Exists("Saves/Guilds/"))
			{
				Directory.CreateDirectory("Saves/Guilds/");
			}</pre>

Fragment 2 in file Server\World.cs

<pre>if (!Directory.Exists("Saves/Mobiles/"))
			{
				Directory.CreateDirectory("Saves/Mobiles/");
			}
			if (!Directory.Exists("Saves/Items/"))
			{
				Directory.CreateDirectory("Saves/Items/");
			}
			if (!Directory.Exists("Saves/Guilds/"))
			{
				Directory.CreateDirectory("Saves/Guilds/");
			}</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\HighPlainsBoura.cs

<pre>private void Recover_Callback(object state)
        {
            var defender = state as Mobile;

            if (defender != null)
            {
                defender.Frozen = false;
                defender.Combatant = null;
                defender.LocalOverheadMessage(MessageType.Regular, 0x3B2, false, "You recover your senses.");
            }

            m_Stunning = false;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\LowlandBoura.cs

<pre>private void Recover_Callback(object state)
        {
            var defender = state as Mobile;

            if (defender != null)
            {
                defender.Frozen = false;
                defender.Combatant = null;
                defender.LocalOverheadMessage(MessageType.Regular, 0x3B2, false, "You recover your senses.");
            }

            m_Stunning = false;
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\RuddyBoura.cs

<pre>private void Recover_Callback(object state)
        {
            var defender = state as Mobile;

            if (defender != null)
            {
                defender.Frozen = false;
                defender.Combatant = null;
                defender.LocalOverheadMessage(MessageType.Regular, 0x3B2, false, "You recover your senses.");
            }

            m_Stunning = false;
        }</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseRenowned.cs

<pre>public void RegisterDamage(Mobile from, int amount)
        {
            if (from == null || !from.Player)
                return;

            if (this.m_DamageEntries.ContainsKey(from))
                this.m_DamageEntries[from] += amount;
            else
                this.m_DamageEntries.Add(from, amount);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseSABosses.cs

<pre>public void RegisterDamage(Mobile from, int amount)
        {
            if (from == null || !from.Player)
                return;

            if (this.m_DamageEntries.ContainsKey(from))
                this.m_DamageEntries[from] += amount;
            else
                this.m_DamageEntries.Add(from, amount);
        }</pre>

Fragment 3 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>public void RegisterDamage(Mobile from, int amount)
        {
            if (from == null || !from.Player)
                return;

            if (this.m_DamageEntries.ContainsKey(from))
                this.m_DamageEntries[from] += amount;
            else
                this.m_DamageEntries.Add(from, amount);
        }</pre>

Fragment 4 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>public void RegisterDamage(Mobile from, int amount)
        {
            if (from == null || !from.Player)
                return;

            if (this.m_DamageEntries.ContainsKey(from))
                this.m_DamageEntries[from] += amount;
            else
                this.m_DamageEntries.Add(from, amount);
        }</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Quest\AbyssKey.cs

<pre>public virtual void StartTimer()
        {
            if (this.m_Timer != null)
                return;

            this.m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), new TimerCallback(Slice));
            this.m_Timer.Priority = TimerPriority.OneSecond;
        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\QuestItems\WillemHartesHat.cs

<pre>public virtual void StartTimer()
        {
            if (this.m_Timer != null)
                return;

            this.m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), new TimerCallback(Slice));
            this.m_Timer.Priority = TimerPriority.OneSecond;
        }</pre>

Fragment 3 in file Scripts\Services\Peerless\PeerlessKey.cs

<pre>public virtual void StartTimer()
        {
            if (this.m_Timer != null)
                return;

            this.m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), new TimerCallback(Slice));
            this.m_Timer.Priority = TimerPriority.OneSecond;
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\ExodusSacrificalDagger.cs

<pre>public virtual void StartTimer()
        {
            if (this.m_Timer != null)
                return;

            this.m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), new TimerCallback(Slice));
            this.m_Timer.Priority = TimerPriority.OneSecond;
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\ExodusSummoningRite.cs

<pre>public virtual void StartTimer()
        {
            if (this.m_Timer != null)
                return;

            this.m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), new TimerCallback(Slice));
            this.m_Timer.Priority = TimerPriority.OneSecond;
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\RobeofRite.cs

<pre>public virtual void StartTimer()
        {
            if (this.m_Timer != null)
                return;

            this.m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), new TimerCallback(Slice));
            this.m_Timer.Priority = TimerPriority.OneSecond;
        }</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Enrico.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Odell.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Sam.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));</pre>

Fragment 4 in file Scripts\Mobiles\NPCs\Zorda.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));</pre>

Fragment 5 in file Scripts\Services\CommunityCollections\MuseumDonationBox.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));</pre>

Fragment 6 in file Scripts\Services\CommunityCollections\RoyalZooDonationBox.cs

<pre>base.Init();

            this.Donations.Add(new CollectionItem(typeof(Gold), 0xEEF, 1073116, 0x0, 0.06666));
            this.Donations.Add(new CollectionItem(typeof(BankCheck), 0x14F0, 1075013, 0x34, 0.06666));</pre>

## Duplicated Code. Size: 105

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\PrimevalLich.cs

<pre>this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Energy, 20);
            this.SetDamageType(ResistanceType.Poison, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\ShimmeringEffusion.cs

<pre>this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Poison, 20);
            this.SetDamageType(ResistanceType.Energy, 20);</pre>

Fragment 3 in file Scripts\Mobiles\Void Creatures\Anlorvaglem.cs

<pre>this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Poison, 20);
            this.SetDamageType(ResistanceType.Energy, 20);</pre>

Fragment 4 in file Scripts\Mobiles\Void Creatures\Anlorzen.cs

<pre>this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Poison, 20);
            this.SetDamageType(ResistanceType.Energy, 20);</pre>

Fragment 5 in file Scripts\Mobiles\Void Creatures\Anzuanord.cs

<pre>this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Poison, 20);
            this.SetDamageType(ResistanceType.Energy, 20);</pre>

Fragment 6 in file Scripts\Mobiles\Void Creatures\Betballem.cs

<pre>this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Poison, 20);
            this.SetDamageType(ResistanceType.Energy, 20);</pre>

Fragment 7 in file Scripts\Services\ExploringTheDeep\Mobiles\Shadowlord.cs

<pre>this.SetDamageType(ResistanceType.Physical, 20);
            this.SetDamageType(ResistanceType.Fire, 20);
            this.SetDamageType(ResistanceType.Cold, 20);
            this.SetDamageType(ResistanceType.Poison, 20);
            this.SetDamageType(ResistanceType.Energy, 20);</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Implementors\RangeCommandImplementor.cs

<pre>string[] oldArgs = e.Arguments;
                        string[] args = new string[oldArgs.Length - 2];

                        for (int i = 0; i < args.Length; ++i)
                            args[i] = oldArgs[i + 2];</pre>

Fragment 2 in file Scripts\Commands\Generic\Implementors\SerialCommandImplementor.cs

<pre>string[] oldArgs = e.Arguments;
                        string[] args = new string[oldArgs.Length - 2];

                        for (int i = 0; i < args.Length; ++i)
                            args[i] = oldArgs[i + 2];</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\Equivocation.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = pois = 50;
            cold = nrgy = chaos = direct = fire = 0;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\Equivocation.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = pois = 50;
            cold = nrgy = chaos = direct = fire = 0;
        }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\CommunicationCrystals.cs

<pre>if (!this.m_Crystal.IsAccessibleTo(from))
                    return;

                if (from.Map != this.m_Crystal.Map || !from.InRange(this.m_Crystal.GetWorldLocation(), 2))
                {
                    from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
                    return;
                }</pre>

Fragment 2 in file Scripts\Items\Consumables\CommunicationCrystals.cs

<pre>if (!this.m_Crystal.IsAccessibleTo(from))
                    return;

                if (from.Map != this.m_Crystal.Map || !from.InRange(this.m_Crystal.GetWorldLocation(), 2))
                {
                    from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
                    return;
                }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Talismans\BloodwoodSpirit.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && (this.Protection == null || this.Protection.IsEmpty))
                this.Protection = GetRandomProtection(false);
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Talismans\TotemOfVoid.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && (this.Protection == null || this.Protection.IsEmpty))
                this.Protection = GetRandomProtection(false);
        }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\Incubator.cs

<pre>if (canDrop && item is ChickenLizardEgg)
            {
                ChickenLizardEgg egg = (ChickenLizardEgg)item;

                if (egg.TotalIncubationTime > TimeSpan.FromHours(120))
                    egg.BurnEgg();
                else
                {
                    egg.IncubationStart = DateTime.UtcNow;
                    egg.Incubating = true;
                }
            }

            return canDrop;</pre>

Fragment 2 in file Scripts\Items\Functional\Incubator.cs

<pre>if (canDrop && item is ChickenLizardEgg)
            {
                ChickenLizardEgg egg = (ChickenLizardEgg)item;

                if (egg.TotalIncubationTime > TimeSpan.FromHours(120))
                    egg.BurnEgg();
                else
                {
                    egg.IncubationStart = DateTime.UtcNow;
                    egg.Incubating = true;
                }
            }

            return canDrop;</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\AOS.cs

<pre>uint mask = (uint)bitmask;

            if ((this.m_Names & mask) == 0)
                return 0;

            int index = this.GetIndex(mask);

            if (index >= 0 && index < this.m_Values.Length)
                return this.m_Values[index];</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlAosAttributes.cs

<pre>uint mask = (uint)bitmask;

            if ((this.m_Names & mask) == 0)
                return 0;

            int index = this.GetIndex(mask);

            if (index >= 0 && index < this.m_Values.Length)
                return this.m_Values[index];</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\PlayerMobile.cs

<pre>AddBackground(0, 0, 240, 142, 0x13BE);
				AddImageTiled(6, 6, 228, 100, 0xA40);
				AddImageTiled(6, 116, 228, 20, 0xA40);
				AddAlphaRegion(6, 6, 228, 142);</pre>

Fragment 2 in file Scripts\Mobiles\PlayerMobile.cs

<pre>AddBackground(0, 0, 240, 142, 0x13BE);
                AddImageTiled(6, 6, 228, 100, 0xA40);
                AddImageTiled(6, 116, 228, 20, 0xA40);
                AddAlphaRegion(6, 6, 228, 142);</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Myrmidex Invasion\MoonstonePowerGenerator.cs

<pre>c = new AddonComponent(39759);
            c.Hue = 2955;
            AddComponent(c, -1, 0, 0);

            c = new AddonComponent(39759);
            c.Hue = 2955;
            AddComponent(c, 1, 0, 0);</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Myrmidex Invasion\MoonstonePowerGenerator.cs

<pre>c = new AddonComponent(39759);
            c.Hue = 2955;
            AddComponent(c, 0, -1, 0);

            c = new AddonComponent(39759);
            c.Hue = 2955;
            AddComponent(c, 0, 1, 0);</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 21, 0, 0, 1779, -1, "", 1);// 141
			AddComplexComponent( (BaseAddon) this, 2769, 21, -1, 0, 1779, -1, "", 1);// 142</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 0, 21, 0, 1779, -1, "", 1);// 1159
			AddComplexComponent( (BaseAddon) this, 2769, -1, 21, 0, 1779, -1, "", 1);// 1161</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 20, 0, 0, 1779, -1, "", 1);// 145
			AddComplexComponent( (BaseAddon) this, 2769, 20, -1, 0, 1779, -1, "", 1);// 146</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 0, 20, 0, 1779, -1, "", 1);// 1167
			AddComplexComponent( (BaseAddon) this, 2769, -1, 20, 0, 1779, -1, "", 1);// 1170</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Core\Town.cs

<pre>bool isFinance = this.IsFinance(from);
            bool isSheriff = this.IsSheriff(from);
            string type = null;

            // NOTE: Messages not OSI-accurate, intentional
            if (isFinance && isSheriff) // GM only
                type = "vendor or guard";
            else if (isFinance)
                type = "vendor";
            else if (isSheriff)
                type = "guard";</pre>

Fragment 2 in file Scripts\Services\Factions\Core\Town.cs

<pre>bool isFinance = this.IsFinance(from);
            bool isSheriff = this.IsSheriff(from);
            string type = null;

            if (isFinance && isSheriff) // GM only
                type = "vendor or guard";
            else if (isFinance)
                type = "vendor";
            else if (isSheriff)
                type = "guard";</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\WriteMulti.cs

<pre>private class TileEntry
		{
			public int ID;
			public int X;
			public int Y;
			public int Z;

			public TileEntry(int id, int x, int y, int z)
			{
				ID = id;
				X = x;
				Y = y;
				Z = z;
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\Attachments\XmlSiege.cs

<pre>private class TileEntry
		{
			public int ID;
			public int X;
			public int Y;
			public int Z;

			public TileEntry(int id, int x, int y, int z)
			{
				ID = id;
				X = x;
				Y = y;
				Z = z;
			}
		}</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Eighth\EnergyVortex.cs

<pre>protected override void OnTargetOutOfLOS(Mobile from, object o)
            {
                from.SendLocalizedMessage(501943); // Target cannot be seen. Try again.
                from.Target = new InternalTarget(this.m_Owner);
                from.Target.BeginTimeout(from, this.TimeoutTime - DateTime.UtcNow);
                this.m_Owner = null;
            }</pre>

Fragment 2 in file Scripts\Spells\Fifth\BladeSpirits.cs

<pre>protected override void OnTargetOutOfLOS(Mobile from, object o)
            {
                from.SendLocalizedMessage(501943); // Target cannot be seen. Try again.
                from.Target = new InternalTarget(this.m_Owner);
                from.Target.BeginTimeout(from, this.TimeoutTime - DateTime.UtcNow);
                this.m_Owner = null;
            }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>for (int i = 0; i < cache.Length; ++i)
				{
					for (int j = 0; j < cache[i].Length; ++j)
					{
						Packet.Release(ref cache[i][j]);
					}
				}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>for (int i = 0; i < cache.Length; ++i)
				{
					for (int j = 0; j < cache[i].Length; ++j)
					{
						Packet.Release(ref cache[i][j]);
					}
				}</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>string line;

            while ((line = ip.ReadLine()) != null)
            {
                line = line.Trim();

                if (line.Length > 0 && !line.StartsWith("#"))
                    break;
            }

            if (string.IsNullOrEmpty(line))
                return null;</pre>

Fragment 2 in file Scripts\Commands\DecorateDelete.cs

<pre>string line;

            while ((line = ip.ReadLine()) != null)
            {
                line = line.Trim();

                if (line.Length > 0 && !line.StartsWith("#"))
                    break;
            }

            if (string.IsNullOrEmpty(line))
                return null;</pre>

Fragment 3 in file Scripts\Commands\DecorateMag.cs

<pre>string line;

            while ((line = ip.ReadLine()) != null)
            {
                line = line.Trim();

                if (line.Length > 0 && !line.StartsWith("#"))
                    break;
            }

            if (string.IsNullOrEmpty(line))
                return null;</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\ColdForgedBlade.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = pois = nrgy = chaos = direct = 0;
            cold = 100;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\Frostbringer.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = pois = nrgy = chaos = direct = 0;
            cold = 100;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\TOTGreaterArtifacts.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = pois = nrgy = chaos = direct = 0;
            cold = 100;
        }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\DreadsRevenge.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = cold = nrgy = chaos = direct = 0;
            pois = 100;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\ScepterOfTheChief.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = cold = nrgy = chaos = direct = 0;
            pois = 100;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Weapons\TheTaskmaster.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = cold = nrgy = chaos = direct = 0;
            pois = 100;
        }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\MischiefMaker.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            pois = fire = phys = nrgy = chaos = direct = 0;
            cold = 100;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\SoulSeeker.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            cold = 100;

            pois = fire = phys = nrgy = chaos = direct = 0;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Weapons\WrathOfTheDryad.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            pois = 100;

            cold = fire = phys = nrgy = chaos = direct = 0;
        }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>if (field.Visible && field.Caster != null && (!Core.AOS || m_Mobile != field.Caster) && SpellHelper.ValidIndirectTarget(field.Caster, m_Mobile) && field.Caster.CanBeHarmful(m_Mobile, false))
                    {
                        eable.Free();
                        return item;
                    }</pre>

Fragment 2 in file Scripts\Mobiles\AI\MageAI.cs

<pre>if (field.Visible && field.Caster != null && (!Core.AOS || m_Mobile != field.Caster) && SpellHelper.ValidIndirectTarget(field.Caster, m_Mobile) && field.Caster.CanBeHarmful(m_Mobile, false))
                    {
                        eable.Free();
                        return item;
                    }</pre>

Fragment 3 in file Scripts\Mobiles\AI\MageAI.cs

<pre>if (field.Visible && field.Caster != null && (!Core.AOS || m_Mobile != field.Caster) && SpellHelper.ValidIndirectTarget(field.Caster, m_Mobile) && field.Caster.CanBeHarmful(m_Mobile, false))
                    {
                        eable.Free();
                        return item;
                    }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\HighPlainsBoura.cs

<pre>if (c != null && !c.Deleted && c is Corpse)
            {
                var corpse = (Corpse) c;
                if (Utility.RandomDouble() < 0.01 && corpse.Killer != null && !corpse.Killer.Deleted)
                {
                    GiveVArtifactTo(corpse.Killer);
                }
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Raptor.cs

<pre>if (c != null && !c.Deleted && c is Corpse)
			{
				var corpse = (Corpse)c;
				if (Utility.RandomDouble() < 0.01 && corpse.Killer != null && !corpse.Killer.Deleted)
				{
					GiveVArtifactTo(corpse.Killer);
				}
			}</pre>

Fragment 3 in file Scripts\Mobiles\Normal\StoneSlith.cs

<pre>if (c != null && !c.Deleted && c is Corpse)
            {
                var corpse = (Corpse) c;
                if (Utility.RandomDouble() < 0.01 && corpse.Killer != null && !corpse.Killer.Deleted)
                {
                    GiveVArtifactTo(corpse.Killer);
                }
            }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Items\Artifacts\CullingBlade.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = cold = nrgy = pois = direct = 0;
            chaos = 100;
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\Artifacts\RuneEngravedPegLeg.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = cold = nrgy = pois = direct = 0;
            chaos = 100;
        }</pre>

Fragment 3 in file Scripts\Services\Expansions\High Seas\Items\Artifacts\WandOfThunderingGlory.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = cold = nrgy = pois = direct = 0;
            chaos = 100;
        }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.08 > Utility.RandomDouble() && Region.Find(c.Location, c.Map).IsPartOf("Shame"))
                c.DropItem(new ShameCrystal());
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.08 > Utility.RandomDouble() && Region.Find(c.Location, c.Map).IsPartOf("Shame"))
                c.DropItem(new ShameCrystal());
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.08 > Utility.RandomDouble() && Region.Find(c.Location, c.Map).IsPartOf("Shame"))
                c.DropItem(new ShameCrystal());
        }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.10 > Utility.RandomDouble() && Region.Find(c.Location, c.Map).IsPartOf("Shame"))
                c.DropItem(new ShameCrystal());
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.10 > Utility.RandomDouble() && Region.Find(c.Location, c.Map).IsPartOf("Shame"))
                c.DropItem(new ShameCrystal());
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (0.10 > Utility.RandomDouble() && Region.Find(c.Location, c.Map).IsPartOf("Shame"))
                c.DropItem(new ShameCrystal());
        }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Server\Random.cs

<pre>private void CheckSwap(int c)
		{
			lock (_sync)
			{
				if (_Index + c < BUFFER_SIZE)
				{
					return;
				}

				lock (_syncB)
				{
					var b = _Working;
					_Working = _Buffer;
					_Buffer = b;
					_Index = 0;
				}
			}
			ThreadPool.QueueUserWorkItem(Fill);
		}</pre>

Fragment 2 in file Server\Random.cs

<pre>private void CheckSwap(int c)
		{
			lock (_sync)
			{
				if (_Index + c < BUFFER_SIZE)
				{
					return;
				}

				lock (_syncB)
				{
					var b = _Working;
					_Working = _Buffer;
					_Buffer = b;
					_Index = 0;
				}
			}
			ThreadPool.QueueUserWorkItem(Fill);
		}</pre>

Fragment 3 in file Server\Random.cs

<pre>private void CheckSwap(int c)
		{
			lock (_sync)
			{
				if (_Index + c < BUFFER_SIZE)
				{
					return;
				}

				lock (_syncB)
				{
					var b = _Working;
					_Working = _Buffer;
					_Buffer = b;
					_Index = 0;
				}
			}
			ThreadPool.QueueUserWorkItem(Fill);
		}</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\BowOfTheInfiniteSwarm.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = 100;
            fire = cold = nrgy = chaos = direct = pois = 0;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\BowOfTheInfiniteSwarm.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = 100;
            fire = cold = nrgy = chaos = direct = pois = 0;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Weapons\Glenda.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = 100;
            fire = cold = nrgy = chaos = direct = pois = 0;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Weapons\TheDeceiver.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = 100;
            fire = cold = nrgy = chaos = direct = pois = 0;
        }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\FaerieFire.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = cold = pois = nrgy = chaos = direct = 0;
            fire = 100;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\OverseerSunderedBlade.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = cold = pois = nrgy = chaos = direct = 0;
            fire = 100;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Weapons\WildfireBow.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = cold = pois = nrgy = chaos = direct = 0;
            fire = 100;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\TOTGreaterArtifacts.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = cold = pois = nrgy = chaos = direct = 0;
            fire = 100;
        }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\GargishClothArmor.cs

<pre>public override int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            return base.OnCraft(quality, makersMark, from, craftSystem, null, tool, craftItem, resHue);
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\GargishClothArmor.cs

<pre>public override int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            return base.OnCraft(quality, makersMark, from, craftSystem, null, tool, craftItem, resHue);
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Armor\GargishClothArmor.cs

<pre>public override int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            return base.OnCraft(quality, makersMark, from, craftSystem, null, tool, craftItem, resHue);
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Armor\GargishClothArmor.cs

<pre>public override int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            return base.OnCraft(quality, makersMark, from, craftSystem, null, tool, craftItem, resHue);
        }</pre>

## Duplicated Code. Size: 104

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\LuminousRuneBlade.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = cold = pois = chaos = direct = 0;
            nrgy = 100;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\SilvanisFeywoodBow.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = cold = pois = chaos = direct = 0;
            nrgy = 100;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Weapons\StaffOfTheMagi.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = cold = pois = chaos = direct = 0;
            nrgy = 100;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Weapons\TheDragonSlayer.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = cold = pois = chaos = direct = 0;
            nrgy = 100;
        }</pre>

Fragment 5 in file Scripts\Items\Artifacts\TOTGreaterArtifacts.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = cold = pois = chaos = direct = 0;
            nrgy = 100;
        }</pre>

Fragment 6 in file Scripts\Items\Artifacts\TOTLesserArtifacts.cs

<pre>public override void GetDamageTypes(Mobile wielder, out int phys, out int fire, out int cold, out int pois, out int nrgy, out int chaos, out int direct)
        {
            phys = fire = cold = pois = chaos = direct = 0;

            nrgy = 100;
        }</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DungeonHitchingPost.cs

<pre>protected override void OnTarget(Mobile from, object targeted)
            {
                if (targeted is BaseCreature)
                    this.m_Post.EndStable(from, (BaseCreature)targeted);
                else if (targeted == from)
                    from.SendLocalizedMessage(502672); // HA HA HA! Sorry, I am not an inn.
                else
                    from.SendLocalizedMessage(1048053); // You can't stable that!
            }</pre>

Fragment 2 in file Scripts\Items\Addons\HitchingPost.cs

<pre>protected override void OnTarget(Mobile from, object targeted)
            {
                if (targeted is BaseCreature)
                    this.m_Post.EndStable(from, (BaseCreature)targeted);
                else if (targeted == from)
                    from.SendLocalizedMessage(502672); // HA HA HA! Sorry, I am not an inn.
                else
                    from.SendLocalizedMessage(1048053); // You can't stable that!
            }</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Wreath.cs

<pre>if (this.Deleted)
                return;

            BaseHouse house = BaseHouse.FindHouseAt(loc, from.Map, 16);

            if (house == null || !house.IsCoOwner(from))
            {
                from.SendLocalizedMessage(1042036); // That location is not in your house.
                return;
            }

            int itemID = 0;</pre>

Fragment 2 in file Scripts\Items\Decorative\Mistletoe.cs

<pre>if (this.Deleted)
                return;

            BaseHouse house = BaseHouse.FindHouseAt(loc, from.Map, 16);

            if (house == null || !house.IsCoOwner(from))
            {
                from.SendLocalizedMessage(1042036); // That location is not in your house.
                return;
            }

            int itemID = 0;</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\BaseConflagrationPotion.cs

<pre>public void Explode_Callback(object state)
        {
            object[] states = (object[])state;

            this.Explode((Mobile)states[0], (Point3D)states[1], (Map)states[2]);
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\BaseConfusionBlastPotion.cs

<pre>public void Explode_Callback(object state)
        {
            object[] states = (object[])state;

            this.Explode((Mobile)states[0], (Point3D)states[1], (Map)states[2]);
        }</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Gorilla.cs

<pre>this.SetMana(0);

            this.SetDamage(4, 10);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 20, 25);
            this.SetResistance(ResistanceType.Fire, 5, 10);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Walrus.cs

<pre>this.SetMana(0);

            this.SetDamage(4, 10);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 20, 25);
            this.SetResistance(ResistanceType.Fire, 5, 10);</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\YoungRonin.cs

<pre>switch ( Utility.Random(3) )
            {
                case 0:
                    this.AddItem(new StuddedHaidate());
                    break;
                case 1:
                    this.AddItem(new PlateSuneate());
                    break;
                default:
                    this.AddItem(new LeatherSuneate());
                    break;
            }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HaochisGuardsman.cs

<pre>switch ( Utility.Random(3) )
            {
                case 0:
                    this.AddItem(new StuddedHaidate());
                    break;
                case 1:
                    this.AddItem(new PlateSuneate());
                    break;
                default:
                    this.AddItem(new LeatherSuneate());
                    break;
            }</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Armor Refinement\Items.cs

<pre>int v = reader.ReadInt();

            m_RefinementType = (RefinementType)reader.ReadInt();
            m_CraftType = (RefinementCraftType)reader.ReadInt();
            m_SubCraftType = (RefinementSubCraftType)reader.ReadInt();
            m_ModType = (ModType)reader.ReadInt();</pre>

Fragment 2 in file Scripts\Services\Armor Refinement\Items.cs

<pre>int v = reader.ReadInt();

            m_RefinementType = (RefinementType)reader.ReadInt();
            m_CraftType = (RefinementCraftType)reader.ReadInt();
            m_SubCraftType = (RefinementSubCraftType)reader.ReadInt();
            m_ModType = (ModType)reader.ReadInt();</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\Books\BOBGump.cs

<pre>if (name is int)
                            this.AddHtmlLocalized(316, y, 100, 20, (int)name, LabelColor, false, false);
                        else if (name is string)
                            this.AddLabel(316, y, 1152, (string)name);</pre>

Fragment 2 in file Scripts\Services\BulkOrders\Books\BOBGump.cs

<pre>if (name is int)
                        this.AddHtmlLocalized(316, y, 100, 20, (int)name, LabelColor, false, false);
                    else if (name is string)
                        this.AddLabel(316, y, 1152, (string)name);</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>AddButton(15, Height - 35, 4005, 4007, 250, GumpButtonType.Reply, 0);

            AddHtml(55, Height - 32, 150, 16, Color("#FFFF00", "CONTINUE"), false, false);
            DiceGame.Remove();</pre>

Fragment 2 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>AddButton(15, Height - 35, 4005, 4007, 250, GumpButtonType.Reply, 0);

            AddHtml(55, Height - 32, 150, 16, Color("#FFFF00", "CONTINUE"), false, false);
            DiceGame.Remove();</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>if (list != null)
				{
					foreach (XmlAttachment a in list)
					{
						if (a != null && !a.Deleted)
							e.Mobile.SendMessage("\t{0} : {1} : {2}", a.GetType().Name, a.Name, a.OnIdentify(e.Mobile));
					}
				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>if (list != null)
				{
					foreach (XmlAttachment a in list)
					{
						if (a != null && !a.Deleted)
							e.Mobile.SendMessage("\t{0} : {1} : {2}", a.GetType().Name, a.Name, a.OnIdentify(e.Mobile));
					}
				}</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>bool result;
					if(e.Arguments[0]=="si" || e.Arguments[0]=="ok" || e.Arguments[0]=="vero")
						result=true;
					else
						bool.TryParse(e.Arguments[0], out result);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>bool result;
					if(e.Arguments[0]=="si" || e.Arguments[0]=="ok" || e.Arguments[0]=="vero")
						result=true;
					else
						bool.TryParse(e.Arguments[0], out result);</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Server\Gumps\GumpBackground.cs

<pre>public override void AppendTo( IGumpWriter disp )
		{
			disp.AppendLayout( m_LayoutName );
			disp.AppendLayout( m_X );
			disp.AppendLayout( m_Y );
			disp.AppendLayout( m_GumpID );
			disp.AppendLayout( m_Width );
			disp.AppendLayout( m_Height );
		}</pre>

Fragment 2 in file Server\Gumps\GumpImageTiled.cs

<pre>public override void AppendTo( IGumpWriter disp )
		{
			disp.AppendLayout( m_LayoutName );
			disp.AppendLayout( m_X );
			disp.AppendLayout( m_Y );
			disp.AppendLayout( m_Width );
			disp.AppendLayout( m_Height );
			disp.AppendLayout( m_GumpID );
		}</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>if (item.AtWorldPoint(x, y) &&
									(item.Z == newZ || ((item.Z + item.ItemData.Height) > newZ && (newZ + 15) > item.Z)) && !item.OnMoveOver(this))
								{
									return false;
								}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>if (item.AtWorldPoint(x, y) &&
										 (item.Z == newZ || ((item.Z + item.ItemData.Height) > newZ && (newZ + 15) > item.Z)) && !item.OnMoveOver(this))
								{
									return false;
								}</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void Write(HashSet<Item> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(item => item.Deleted);
			}

			Write(set.Count);

			foreach (Item item in set)
			{
				Write(item);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void Write(HashSet<Item> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(item => item.Deleted);
			}

			Write(set.Count);

			foreach (Item item in set)
			{
				Write(item);
			}
		}</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void Write(HashSet<Mobile> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(mobile => mobile.Deleted);
			}

			Write(set.Count);

			foreach (Mobile mob in set)
			{
				Write(mob);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void Write(HashSet<Mobile> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(mobile => mobile.Deleted);
			}

			Write(set.Count);

			foreach (Mobile mob in set)
			{
				Write(mob);
			}
		}</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void Write(HashSet<BaseGuild> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(guild => guild.Disbanded);
			}

			Write(set.Count);

			foreach (BaseGuild guild in set)
			{
				Write(guild);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void Write(HashSet<BaseGuild> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(guild => guild.Disbanded);
			}

			Write(set.Count);

			foreach (BaseGuild guild in set)
			{
				Write(guild);
			}
		}</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void Write(HashSet<SaveData> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(data => data.Deleted);
			}

			Write(set.Count);

			foreach (SaveData data in set)
			{
				Write(data);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void Write(HashSet<SaveData> set, bool tidy)
		{
			if (tidy)
			{
				set.RemoveWhere(data => data.Deleted);
			}

			Write(set.Count);

			foreach (SaveData data in set)
			{
				Write(data);
			}
		}</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Ultima\AnimationEdit.cs

<pre>BitmapData bd = bmp.LockBits(
				new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.ReadOnly, PixelFormat.Format16bppArgb1555);
			var line = (ushort*)bd.Scan0;
			int delta = bd.Stride >> 1;</pre>

Fragment 2 in file Ultima\ASCIIFont.cs

<pre>BitmapData bd = bmp.LockBits(
								new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.ReadOnly, PixelFormat.Format16bppArgb1555);
							var line = (ushort*)bd.Scan0;
							int delta = bd.Stride >> 1;</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>public override bool OnDragLift(Mobile from)
        {
            if (this.Parent is Mobile && from == this.Parent)
            {
                if (this.IsSetItem && this.m_SetEquipped)
                    SetHelper.RemoveSetBonus(from, this.SetID, this);
            }

            return base.OnDragLift(from);
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>public override bool OnDragLift(Mobile from)
        {
            if (this.Parent is Mobile && from == this.Parent)
            {
                if (this.IsSetItem && this.m_SetEquipped)
                    SetHelper.RemoveSetBonus(from, this.SetID, this);
            }

            return base.OnDragLift(from);
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>public override bool OnDragLift(Mobile from)
        {
            if (this.Parent is Mobile && from == this.Parent)
            {
                if (this.IsSetItem && this.m_SetEquipped)
                    SetHelper.RemoveSetBonus(from, this.SetID, this);
            }

            return base.OnDragLift(from);
        }</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Ultima\ASCIIFont.cs

<pre>BitmapData bd = bmp.LockBits(
										new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.WriteOnly, PixelFormat.Format16bppArgb1555);
									var line = (ushort*)bd.Scan0;
									int delta = bd.Stride >> 1;</pre>

Fragment 2 in file Ultima\MultiMap.cs

<pre>BitmapData bd = bmp.LockBits(
						new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.WriteOnly, PixelFormat.Format16bppArgb1555);
					var line = (ushort*)bd.Scan0;
					int delta = bd.Stride >> 1;</pre>

Fragment 3 in file Ultima\UnicodeFont.cs

<pre>BitmapData bd = bmp.LockBits(
				new Rectangle(0, 0, bmp.Width, bmp.Height), ImageLockMode.WriteOnly, PixelFormat.Format16bppArgb1555);
			var line = (ushort*)bd.Scan0;
			int delta = bd.Stride >> 1;</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>if (entry != null)
							{
								int tval = 0;
								tr = info.GetTextEntry(500 + i);
								if (tr != null)
								{
									try { tval = int.Parse(tr.Text); }
									catch { }
								}
								entry.Team = tval;
							}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>if(entry != null)
                        {
                            int tval = 0;
                            tr = info.GetTextEntry( 500+i );
                            if(tr != null)
                            {
                                try{tval = int.Parse(tr.Text); } catch{}
                            }
                            entry.Team = tval;
                        }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>if(entry != null)
                        {
                            int tval = 0;
                            tr = info.GetTextEntry( 500+i );
                            if(tr != null)
                            {
                                try{tval = int.Parse(tr.Text); } catch{}
                            }
                            entry.Team = tval;
                        }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>if(entry != null)
                        {
                            int tval = 0;
                            tr = info.GetTextEntry( 500+i );
                            if(tr != null)
                            {
                                try{tval = int.Parse(tr.Text); } catch{}
                            }
                            entry.Team = tval;
                        }</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>if(entry != null)
                        {
                            int tval = 0;
                            tr = info.GetTextEntry( 500+i );
                            if(tr != null)
                            {
                                try{tval = int.Parse(tr.Text); } catch{}
                            }
                            entry.Team = tval;
                        }</pre>

## Duplicated Code. Size: 103

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ExodusMinion.cs

<pre>public override bool Move(Direction d)
        {
            bool move = base.Move(d);

            if (move && this.m_FieldActive && this.Combatant != null)
                this.FixedParticles(0, 10, 0, 0x2530, EffectLayer.Waist);

            return move;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ExodusOverseer.cs

<pre>public override bool Move(Direction d)
        {
            bool move = base.Move(d);

            if (move && this.m_FieldActive && this.Combatant != null)
                this.FixedParticles(0, 10, 0, 0x2530, EffectLayer.Waist);

            return move;
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusDrone.cs

<pre>public override bool Move(Direction d)
        {
            bool move = base.Move(d);

            if (move && this.m_FieldActive && this.Combatant != null)
                this.FixedParticles(0, 10, 0, 0x2530, EffectLayer.Waist);

            return move;
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusJuggernaut.cs

<pre>public override bool Move(Direction d)
        {
            bool move = base.Move(d);

            if (move && this.m_FieldActive && this.Combatant != null)
                this.FixedParticles(0, 10, 0, 0x2530, EffectLayer.Waist);

            return move;
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusMinionLord.cs

<pre>public override bool Move(Direction d)
        {
            bool move = base.Move(d);

            if (move && this.m_FieldActive && this.Combatant != null)
                this.FixedParticles(0, 10, 0, 0x2530, EffectLayer.Waist);

            return move;
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusSentinel.cs

<pre>public override bool Move(Direction d)
        {
            bool move = base.Move(d);

            if (move && this.m_FieldActive && this.Combatant != null)
                this.FixedParticles(0, 10, 0, 0x2530, EffectLayer.Waist);

            return move;
        }</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\MysticArc.cs

<pre>List<Mobile> targets = new List<Mobile>();

            foreach (Mobile m in attacker.GetMobilesInRange(weapon.MaxRange))
            {
                if (m == defender)
                    continue;

                if (m.Combatant != attacker)
                    continue;

                targets.Add(m);
            }</pre>

Fragment 2 in file Scripts\Spells\Bushido\MomentumStrike.cs

<pre>List<Mobile> targets = new List<Mobile>();

            foreach (Mobile m in attacker.GetMobilesInRange(weapon.MaxRange))
            {
                if (m == defender)
                    continue;

                if (m.Combatant != attacker)
                    continue;

                targets.Add(m);
            }</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\PropsGump.cs

<pre>t == typeof(byte) || t == typeof(sbyte) || t == typeof(short) || t == typeof(ushort) || t == typeof(int) ||
				t == typeof(uint) || t == typeof(long) || t == typeof(ulong)</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlPropsGump.cs

<pre>t == typeof( byte ) || t == typeof( sbyte ) || t == typeof( short ) || t == typeof( ushort ) || t == typeof( int ) || t == typeof( uint ) || t == typeof( long ) || t == typeof( ulong )</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\AddonComponent.cs

<pre>public override void OnLocationChange(Point3D old)
        {
            if (this.m_Addon != null)
                this.m_Addon.Location = new Point3D(this.X - this.m_Offset.X, this.Y - this.m_Offset.Y, this.Z - this.m_Offset.Z);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\AddonContainerComponent.cs

<pre>public override void OnLocationChange(Point3D old)
        {
            if (this.m_Addon != null)
                this.m_Addon.Location = new Point3D(this.X - this.m_Offset.X, this.Y - this.m_Offset.Y, this.Z - this.m_Offset.Z);
        }</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\FlourMillEastAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_Flour = reader.ReadInt();
                        break;
                    }
            }

            this.UpdateStage();
        }</pre>

Fragment 2 in file Scripts\Items\Addons\FlourMillSouthAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_Flour = reader.ReadInt();
                        break;
                    }
            }

            this.UpdateStage();
        }</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\CaptainJohnesBlade.cs

<pre>{
            this.Slayer2 = BaseRunicTool.GetRandomSlayer();
            this.Attributes.AttackChance = 15;
            this.Attributes.DefendChance = 15;
            this.Attributes.WeaponSpeed = 30;
            this.Attributes.WeaponDamage = 60;
            this.ExtendedWeaponAttributes.Bane = 1;

            this.Hue = 2124;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\CaptainJohnesBlade.cs

<pre>{
            this.Slayer2 = BaseRunicTool.GetRandomSlayer();
            this.Attributes.AttackChance = 15;
            this.Attributes.DefendChance = 15;
            this.Attributes.WeaponSpeed = 30;
            this.Attributes.WeaponDamage = 60;
            this.ExtendedWeaponAttributes.Bane = 1;

            this.Hue = 2124;
        }</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\TaxidermyKit.cs

<pre>public override void GetProperties( ObjectPropertyList list )
		{
			base.GetProperties( list );

			if ( m_AnimalWeight >= 20 )
			{
				if ( m_Hunter != null )
					list.Add( 1070857, m_Hunter.Name ); // Caught by ~1_fisherman~

				list.Add( 1070858, m_AnimalWeight.ToString() ); // ~1_weight~ stones
			}
		}</pre>

Fragment 2 in file Scripts\Items\Consumables\TaxidermyKit.cs

<pre>public override void GetProperties( ObjectPropertyList list )
		{
			base.GetProperties( list );

			if ( m_AnimalWeight >= 20 )
			{
				if ( m_Hunter != null )
					list.Add( 1070857, m_Hunter.Name ); // Caught by ~1_fisherman~

				list.Add( 1070858, m_AnimalWeight.ToString() ); // ~1_weight~ stones
			}
		}</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>m_HitPoints = ((this.m_HitPoints * scale) + 99) / 100;
            m_MaxHitPoints = ((this.m_MaxHitPoints * scale) + 99) / 100;

            if (m_MaxHitPoints > 255)
                m_MaxHitPoints = 255;

            if (m_HitPoints > 255)
                m_HitPoints = 255;

            InvalidateProperties();</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>m_HitPoints = ((this.m_HitPoints * scale) + 99) / 100;
            m_MaxHitPoints = ((this.m_MaxHitPoints * scale) + 99) / 100;

            if (m_MaxHitPoints > 255)
                m_MaxHitPoints = 255;

            if (m_HitPoints > 255)
                m_HitPoints = 255;

            InvalidateProperties();</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>public override bool AllowSecureTrade(Mobile from, Mobile to, Mobile newOwner, bool accepted)
        {
            if (!Ethics.Ethic.CheckTrade(from, to, newOwner, this))
                return false;

            return base.AllowSecureTrade(from, to, newOwner, accepted);
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>public override bool AllowSecureTrade(Mobile from, Mobile to, Mobile newOwner, bool accepted)
        {
            if (!Ethics.Ethic.CheckTrade(from, to, newOwner, this))
                return false;

            return base.AllowSecureTrade(from, to, newOwner, accepted);
        }</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>public int SetResistBonus(ResistanceType resist)
        {
            switch (resist)
            {
                case ResistanceType.Physical: return PhysicalResistance;
                case ResistanceType.Fire: return FireResistance;
                case ResistanceType.Cold: return ColdResistance;
                case ResistanceType.Poison: return PoisonResistance;
                case ResistanceType.Energy: return EnergyResistance;
            }

            return 0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>public int SetResistBonus(ResistanceType resist)
        {
            switch (resist)
            {
                case ResistanceType.Physical: return PhysicalResistance;
                case ResistanceType.Fire: return FireResistance;
                case ResistanceType.Cold: return ColdResistance;
                case ResistanceType.Poison: return PoisonResistance;
                case ResistanceType.Energy: return EnergyResistance;
            }

            return 0;
        }</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Spellbooks\Spellbook.cs

<pre>public override bool AllowSecureTrade(Mobile from, Mobile to, Mobile newOwner, bool accepted)
		{
			if (!Ethic.CheckTrade(from, to, newOwner, this))
			{
				return false;
			}

			return base.AllowSecureTrade(from, to, newOwner, accepted);
		}</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>public override bool AllowSecureTrade(Mobile from, Mobile to, Mobile newOwner, bool accepted)
		{
			if (!Ethic.CheckTrade(from, to, newOwner, this))
			{
				return false;
			}

			return base.AllowSecureTrade(from, to, newOwner, accepted);
		}</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\AOS.cs

<pre>this.m_Names = reader.ReadUInt();
                        this.m_Values = new int[reader.ReadEncodedInt()];

                        for (int i = 0; i < this.m_Values.Length; ++i)
                            this.m_Values[i] = reader.ReadEncodedInt();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlAosAttributes.cs

<pre>this.m_Names = reader.ReadUInt();
            this.m_Values = new int[reader.ReadEncodedInt()];

            for (int i = 0; i < this.m_Values.Length; ++i)
                this.m_Values[i] = reader.ReadEncodedInt();</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\AnimalTrainer.cs

<pre>var pet = from.Stabled[i] as BaseCreature;

				if (pet == null || pet.Deleted)
				{
					if (pet != null)
					{
						pet.IsStabled = false;
						pet.StabledBy = null;
					}

					from.Stabled.RemoveAt(i--);
					continue;
				}</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\AnimalTrainer.cs

<pre>var pet = from.Stabled[i] as BaseCreature;

				if (pet == null || pet.Deleted)
				{
					if (pet != null)
					{
						pet.IsStabled = false;
						pet.StabledBy = null;
					}

					from.Stabled.RemoveAt(i--);
					continue;
				}</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\AttendantFortuneTeller.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (from.Alive && this.IsOwner(from))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                base.OnDoubleClick(from);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\AttendantLuckyDealer.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (from.Alive && this.IsOwner(from))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                base.OnDoubleClick(from);
        }</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 18, 1, 0, 1779, -1, "", 1);// 30
			AddComplexComponent( (BaseAddon) this, 2769, 17, 2, 0, 1779, -1, "", 1);// 31</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 2, 17, 0, 1779, -1, "", 1);// 345
			AddComplexComponent( (BaseAddon) this, 2769, 1, 18, 0, 1779, -1, "", 1);// 347</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2776, 3, 25, 0, 1779, -1, "", 1);// 309
			AddComplexComponent( (BaseAddon) this, 2769, 2, 24, 0, 1779, -1, "", 1);// 310</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 2, 25, 0, 1779, -1, "", 1);// 369
			AddComplexComponent( (BaseAddon) this, 2776, 3, 24, 0, 1779, -1, "", 1);// 370</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2776, 3, 20, 0, 1779, -1, "", 1);// 349
			AddComplexComponent( (BaseAddon) this, 2769, 1, 23, 0, 1779, -1, "", 1);// 360</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 1, 20, 0, 1779, -1, "", 1);// 390
			AddComplexComponent( (BaseAddon) this, 2776, 3, 23, 0, 1779, -1, "", 1);// 400</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 13, 2, 0, 1779, -1, "", 1);// 422
			AddComplexComponent( (BaseAddon) this, 2769, 13, 1, 0, 1779, -1, "", 1);// 423</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 2, 13, 0, 1779, -1, "", 1);// 546
			AddComplexComponent( (BaseAddon) this, 2769, 1, 13, 0, 1779, -1, "", 1);// 554</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 8, 1, 0, 1779, -1, "", 1);// 433
			AddComplexComponent( (BaseAddon) this, 2769, 7, 2, 0, 1779, -1, "", 1);// 434</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>AddComplexComponent( (BaseAddon) this, 2769, 2, 8, 0, 1779, -1, "", 1);// 579
			AddComplexComponent( (BaseAddon) this, 2769, 1, 7, 0, 1779, -1, "", 1);// 580</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Paragon.cs

<pre>bc.DamageMin -= DamageBuff;
            bc.DamageMax -= DamageBuff;

            if (bc.Fame > 0)
                bc.Fame = (int)(bc.Fame / FameBuff);
            if (bc.Karma != 0)
                bc.Karma = (int)(bc.Karma / KarmaBuff);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlParagon\XmlParagon.cs

<pre>bc.DamageMin -= DamageBuff;
            bc.DamageMax -= DamageBuff;

            if (bc.Fame > 0)
                bc.Fame = (int)(bc.Fame / FameBuff);
            if (bc.Karma != 0)
                bc.Karma = (int)(bc.Karma / KarmaBuff);</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\SimpleSwitches.cs

<pre>writer.Write(this.m_TargetItem0);
			writer.Write(this.m_TargetProperty0);
			writer.Write(this.m_TargetItem1);
			writer.Write(this.m_TargetProperty1);
			writer.Write(this.m_TargetItem2);
			writer.Write(this.m_TargetProperty2);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>writer.Write( this.m_TargetItem0 );
			writer.Write( this.m_TargetProperty0 );
			writer.Write( this.m_TargetItem1 );
			writer.Write( this.m_TargetProperty1 );
			writer.Write( this.m_TargetItem2 );
			writer.Write( this.m_TargetProperty2 );</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestGumps.cs

<pre>int.TryParse(args[1].Trim(), out gx);
								int.TryParse(args[2].Trim(), out gy);
								int.TryParse(args[3].Trim(), out gwidth);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestGumps.cs

<pre>int.TryParse(args[1].Trim(), out gx);
								int.TryParse(args[2].Trim(), out gy);
								int.TryParse(args[3].Trim(), out gwidth);</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>public static double GetDistance(Point3D p1, Point3D p2)
		{
			int xDelta = p1.X - p2.X;
			int yDelta = p1.Y - p2.Y;

			return Math.Sqrt((xDelta * xDelta) + (yDelta * yDelta));
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\Attachments\XmlSiege.cs

<pre>public static double GetDistance(Point3D p1, Point3D p2)
		{
			int xDelta = p1.X - p2.X;
			int yDelta = p1.Y - p2.Y;

			return Math.Sqrt((xDelta * xDelta) + (yDelta * yDelta));
		}</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketHandlers.cs

<pre>int unk3 = pvSrc.ReadByte();
			string name = pvSrc.ReadString(30);

			pvSrc.Seek(2, SeekOrigin.Current);
			int flags = pvSrc.ReadInt32();
			pvSrc.Seek(8, SeekOrigin.Current);</pre>

Fragment 2 in file Server\Network\PacketHandlers.cs

<pre>int unk3 = pvSrc.ReadByte();
			string name = pvSrc.ReadString(30);

			pvSrc.Seek(2, SeekOrigin.Current);
			int flags = pvSrc.ReadInt32();
			pvSrc.Seek(8, SeekOrigin.Current);</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Chyloth.cs

<pre>private static readonly int[] m_Offsets = new int[]
        {
            -1, -1,
            -1, 0,
            -1, 1,
            0, -1,
            0, 1,
            1, -1,
            1, 0,
            1, 1
        };</pre>

Fragment 2 in file Scripts\Skills\Mining.cs

<pre>private static readonly int[] m_Offsets = new int[]
        {
            -1, -1,
            -1, 0,
            -1, 1,
            0, -1,
            0, 1,
            1, -1,
            1, 0,
            1, 1
        };</pre>

Fragment 3 in file Scripts\Spells\Base\SpellHelper.cs

<pre>private static readonly int[] m_Offsets = new int[]
        {
            -1, -1,
            -1, 0,
            -1, 1,
            0, -1,
            0, 1,
            1, -1,
            1, 0,
            1, 1
        };</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetGump.cs

<pre>if ( shouldSet )
			{
				try
				{
					CommandLogging.LogChangeProperty( m_Mobile, m_Object, m_Property.Name, toSet==null?"(null)":toSet.ToString() );
					m_Property.SetValue( m_Object, toSet, null );
				}
				catch
				{
					m_Mobile.SendMessage( "An exception was caught. The property may not have changed." );
				}
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetObjectGump.cs

<pre>if ( shouldSet )
				{
					try
					{
						CommandLogging.LogChangeProperty( m_Mobile, m_Object, m_Property.Name, toSet==null?"(null)":toSet.ToString() );
						m_Property.SetValue( m_Object, toSet, null );
					}
					catch
					{
						m_Mobile.SendMessage( "An exception was caught. The property may not have changed." );
					}
				}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetObjectGump.cs

<pre>if ( shouldSet )
			{
				try
				{
					CommandLogging.LogChangeProperty( m_Mobile, m_Object, m_Property.Name, toSet==null?"(null)":toSet.ToString() );
					m_Property.SetValue( m_Object, toSet, null );
				}
				catch
				{
					m_Mobile.SendMessage( "An exception was caught. The property may not have changed." );
				}
			}</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\QuestRewardGump.cs

<pre>case 12:
					// page up
					int nitems = 0;
					if(Rewards != null)
						nitems = Rewards.Count;

					int page = viewpage+1;
					if(page > (int)(nitems/maxItemsPerPage))
					{
						page = (int)(nitems/maxItemsPerPage);
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlMobFactions\MobFactionsRewardGump.cs

<pre>case 12:
                    // page up
                    int nitems = 0;
                    if(Rewards != null)
                        nitems = Rewards.Count;

                    int page = viewpage+1;
                    if(page > (int)(nitems/maxItemsPerPage))
                    {
                        page = (int)(nitems/maxItemsPerPage);
                    }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\PointsRewardGump.cs

<pre>case 12:
                    // page up
                    int nitems = 0;
                    if(Rewards != null)
                        nitems = Rewards.Count;

                    int page = viewpage+1;
                    if(page > (int)(nitems/maxItemsPerPage))
                    {
                        page = (int)(nitems/maxItemsPerPage);
                    }</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>string SpawnerPrefix = string.Empty;

					// Check if there is an argument provided (load criteria)
					if (e.Arguments.Length > 1)
						SpawnerPrefix = e.Arguments[1];

					string filename = LocateFile(e.Arguments[0].ToString());
					int processedmaps;
					int processedspawners;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>string filename = LocateFile(e.Arguments[0].ToString());

					// Spawner load criteria (if any)
					string SpawnerPrefix = string.Empty;

					// Check if there is an argument provided (load criteria)
					if (e.Arguments.Length > 1)
						SpawnerPrefix = e.Arguments[1];
					int processedmaps;
					int processedspawners;</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>string filename = LocateFile(e.Arguments[0].ToString());

					// Spawner load criteria (if any)
					string SpawnerPrefix = string.Empty;

					// Check if there is an argument provided (load criteria)
					if (e.Arguments.Length > 1)
						SpawnerPrefix = e.Arguments[1];
					int processedmaps;
					int processedspawners;</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>if(gauntlet == null || from == null) return;

                int yinc = 25;

                ArrayList Teams = gauntlet.GetTeams();

                // gump height determined by number of teams
                int height  = Teams.Count*yinc + 80;

                AddBackground( 0, 0, 260, height, 0xDAC );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>if(gauntlet == null || from == null) return;

                int yinc = 25;

                ArrayList Teams = gauntlet.GetTeams();

                // gump height determined by number of teams
                int height  = Teams.Count*yinc + 80;

                AddBackground( 0, 0, 260, height, 0xDAC );</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>if(gauntlet == null || from == null) return;

                int yinc = 25;

                ArrayList Teams = gauntlet.GetTeams();

                // gump height determined by number of teams
                int height  = Teams.Count*yinc + 80;

                AddBackground( 0, 0, 260, height, 0xDAC );</pre>

## Duplicated Code. Size: 102

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>if (entry != null)
							{

								if (entry.Participant == state.Mobile)
								{
									entry.PageBeingViewed++;

									if (entry.PageBeingViewed > (int)(nplayers / PlayersPerPage)) entry.PageBeingViewed = (int)(nplayers / PlayersPerPage);

									page = entry.PageBeingViewed;
									//break;

								}
							}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>if(entry != null)
                        {

                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed++;

                                if(entry.PageBeingViewed > (int)(nplayers/PlayersPerPage)) entry.PageBeingViewed=(int)(nplayers/PlayersPerPage);

                                page = entry.PageBeingViewed;
                                //break;

                            }
                        }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>if(entry != null)
                        {

                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed++;

                                if(entry.PageBeingViewed > (int)(nplayers/PlayersPerPage)) entry.PageBeingViewed=(int)(nplayers/PlayersPerPage);

                                page = entry.PageBeingViewed;
                                //break;

                            }
                        }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>if(entry != null)
                        {

                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed++;

                                if(entry.PageBeingViewed > (int)(nplayers/PlayersPerPage)) entry.PageBeingViewed=(int)(nplayers/PlayersPerPage);

                                page = entry.PageBeingViewed;
                                //break;

                            }
                        }</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>if(entry != null)
                        {

                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed++;

                                if(entry.PageBeingViewed > (int)(nplayers/PlayersPerPage)) entry.PageBeingViewed=(int)(nplayers/PlayersPerPage);

                                page = entry.PageBeingViewed;
                                //break;

                            }
                        }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\HouseRaffleManagementGump.cs

<pre>bool xIsNull = (x == null || x.From == null);
                bool yIsNull = (y == null || y.From == null);

                if (xIsNull && yIsNull)
                    return 0;
                else if (xIsNull)
                    return -1;
                else if (yIsNull)
                    return 1;</pre>

Fragment 2 in file Scripts\Gumps\HouseRaffleManagementGump.cs

<pre>bool xIsNull = (x == null || x.From == null);
                bool yIsNull = (y == null || y.From == null);

                if (xIsNull && yIsNull)
                    return 0;
                else if (xIsNull)
                    return -1;
                else if (yIsNull)
                    return 1;</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetGump.cs

<pre>x += EntryWidth + OffsetSize;

                if (SetGumpID != 0)
                    this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);

                this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 2, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Gumps\Properties\SetObjectGump.cs

<pre>x += EntryWidth + OffsetSize;

            if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);

            this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 2, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetGump.cs

<pre>x += EntryWidth + OffsetSize;

                if (SetGumpID != 0)
                    this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);

                this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 3, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Gumps\Properties\SetObjectGump.cs

<pre>x += EntryWidth + OffsetSize;

            if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);

            this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 3, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetGump.cs

<pre>x += EntryWidth + OffsetSize;

                if (SetGumpID != 0)
                    this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);

                this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 4, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Gumps\Properties\SetObjectGump.cs

<pre>x += EntryWidth + OffsetSize;

            if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);

            this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 4, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\HolidayPottedPlant.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
            {
                from.SendLocalizedMessage(1042038); // You must have the object in your backpack to use it.
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\SnowStatue.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
            {
                from.SendLocalizedMessage(1042038); // You must have the object in your backpack to use it.
            }
        }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\Container.cs

<pre>item.Location = new Point3D(p.X, p.Y, 0);

            this.AddItem(item);

            from.SendSound(this.GetDroppedSound(item), this.GetWorldLocation());

            ItemFlags.SetTaken(item, true);</pre>

Fragment 2 in file Scripts\Services\CleanUpBritannia\Items\Steward.cs

<pre>item.Location = new Point3D(p.X, p.Y, 0);
                this.AddItem(item);

                from.SendSound(this.GetDroppedSound(item), this.GetWorldLocation());

                ItemFlags.SetTaken(item, true);</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Corpses\DecayedCorpse.cs

<pre>public void BeginDecay(TimeSpan delay)
        {
            if (this.m_DecayTimer != null)
                this.m_DecayTimer.Stop();

            this.m_DecayTime = DateTime.UtcNow + delay;

            this.m_DecayTimer = new InternalTimer(this, delay);
            this.m_DecayTimer.Start();
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>private void BeginDecay(TimeSpan delay)
        {
            if (this.m_DecayTimer != null)
                this.m_DecayTimer.Stop();

            this.m_DecayTime = DateTime.UtcNow + delay;

            this.m_DecayTimer = new InternalTimer(this, delay);
            this.m_DecayTimer.Start();
        }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseKnife.cs

<pre>if (!Core.AOS && defender is Mobile && this.Poison != null && this.PoisonCharges > 0)
            {
                --this.PoisonCharges;

                if (Utility.RandomDouble() >= 0.5) // 50% chance to poison
                    ((Mobile)defender).ApplyPoison(attacker, this.Poison);
            }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseSpear.cs

<pre>if (!Core.AOS && defender is Mobile && this.Poison != null && this.PoisonCharges > 0)
            {
                --this.PoisonCharges;

                if (Utility.RandomDouble() >= 0.5) // 50% chance to poison
                    ((Mobile)defender).ApplyPoison(attacker, this.Poison);
            }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BronzeElemental.cs

<pre>this.BaseSoundID = 268;

            this.SetStr(226, 255);
            this.SetDex(126, 145);
            this.SetInt(71, 92);

            this.SetHits(136, 153);

            this.SetDamage(9, 16);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\VeriteElemental.cs

<pre>this.BaseSoundID = 268;

            this.SetStr(226, 255);
            this.SetDex(126, 145);
            this.SetInt(71, 92);

            this.SetHits(136, 153);

            this.SetDamage(9, 16);</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GargoyleDestroyer.cs

<pre>this.BaseSoundID = 0x174;

            this.SetStr(760, 850);
            this.SetDex(102, 150);
            this.SetInt(152, 200);

            this.SetHits(482, 485);

            this.SetDamage(7, 14);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GargoyleEnforcer.cs

<pre>this.BaseSoundID = 0x174;

            this.SetStr(760, 850);
            this.SetDex(102, 150);
            this.SetInt(152, 200);

            this.SetHits(482, 485);

            this.SetDamage(7, 14);</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\BaseEscortable.cs

<pre>{
                int minutes = (int)Math.Ceiling(((((PlayerMobile)m).LastEscortTime + m_EscortDelay) - DateTime.UtcNow).TotalMinutes);

                this.Say("You must rest {0} minute{1} before we set out on this journey.", minutes, minutes == 1 ? "" : "s");
                return false;
            }</pre>

Fragment 2 in file Scripts\Services\MondainsLegacyQuests\BaseEscort.cs

<pre>{
                int minutes = (int)Math.Ceiling(((((PlayerMobile)m).LastEscortTime + m_EscortDelay) - DateTime.UtcNow).TotalMinutes);

                this.Say("You must rest {0} minute{1} before we set out on this journey.", minutes, minutes == 1 ? "" : "s");
                return false;
            }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\Books\BOBGump.cs

<pre>{
                    ((BOBLargeEntry)this.m_Object).Price = price;

                    from.SendLocalizedMessage(1062384); // Deed price set.

                    if (from is PlayerMobile)
                        from.SendGump(new BOBGump((PlayerMobile)from, this.m_Book, this.m_Page, this.m_List));
                }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\Books\BOBGump.cs

<pre>{
                    ((BOBSmallEntry)this.m_Object).Price = price;

                    from.SendLocalizedMessage(1062384); // Deed price set.

                    if (from is PlayerMobile)
                        from.SendGump(new BOBGump((PlayerMobile)from, this.m_Book, this.m_Page, this.m_List));
                }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>public void BeginRestart(TimeSpan ts)
        {
            if (this.m_RestartTimer != null)
                this.m_RestartTimer.Stop();

            this.m_RestartTime = DateTime.UtcNow + ts;

            this.m_RestartTimer = new RestartTimer(this, ts);
            this.m_RestartTimer.Start();
        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\QuestItems\StorageLocker.cs

<pre>public void BeginRestart(TimeSpan ts)
        {
            if (this.m_RestartTimer != null)
                this.m_RestartTimer.Stop();

            this.m_RestartTime = DateTime.UtcNow + ts;

            this.m_RestartTimer = new RestartTimer(this, ts);
            this.m_RestartTimer.Start();
        }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>{
                    pageIndex = 0;
                    page++;

                    AddHtml(535, 346, 100, 16, "<basefont color=#FFFFFF>NEXT", false, false);
                    AddButton(574, 348, 5601, 5605, 0, GumpButtonType.Page, page);

                    AddPage(page);
                }</pre>

Fragment 2 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>{
                    pageIndex = 0;
                    page++;

                    AddHtml(535, 346, 100, 16, "<basefont color=#FFFFFF>NEXT", false, false);
                    AddButton(574, 348, 5601, 5605, 0, GumpButtonType.Page, page);

                    AddPage(page);
                }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Items\Teleporter\Whirlpool.cs

<pre>i => (i is CanvassRobe || i is BootsOfBallast || i is NictitatingLens || i is AquaPendant || i is GargishNictitatingLens) && (i.Parent is Mobile && ((Mobile)i.Parent).FindItemOnLayer(i.Layer) == i)</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Regions.cs

<pre>i => (i is CanvassRobe || i is BootsOfBallast || i is NictitatingLens || i is AquaPendant || i is GargishNictitatingLens) && (i.Parent is Mobile && ((Mobile)i.Parent).FindItemOnLayer(i.Layer) == i)</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Harvest\HarvestSystem.cs

<pre>if (toHarvest is LandTarget)
            {
                LandTarget obj = (LandTarget)toHarvest;

                tileID = obj.TileID;
                map = from.Map;
                loc = obj.Location;
            }
            else
            {
                tileID = 0;
                map = null;
                loc = Point3D.Zero;
                return false;
            }</pre>

Fragment 2 in file Scripts\Skills\Fishing.cs

<pre>if (toHarvest is LandTarget)
            {
                LandTarget obj = (LandTarget)toHarvest;

                tileID = obj.TileID;
                map = from.Map;
                loc = obj.Location;
            }
            else
            {
                tileID = 0;
                map = null;
                loc = Point3D.Zero;
                return false;
            }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainQuestGump.cs

<pre>if (slay.Timed)
                                {
                                    this.AddHtmlLocalized(103, offset, 120, 16, 1062379, 0x15F90, false, false); // Est. time remaining:
                                    this.AddLabel(223, offset, 0x481, this.FormatSeconds(slay.Seconds)); // %est. time remaining%

                                    offset += 16;
                                }</pre>

Fragment 2 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainQuestGump.cs

<pre>if (slay.Timed)
                            {
                                this.AddHtmlLocalized(103, offset, 120, 16, 1062379, 0x15F90, false, false); // Est. time remaining:
                                this.AddLabel(223, offset, 0x481, this.FormatSeconds(slay.Seconds)); // %est. time remaining%

                                offset += 16;
                            }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Party\Party.cs

<pre>for (int i = 0; i < this.m_Members.Count; ++i)
                {
                    this[i].Mobile.Send(new PartyEmptyList(this[i].Mobile));
                    this[i].Mobile.Party = null;
                }</pre>

Fragment 2 in file Scripts\Services\Party\Party.cs

<pre>for (int i = 0; i < this.m_Members.Count; ++i)
            {
                this[i].Mobile.Send(new PartyEmptyList(this[i].Mobile));
                this[i].Mobile.Party = null;
            }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Pathing\PathFollower.cs

<pre>{
                d = this.m_From.GetDirectionTo(goal);

                if (run)
                    d |= Direction.Running;

                this.m_From.SetDirection(d);
                this.Move(d);

                return this.Check(this.m_From.Location, goal, range);
            }</pre>

Fragment 2 in file Scripts\Services\Pathing\PathFollower.cs

<pre>{
                    d = this.m_From.GetDirectionTo(goal);

                    if (run)
                        d |= Direction.Running;

                    this.m_From.SetDirection(d);
                    this.Move(d);

                    return this.Check(this.m_From.Location, goal, range);
                }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\CauldronOfTransmutation.cs

<pre>int left = 0;
                if (DateTime.UtcNow < ((CauldronOfTransmutation)Addon).Expires)
                    left = (int)(((CauldronOfTransmutation)Addon).Expires - DateTime.UtcNow).TotalSeconds;

                list.Add(1072517, left.ToString()); // Lifespan: ~1_val~ seconds</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\TemporaryForge.cs

<pre>int left = 0;
                if (DateTime.UtcNow < ((TemporaryForge)Addon).Expires)
                    left = (int)(((TemporaryForge)Addon).Expires - DateTime.UtcNow).TotalSeconds;

                list.Add(1072517, left.ToString()); // Lifespan: ~1_val~ seconds</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>if (attrs != null && value > 0 && attrs[(AosArmorAttribute)attribute] == 0)
                {
                    attrs[(AosArmorAttribute)attribute] = value;
                    budget -= Imbuing.GetIntensityForAttribute(item, (AosArmorAttribute)attribute, -1, value);
                }</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>if (attrs != null && value > 0 && attrs[(SAAbsorptionAttribute)attribute] == 0)
                {
                    attrs[(SAAbsorptionAttribute)attribute] = value;
                    budget -= Imbuing.GetIntensityForAttribute(item, (SAAbsorptionAttribute)attribute, -1, value);
                }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Underworld\ExperimentalRoom\ExperimentalGem.cs

<pre>private static Rectangle2D[] m_RoomRecs = new Rectangle2D[]
        {
            new Rectangle2D(977, 1104, 15, 10), //RoomOne
            new Rectangle2D(977, 1092, 15, 9), //RoomTwo
            new Rectangle2D(977, 1074, 15, 10), //RoomThree
        };</pre>

Fragment 2 in file Scripts\Services\Underworld\ExperimentalRoom\Region.cs

<pre>private static Rectangle2D[] m_RoomRecs = new Rectangle2D[]
        {
            new Rectangle2D(977, 1104, 15, 10), //RoomOne
            new Rectangle2D(977, 1092, 15, 9), //RoomTwo
            new Rectangle2D(977, 1074, 15, 10), //RoomThree
        };</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlAdd.cs

<pre>defs.SelectionList != null && i < defs.SelectionList.Length && defs.SelectionList[i] &&
						defs.NameList != null && i < defs.NameList.Length && defs.NameList[i] != null && defs.NameList[i].Length > 0</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlAdd.cs

<pre>defs.SelectionList != null && i < defs.SelectionList.Length && defs.SelectionList[i] &&
						defs.NameList != null && i < defs.NameList.Length && defs.NameList[i] != null && defs.NameList[i].Length > 0</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlMobFactions\MobFactionRegionStone.cs

<pre>public static Region FindRegion(string name)
		{
			if (Region.Regions == null) return null;

			foreach (Region region in Region.Regions)
			{
				if (string.Compare(region.Name, name, true) == 0)
				{
					return region;
				}
			}

			return null;
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeRegionStone.cs

<pre>public static Region FindRegion(string name)
		{
            if (Region.Regions == null)	return null;

        	foreach (Region region in Region.Regions)
        	{
        		if (string.Compare(region.Name, name, true) == 0)
        		{
        			return region;
        		}
        	}

        	return null;
        }</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>int x = loc.m_X & 0x7FFF;
            int y = loc.m_Y & 0x3FFF;
            stream.Write((short)x);
            stream.Write((short)y);
            stream.Write((sbyte)loc.m_Z);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>int x = loc.m_X & 0x7FFF;
            int y = loc.m_Y & 0x3FFF;
            stream.Write((short)x);
            stream.Write((short)y);
            stream.Write((sbyte)loc.m_Z);</pre>

## Duplicated Code. Size: 101

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\GuildAbbrvPrompt.cs

<pre>public override void OnCancel(Mobile from)
        {
            if (GuildGump.BadLeader(this.m_Mobile, this.m_Guild))
                return;

            GuildGump.EnsureClosed(this.m_Mobile);
            this.m_Mobile.SendGump(new GuildmasterGump(this.m_Mobile, this.m_Guild));
        }</pre>

Fragment 2 in file Scripts\Gumps\Guilds\GuildCharterPrompt.cs

<pre>public override void OnCancel(Mobile from)
        {
            if (GuildGump.BadLeader(this.m_Mobile, this.m_Guild))
                return;

            GuildGump.EnsureClosed(this.m_Mobile);
            this.m_Mobile.SendGump(new GuildmasterGump(this.m_Mobile, this.m_Guild));
        }</pre>

Fragment 3 in file Scripts\Gumps\Guilds\GuildNamePrompt.cs

<pre>public override void OnCancel(Mobile from)
        {
            if (GuildGump.BadLeader(this.m_Mobile, this.m_Guild))
                return;

            GuildGump.EnsureClosed(this.m_Mobile);
            this.m_Mobile.SendGump(new GuildmasterGump(this.m_Mobile, this.m_Guild));
        }</pre>

Fragment 4 in file Scripts\Gumps\Guilds\GuildWebsitePrompt.cs

<pre>public override void OnCancel(Mobile from)
        {
            if (GuildGump.BadLeader(this.m_Mobile, this.m_Guild))
                return;

            GuildGump.EnsureClosed(this.m_Mobile);
            this.m_Mobile.SendGump(new GuildmasterGump(this.m_Mobile, this.m_Guild));
        }</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>if (this.m_Vendor is PlayerVendor && !((PlayerVendor)this.m_Vendor).CanInteractWith(this.m_Mob, true))
                    return;

                if (this.m_Vendor is PlayerBarkeeper && !((PlayerBarkeeper)this.m_Vendor).IsOwner(this.m_Mob))
                    return;</pre>

Fragment 2 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>if (this.m_Vendor is PlayerVendor && !((PlayerVendor)this.m_Vendor).CanInteractWith(this.m_Mob, true))
                    return;

                if (this.m_Vendor is PlayerBarkeeper && !((PlayerBarkeeper)this.m_Vendor).IsOwner(this.m_Mob))
                    return;</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Banner.cs

<pre>this.AddButton(50, 35, 0x868, 0x869, (int)Buttons.East, GumpButtonType.Reply, 0);
                    this.AddButton(145, 35, 0x868, 0x869, (int)Buttons.South, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Items\Addons\HangingSkeleton.cs

<pre>this.AddButton(50, 35, 0x868, 0x869, (int)Buttons.East, GumpButtonType.Reply, 0);
                    this.AddButton(145, 35, 0x868, 0x869, (int)Buttons.South, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\FountainOfFortune.cs

<pre>public static void StartTimer()
        {
            if (m_Timer != null && m_Timer.Running)
                return;

            m_Timer = Timer.DelayCall(TimeSpan.FromMinutes(1), TimeSpan.FromMinutes(1), new TimerCallback(DefragTables));
            m_Timer.Start();
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Decorative\TenthAnniversarySculpture.cs

<pre>public static void StartTimer()
        {
            if (m_Timer != null && m_Timer.Running)
                return;

            m_Timer = Timer.DelayCall(TimeSpan.FromMinutes(1), TimeSpan.FromMinutes(1), new TimerCallback(DefragTables));
            m_Timer.Start();
        }</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\GiantWebs.cs

<pre>for (int i = 0; i < count; ++i)
                this.AddComponent(new AddonComponent(itemID++), leftToRight ? i : count - 1 - i, -(leftToRight ? i : count - 1 - i), 0);</pre>

Fragment 2 in file Scripts\Items\Addons\GiantWebs.cs

<pre>for (int i = 0; i < count; ++i)
                this.AddComponent(new AddonComponent(itemID++), leftToRight ? i : count - 1 - i, -(leftToRight ? i : count - 1 - i), 0);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Wreath.cs

<pre>bool northWall = BaseAddon.IsWall(loc.X, loc.Y - 1, loc.Z, from.Map);
                bool westWall = BaseAddon.IsWall(loc.X - 1, loc.Y, loc.Z, from.Map);</pre>

Fragment 2 in file Scripts\Items\Decorative\Mistletoe.cs

<pre>bool northWall = BaseAddon.IsWall(loc.X, loc.Y - 1, loc.Z, from.Map);
                bool westWall = BaseAddon.IsWall(loc.X - 1, loc.Y, loc.Z, from.Map);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Corpses\Packets.cs

<pre>var items = beheld.EquipItems;
			int count = items.Count;

			if (beheld.Hair != null && beheld.Hair.ItemID > 0)
			{
				count++;
			}
			if (beheld.FacialHair != null && beheld.FacialHair.ItemID > 0)
			{
				count++;
			}</pre>

Fragment 2 in file Scripts\Items\Decorative\Corpses\Packets.cs

<pre>var items = beheld.EquipItems;
			int count = items.Count;

			if (beheld.Hair != null && beheld.Hair.ItemID > 0)
			{
				count++;
			}
			if (beheld.FacialHair != null && beheld.FacialHair.ItemID > 0)
			{
				count++;
			}</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Quest\PrismaticAmber.cs

<pre>public override bool DropToItem(Mobile from, Item target, Point3D p)
        {
            bool ret = base.DropToItem(from, target, p);

            if (ret && this.Parent != from.Backpack)
                this.DestroyItem(from);

            return ret;
        }</pre>

Fragment 2 in file Scripts\Items\Quest\PrismOfLightAdmissionTicket.cs

<pre>public override bool DropToItem(Mobile from, Item target, Point3D p)
        {
            bool ret = base.DropToItem(from, target, p);

            if (ret && this.Parent != from.Backpack)
                this.DestroyItem(from);

            return ret;
        }</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Harrower\Harrower.cs

<pre>this.SetResistance(ResistanceType.Fire, 60, 80);
            this.SetResistance(ResistanceType.Cold, 60, 80);
            this.SetResistance(ResistanceType.Poison, 60, 80);
            this.SetResistance(ResistanceType.Energy, 60, 80);</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\ShimmeringEffusion.cs

<pre>this.SetResistance(ResistanceType.Fire, 60, 80);
            this.SetResistance(ResistanceType.Cold, 60, 80);
            this.SetResistance(ResistanceType.Poison, 60, 80);
            this.SetResistance(ResistanceType.Energy, 60, 80);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Neira.cs

<pre>private class VirtualMount : IMount
        {
            private readonly VirtualMountItem m_Item;
            public VirtualMount(VirtualMountItem item)
            {
                this.m_Item = item;
            }

            public Mobile Rider
            {
                get
                {
                    return this.m_Item.Rider;
                }
                set
                {
                }
            }
            public virtual void OnRiderDamaged(int amount, Mobile from, bool willKill)
            {
            }
        }</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\BaseFactionGuard.cs

<pre>public class VirtualMount : IMount
    {
        private readonly VirtualMountItem m_Item;
        public VirtualMount(VirtualMountItem item)
        {
            this.m_Item = item;
        }

        public Mobile Rider
        {
            get
            {
                return this.m_Item.Rider;
            }
            set
            {
            }
        }
        public virtual void OnRiderDamaged(int amount, Mobile from, bool willKill)
        {
        }
    }</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\SlasherOfVeils.cs

<pre>this.SetResistance(ResistanceType.Fire, 70, 80);
            this.SetResistance(ResistanceType.Cold, 70, 80);
            this.SetResistance(ResistanceType.Poison, 70, 80);
            this.SetResistance(ResistanceType.Energy, 70, 80);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\Shadowlord.cs

<pre>this.SetResistance(ResistanceType.Fire, 70, 80);
            this.SetResistance(ResistanceType.Cold, 70, 80);
            this.SetResistance(ResistanceType.Poison, 70, 80);
            this.SetResistance(ResistanceType.Energy, 70, 80);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\TavaraSewel.cs

<pre>this.SetResistance(ResistanceType.Fire, 25, 30);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 25, 35);
            this.SetResistance(ResistanceType.Energy, 25, 35);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\KhaldunSummoner.cs

<pre>this.SetResistance(ResistanceType.Fire, 25, 30);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 25, 35);
            this.SetResistance(ResistanceType.Energy, 25, 35);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\WyvernRenowned.cs

<pre>this.SetResistance(ResistanceType.Fire, 80, 90);
            this.SetResistance(ResistanceType.Cold, 70, 80);
            this.SetResistance(ResistanceType.Poison, 60, 70);
            this.SetResistance(ResistanceType.Energy, 60, 70);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\AncientWyrm.cs

<pre>this.SetResistance(ResistanceType.Fire, 80, 90);
            this.SetResistance(ResistanceType.Cold, 70, 80);
            this.SetResistance(ResistanceType.Poison, 60, 70);
            this.SetResistance(ResistanceType.Energy, 60, 70);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BakeKitsune.cs

<pre>this.SetResistance(ResistanceType.Physical, 40, 60);
            this.SetResistance(ResistanceType.Fire, 70, 90);
            this.SetResistance(ResistanceType.Cold, 40, 60);
            this.SetResistance(ResistanceType.Poison, 40, 60);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BakeKitsune.cs

<pre>this.SetResistance(ResistanceType.Physical, 40, 60);
                this.SetResistance(ResistanceType.Fire, 70, 90);
                this.SetResistance(ResistanceType.Cold, 40, 60);
                this.SetResistance(ResistanceType.Poison, 40, 60);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BloodElemental.cs

<pre>this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 50, 60);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Drake.cs

<pre>this.SetResistance(ResistanceType.Fire, 50, 60);
            this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BronzeElemental.cs

<pre>this.SetResistance(ResistanceType.Energy, 20, 30);

            this.SetSkill(SkillName.MagicResist, 50.1, 95.0);
            this.SetSkill(SkillName.Tactics, 60.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 100.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DullCopperElemental.cs

<pre>this.SetResistance(ResistanceType.Energy, 20, 30);

            this.SetSkill(SkillName.MagicResist, 50.1, 95.0);
            this.SetSkill(SkillName.Tactics, 60.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 100.0);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ChaosDaemon.cs

<pre>this.SetResistance(ResistanceType.Fire, 60, 70);
            this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 20, 30);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Moloch.cs

<pre>this.SetResistance(ResistanceType.Fire, 60, 70);
            this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 20, 30);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Cyclops.cs

<pre>this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 25, 35);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Titan.cs

<pre>this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 25, 35);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Eagle.cs

<pre>this.SetResistance(ResistanceType.Fire, 10, 15);
            this.SetResistance(ResistanceType.Cold, 20, 25);
            this.SetResistance(ResistanceType.Poison, 5, 10);
            this.SetResistance(ResistanceType.Energy, 5, 10);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\OrcCaptain.cs

<pre>this.SetResistance(ResistanceType.Fire, 10, 20);
            this.SetResistance(ResistanceType.Cold, 15, 25);
            this.SetResistance(ResistanceType.Poison, 5, 10);
            this.SetResistance(ResistanceType.Energy, 5, 10);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\EffetePutridGargoyle.cs

<pre>this.SetResistance(ResistanceType.Physical, 30, 35);
            this.SetResistance(ResistanceType.Fire, 25, 35);
            this.SetResistance(ResistanceType.Cold, 5, 10);
            this.SetResistance(ResistanceType.Poison, 15, 25);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Gargoyle.cs

<pre>this.SetResistance(ResistanceType.Physical, 30, 35);
            this.SetResistance(ResistanceType.Fire, 25, 35);
            this.SetResistance(ResistanceType.Cold, 5, 10);
            this.SetResistance(ResistanceType.Poison, 15, 25);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Ettin.cs

<pre>this.SetResistance(ResistanceType.Fire, 15, 25);
            this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 15, 25);
            this.SetResistance(ResistanceType.Energy, 15, 25);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ExodusMinion.cs

<pre>this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 15, 25);
            this.SetResistance(ResistanceType.Poison, 15, 25);
            this.SetResistance(ResistanceType.Energy, 15, 25);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\FanDancer.cs

<pre>this.SetResistance(ResistanceType.Physical, 40, 60);
            this.SetResistance(ResistanceType.Fire, 50, 70);
            this.SetResistance(ResistanceType.Cold, 50, 70);
            this.SetResistance(ResistanceType.Poison, 50, 70);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\TsukiWolf.cs

<pre>this.SetResistance(ResistanceType.Physical, 40, 60);
            this.SetResistance(ResistanceType.Fire, 50, 70);
            this.SetResistance(ResistanceType.Cold, 50, 70);
            this.SetResistance(ResistanceType.Poison, 50, 70);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ForgottenServant.cs

<pre>this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Nightmare.cs

<pre>this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 20, 30);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Hiryu.cs

<pre>this.SetSkill(SkillName.Anatomy, 75.1, 80.0);
            this.SetSkill(SkillName.MagicResist, 85.1, 100.0);
            this.SetSkill(SkillName.Tactics, 100.1, 110.0);
            this.SetSkill(SkillName.Wrestling, 100.1, 120.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\LesserHiryu.cs

<pre>this.SetSkill(SkillName.Anatomy, 75.1, 80.0);
            this.SetSkill(SkillName.MagicResist, 85.1, 100.0);
            this.SetSkill(SkillName.Tactics, 100.1, 110.0);
            this.SetSkill(SkillName.Wrestling, 100.1, 120.0);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Wight.cs

<pre>this.SetResistance(ResistanceType.Physical, 35, 45);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 40, 50);</pre>

Fragment 2 in file Scripts\Mobiles\Summons\SummonedAirElemental.cs

<pre>this.SetResistance(ResistanceType.Physical, 40, 50);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 35, 45);
            this.SetResistance(ResistanceType.Poison, 50, 60);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Churchill.cs

<pre>this.SetSkill(SkillName.Anatomy, 120.0, 120.0);
            this.SetSkill(SkillName.Parry, 120.0, 120.0);
            this.SetSkill(SkillName.Healing, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Recaro.cs

<pre>this.SetSkill(SkillName.Anatomy, 120.0, 120.0);
            this.SetSkill(SkillName.Parry, 120.0, 120.0);
            this.SetSkill(SkillName.Healing, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Chyloth.cs

<pre>Map map = this.Map;

            Effects.SendLocationParticles(EffectItem.Create(loc, map, EffectItem.DefaultDuration), 0x3728, 10, 10, 0, 0, 2023, 0);
            Effects.PlaySound(loc, map, 0x1FE);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Mobile\DemonicJailor.cs

<pre>Map map = this.Map;

            Effects.SendLocationParticles(EffectItem.Create(loc, map, EffectItem.DefaultDuration), 0x3728, 10, 10, 0, 0, 2023, 0);
            Effects.PlaySound(loc, map, 0x1FE);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Jun.cs

<pre>this.SetSkill(SkillName.Hiding, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Tracking, 120.0, 120.0);
            this.SetSkill(SkillName.Fencing, 120.0, 120.0);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Walker.cs

<pre>this.SetSkill(SkillName.Hiding, 120.0, 120.0);
            this.SetSkill(SkillName.Tactics, 120.0, 120.0);
            this.SetSkill(SkillName.Tracking, 120.0, 120.0);
            this.SetSkill(SkillName.Fencing, 120.0, 120.0);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>AddHtml(223, 32, 200, 40, "BARKEEP CUSTOMIZATION MENU", false, false);
			AddBackground(243, 433, 150, 30, 5054);

			AddImage(240, 433, 10460);
			AddImage(375, 433, 10460);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>AddHtml(223, 32, 200, 40, "BARKEEP CUSTOMIZATION MENU", false, false);
			AddBackground(243, 433, 150, 30, 5054);

			AddImage(240, 433, 10460);
			AddImage(375, 433, 10460);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Summons\ShadowWisp.cs

<pre>this.SetResistance(ResistanceType.Physical, 10, 15);
            this.SetResistance(ResistanceType.Fire, 10, 15);
            this.SetResistance(ResistanceType.Cold, 10, 15);
            this.SetResistance(ResistanceType.Poison, 10, 15);</pre>

Fragment 2 in file Scripts\Mobiles\Summons\VampireBat.cs

<pre>this.SetResistance(ResistanceType.Physical, 10, 15);
            this.SetResistance(ResistanceType.Fire, 10, 15);
            this.SetResistance(ResistanceType.Cold, 10, 15);
            this.SetResistance(ResistanceType.Poison, 10, 15);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\BaseHouse.cs

<pre>westDoor.Link = eastDoor;
            eastDoor.Link = westDoor;

            this.AddDoor(westDoor, x, y, z);
            this.AddDoor(eastDoor, x + 1, y, z);

            return new BaseDoor[2] { westDoor, eastDoor };</pre>

Fragment 2 in file Scripts\Multis\BaseHouse.cs

<pre>westDoor.Link = eastDoor;
            eastDoor.Link = westDoor;

            this.AddDoor(westDoor, x, y, z);
            this.AddDoor(eastDoor, x + 1, y, z);

            return new BaseDoor[2] { westDoor, eastDoor };</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Armor Refinement\Items.cs

<pre>writer.Write((int)0);

            writer.Write((int)m_RefinementType);
            writer.Write((int)m_CraftType);
            writer.Write((int)m_SubCraftType);
            writer.Write((int)m_ModType);</pre>

Fragment 2 in file Scripts\Services\Armor Refinement\Items.cs

<pre>writer.Write((int)0);

            writer.Write((int)m_RefinementType);
            writer.Write((int)m_CraftType);
            writer.Write((int)m_SubCraftType);
            writer.Write((int)m_ModType);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\DuelContextGump.cs

<pre>public void AddGoldenButtonLabeled(int x, int y, int bid, string text)
        {
            this.AddGoldenButton(x, y, bid);
            this.AddHtml(x + 25, y, 200, 20, text, false, false);
        }</pre>

Fragment 2 in file Scripts\Services\ConPVP\ParticipantGump.cs

<pre>public void AddGoldenButtonLabeled(int x, int y, int bid, string text)
        {
            this.AddGoldenButton(x, y, bid);
            this.AddHtml(x + 25, y, 200, 20, text, false, false);
        }</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\Core\CraftGump.cs

<pre>if (craftSystem.GumpTitleNumber > 0)
                this.AddHtmlLocalized(10, 12, 510, 20, craftSystem.GumpTitleNumber, LabelColor, false, false);
            else
                this.AddHtml(10, 12, 510, 20, craftSystem.GumpTitleString, false, false);</pre>

Fragment 2 in file Scripts\Services\Craft\Core\CraftGumpItem.cs

<pre>if (craftSystem.GumpTitleNumber > 0)
                this.AddHtmlLocalized(10, 12, 510, 20, craftSystem.GumpTitleNumber, LabelColor, false, false);
            else
                this.AddHtml(10, 12, 510, 20, craftSystem.GumpTitleString, false, false);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>hold7.Location = new Point3D(X - 1, Y + 10, Z);
                    hold8.Location = new Point3D(X,    Y + 9, Z);

                    fill1.Location = new Point3D(X, Y - 3, Z);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\BritannianShip.cs

<pre>hold7.Location = new Point3D(X + 1, Y - 10, Z);
                    hold8.Location = new Point3D(X,    Y - 9, Z);

                    fill1.Location = new Point3D(X, Y + 3, Z);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\CommodityBrokerGump.cs

<pre>AddBackground(190, 305, 285, 22, 9350);
			AddTextEntry(191, 305, 285, 20, LabelHueBlue, 1, "");
            AddButton(480, 305, 4014, 4016, 3, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>AddBackground(190, 305, 285, 22, 9350);
			AddTextEntry(191, 305, 285, 20, LabelHueBlue, 1, "");
            AddButton(480, 305, 4014, 4016, 3, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\Setup.cs

<pre>HueGates(gate1, gate2);
                LinkGates(gate1, gate2);

                gate1 = new Moongate(false);
                gate2 = new Moongate(false);
                WeakEntityCollection.Add("despise", gate1);
                WeakEntityCollection.Add("despise", gate2);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\Setup.cs

<pre>HueGates(gate1, gate2);
                LinkGates(gate1, gate2);

                gate1 = new Moongate(false);
                gate2 = new Moongate(false);
                WeakEntityCollection.Add("despise", gate1);
                WeakEntityCollection.Add("despise", gate2);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Underworld\Maze of Death\UnderworldPuzzle.cs

<pre>if (movingPiece != m_CurrentSolution.Rows[m_Row] || movingToPiece != m_CurrentSolution.Rows[nextRow])
                        {
                            m_CurrentSolution.Rows[m_Row] = movingPiece;
                            m_CurrentSolution.Rows[nextRow] = movingToPiece;

                            m_Item.CurrentSolution = m_CurrentSolution;
                            m_Item.Attempts++;
                        }
                        break;</pre>

Fragment 2 in file Scripts\Services\Underworld\Maze of Death\UnderworldPuzzle.cs

<pre>if (movingPiece != m_CurrentSolution.Rows[m_Row] || movingToPiece != m_CurrentSolution.Rows[nextRow])
                        {
                            m_CurrentSolution.Rows[m_Row] = movingPiece;
                            m_CurrentSolution.Rows[nextRow] = movingToPiece;

                            m_Item.Attempts++;

                            m_Item.CurrentSolution = m_CurrentSolution;
                        }
                        break;</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>List<XmlAttachment> alist = XmlAttach.FindAttachments(i);
						if (alist != null)
						{
							foreach (XmlAttachment a in alist)
							{
								if (a != null && !a.Deleted && a.HandlesOnMovement)
								{
									a.OnMovement(args);
								}
							}
						}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>List<XmlAttachment> alist = XmlAttach.FindAttachments(i);
						if (alist != null)
						{
							foreach (XmlAttachment a in alist)
							{
								if (a != null && !a.Deleted && a.HandlesOnMovement)
								{
									a.OnMovement(args);
								}
							}
						}</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlMessage.cs

<pre>public override void OnSpeech(SpeechEventArgs e )
		{
			base.OnSpeech(e);

			if(e.Mobile == null || e.Mobile.AccessLevel > AccessLevel.Player) return;

			if(e.Speech == ActivationWord)
			{
				OnTrigger(null, e.Mobile);
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlSound.cs

<pre>public override void OnSpeech(SpeechEventArgs e )
		{
			base.OnSpeech(e);

			if(e.Mobile == null || e.Mobile.AccessLevel > AccessLevel.Player) return;

			if(e.Speech == ActivationWord)
			{
				OnTrigger(null, e.Mobile);
			}
		}</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomAttacks.cs

<pre>int rand = Utility.Random(nspecials);
                    int nrtries = 0;
                    while(tmplist.Contains(rand))
                    {
                        rand = Utility.Random(nspecials);
                        // add some sanity checking
                        if(nrtries++ > 100) break;
                    }

                    tmplist.Add(rand);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomDefenses.cs

<pre>int rand = Utility.Random(nspecials);
                    int nrtries = 0;
                    while(tmplist.Contains(rand))
                    {
                        rand = Utility.Random(nspecials);
                        // add some sanity checking
                        if(nrtries++ > 100) break;
                    }

                    tmplist.Add(rand);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCatapult.cs

<pre>public override void LaunchProjectile(Mobile from, Item projectile, IEntity target, Point3D targetloc, TimeSpan delay)
		{
			// launch animation and delayed projectile release
			DoTimer(from, this, target, targetloc, projectile, delay, 0);
			// play the launch sound
			Effects.PlaySound(this, Map, 0x531);

		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>public override void LaunchProjectile(Mobile from, Item projectile, IEntity target, Point3D targetloc, TimeSpan delay)
		{
			// launch animation and delayed projectile release
			DoTimer(from, this, target, targetloc, projectile, delay, 0);
			// play the launch sound
			Effects.PlaySound(this, Map, 0x531);

		}</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Fifth\PoisonField.cs

<pre>bool canFit = SpellHelper.AdjustField(ref loc, map, 12, false);

                this.Visible = false;
                this.Movable = false;
                this.Light = LightType.Circle300;

                this.MoveToWorld(loc, map);

                this.m_Caster = caster;</pre>

Fragment 2 in file Scripts\Spells\Fourth\FireField.cs

<pre>bool canFit = SpellHelper.AdjustField(ref loc, map, 12, false);

                this.Visible = false;
                this.Movable = false;
                this.Light = LightType.Circle300;

                this.MoveToWorld(loc, map);

                this.m_Caster = caster;</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>{
			return (p.m_X >= (m_Location.m_X - range)) && (p.m_X <= (m_Location.m_X + range)) &&
				   (p.m_Y >= (m_Location.m_Y - range)) && (p.m_Y <= (m_Location.m_Y + range));
		}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>{
			return (p.m_X >= (m_Location.m_X - range)) && (p.m_X <= (m_Location.m_X + range)) &&
				   (p.m_Y >= (m_Location.m_Y - range)) && (p.m_Y <= (m_Location.m_Y + range));
		}</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Server\MultiData.cs

<pre>allTiles[i].m_OffsetX = reader.ReadShort();
					allTiles[i].m_OffsetY = reader.ReadShort();
					allTiles[i].m_OffsetZ = reader.ReadShort();
					allTiles[i].m_Flags = reader.ReadInt();</pre>

Fragment 2 in file Server\MultiData.cs

<pre>allTiles[i].m_OffsetX = reader.ReadShort();
					allTiles[i].m_OffsetY = reader.ReadShort();
					allTiles[i].m_OffsetZ = reader.ReadShort();
					allTiles[i].m_Flags = reader.ReadInt();</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Server\TileMatrix.cs

<pre>while (pCur < pEnd)
						{
							lists[pCur->m_X & 0x7][pCur->m_Y & 0x7].Add(pCur->m_ID, pCur->m_Z);
							pCur = pCur + 1;
						}

						var tiles = new StaticTile[8][][];</pre>

Fragment 2 in file Server\TileMatrixPatch.cs

<pre>while (pCur < pEnd)
								{
									lists[pCur->m_X & 0x7][pCur->m_Y & 0x7].Add(pCur->m_ID, pCur->m_Z);
									pCur = pCur + 1;
								}

								var tiles = new StaticTile[8][][];</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Server\Utility.cs

<pre>{
			return (p1.m_X >= (p2.m_X - 18)) && (p1.m_X <= (p2.m_X + 18)) && (p1.m_Y >= (p2.m_Y - 18)) &&
				   (p1.m_Y <= (p2.m_Y + 18));
		}</pre>

Fragment 2 in file Server\Utility.cs

<pre>{
			return (p1.m_X >= (p2.m_X - 18)) && (p1.m_X <= (p2.m_X + 18)) && (p1.m_Y >= (p2.m_Y - 18)) &&
				   (p1.m_Y <= (p2.m_Y + 18));
		}</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DecorativeShield.cs

<pre>this.AddButton(50, 35, 0x867, 0x869, (int)Buttons.East, GumpButtonType.Reply, 0);					
                    this.AddButton(145, 35, 0x867, 0x869, (int)Buttons.South, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Services\CleanUpBritannia\Items\DragonHead.cs

<pre>this.AddButton(50, 35, 0x867, 0x869, (int)Buttons.East, GumpButtonType.Reply, 0);
                    this.AddButton(145, 35, 0x867, 0x869, (int)Buttons.South, GumpButtonType.Reply, 0);</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\DecorativeShardShields.cs

<pre>this.AddButton(50, 35, 0x867, 0x869, (int)Buttons.East, GumpButtonType.Reply, 0);
                    this.AddButton(145, 35, 0x867, 0x869, (int)Buttons.South, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\MoonstoneGate.cs

<pre>private class InternalTimer : Timer
        {
            private readonly Item m_Item;
            public InternalTimer(Item item)
                : base(TimeSpan.FromSeconds(30.0))
            {
                this.m_Item = item;
                this.Priority = TimerPriority.OneSecond;
            }

            protected override void OnTick()
            {
                this.m_Item.Delete();
            }
        }</pre>

Fragment 2 in file Scripts\Services\StaffRunebook\RuneGate.cs

<pre>private class InternalTimer : Timer
        {
            private readonly Item m_Item;
            public InternalTimer(Item item)
                : base(TimeSpan.FromSeconds(30.0))
            {
                this.Priority = TimerPriority.OneSecond;
                this.m_Item = item;
            }

            protected override void OnTick()
            {
                this.m_Item.Delete();
            }
        }</pre>

Fragment 3 in file Scripts\Spells\Seventh\GateTravel.cs

<pre>private class InternalTimer : Timer
            {
                private readonly Item m_Item;
                public InternalTimer(Item item)
                    : base(TimeSpan.FromSeconds(30.0))
                {
                    this.Priority = TimerPriority.OneSecond;
                    this.m_Item = item;
                }

                protected override void OnTick()
                {
                    this.m_Item.Delete();
                }
            }</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\CrystalLatticeSeeker.cs

<pre>this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\BaseHealer.cs

<pre>this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

Fragment 3 in file Scripts\Mobiles\Summons\SummonedEarthElemental.cs

<pre>this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\AldenArmstrong.cs

<pre>this.AddItem(new StuddedLegs());
            this.AddItem(new StuddedGloves());
            this.AddItem(new StuddedGorget());
            this.AddItem(new StuddedChest());
            this.AddItem(new StuddedArms());</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HireFighter.cs

<pre>this.AddItem(new StuddedChest());
                    this.AddItem(new StuddedArms());
                    this.AddItem(new StuddedGloves());
                    this.AddItem(new StuddedGorget());
                    this.AddItem(new StuddedLegs());</pre>

Fragment 3 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionHenchman.cs

<pre>this.AddItem(new StuddedChest());
            this.AddItem(new StuddedLegs());
            this.AddItem(new StuddedArms());
            this.AddItem(new StuddedGloves());
            this.AddItem(new StuddedGorget());</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Instruments\BaseInstrument.cs

<pre>public int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            this.Quality = (InstrumentQuality)quality;

            if (makersMark)
                this.Crafter = from;

            return quality;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Quivers\BaseQuiver.cs

<pre>public virtual int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            this.Quality = (ClothingQuality)quality;

            if (makersMark)
                this.Crafter = from;

            return quality;
        }</pre>

Fragment 3 in file Scripts\Items\Tools\BaseHarvestTool.cs

<pre>public int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            this.Quality = (ToolQuality)quality;

            if (makersMark)
                this.Crafter = from;

            return quality;
        }</pre>

Fragment 4 in file Scripts\Items\Tools\BaseTool.cs

<pre>public int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            this.Quality = (ToolQuality)quality;

            if (makersMark)
                this.Crafter = from;

            return quality;
        }</pre>

## Duplicated Code. Size: 100

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Plants\Raised Garden Beds\RaisedGarden.cs

<pre>public override void OnChop( Mobile from )
        {
            foreach (AddonComponent comp in Components)
            {
                if (comp is GardenAddonComponent && ((GardenAddonComponent)comp).Plant != null)
                {
                    from.SendMessage("You must remove any plants before you can re-deed the raised garden.");
                    return;
                }
            }

            base.OnChop(from);
        }</pre>

Fragment 2 in file Scripts\Services\Plants\Raised Garden Beds\RaisedGarden.cs

<pre>public override void OnChop(Mobile from)
        {
            foreach (AddonComponent comp in Components)
            {
                if (comp is GardenAddonComponent && ((GardenAddonComponent)comp).Plant != null)
                {
                    from.SendMessage("You must remove any plants before you can re-deed the raised garden.");
                    return;
                }
            }

            base.OnChop(from);
        }</pre>

Fragment 3 in file Scripts\Services\Plants\Raised Garden Beds\RaisedGarden.cs

<pre>public override void OnChop(Mobile from)
        {
            foreach (AddonComponent comp in Components)
            {
                if (comp is GardenAddonComponent && ((GardenAddonComponent)comp).Plant != null)
                {
                    from.SendMessage("You must remove any plants before you can re-deed the raised garden.");
                    return;
                }
            }

            base.OnChop(from);
        }</pre>

Fragment 4 in file Scripts\Services\Plants\Raised Garden Beds\RaisedGarden.cs

<pre>public override void OnChop(Mobile from)
        {
            foreach (AddonComponent comp in Components)
            {
                if (comp is GardenAddonComponent && ((GardenAddonComponent)comp).Plant != null)
                {
                    from.SendMessage("You must remove any plants before you can re-deed the raised garden.");
                    return;
                }
            }

            base.OnChop(from);
        }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\BankerGump.cs

<pre>public void Refresh(bool recompile = true)
        {
            if (recompile)
            {
                Entries.Clear();
                Entries.TrimExcess();
                AddGumpLayout();
            }

            User.CloseGump(this.GetType());
            User.SendGump(this, false);
        }</pre>

Fragment 2 in file Scripts\Gumps\TitlesMenu.cs

<pre>public void Refresh(bool recompile = true)
        {
            if (recompile)
            {
                Entries.Clear();
                Entries.TrimExcess();
                AddGumpLayout();
            }

            User.CloseGump(this.GetType());
            User.SendGump(this, false);
        }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\CommunicationCrystals.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (!from.InRange(this.GetWorldLocation(), 2))
            {
                from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
                return;
            }

            from.Target = new InternalTarget(this);
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\CommunicationCrystals.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (!from.InRange(this.GetWorldLocation(), 2))
            {
                from.LocalOverheadMessage(MessageType.Regular, 0x3B2, 1019045); // I can't reach that.
                return;
            }

            from.Target = new InternalTarget(this);
        }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\Mahjong\MahjongGame.cs

<pre>this.BuildWalls();
            this.m_DealerIndicator = new MahjongDealerIndicator(this, new Point2D(300, 300), MahjongPieceDirection.Up, MahjongWind.North);
            this.m_WallBreakIndicator = new MahjongWallBreakIndicator(this, new Point2D(335, 335));</pre>

Fragment 2 in file Scripts\Items\Containers\Mahjong\MahjongGame.cs

<pre>this.BuildWalls();
            this.m_DealerIndicator = new MahjongDealerIndicator(this, new Point2D(300, 300), MahjongPieceDirection.Up, MahjongWind.North);
            this.m_WallBreakIndicator = new MahjongWallBreakIndicator(this, new Point2D(335, 335));</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Clothing\Cloaks.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (Core.ML && this.m_IsRewardItem)
                list.Add(RewardSystem.GetRewardYearLabel(this, new object[] { this.Hue, this.m_LabelNumber })); // X Year Veteran Reward
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (Core.ML && this.m_IsRewardItem)
                list.Add(RewardSystem.GetRewardYearLabel(this, new object[] { this.Hue, this.m_LabelNumber })); // X Year Veteran Reward
        }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseAxe.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)2); // version

            writer.Write((bool)this.m_ShowUsesRemaining);

            writer.Write((int)this.m_UsesRemaining);
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BasePoleArm.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)2); // version

            writer.Write((bool)this.m_ShowUsesRemaining);

            writer.Write((int)this.m_UsesRemaining);
        }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\MedusaLairAltar.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_ID);
            writer.Write((Item)this.m_Altar);
        }</pre>

Fragment 2 in file Scripts\Items\Functional\StygianDragonAltar.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_ID);
            writer.Write((Item)this.m_Altar);
        }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>int x = m_Offsets[i], y = m_Offsets[i + 1];

                    Point3D p = new Point3D(px + x, py + y, 0);

                    LandTarget lt = new LandTarget(p, map);</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>int x = m_Offsets[i], y = m_Offsets[i + 1];

                    Point3D p = new Point3D(px + x, py + y, 0);

                    LandTarget lt = new LandTarget(p, map);</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\FireDaemonRenowned.cs

<pre>this.SetHits(1111, 1478);

            this.SetDamage(22, 29);

            this.SetDamageType(ResistanceType.Physical, 50);
            this.SetDamageType(ResistanceType.Fire, 25);
            this.SetDamageType(ResistanceType.Energy, 25);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\FireDaemon.cs

<pre>this.SetHits(1111, 1478);

            this.SetDamage(22, 29);

            this.SetDamageType(ResistanceType.Physical, 50);
            this.SetDamageType(ResistanceType.Fire, 25);
            this.SetDamageType(ResistanceType.Energy, 25);</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\MorgBergen.cs

<pre>this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 80.1, 90.0);
            this.SetSkill(SkillName.Anatomy, 90.1, 100.0);

            this.Fame = 5000;
            this.Karma = -1000;</pre>

Fragment 2 in file Scripts\Mobiles\Named\TavaraSewel.cs

<pre>this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 80.1, 90.0);
            this.SetSkill(SkillName.Anatomy, 90.1, 100.0);

            this.Fame = 5000;
            this.Karma = -1000;</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\SkeletalDragonRenowned.cs

<pre>this.SetSkill(SkillName.MagicResist, 100.3, 130.0);
            this.SetSkill(SkillName.Tactics, 97.6, 100.0);
            this.SetSkill(SkillName.Wrestling, 97.6, 100.0);

            this.Fame = 22500;
            this.Karma = -22500;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ShadowWyrm.cs

<pre>this.SetSkill(SkillName.MagicResist, 100.3, 130.0);
            this.SetSkill(SkillName.Tactics, 97.6, 100.0);
            this.SetSkill(SkillName.Wrestling, 97.6, 100.0);

            this.Fame = 22500;
            this.Karma = -22500;</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ElfBrigand.cs

<pre>Item weapon = Loot.RandomWeapon();

            this.AddItem(weapon);

            if (weapon.Layer == Layer.OneHanded && Utility.RandomBool())
                this.AddItem(Loot.RandomShield());

            this.PackGold(50, 150);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\HumanBrigand.cs

<pre>Item weapon = Loot.RandomWeapon();

            this.AddItem(weapon);

            if (weapon.Layer == Layer.OneHanded && Utility.RandomBool())
                this.AddItem(Loot.RandomShield());

            this.PackGold(50, 150);</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Slime.cs

<pre>this.SetSkill(SkillName.MagicResist, 15.1, 20.0);
            this.SetSkill(SkillName.Tactics, 19.3, 34.0);
            this.SetSkill(SkillName.Wrestling, 19.3, 34.0);

            this.Fame = 300;
            this.Karma = -300;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Snake.cs

<pre>this.SetSkill(SkillName.MagicResist, 15.1, 20.0);
            this.SetSkill(SkillName.Tactics, 19.3, 34.0);
            this.SetSkill(SkillName.Wrestling, 19.3, 34.0);

            this.Fame = 300;
            this.Karma = -300;</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\BaseHouse.cs

<pre>retainDeedHue = true;

                            for (int i = 0; hue == 0 && i < ba.Components.Count; ++i)
                            {
                                AddonComponent c = ba.Components[i];

                                if (c.Hue != 0)
                                    hue = c.Hue;
                            }</pre>

Fragment 2 in file Scripts\Multis\BaseHouse.cs

<pre>retainDeedHue = true;

                                    for (int i = 0; hue == 0 && i < ba.Components.Count; ++i)
                                    {
                                        AddonComponent c = ba.Components[i];

                                        if (c.Hue != 0)
                                            hue = c.Hue;
                                    }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Trading\TradeSystem.cs

<pre>surface = id.Surface;
                impassable = id.Impassable;

                wet = (id.Flags & TileFlag.Wet) != 0;

                if (cantwalk && !wet)
                {
                    impassable = true;
                }
                if (canswim && wet)
                {
                    surface = true;
                    impassable = false;
                }</pre>

Fragment 2 in file Scripts\Services\City Loyalty System\Trading\TradeSystem.cs

<pre>surface = id.Surface;
                    impassable = id.Impassable;

                    wet = (id.Flags & TileFlag.Wet) != 0;
                    if (cantwalk && !wet)
                    {
                        impassable = true;
                    }
                    if (canswim && wet)
                    {
                        surface = true;
                        impassable = false;
                    }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefCarpentry.cs

<pre>this.AddSkill(index, SkillName.Tailoring, 65.0, 85.0);
                this.AddRes(index, typeof(Cloth), 1044286, 40, 1044287);
                this.ForceNonExceptional(index);
                this.SetNeededExpansion(index, Expansion.ML);</pre>

Fragment 2 in file Scripts\Services\Craft\DefCarpentry.cs

<pre>this.AddSkill(index, SkillName.Tailoring, 65.0, 85.0);
                this.AddRes(index, typeof(Cloth), 1044286, 40, 1044287);
                this.ForceNonExceptional(index);
                this.SetNeededExpansion(index, Expansion.ML);</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\Brightblade.cs

<pre>{
            WeaponAttributes.HitLeechStam = 100;
            WeaponAttributes.SplinteringWeapon = 20;
            Attributes.RegenStam = 3;
            Attributes.AttackChance = 10;
            Attributes.CastSpeed = 1;
            Attributes.WeaponSpeed = 40;
            Attributes.WeaponDamage = 50;
            AosElementDamages.Fire = 100;
            Hue = 1756;
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\Brightblade.cs

<pre>{
            WeaponAttributes.HitLeechStam = 100;
            WeaponAttributes.SplinteringWeapon = 20;
            Attributes.RegenStam = 3;
            Attributes.AttackChance = 10;
            Attributes.CastSpeed = 1;
            Attributes.WeaponSpeed = 40;
            Attributes.WeaponDamage = 50;
            AosElementDamages.Fire = 100;
            Hue = 1756;
        }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>foreach (Item item in r.GetEnumeratedItems().Where(i => i is XmlSpawner && i.Name.ToLower() != "shame_revamped" && i.Name.ToLower() != "shame_chest"))
            {
                ((XmlSpawner)item).DoReset = true;
            }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Generate.cs

<pre>foreach (Item item in r.GetEnumeratedItems().Where(i => i is XmlSpawner && i.Name.ToLower() != "shame_revamped" && i.Name.ToLower() != "shame_chest"))
            {
                ((XmlSpawner)item).DoReset = true;
            }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\SimpleTileTrap.cs

<pre>case 0:
				{

					this.m_SwitchSound = reader.ReadInt();
					this.m_TargetItem0 = reader.ReadItem();
					this.m_TargetProperty0 = reader.ReadString();
					this.m_TargetItem1 = reader.ReadItem();
					this.m_TargetProperty1 = reader.ReadString();
				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>case 0:
				{

					this.m_SwitchSound = reader.ReadInt();
					this.m_TargetItem0 = reader.ReadItem();
					this.m_TargetProperty0 = reader.ReadString();
					this.m_TargetItem1 = reader.ReadItem();
					this.m_TargetProperty1 = reader.ReadString();
				}</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>Item[] itemlist = pack.FindItemsByType(typeof(Item), true);
			if (itemlist != null)
			{
				for (int i = 0; i < itemlist.Length; i++)
				{
					itemlist[i].Movable = canmove;
				}
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>Item[] itemlist = pack.FindItemsByType(typeof(Item), true);
            if (itemlist != null)
            {
                for (int i = 0; i < itemlist.Length; i++)
                {
                    itemlist[i].Movable = canmove;
                }
            }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10121, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1061153, LabelColor, false, false);       //Luck</pre>

Fragment 2 in file Scripts\Skills\Imbuing\Gumps\ImbuingB.cs

<pre>AddButton(270, 85 + (yOffset * 25), 4005, 4007, 10121, GumpButtonType.Reply, 0);
                    AddHtmlLocalized(311, 87 + (yOffset * 25), 150, 18, 1061153, LabelColor, false, false);       //Luck</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Base\SpellRegistry.cs

<pre>if (t != null && !t.IsSubclassOf(typeof(SpecialMove)))
            {
                m_Params[0] = caster;
                m_Params[1] = scroll;

                try
                {
                    return (Spell)Activator.CreateInstance(t, m_Params);
                }
                catch
                {
                }
            }</pre>

Fragment 2 in file Scripts\Spells\Base\SpellRegistry.cs

<pre>if (t != null && !t.IsSubclassOf(typeof(SpecialMove)))
                {
                    m_Params[0] = caster;
                    m_Params[1] = scroll;

                    try
                    {
                        return (Spell)Activator.CreateInstance(t, m_Params);
                    }
                    catch
                    {
                    }
                }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Necromancy\PainSpike.cs

<pre>public void Target(Mobile m)
        {
            if (this.CheckHSequence(m))
            {
                SpellHelper.Turn(this.Caster, m);

                ApplyEffects(m);
                ConduitSpell.CheckAffected(Caster, m, ApplyEffects);
            }

            FinishSequence();
        }</pre>

Fragment 2 in file Scripts\Spells\Necromancy\Strangle.cs

<pre>public void Target(Mobile m)
        {
            if (this.CheckHSequence(m))
            {
                SpellHelper.Turn(this.Caster, m);

                ApplyEffects(m);
                ConduitSpell.CheckAffected(Caster, m, ApplyEffects);
            }

            FinishSequence();
        }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\BaseConflagrationPotion.cs

<pre>public static int GetDelay(Mobile m)
        {
            Timer timer = m_Delay[m] as Timer;

            if (timer != null && timer.Next > DateTime.UtcNow)
                return (int)(timer.Next - DateTime.UtcNow).TotalSeconds;

            return 0;
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\BaseConfusionBlastPotion.cs

<pre>public static int GetDelay(Mobile m)
        {
            Timer timer = m_Delay[m] as Timer;

            if (timer != null && timer.Next > DateTime.UtcNow)
                return (int)(timer.Next - DateTime.UtcNow).TotalSeconds;

            return 0;
        }</pre>

Fragment 3 in file Scripts\Items\Consumables\BaseExplodingTarPotion.cs

<pre>public static int GetDelay( Mobile m )
		{
			Timer timer = m_Delay[ m ] as Timer;

			if ( timer != null && timer.Next > DateTime.UtcNow )
				return (int) (timer.Next - DateTime.UtcNow).TotalSeconds;

			return 0;
		}</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Clothing\Cloaks.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_LabelNumber);
            writer.Write((bool)this.m_IsRewardItem);
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_LabelNumber);
            writer.Write((bool)this.m_IsRewardItem);
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_LabelNumber);
            writer.Write((bool)this.m_IsRewardItem);
        }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\BagOfSending.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int Charges
        {
            get
            {
                return this.m_Charges;
            }
            set
            {
                if (value > this.MaxCharges)
                    this.m_Charges = this.MaxCharges;
                else if (value < 0)
                    this.m_Charges = 0;
                else
                    this.m_Charges = value;

                this.InvalidateProperties();
            }
        }</pre>

Fragment 2 in file Scripts\Items\Tools\BallOfSummoning.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int Charges
        {
            get
            {
                return this.m_Charges;
            }
            set
            {
                if (value > this.MaxCharges)
                    this.m_Charges = this.MaxCharges;
                else if (value < 0)
                    this.m_Charges = 0;
                else
                    this.m_Charges = value;

                this.InvalidateProperties();
            }
        }</pre>

Fragment 3 in file Scripts\Items\Tools\BraceletOfBinding.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int Charges
        {
            get
            {
                return this.m_Charges;
            }
            set
            {
                if (value > this.MaxCharges)
                    this.m_Charges = this.MaxCharges;
                else if (value < 0)
                    this.m_Charges = 0;
                else
                    this.m_Charges = value;

                this.InvalidateProperties();
            }
        }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\BagOfSending.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int Recharges
        {
            get
            {
                return this.m_Recharges;
            }
            set
            {
                if (value > this.MaxRecharges)
                    this.m_Recharges = this.MaxRecharges;
                else if (value < 0)
                    this.m_Recharges = 0;
                else
                    this.m_Recharges = value;

                this.InvalidateProperties();
            }
        }</pre>

Fragment 2 in file Scripts\Items\Tools\BallOfSummoning.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int Recharges
        {
            get
            {
                return this.m_Recharges;
            }
            set
            {
                if (value > this.MaxRecharges)
                    this.m_Recharges = this.MaxRecharges;
                else if (value < 0)
                    this.m_Recharges = 0;
                else
                    this.m_Recharges = value;

                this.InvalidateProperties();
            }
        }</pre>

Fragment 3 in file Scripts\Items\Tools\BraceletOfBinding.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int Recharges
        {
            get
            {
                return this.m_Recharges;
            }
            set
            {
                if (value > this.MaxRecharges)
                    this.m_Recharges = this.MaxRecharges;
                else if (value < 0)
                    this.m_Recharges = 0;
                else
                    this.m_Recharges = value;

                this.InvalidateProperties();
            }
        }</pre>

## Duplicated Code. Size: 99

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\AgapiteElemental.cs

<pre>this.SetSkill(SkillName.MagicResist, 50.1, 95.0);
            this.SetSkill(SkillName.Tactics, 60.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 100.0);

            this.Fame = 3500;
            this.Karma = -3500;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GoldenElemental.cs

<pre>this.SetSkill(SkillName.MagicResist, 50.1, 95.0);
            this.SetSkill(SkillName.Tactics, 60.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 100.0);

            this.Fame = 3500;
            this.Karma = -3500;</pre>

Fragment 3 in file Scripts\Mobiles\Normal\ValoriteElemental.cs

<pre>this.SetSkill(SkillName.MagicResist, 50.1, 95.0);
            this.SetSkill(SkillName.Tactics, 60.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 100.0);

            this.Fame = 3500;
            this.Karma = -3500;</pre>

Fragment 4 in file Scripts\Mobiles\Normal\VeriteElemental.cs

<pre>this.SetSkill(SkillName.MagicResist, 50.1, 95.0);
            this.SetSkill(SkillName.Tactics, 60.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 100.0);

            this.Fame = 3500;
            this.Karma = -3500;</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetListOptionGump.cs

<pre>m_Property = prop;
			m_Mobile = mobile;
			m_Object = o;
			m_Stack = stack;
			m_Page = propspage;
			m_List = list;

			m_Values = values;

			int pages = (names.Length + EntryCount - 1) / EntryCount;
			int index = 0;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetListOptionGump.cs

<pre>m_Property = prop;
			m_Mobile = mobile;
			m_Object = o;
			m_Stack = stack;
			m_Page = propspage;
			m_List = list;

			m_Values = values;

			int pages = (names.Length + EntryCount - 1) / EntryCount;
			int index = 0;</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\MailboxEastAddon.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.WriteEncodedInt(1); // version
            writer.Write(this.m_Owner != null);
            if (this.m_Owner != null)
                writer.Write(this.m_Owner);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\MailboxSouthAddon.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.WriteEncodedInt(1); // version
            writer.Write(this.m_Owner != null);
            if (this.m_Owner != null)
                writer.Write(this.m_Owner);
        }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\GargishSignOfOrder.cs

<pre>{
			this.Name = "Sign of Order";

            this.SkillBonuses.SetValues(0, SkillName.Chivalry, 10.0);
            this.Attributes.AttackChance = 5;
            this.Attributes.DefendChance = 10;
            this.Attributes.CastSpeed = 1;
			this.Attributes.CastRecovery = 1;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\HumanSignOfOrder.cs

<pre>{
            this.Name = "Sign of Order";

            this.SkillBonuses.SetValues(0, SkillName.Chivalry, 10.0);
            this.Attributes.AttackChance = 5;
            this.Attributes.DefendChance = 10;
            this.Attributes.CastSpeed = 1;
            this.Attributes.CastRecovery = 1;
        }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Quivers\QuiverOfBlight.cs

<pre>public override void AlterBowDamage(ref int phys, ref int fire, ref int cold, ref int pois, ref int nrgy, ref int chaos, ref int direct)
        {
            phys = fire = nrgy = chaos = direct = 0;
            cold = pois = 50;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Quivers\QuiverOfFire.cs

<pre>public override void AlterBowDamage(ref int phys, ref int fire, ref int cold, ref int pois, ref int nrgy, ref int chaos, ref int direct)
        {
            cold = pois = nrgy = chaos = direct = 0;
            phys = fire = 50;
        }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\BowOfTheInfiniteSwarm.cs

<pre>{
            ExtendedWeaponAttributes.HitSwarm = 20;

            this.WeaponAttributes.HitLeechMana = 50;
            this.WeaponAttributes.HitLeechStam = 50;
            this.Attributes.BonusStam = 8;
            this.Attributes.RegenStam = 3;
            this.Attributes.WeaponSpeed = 30;
            this.Attributes.WeaponDamage = 50;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\BowOfTheInfiniteSwarm.cs

<pre>{
            ExtendedWeaponAttributes.HitSwarm = 20;

            this.WeaponAttributes.HitLeechMana = 50;
            this.WeaponAttributes.HitLeechStam = 50;
            this.Attributes.BonusStam = 8;
            this.Attributes.RegenStam = 3;
            this.Attributes.WeaponSpeed = 30;
            this.Attributes.WeaponDamage = 50;
        }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseBashing.cs

<pre>public override void OnHit(Mobile attacker, IDamageable defender, double damageBonus)
        {
            base.OnHit(attacker, defender, damageBonus);

            if(defender is Mobile)
                ((Mobile)defender).Stam -= Utility.Random(3, 3); // 3-5 points of stamina loss
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseStaff.cs

<pre>public override void OnHit(Mobile attacker, IDamageable defender, double damageBonus)
        {
            base.OnHit(attacker, defender, damageBonus);

            if(defender is Mobile)
                ((Mobile)defender).Stam -= Utility.Random(3, 3); // 3-5 points of stamina loss
        }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
            this.m_Item2 = reader.ReadItem() as InternalItem2;
        }</pre>

Fragment 2 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
            this.m_Item2 = reader.ReadItem() as InternalItem2;
        }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\LightCycle.cs

<pre>for (int i = 0; i < NetState.Instances.Count; ++i)
                {
                    NetState ns = NetState.Instances[i];
                    Mobile m = ns.Mobile;

                    if (m != null)
                        m.CheckLightLevels(false);
                }</pre>

Fragment 2 in file Scripts\Misc\LightCycle.cs

<pre>for (int i = 0; i < NetState.Instances.Count; ++i)
                {
                    NetState ns = NetState.Instances[i];
                    Mobile m = ns.Mobile;

                    if (m != null)
                        m.CheckLightLevels(false);
                }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Corpser.cs

<pre>this.VirtualArmor = 18;

            if (0.25 > Utility.RandomDouble())
                this.PackItem(new Board(10));
            else
                this.PackItem(new Log(10));

            this.PackItem(new MandrakeRoot(3));</pre>

Fragment 2 in file Scripts\Mobiles\Normal\TanglingRoots.cs

<pre>this.VirtualArmor = 18;

            if (0.25 > Utility.RandomDouble())
                this.PackItem(new Board(10));
            else
                this.PackItem(new Log(10));

            this.PackItem(new MandrakeRoot(3));</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Boats\Plank.cs

<pre>switch ( ItemID )
			{
				case 0x3EB1: ItemID = 0x3ED5; break;
				case 0x3E8A: ItemID = 0x3E89; break;
				case 0x3EB2: ItemID = 0x3ED4; break;
				case 0x3E85: ItemID = 0x3E84; break;
			}

			if ( m_Boat != null )
				m_Boat.Refresh();</pre>

Fragment 2 in file Scripts\Multis\Boats\Plank.cs

<pre>switch ( ItemID )
			{
				case 0x3ED5: ItemID = 0x3EB1; break;
				case 0x3E89: ItemID = 0x3E8A; break;
				case 0x3ED4: ItemID = 0x3EB2; break;
				case 0x3E84: ItemID = 0x3E85; break;
			}

			if ( m_Boat != null )
				m_Boat.Refresh();</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>int gold = goldTable[typeIndex][quanIndex][mtrlIndex];

            int min = (gold * 9) / 10;
            int max = (gold * 10) / 9;

            return Utility.RandomMinMax(min, max);</pre>

Fragment 2 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>int gold = goldTable[typeIndex][quanIndex][mtrlIndex];

            int min = (gold * 9) / 10;
            int max = (gold * 10) / 9;

            return Utility.RandomMinMax(min, max);</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 1-part (regular)
            {
                new int[] { 150, 150, 300, 300 },
                new int[] { 225, 225, 450, 450 },
                new int[] { 300, 400, 600, 750 }
            }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 1-part (regular)
            {
                new int[] { 150, 150, 300, 300 },
                new int[] { 225, 225, 450, 450 },
                new int[] { 300, 400, 600, 750 }
            }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 1-part (exceptional)
            {
                new int[] { 300, 300, 600, 600 },
                new int[] { 450, 450, 900, 900 },
                new int[] { 600, 750, 1200, 1800 }
            }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 1-part (exceptional)
            {
                new int[] { 300, 300, 600, 600 },
                new int[] { 450, 450, 900, 900 },
                new int[] { 600, 750, 1200, 1800 }
            }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>this.m_Active = false;
            this.m_HasBeenAdvanced = false;

            if (this.m_Timer != null)
                this.m_Timer.Stop();

            this.m_Timer = null;

            if (this.m_RestartTimer != null)
                this.m_RestartTimer.Stop();

            this.m_RestartTimer = null;</pre>

Fragment 2 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>this.m_Active = false;
            this.m_HasBeenAdvanced = false;

            if (this.m_Timer != null)
                this.m_Timer.Stop();

            this.m_Timer = null;

            if (this.m_RestartTimer != null)
                this.m_RestartTimer.Stop();

            this.m_RestartTimer = null;</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CleanUpBritannia\Items\DragonHead.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1042038); // You must have the object in your backpack to use it.          	
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\DecorativeShardShields.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1042038); // You must have the object in your backpack to use it.          	
        }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>{
                this.AddButton(300, 335, 0x15E1, 0x15E5, (int)Buttons.Next, GumpButtonType.Page, this.m_Page);
                this.AddHtmlLocalized(240, 335, 60, 20, 1072854, 0x1, false, false); // <div align=right>Next</div>
            }</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>{
                this.AddButton(300, 335, 0x15E1, 0x15E5, (int)Buttons.Next, GumpButtonType.Page, this.m_Page);
                this.AddHtmlLocalized(240, 335, 60, 20, 1072854, 0x1, false, false); // <div align=right>Next</div>
            }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\InstancedPeerless\Medusa\MedusaPlatform.cs

<pre>public override void AddBraziers()
		{
			AddBrazier( -1, -1, 7 );
			AddBrazier( 1, -1, 8 );
			AddBrazier( -1, 1, 8 );
			AddBrazier( 1, 1, 9 );
		}</pre>

Fragment 2 in file Scripts\Services\InstancedPeerless\StygianDragon\StygianDragonPlatform.cs

<pre>public override void AddBraziers()
		{
			AddBrazier( -1, -1, 7 );
			AddBrazier( 1, -1, 8 );
			AddBrazier( -1, 1, 8 );
			AddBrazier( 1, 1, 9 );
		}</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Pathing\FastMovement.cs

<pre>itemsStart = sStart.Items.Where(i => Verify(i, reqFlags, ignoreMovableImpassables, xStart, yStart));
				itemsForward = sForward.Items.Where(i => Verify(i, reqFlags, ignoreMovableImpassables, xForward, yForward));</pre>

Fragment 2 in file Scripts\Services\Pathing\FastMovement.cs

<pre>itemsStart = sStart.Items.Where(i => Verify(i, reqFlags, ignoreMovableImpassables, xStart, yStart));
				itemsForward = sForward.Items.Where(i => Verify(i, reqFlags, ignoreMovableImpassables, xForward, yForward));</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>ApplyAttribute(item, prefixCol[random].Attribute, prefixCol[random].Min(resIndex, preIndex, item), prefixCol[random].Max(resIndex, preIndex, item), moddedPercLow, moddedPercHigh, ref budget, luckchance)</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>ApplyAttribute(item, prefixCol[random].Attribute, prefixCol[random].Min(resIndex, preIndex, item), prefixCol[random].Max(resIndex, preIndex, item), moddedPercLow, moddedPercHigh, ref budget, luckchance)</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>ApplyAttribute(item, suffixCol[random].Attribute, suffixCol[random].Min(resIndex, preIndex, item), suffixCol[random].Max(resIndex, preIndex, item), moddedPercLow, moddedPercHigh, ref budget, luckchance)</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>ApplyAttribute(item, suffixCol[random].Attribute, suffixCol[random].Min(resIndex, preIndex, item), suffixCol[random].Max(resIndex, preIndex, item), moddedPercLow, moddedPercHigh, ref budget, luckchance)</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ViceVsVirtue\Items\Rewards\VvVWands.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);
			int version = reader.ReadInt();

            if (reader.ReadBool())
            {
                m_CurArcaneCharges = reader.ReadInt();
                m_MaxArcaneCharges = reader.ReadInt();
            }
		}</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\Items\Rewards\VvVWands.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (reader.ReadBool())
            {
                m_CurArcaneCharges = reader.ReadInt();
                m_MaxArcaneCharges = reader.ReadInt();
            }
        }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public MessageType SpeechStyle
		{

			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.SpeechStyle;
				}
				else
					return MessageType.Regular;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.SpeechStyle = value;
			}

		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public MessageType SpeechStyle
		{

			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.SpeechStyle;
				}
				else
					return MessageType.Regular;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.SpeechStyle = value;
			}

		}</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGauntlet.cs

<pre>public void DropBall(Mobile from, Point3D loc, Map map)
        {
            // drop the ball if they were carrying it
            if(m_DeathBall != null && from != null && m_DeathBall.RootParent == from)
            {
                GameBroadcast(100412, from.Name);  // "{0} has dropped the ball!"
                m_DeathBall.MoveToWorld(loc, map);
            }
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGauntlet.cs

<pre>public void DropBall(Mobile from, Point3D loc, Map map)
        {
            // drop the ball if they were carrying it
            if(m_DeathBall != null && from != null && m_DeathBall.RootParent == from)
            {
                GameBroadcast(100412, from.Name);  // "{0} has dropped the ball!"
                m_DeathBall.MoveToWorld(loc, map);
            }
        }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Poisoning.cs

<pre>{
                                ((FukiyaDarts)this.m_Target).Poison = this.m_Poison;
                                ((FukiyaDarts)this.m_Target).PoisonCharges = Math.Min(18 - (this.m_Poison.RealLevel * 2), ((FukiyaDarts)this.m_Target).UsesRemaining);
                            }</pre>

Fragment 2 in file Scripts\Skills\Poisoning.cs

<pre>{
                                ((Shuriken)this.m_Target).Poison = this.m_Poison;
                                ((Shuriken)this.m_Target).PoisonCharges = Math.Min(18 - (this.m_Poison.RealLevel * 2), ((Shuriken)this.m_Target).UsesRemaining);
                            }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Fifth\PoisonField.cs

<pre>this.m_End = DateTime.UtcNow + duration;

                this.m_Timer = new InternalTimer(this, TimeSpan.FromSeconds(Math.Abs(val) * 0.2), caster.InLOS(this), canFit);
                this.m_Timer.Start();</pre>

Fragment 2 in file Scripts\Spells\Fourth\FireField.cs

<pre>this.m_End = DateTime.UtcNow + duration;

                this.m_Timer = new InternalTimer(this, TimeSpan.FromSeconds(Math.Abs(val) * 0.2), caster.InLOS(this), canFit);
                this.m_Timer.Start();</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Server\Gumps\GumpTextEntry.cs

<pre>disp.AppendLayout( m_LayoutName );
			disp.AppendLayout( m_X );
			disp.AppendLayout( m_Y );
			disp.AppendLayout( m_Width );
			disp.AppendLayout( m_Height );
			disp.AppendLayout( m_Hue );
			disp.AppendLayout( m_EntryID );</pre>

Fragment 2 in file Server\Gumps\GumpTextEntryLimited.cs

<pre>disp.AppendLayout( m_LayoutName );
			disp.AppendLayout( m_X );
			disp.AppendLayout( m_Y );
			disp.AppendLayout( m_Width );
			disp.AppendLayout( m_Height );
			disp.AppendLayout( m_Hue );
			disp.AppendLayout( m_EntryID );</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\BaseChampion.cs

<pre>int chance = 0;

                    switch( VirtueHelper.GetLevel(prot, VirtueName.Justice) )
                    {
                        case VirtueLevel.Seeker:
                            chance = 60;
                            break;
                        case VirtueLevel.Follower:
                            chance = 80;
                            break;
                        case VirtueLevel.Knight:
                            chance = 100;
                            break;
                    }</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\Harrower\Harrower.cs

<pre>int chance = 0;

                        switch ( VirtueHelper.GetLevel(prot, VirtueName.Justice) )
                        {
                            case VirtueLevel.Seeker:
                                chance = 60;
                                break;
                            case VirtueLevel.Follower:
                                chance = 80;
                                break;
                            case VirtueLevel.Knight:
                                chance = 100;
                                break;
                        }</pre>

Fragment 3 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>int chance = 0;

                switch ( VirtueHelper.GetLevel(prot, VirtueName.Justice) )
                {
                    case VirtueLevel.Seeker:
                        chance = 60;
                        break;
                    case VirtueLevel.Follower:
                        chance = 80;
                        break;
                    case VirtueLevel.Knight:
                        chance = 100;
                        break;
                }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 4-part (regular)
            {
                new int[] { 4000, 4000, 5000, 5000 },
                new int[] { 6000, 6000, 7500, 7500 },
                new int[] { 8000, 10000, 10000, 15000 }
            }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 4-part (exceptional)
            {
                new int[] { 4000, 4000, 5000, 5000 },
                new int[] { 6000, 6000, 7500, 7500 },
                new int[] { 8000, 10000, 10000, 15000 }
            }</pre>

Fragment 3 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 5-part (regular)
            {
                new int[] { 4000, 4000, 5000, 5000 },
                new int[] { 6000, 6000, 7500, 7500 },
                new int[] { 8000, 10000, 10000, 15000 }
            }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 5-part (exceptional)
            {
                new int[] { 7500, 7500, 10000, 10000 },
                new int[] { 11250, 11250, 15000, 15000 },
                new int[] { 15000, 20000, 20000, 30000 }
            }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 6-part (regular)
            {
                new int[] { 7500, 7500, 10000, 10000 },
                new int[] { 11250, 11250, 15000, 15000 },
                new int[] { 15000, 20000, 20000, 30000 }
            }</pre>

Fragment 3 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 6-part (exceptional)
            {
                new int[] { 7500, 7500, 10000, 10000 },
                new int[] { 11250, 11250, 15000, 15000 },
                new int[] { 15000, 20000, 20000, 30000 }
            }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 4-part (exceptional)
            {
                new int[] { 5000, 5000, 7500, 7500 },
                new int[] { 7500, 7500, 11250, 11250 },
                new int[] { 10000, 15000, 15000, 20000 }
            }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 5-part (regular)
            {
                new int[] { 5000, 5000, 7500, 7500 },
                new int[] { 7500, 7500, 11250, 11250 },
                new int[] { 10000, 15000, 15000, 20000 }
            }</pre>

Fragment 3 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 5-part (exceptional)
            {
                new int[] { 5000, 5000, 7500, 7500 },
                new int[] { 7500, 7500, 11250, 11250 },
                new int[] { 10000, 15000, 15000, 20000 }
            }</pre>

Fragment 4 in file Scripts\Services\BulkOrders\Rewards.cs

<pre>new int[][] // 6-part (regular)
            {
                new int[] { 5000, 5000, 7500, 7500 },
                new int[] { 7500, 7500, 11250, 11250 },
                new int[] { 10000, 15000, 15000, 20000 }
            }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Decorative\CollectionsBritLibraryQuotes.cs

<pre>if (Utility.RandomBool())
                    Effects.PlaySound(this.Location, this.Map, Utility.RandomMinMax(0x30A, 0x313));
                else
                    Effects.PlaySound(this.Location, this.Map, Utility.RandomMinMax(0x419, 0x422));</pre>

Fragment 2 in file Scripts\Items\Artifacts\Decorative\CollectionsBritLibraryQuotes.cs

<pre>if (Utility.RandomBool())
                    Effects.PlaySound(this.Location, this.Map, Utility.RandomMinMax(0x30A, 0x313));
                else
                    Effects.PlaySound(this.Location, this.Map, Utility.RandomMinMax(0x419, 0x422));</pre>

Fragment 3 in file Scripts\Items\Artifacts\Decorative\CollectionsBritLibraryQuotes.cs

<pre>if (Utility.RandomBool())
                    Effects.PlaySound(this.Location, this.Map, Utility.RandomMinMax(0x30A, 0x313));
                else
                    Effects.PlaySound(this.Location, this.Map, Utility.RandomMinMax(0x419, 0x422));</pre>

Fragment 4 in file Scripts\Items\Artifacts\Decorative\CollectionsBritLibraryQuotes.cs

<pre>if (Utility.RandomBool())
                    Effects.PlaySound(this.Location, this.Map, Utility.RandomMinMax(0x30A, 0x313));
                else
                    Effects.PlaySound(this.Location, this.Map, Utility.RandomMinMax(0x419, 0x422));</pre>

Fragment 5 in file Scripts\Items\Artifacts\Decorative\CollectionsBritLibraryQuotes.cs

<pre>if (Utility.RandomBool())
                    Effects.PlaySound(this.Location, this.Map, Utility.RandomMinMax(0x30A, 0x313));
                else
                    Effects.PlaySound(this.Location, this.Map, Utility.RandomMinMax(0x419, 0x422));</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\AmbitiousSolenQueen\Objectives.cs

<pre>gump.AddLabel(70, 280, 0x64, this.CurProgress.ToString());
                gump.AddLabel(100, 280, 0x64, "/");
                gump.AddLabel(130, 280, 0x64, this.MaxProgress.ToString());</pre>

Fragment 2 in file Scripts\Quests\Collector\Objectives.cs

<pre>gump.AddLabel(70, 280, 0x64, this.CurProgress.ToString());
                gump.AddLabel(100, 280, 0x64, "/");
                gump.AddLabel(130, 280, 0x64, this.MaxProgress.ToString());</pre>

Fragment 3 in file Scripts\Quests\EminosUndertaking\Objectives.cs

<pre>gump.AddLabel(70, 280, 0x64, this.CurProgress.ToString());
                gump.AddLabel(100, 280, 0x64, "/");
                gump.AddLabel(130, 280, 0x64, this.MaxProgress.ToString());</pre>

Fragment 4 in file Scripts\Quests\SolenMatriarch\Objectives.cs

<pre>gump.AddLabel(70, 280, 0x64, this.CurProgress.ToString());
                gump.AddLabel(100, 280, 0x64, "/");
                gump.AddLabel(130, 280, 0x64, this.MaxProgress.ToString());</pre>

Fragment 5 in file Scripts\Quests\StudyOfTheSolenHive\Objectives.cs

<pre>gump.AddLabel(70, 280, 0x64, this.CurProgress.ToString());
                gump.AddLabel(100, 280, 0x64, "/");
                gump.AddLabel(130, 280, 0x64, this.MaxProgress.ToString());</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BrokenBed.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.
        }</pre>

Fragment 2 in file Scripts\Items\Addons\BrokenVanity.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.
        }</pre>

Fragment 3 in file Scripts\Items\Addons\Curtains.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.
        }</pre>

Fragment 4 in file Scripts\Items\Addons\HangingAxes.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.
        }</pre>

Fragment 5 in file Scripts\Items\Addons\HangingSwords.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.
        }</pre>

Fragment 6 in file Scripts\Items\Addons\HouseLadder.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.
        }</pre>

Fragment 7 in file Scripts\Items\Addons\Statue.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.
        }</pre>

Fragment 8 in file Scripts\Items\Addons\UnmadeBed.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.
        }</pre>

Fragment 9 in file Scripts\Items\Addons\WoodenCoffin.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.
        }</pre>

Fragment 10 in file Scripts\Items\Consumables\PersonalAttendantToken.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.
        }</pre>

Fragment 11 in file Scripts\Items\Containers\Vanity.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(InternalGump));
                from.SendGump(new InternalGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.
        }</pre>

## Duplicated Code. Size: 98

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\GeoffreyCampAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\PotteryWheelAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\ArmoryAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 4 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Addons\BarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 5 in file Scripts\Services\FireCasino\TentBrownAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 6 in file Scripts\Services\FireCasino\TentWhiteAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 7 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\Alchemist2BazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 8 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\ArtistBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 9 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\CarpetedStairBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 10 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\DistilleryBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 11 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\EvilBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 12 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\FishermanBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 13 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\JewelerBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 14 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\LeatherArmourBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 15 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\PillowBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 16 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\ScribeBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 17 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\Tailor2BazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

Fragment 18 in file Scripts\Services\MaginciaBazaar\BazaarAddOns\TailorBazaarAddon.cs

<pre>private static void AddComplexComponent(BaseAddon addon, int item, int xoffset, int yoffset, int zoffset, int hue, int lightsource)
        {
            AddComplexComponent(addon, item, xoffset, yoffset, zoffset, hue, lightsource, null, 1);
        }</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AdminGump.cs

<pre>this.AddPageButton(200, 20, this.GetButtonID(0, 0), "General", AdminGumpPage.Information_General);
                        this.AddPageButton(200, 40, this.GetButtonID(0, 5), "Performance", AdminGumpPage.Information_Perf);

                        break;</pre>

Fragment 2 in file Scripts\Gumps\AdminGump.cs

<pre>this.AddPageButton(200, 20, this.GetButtonID(0, 0), "General", AdminGumpPage.Information_General);
                        this.AddPageButton(200, 40, this.GetButtonID(0, 5), "Performance", AdminGumpPage.Information_Perf);

                        break;</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\MiniHouses.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_Type = (MiniHouseType)reader.ReadInt();
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\Moonstone.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_Type = (MoonstoneType)reader.ReadInt();

                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Spellbooks\Spellbook.cs

<pre>{
					if (ns.ContainerGridLines)
					{
						to.Send(new SpellbookContent6017(m_Count, BookOffset + 1, m_Content, this));
					}
					else
					{
						to.Send(new SpellbookContent(m_Count, BookOffset + 1, m_Content, this));
					}
				}</pre>

Fragment 2 in file Scripts\Items\Equipment\Spellbooks\Spellbook.cs

<pre>{
				if (ns.ContainerGridLines)
				{
					to.Send(new SpellbookContent6017(m_Count, BookOffset + 1, m_Content, this));
				}
				else
				{
					to.Send(new SpellbookContent(m_Count, BookOffset + 1, m_Content, this));
				}
			}</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\MorphItem.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (Utility.InRange(m.Location, this.Location, this.CurrentRange) || Utility.InRange(oldLocation, this.Location, this.CurrentRange))
                this.Refresh();
        }</pre>

Fragment 2 in file Scripts\Services\Khaldun\RaiseSwitch.cs

<pre>public override void OnMovement(Mobile m, Point3D oldLocation)
        {
            if (Utility.InRange(m.Location, this.Location, this.CurrentRange) || Utility.InRange(oldLocation, this.Location, this.CurrentRange))
                this.Refresh();
        }</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Grim.cs

<pre>this.Tamable = false;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Named\Miasma.cs

<pre>this.Tamable = false;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\AgapiteElemental.cs

<pre>this.BaseSoundID = 268;

            this.SetStr(226, 255);
            this.SetDex(126, 145);
            this.SetInt(71, 92);

            this.SetHits(136, 153);

            this.SetDamage(28);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ValoriteElemental.cs

<pre>this.BaseSoundID = 268;

            this.SetStr(226, 255);
            this.SetDex(126, 145);
            this.SetInt(71, 92);

            this.SetHits(136, 153);

            this.SetDamage(28);</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>Effects.SendLocationParticles(
                    EffectItem.Create(m.Location, m.Map, EffectItem.DefaultDuration), 0x36B0, 1, 14, 63, 7, 9915, 0);
                Effects.PlaySound(m.Location, m.Map, 0x229);</pre>

Fragment 2 in file Scripts\Spells\Necromancy\PoisonStrike.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(m.Location, m.Map, EffectItem.DefaultDuration), 0x36B0, 1, 14, 63, 7, 9915, 0);
            Effects.PlaySound(m.Location, m.Map, 0x229);</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Cougar.cs

<pre>this.BaseSoundID = 0x73;

            this.SetStr(56, 80);
            this.SetDex(66, 85);
            this.SetInt(26, 50);

            this.SetHits(34, 48);
            this.SetMana(0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SnowLeopard.cs

<pre>this.BaseSoundID = 0x73;

            this.SetStr(56, 80);
            this.SetDex(66, 85);
            this.SetInt(26, 50);

            this.SetHits(34, 48);
            this.SetMana(0);</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DesertOstard.cs

<pre>this.BaseSoundID = 0x270;

            this.SetStr(94, 170);
            this.SetDex(56, 75);
            this.SetInt(6, 10);

            this.SetHits(71, 88);
            this.SetMana(0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ForestOstard.cs

<pre>this.BaseSoundID = 0x270;

            this.SetStr(94, 170);
            this.SetDex(56, 75);
            this.SetInt(6, 10);

            this.SetHits(71, 88);
            this.SetMana(0);</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\WitchApprentice\Objectives.cs

<pre>if (m != null && !m.Deleted)
            {
                Effects.SendLocationEffect(m.Location, m.Map, 0x3728, 10, 10);
                Effects.PlaySound(m.Location, m.Map, 0x1FE);

                m.Delete();
            }</pre>

Fragment 2 in file Scripts\Quests\WitchApprentice\Objectives.cs

<pre>if (m != null && !m.Deleted)
            {
                Effects.SendLocationEffect(m.Location, m.Map, 0x3728, 10, 10);
                Effects.PlaySound(m.Location, m.Map, 0x1FE);

                m.Delete();
            }</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlGetAttachGump.cs

<pre>int index = i + DisplayFrom;
				if(m_SearchList == null || index >= m_SearchList.Count) break;
				int page = (int)(i/MaxEntriesPerPage);
				if(i%MaxEntriesPerPage == 0){
					AddPage(page+1);
				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlEdit.cs

<pre>int index = i + DisplayFrom;
				if(m_SearchList == null || index >= m_SearchList.Count) break;
				int page = (int)(i/MaxEntriesPerPage);
				if(i%MaxEntriesPerPage == 0)
				{
					AddPage(page+1);
					// add highlighted page button
					//AddImageTiled( 235+page*25, 448, 25, 25, 0xBBC );
					//AddImage( 238+page*25, 450, 0x8B1+page );
				}</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlAddVirtue.cs

<pre>VirtueName g = (VirtueName)0;
				bool valid = true;
				bool gainedPath = false;
                try{
                    g = (VirtueName)Enum.Parse(typeof(VirtueName),Virtue, true);
                } catch{valid = false;}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlAddVirtue.cs

<pre>VirtueName g = (VirtueName)0;
			bool valid = true;
			bool gainedPath = false;
            try{
                g = (VirtueName)Enum.Parse(typeof(VirtueName),Virtue, true);
            } catch{valid = false;}</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public int Pause
		{

			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.Pause;
				}
				else
					return -1;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.Pause = value;
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public int Pause
		{

			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.Pause;
				}
				else
					return -1;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.Pause = value;
			}
		}</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public int PrePause
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.PrePause;
				}
				else
					return -1;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.PrePause = value;
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public int PrePause
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.PrePause;
				}
				else
					return -1;
			}
			set
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.PrePause = value;
			}
		}</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public int ID
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.ID;
				}
				else
					return -1;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.ID = value;
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public int ID
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.ID;
				}
				else
					return -1;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.ID = value;
			}
		}</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>if (ObjectPropertyList.Enabled)
			{
				List<Item> items = this.Items;

				for (int i = 0; i < items.Count; ++i)
					to.Send(((Item)items[i]).OPLPacket);
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>if (ObjectPropertyList.Enabled)
            {
                List<Item> items = this.Items;

                for (int i = 0; i < items.Count; ++i)
                    to.Send(((Item)items[i]).OPLPacket);
            }</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCatapult.cs

<pre>{
			if (m_Timer != null)
				m_Timer.Stop();

			if (step > 4 || step < 0) return;

			m_Timer = new InternalTimer(from, weapon, target, targetloc, projectile, damagedelay, step);
			m_Timer.Start();
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>{
			if (m_Timer != null)
				m_Timer.Stop();

			if (step > 4 || step < 0) return;

			m_Timer = new InternalTimer(from, weapon, target, targetloc, projectile, damagedelay, step);
			m_Timer.Start();
		}</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Imbuing\Gumps\ImbuingGump.cs

<pre>Effects.PlaySound(from.Location, from.Map, 0x1ED);
                        Effects.SendLocationParticles(
                            EffectItem.Create(from.Location, from.Map, EffectItem.DefaultDuration), 0x373A,
                            10, 30, 0, 4, 0, 0);</pre>

Fragment 2 in file Scripts\Skills\Imbuing\Gumps\ImbuingGump.cs

<pre>Effects.PlaySound(from.Location, from.Map, 0x1ED);
                            Effects.SendLocationParticles(
                                EffectItem.Create(from.Location, from.Map, EffectItem.DefaultDuration), 0x373A,
                                10, 30, 0, 4, 0, 0);</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>foreach (NetState state in eable)
                    {
                        Mobile m = state.Mobile;

                        if (m.CanSee(this) && m.InRange(m_Location, GetUpdateRange(m)))
                        {
                            SendInfoTo(state);
                        }
                    }

                    eable.Free();</pre>

Fragment 2 in file Server\Item.cs

<pre>foreach (NetState state in eable)
                {
                    Mobile m = state.Mobile;

                    if (m.CanSee(this) && m.InRange(m_Location, GetUpdateRange(m)))
                    {
                        SendInfoTo(state);
                    }
                }

                eable.Free();</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketReader.cs

<pre>string s = Utility.UTF8.GetString(buffer);

			bool isSafe = true;

			for (int i = 0; isSafe && i < s.Length; ++i)
			{
				isSafe = IsSafeChar(s[i]);
			}</pre>

Fragment 2 in file Server\Network\PacketReader.cs

<pre>string s = Utility.UTF8.GetString(buffer);

			bool isSafe = true;

			for (int i = 0; isSafe && i < s.Length; ++i)
			{
				isSafe = IsSafeChar(s[i]);
			}</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Ultima\Multis.cs

<pre>int px = (x - y) * 22;
						int py = (x + y) * 22;

						px -= (bmp.Width / 2);
						py -= tiles[i].Z << 2;
						py -= bmp.Height;</pre>

Fragment 2 in file Ultima\Multis.cs

<pre>int px = (x - y) * 22;
						int py = (x + y) * 22;

						px -= (bmp.Width / 2);
						py -= tiles[i].Z << 2;
						py -= bmp.Height;</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\SnowGlobes.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_Type = (SnowGlobeTypeOne)reader.ReadEncodedInt();
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\SnowGlobes.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_Type = (SnowGlobeTypeTwo)reader.ReadEncodedInt();
                        break;
                    }
            }
        }</pre>

Fragment 3 in file Scripts\Items\Decorative\SnowGlobes.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_Type = (SnowGlobeTypeThree)reader.ReadEncodedInt();
                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();
            this.Type = (DoorType)reader.ReadInt();
            _Resource = (CraftResource)reader.ReadInt();
        }</pre>

Fragment 2 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();
            this.Type = (DoorType)reader.ReadInt();
            _Resource = (CraftResource)reader.ReadInt();
        }</pre>

Fragment 3 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();
            this.Type = (DoorType)reader.ReadInt();
            _Resource = (CraftResource)reader.ReadInt();
        }</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Meraktus.cs

<pre>this.VirtualArmor = 28; // Don't know what it should be

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\InsaneDryad.cs

<pre>this.VirtualArmor = 28; // Don't know what it should be

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\MinotaurCaptain.cs

<pre>this.VirtualArmor = 28; // Don't know what it should be

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Impresario.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Hue = Utility.RandomSkinHue();

            this.Female = false;
            this.Body = 0x190;
            this.Name = NameList.RandomName("male");
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\MansionGuard.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Hue = Utility.RandomSkinHue();

            this.Female = false;
            this.Body = 0x190;
            this.Name = NameList.RandomName("male");
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Naturalist.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Hue = Utility.RandomSkinHue();

            this.Female = false;
            this.Body = 0x190;
            this.Name = NameList.RandomName("male");
        }</pre>

## Duplicated Code. Size: 97

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>case EodonTribe.Jukari:
                    Female = Utility.RandomBool();
                    Body = Female ? 0x191 : 0x190;
                    HairItemID = 0;
                    Hue = 34723; break;
		        case EodonTribe.Kurak:
                    Female = Utility.RandomBool();
                    Body = Female ? 0x191 : 0x190;</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>case EodonTribe.Jukari:
                    Female = Utility.RandomBool();
                    Body = Female ? 0x191 : 0x190;
                    HairItemID = 0;
                    Hue = 34723; break;
                case EodonTribe.Kurak:
                    Female = Utility.RandomBool();
                    Body = Female ? 0x191 : 0x190;</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>case EodonTribe.Jukari:
                    Female = Utility.RandomBool();
                    Body = Female ? 0x191 : 0x190;
                    HairItemID = 0;
                    Hue = 34723; break;
                case EodonTribe.Kurak:
                    Female = Utility.RandomBool();
                    Body = Female ? 0x191 : 0x190;</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\PileOfGlacialSnow.cs

<pre>new InternalTimer(from).Start();

                            from.PlaySound(0x145);

                            from.Animate(9, 1, 1, true, false, 0);

                            targ.SendLocalizedMessage(1010572); // You have just been hit by a snowball!
                            from.SendLocalizedMessage(1010573); // You throw the snowball and hit the target!</pre>

Fragment 2 in file Scripts\Items\Decorative\SnowPile.cs

<pre>new InternalTimer(from).Start();

                            from.PlaySound(0x145);

                            from.Animate(9, 1, 1, true, false, 0);

                            targ.SendLocalizedMessage(1010572); // You have just been hit by a snowball!
                            from.SendLocalizedMessage(1010573); // You throw the snowball and hit the target!</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override bool CanEquip(Mobile m)
        {
            if (!base.CanEquip(m))
                return false;

            return !this.m_IsRewardItem || RewardSystem.CheckIsUsableBy(m, this, new object[] { this.Hue, this.m_LabelNumber });
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override bool CanEquip(Mobile m)
        {
            if (!base.CanEquip(m))
                return false;

            return !this.m_IsRewardItem || RewardSystem.CheckIsUsableBy(m, this, new object[] { this.Hue, this.m_LabelNumber });
        }</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Spellbooks\Spellbook.cs

<pre>if ((prop = m_AosAttributes.EnhancePotions) != 0)
			{
				list.Add(1060411, prop.ToString()); // enhance potions ~1_val~%
			}

			if ((prop = m_AosAttributes.CastRecovery) != 0)
			{
				list.Add(1060412, prop.ToString()); // faster cast recovery ~1_val~
			}</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if ((prop = m_AosAttributes.EnhancePotions) != 0)
			{
				list.Add(1060411, prop.ToString()); // enhance potions ~1_val~%
			}

			if ((prop = m_AosAttributes.CastRecovery) != 0)
			{
				list.Add(1060412, prop.ToString()); // faster cast recovery ~1_val~
			}</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Navery\NavreyParalyzingWeb.cs

<pre>private class InternalTimer : Timer
        {
            private readonly Item m_Item;

            public InternalTimer(Item item, TimeSpan duration)
                : base(duration)
            {
                this.Priority = TimerPriority.OneSecond;
                this.m_Item = item;
            }

            protected override void OnTick()
            {
                this.m_Item.Delete();
            }
        }</pre>

Fragment 2 in file Scripts\Spells\Sixth\ParalyzeField.cs

<pre>private class InternalTimer : Timer
            {
                private readonly Item m_Item;
                public InternalTimer(Item item, TimeSpan duration)
                    : base(duration)
                {
                    this.Priority = TimerPriority.OneSecond;
                    this.m_Item = item;
                }

                protected override void OnTick()
                {
                    this.m_Item.Delete();
                }
            }</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Bogling.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 20, 25);
            this.SetResistance(ResistanceType.Fire, 10, 20);
            this.SetResistance(ResistanceType.Cold, 15, 25);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\PackHorse.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 20, 25);
            this.SetResistance(ResistanceType.Fire, 10, 15);
            this.SetResistance(ResistanceType.Cold, 20, 25);</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DeathWatchBeetle.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 35, 40);
            this.SetResistance(ResistanceType.Fire, 15, 30);
            this.SetResistance(ResistanceType.Cold, 15, 30);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DeathWatchBeetleHatchling.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 35, 40);
            this.SetResistance(ResistanceType.Fire, 15, 30);
            this.SetResistance(ResistanceType.Cold, 15, 30);</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Quagmire.cs

<pre>this.SetResistance(ResistanceType.Fire, 10, 20);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 20, 30);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\DiabolicalSeaweed.cs

<pre>this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 10, 20);</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Ravager.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 50, 60);
            this.SetResistance(ResistanceType.Fire, 50, 60);
            this.SetResistance(ResistanceType.Cold, 60, 70);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Mobile\SavagePackWolf.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 50, 60);
            this.SetResistance(ResistanceType.Fire, 50, 60);
            this.SetResistance(ResistanceType.Cold, 60, 70);</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\SewerRat.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 5, 10);
            this.SetResistance(ResistanceType.Poison, 15, 25);
            this.SetResistance(ResistanceType.Energy, 5, 10);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Mobile\PrisonRat.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 5, 10);
            this.SetResistance(ResistanceType.Poison, 15, 25);
            this.SetResistance(ResistanceType.Energy, 5, 10);</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\BaseVendor.cs

<pre>if (resp.Item.RootParent != seller || resp.Amount <= 0 || !resp.Item.IsStandardLoot() || !resp.Item.Movable ||
					(resp.Item is Container && (resp.Item).Items.Count != 0))
				{
					continue;
				}</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\BaseVendor.cs

<pre>if (resp.Item.RootParent != seller || resp.Amount <= 0 || !resp.Item.IsStandardLoot() || !resp.Item.Movable ||
					(resp.Item is Container && (resp.Item).Items.Count != 0))
				{
					continue;
				}</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Summons\BladeSpirits.cs

<pre>this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 20, 30);</pre>

Fragment 2 in file Scripts\Mobiles\Void Creatures\Ballem.cs

<pre>this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Discipline.cs

<pre>this.AddReward(new BaseReward(typeof(ArcaneCircleScroll), 1071026)); // Arcane Circle			
            this.AddReward(new BaseReward(typeof(GiftOfRenewalScroll), 1071027)); // Gift of Renewal
            this.AddReward(new BaseReward(typeof(SpellweavingBook), 1031600)); // Spellweaving Spellbook</pre>

Fragment 2 in file Scripts\Quests\Spellweaving.cs

<pre>this.AddReward(new BaseReward(typeof(ArcaneCircleScroll), 1071026)); // Arcane Circle			
            this.AddReward(new BaseReward(typeof(GiftOfRenewalScroll), 1071027)); // Gift of Renewal
            this.AddReward(new BaseReward(typeof(SpellweavingBook), 1031600)); // Spellweaving Spellbook</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\Core\CraftItem.cs

<pre>if (tool != null && !tool.Deleted && tool.UsesRemaining > 0)
				{
					from.SendGump(new CraftGump(from, craftSystem, tool, num));
				}
				else if (num > 0)
				{
					from.SendLocalizedMessage(num);
				}</pre>

Fragment 2 in file Scripts\Services\Craft\Core\CraftItem.cs

<pre>if (tool != null && !tool.Deleted && tool.UsesRemaining > 0)
				{
					from.SendGump(new CraftGump(from, craftSystem, tool, num));
				}
				else if (num > 0)
				{
					from.SendLocalizedMessage(num);
				}</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>Race = Race.Elf;
                    HairItemID = 0x2FC1;
                    Hue = 35356; 
                    break;
		        case EodonTribe.Sakkhra:
                    Female = Utility.RandomBool();
                    Body = Female ? 0x191 : 0x190;
                    HairItemID = 0x203C;
                    Hue = 34894; 
                    RangeFight = 7; break;</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>Race = Race.Elf;
                    HairItemID = 0x2FC1;
                    Hue = 35356; 
                    break;
                case EodonTribe.Sakkhra:
                    Female = Utility.RandomBool();
                    Body = Female ? 0x191 : 0x190;
                    HairItemID = 0x203C;
                    Hue = 34894; 
                    RangeFight = 7; break;</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Gumps\FactionStoneGump.cs

<pre>this.m_From = from;
            this.m_Faction = faction;

            this.AddPage(0);

            this.AddBackground(0, 0, 550, 440, 5054);
            this.AddBackground(10, 10, 530, 420, 3000);</pre>

Fragment 2 in file Scripts\Services\Factions\Gumps\JoinStoneGump.cs

<pre>this.m_From = from;
            this.m_Faction = faction;

            this.AddPage(0);

            this.AddBackground(0, 0, 550, 440, 5054);
            this.AddBackground(10, 10, 530, 420, 3000);</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Plants\Raised Garden Beds\RaisedGarden.cs

<pre>AddComponent(new GardenAddonComponent(19234), 0, 0, 0);
            AddComponent(new GardenAddonComponent(19240), 1, 0, 0);
            AddComponent(new GardenAddonComponent(19235), 2, 0, 0);</pre>

Fragment 2 in file Scripts\Services\Plants\Raised Garden Beds\RaisedGarden.cs

<pre>AddComponent(new GardenAddonComponent(19234), 0, 0, 0);
            AddComponent(new GardenAddonComponent(19240), 1, 0, 0);
            AddComponent(new GardenAddonComponent(19235), 2, 0, 0);</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Generate.cs

<pre>foreach (Item item in eable)
            {
                if (item is XmlSpawner || item is Teleporter || item.ItemID == 0x375A || item is BarredMetalDoor || item is SecretDungeonDoor)
                {
                    count++;
                    item.Delete();
                }
            }

            eable.Free();</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Generate.cs

<pre>foreach (Item item in eable)
            {
                if (item is XmlSpawner || item is Teleporter || item.ItemID == 0x375A || item is BarredMetalDoor || item is SecretDungeonDoor)
                {
                    count++;
                    item.Delete();
                }
            }

            eable.Free();</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\XmlQuestNPC.cs

<pre>case 0: shirt = new Doublet( GetRandomHue() );		break;
                    case 1: shirt = new Surcoat( GetRandomHue() );		break;
                    case 2: shirt = new Tunic( GetRandomHue() );		break;
                    case 3:</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\XmlQuestNPC.cs

<pre>case 0: shirt = new Doublet( GetRandomHue() );		break;
                    case 1: shirt = new Surcoat( GetRandomHue() );		break;
                    case 2: shirt = new Tunic( GetRandomHue() );		break;
                    case 3:</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Seventh\EnergyField.cs

<pre>private class InternalTimer : Timer
            {
                private readonly InternalItem m_Item;
                public InternalTimer(InternalItem item, TimeSpan duration)
                    : base(duration)
                {
                    this.Priority = TimerPriority.OneSecond;
                    this.m_Item = item;
                }

                protected override void OnTick()
                {
                    this.m_Item.Delete();
                }
            }</pre>

Fragment 2 in file Scripts\Spells\Third\WallOfStone.cs

<pre>private class InternalTimer : Timer
            {
                private readonly InternalItem m_Item;
                public InternalTimer(InternalItem item, TimeSpan duration)
                    : base(duration)
                {
                    this.Priority = TimerPriority.OneSecond;
                    this.m_Item = item;
                }

                protected override void OnTick()
                {
                    this.m_Item.Delete();
                }
            }</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Seventh\MassDispel.cs

<pre>{
                        Effects.SendLocationParticles(EffectItem.Create(m.Location, m.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                        Effects.PlaySound(m, m.Map, 0x201);

                        m.Delete();
                    }</pre>

Fragment 2 in file Scripts\Spells\Sixth\Dispel.cs

<pre>{
                            Effects.SendLocationParticles(EffectItem.Create(m.Location, m.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                            Effects.PlaySound(m, m.Map, 0x201);

                            m.Delete();
                        }</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Ultima\Map.cs

<pre>binmul.Write(tilelist[i].m_ID);
													binmul.Write(tilelist[i].m_X);
													binmul.Write(tilelist[i].m_Y);
													binmul.Write(tilelist[i].m_Z);</pre>

Fragment 2 in file Ultima\Map.cs

<pre>binmul.Write(tilelist[i].m_ID);
												binmul.Write(tilelist[i].m_X);
												binmul.Write(tilelist[i].m_Y);
												binmul.Write(tilelist[i].m_Z);</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);
            writer.Write((int)this.Type);
            writer.Write((int)_Resource);
        }</pre>

Fragment 2 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);
            writer.Write((int)this.Type);
            writer.Write((int)_Resource);
        }</pre>

Fragment 3 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);
            writer.Write((int)this.Type);
            writer.Write((int)_Resource);
        }</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Harrower\Harrower.cs

<pre>public bool IsEligible(Mobile m, Item Artifact)
        {
            return m.Player && m.Alive && m.InRange(this.Location, 32) && m.Backpack != null && m.Backpack.CheckHold(m, Artifact, false);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseRenowned.cs

<pre>public bool IsEligible(Mobile m, Item Artifact)
        {
            return m.Player && m.Alive && m.InRange(this.Location, 32) && m.Backpack != null && m.Backpack.CheckHold(m, Artifact, false);
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\BaseSABosses.cs

<pre>public bool IsEligible(Mobile m, Item Artifact)
        {
            return m.Player && m.Alive && m.InRange(this.Location, 32) && m.Backpack != null && m.Backpack.CheckHold(m, Artifact, false);
        }</pre>

## Duplicated Code. Size: 96

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Chivalry\SacredJourney.cs

<pre>public override void OnCast()
        {
            if (this.m_Entry == null)
                this.Caster.Target = new InternalTarget(this);
            else
                this.Effect(this.m_Entry.Location, this.m_Entry.Map, true, m_Entry.Galleon != null);
        }</pre>

Fragment 2 in file Scripts\Spells\Fourth\Recall.cs

<pre>public override void OnCast()
        {
            if (this.m_Entry == null)
                this.Caster.Target = new InternalTarget(this);
            else
                this.Effect(this.m_Entry.Location, this.m_Entry.Map, true, m_Entry.Galleon != null);
        }</pre>

Fragment 3 in file Scripts\Spells\Seventh\GateTravel.cs

<pre>public override void OnCast()
        {
            if (this.m_Entry == null)
                this.Caster.Target = new InternalTarget(this);
            else
                this.Effect(this.m_Entry.Location, this.m_Entry.Map, true, m_Entry.Galleon != null);
        }</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BaseAddonContainer.cs

<pre>if (c.NeedsWall)
                {
                    Point3D wall = c.WallPosition;

                    if (!BaseAddon.IsWall(p3D.X + wall.X, p3D.Y + wall.Y, p3D.Z + wall.Z, map))
                        return AddonFitResult.NoWall;
                }</pre>

Fragment 2 in file Scripts\Items\Addons\Craft Addons\CraftAddon.cs

<pre>if (c.NeedsWall)
                    {
                        Point3D wall = c.WallPosition;

                        if (!BaseAddon.IsWall(p3D.X + wall.X, p3D.Y + wall.Y, p3D.Z + wall.Z, map))
                            return AddonFitResult.NoWall;
                    }</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\HitchingPost.cs

<pre>pet.ControlTarget = null;
                    pet.ControlOrder = OrderType.Stay;
                    pet.Internalize();

                    pet.SetControlMaster(null);
                    pet.SummonMaster = null;

                    pet.IsStabled = true;

                    if (Core.SE)
                        pet.Loyalty = BaseCreature.MaxLoyalty; // Wonderfully happy</pre>

Fragment 2 in file Scripts\Items\Functional\ChickenCoop.cs

<pre>pet.ControlTarget = null;
                pet.ControlOrder = OrderType.Stay;
                pet.Internalize();

                pet.SetControlMaster(null);
                pet.SummonMaster = null;

                pet.IsStabled = true;

                if (Core.SE)
                    pet.Loyalty = BaseCreature.MaxLoyalty; // Wonderfully happy</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\Guild.cs

<pre>{
					from.SendGump(new PropertiesGump(from, g));

					if (NewGuildSystem && from.AccessLevel >= AccessLevel.GameMaster && from is PlayerMobile)
					{
						from.SendGump(new GuildInfoGump((PlayerMobile)from, g));
					}
				}</pre>

Fragment 2 in file Scripts\Misc\Guild.cs

<pre>{
					from.SendGump(new PropertiesGump(from, g));

					if (NewGuildSystem && from.AccessLevel >= AccessLevel.GameMaster && from is PlayerMobile)
					{
						from.SendGump(new GuildInfoGump((PlayerMobile)from, g));
					}
				}</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>this.RunFrom(this.m_Mobile.FocusMob);
                this.m_Mobile.FocusMob = null;

                if (this.m_Mobile.Poisoned && Utility.Random(0, 5) == 0)
                    new CureSpell(this.m_Mobile, null).Cast();</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>this.RunFrom(this.m_Mobile.FocusMob);
                this.m_Mobile.FocusMob = null;

                if (this.m_Mobile.Poisoned && Utility.Random(0, 5) == 0)
                    new CureSpell(this.m_Mobile, null).Cast();</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>List<AggressorInfo> aggressed = this.m_Mobile.Aggressed;
                List<AggressorInfo> aggressors = this.m_Mobile.Aggressors;

                Mobile active = null;
                double activePrio = 0.0;

                Mobile comb = this.m_Mobile.Combatant as Mobile;</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>List<AggressorInfo> aggressed = this.m_Mobile.Aggressed;
                List<AggressorInfo> aggressors = this.m_Mobile.Aggressors;

                Mobile active = null;
                double activePrio = 0.0;

                Mobile comb = this.m_Mobile.Combatant as Mobile;</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ExodusMinion.cs

<pre>this.Fame = 18000;
            this.Karma = -18000;
            this.VirtualArmor = 65;

            this.PackItem(new PowerCrystal());
            this.PackItem(new ArcaneGem());
            this.PackItem(new ClockworkAssembly());</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusMinionLord.cs

<pre>this.Fame = 18000;
            this.Karma = -18000;
            this.VirtualArmor = 65;

            this.PackItem(new PowerCrystal());
            this.PackItem(new ArcaneGem());
            this.PackItem(new ClockworkAssembly());</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>offset += 5 + height;
                this.m_Index += 1;

                if (this.m_Index < this.m_Collection.Donations.Count)
                    next = Math.Max(this.m_Collection.Donations[this.m_Index].Height, 20);
                else
                    next = 0;</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>offset += 5 + height;
                this.m_Index += 1;

                if (this.m_Index < this.m_Collection.Donations.Count)
                    next = Math.Max(this.m_Collection.Donations[this.m_Index].Height, 20);
                else
                    next = 0;</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Ethics\Evil\Powers\Blight.cs

<pre>Player from = state as Player;

            IPoint3D p = obj as IPoint3D;

            if (p == null)
                return;

            if (!this.CheckInvoke(from))
                return;

            bool powerFunctioned = false;

            SpellHelper.GetSurfaceTop(ref p);</pre>

Fragment 2 in file Scripts\Services\Ethics\Hero\Powers\Bless.cs

<pre>Player from = state as Player;

            IPoint3D p = obj as IPoint3D;

            if (p == null)
                return;

            if (!this.CheckInvoke(from))
                return;

            bool powerFunctioned = false;

            SpellHelper.GetSurfaceTop(ref p);</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Mobiles\Corgul\SoulboundPirateRaider.cs

<pre>AddItem(new LeatherArms());
            AddItem(new FancyShirt());
            AddItem(new ShortPants());
            AddItem(new Cutlass());
            AddItem(new Boots(Utility.RandomNeutralHue()));</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Mobiles\Corgul\SoulboundSwashbuckler.cs

<pre>AddItem(new LeatherArms());
            AddItem(new FancyShirt());
            AddItem(new ShortPants());
            AddItem(new Cutlass());
            AddItem(new Boots(Utility.RandomNeutralHue()));</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Items\QuestItems\WillemHartesHat.cs

<pre>TimeSpan t = TimeSpan.FromSeconds(this.m_Lifespan);

                int weeks = (int)t.Days / 7;
                int days = t.Days;
                int hours = t.Hours;
                int minutes = t.Minutes;</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\ExodusSacrificalDagger.cs

<pre>TimeSpan t = TimeSpan.FromSeconds(this.m_Lifespan);

                int weeks = (int)t.Days / 7;
                int days = t.Days;
                int hours = t.Hours;
                int minutes = t.Minutes;</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>if(hasbidspecific)
						{
							// You are still bidding on Stall ~2_NEWSTALL~.
							cliloc2 = 1150583;
							args2 = String.Format("{0}\t{1}", "", oldPlot.PlotDef.ID);
						}
						else if(hasbidnextavailable)
						{
							// You are still bidding on the next available stall.
							cliloc2 = 1150581;
							args2 = null;
						}
						else
						{
							cliloc2 = 1150541;
							args2 = "You have no active bids.";
						}</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>if(hasbidspecific)
						{
							// You are still bidding on Stall ~2_NEWSTALL~.
							cliloc2 = 1150583;
							args2 = String.Format("{0}\t{1}", "", oldPlot.PlotDef.ID);
						}
						else if(hasbidnextavailable)
						{
							// You are still bidding on the next available stall.
							cliloc2 = 1150581;
							args2 = null;
						}
						else
						{
							cliloc2 = 1150541;
							args2 = "You have no active bids.";
						}</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Gumps.cs

<pre>AddHtmlLocalized(10, 10, 200, 16, 1152531, Red, false, false); // The Void Pool
			AddHtmlLocalized(10, 30, 200, 16, Controller.Map == Map.Felucca ? 1012001 : 1012000, Red, false, false); // FEl/Tram</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Gumps.cs

<pre>AddHtmlLocalized(10, 10, 200, 16, 1152531, Red, false, false); // The Void Pool
            AddHtmlLocalized(10, 30, 200, 16, Controller.Map == Map.Felucca ? 1012001 : 1012000, Red, false, false); // FEl/Tram</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\SmeltersTalisman.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            writer.Write((int)Resource);
            writer.Write(Expires);
            writer.Write(UsesRemaining);
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\WoodsmanTalisman.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write(0);

            writer.Write((int)Resource);
            writer.Write(Expires);
            writer.Write(UsesRemaining);
        }</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>object relativeto = spawner;
										if (o is XmlAttachment)
										{
											relativeto = ((XmlAttachment)o).AttachedTo;
										}
										List<object> nearbylist = GetNearbyObjects(relativeto, targetname, targettype, typestr, range, searchcontainers, null);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>object relativeto = spawner;
								if (o is XmlAttachment)
								{
									relativeto = ((XmlAttachment)o).AttachedTo;
								}
								List<object> nearbylist = GetNearbyObjects(relativeto, targetname, targettype, typestr, range, searchcontainers, null);</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlGetAttachGump.cs

<pre>{

						SelectAll = !SelectAll;

						// dont allow individual selection with the selectall button selected
						if(m_SelectionList != null)
						{
							for(int i = 0; i < MaxEntries;i++)
							{
								if(i < m_SelectionList.Length){
									// only toggle the selection list entries for things that actually have entries
									m_SelectionList[i] = SelectAll;
								} else
								{
									break;
								}
							}
						}
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlEdit.cs

<pre>{

						SelectAll = !SelectAll;

						// dont allow individual selection with the selectall button selected
						if(m_SelectionList != null)
						{
							for(int i = 0; i < MaxEntries;i++)
							{
								if(i < m_SelectionList.Length)
								{
									// only toggle the selection list entries for things that actually have entries
									m_SelectionList[i] = SelectAll;
								} 
								else 
								{
									break;
								}
							}
						}
					}</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>if (AttachedTo is Item)
                            {
                                ((Item)AttachedTo).Name = (string)dr["Name"];
                            }
                            else
                                if (AttachedTo is Mobile)
                                {
                                    ((Mobile)AttachedTo).Name = (string)dr["Name"];
                                }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>if (AttachedTo is Item)
            {
                dr["Name"] = (string)((Item)AttachedTo).Name;
            }
            else
                if (AttachedTo is Mobile)
                {
                    dr["Name"] = (string)((Mobile)AttachedTo).Name;
                }</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public string Keywords
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.Keywords;
				}
				else
					return null;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.Keywords = value;
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public string Keywords
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.Keywords;
				}
				else
					return null;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.Keywords = value;
			}
		}</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public string Action
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.Action;
				}
				else
					return null;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.Action = value;
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public string Action
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.Action;
				}
				else
					return null;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.Action = value;
			}
		}</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public string Condition
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.Condition;
				}
				else
					return null;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.Condition = value;
			}

		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public string Condition
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.Condition;
				}
				else
					return null;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.Condition = value;
			}

		}</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public string Text
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.Text;
				}
				else
					return null;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.Text = value;
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public string Text
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.Text;
				}
				else
					return null;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.Text = value;
			}
		}</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public string DependsOn
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.DependsOn;
				}
				else
					return "-1";
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.DependsOn = value;
			}

		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public string DependsOn
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.DependsOn;
				}
				else
					return "-1";
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.DependsOn = value;
			}

		}</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public bool LockConversation
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.LockConversation;
				}
				else
					return false;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.LockConversation = value;
			}

		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public bool LockConversation
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.LockConversation;
				}
				else
					return false;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.LockConversation = value;
			}

		}</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseCreature.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public bool AllowNPCTrigger
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.AllowNPCTrigger;
				}
				else
					return false;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.AllowNPCTrigger = value;
			}

		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseVendor.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public bool AllowNPCTrigger
		{
			get
			{
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
				{
					return DialogAttachment.CurrentEntry.AllowNPCTrigger;
				}
				else
					return false;
			}
			set
			{ 
				if(DialogAttachment != null && DialogAttachment.CurrentEntry != null)
					DialogAttachment.CurrentEntry.AllowNPCTrigger = value;
			}

		}</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>this.m_RewardItem = reader.ReadItem();
						this.m_AutoReward = reader.ReadBool();
						this.m_CanSeeReward = reader.ReadBool();
						this.m_PlayerMade = reader.ReadBool();
						this.m_Creator = reader.ReadMobile() as PlayerMobile;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>this.m_RewardItem = reader.ReadItem();
                        this.m_AutoReward = reader.ReadBool();
                        this.m_CanSeeReward = reader.ReadBool();
                        this.m_PlayerMade = reader.ReadBool();
                        this.m_Creator = reader.ReadMobile() as PlayerMobile;</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>{
                    try
                    {
                        using (StreamWriter op = new StreamWriter("delta-recursion.log", true))
                        {
                            op.WriteLine("# {0}", DateTime.UtcNow);
                            op.WriteLine(new StackTrace());
                            op.WriteLine();
                        }
                    }
                    catch
                    { }
                }</pre>

Fragment 2 in file Server\Item.cs

<pre>{
                    try
                    {
                        using (StreamWriter op = new StreamWriter("delta-recursion.log", true))
                        {
                            op.WriteLine("# {0}", DateTime.UtcNow);
                            op.WriteLine(new StackTrace());
                            op.WriteLine();
                        }
                    }
                    catch
                    { }
                }</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>{
			if ((m_Index + 2) > m_Buffer.Length)
			{
				Flush();
			}

			m_Buffer[m_Index] = (byte)value;
			m_Buffer[m_Index + 1] = (byte)(value >> 8);
			m_Index += 2;
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>{
			if ((m_Index + 2) > m_Buffer.Length)
			{
				Flush();
			}

			m_Buffer[m_Index] = (byte)value;
			m_Buffer[m_Index + 1] = (byte)(value >> 8);
			m_Index += 2;
		}</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\EvilWanderingHealer.cs

<pre>this.AddItem(new GnarledStaff());

            this.SetSkill(SkillName.Camping, 80.0, 100.0);
            this.SetSkill(SkillName.Forensics, 80.0, 100.0);
            this.SetSkill(SkillName.SpiritSpeak, 80.0, 100.0);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\GargishWanderingHealer.cs

<pre>this.AddItem(new GnarledStaff());
            //AddItem( new GargishRobe(5) );

            this.SetSkill(SkillName.Camping, 80.0, 100.0);
            this.SetSkill(SkillName.Forensics, 80.0, 100.0);
            this.SetSkill(SkillName.SpiritSpeak, 80.0, 100.0);</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\WanderingHealer.cs

<pre>this.AddItem(new GnarledStaff());

            this.SetSkill(SkillName.Camping, 80.0, 100.0);
            this.SetSkill(SkillName.Forensics, 80.0, 100.0);
            this.SetSkill(SkillName.SpiritSpeak, 80.0, 100.0);</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public static void EndEffects(Mobile from)
        {
            if (IsUnderEffects(from))
            {
                Table[from].Stop();
                Table.Remove(from);

                from.SendLocalizedMessage(1151486); // Your mana is no longer being diverted.
                from.SendLocalizedMessage(1151483); // Your mana is no longer corrupted.
            }
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public static void EndEffects(Mobile from)
        {
            if (IsUnderEffects(from))
            {
                Table[from].Stop();
                Table.Remove(from);

                from.SendLocalizedMessage(1151486); // Your mana is no longer being diverted.
                from.SendLocalizedMessage(1151483); // Your mana is no longer corrupted.
            }
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public static void EndEffects(Mobile from)
        {
            if (IsUnderEffects(from))
            {
                Table[from].Stop();
                Table.Remove(from);

                from.SendLocalizedMessage(1151486); // Your mana is no longer being diverted.
                from.SendLocalizedMessage(1151483); // Your mana is no longer corrupted.
            }
        }</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\RuneBeetleCarapaceBase\ChainmailTunicBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;                     
            this.Hue = 1773;
            this.Attributes.BonusMana = 10;
            this.Attributes.RegenMana = 3;
            this.Attributes.LowerManaCost = 15;
            this.ArmorAttributes.LowerStatReq = 100;
            this.ArmorAttributes.MageArmor = 1;
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\RuneBeetleCarapaceBase\DragonBreastplateBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.Hue = 1773;
            this.Attributes.BonusMana = 10;
            this.Attributes.RegenMana = 3;
            this.Attributes.LowerManaCost = 15;
            this.ArmorAttributes.LowerStatReq = 100;
            this.ArmorAttributes.MageArmor = 1;
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\RuneBeetleCarapaceBase\GargishPlatemailChestBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.Hue = 1773;
            this.Attributes.BonusMana = 10;
            this.Attributes.RegenMana = 3;
            this.Attributes.LowerManaCost = 15;
            this.ArmorAttributes.LowerStatReq = 100;
            this.ArmorAttributes.MageArmor = 1;
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\RuneBeetleCarapaceBase\GargishStoneChestBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.Hue = 1773;
            this.Attributes.BonusMana = 10;
            this.Attributes.RegenMana = 3;
            this.Attributes.LowerManaCost = 15;
            this.ArmorAttributes.LowerStatReq = 100;
            this.ArmorAttributes.MageArmor = 1;
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\RuneBeetleCarapaceBase\PlatemailTunicBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.Hue = 1773;
            this.Attributes.BonusMana = 10;
            this.Attributes.RegenMana = 3;
            this.Attributes.LowerManaCost = 15;
            this.ArmorAttributes.LowerStatReq = 100;
            this.ArmorAttributes.MageArmor = 1;
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\RuneBeetleCarapaceBase\RingmailTunicBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.Hue = 1773;
            this.Attributes.BonusMana = 10;
            this.Attributes.RegenMana = 3;
            this.Attributes.LowerManaCost = 15;
            this.ArmorAttributes.LowerStatReq = 100;
            this.ArmorAttributes.MageArmor = 1;
        }</pre>

## Duplicated Code. Size: 95

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CleanUpBritannia\Items\CompassionVirtueTile.cs

<pre>public override void OnDoubleClick( Mobile from )
		{
			if ( IsChildOf( from.Backpack ) )
			{
				from.CloseGump( typeof( RewardOptionGump ) );
				from.SendGump( new RewardOptionGump( this ) );
			}
			else
				from.SendLocalizedMessage( 1062334 ); // This item must be in your backpack to be used.       	
		}</pre>

Fragment 2 in file Scripts\Services\CleanUpBritannia\Items\HonestyVirtueTile.cs

<pre>public override void OnDoubleClick( Mobile from )
		{
			if ( IsChildOf( from.Backpack ) )
			{
				from.CloseGump( typeof( RewardOptionGump ) );
				from.SendGump( new RewardOptionGump( this ) );
			}
			else
				from.SendLocalizedMessage( 1062334 ); // This item must be in your backpack to be used.       	
		}</pre>

Fragment 3 in file Scripts\Services\CleanUpBritannia\Items\HonorVirtueTile.cs

<pre>public override void OnDoubleClick( Mobile from )
		{
			if ( IsChildOf( from.Backpack ) )
			{
				from.CloseGump( typeof( RewardOptionGump ) );
				from.SendGump( new RewardOptionGump( this ) );
			}
			else
				from.SendLocalizedMessage( 1062334 ); // This item must be in your backpack to be used.       	
		}</pre>

Fragment 4 in file Scripts\Services\CleanUpBritannia\Items\HorseBarding.cs

<pre>public override void OnDoubleClick( Mobile from )
		{
			if ( IsChildOf( from.Backpack ) )
			{
				from.CloseGump( typeof( RewardOptionGump ) );
				from.SendGump( new RewardOptionGump( this ) );
			}
			else
				from.SendLocalizedMessage( 1062334 ); // This item must be in your backpack to be used.       	
		}</pre>

Fragment 5 in file Scripts\Services\CleanUpBritannia\Items\HumilityVirtueTile.cs

<pre>public override void OnDoubleClick( Mobile from )
		{
			if ( IsChildOf( from.Backpack ) )
			{
				from.CloseGump( typeof( RewardOptionGump ) );
				from.SendGump( new RewardOptionGump( this ) );
			}
			else
				from.SendLocalizedMessage( 1062334 ); // This item must be in your backpack to be used.       	
		}</pre>

Fragment 6 in file Scripts\Services\CleanUpBritannia\Items\JusticeVirtueTile.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.       	
        }</pre>

Fragment 7 in file Scripts\Services\CleanUpBritannia\Items\SacrificeVirtueTile.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.       	
        }</pre>

Fragment 8 in file Scripts\Services\CleanUpBritannia\Items\SpiritualityVirtueTile.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.       	
        }</pre>

Fragment 9 in file Scripts\Services\CleanUpBritannia\Items\ValorVirtueTile.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.       	
        }</pre>

Fragment 10 in file Scripts\Services\ViceVsVirtue\Items\Rewards\Tiles\CovetousTile.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.       	
        }</pre>

Fragment 11 in file Scripts\Services\ViceVsVirtue\Items\Rewards\Tiles\DeceitTIle.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.       	
        }</pre>

Fragment 12 in file Scripts\Services\ViceVsVirtue\Items\Rewards\Tiles\DespiseTile.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.       	
        }</pre>

Fragment 13 in file Scripts\Services\ViceVsVirtue\Items\Rewards\Tiles\DestardTile.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.       	
        }</pre>

Fragment 14 in file Scripts\Services\ViceVsVirtue\Items\Rewards\Tiles\HythlothTIle.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.       	
        }</pre>

Fragment 15 in file Scripts\Services\ViceVsVirtue\Items\Rewards\Tiles\PrideTile.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.       	
        }</pre>

Fragment 16 in file Scripts\Services\ViceVsVirtue\Items\Rewards\Tiles\ShameTile.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.       	
        }</pre>

Fragment 17 in file Scripts\Services\ViceVsVirtue\Items\Rewards\Tiles\WrongTile.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.CloseGump(typeof(RewardOptionGump));
                from.SendGump(new RewardOptionGump(this));
            }
            else
                from.SendLocalizedMessage(1062334); // This item must be in your backpack to be used.       	
        }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>this.AddHtmlLocalized(5, y, 150, 25, cat.LocNumber, true, false);
                this.AddButton(155, y, 4005, 4007, 0, GumpButtonType.Page, i + 1);
                y += 25;</pre>

Fragment 2 in file Scripts\Gumps\PolymorphGump.cs

<pre>this.AddHtmlLocalized(5, y, 150, 25, cat.LocNumber, true, false);
                this.AddButton(155, y, 4005, 4007, 0, GumpButtonType.Page, i + 1);
                y += 25;</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\PropsGump.cs

<pre>public static string ValueToString(object obj, PropertyInfo prop)
		{
			try
			{
				return ValueToString(prop.GetValue(obj, null));
			}
			catch (Exception e)
			{
				return String.Format("!{0}!", e.GetType());
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlPropsGump.cs

<pre>public static string ValueToString( object obj, PropertyInfo prop )
		{
			try
			{
				return ValueToString( prop.GetValue( obj, null ) );
			}
			catch ( Exception e )
			{
				return String.Format( "!{0}!", e.GetType() );
			}
		}</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Distillery.cs

<pre>public override void OnComponentUsed(AddonComponent component, Mobile from)
        {
            BaseHouse house = BaseHouse.FindHouseAt(component);

            if (house == null || house.IsCoOwner(from))
                from.SendGump(new DistillationGump(from));
        }</pre>

Fragment 2 in file Scripts\Items\Addons\Distillery.cs

<pre>public override void OnComponentUsed(AddonComponent component, Mobile from)
        {
            BaseHouse house = BaseHouse.FindHouseAt(component);

            if (house == null || house.IsCoOwner(from))
                from.SendGump(new DistillationGump(from));
        }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\PileOfGlacialSnow.cs

<pre>private class InternalTimer : Timer
        {
            private readonly Mobile m_From;
            public InternalTimer(Mobile from)
                : base(TimeSpan.FromSeconds(5.0))
            {
                this.m_From = from;
            }

            protected override void OnTick()
            {
                this.m_From.EndAction(typeof(SnowPile));
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\SnowPile.cs

<pre>private class InternalTimer : Timer
        {
            private readonly Mobile m_From;
            public InternalTimer(Mobile from)
                : base(TimeSpan.FromSeconds(5.0))
            {
                this.m_From = from;
            }

            protected override void OnTick()
            {
                this.m_From.EndAction(typeof(SnowPile));
            }
        }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>Mobile m = (Mobile)parent;
                string modName = this.Serial.ToString();

                m.RemoveStatMod(modName + "Str");
                m.RemoveStatMod(modName + "Dex");
                m.RemoveStatMod(modName + "Int");</pre>

Fragment 2 in file Scripts\Items\Tools\FishingPole.cs

<pre>Mobile m = (Mobile)parent;

                string modName = this.Serial.ToString();

                m.RemoveStatMod(modName + "Str");
                m.RemoveStatMod(modName + "Dex");
                m.RemoveStatMod(modName + "Int");</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\Notoriety.cs

<pre>target.Kills >= 5 || (body.IsMonster && IsSummoned(target.Owner as BaseCreature)) || (target.Owner is BaseCreature && (((BaseCreature)target.Owner).AlwaysMurderer || ((BaseCreature)target.Owner).IsAnimatedDead))</pre>

Fragment 2 in file Scripts\Misc\Notoriety.cs

<pre>target.Kills >= 5 || (body.IsMonster && IsSummoned(target.Owner as BaseCreature)) || (target.Owner is BaseCreature && (((BaseCreature)target.Owner).AlwaysMurderer || ((BaseCreature)target.Owner).IsAnimatedDead))</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Neira.cs

<pre>public override void Deserialize(GenericReader reader)
            {
                base.Deserialize(reader);

                int version = reader.ReadInt();

                this.m_Rider = reader.ReadMobile();

                if (this.m_Rider == null)
                    this.Delete();
            }</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\BaseFactionGuard.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Rider = reader.ReadMobile();

            if (this.m_Rider == null)
                this.Delete();
        }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseRenowned.cs

<pre>public Item GetArtifact()
        {
            double random = Utility.RandomDouble();
            if (0.05 >= random)
                return this.CreateArtifact(this.UniqueSAList);
            else if (0.15 >= random)
                return this.CreateArtifact(this.SharedSAList);

            return null;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseSABosses.cs

<pre>public Item GetArtifact()
        {
            double random = Utility.RandomDouble();
            if (0.05 >= random)
                return this.CreateArtifact(this.UniqueSAList);
            else if (0.15 >= random)
                return this.CreateArtifact(this.SharedSAList);

            return null;
        }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GargoyleDestroyer.cs

<pre>public override void OnGotMeleeAttack(Mobile attacker)
        {
            base.OnGotMeleeAttack(attacker);

            if (attacker != null && attacker.Alive && attacker.Weapon is BaseRanged && 0.4 > Utility.RandomDouble())
            {
                this.ThrowHatchet(attacker);
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GargoyleGuardian.cs

<pre>public override void OnGotMeleeAttack(Mobile attacker)
        {
            base.OnGotMeleeAttack(attacker);

            if (attacker != null && attacker.Alive && attacker.Weapon is BaseRanged && 0.4 > Utility.RandomDouble())
            {
                this.ThrowHatchet(attacker);
            }
        }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Sandals(this.GetShoeHue()));
            this.AddItem(new Robe(Utility.RandomYellowHue()));
            this.AddItem(new GnarledStaff());
        }</pre>

Fragment 2 in file Scripts\Quests\Escortables.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Sandals(this.GetShoeHue()));
            this.AddItem(new Robe(Utility.RandomYellowHue()));
            this.AddItem(new GnarledStaff());
        }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Gorrow.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = false;
            this.Race = Race.Human;

            this.Hue = 0x8412;
            this.HairItemID = 0x2047;
            this.HairHue = 0x465;
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Neville.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = false;
            this.Race = Race.Human;

            this.Hue = 0x8412;
            this.HairItemID = 0x2047;
            this.HairHue = 0x465;
        }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Kia.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = true;
            this.Race = Race.Human;

            this.Hue = 0x8418;
            this.HairItemID = 0x2046;
            this.HairHue = 0x466;
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Sutek.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = true;
            this.Race = Race.Human;

            this.Hue = 0x8418;
            this.HairItemID = 0x2046;
            this.HairHue = 0x466;
        }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Percolem.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = false;
            this.Race = Race.Human;

            this.Hue = 0x840C;
            this.HairItemID = 0x203C;
            this.HairHue = 0x3B3;
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Petrus.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = false;
            this.Race = Race.Human;

            this.Hue = 0x840C;
            this.HairItemID = 0x203C;
            this.HairHue = 0x3B3;
        }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Deeds.cs

<pre>if (ip is Item)
                    ip = ((Item)ip).GetWorldTop();

                Point3D p = new Point3D(ip);

                Region reg = Region.Find(new Point3D(p), from.Map);</pre>

Fragment 2 in file Scripts\Multis\HousePlacementTool.cs

<pre>if (ip is Item)
                    ip = ((Item)ip).GetWorldTop();

                Point3D p = new Point3D(ip);

                Region reg = Region.Find(new Point3D(p), from.Map);</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\Books\BOBGump.cs

<pre>if (e.RequireExceptional)
                            this.AddHtmlLocalized(235, y, 80, 20, 1060636, LabelColor, false, false); // exceptional
                        else
                            this.AddHtmlLocalized(235, y, 80, 20, 1011542, LabelColor, false, false); // normal</pre>

Fragment 2 in file Scripts\Services\BulkOrders\Books\BOBGump.cs

<pre>if (e.RequireExceptional)
                        this.AddHtmlLocalized(235, y, 80, 20, 1060636, LabelColor, false, false); // exceptional
                    else
                        this.AddHtmlLocalized(235, y, 80, 20, 1011542, LabelColor, false, false); // normal</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\DuelContext.cs

<pre>if (this.m_Mobile.Map == Map.Internal)
                {
                    this.m_Mobile.LogoutLocation = this.m_Location;
                    this.m_Mobile.LogoutMap = this.m_Facet;
                }
                else
                {
                    this.m_Mobile.Location = this.m_Location;
                    this.m_Mobile.Map = this.m_Facet;
                }</pre>

Fragment 2 in file Scripts\Services\ConPVP\DuelContext.cs

<pre>if (this.m_Mobile.Map == Map.Internal)
                {
                    this.m_Facet = this.m_Mobile.LogoutMap;
                    this.m_Location = this.m_Mobile.LogoutLocation;
                }
                else
                {
                    this.m_Facet = this.m_Mobile.Map;
                    this.m_Location = this.m_Mobile.Location;
                }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>m_Plot = plot;
			m_Commodity = commodity;

            AddHtmlLocalized(195, 5, 150, 18, 1150385, RedColor16, false, false);     // New Magincia Bazaar
            AddHtmlLocalized(217, 40, 150, 18, 1150386, RedColor16, false, false);    // Stall Leasing</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>m_Plot = plot;
			m_Commodity = commodity;

            AddHtmlLocalized(195, 5, 150, 18, 1150385, RedColor16, false, false);     // New Magincia Bazaar
            AddHtmlLocalized(217, 40, 150, 18, 1150386, RedColor16, false, false);    // Stall Leasing</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>m_Broker = broker;
			m_Index = index;

			AddHtmlLocalized(215, 10, 200, 18, 1150311, RedColor16, false, false); // Animal Broker
			AddHtmlLocalized(145, 50, 250, 18, 1150337, RedColor16, false, false); // ADD PET TO BROKER INVENTORY</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>m_Broker = broker;
			m_Index = index;

            AddHtmlLocalized(215, 10, 200, 18, 1150311, RedColor16, false, false); // Animal Broker
            AddHtmlLocalized(145, 50, 250, 18, 1150337, RedColor16, false, false); // ADD PET TO BROKER INVENTORY</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\VeteranRewards\CrystalPortals\CorruptedCrystalPortal.cs

<pre>if (loc == Point3D.Zero || map == null || map == Map.Internal)
			{
				return;
			}

			e.Handled = true;

			if (ValidateUse(e.Mobile, true))
			{
				OnTeleport(e.Mobile, loc, map);
			}</pre>

Fragment 2 in file Scripts\Services\VeteranRewards\CrystalPortals\CrystalPortal.cs

<pre>if (loc == Point3D.Zero || map == null || map == Map.Internal)
			{
				return;
			}

			e.Handled = true;

			if (ValidateUse(e.Mobile, true))
			{
				OnTeleport(e.Mobile, loc, map);
			}</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\VeteranRewards\RewardSystem.cs

<pre>{
                            if (i > 0 && !HasAccess(from, list, out ts))
                            {
                                from.SendLocalizedMessage(1008126, true, Math.Ceiling(ts.TotalDays / 30.0).ToString()); // Your account is not old enough to use this item. Months until you can use this item : 
                                return false;
                            }

                            return true;
                        }</pre>

Fragment 2 in file Scripts\Services\VeteranRewards\RewardSystem.cs

<pre>{
                                if (i > 0 && !HasAccess(from, list, out ts))
                                {
                                    from.SendLocalizedMessage(1008126, true, Math.Ceiling(ts.TotalDays / 30.0).ToString()); // Your account is not old enough to use this item. Months until you can use this item : 
                                    return false;
                                }

                                return true;
                            }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (itemTarget == null) break;

												remaining = itemTarget.Amount - quantity;

												if (remaining <= 0)
												{
													taken = itemTarget.Amount;
													totaltaken += taken;

													itemTarget.Delete();
												}
												else
												{
													totaltaken += quantity;
													itemTarget.Amount = remaining;
												}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (itemTarget == null) break;

												remaining = itemTarget.Amount - quantity;
												if (remaining <= 0)
												{
													taken = itemTarget.Amount;
													totaltaken += taken;

													itemTarget.Delete();

												}
												else
												{
													totaltaken += quantity;
													itemTarget.Amount = remaining;
												}</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>{
			if (map == null || map == Map.Internal) return false;
			// check the location relative to the current map to make sure it is valid
			if (location.X < 0 || location.X > map.Width || location.Y < 0 || location.Y > map.Height)
			{
				return false;
			}
			return true;
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>{
			if (map == null || map == Map.Internal) return false;
			// check the location relative to the current map to make sure it is valid
			if (location.X < 0 || location.X > map.Width || location.Y < 0 || location.Y > map.Height)
			{
				return false;
			}
			return true;
		}</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write((short)explodeEffect);
			m_Stream.Write((short)explodeSound);
			m_Stream.Write(serial);
			m_Stream.Write((byte)layer);
			m_Stream.Write((short)unknown);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write((short)explodeEffect);
			m_Stream.Write((short)explodeSound);
			m_Stream.Write(serial);
			m_Stream.Write((byte)layer);
			m_Stream.Write((short)unknown);</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Server\Utility.cs

<pre>output.Write(byteIndex.ToString("X4"));
				output.Write("   ");
				output.Write(bytes.ToString());
				output.Write("  ");
				output.WriteLine(chars.ToString());</pre>

Fragment 2 in file Server\Utility.cs

<pre>output.Write(byteIndex.ToString("X4"));
				output.Write("   ");
				output.Write(bytes.ToString());
				output.Write("  ");
				output.WriteLine(chars.ToString());</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>{
                    if (this.RequiredRace == Race.Elf)
                        from.SendLocalizedMessage(1072203); // Only Elves may use this.
                    else if (this.RequiredRace == Race.Gargoyle)
                        from.SendLocalizedMessage(1111707); // Only gargoyles can wear this.
                    else
                        from.SendMessage("Only {0} may use this.", this.RequiredRace.PluralName);

                    return false;
                }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>{
                    if (this.RequiredRace == Race.Elf)
                        from.SendLocalizedMessage(1072203); // Only Elves may use this.
                    else if (this.RequiredRace == Race.Gargoyle)
                        from.SendLocalizedMessage(1111707); // Only gargoyles can wear this.
                    else
                        from.SendMessage("Only {0} may use this.", this.RequiredRace.PluralName);

                    return false;
                }</pre>

Fragment 3 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>{
                    if (this.RequiredRace == Race.Elf)
                        from.SendLocalizedMessage(1072203); // Only Elves may use this.
                    else if (this.RequiredRace == Race.Gargoyle)
                        from.SendLocalizedMessage(1111707); // Only gargoyles can wear this.
                    else
                        from.SendMessage("Only {0} may use this.", this.RequiredRace.PluralName);

                    return false;
                }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Gnaw.cs

<pre>Tamable = false;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Named\Grobu.cs

<pre>Tamable = false;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 3 in file Scripts\Mobiles\Named\Swoop.cs

<pre>Tamable = false;

            for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Items\FactionStone.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.Faction = Faction.ReadReference(reader);
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Services\Factions\Items\JoinStone.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.Faction = Faction.ReadReference(reader);
                        break;
                    }
            }
        }</pre>

Fragment 3 in file Scripts\Services\Factions\Mobiles\FactionWarHorse.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.Faction = Faction.ReadReference(reader);
                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Fourth\ManaDrain.cs

<pre>SpellHelper.Turn(this.Caster, m);

                SpellHelper.CheckReflect((int)this.Circle, this.Caster, ref m);

                if (m.Spell != null)
                    m.Spell.OnCasterHurt();

                m.Paralyzed = false;</pre>

Fragment 2 in file Scripts\Spells\Seventh\ManaVampire.cs

<pre>SpellHelper.Turn(this.Caster, m);

                SpellHelper.CheckReflect((int)this.Circle, this.Caster, ref m);

                if (m.Spell != null)
                    m.Spell.OnCasterHurt();

                m.Paralyzed = false;</pre>

Fragment 3 in file Scripts\Spells\Third\Poison.cs

<pre>SpellHelper.Turn(this.Caster, m);

                SpellHelper.CheckReflect((int)this.Circle, this.Caster, ref m);

                if (m.Spell != null)
                    m.Spell.OnCasterHurt();

                m.Paralyzed = false;</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write(serial);
			m_Stream.Write((short)graphic);
			m_Stream.Write((byte)type);
			m_Stream.Write((short)hue);
			m_Stream.Write((short)font);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write(serial);
			m_Stream.Write((short)graphic);
			m_Stream.Write((byte)type);
			m_Stream.Write((short)hue);
			m_Stream.Write((short)font);</pre>

Fragment 3 in file Server\Network\Packets.cs

<pre>m_Stream.Write(serial);
			m_Stream.Write((short)graphic);
			m_Stream.Write((byte)type);
			m_Stream.Write((short)hue);
			m_Stream.Write((short)font);</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Server\Random.cs

<pre>private void _GetBytes(byte[] b)
		{
			int c = b.Length;

			CheckSwap(c);

			lock (_sync)
			{
				Buffer.BlockCopy(_Working, _Index, b, 0, c);
				_Index += c;
			}
		}</pre>

Fragment 2 in file Server\Random.cs

<pre>private void _GetBytes(byte[] b)
		{
			int c = b.Length;

			CheckSwap(c);

			lock (_sync)
			{
				Buffer.BlockCopy(_Working, _Index, b, 0, c);
				_Index += c;
			}
		}</pre>

Fragment 3 in file Server\Random.cs

<pre>private void _GetBytes(byte[] b)
		{
			int c = b.Length;

			CheckSwap(c);

			lock (_sync)
			{
				Buffer.BlockCopy(_Working, _Index, b, 0, c);
				_Index += c;
			}
		}</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Banner.cs

<pre>bool north = BaseAddon.IsWall(p3d.X, p3d.Y - 1, p3d.Z, map);
                                bool west = BaseAddon.IsWall(p3d.X - 1, p3d.Y, p3d.Z, map);</pre>

Fragment 2 in file Scripts\Items\Addons\DecorativeShield.cs

<pre>bool north = BaseAddon.IsWall(p3d.X, p3d.Y - 1, p3d.Z, map);
                                bool west = BaseAddon.IsWall(p3d.X - 1, p3d.Y, p3d.Z, map);</pre>

Fragment 3 in file Scripts\Items\Addons\FlamingHead.cs

<pre>bool north = BaseAddon.IsWall(p3d.X, p3d.Y - 1, p3d.Z, map);
                                bool west = BaseAddon.IsWall(p3d.X - 1, p3d.Y, p3d.Z, map);</pre>

Fragment 4 in file Scripts\Items\Addons\HangingSkeleton.cs

<pre>bool north = BaseAddon.IsWall(p3d.X, p3d.Y - 1, p3d.Z, map);
                                bool west = BaseAddon.IsWall(p3d.X - 1, p3d.Y, p3d.Z, map);</pre>

Fragment 5 in file Scripts\Services\CleanUpBritannia\Items\DragonHead.cs

<pre>bool north = BaseAddon.IsWall(p3d.X, p3d.Y - 1, p3d.Z, map);
                                bool west = BaseAddon.IsWall(p3d.X - 1, p3d.Y, p3d.Z, map);</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\DecorativeShardShields.cs

<pre>bool north = BaseAddon.IsWall(p3d.X, p3d.Y - 1, p3d.Z, map);
                                bool west = BaseAddon.IsWall(p3d.X - 1, p3d.Y, p3d.Z, map);</pre>

## Duplicated Code. Size: 94

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Enrico.cs

<pre>this.Donations.Add(new CollectionItem(typeof(BrownBook), 0xFEF, 1074906, 0x0, 3));
            this.Donations.Add(new CollectionItem(typeof(TanBook), 0xFF0, 1074906, 0x0, 3));</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Filbert.cs

<pre>this.Donations.Add(new CollectionItem(typeof(BrownBook), 0xFEF, 1074906, 0x0, 3));
            this.Donations.Add(new CollectionItem(typeof(TanBook), 0xFF0, 1074906, 0x0, 3));</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Joy.cs

<pre>this.Donations.Add(new CollectionItem(typeof(BrownBook), 0xFEF, 1074906, 0x0, 3));
            this.Donations.Add(new CollectionItem(typeof(TanBook), 0xFF0, 1074906, 0x0, 3));</pre>

Fragment 4 in file Scripts\Mobiles\NPCs\Odell.cs

<pre>this.Donations.Add(new CollectionItem(typeof(BrownBook), 0xFEF, 1074906, 0x0, 3));
            this.Donations.Add(new CollectionItem(typeof(TanBook), 0xFF0, 1074906, 0x0, 3));</pre>

Fragment 5 in file Scripts\Mobiles\NPCs\Sam.cs

<pre>this.Donations.Add(new CollectionItem(typeof(BrownBook), 0xFEF, 1074906, 0x0, 3));
            this.Donations.Add(new CollectionItem(typeof(TanBook), 0xFF0, 1074906, 0x0, 3));</pre>

Fragment 6 in file Scripts\Mobiles\NPCs\Zorda.cs

<pre>this.Donations.Add(new CollectionItem(typeof(BrownBook), 0xFEF, 1074906, 0x0, 3));
            this.Donations.Add(new CollectionItem(typeof(TanBook), 0xFF0, 1074906, 0x0, 3));</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\FillableContainers.cs

<pre>new FillableEntry[]
            {
                new FillableEntry(12, Loot.ArmorTypes),
                new FillableEntry(8, Loot.WeaponTypes),
                new FillableEntry(3, Loot.ShieldTypes),
                new FillableEntry(1, typeof(Arrow))
            }</pre>

Fragment 2 in file Scripts\Items\Containers\FillableContainers.cs

<pre>new FillableEntry[]
            {
                new FillableEntry(12, Loot.ArmorTypes),
                new FillableEntry(8, Loot.WeaponTypes),
                new FillableEntry(3, Loot.ShieldTypes),
                new FillableEntry(1, typeof(Arrow))
            }</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>{
                if (this.m_Mobile.Target != null)
                    this.m_Mobile.Target.Cancel(this.m_Mobile, TargetCancelType.Canceled);

                new TeleportSpell(this.m_Mobile, null).Cast();

                this.m_Mobile.DebugSay("I am stuck, I'm going to try teleporting away");
            }</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>{
                if (this.m_Mobile.Target != null)
                    this.m_Mobile.Target.Cancel(this.m_Mobile, TargetCancelType.Canceled);

                new TeleportSpell(this.m_Mobile, null).Cast();

                this.m_Mobile.DebugSay("I am stuck, I'm going to try teleporting away");
            }</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Ninja.cs

<pre>int hairHue = Utility.RandomNondyedHue();

            Utility.AssignRandomHair(this, hairHue);

            if (Utility.Random(7) != 0)
                Utility.AssignRandomFacialHair(this, hairHue);

            this.PackGold(250, 300);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Samurai.cs

<pre>int hairHue = Utility.RandomNondyedHue();

            Utility.AssignRandomHair(this, hairHue);

            if (Utility.Random(7) != 0)
                Utility.AssignRandomFacialHair(this, hairHue);

            this.PackGold(250, 300);</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Ladder.cs

<pre>writer.WriteEncodedInt((int)this.m_Entries.Count);

            for (int i = 0; i < this.m_Entries.Count; ++i)
                ((LadderEntry)this.m_Entries[i]).Serialize(writer);</pre>

Fragment 2 in file Scripts\Services\ConPVP\Preferences.cs

<pre>writer.WriteEncodedInt((int)this.m_Entries.Count);

            for (int i = 0; i < this.m_Entries.Count; ++i)
                ((PreferencesEntry)this.m_Entries[i]).Serialize(writer);</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Gumps\FinanceGump.cs

<pre>this.AddHtmlLocalized(55, 360, 200, 25, 1011441, false, false); // EXIT
            this.AddButton(20, 360, 4005, 4007, 0, GumpButtonType.Reply, 0);
            #endregion

            #region Change Prices
            this.AddPage(2);</pre>

Fragment 2 in file Scripts\Services\Factions\Gumps\SheriffGump.cs

<pre>this.AddHtmlLocalized(55, 360, 200, 25, 1011441, false, false); // Exit
            this.AddButton(20, 360, 4005, 4007, 0, GumpButtonType.Reply, 0);
            #endregion

            #region Finances
            this.AddPage(2);</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\FireCasino\DiceGames.cs

<pre>Winner = true;
                OnWin();
                Dealer.PrivateOverheadMessage(MessageType.Regular, 0x35, 1153377, String.Format("{0}\t{1}", Player.Name, winnings.ToString(CultureInfo.GetCultureInfo("en-US"))), Player.NetState); // *pays out ~2_VAL~ chips to ~1_NAME~*</pre>

Fragment 2 in file Scripts\Services\FireCasino\DiceGames.cs

<pre>Winner = true;
                    OnWin();

                    Dealer.PrivateOverheadMessage(MessageType.Regular, 0x35, 1153377, String.Format("{0}\t{1}", Player.Name, winnings.ToString(CultureInfo.GetCultureInfo("en-US"))), Player.NetState); // *pays out ~2_VAL~ chips to ~1_NAME~*</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseEscortable.cs

<pre>Hue = Utility.RandomSkinHue();

			switch(gender)
            {
                case -1: this.Female = Utility.RandomBool(); break;
                case 0: this.Female = false; break;
                case 1: this.Female = true; break;
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\XmlQuestNPC.cs

<pre>Hue = Utility.RandomSkinHue();

            switch(gender)
            {
                case -1: this.Female = Utility.RandomBool(); break;
                case 0: this.Female = false; break;
                case 1: this.Female = true; break;
            }</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetListOptionGump.cs

<pre>if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );

			if ( button != 0 )
				AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, button, GumpButtonType.Reply, 0 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetTimeSpanGump.cs

<pre>if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );

			if ( button != 0 )
				AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, button, GumpButtonType.Reply, 0 );</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>for(int x=ToDelete.Count - 1; x>=0; --x)//BaseXmlSpawner.KeywordTag i in ToDelete)
			{
				BaseXmlSpawner.KeywordTag i = ToDelete[x];
				if (i != null && !i.Deleted)
				{
					i.Delete();
				}
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>for(int x=ToDelete.Count - 1; x>=0; --x)//each (BaseXmlSpawner.KeywordTag i in ToDelete)
			{
				BaseXmlSpawner.KeywordTag i = ToDelete[x];
				if (i != null && !i.Deleted)
				{
					i.Delete();
				}
			}</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Alchemy, 5.0 );
                        break;
                    }
                }
                return true;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Alchemy, 5.0 );
                        break;
                    }
                }
                return true;</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Anatomy, 5.0 );
                        break;
                    }
                }
                return true;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Anatomy, 5.0 );
                        break;
                    }
                }
                return true;</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.AnimalLore, 5.0 );
                        break;
                    }
                }
                return true;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.AnimalLore, 5.0 );
                        break;
                    }
                }
                return true;</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.ItemID, 5.0 );
                        break;
                    }
                }
                return true;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.ItemID, 5.0 );
                        break;
                    }
                }
                return true;</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.ArmsLore, 5.0 );
                        break;
                    }
                }
                return true;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.ArmsLore, 5.0 );
                        break;
                    }
                }
                return true;</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Parry, 5.0 );
                        break;
                    }
                }
                return true;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Parry, 5.0 );
                        break;
                    }
                }
                return true;</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Blacksmith, 5.0 );
                        break;
                    }
                }
                return true;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Blacksmith, 5.0 );
                        break;
                    }
                }
                return true;</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Fletching, 5.0 );
                        break;
                    }
                }
                return true;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Fletching, 5.0 );
                        break;
                    }
                }
                return true;</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Peacemaking, 5.0 );
                        break;
                    }
                }
                return true;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Peacemaking, 5.0 );
                        break;
                    }
                }
                return true;</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Healing, 5.0 );
                        break;
                    }
                }
                return true;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\XmlSocketItems\Augments\Stones.cs

<pre>for(int i =0; i < 5; i++)
                {
                    if(a.SkillBonuses.GetBonus(i) == 0)
                    {
                        a.SkillBonuses.SetValues( i, SkillName.Healing, 5.0 );
                        break;
                    }
                }
                return true;</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Eighth\WaterElemental.cs

<pre>public override bool CheckCast()
        {
            if (!base.CheckCast())
                return false;

            if ((this.Caster.Followers + 3) > this.Caster.FollowersMax)
            {
                this.Caster.SendLocalizedMessage(1049645); // You have too many followers to summon that creature.
                return false;
            }

            return true;
        }</pre>

Fragment 2 in file Scripts\Spells\Necromancy\VengefulSpirit.cs

<pre>public override bool CheckCast()
        {
            if (!base.CheckCast())
                return false;

            if ((this.Caster.Followers + 3) > this.Caster.FollowersMax)
            {
                this.Caster.SendLocalizedMessage(1049645); // You have too many followers to summon that creature.
                return false;
            }

            return true;
        }</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Ninjitsu\AnimalForm.cs

<pre>{
						if (Morph(Caster, GetLastAnimalForm(Caster)) == MorphResult.Fail)
						{
							DoFizzle();
						}
						else
						{
							Caster.FixedParticles(0x3728, 10, 13, 2023, EffectLayer.Waist);
							Caster.Mana -= mana;
						}
					}</pre>

Fragment 2 in file Scripts\Spells\Ninjitsu\AnimalForm.cs

<pre>{
					if (Morph(Caster, GetLastAnimalForm(Caster)) == MorphResult.Fail)
					{
						DoFizzle();
					}
					else
					{
						Caster.FixedParticles(0x3728, 10, 13, 2023, EffectLayer.Waist);
						Caster.Mana -= mana;
					}
				}</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\Cotton.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(502655); // What spinning wheel do you wish to spin this on?
                from.Target = new PickWheelTarget(this);
            }
            else
            {
                from.SendLocalizedMessage(1042001); // That must be in your pack for you to use it.
            }
        }</pre>

Fragment 2 in file Scripts\Items\Resource\Flax.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(502655); // What spinning wheel do you wish to spin this on?
                from.Target = new PickWheelTarget(this);
            }
            else
            {
                from.SendLocalizedMessage(1042001); // That must be in your pack for you to use it.
            }
        }</pre>

Fragment 3 in file Scripts\Items\Resource\Wool.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(502655); // What spinning wheel do you wish to spin this on?
                from.Target = new PickWheelTarget(this);
            }
            else
            {
                from.SendLocalizedMessage(1042001); // That must be in your pack for you to use it.
            }
        }</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>IPooledEnumerable rangelist = null;
						if (refitem != null && !refitem.Deleted)
						{
							rangelist = refitem.GetMobilesInRange(range);
						}
						else if (refmob != null && !refmob.Deleted)
						{
							rangelist = refmob.GetMobilesInRange(range);
						}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>IPooledEnumerable rangelist = null;
						if (refitem != null && !refitem.Deleted)
						{
							rangelist = refitem.GetMobilesInRange(range);

						}
						else if (refmob != null && !refmob.Deleted)
						{

							rangelist = refmob.GetMobilesInRange(range);

						}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>IPooledEnumerable rangelist = null;
						if (refitem != null && !refitem.Deleted)
						{
							rangelist = refitem.GetMobilesInRange(range);
						}
						else if (refmob != null && !refmob.Deleted)
						{
							rangelist = refmob.GetMobilesInRange(range);
						}</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>for (int i = 0; i < so.SpawnedObjects.Count; ++i)
				{
					object o = so.SpawnedObjects[i];

					if (o is Item || o is Mobile) deletelist.Add(o);

				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>for (int i = 0; i < so.SpawnedObjects.Count; ++i)
			{
				object o = so.SpawnedObjects[i];

				if (o is Item || o is Mobile) deletelist.Add(o);

			}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>for (int i = 0; i < so.SpawnedObjects.Count; ++i)
				{
					object o = so.SpawnedObjects[i];

					if (o is Item || o is Mobile) deletelist.Add(o);

				}</pre>

## Duplicated Code. Size: 93

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Eighth\AirElemental.cs

<pre>public override bool CheckCast()
        {
            if (!base.CheckCast())
                return false;

            if ((this.Caster.Followers + 2) > this.Caster.FollowersMax)
            {
                this.Caster.SendLocalizedMessage(1049645); // You have too many followers to summon that creature.
                return false;
            }

            return true;
        }</pre>

Fragment 2 in file Scripts\Spells\Eighth\EarthElemental.cs

<pre>public override bool CheckCast()
        {
            if (!base.CheckCast())
                return false;

            if ((this.Caster.Followers + 2) > this.Caster.FollowersMax)
            {
                this.Caster.SendLocalizedMessage(1049645); // You have too many followers to summon that creature.
                return false;
            }

            return true;
        }</pre>

Fragment 3 in file Scripts\Spells\Fifth\SummonCreature.cs

<pre>public override bool CheckCast()
        {
            if (!base.CheckCast())
                return false;

            if ((this.Caster.Followers + 2) > this.Caster.FollowersMax)
            {
                this.Caster.SendLocalizedMessage(1049645); // You have too many followers to summon that creature.
                return false;
            }

            return true;
        }</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AdminGump.cs

<pre>public void AddBlackAlpha(int x, int y, int width, int height)
        {
            this.AddImageTiled(x, y, width, height, 2624);
            this.AddAlphaRegion(x, y, width, height);
        }</pre>

Fragment 2 in file Scripts\Gumps\ViewHousesGump.cs

<pre>public void AddBlackAlpha(int x, int y, int width, int height)
        {
            this.AddImageTiled(x, y, width, height, 2624);
            this.AddAlphaRegion(x, y, width, height);
        }</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\CategorizedAddGump.cs

<pre>{
                this.AddButton(x + NextOffsetX, y + NextOffsetY, NextButtonID1, NextButtonID2, 3, GumpButtonType.Reply, 1);

                if (NextLabel)
                    this.AddLabel(x + NextLabelOffsetX, y + NextLabelOffsetY, TextHue, "Next");
            }</pre>

Fragment 2 in file Scripts\Gumps\Go\GoGump.cs

<pre>{
                this.AddButton(x + NextOffsetX, y + NextOffsetY, NextButtonID1, NextButtonID2, 3, GumpButtonType.Reply, 1);

                if (NextLabel)
                    this.AddLabel(x + NextLabelOffsetX, y + NextLabelOffsetY, TextHue, "Next");
            }</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Cannon.cs

<pre>this.AddButton(5, 107, 0xFB1, 0xFB2, (int)Buttons.Cancel, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(40, 109, 100, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 2 in file Scripts\Items\Tools\WeaponEngravingTool.cs

<pre>this.AddButton(5, 107, 0xFB1, 0xFB2, (int)Buttons.Cancel, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(40, 109, 100, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\FurnitureContainer.cs

<pre>switch ( c.ItemID )
                {
                    case 0xA4D:
                        c.ItemID = 0xA4C;
                        break;
                    case 0xA4F:
                        c.ItemID = 0xA4E;
                        break;
                    case 0xA51:
                        c.ItemID = 0xA50;
                        break;
                    case 0xA53:
                        c.ItemID = 0xA52;
                        break;
                }</pre>

Fragment 2 in file Scripts\Items\Containers\FurnitureContainer.cs

<pre>switch ( c.ItemID )
                {
                    case 0xA4C:
                        c.ItemID = 0xA4D;
                        break;
                    case 0xA4E:
                        c.ItemID = 0xA4F;
                        break;
                    case 0xA50:
                        c.ItemID = 0xA51;
                        break;
                    case 0xA52:
                        c.ItemID = 0xA53;
                        break;
                }</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if (oreType != 0)
                    list.Add(1053099, "#{0}\t{1}", oreType, this.GetNameString()); // ~1_oretype~ ~2_armortype~
                else if (this.Name == null)
                    list.Add(this.LabelNumber);
                else
                    list.Add(this.Name);</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if (oreType != 0)
                list.Add(1053099, "#{0}\t{1}", oreType, this.GetNameString()); // ~1_oretype~ ~2_armortype~
            else if (this.Name == null)
                list.Add(this.LabelNumber);
            else
                list.Add(this.Name);</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>if (m_ItemPower != ItemPower.None)
            {
                if (m_ItemPower <= ItemPower.LegendaryArtifact)
                    list.Add(1151488 + ((int)m_ItemPower - 1));
                else
                    list.Add(1152281 + ((int)m_ItemPower - 9));
            }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if (m_ItemPower != ItemPower.None)
            {
                if (m_ItemPower <= ItemPower.LegendaryArtifact)
                    list.Add(1151488 + ((int)m_ItemPower - 1));
                else
                    list.Add(1152281 + ((int)m_ItemPower - 9));
            }</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(this.m.X + this.inc, this.m.Y - this.inc, this.m.Z), this.m.Map, 0x3709, 17, this.ehue, 0);</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>Effects.SendLocationEffect(new Point3D(this.m.X - this.inc, this.m.Y + this.inc, this.m.Z), this.m.Map, 0x3709, 17, this.ehue, 0);</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>list.Add(new InternalEntry(from, 6112, 14, m_Mobile, this, OrderType.Stop)); // Command: Stop
					list.Add(new InternalEntry(from, 6114, 14, m_Mobile, this, OrderType.Stay)); // Command: Stay</pre>

Fragment 2 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>list.Add(new InternalEntry(from, 6112, 14, m_Mobile, this, OrderType.Stop)); // Command: Stop
					list.Add(new InternalEntry(from, 6114, 14, m_Mobile, this, OrderType.Stay)); // Command: Stay</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Reaper.cs

<pre>this.SetDamageType(ResistanceType.Physical, 80);
            this.SetDamageType(ResistanceType.Poison, 20);

            this.SetResistance(ResistanceType.Physical, 35, 45);
            this.SetResistance(ResistanceType.Fire, 15, 25);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\VampireBat.cs

<pre>this.SetDamageType(ResistanceType.Physical, 80);
            this.SetDamageType(ResistanceType.Poison, 20);

            this.SetResistance(ResistanceType.Physical, 35, 45);
            this.SetResistance(ResistanceType.Fire, 15, 25);</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\SerpentsFangAssassin.cs

<pre>this.AddItem(item);

            item = new LeatherNinjaPants();
            item.Hue = 0x51D;
            this.AddItem(item);

            item = new LightPlateJingasa();
            item.Hue = 0x51D;
            this.AddItem(item);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\TigersClawThief.cs

<pre>this.AddItem(item);

            item = new LeatherNinjaPants();
            item.Hue = 0x51D;
            this.AddItem(item);			

            item = new LightPlateJingasa();
            item.Hue = 0x51D;
            this.AddItem(item);</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\HouseFoundation.cs

<pre>this.m_Stream.Write((ushort)0x0000);
            this.m_Stream.Write((ushort)0xFFFF);
            this.m_Stream.Write((ushort)0xFFFF);
            this.m_Stream.Write((byte)0xFF);</pre>

Fragment 2 in file Scripts\Multis\HouseFoundation.cs

<pre>this.m_Stream.Write((ushort)0x0000);
            this.m_Stream.Write((ushort)0xFFFF);
            this.m_Stream.Write((ushort)0xFFFF);
            this.m_Stream.Write((byte)0xFF);</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\AmbitiousSolenQueen\Conversations.cs

<pre>public override void ChildDeserialize(GenericReader reader)
        {
            int version = reader.ReadEncodedInt();

            this.m_BagOfSending = reader.ReadBool();
            this.m_PowderOfTranslocation = reader.ReadBool();
            this.m_Gold = reader.ReadBool();
        }</pre>

Fragment 2 in file Scripts\Quests\AmbitiousSolenQueen\Objectives.cs

<pre>public override void ChildDeserialize(GenericReader reader)
        {
            int version = reader.ReadEncodedInt();

            this.m_BagOfSending = reader.ReadBool();
            this.m_PowderOfTranslocation = reader.ReadBool();
            this.m_Gold = reader.ReadBool();
        }</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\MyrmidexThreat\Mobiles\Creatures.cs

<pre>Direction d = Utility.GetDirection(this, m);

                            int range = 0;
                            int x = m.X;
                            int y = m.Y;
                            int orx = x;
                            int ory = y;</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Bosses.cs

<pre>Direction d = Utility.GetDirection(this, m);
                int range = 0;
                int x = m.X;
                int y = m.Y;
                int orx = x;
                int ory = y;</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>this.AddButton(50, 335, 0x15E3, 0x15E7, (int)Buttons.Rewards, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(75, 335, 100, 20, 1072842, 0x1, false, false); // Rewards</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>this.AddButton(50, 335, 0x15E3, 0x15E7, (int)Buttons.Rewards, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(75, 335, 100, 20, 1072842, 0x1, false, false); // Rewards</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Myrmidex Invasion\BattleSpawner.cs

<pre>Instance = this;

            MyrmidexTeam = new Dictionary<int, List<BaseCreature>>();
            TribeTeam = new Dictionary<int, List<BaseCreature>>();
            Players = new Dictionary<PlayerMobile, int>();</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Myrmidex Invasion\BattleSpawner.cs

<pre>Instance = this;

            MyrmidexTeam = new Dictionary<int, List<BaseCreature>>();
            TribeTeam = new Dictionary<int, List<BaseCreature>>();
            Players = new Dictionary<PlayerMobile, int>();</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainQuestGump.cs

<pre>{
                                    this.AddHtmlLocalized(103, offset, 120, 16, 1062379, 0x15F90, false, false); // Est. time remaining:
                                    this.AddLabel(223, offset, 0x481, this.FormatSeconds(obtain.Seconds)); // %est. time remaining%

                                    offset += 16;
                                }</pre>

Fragment 2 in file Scripts\Services\MondainsLegacyQuests\Gumps\MondainQuestGump.cs

<pre>{
                                this.AddHtmlLocalized(103, offset, 120, 16, 1062379, 0x15F90, false, false); // Est. time remaining:
                                this.AddLabel(223, offset, 0x481, this.FormatSeconds(obtain.Seconds)); // %est. time remaining%

                                offset += 16;
                            }</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>bc.ControlOrder = OrderType.Stay;
                        bc.Internalize();
                        bc.SetControlMaster(null);
                        bc.SummonMaster = null;
                        bc.IsStabled = true;
                        bc.Loyalty = BaseCreature.MaxLoyalty;
                        from.Stabled.Add(bc);</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Mobiles\WarehouseSuperintendent.cs

<pre>bc.ControlOrder = OrderType.Stay;
                    bc.Internalize();
                    bc.IsStabled = true;
                    bc.Loyalty = BaseCreature.MaxLoyalty; // Wonderfully happy
                    from.Stabled.Add(bc);
                    bc.SetControlMaster(null);
                    bc.SummonMaster = null;</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new NamedInfoCol[]
                    {
                        new NamedInfoCol(AosAttribute.BonusMana, ArmorStamManaLMCTable),
                        new NamedInfoCol(AosAttribute.BonusInt, DexIntTable),
                        new NamedInfoCol(AosAttribute.LowerManaCost, ArmorStamManaLMCTable),
                        new NamedInfoCol(AosAttribute.RegenMana, ArmorRegenTable),
                    }</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new NamedInfoCol[]
                    {
                        new NamedInfoCol(AosAttribute.BonusMana, ArmorStamManaLMCTable),
                        new NamedInfoCol(AosAttribute.BonusInt, DexIntTable),
                        new NamedInfoCol(AosAttribute.LowerManaCost, ArmorStamManaLMCTable),
                        new NamedInfoCol(AosAttribute.RegenMana, ArmorRegenTable),
                    }</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\VeteranRewards\RewardSystem.cs

<pre>bool match = true;

                            for (int k = 0; match && k < args.Length; ++k)
                                match = (args[k].Equals(entries[j].Args[k]));</pre>

Fragment 2 in file Scripts\Services\VeteranRewards\RewardSystem.cs

<pre>bool match = true;

                            for (int k = 0; match && k < args.Length; ++k)
                                match = (args[k].Equals(entries[j].Args[k]));</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>{
							// use the precalculated tile locations
							if (locations != null && locations.Count > 0)
							{
								Point3D p = locations[Utility.Random(locations.Count)];
								x = p.X;
								y = p.Y;
								defaultZ = p.Z;
							}
						}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>{

									if (locations != null && locations.Count > 0)
									{
										Point3D p = locations[Utility.Random(locations.Count)];
										x = p.X;
										y = p.Y;
										defaultZ = p.Z;
									}
								}</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCatapult.cs

<pre>int[] LaunchIDArray = null;

			switch (Facing)
			{
				case 0:
					LaunchIDArray = CatapultWestLaunch;
					break;
				case 1:
					LaunchIDArray = CatapultNorthLaunch;
					break;
				case 2:
					LaunchIDArray = CatapultEastLaunch;
					break;
				case 3:
					LaunchIDArray = CatapultSouthLaunch;
					break;
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>int[] LaunchIDArray = null;

			switch (Facing)
			{
				case 0:
					LaunchIDArray = CatapultWestLaunch;
					break;
				case 1:
					LaunchIDArray = CatapultNorthLaunch;
					break;
				case 2:
					LaunchIDArray = CatapultEastLaunch;
					break;
				case 3:
					LaunchIDArray = CatapultSouthLaunch;
					break;
			}</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\Thrust.cs

<pre>BuffInfo.AddBuff(Caster, new BuffInfo(BuffIcon.Thrust, 1155989, 1155990, String.Format("{0}\t{1}\t{2}", AttackModifier.ToString(), DefenseModifier.ToString(), ScaleMana(30).ToString())));</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\Thrust.cs

<pre>BuffInfo.AddBuff(Caster, new BuffInfo(BuffIcon.Thrust, 1155989, 1155990, String.Format("{0}\t{1}\t{2}", AttackModifier.ToString(), DefenseModifier.ToString(), ScaleMana(30).ToString())));</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBlacksmith.cs

<pre>this.Add(typeof(Bascinet), 9);
                this.Add(typeof(CloseHelm), 9);
                this.Add(typeof(Helmet), 9);
                this.Add(typeof(NorseHelm), 9);</pre>

Fragment 2 in file Scripts\VendorInfo\SBHelmetArmor.cs

<pre>this.Add(typeof(Bascinet), 9);
                this.Add(typeof(CloseHelm), 9);
                this.Add(typeof(Helmet), 9);
                this.Add(typeof(NorseHelm), 9);</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBHerbalist.cs

<pre>this.Add(typeof(MandrakeRoot), 2); 
                this.Add(typeof(Garlic), 2); 
                this.Add(typeof(Ginseng), 2); 
                this.Add(typeof(Nightshade), 2);</pre>

Fragment 2 in file Scripts\VendorInfo\SBMystic.cs

<pre>this.Add(typeof(MandrakeRoot), 2); 
                this.Add(typeof(Garlic), 2); 
                this.Add(typeof(Ginseng), 2); 
                this.Add(typeof(Nightshade), 2);</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBInnKeeper.cs

<pre>this.Add(typeof(Chessboard), 1);
                this.Add(typeof(CheckerBoard), 1);
                this.Add(typeof(Backgammon), 1);
                this.Add(typeof(Dices), 1);</pre>

Fragment 2 in file Scripts\VendorInfo\SBProvisioner.cs

<pre>this.Add(typeof(Chessboard), 1);
                this.Add(typeof(CheckerBoard), 1);
                this.Add(typeof(Backgammon), 1);
                this.Add(typeof(Dices), 1);</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBSATailor.cs

<pre>this.Add(typeof(Cotton), 51);
                this.Add(typeof(Wool), 31);
                this.Add(typeof(Flax), 51);
                this.Add(typeof(SpoolOfThread), 9);</pre>

Fragment 2 in file Scripts\VendorInfo\SBTailor.cs

<pre>this.Add(typeof(SpoolOfThread), 9);

                this.Add(typeof(Flax), 51);
                this.Add(typeof(Cotton), 51);
                this.Add(typeof(Wool), 31);</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBSATailor.cs

<pre>this.Add(typeof(SewingKit), 1);
                this.Add(typeof(Scissors), 6);
                this.Add(typeof(DyeTub), 4);
                this.Add(typeof(Dyes), 4);</pre>

Fragment 2 in file Scripts\VendorInfo\SBTailor.cs

<pre>this.Add(typeof(Scissors), 6);
                this.Add(typeof(SewingKit), 1);
                this.Add(typeof(Dyes), 4);
                this.Add(typeof(DyeTub), 4);</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBSATanner.cs

<pre>this.Add(typeof(Bag), 3);
                this.Add(typeof(Pouch), 3);
                this.Add(typeof(Backpack), 7);
                this.Add(typeof(Leather), 5);</pre>

Fragment 2 in file Scripts\VendorInfo\SBTanner.cs

<pre>this.Add(typeof(Bag), 3);
                this.Add(typeof(Pouch), 3);
                this.Add(typeof(Backpack), 7);

                this.Add(typeof(Leather), 5);</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write((short)m.ManaMax);
			m_Stream.Write((short)m.Mana);

			m_Stream.Write((short)m.StamMax);
			m_Stream.Write((short)m.Stam);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write((short)m.Stam);
			m_Stream.Write((short)m.StamMax);

			m_Stream.Write((short)m.Mana);
			m_Stream.Write((short)m.ManaMax);</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Ultima\StringList.cs

<pre>if (objA.Number == objB.Number)
				{
					return 0;
				}
				else if (m_desc)
				{
					return (objA.Number < objB.Number) ? 1 : -1;
				}
				else
				{
					return (objA.Number < objB.Number) ? -1 : 1;
				}</pre>

Fragment 2 in file Ultima\StringList.cs

<pre>if (objA.Number == objB.Number)
					{
						return 0;
					}
					else if (m_desc)
					{
						return (objA.Number < objB.Number) ? 1 : -1;
					}
					else
					{
						return (objA.Number < objB.Number) ? -1 : 1;
					}</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\CategorizedAddGump.cs

<pre>{
                this.AddButton(x + PrevOffsetX, y + PrevOffsetY, PrevButtonID1, PrevButtonID2, 1, GumpButtonType.Reply, 0);

                if (PrevLabel)
                    this.AddLabel(x + PrevLabelOffsetX, y + PrevLabelOffsetY, TextHue, "Previous");
            }</pre>

Fragment 2 in file Scripts\Gumps\Go\GoGump.cs

<pre>{
                this.AddButton(x + PrevOffsetX, y + PrevOffsetY, PrevButtonID1, PrevButtonID2, 1, GumpButtonType.Reply, 0);

                if (PrevLabel)
                    this.AddLabel(x + PrevLabelOffsetX, y + PrevLabelOffsetY, TextHue, "Previous");
            }</pre>

Fragment 3 in file Scripts\Gumps\WhoGump.cs

<pre>{
                this.AddButton(x + PrevOffsetX, y + PrevOffsetY, PrevButtonID1, PrevButtonID2, 1, GumpButtonType.Reply, 0);

                if (PrevLabel)
                    this.AddLabel(x + PrevLabelOffsetX, y + PrevLabelOffsetY, TextHue, "Previous");
            }</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Hiryu.cs

<pre>int effect = -(defender.PhysicalResistance * 15 / 100);

                ResistanceMod mod = new ResistanceMod(ResistanceType.Physical, effect);

                defender.FixedEffect(0x37B9, 10, 5);
                defender.AddResistanceMod(mod);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\KazeKemono.cs

<pre>int effect = -(defender.PhysicalResistance * 15 / 100);

                ResistanceMod mod = new ResistanceMod(ResistanceType.Physical, effect);

                defender.FixedEffect(0x37B9, 10, 5);
                defender.AddResistanceMod(mod);</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\Gallusaurus.cs

<pre>int effect = -(defender.PhysicalResistance * 15 / 100);

                ResistanceMod mod = new ResistanceMod(ResistanceType.Physical, effect);

                defender.FixedEffect(0x37B9, 10, 5);
                defender.AddResistanceMod(mod);</pre>

## Duplicated Code. Size: 92

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>AddButton(338, 437, 4014, 4016, 0, GumpButtonType.Page, 2);
			AddHtml(290, 440, 35, 40, "Back", false, false);

			AddItem(580, 46, 4030);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>AddButton(338, 437, 4014, 4016, 0, GumpButtonType.Page, 2);
			AddHtml(290, 440, 35, 40, "Back", false, false);

			AddItem(580, 46, 4030);</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>AddButton(338, 437, 4014, 4016, 0, GumpButtonType.Page, 2);
			AddHtml(290, 440, 35, 40, "Back", false, false);

			AddItem(580, 46, 4030);</pre>

Fragment 4 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>AddButton(338, 437, 4014, 4016, 0, GumpButtonType.Page, 2);
			AddHtml(290, 440, 35, 40, "Back", false, false);

			AddItem(580, 46, 4030);</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\CategorizedAddGump.cs

<pre>x - OffsetSize - 22 - ((i % 2) * 44) - (bounds.Width / 2) - bounds.X, y + (EntryHeight / 2) - (bounds.Height / 2) - bounds.Y, itemID</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlCategorizedAddGump.cs

<pre>x - OffsetSize - 22 - ((i % 2) * 44) - (bounds.Width / 2) - bounds.X, y + (EntryHeight / 2) - (bounds.Height / 2) - bounds.Y, itemID</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\PropsGump.cs

<pre>AddPage(0);

			AddBackground(0, 0, BackWidth, BorderSize + totalHeight + BorderSize, BackGumpID);
			AddImageTiled(BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), totalHeight, OffsetGumpID);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlCategorizedAddGump.cs

<pre>AddPage( 0 );

			AddBackground( 0, 0, BackWidth, BorderSize + totalHeight + BorderSize, BackGumpID );
			AddImageTiled( BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), totalHeight, OffsetGumpID );</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\AddonComponent.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_LabelNumber = reader.ReadInt();
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\LocalizedSign.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_LabelNumber = reader.ReadInt();
                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\LoomEastAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_Phase = reader.ReadInt();
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Addons\LoomSouthAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_Phase = reader.ReadInt();
                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\BaseTreasureChest.cs

<pre>public void ClearContents()
        {
            for (int i = this.Items.Count - 1; i >= 0; --i)
            {
                if (i < this.Items.Count)
                    this.Items[i].Delete();
            }
        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\SorcerersRewardChest.cs

<pre>public void ClearContents()
        {
            for (int i = this.Items.Count - 1; i >= 0; --i)
            {
                if (i < this.Items.Count)
                    this.Items[i].Delete();
            }
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\SalvageBag.cs

<pre>item is DragonBardingDeed || (item is BaseArmor && ((BaseArmor)item).PlayerConstructed) || (item is BaseWeapon && ((BaseWeapon)item).PlayerConstructed) || (item is BaseClothing && ((BaseClothing)item).PlayerConstructed)</pre>

Fragment 2 in file Scripts\Services\Craft\Core\Resmelt.cs

<pre>item is DragonBardingDeed || (item is BaseArmor && ((BaseArmor)item).PlayerConstructed) || (item is BaseWeapon && ((BaseWeapon)item).PlayerConstructed) || (item is BaseClothing && ((BaseClothing)item).PlayerConstructed)</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\TrashBarrel.cs

<pre>if (!base.OnDragDropInto(from, item, p))
                return false;

            if (!AddCleanupItem(from, item))
            {
                if (item.LootType == LootType.Blessed)
                {
                    from.SendLocalizedMessage(1075256); // That is blessed; you cannot throw it away.
                    return false;
                }
            }</pre>

Fragment 2 in file Scripts\Items\Containers\TrashChest.cs

<pre>if (!base.OnDragDropInto(from, item, p))
                return false;

            if (!AddCleanupItem(from, item))
            {
                if (item.LootType == LootType.Blessed)
                {
                    from.SendLocalizedMessage(1075256); // That is blessed; you cannot throw it away.
                    return false;
                }
            }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\BaseStatuette.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_TurnedOn = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\WindChimes.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_TurnedOn = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>if (this.IsSetItem)
                {
                    this.m_SetEquipped = SetHelper.FullSetEquipped(from, this.SetID, this.Pieces);

                    if (this.m_SetEquipped)
                    {
                        this.m_LastEquipped = true;
                        SetHelper.AddSetBonus(from, this.SetID);
                    }
                }</pre>

Fragment 2 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>if (this.IsSetItem)
                {
                    this.m_SetEquipped = SetHelper.FullSetEquipped(from, this.SetID, this.Pieces);

                    if (this.m_SetEquipped)
                    {
                        this.m_LastEquipped = true;
                        SetHelper.AddSetBonus(from, this.SetID);
                    }
                }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>if (this.IsSetItem)
                {
                    this.m_SetEquipped = SetHelper.FullSetEquipped(mob, this.SetID, this.Pieces);

                    if (this.m_SetEquipped)
                    {
                        this.m_LastEquipped = true;
                        SetHelper.AddSetBonus(mob, this.SetID);
                    }
                }</pre>

Fragment 2 in file Scripts\Items\Equipment\Quivers\BaseQuiver.cs

<pre>if (this.IsSetItem)
                {
                    this.m_SetEquipped = SetHelper.FullSetEquipped(mob, this.SetID, this.Pieces);

                    if (this.m_SetEquipped)
                    {
                        this.m_LastEquipped = true;
                        SetHelper.AddSetBonus(mob, this.SetID);
                    }
                }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseAxe.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            if (this.HarvestSystem != null)
                BaseHarvestTool.AddContextMenuEntries(from, this, list, this.HarvestSystem);
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BasePoleArm.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            if (this.HarvestSystem != null)
                BaseHarvestTool.AddContextMenuEntries(from, this, list, this.HarvestSystem);
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\Cotton.cs

<pre>public static void OnSpun(ISpinningWheel wheel, Mobile from, int hue)
        {
            Item item = new SpoolOfThread(6);
            item.Hue = hue;

            from.AddToBackpack(item);
            from.SendLocalizedMessage(1010577); // You put the spools of thread in your backpack.
        }</pre>

Fragment 2 in file Scripts\Items\Resource\Flax.cs

<pre>public static void OnSpun(ISpinningWheel wheel, Mobile from, int hue)
        {
            Item item = new SpoolOfThread(6);
            item.Hue = hue;

            from.AddToBackpack(item);
            from.SendLocalizedMessage(1010577); // You put the spools of thread in your backpack.
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\BaseHarvestTool.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.m_Quality == ToolQuality.Exceptional)
                list.Add(1060636); // exceptional

            list.Add(1060584, this.m_UsesRemaining.ToString()); // uses remaining: ~1_val~
        }</pre>

Fragment 2 in file Scripts\Items\Tools\BaseTool.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.m_Quality == ToolQuality.Exceptional)
                list.Add(1060636); // exceptional

            list.Add(1060584, this.m_UsesRemaining.ToString()); // uses remaining: ~1_val~
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Ethereals.cs

<pre>public override bool Validate(Mobile from)
        {
            #region TOL
            if (from.NetState != null && !from.NetState.SupportsExpansion(Expansion.ML))
            {
                from.SendLocalizedMessage(1156139); // * You must upgrade to the Time of Legends in order to use this. *				
                return false;
            }
            #endregion

            return base.Validate(from);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Ethereals.cs

<pre>public override bool Validate(Mobile from)
        {
            #region TOL
            if (from.NetState != null && !from.NetState.SupportsExpansion(Expansion.ML))
            {
                from.SendLocalizedMessage(1156139); // * You must upgrade to the Time of Legends in order to use this. *				
                return false;
            }
            #endregion

            return base.Validate(from);
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\HumanBrigand.cs

<pre>if (this.Female = Utility.RandomBool())
            {
                this.Body = 401;
                this.Name = NameList.RandomName("female");
            }
            else
            {
                this.Body = 400;
                this.Name = NameList.RandomName("male");
            }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\BaseEscortable.cs

<pre>if (this.Female = Utility.RandomBool())
            {
                this.Body = 401;
                this.Name = NameList.RandomName("female");
            }
            else
            {
                this.Body = 400;
                this.Name = NameList.RandomName("male");
            }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\SavageShaman.cs

<pre>bool isFriendly = (m is Savage || m is SavageRider || m is SavageShaman || m is SavageRidgeback);

                                if (isFriendly)
                                {
                                    continue;
                                }

                                if (!CanBeHarmful(m))
                                {
                                    continue;
                                }

                                DoHarmful(m);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SavageShaman.cs

<pre>bool isFriendly = (m is Savage || m is SavageRider || m is SavageShaman || m is SavageRidgeback);

                                if (isFriendly)
                                {
                                    continue;
                                }

                                if (!CanBeHarmful(m))
                                {
                                    continue;
                                }

                                DoHarmful(m);</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Camps\BrigandCamp.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_Prisoner = reader.ReadMobile();
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Multis\Camps\LizardmenCamp.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_Prisoner = reader.ReadMobile();
                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\MyrmidexThreat\Quests.cs

<pre>if (offer)
                g.AddHtmlLocalized(130, 45, 270, 16, 1049010, 0xFFFFFF, false, false); // Quest Offer
            else
                g.AddHtmlLocalized(130, 45, 270, 16, 1046026, 0xFFFFFF, false, false); // Quest Log</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionFishQuest\ProfessionalFisherQuest.cs

<pre>if (offer)
                g.AddHtmlLocalized(130, 45, 270, 16, 1049010, 0xFFFFFF, false, false); // Quest Offer
            else
                g.AddHtmlLocalized(130, 45, 270, 16, 1046026, 0xFFFFFF, false, false); // Quest Log</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefCarpentry.cs

<pre>this.AddRes(index, typeof(BarkFragment), 1032687, 4, 1053098);
                this.AddRes(index, typeof(Feather), 1027123, 25, 1053098);
                this.SetNeededExpansion(index, Expansion.ML);</pre>

Fragment 2 in file Scripts\Services\Craft\DefCarpentry.cs

<pre>this.AddRes(index, typeof(BarkFragment), 1032687, 4, 1053098);
                this.AddRes(index, typeof(Feather), 1027123, 25, 1053098);
                this.SetNeededExpansion(index, Expansion.ML);</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\CauldronOfTransmutation.cs

<pre>base.GetProperties(list);

            int left = 0;
            if (DateTime.UtcNow < Expires)
                left = (int)(Expires - DateTime.UtcNow).TotalSeconds;

            list.Add(1072517, left.ToString()); // Lifespan: ~1_val~ seconds</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\TemporaryForge.cs

<pre>base.GetProperties(list);

            int left = 0;
            if (DateTime.UtcNow < Expires)
                left = (int)(Expires - DateTime.UtcNow).TotalSeconds;

            list.Add(1072517, left.ToString()); // Lifespan: ~1_val~ seconds</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolderGumps.cs

<pre>if (arglist.Length > 1)
                            {
                                name = arglist[1];
                            }

                            XmlQuest.CheckArgList(arglist, 2, null, out typestr, out targetcount, out checkprop, out status_str);

                            if (typestr != null) type = typestr;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolderGumps.cs

<pre>if (arglist.Length > 1)
                            {
                                name = arglist[1];
                            }

                            XmlQuest.CheckArgList(arglist, 2, null, out typestr, out targetcount, out checkprop, out status_str);

                            if (typestr != null) type = typestr;</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Fourth\Lightning.cs

<pre>SpellHelper.Turn(this.Caster, m);
                Mobile source = this.Caster;

                if(mob != null)
                    SpellHelper.CheckReflect((int)this.Circle, ref source, ref mob);

                double damage = 0;</pre>

Fragment 2 in file Scripts\Spells\Second\Harm.cs

<pre>SpellHelper.Turn(this.Caster, m);
                Mobile source = this.Caster;

                if(mob != null)
                    SpellHelper.CheckReflect((int)this.Circle, ref source, ref mob);

                double damage = 0;</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>item.AtWorldPoint(oldX, oldY) &&
									(item.Z == oldZ || ((item.Z + item.ItemData.Height) > oldZ && (oldZ + 15) > item.Z)) && !item.OnMoveOff(this)</pre>

Fragment 2 in file Server\Mobile.cs

<pre>item.AtWorldPoint(oldX, oldY) &&
									(item.Z == oldZ || ((item.Z + item.ItemData.Height) > oldZ && (oldZ + 15) > item.Z)) && !item.OnMoveOff(this)</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Ultima\AnimationEdit.cs

<pre>int length, extra;
			bool patched;
			bool valid = fileIndex.Valid(index, out length, out extra, out patched);
			if ((!valid) || (length < 1))
			{
				return false;
			}
			return true;</pre>

Fragment 2 in file Ultima\Animations.cs

<pre>int length, extra;
			bool patched;
			bool valid = fileIndex.Valid(index, out length, out extra, out patched);
			if ((!valid) || (length < 1))
			{
				return false;
			}
			return true;</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\BaseStatuette.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsOwner(from))
            {
                OnOffGump onOffGump = new OnOffGump(this);
                from.SendGump(onOffGump);
            }
            else
            {
                from.SendLocalizedMessage(502691); // You must be the owner to use this.
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\MonsterStatuette.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsOwner(from))
            {
                OnOffGump onOffGump = new OnOffGump(this);
                from.SendGump(onOffGump);
            }
            else
            {
                from.SendLocalizedMessage(502691); // You must be the owner to use this.
            }
        }</pre>

Fragment 3 in file Scripts\Items\Decorative\WindChimes.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsOwner(from))
            {
                OnOffGump onOffGump = new OnOffGump(this);
                from.SendGump(onOffGump);
            }
            else
            {
                from.SendLocalizedMessage(502691); // You must be the owner to use this.
            }
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Candelabra.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_IsShipwreckedItem = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\GargoyleCandelabra.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_IsShipwreckedItem = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Clothing\Hats.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_IsShipwreckedItem = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>public virtual bool CheckResurrect(Mobile m)
        {
            if (m.Criminal)
            {
                this.Say(501222); // Thou art a criminal.  I shall not resurrect thee.
                return false;
            }
            else if (m.Kills >= 5)
            {
                this.Say(501223); // Thou'rt not a decent and good person. I shall not resurrect thee.
                return false;
            }

            return true;
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\GargishWanderingHealer.cs

<pre>public override bool CheckResurrect(Mobile m)
        {
            if (m.Criminal)
            {
                this.Say(501222); // Thou art a criminal.  I shall not resurrect thee.
                return false;
            }
            else if (m.Kills >= 5)
            {
                this.Say(501223); // Thou'rt not a decent and good person. I shall not resurrect thee.
                return false;
            }

            return true;
        }</pre>

Fragment 3 in file Scripts\Quests\Escortables.cs

<pre>public virtual bool CheckResurrect(Mobile m)
        {
            if (m.Criminal)
            {
                this.Say(501222); // Thou art a criminal.  I shall not resurrect thee.
                return false;
            }
            else if (m.Kills >= 5)
            {
                this.Say(501223); // Thou'rt not a decent and good person. I shall not resurrect thee.
                return false;
            }

            return true;
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>{
                                    if (ns.ContainerGridLines)
                                    {
                                        ns.Send(new ContainerContentUpdate6017(this));
                                    }
                                    else
                                    {
                                        ns.Send(new ContainerContentUpdate(this));
                                    }

                                    if (ObjectPropertyList.Enabled)
                                    {
                                        ns.Send(OPLPacket);
                                    }
                                }</pre>

Fragment 2 in file Server\Item.cs

<pre>{
                                            if (ns.ContainerGridLines)
                                            {
                                                ns.Send(new ContainerContentUpdate6017(this));
                                            }
                                            else
                                            {
                                                ns.Send(new ContainerContentUpdate(this));
                                            }

                                            if (ObjectPropertyList.Enabled)
                                            {
                                                ns.Send(OPLPacket);
                                            }
                                        }</pre>

Fragment 3 in file Server\Item.cs

<pre>{
                                                if (ns.ContainerGridLines)
                                                {
                                                    ns.Send(new ContainerContentUpdate6017(this));
                                                }
                                                else
                                                {
                                                    ns.Send(new ContainerContentUpdate(this));
                                                }

                                                if (ObjectPropertyList.Enabled)
                                                {
                                                    ns.Send(OPLPacket);
                                                }
                                            }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Server\Random.cs

<pre>private void _GetBytes(byte[] b, int offset, int count)
		{
			CheckSwap(count);

			lock (_sync)
			{
				Buffer.BlockCopy(_Working, _Index, b, offset, count);
				_Index += count;
			}
		}</pre>

Fragment 2 in file Server\Random.cs

<pre>private void _GetBytes(byte[] b, int offset, int count)
		{
			CheckSwap(count);

			lock (_sync)
			{
				Buffer.BlockCopy(_Working, _Index, b, offset, count);
				_Index += count;
			}
		}</pre>

Fragment 3 in file Server\Random.cs

<pre>private void _GetBytes(byte[] b, int offset, int count)
		{
			CheckSwap(count);

			lock (_sync)
			{
				Buffer.BlockCopy(_Working, _Index, b, offset, count);
				_Index += count;
			}
		}</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BlackSolenQueen.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            switch( version )
            {
                case 1:
                    {
                        this.m_BurstSac = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BlackSolenWarrior.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            switch( version )
            {
                case 1:
                    {
                        this.m_BurstSac = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\RedSolenQueen.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            switch( version )
            {
                case 1:
                    {
                        this.m_BurstSac = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

Fragment 4 in file Scripts\Mobiles\Normal\RedSolenWarrior.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            switch( version )
            {
                case 1:
                    {
                        this.m_BurstSac = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Agralem.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = false;
            this.CantWalk = true;

            this.Body = 666;
            this.HairItemID = 16987;
            this.HairHue = 1801;
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Egwexem.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = false;
            this.CantWalk = true;
            this.Body = 666;
            this.HairItemID = 16987;
            this.HairHue = 1801;
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Naxatillor.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = false;
            this.CantWalk = true;
            this.Body = 666;
            this.HairItemID = 16987;
            this.HairHue = 1801;
        }</pre>

Fragment 4 in file Scripts\Mobiles\NPCs\Valem.cs

<pre>public override void InitBody()
        {
            this.InitStats(100, 100, 25);

            this.Female = false;
            this.CantWalk = true;

            this.Body = 666;
            this.HairItemID = 16987;
            this.HairHue = 1801;
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SoulStone.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_IsRewardItem = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Tools\LeatherDyeTub.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_IsRewardItem = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

Fragment 3 in file Scripts\Items\Tools\RewardBlackDyeTub.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_IsRewardItem = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

Fragment 4 in file Scripts\Items\Tools\RunebookDyeTub.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_IsRewardItem = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

Fragment 5 in file Scripts\Items\Tools\SpecialDyeTub.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_IsRewardItem = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

Fragment 6 in file Scripts\Items\Tools\StatuetteDyeTub.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 1:
                    {
                        this.m_IsRewardItem = reader.ReadBool();
                        break;
                    }
            }
        }</pre>

## Duplicated Code. Size: 91

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>if (state == null || info == null || state.Mobile == null || m_gauntlet == null || m_gauntlet.Challenger == null) return;

			XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(state.Mobile, typeof(XmlPoints));</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>if(state == null || info == null || state.Mobile == null || m_gauntlet == null || m_gauntlet.Challenger == null) return;

            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(state.Mobile, typeof(XmlPoints));</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>if(state == null || info == null || state.Mobile == null || m_gauntlet == null || m_gauntlet.Challenger == null) return;

            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(state.Mobile, typeof(XmlPoints));</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>if(state == null || info == null || state.Mobile == null || m_gauntlet == null || m_gauntlet.Challenger == null) return;

            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(state.Mobile, typeof(XmlPoints));</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>if(state == null || info == null || state.Mobile == null || m_gauntlet == null || m_gauntlet.Challenger == null) return;

            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(state.Mobile, typeof(XmlPoints));</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>if(state == null || info == null || state.Mobile == null || m_gauntlet == null || m_gauntlet.Challenger == null) return;

            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(state.Mobile, typeof(XmlPoints));</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>if(state == null || info == null || state.Mobile == null || m_gauntlet == null || m_gauntlet.Challenger == null) return;

            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(state.Mobile, typeof(XmlPoints));</pre>

Fragment 8 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>if(state == null || info == null || state.Mobile == null || m_gauntlet == null || m_gauntlet.Challenger == null) return;

            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(state.Mobile, typeof(XmlPoints));</pre>

Fragment 9 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>if(state == null || info == null || state.Mobile == null || m_gauntlet == null || m_gauntlet.Challenger == null) return;

            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(state.Mobile, typeof(XmlPoints));</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\MiningCart.cs

<pre>!from.InRange(this.GetWorldLocation(), 2) || !from.InLOS(this) || !((from.Z - this.Z) > -3 && (from.Z - this.Z) < 3)</pre>

Fragment 2 in file Scripts\Items\Addons\TreeStump.cs

<pre>!from.InRange(this.GetWorldLocation(), 2) || !from.InLOS(this) || !((from.Z - this.Z) > -3 && (from.Z - this.Z) < 3)</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\BowOfTheInfiniteSwarm.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();

            if (version == 0 && this.WeaponAttributes.HitLeechMana != 50)
                this.WeaponAttributes.HitLeechMana = 50;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\BowOfTheInfiniteSwarm.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();

            if (version == 0 && this.WeaponAttributes.HitLeechMana != 50)
                this.WeaponAttributes.HitLeechMana = 50;
        }</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\ScrollofAlacrity.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = (this.InheritsItem ? 0 : reader.ReadInt()); //Required for SpecialScroll insertion

            this.LootType = LootType.Cursed;
            this.Insured = false;
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\StatScroll.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = (this.InheritsItem ? 0 : reader.ReadInt()); //Required for SpecialScroll insertion

            this.LootType = LootType.Cursed;
            this.Insured = false;
        }</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\PileOfGlacialSnow.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0)
            {
                this.Weight = 1.0;
                this.LootType = LootType.Blessed;
            }
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\SnowPile.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0)
            {
                this.Weight = 1.0;
                this.LootType = LootType.Blessed;
            }
        }</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\ChaosShield.cs

<pre>Guild g = m.Guild as Guild;

            if (g == null || g.Type != GuildType.Chaos)
            {
                m.FixedEffect(0x3728, 10, 13);
                this.Delete();

                return false;
            }

            return true;</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\GargishChaosShield.cs

<pre>Guild g = m.Guild as Guild;

            if (g == null || g.Type != GuildType.Chaos)
            {
                m.FixedEffect(0x3728, 10, 13);
                this.Delete();

                return false;
            }

            return true;</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\GargishOrderShield.cs

<pre>Guild g = m.Guild as Guild;

            if (g == null || g.Type != GuildType.Order)
            {
                m.FixedEffect(0x3728, 10, 13);
                this.Delete();

                return false;
            }

            return true;</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\OrderShield.cs

<pre>Guild g = m.Guild as Guild;

            if (g == null || g.Type != GuildType.Order)
            {
                m.FixedEffect(0x3728, 10, 13);
                this.Delete();

                return false;
            }

            return true;</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\SkillCheck.cs

<pre>Skill skill = from.Skills[skillName];

            if (skill == null)
                return false;

            CrystalBallOfKnowledge.TellSkillDifficulty(from, skillName, chance);

            if (chance < 0.0)
                return false; // Too difficult
            else if (chance >= 1.0)
                return true; // No challenge</pre>

Fragment 2 in file Scripts\Misc\SkillCheck.cs

<pre>Skill skill = from.Skills[skillName];

            if (skill == null)
                return false;

            CrystalBallOfKnowledge.TellSkillDifficulty(from, skillName, chance);

            if (chance < 0.0)
                return false; // Too difficult
            else if (chance >= 1.0)
                return true; // No challenge</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\NinjaAI.cs

<pre>if(item is INinjaWeapon && ((INinjaWeapon)item).UsesRemaining > 0 && d >= ((INinjaWeapon)item).WeaponMinRange && d <= ((INinjaWeapon)item).WeaponMaxRange)
					list.Add(item as INinjaWeapon);</pre>

Fragment 2 in file Scripts\Mobiles\AI\NinjaAI.cs

<pre>if (item is INinjaWeapon && ((INinjaWeapon)item).UsesRemaining > 0 && d >= ((INinjaWeapon)item).WeaponMinRange && d <= ((INinjaWeapon)item).WeaponMaxRange)
                        list.Add(item as INinjaWeapon);</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\AcidElemental.cs

<pre>this.SetStr(326, 355);
            this.SetDex(66, 85);
            this.SetInt(271, 295);

            this.SetHits(196, 213);

            this.SetDamage(9, 15);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ToxicElemental.cs

<pre>this.SetStr(326, 355);
            this.SetDex(66, 85);
            this.SetInt(271, 295);

            this.SetHits(196, 213);

            this.SetDamage(9, 15);</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\MeerMage.cs

<pre>this.SetStr(171, 200);
            this.SetDex(126, 145);
            this.SetInt(276, 305);

            this.SetHits(103, 120);

            this.SetDamage(24, 26);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ShadowDweller.cs

<pre>this.SetStr(171, 200);
            this.SetDex(126, 145);
            this.SetInt(276, 305);

            this.SetHits(103, 120);

            this.SetDamage(24, 26);</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\GargishNoble.cs

<pre>this.AddItem(new GargishClothChest(Utility.RandomNeutralHue()));
                this.AddItem(new GargishClothKilt(Utility.RandomNeutralHue()));
                this.AddItem(new GargishClothLegs(Utility.RandomNeutralHue()));</pre>

Fragment 2 in file Scripts\Quests\GatheringOfEvidence.cs

<pre>this.AddItem(new GargishClothChest(Utility.RandomNeutralHue()));
            this.AddItem(new GargishClothKilt(Utility.RandomNeutralHue()));
            this.AddItem(new GargishClothLegs(Utility.RandomNeutralHue()));</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>if (i > 10)
                {
                    AddHtml(32, 346, 100, 16, "<basefont color=#FFFFFF>BACK", false, false);
                    AddButton(10, 348, 5603, 5607, 0, GumpButtonType.Page, page - 1);
                }</pre>

Fragment 2 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>if (i > 10)
                {
                    AddHtml(32, 346, 100, 16, "<basefont color=#FFFFFF>BACK", false, false);
                    AddButton(10, 348, 5603, 5607, 0, GumpButtonType.Page, page - 1);
                }</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\BaseCollectionItem.cs

<pre>this.m_Points = reader.ReadLong();
            this.m_StartTier = reader.ReadLong();
            this.m_NextTier = reader.ReadLong();
            this.m_DailyDecay = reader.ReadLong();
            this.m_Tier = reader.ReadInt();</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\BaseCollectionMobile.cs

<pre>this.m_Points = reader.ReadLong();
				this.m_StartTier = reader.ReadLong();
				this.m_NextTier = reader.ReadLong();
				this.m_DailyDecay = reader.ReadLong();
				this.m_Tier = reader.ReadInt();</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>xOffset = Utility.RandomMinMax(-1, 1);
                            yOffset = Utility.RandomMinMax(-2, 0);
                            hit = new Point3D(pnt.X + xOffset, pnt.Y + yOffset, z);
                            break;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>xOffset = Utility.RandomMinMax(-2, 0);
                            yOffset = Utility.RandomMinMax(-1, 1);
                            hit = new Point3D(pnt.X + xOffset, pnt.Y + yOffset, z);
                            break;</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Housing Lotto\Core\MaginciaLottoSystem.cs

<pre>m_FreeHousingZones = new Dictionary<Map, List<Rectangle2D>>();
            m_FreeHousingZones[Map.Trammel] = new List<Rectangle2D>();
            m_FreeHousingZones[Map.Felucca] = new List<Rectangle2D>();</pre>

Fragment 2 in file Scripts\Services\New Magincia\Housing Lotto\Core\MaginciaLottoSystem.cs

<pre>m_FreeHousingZones = new Dictionary<Map, List<Rectangle2D>>();
            m_FreeHousingZones[Map.Trammel] = new List<Rectangle2D>();
            m_FreeHousingZones[Map.Felucca] = new List<Rectangle2D>();</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
									IPooledEnumerable ie = ((Item)refobject).GetMobilesInRange(range);
									foreach (Mobile p in ie )
									{
										if (p.Player && p.AccessLevel == AccessLevel.Player) nplayers++;
									}
									ie.Free();
								}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
									IPooledEnumerable ie = ((Mobile)refobject).GetMobilesInRange(range);
									foreach (Mobile p in ie)
									{
										if (p.Player && p.AccessLevel == AccessLevel.Player) nplayers++;
									}
									ie.Free();
								}</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
								IPooledEnumerable ie = ((Item)o).GetMobilesInRange(range);
								foreach (Mobile p in ie)
								{
									if (p.Player && p.AccessLevel == AccessLevel.Player) nplayers++;
								}
								ie.Free();
							}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
								IPooledEnumerable ie = ((Mobile)o).GetMobilesInRange(range);
								foreach (Mobile p in ie)
								{
									if (p.Player && p.AccessLevel == AccessLevel.Player) nplayers++;
								}
								ie.Free();
							}</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>if (action == null || action.Length <= 0) return;
            string status_str = null;
            Server.Mobiles.XmlSpawner.SpawnObject TheSpawn = new Server.Mobiles.XmlSpawner.SpawnObject(null, 0);

            TheSpawn.TypeName = action;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlUse.cs

<pre>if (action == null || action.Length <= 0) return;

            string status_str = null;
            Server.Mobiles.XmlSpawner.SpawnObject TheSpawn = new Server.Mobiles.XmlSpawner.SpawnObject(null, 0);

            TheSpawn.TypeName = action;</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>newentry.EntryNumber = reader.ReadInt();
                                newentry.ID = reader.ReadInt();
                                newentry.Text = reader.ReadString();
                                newentry.Keywords = reader.ReadString();
                                newentry.Action = reader.ReadString();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>newentry.EntryNumber = reader.ReadInt();
                                newentry.ID = reader.ReadInt();
                                newentry.Text = reader.ReadString();
                                newentry.Keywords = reader.ReadString();
                                newentry.Action = reader.ReadString();</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>this.m_Description1 = reader.ReadString();
						this.m_Description2 = reader.ReadString();
						this.m_Description3 = reader.ReadString();
						this.m_Description4 = reader.ReadString();
						this.m_Description5 = reader.ReadString();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>this.m_Description1 = reader.ReadString();
                        this.m_Description2 = reader.ReadString();
                        this.m_Description3 = reader.ReadString();
                        this.m_Description4 = reader.ReadString();
                        this.m_Description5 = reader.ReadString();</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>this.m_State1 = reader.ReadString();
						this.m_State2 = reader.ReadString();
						this.m_State3 = reader.ReadString();
						this.m_State4 = reader.ReadString();
						this.m_State5 = reader.ReadString();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>this.m_State1 = reader.ReadString();
                        this.m_State2 = reader.ReadString();
                        this.m_State3 = reader.ReadString();
                        this.m_State4 = reader.ReadString();
                        this.m_State5 = reader.ReadString();</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>if(m_WorkingList.Count < 2)
                    {
                        XmlPoints.SendText(m_gauntlet.Challenger, 100540);  // "Insufficient number of players."
                        complete = false;
                    }

                    if(m_gauntlet.TargetScore <=0 )
                    {
                        XmlPoints.SendText(m_gauntlet.Challenger, 100568);  // "No valid end condition for match."
                        complete = false;
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>if(m_WorkingList.Count < 2)
                    {
                        XmlPoints.SendText(m_gauntlet.Challenger, 100540);  // "Insufficient number of players."
                        complete = false;
                    }

                    if(m_gauntlet.TargetScore <=0 )
                    {
                        XmlPoints.SendText(m_gauntlet.Challenger, 100568);  // "No valid end condition for match."
                        complete = false;
                    }</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_CompiledLength = length;

					if (length > BufferSize || (m_State & State.Static) != 0)
					{
						m_CompiledBuffer = new byte[length];
					}
					else
					{
						lock (m_Buffers)
							m_CompiledBuffer = m_Buffers.AcquireBuffer();
						m_State |= State.Buffered;
					}</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_CompiledLength = length;

				if (length > BufferSize || (m_State & State.Static) != 0)
				{
					m_CompiledBuffer = new byte[length];
				}
				else
				{
					lock (m_Buffers)
						m_CompiledBuffer = m_Buffers.AcquireBuffer();
					m_State |= State.Buffered;
				}</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\BaseStatuette.cs

<pre>this.m_TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2)</pre>

Fragment 2 in file Scripts\Items\Decorative\MonsterStatuette.cs

<pre>this.m_TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2)</pre>

Fragment 3 in file Scripts\Items\Decorative\WindChimes.cs

<pre>this.m_TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2)</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\HighPlainsBoura.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            var version = reader.ReadInt();

            if (version == 1)
                reader.ReadDeltaTime();
            else
            {
                GatheredFur = reader.ReadBool();
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\LowlandBoura.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            var version = reader.ReadInt();

            if (version == 1)
                reader.ReadDeltaTime();
            else
            {
                GatheredFur = reader.ReadBool();
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\RuddyBoura.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            var version = reader.ReadInt();

            if (version == 1)
                reader.ReadDeltaTime();
            else
            {
                GatheredFur = reader.ReadBool();
            }
        }</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\AnimalLore.cs

<pre>this.AddButton(340, 358, 5601, 5605, 0, GumpButtonType.Page, page + 1);
                this.AddButton(317, 358, 5603, 5607, 0, GumpButtonType.Page, page - 1);</pre>

Fragment 2 in file Scripts\Skills\AnimalLore.cs

<pre>this.AddButton(340, 358, 5601, 5605, 0, GumpButtonType.Page, page + 1);
                this.AddButton(317, 358, 5603, 5607, 0, GumpButtonType.Page, page - 1);</pre>

Fragment 3 in file Scripts\Skills\AnimalLore.cs

<pre>this.AddButton(340, 358, 5601, 5605, 0, GumpButtonType.Page, page + 1);
            this.AddButton(317, 358, 5603, 5607, 0, GumpButtonType.Page, page - 1);</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Void Creatures\Vasanord.cs

<pre>SetDamageType( ResistanceType.Physical, 20 );
			SetDamageType( ResistanceType.Fire, 20 );
			SetDamageType( ResistanceType.Cold, 20 );
			SetDamageType( ResistanceType.Poison, 20 );
			SetDamageType( ResistanceType.Energy, 20 );</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Mobiles\Corgul\SoulboundBattleMage.cs

<pre>SetDamageType(ResistanceType.Physical, 20);
            SetDamageType(ResistanceType.Fire, 20);
            SetDamageType(ResistanceType.Cold, 20);
            SetDamageType(ResistanceType.Poison, 20);
            SetDamageType(ResistanceType.Energy, 20);</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Bosses.cs

<pre>SetDamageType(ResistanceType.Physical, 20);
			SetDamageType(ResistanceType.Fire, 20);
			SetDamageType(ResistanceType.Cold, 20);
			SetDamageType(ResistanceType.Poison, 20);
			SetDamageType(ResistanceType.Energy, 20);</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>SetDamageType( ResistanceType.Physical, 20 );
			SetDamageType( ResistanceType.Fire, 20 );
			SetDamageType( ResistanceType.Cold, 20 );
			SetDamageType( ResistanceType.Poison, 20);
			SetDamageType( ResistanceType.Energy, 20 );</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Items\LavaFishItems.cs

<pre>{
            switch (Utility.Random(4))
            {
                case 0: Hue = 2658; break;
                case 1: Hue = 2659; break;
                case 2: Hue = 2660; break;
                case 3: Hue = 2654; break;
            }
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\LavaFishItems.cs

<pre>{
            switch (Utility.Random(4))
            {
                case 0: Hue = 2658; break;
                case 1: Hue = 2659; break;
                case 2: Hue = 2660; break;
                case 3: Hue = 2654; break;
            }
        }</pre>

Fragment 3 in file Scripts\Services\Expansions\High Seas\Items\LavaFishItems.cs

<pre>{
            switch (Utility.Random(4))
            {
                case 0: Hue = 2658; break;
                case 1: Hue = 2659; break;
                case 2: Hue = 2660; break;
                case 3: Hue = 2654; break;
            }
        }</pre>

Fragment 4 in file Scripts\Services\Expansions\High Seas\Items\LavaFishItems.cs

<pre>{
            switch (Utility.Random(4))
            {
                case 0: Hue = 2658; break;
                case 1: Hue = 2659; break;
                case 2: Hue = 2660; break;
                case 3: Hue = 2654; break;
            }
        }</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\BritannianInfantry.cs

<pre>public override bool IsEnemy(Mobile m)
        {
            if (MyrmidexInvasionSystem.Active && MyrmidexInvasionSystem.IsAlliedWithEodonTribes(m))
                return false;

            if (MyrmidexInvasionSystem.Active && MyrmidexInvasionSystem.IsAlliedWithMyrmidex(m))
                return true;

            return base.IsEnemy(m);
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\MyrmidexDrone.cs

<pre>public override bool IsEnemy(Mobile m)
        {
            if (MyrmidexInvasionSystem.Active && MyrmidexInvasionSystem.IsAlliedWithEodonTribes(m))
                return true;

            if (MyrmidexInvasionSystem.Active && MyrmidexInvasionSystem.IsAlliedWithMyrmidex(m))
                return false;

            return base.IsEnemy(m);
        }</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\MyrmidexLarvae.cs

<pre>public override bool IsEnemy(Mobile m)
        {
            if (MyrmidexInvasionSystem.Active && MyrmidexInvasionSystem.IsAlliedWithEodonTribes(m))
                return true;

            if (MyrmidexInvasionSystem.Active && MyrmidexInvasionSystem.IsAlliedWithMyrmidex(m))
                return false;

            return base.IsEnemy(m);
        }</pre>

Fragment 4 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\MyrmidexWarrior.cs

<pre>public override bool IsEnemy(Mobile m)
        {
            if (MyrmidexInvasionSystem.Active && MyrmidexInvasionSystem.IsAlliedWithEodonTribes(m))
                return true;

            if (MyrmidexInvasionSystem.Active && MyrmidexInvasionSystem.IsAlliedWithMyrmidex(m))
                return false;

            return base.IsEnemy(m);
        }</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Artifacts.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);
			int version = reader.ReadInt();

            if (version == 0 && this.WeaponAttributes.HitLeechMana != 50)
                this.WeaponAttributes.HitLeechMana = 50;
		}</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Artifacts.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);
			int version = reader.ReadInt();

            if (version == 0 && this.WeaponAttributes.HitLeechMana != 50)
                this.WeaponAttributes.HitLeechMana = 50;
		}</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Artifacts.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);
			int version = reader.ReadInt();

            if (version == 0 && this.WeaponAttributes.HitLeechMana != 50)
                this.WeaponAttributes.HitLeechMana = 50;
		}</pre>

Fragment 4 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Artifacts.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);
			int version = reader.ReadInt();

            if (version == 0 && this.WeaponAttributes.HitLeechMana != 50)
                this.WeaponAttributes.HitLeechMana = 50;
		}</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\RakktaviRenowned.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Body == 42)
            {
                this.Body = 0x8E;
                this.Hue = 0;
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ClanCA.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Body == 42)
            {
                this.Body = 0x8E;
                this.Hue = 0;
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\ClanCT.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Body == 42)
            {
                this.Body = 0x8E;
                this.Hue = 0;
            }
        }</pre>

Fragment 4 in file Scripts\Mobiles\Normal\ClanSS.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Body == 42)
            {
                this.Body = 0x8E;
                this.Hue = 0;
            }
        }</pre>

Fragment 5 in file Scripts\Mobiles\Normal\RatmanArcher.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Body == 42)
            {
                this.Body = 0x8E;
                this.Hue = 0;
            }
        }</pre>

## Duplicated Code. Size: 90

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Decorative\CollectionsBritLibraryQuotes.cs

<pre>this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2)</pre>

Fragment 2 in file Scripts\Items\Artifacts\Decorative\CollectionsBritLibraryQuotes.cs

<pre>this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2)</pre>

Fragment 3 in file Scripts\Items\Artifacts\Decorative\CollectionsBritLibraryQuotes.cs

<pre>this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2)</pre>

Fragment 4 in file Scripts\Items\Artifacts\Decorative\CollectionsBritLibraryQuotes.cs

<pre>this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2)</pre>

Fragment 5 in file Scripts\Items\Artifacts\Decorative\CollectionsBritLibraryQuotes.cs

<pre>this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2)</pre>

Fragment 6 in file Scripts\Items\Artifacts\Decorative\CollectionStatuettes.cs

<pre>this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2)</pre>

Fragment 7 in file Scripts\Items\Artifacts\Decorative\MuseumStatues.cs

<pre>this.TurnedOn && this.IsLockedDown && (!m.Hidden || m.IsPlayer()) && Utility.InRange(m.Location, this.Location, 2) && !Utility.InRange(oldLocation, this.Location, 2)</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DoorGenerator.cs

<pre>if (first != null && second != null)
                                {
                                    first.Link = second;
                                    second.Link = first;
                                }
                                else
                                {
                                    if (first != null)
                                        first.Delete();

                                    if (second != null)
                                        second.Delete();
                                }</pre>

Fragment 2 in file Scripts\Commands\DoorGenerator.cs

<pre>if (first != null && second != null)
                                {
                                    first.Link = second;
                                    second.Link = first;
                                }
                                else
                                {
                                    if (first != null)
                                        first.Delete();

                                    if (second != null)
                                        second.Delete();
                                }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\HouseGump.cs

<pre>Mobile m = (Mobile)list[i];

                    string name;

                    if (m == null || (name = m.Name) == null || (name = name.Trim()).Length <= 0)
                        continue;</pre>

Fragment 2 in file Scripts\Gumps\HouseGump.cs

<pre>Mobile m = (Mobile)list[i];

                    string name;

                    if (m == null || (name = m.Name) == null || (name = name.Trim()).Length <= 0)
                        continue;</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetPoint2DGump.cs

<pre>if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);
            this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 3, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Gumps\Properties\SetPoint3DGump.cs

<pre>if (SetGumpID != 0)
                this.AddImageTiled(x, y, SetWidth, EntryHeight, SetGumpID);
            this.AddButton(x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 3, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\AddonComponent.cs

<pre>public void OnChop(Mobile from)
        {
            if (this.m_Addon != null && from.InRange(this.GetWorldLocation(), 3))
                this.m_Addon.OnChop(from);
            else
                from.SendLocalizedMessage(500446); // That is too far away.
        }</pre>

Fragment 2 in file Scripts\Items\Addons\AddonContainerComponent.cs

<pre>public virtual void OnChop(Mobile from)
        {
            if (this.m_Addon != null && from.InRange(this.GetWorldLocation(), 3))
                this.m_Addon.OnChop(from);
            else
                from.SendLocalizedMessage(500446); // That is too far away.
        }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BaseAddonContainerDeed.cs

<pre>Type resourceType = typeRes;

            if (resourceType == null)
                resourceType = craftItem.Resources.GetAt(0).ItemType;

            this.Resource = CraftResources.GetFromType(resourceType);

            CraftContext context = craftSystem.GetContext(from);</pre>

Fragment 2 in file Scripts\Items\Addons\BaseAddonDeed.cs

<pre>Type resourceType = typeRes;

            if (resourceType == null)
                resourceType = craftItem.Resources.GetAt(0).ItemType;

            this.Resource = CraftResources.GetFromType(resourceType);

            CraftContext context = craftSystem.GetContext(from);</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\FlourMillEastAddon.cs

<pre>public void StartWorking(Mobile from)
        {
            if (this.IsWorking)
                return;

            this.m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(5.0), new TimerStateCallback(FinishWorking_Callback), from);
            this.UpdateStage();
        }</pre>

Fragment 2 in file Scripts\Items\Addons\FlourMillSouthAddon.cs

<pre>public void StartWorking(Mobile from)
        {
            if (this.IsWorking)
                return;

            this.m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(5.0), new TimerStateCallback(FinishWorking_Callback), from);
            this.UpdateStage();
        }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Consumables\BasePigmentsOfTokuno.cs

<pre>private static bool IsInTypeList(Type t, Type[] list)
        {
            for (int i = 0; i < list.Length; i++)
            {
                if (list[i] == t)
                    return true;
            }

            return false;
        }</pre>

Fragment 2 in file Scripts\Items\Resource\ScouringToxin.cs

<pre>private static bool IsInTypeList(Type t, Type[] list)
        {
            for (int i = 0; i < list.Length; i++)
            {
                if (list[i] == t) return true;
            }

            return false;
        }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>case 0:
							m_AosAttributes.WeaponDamage += attrInfo.WeaponDamage;
							break;
						case 1:
							m_AosAttributes.WeaponSpeed += attrInfo.WeaponSwingSpeed;
							break;
						case 2:
							m_AosAttributes.AttackChance += attrInfo.WeaponHitChance;
							break;
						case 3:
							m_AosAttributes.Luck += attrInfo.WeaponLuck;</pre>

Fragment 2 in file Scripts\Items\Tools\FishingPole.cs

<pre>case 0: m_AosAttributes.WeaponDamage += attrInfo.WeaponDamage; break;
                        case 1: m_AosAttributes.WeaponSpeed += attrInfo.WeaponSwingSpeed; break;
                        case 2: m_AosAttributes.AttackChance += attrInfo.WeaponHitChance; break;
                        case 3: m_AosAttributes.Luck += attrInfo.WeaponLuck;</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\AOS.cs

<pre>{
                    AosAttributes attrs = ((BaseWeapon)obj).Attributes;

                    if (attrs != null)
                        value += attrs[attribute];

                    if (attribute == AosAttribute.Luck)
                        value += ((BaseWeapon)obj).GetLuckBonus();
                }</pre>

Fragment 2 in file Scripts\Misc\AOS.cs

<pre>{
                    AosAttributes attrs = ((BaseArmor)obj).Attributes;

                    if (attrs != null)
                        value += attrs[attribute];

                    if (attribute == AosAttribute.Luck)
                        value += ((BaseArmor)obj).GetLuckBonus();
                }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Ilhenir.cs

<pre>public virtual void PackTalismans(int amount)
        {
            int count = Utility.Random(amount);

            for (int i = 0; i < count; i++)
                this.PackItem(new RandomTalisman());
        }</pre>

Fragment 2 in file Scripts\Mobiles\Named\Meraktus.cs

<pre>public virtual void PackTalismans(int amount)
        {
            int count = Utility.Random(amount);

            for (int i = 0; i < count; i++)
                this.PackItem(new RandomTalisman());
        }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Llama.cs

<pre>this.SetInt(16, 30);

            this.SetHits(15, 27);
            this.SetMana(0);

            this.SetDamage(3, 5);

            this.SetDamageType(ResistanceType.Physical, 100);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RidableLlama.cs

<pre>this.SetInt(16, 30);

            this.SetHits(15, 27);
            this.SetMana(0);

            this.SetDamage(3, 5);

            this.SetDamageType(ResistanceType.Physical, 100);</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\ArcherGuard.cs

<pre>public override void OnAfterDelete()
		{
			if (m_AttackTimer != null)
			{
				m_AttackTimer.Stop();
				m_AttackTimer = null;
			}

			if (m_IdleTimer != null)
			{
				m_IdleTimer.Stop();
				m_IdleTimer = null;
			}

			base.OnAfterDelete();
		}</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\WarriorGuard.cs

<pre>public override void OnAfterDelete()
		{
			if (m_AttackTimer != null)
			{
				m_AttackTimer.Stop();
				m_AttackTimer = null;
			}

			if (m_IdleTimer != null)
			{
				m_IdleTimer.Stop();
				m_IdleTimer = null;
			}

			base.OnAfterDelete();
		}</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>public override void AlterLightLevel(Mobile m, ref int global, ref int personal)
        {
            base.AlterLightLevel(m, ref global, ref personal);
            global = Math.Max(global, 1 + this.m_Spawn.Level);	//This is a guesstimate.  TODO: Verify & get exact values // OSI testing: at 2 red skulls, light = 0x3 ; 1 red = 0x3.; 3 = 8; 9 = 0xD 8 = 0xD 12 = 0x12 10 = 0xD
        }</pre>

Fragment 2 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>public override void AlterLightLevel(Mobile m, ref int global, ref int personal)
        {
            base.AlterLightLevel(m, ref global, ref personal);
            global = Math.Max(global, 1 + this.m_Spawn.Level);	//This is a guesstimate.  TODO: Verify & get exact values // OSI testing: at 2 red skulls, light = 0x3 ; 1 red = 0x3.; 3 = 8; 9 = 0xD 8 = 0xD 12 = 0x12 10 = 0xD
        }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Pathing\Movement.cs

<pre>(!isSet || calcTop >= zCenter) && ((id.Flags & TileFlag.Surface) != 0 || (m != null && m.CanSwim && (id.Flags & TileFlag.Wet) != 0)) && loc.Z >= calcTop</pre>

Fragment 2 in file Scripts\Services\Pathing\Movement.cs

<pre>(!isSet || calcTop >= zCenter) && ((id.Flags & TileFlag.Surface) != 0 || (m != null && m.CanSwim && (id.Flags & TileFlag.Wet) != 0)) && loc.Z >= calcTop</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Loot\BracersofAlchemicalDevastation.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString());
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Loot\GargishBracersofAlchemicalDevastation.cs

<pre>public override void AppendChildNameProperties(ObjectPropertyList list)
        {
            base.AppendChildNameProperties(list);

            int prop;

            if ((prop = this.m_AosWeaponAttributes.HitFireball) != 0)
                list.Add(1060420, prop.ToString());
        }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new NamedInfoCol[] // armor
                    {
                        new NamedInfoCol("RandomEater", EaterTable),
                        new NamedInfoCol(AosAttribute.BonusHits, ArmorHitsTable),
                        new NamedInfoCol(AosAttribute.BonusStr, ArmorStrTable),
                        new NamedInfoCol(AosAttribute.RegenHits, ArmorRegenTable),
                    }</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new NamedInfoCol[] // shield
                    {
                        new NamedInfoCol("RandomEater", EaterTable),
                        new NamedInfoCol(AosAttribute.BonusHits, ArmorHitsTable),
                        new NamedInfoCol(AosAttribute.BonusStr, ArmorStrTable),
                        new NamedInfoCol(AosAttribute.RegenHits, ArmorRegenTable),
                    }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new NamedInfoCol[] // armor
                    {
                        new NamedInfoCol(AosAttribute.RegenHits, ArmorRegenTable),
                        new NamedInfoCol(AosAttribute.RegenStam, ArmorRegenTable),
                        new NamedInfoCol(AosAttribute.RegenMana, ArmorRegenTable),

                        new NamedInfoCol("RandomEater",  EaterTable),
                    }</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new NamedInfoCol[]
                    {
                        new NamedInfoCol(AosAttribute.RegenHits, ArmorRegenTable),
                        new NamedInfoCol(AosAttribute.RegenStam, ArmorRegenTable),
                        new NamedInfoCol(AosAttribute.RegenMana, ArmorRegenTable),
                        new NamedInfoCol("RandomEater", EaterTable),
                    }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>new int[] { -1, 0, 1, 2, 3, -1, -1, 1, 0, 0, -2, -2, -1, 1, 1, -2 }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>new int[] { -1, 0, 1, 2, 3, -1, -1, -1, 0, -2, -2, 0, 1, -2, 1, 1 }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>int hue;

				if (m_NameHue != -1)
				{
					hue = m_NameHue;
				}
				else if (IsStaff())
				{
					hue = 11;
				}
				else
				{
					hue = Notoriety.GetHue(Notoriety.Compute(from, this));
				}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>int hue;

			if (m_NameHue != -1)
			{
				hue = m_NameHue;
			}
			else if (IsStaff())
			{
				hue = 11;
			}
			else
			{
				hue = Notoriety.GetHue(Notoriety.Compute(from, this));
			}</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Escortables.cs

<pre>{
            this.Title = "the noble";

            this.SetSkill(SkillName.Parry, 80.0, 100.0);
            this.SetSkill(SkillName.Swords, 80.0, 100.0);
            this.SetSkill(SkillName.Tactics, 80.0, 100.0);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Noble.cs

<pre>{
            this.Title = "the noble";

            this.SetSkill(SkillName.Parry, 80.0, 100.0);
            this.SetSkill(SkillName.Swords, 80.0, 100.0);
            this.SetSkill(SkillName.Tactics, 80.0, 100.0);
        }</pre>

Fragment 3 in file Scripts\Quests\Escortables.cs

<pre>{
            this.Title = "the noble";

            this.SetSkill(SkillName.Parry, 80.0, 100.0);
            this.SetSkill(SkillName.Swords, 80.0, 100.0);
            this.SetSkill(SkillName.Tactics, 80.0, 100.0);
        }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Items.cs

<pre>public override void OnDoubleClick(Mobile from)
		{
			if(IsChildOf(from.Backpack))
			{
				from.SendGump(new SouthEastGump(s =>
				{
					SouthFacing = s;
					base.OnDoubleClick(from);
				}));
			}
		}</pre>

Fragment 2 in file Scripts\Quests\Eodon\Valley of One Quest\Items.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.SendGump(new SouthEastGump(s =>
                {
                    SouthFacing = s;
                    base.OnDoubleClick(from);
                }));
            }
        }</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\AuctionSafe\AuctionSafe.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.SendGump(new SouthEastGump(s =>
                {
                    SouthFacing = s;
                    base.OnDoubleClick(from);
                }));
            }
        }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ViceVsVirtue\Items\Rewards\VvVTraps.cs

<pre>int dam = Utility.RandomMinMax(MinDamage, MaxDamage);

            if (DeploymentType == DeploymentType.Tripwire)
                dam *= 2;

			AOS.Damage(m, Owner, dam, 0, 0, 0, 100, 0);</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\Items\Rewards\VvVTraps.cs

<pre>int dam = Utility.RandomMinMax(MinDamage, MaxDamage);

            if (DeploymentType == DeploymentType.Tripwire)
                dam *= 2;

			AOS.Damage(m, Owner, dam, 0, 0, 100, 0, 0);</pre>

Fragment 3 in file Scripts\Services\ViceVsVirtue\Items\Rewards\VvVTraps.cs

<pre>int dam = Utility.RandomMinMax(MinDamage, MaxDamage);

            if (DeploymentType == DeploymentType.Tripwire)
                dam *= 2;

			AOS.Damage(m, Owner, dam, 100, 0, 0, 0, 0);</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write((short)0); // itemID
			m_Stream.Write((short)target.X);
			m_Stream.Write((short)target.Y);
			m_Stream.Write((sbyte)target.Z);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write((short)target.X);
			m_Stream.Write((short)target.Y);
			m_Stream.Write((sbyte)target.Z);
			m_Stream.Write((byte)0); // speed</pre>

Fragment 3 in file Server\Network\Packets.cs

<pre>m_Stream.Write((short)0); // volume
			m_Stream.Write((short)target.X);
			m_Stream.Write((short)target.Y);
			m_Stream.Write((short)target.Z);</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Craft Addons\FletchingStation.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.SendGump(new SouthEastGump(s =>
                {
                    _South = s;
                    base.OnDoubleClick(from);
                }));
            }
        }</pre>

Fragment 2 in file Scripts\Items\Addons\Craft Addons\SewingMachine.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.SendGump(new SouthEastGump(s =>
                {
                    _South = s;
                    base.OnDoubleClick(from);
                }));
            }
        }</pre>

Fragment 3 in file Scripts\Items\Addons\Craft Addons\SmithingPress.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.SendGump(new SouthEastGump(s =>
                {
                    _South = s;
                    base.OnDoubleClick(from);
                }));
            }
        }</pre>

Fragment 4 in file Scripts\Items\Addons\Craft Addons\SpinningLathe.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (IsChildOf(from.Backpack))
            {
                from.SendGump(new SouthEastGump(s =>
                {
                    _South = s;
                    base.OnDoubleClick(from);
                }));
            }
        }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public bool IsImbued
        {
            get
            {
                if (this.TimesImbued >= 1 && !m_IsImbued)
                    m_IsImbued = true;

                return m_IsImbued;
            }
            set
            {
                if (this.TimesImbued >= 1)
                    m_IsImbued = true;
                else
                    m_IsImbued = value; InvalidateProperties();
            }
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public bool IsImbued
        {
            get
            {
                if (this.TimesImbued >= 1 && !m_IsImbued)
                    m_IsImbued = true;

                return m_IsImbued;
            }
            set
            {
                if (this.TimesImbued >= 1)
                    m_IsImbued = true;
                else
                    m_IsImbued = value; InvalidateProperties();
            }
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public bool IsImbued
        {
            get
            {
                if (this.TimesImbued >= 1 && !m_IsImbued)
                    m_IsImbued = true;

                return m_IsImbued;
            }
            set
            {
                if (this.TimesImbued >= 1)
                    m_IsImbued = true;
                else
                    m_IsImbued = value; InvalidateProperties();
            }
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public bool IsImbued
        {
            get 
            {
                if (this.TimesImbued >= 1 && !m_IsImbued)
                    m_IsImbued = true;

                return m_IsImbued; 
            }
            set 
            {
                if (this.TimesImbued >= 1)
                    m_IsImbued = true;
                else
                    m_IsImbued = value; InvalidateProperties();
            }
        }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>status_str = null;
			Item refitem = null;
			Mobile refmob = null;

			if (refobject is Item)
			{
				refitem = (Item)refobject;
			}
			else
				if (refobject is Mobile)
				{
					refmob = (Mobile)refobject;
				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>status_str = null;
			Item refitem = null;
			Mobile refmob = null;
			if (refobject is Item)
			{
				refitem = (Item)refobject;
			}
			else
				if (refobject is Mobile)
				{
					refmob = (Mobile)refobject;
				}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>status_str = null;
			Item refitem = null;
			Mobile refmob = null;

			if (refobject is Item)
			{
				refitem = (Item)refobject;
			}
			else if (refobject is Mobile)
			{
				refmob = (Mobile)refobject;
			}</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>status_str = null;
			Item refitem = null;
			Mobile refmob = null;
			if (refobject is Item)
			{
				refitem = (Item)refobject;
			}
			else if (refobject is Mobile)
			{
				refmob = (Mobile)refobject;
			}</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BaseAddon.cs

<pre>[CommandProperty(AccessLevel.Decorator)]
        public CraftResource Resource
        {
            get
            {
                return this.m_Resource;
            }
            set
            {
                if (this.m_Resource != value)
                {
                    this.m_Resource = value;
                    this.Hue = CraftResources.GetHue(this.m_Resource);

                    this.InvalidateProperties();
                }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Addons\BaseAddonContainer.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public CraftResource Resource
        {
            get
            {
                return this.m_Resource;
            }
            set
            {
                if (this.m_Resource != value)
                {
                    this.m_Resource = value;
                    this.Hue = CraftResources.GetHue(this.m_Resource);

                    this.InvalidateProperties();
                }
            }
        }</pre>

Fragment 3 in file Scripts\Items\Addons\BaseAddonContainerDeed.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public CraftResource Resource
        {
            get
            {
                return this.m_Resource;
            }
            set
            {
                if (this.m_Resource != value)
                {
                    this.m_Resource = value;
                    this.Hue = CraftResources.GetHue(this.m_Resource);

                    this.InvalidateProperties();
                }
            }
        }</pre>

Fragment 4 in file Scripts\Items\Addons\BaseAddonDeed.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public CraftResource Resource
        {
            get
            {
                return this.m_Resource;
            }
            set
            {
                if (this.m_Resource != value)
                {
                    this.m_Resource = value;
                    this.Hue = CraftResources.GetHue(this.m_Resource);

                    this.InvalidateProperties();
                }
            }
        }</pre>

Fragment 5 in file Scripts\Items\Decorative\CraftableFurniture.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public CraftResource Resource
        {
            get
            {
                return this.m_Resource;
            }
            set
            {
                if (this.m_Resource != value)
                {
                    this.m_Resource = value;
                    this.Hue = CraftResources.GetHue(this.m_Resource);

                    this.InvalidateProperties();
                }
            }
        }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\BaseGalleon.cs

<pre>item =>
            {
                item.Location = new Point3D(X + (item.X - old.X), Y + (item.Y - old.Y), Z + (item.Z - old.Z));
            }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\BaseGalleon.cs

<pre>item =>
            {
                item.Location = new Point3D(X + (item.X - old.X), Y + (item.Y - old.Y), Z + (item.Z - old.Z));
            }</pre>

Fragment 3 in file Scripts\Services\Expansions\High Seas\Multis\BaseGalleon.cs

<pre>item =>
            {
                item.Location = new Point3D(X + (item.X - old.X), Y + (item.Y - old.Y), Z + (item.Z - old.Z));
            }</pre>

Fragment 4 in file Scripts\Services\Expansions\High Seas\Multis\BaseGalleon.cs

<pre>item =>
            {
                item.Location = new Point3D(X + (item.X - old.X), Y + (item.Y - old.Y), Z + (item.Z - old.Z));
            }</pre>

Fragment 5 in file Scripts\Services\Expansions\High Seas\Multis\BaseGalleon.cs

<pre>item =>
            {
                item.Location = new Point3D(X + (item.X - old.X), Y + (item.Y - old.Y), Z + (item.Z - old.Z));
            }</pre>

## Duplicated Code. Size: 89

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Reports\Objects\Charts\ChartItemCollection.cs

<pre>/// <summary>
            /// Gets the current element in the collection.
            /// </summary>
            object IEnumerator.Current
            {
                get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }
            }</pre>

Fragment 2 in file Scripts\Services\Reports\Objects\Reports\ItemValueCollection.cs

<pre>/// <summary>
            /// Gets the current element in the collection.
            /// </summary>
            object IEnumerator.Current
            {
                get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }
            }</pre>

Fragment 3 in file Scripts\Services\Reports\Objects\Reports\ReportColumnCollection.cs

<pre>/// <summary>
            /// Gets the current element in the collection.
            /// </summary>
            object IEnumerator.Current
            {
                get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }
            }</pre>

Fragment 4 in file Scripts\Services\Reports\Objects\Reports\ReportItemCollection.cs

<pre>/// <summary>
            /// Gets the current element in the collection.
            /// </summary>
            object IEnumerator.Current
            {
                get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }
            }</pre>

Fragment 5 in file Scripts\Services\Reports\Objects\Snapshots\SnapshotCollection.cs

<pre>/// <summary>
            /// Gets the current element in the collection.
            /// </summary>
            object IEnumerator.Current
            {
                get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }
            }</pre>

Fragment 6 in file Scripts\Services\Reports\Objects\Staffing\PageInfoCollection.cs

<pre>/// <summary>
            /// Gets the current element in the collection.
            /// </summary>
            object IEnumerator.Current
            {
                get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }
            }</pre>

Fragment 7 in file Scripts\Services\Reports\Objects\Staffing\QueueStatusCollection.cs

<pre>/// <summary>
            /// Gets the current element in the collection.
            /// </summary>
            object IEnumerator.Current
            {
                get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }
            }</pre>

Fragment 8 in file Scripts\Services\Reports\Objects\Staffing\ResponseInfoCollection.cs

<pre>/// <summary>
            /// Gets the current element in the collection.
            /// </summary>
            object IEnumerator.Current
            {
                get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }
            }</pre>

Fragment 9 in file Scripts\Services\Reports\Persistence\PersistableObjectCollection.cs

<pre>/// <summary>
            /// Gets the current element in the collection.
            /// </summary>
            object IEnumerator.Current
            {
                get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }
            }</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>{
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                wall.MapDest = Map.Parse(this.m_Params[i].Substring(++indexOf));
                        }</pre>

Fragment 2 in file Scripts\Commands\DecorateDelete.cs

<pre>{
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                wall.MapDest = Map.Parse(this.m_Params[i].Substring(++indexOf));
                        }</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>{
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                wall.PointDest = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                        }</pre>

Fragment 2 in file Scripts\Commands\DecorateDelete.cs

<pre>{
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                wall.PointDest = Point3D.Parse(this.m_Params[i].Substring(++indexOf));
                        }</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Commands\Interface.cs

<pre>this.AddEntryHeader(20);

            this.AddNewLine();
            this.AddEntryHtml(20 + this.OffsetSize + 160, "Properties");
            this.AddEntryButton(20, ArrowRightID1, ArrowRightID2, 2, ArrowRightWidth, ArrowRightHeight);</pre>

Fragment 2 in file Scripts\Commands\Generic\Commands\Interface.cs

<pre>this.AddEntryHeader(20);

            this.AddNewLine();
            this.AddEntryHtml(20 + this.OffsetSize + 160, "Properties");
            this.AddEntryButton(20, ArrowRightID1, ArrowRightID2, 2, ArrowRightWidth, ArrowRightHeight);</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\HouseDemolishGump.cs

<pre>AddPage(0);

			AddBackground(0, 0, 420, 280, 5054);

			AddImageTiled(10, 10, 400, 20, 2624);
			AddAlphaRegion(10, 10, 400, 20);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlPartialCategorizedAddGump.cs

<pre>AddPage( 0 );

			AddBackground( 0, 0, 420, 280, 5054 );

			AddImageTiled( 10, 10, 400, 20, 2624 );
			AddAlphaRegion( 10, 10, 400, 20 );</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Banner.cs

<pre>this.Closable = true;
                    this.Disposable = true;
                    this.Dragable = true;
                    this.Resizable = false;

                    this.AddPage(0);

                    this.AddBackground(0, 0, 300, 150, 0xA28);</pre>

Fragment 2 in file Scripts\Items\Addons\StoneAnkh.cs

<pre>this.Closable = true;
                this.Disposable = true;
                this.Dragable = true;
                this.Resizable = false;

                this.AddPage(0);

                this.AddBackground(0, 0, 300, 150, 0xA28);</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DecorativeShield.cs

<pre>this.Closable = true;
                this.Disposable = true;
                this.Dragable = true;
                this.Resizable = false;

                this.AddPage(0);

                this.AddBackground(25, 0, 500, 230, 0xA28);</pre>

Fragment 2 in file Scripts\Items\Addons\HangingSkeleton.cs

<pre>this.Closable = true;
                this.Disposable = true;
                this.Dragable = true;
                this.Resizable = false;

                this.AddPage(0);

                this.AddBackground(25, 0, 500, 230, 0xA28);</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\DespiseArtifacts.cs

<pre>{
			Hue = 2714; 

			WeaponAttributes.HitLightning = 15;
			WeaponAttributes.HitColdArea = 100;
			WeaponAttributes.HitLeechMana = 30;
			Attributes.AttackChance = 20;
			Attributes.WeaponSpeed = 25;
			Attributes.WeaponDamage = 50;
			AosElementDamages.Cold = 100;
		}</pre>

Fragment 2 in file Scripts\Items\Artifacts\DespiseArtifacts.cs

<pre>{
			Hue = 2714;

			WeaponAttributes.HitLightning = 15;
			WeaponAttributes.HitColdArea = 100;
			WeaponAttributes.HitLeechMana = 30;
			Attributes.AttackChance = 20;
			Attributes.WeaponSpeed = 25;
			Attributes.WeaponDamage = 50;
			AosElementDamages.Cold = 100;
		}</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\BaseTreasureChest.cs

<pre>public void Reset()
        {
            if (this.m_ResetTimer != null)
            {
                if (this.m_ResetTimer.Running)
                    this.m_ResetTimer.Stop();
            }

            this.Locked = true;
            this.ClearContents();
            this.GenerateTreasure();
        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\SorcerersRewardChest.cs

<pre>public void Reset()
        {
            if (this.m_ResetTimer != null)
            {
                if (this.m_ResetTimer.Running)
                    this.m_ResetTimer.Stop();
            }

            this.Locked = true;
            this.ClearContents();
            this.GenerateTreasure();
        }</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\GargishClothArmor.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile)
            {
                if (((Mobile)parent).Female)
                    this.ItemID = 0x0403;
                else
                    this.ItemID = 0x0404;
            }
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\Arms.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile)
            {
                if (((Mobile)parent).Female)
                    this.ItemID = 0x0403;
                else
                    this.ItemID = 0x0404;
            }
        }</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\GargishClothArmor.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile)
            {
                if (((Mobile)parent).Female)
                    this.ItemID = 0x0405;
                else
                    this.ItemID = 0x0406;
            }
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\Shirts.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile)
            {
                if (((Mobile)parent).Female)
                    this.ItemID = 0x0405;
                else
                    this.ItemID = 0x0406;
            }
        }</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\GargishClothArmor.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile)
            {
                if (((Mobile)parent).Female)
                    this.ItemID = 0x0409;
                else
                    this.ItemID = 0x040A;
            }
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\Pants.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile)
            {
                if (((Mobile)parent).Female)
                    this.ItemID = 0x0409;
                else
                    this.ItemID = 0x040A;
            }
        }</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\GargishClothArmor.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile)
            {
                if (((Mobile)parent).Female)
                    this.ItemID = 0x0407;
                else
                    this.ItemID = 0x0408;
            }
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\OuterLegs.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile)
            {
                if (((Mobile)parent).Female)
                    this.ItemID = 0x0407;
                else
                    this.ItemID = 0x0408;
            }
        }</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\BaseDecayingItem.cs

<pre>{
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }</pre>

Fragment 2 in file Scripts\Services\Underworld\PuzzleRoom\MastermindPuzzleItem.cs

<pre>{
                Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                Effects.PlaySound(this.Location, this.Map, 0x201);
            }</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>m_Mobile.ControlMaster.RevealingAction();
					m_Mobile.Home = m_Mobile.Location;
					m_Mobile.CurrentSpeed = m_Mobile.PassiveSpeed;
					m_Mobile.PlaySound(m_Mobile.GetIdleSound());
					m_Mobile.Warmode = false;
					m_Mobile.Combatant = null;
					break;</pre>

Fragment 2 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>m_Mobile.ControlMaster.RevealingAction();
					m_Mobile.Home = m_Mobile.Location;
					m_Mobile.CurrentSpeed = m_Mobile.PassiveSpeed;
					m_Mobile.PlaySound(m_Mobile.GetIdleSound());
					m_Mobile.Warmode = false;
					m_Mobile.Combatant = null;
					break;</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MysticAI.cs

<pre>{
                if (m_Mobile.Combatant != null && m_Mobile.InRange(m_Mobile.Combatant.Location, 8))
				{
					t.Invoke(m_Mobile, m_Mobile.Combatant);
				}
				else
					t.Invoke(m_Mobile, m_Mobile);

				return true;
			}</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellWeavingAI.cs

<pre>{
                if (m_Mobile.Combatant != null && m_Mobile.InRange(m_Mobile.Combatant.Location, 8))
				{
					t.Invoke(m_Mobile, m_Mobile.Combatant);
				}
				else
					t.Invoke(m_Mobile, m_Mobile);

				return true;
			}</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Harrower\HarrowerTentacles.cs

<pre>if (m is BaseCreature)
                    {
                        BaseCreature bc = m as BaseCreature;

                        if (bc.Controlled || bc.Summoned)
                            m_ToDrain.Add(m);
                    }
                    else if (m.Player)
                    {
                        m_ToDrain.Add(m);
                    }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\DiabolicalSeaweed.cs

<pre>if (m is BaseCreature)
                    {
                        BaseCreature bc = m as BaseCreature;

                        if (bc.Controlled || bc.Summoned)
                            m_ToDrain.Add(m);
                    }
                    else if (m.Player)
                    {
                        m_ToDrain.Add(m);
                    }</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Beetle.cs

<pre>this.SetSkill(SkillName.Tactics, 100.0);
            this.SetSkill(SkillName.Wrestling, 100.0);

            this.Fame = 4000;
            this.Karma = -4000;

            this.Tamable = true;
            this.ControlSlots = 3;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\FireBeetle.cs

<pre>this.SetSkill(SkillName.Tactics, 100.0);
            this.SetSkill(SkillName.Wrestling, 100.0);

            this.Fame = 4000;
            this.Karma = -4000;

            this.Tamable = true;
            this.ControlSlots = 3;</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\OphidianKnight.cs

<pre>SetResistance(ResistanceType.Fire, 30, 40);
            SetResistance(ResistanceType.Cold, 35, 45);
            SetResistance(ResistanceType.Poison, 90, 100);
            SetResistance(ResistanceType.Energy, 35, 45);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\TerathanAvenger.cs

<pre>SetResistance(ResistanceType.Fire, 30, 40);
            SetResistance(ResistanceType.Cold, 35, 45);
            SetResistance(ResistanceType.Poison, 90, 100);
            SetResistance(ResistanceType.Energy, 35, 45);</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\OphidianKnight.cs

<pre>SetSkill(SkillName.Poisoning, 60.1, 80.0);
            SetSkill(SkillName.MagicResist, 65.1, 80.0);
            SetSkill(SkillName.Tactics, 90.1, 100.0);
            SetSkill(SkillName.Wrestling, 90.1, 100.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\TerathanAvenger.cs

<pre>SetSkill(SkillName.Poisoning, 60.1, 80.0);
            SetSkill(SkillName.MagicResist, 65.1, 80.0);
            SetSkill(SkillName.Tactics, 90.1, 100.0);
            SetSkill(SkillName.Wrestling, 90.1, 100.0);</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\OphidianWarrior.cs

<pre>SetResistance(ResistanceType.Fire, 20, 30);
            SetResistance(ResistanceType.Cold, 25, 35);
            SetResistance(ResistanceType.Poison, 30, 40);
            SetResistance(ResistanceType.Energy, 25, 35);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\TerathanWarrior.cs

<pre>SetResistance(ResistanceType.Fire, 20, 30);
            SetResistance(ResistanceType.Cold, 25, 35);
            SetResistance(ResistanceType.Poison, 30, 40);
            SetResistance(ResistanceType.Energy, 25, 35);</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\YoungNinja.cs

<pre>Utility.AssignRandomHair(this);
            Utility.AssignRandomFacialHair(this);

            this.AddItem(new NinjaTabi());
            this.AddItem(new LeatherNinjaPants());
            this.AddItem(new LeatherNinjaJacket());</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Henchman.cs

<pre>Utility.AssignRandomHair(this);
            Utility.AssignRandomFacialHair(this);

            this.AddItem(new LeatherNinjaJacket());
            this.AddItem(new LeatherNinjaPants());
            this.AddItem(new NinjaTabi());</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Banker.cs

<pre>public override void AddCustomContextEntries(Mobile from, List<ContextMenuEntry> list)
        {
            if (from.Alive)
            {
                list.Add(new OpenBankEntry(from, this));
            }

            base.AddCustomContextEntries(from, list);
        }</pre>

Fragment 2 in file Scripts\Services\MaginciaBazaar\VendorMallManager.cs

<pre>public override void AddCustomContextEntries(Mobile from, List<ContextMenuEntry> list)
		{
			if (from.Alive)
			{
				list.Add(new OpenBankEntry(from, this));
			}

			base.AddCustomContextEntries(from, list);
		}</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Dryad.cs

<pre>this.Add(new GenericBuyInfo(typeof(Bloodmoss), 5, 20, 0xF7B, 0));
                this.Add(new GenericBuyInfo(typeof(Nightshade), 3, 20, 0xF88, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBHerbalist.cs

<pre>this.Add(new GenericBuyInfo(typeof(Nightshade), 3, 20, 0xF88, 0)); 
                this.Add(new GenericBuyInfo(typeof(Bloodmoss), 5, 20, 0xF7B, 0));</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\PlayerMobile.cs

<pre>if (suffix.Length > 0)
                    suffix = String.Format("{0} [{1}]", suffix, Utility.FixHtml(guild.Abbreviation));
                else
                    suffix = String.Format("[{0}]", Utility.FixHtml(guild.Abbreviation));</pre>

Fragment 2 in file Server\Mobile.cs

<pre>if (suffix.Length > 0)
                    suffix = String.Format("{0} [{1}]", suffix, Utility.FixHtml(guild.Abbreviation));
                else
                    suffix = String.Format("[{0}]", Utility.FixHtml(guild.Abbreviation));</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Boats\BaseBoatDeed.cs

<pre>if (boat.IsClassicBoat)
                    {
                        uint keyValue = boat.CreateKeys(from);

                        if (boat.PPlank != null)
                            boat.PPlank.KeyValue = keyValue;

                        if (boat.SPlank != null)
                            boat.SPlank.KeyValue = keyValue;
                    }</pre>

Fragment 2 in file Scripts\Multis\Boats\BaseDockedBoat.cs

<pre>if (boat.IsClassicBoat)
                    {
                        uint keyValue = boat.CreateKeys(from);

                        if (boat.PPlank != null)
                            boat.PPlank.KeyValue = keyValue;

                        if (boat.SPlank != null)
                            boat.SPlank.KeyValue = keyValue;
                    }</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\ConfirmTransferPetGump.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            this.AddPage(0);
            this.AddBackground(0, 0, 270, 120, 0x13BE);</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\SelectTitleGump.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;
            this.Resizable = false;

            this.AddPage(0);
            this.AddBackground(0, 0, 270, 120, 0x13BE);</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>xOffset = Utility.RandomMinMax(-1, 1);
                            yOffset = Utility.RandomMinMax(0, 2);
                            hit = new Point3D(pnt.X + xOffset, pnt.Y + yOffset, z);
                            break;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>xOffset = Utility.RandomMinMax(0, 2);
                            yOffset = Utility.RandomMinMax(-1, 1);
                            hit = new Point3D(pnt.X + xOffset, pnt.Y + yOffset, z);
                            break;</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Mobiles\Corgul\CorgulTheSoulbinder.cs

<pre>SetResistance(ResistanceType.Fire, 80, 90);
            SetResistance(ResistanceType.Cold, 85, 95);
            SetResistance(ResistanceType.Poison, 80, 90);
            SetResistance(ResistanceType.Energy, 80, 90);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Mobiles\OsiredonTheScalisEnforcer.cs

<pre>SetResistance(ResistanceType.Fire, 80, 90);
            SetResistance(ResistanceType.Cold, 85, 95);
            SetResistance(ResistanceType.Poison, 80, 90);
            SetResistance(ResistanceType.Energy, 80, 90);</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Mobiles\Corgul\SoulboundBattleMage.cs

<pre>SetResistance(ResistanceType.Physical, 50, 60);
            SetResistance(ResistanceType.Fire, 50, 60);
            SetResistance(ResistanceType.Cold, 50, 60);
            SetResistance(ResistanceType.Poison, 50, 60);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Mobile\LizardmanDefender.cs

<pre>SetResistance(ResistanceType.Physical, 50, 60);
            SetResistance(ResistanceType.Fire, 50, 60);
            SetResistance(ResistanceType.Cold, 50, 60);
            SetResistance(ResistanceType.Poison, 50, 60);</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Spawners\BountyQuestSpawner.cs

<pre>crew.MoveToWorld(new Point3D(gal.X + Utility.RandomList(-1, 1), gal.Y + Utility.RandomList(-1, 0, 1), gal.ZSurface), map);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Spawners\BountyQuestSpawner.cs

<pre>crew.MoveToWorld(new Point3D(gal.X + Utility.RandomList(-1, 1), gal.Y + Utility.RandomList(-1, 0, 1), gal.ZSurface), map);</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Questers\ChampHuthwait.cs

<pre>this.Race = Race.Human;
            this.CantWalk = true;
            this.Blessed = true;

            this.Hue = Utility.RandomSkinHue();
            Utility.AssignRandomHair(this);

            this.AddItem(new Backpack());</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Questers\CusteauPerron.cs

<pre>this.Race = Race.Human;
            this.Blessed = true;

            this.CantWalk = true;
            this.Hue = Utility.RandomSkinHue();
            Utility.AssignRandomHair(this);

            this.AddItem(new Backpack());</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionSorceress.cs

<pre>this.AddItem(this.Immovable(this.Rehued(new WizardsHat(), 1325)));
            this.AddItem(this.Immovable(this.Rehued(new Sandals(), 1325)));</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionWizard.cs

<pre>this.AddItem(this.Immovable(this.Rehued(new WizardsHat(), 1325)));
            this.AddItem(this.Immovable(this.Rehued(new Sandals(), 1325)));</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\MaginciaPlants\MaginciaPlantItem.cs

<pre>Point3D loc = this.GetWorldLocation();

            if (!from.InLOS(loc) || !from.InRange(loc, 2))
            {
                from.LocalOverheadMessage(MessageType.Regular, 0x3E9, 1019045); // I can't reach that.
                return;
            }</pre>

Fragment 2 in file Scripts\Services\Plants\PlantItem.cs

<pre>Point3D loc = this.GetWorldLocation();

			if ( !from.InLOS( loc ) || !from.InRange( loc, 2 ) )
			{
				from.LocalOverheadMessage( MessageType.Regular, 0x3E9, 1019045 ); // I can't reach that.
				return;
			}</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string[] groupargs = null;
					string groupargstring = null;
					if (groupedarglist.Length > 1)
					{
						groupargs = ParseToMatchingParen(groupedarglist[1], '[', ']');

						// and get the first part of the string without the >  so itemargs[0] should be arg2/ag3/arg4
						groupargstring = groupargs[0];
					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string[] groupargs = null;
			string groupargstring = null;
			if (groupedarglist.Length > 1)
			{
				groupargs = ParseToMatchingParen(groupedarglist[1], '[', ']');

				// and get the first part of the string without the >  so itemargs[0] should be arg2/ag3/arg4
				groupargstring = groupargs[0];
			}</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>FileStream fs = null;
                try
                {
                    fs = File.Open(dirname, FileMode.Open, FileAccess.Read);
                }
                catch { }

                if (fs == null)
                {
                    from.SendMessage("Unable to open {0} for loading", dirname);
                    return;
                }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlAdd.cs

<pre>FileStream fs = null;
				try
				{
					fs = File.Open(dirname, FileMode.Open, FileAccess.Read);
				} 
				catch {}

				if(fs == null)
				{
					from.SendMessage("Unable to open {0} for loading", dirname);
					return;
				}</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\Attachments\XmlSiege.cs

<pre>MultiTileEntry t = mcl.List[i];

							int x = t.m_OffsetX + targetitem.X;
							int y = t.m_OffsetY + targetitem.Y;
							int z = t.m_OffsetZ + targetitem.Z;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\Attachments\XmlSiege.cs

<pre>MultiTileEntry t = mcl.List[i];

						int x = t.m_OffsetX + targetitem.X;
						int y = t.m_OffsetY + targetitem.Y;
						int z = t.m_OffsetZ + targetitem.Z;</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\CombatTraining.cs

<pre>if (Caster is PlayerMobile && ((PlayerMobile)Caster).AllFollowers == null || ((PlayerMobile)Caster).AllFollowers.Count == 0)
            {
                Caster.SendLocalizedMessage(1156112); // This ability requires you to have pets.
                return false;
            }

            return base.CheckCast();</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\Whispering.cs

<pre>if (Caster is PlayerMobile && ((PlayerMobile)Caster).AllFollowers == null || ((PlayerMobile)Caster).AllFollowers.Count == 0)
            {
                Caster.SendLocalizedMessage(1156112); // This ability requires you to have pets.
                return false;
            }

			return base.CheckCast();</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBBlacksmith.cs

<pre>this.Add(new GenericBuyInfo(typeof(ChainCoif), 17, 20, 0x13BB, 0));
                this.Add(new GenericBuyInfo(typeof(ChainChest), 143, 20, 0x13BF, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBChainmailArmor.cs

<pre>this.Add(new GenericBuyInfo(typeof(ChainCoif), 17, 20, 0x13BB, 0));
                this.Add(new GenericBuyInfo(typeof(ChainChest), 143, 20, 0x13BF, 0));</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBFarmer.cs

<pre>this.Add(new GenericBuyInfo(typeof(Peach), 3, 20, 0x9D2, 0));
                this.Add(new GenericBuyInfo(typeof(Pear), 3, 20, 0x994, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBInnKeeper.cs

<pre>this.Add(new GenericBuyInfo(typeof(Peach), 3, 20, 0x9D2, 0));
                this.Add(new GenericBuyInfo(typeof(Pear), 3, 20, 0x994, 0));</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBFarmer.cs

<pre>this.Add(new GenericBuyInfo(typeof(Grapes), 3, 20, 0x9D1, 0));
                this.Add(new GenericBuyInfo(typeof(Apple), 3, 20, 0x9D0, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBInnKeeper.cs

<pre>this.Add(new GenericBuyInfo(typeof(Grapes), 3, 20, 0x9D1, 0));
                this.Add(new GenericBuyInfo(typeof(Apple), 3, 20, 0x9D0, 0));</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBProvisioner.cs

<pre>this.Add(new GenericBuyInfo(typeof(Backpack), 15, 20, 0x9B2, 0));
                this.Add(new GenericBuyInfo(typeof(Pouch), 6, 20, 0xE79, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBThief.cs

<pre>this.Add(new GenericBuyInfo(typeof(Backpack), 15, 20, 0x9B2, 0));
                this.Add(new GenericBuyInfo(typeof(Pouch), 6, 20, 0xE79, 0));</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBSECook.cs

<pre>this.Add(new GenericBuyInfo(typeof(Wasabi), 2, 20, 0x24E8, 0));
                this.Add(new GenericBuyInfo(typeof(Wasabi), 2, 20, 0x24E9, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBSEFood.cs

<pre>this.Add(new GenericBuyInfo(typeof(Wasabi), 2, 20, 0x24E8, 0));
                this.Add(new GenericBuyInfo(typeof(Wasabi), 2, 20, 0x24E9, 0));</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\VendorInfo\SBSECook.cs

<pre>this.Add(new GenericBuyInfo(typeof(BentoBox), 6, 20, 0x2836, 0));
                this.Add(new GenericBuyInfo(typeof(BentoBox), 6, 20, 0x2837, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBSEFood.cs

<pre>this.Add(new GenericBuyInfo(typeof(BentoBox), 6, 20, 0x2836, 0));
                this.Add(new GenericBuyInfo(typeof(BentoBox), 6, 20, 0x2837, 0));</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>public override void OnCancel(Mobile from)
			{
				if (m_CallbackHandlesCancel && m_Callback != null)
				{
					m_Callback(from, "", m_State);
				}
				else if (m_CancelCallback != null)
				{
					m_CancelCallback(from, "", m_State);
				}
			}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>public override void OnCancel(Mobile from)
			{
				if (m_CallbackHandlesCancel && m_Callback != null)
				{
					m_Callback(from, "", m_State);
				}
				else if (m_CancelCallback != null)
				{
					m_CancelCallback(from, "", m_State);
				}
			}</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>{
				m_Stream.Write((byte)0x02);

				m_Stream.Write(item.Serial);

				itemID &= 0x3FFF;

				m_Stream.Write((short)itemID);

				m_Stream.Write((byte)0);
			}</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>{
                m_Stream.Write((byte)0x02);
                m_Stream.Write(item.Serial);

                itemID &= 0x3FFF;

                m_Stream.Write((ushort)itemID);

                m_Stream.Write((byte)0);
            }</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Dryad.cs

<pre>this.Add(new GenericBuyInfo(typeof(Ginseng), 3, 20, 0xF85, 0));
                this.Add(new GenericBuyInfo(typeof(Garlic), 3, 20, 0xF84, 0));</pre>

Fragment 2 in file Scripts\VendorInfo\SBHealer.cs

<pre>this.Add(new GenericBuyInfo(typeof(Ginseng), 3, 20, 0xF85, 0));
                this.Add(new GenericBuyInfo(typeof(Garlic), 3, 20, 0xF84, 0));</pre>

Fragment 3 in file Scripts\VendorInfo\SBProvisioner.cs

<pre>this.Add(new GenericBuyInfo(typeof(Garlic), 3, 20, 0xF84, 0));
                this.Add(new GenericBuyInfo(typeof(Ginseng), 3, 20, 0xF85, 0));</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Bard Mastery Quests\SirBerran.cs

<pre>InitStats(125, 100, 25);

            SpeechHue = Utility.RandomDyedHue();
            Hue = Utility.RandomSkinHue();

            if (IsInvulnerable && !Core.AOS)
                NameHue = 0x35;

            Female = false;
            Body = 0x190;</pre>

Fragment 2 in file Scripts\Quests\Bard Mastery Quests\SirFelean.cs

<pre>InitStats(125, 100, 25);

            SpeechHue = Utility.RandomDyedHue();
            Hue = Utility.RandomSkinHue();

            if (IsInvulnerable && !Core.AOS)
                NameHue = 0x35;

            Female = false;
            Body = 0x190;</pre>

Fragment 3 in file Scripts\Quests\Bard Mastery Quests\SirHareus.cs

<pre>InitStats(125, 100, 25);

            SpeechHue = Utility.RandomDyedHue();
            Hue = Utility.RandomSkinHue();

            if (IsInvulnerable && !Core.AOS)
                NameHue = 0x35;

            Female = false;
            Body = 0x190;</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Virtue\CompassionArms.cs

<pre>this.SetHue = 0;
            this.Hue = 0x226;

            this.SetSelfRepair = 5;

            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 5;
            this.SetEnergyBonus = 5;</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Virtue\HonestyGorget.cs

<pre>this.SetHue = 0;
            this.Hue = 0x226;

            this.SetSelfRepair = 5;

            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 5;
            this.SetEnergyBonus = 5;</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Virtue\HonorLegs.cs

<pre>this.SetHue = 0;
            this.Hue = 0x226;

            this.SetSelfRepair = 5;			
            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 5;
            this.SetEnergyBonus = 5;</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Virtue\JusticeBreastplate.cs

<pre>this.SetHue = 0;
            this.Hue = 0x226;

            this.SetSelfRepair = 5;

            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 5;
            this.SetEnergyBonus = 5;</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Virtue\ValorGauntlets.cs

<pre>this.SetHue = 0;
            this.Hue = 0x226;

            this.SetSelfRepair = 5;

            this.SetPhysicalBonus = 5;
            this.SetFireBonus = 5;
            this.SetColdBonus = 5;
            this.SetPoisonBonus = 5;
            this.SetEnergyBonus = 5;</pre>

## Duplicated Code. Size: 88

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\LeafGloves.cs

<pre>public override void OnSingleClick(Mobile from)
        {
            base.OnSingleClick(from);

            if (this.IsArcane)
                this.LabelTo(from, 1061837, String.Format("{0}\t{1}", this.m_CurArcaneCharges, this.m_MaxArcaneCharges));
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\LeatherGloves.cs

<pre>public override void OnSingleClick(Mobile from)
        {
            base.OnSingleClick(from);

            if (this.IsArcane)
                this.LabelTo(from, 1061837, String.Format("{0}\t{1}", this.m_CurArcaneCharges, this.m_MaxArcaneCharges));
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Clothing\Cloaks.cs

<pre>public override void OnSingleClick(Mobile from)
        {
            base.OnSingleClick(from);

            if (this.IsArcane)
                this.LabelTo(from, 1061837, String.Format("{0}\t{1}", this.m_CurArcaneCharges, this.m_MaxArcaneCharges));
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override void OnSingleClick(Mobile from)
        {
            base.OnSingleClick(from);

            if (this.IsArcane)
                this.LabelTo(from, 1061837, String.Format("{0}\t{1}", this.m_CurArcaneCharges, this.m_MaxArcaneCharges));
        }</pre>

Fragment 5 in file Scripts\Items\Equipment\Clothing\Shoes.cs

<pre>public override void OnSingleClick(Mobile from)
        {
            base.OnSingleClick(from);

            if (this.IsArcane)
                this.LabelTo(from, 1061837, String.Format("{0}\t{1}", this.m_CurArcaneCharges, this.m_MaxArcaneCharges));
        }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\DualWield.cs

<pre>public override bool CheckSkills(Mobile from)
        {
            if (this.GetSkill(from, SkillName.Ninjitsu) < 50.0)
            {
                from.SendLocalizedMessage(1063352, "50"); // You need ~1_SKILL_REQUIREMENT~ Ninjitsu skill to perform that attack!
                return false;
            }

            return base.CheckSkills(from);
        }</pre>

Fragment 2 in file Scripts\Abilities\TalonStrike.cs

<pre>public override bool CheckSkills(Mobile from)
        {
            if (this.GetSkill(from, SkillName.Ninjitsu) < 50.0)
            {
                from.SendLocalizedMessage(1063352, "50"); // You need ~1_SKILL_REQUIREMENT~ Ninjitsu skill to perform that attack!
                return false;
            }

            return base.CheckSkills(from);
        }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\NerveStrike.cs

<pre>public override bool CheckSkills(Mobile from)
        {
            if (this.GetSkill(from, SkillName.Bushido) < 50.0)
            {
                from.SendLocalizedMessage(1070768, "50"); // You need ~1_SKILL_REQUIREMENT~ Bushido skill to perform that attack!
                return false;
            }

            return base.CheckSkills(from);
        }</pre>

Fragment 2 in file Scripts\Abilities\RidingSwipe.cs

<pre>public override bool CheckSkills(Mobile from)
        {
            if (this.GetSkill(from, SkillName.Bushido) < 50.0)
            {
                from.SendLocalizedMessage(1070768, "50"); // You need ~1_SKILL_REQUIREMENT~ Bushido skill to perform that attack!
                return false;
            }

            return base.CheckSkills(from);
        }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\TitlesMenu.cs

<pre>if (sk.Base < 30)
                            continue;

                        AddHtml(260, 70 + (index * 22), 245, 16, Color("#FFFFFF", Titles.GetSkillTitle(User, sk)), false, false);</pre>

Fragment 2 in file Scripts\Gumps\TitlesMenu.cs

<pre>if (sk.Base < 30)
                            continue;

                        AddHtml(260, 70 + (index * 22), 245, 16, Color("#FFFFFF", Titles.GetSkillTitle(User, sk)), false, false);</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\PickpocketDips.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);

            writer.Write(this.m_MinSkill);
            writer.Write(this.m_MaxSkill);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\TrainingDummies.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);

            writer.Write(this.m_MinSkill);
            writer.Write(this.m_MaxSkill);
        }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\CuffsOfTheArchmage.cs

<pre>{
            this.SkillBonuses.SetValues(0, SkillName.MagicResist, 15.0);
            this.Attributes.BonusMana = 5;
            this.Attributes.RegenMana = 4;
            this.Attributes.SpellDamage = 20;
            this.ArmorAttributes.MageArmor = 1;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\CuffsOfTheArchmage.cs

<pre>{
            this.SkillBonuses.SetValues(0, SkillName.MagicResist, 15.0);
            this.Attributes.BonusMana = 5;
            this.Attributes.RegenMana = 4;
            this.Attributes.SpellDamage = 20;
            this.ArmorAttributes.MageArmor = 1;
        }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Initiation\InitiationGloves.cs

<pre>{

			this.Weight = 1;	
			this.Hue = 0x9C4;
			//this.Attributes.Brittle = 1; //If you have imbuing add this part in!!!!
			this.LootType = LootType.Blessed;

			SetHue = 0x30;
			SetPhysicalBonus = 2;
			SetFireBonus = 5;
			SetColdBonus = 5;
			SetPoisonBonus = 3;
			SetEnergyBonus = 5;
		}</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Initiation\InitiationGorget.cs

<pre>{

			this.Hue = 0x9C4;
			//this.Attributes.Brittle = 1; //If you have imbuing add this part in!!!!
			this.Weight = 1;	
			this.LootType = LootType.Blessed;

			SetHue = 0x30;
			SetPhysicalBonus = 2;
			SetFireBonus = 5;
			SetColdBonus = 5;
			SetPoisonBonus = 3;
			SetEnergyBonus = 5;
		}</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\TrashBarrel.cs

<pre>if (!base.OnDragDrop(from, dropped))
                return false;

            if (!AddCleanupItem(from, dropped))
            {
                if (dropped.LootType == LootType.Blessed)
                {
                    from.SendLocalizedMessage(1075256); // That is blessed; you cannot throw it away.
                    return false;
                }
            }</pre>

Fragment 2 in file Scripts\Items\Containers\TrashChest.cs

<pre>if (!base.OnDragDrop(from, dropped))
                return false;

            if (!AddCleanupItem(from, dropped))
            {
                if (dropped.LootType == LootType.Blessed)
                {
                    from.SendLocalizedMessage(1075256); // That is blessed; you cannot throw it away.
                    return false;
                }
            }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\MonsterStatuette.cs

<pre>{
                double ran = Utility.RandomDouble();
                if (0.01 > ran)
                    Hue = 1907;
                else if (0.1 > ran)
                    Hue = 2562;
                else if (0.25 > ran)
                    Hue = 2525;
                else
                    Hue = 2309;
            }</pre>

Fragment 2 in file Scripts\Items\Decorative\MonsterStatuette.cs

<pre>{
                    double ran = Utility.RandomDouble();
                    if (0.01 > ran)
                        Hue = 1907;
                    else if (0.1 > ran)
                        Hue = 2562;
                    else if (0.25 > ran)
                        Hue = 2525;
                    else
                        Hue = 2309;
                }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if (UseSkillMod && m_AccuracyLevel != WeaponAccuracyLevel.Regular && Parent is Mobile)
						{
							m_SkillMod = new DefaultSkillMod(AccuracySkill, true, (int)m_AccuracyLevel * 5);
							((Mobile)Parent).AddSkillMod(m_SkillMod);
						}</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if (UseSkillMod && m_AccuracyLevel != WeaponAccuracyLevel.Regular && Parent is Mobile)
						{
							m_SkillMod = new DefaultSkillMod(AccuracySkill, true, (int)m_AccuracyLevel * 5);
							((Mobile)Parent).AddSkillMod(m_SkillMod);
						}</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write(this.m_Item);
            writer.Write(this.m_Item2);
        }</pre>

Fragment 2 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write(this.m_Item);
            writer.Write(this.m_Item2);
        }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\MacawSpawner.cs

<pre>int z = this.Map.GetAverageZ(x, y);

                    if (this.Map.CanSpawnMobile(x, y, z))
                    {
                        p = new Point3D(x, y, z);
                        break;
                    }</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Bosses.cs

<pre>int z = this.Map.GetAverageZ(x, y);

					if(this.Map.CanSpawnMobile(x, y, z))
					{
						p = new Point3D(x, y, z);
						break;
					}</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\WorldLocationInfo.cs

<pre>new WorldLocationInfo("an island southeast of Britain", new Rectangle2D(1620, 1900, 594, 150), 
                                                                        new Rectangle2D(1810, 2040, 200, 120), 
                                                                        new Rectangle2D(1980, 2040, 250, 380))</pre>

Fragment 2 in file Scripts\Misc\WorldLocationInfo.cs

<pre>new WorldLocationInfo("an island southeast of Britain", new Rectangle2D(1620, 1900, 594, 150), 
                                                                        new Rectangle2D(1810, 2040, 200, 120), 
                                                                        new Rectangle2D(1980, 2040, 250, 380))</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\NecroMageAI.cs

<pre>case NecroComboType.Exp_FB_MA_PS:
                    case NecroComboType.Exp_Poison_FB_PS:
                        if (Utility.RandomBool())
                            spell = new PoisonStrikeSpell(m_Mobile, null);
                        else
                            spell = new PainSpikeSpell(m_Mobile, null);
                        EndCombo();
                        return spell;</pre>

Fragment 2 in file Scripts\Mobiles\AI\NecroMageAI.cs

<pre>case NecroComboType.Exp_FB_MA_PS:
                    case NecroComboType.Exp_Poison_FB_PS:
                        if (Utility.RandomBool())
                            spell = new PoisonStrikeSpell(m_Mobile, null);
                        else
                            spell = new PainSpikeSpell(m_Mobile, null);
                        EndCombo();
                        return spell;</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>if (Body.IsAnimal)
                        {
                            Animate(3, 5, 1, true, false, 0);
                        }
                        else if (Body.IsMonster)
                        {
                            Animate(17, 5, 1, true, false, 0);
                        }</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\Items\Rewards\VvVSteeds.cs

<pre>if (Body.IsAnimal)
                {
                    Animate(3, 5, 1, true, false, 0);
                }
                else if (Body.IsMonster)
                {
                    Animate(17, 5, 1, true, false, 0);
                }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Kepetch.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            var version = reader.ReadInt();

            if (version == 1)
                reader.ReadDeltaTime();
            else
                GatheredFur = reader.ReadBool();
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\KepetchAmbusher.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            var version = reader.ReadInt();

            if (version == 1)
                reader.ReadDeltaTime();
            else
                GatheredFur = reader.ReadBool();
        }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>AddHtml(100, 190, 50, 20, "Message", false, false);
			AddHtml(
				100, 210, 450, 40, m_Barkeeper.TipMessage == null ? "No current message" : m_Barkeeper.TipMessage, true, false);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>AddHtml(100, 190, 50, 20, "Message", false, false);
			AddHtml(
				100, 210, 450, 40, m_Barkeeper.TipMessage == null ? "No current message" : m_Barkeeper.TipMessage, true, false);</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Questers\ChampHuthwait.cs

<pre>AddButton(115, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 4);

            AddButton(345, 440, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK

            AddPage(4);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Questers\GipsyGemologist.cs

<pre>AddButton(115, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 4);

            AddButton(345, 440, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK

            AddPage(4);</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Underworld\Navrey's Lair\NavreysController.cs

<pre>Effects.SendPacket(orig, m_Navrey.Map, new HuedEffect(EffectType.Moving, Serial.Zero, Serial.Zero, itemId, orig, dest, speed, 0, false, false, hue, 4));</pre>

Fragment 2 in file Scripts\Services\Underworld\Navrey's Lair\NavreysController.cs

<pre>Effects.SendPacket(orig, m_Navrey.Map, new HuedEffect(EffectType.Moving, Serial.Zero, Serial.Zero, itemId, orig, dest, speed, 0, false, false, hue, 4));</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlAddFaction.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);
            // version 0
            writer.Write(this.m_DataValue);
            writer.Write(this.m_GroupName);
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlMobFactions\Attachments\XmlFactionEquip.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);
            // version 0
            writer.Write(this.m_DataValue);
            writer.Write(this.m_GroupName);
        }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\Attachments\XmlSocketable.cs

<pre>MaxSockets = maxsockets;

            try{
            RequiredResource = SpawnerType.GetType(resource);
            } catch{}

            try{
            RequiredSkill = (SkillName)Enum.Parse(typeof(SkillName),skillname);
            } catch{}

            MinSkillLevel = minskilllevel;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\Attachments\XmlSocketable.cs

<pre>MaxSockets = maxsockets;

            try{
            RequiredResource = SpawnerType.GetType(resource);
            } catch{}

            try{
            RequiredSkill = (SkillName)Enum.Parse(typeof(SkillName),skillname);
            } catch{}

            MinSkillLevel = minskilllevel;</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Imbuing\Core\Imbuing.cs

<pre>if (from.CheckSkill(SkillName.Imbuing, 0.0, 45.0))
				{
					success = true;
					resType = typeof(MagicalResidue);
					resAmount = Math.Max(1, resAmount + Utility.Random(2));
				}</pre>

Fragment 2 in file Scripts\Skills\Imbuing\Core\Imbuing.cs

<pre>if (from.CheckSkill(SkillName.Imbuing, 0.0, 45.0))
				{
					success = true;
					resType = typeof(MagicalResidue);
					resAmount = Math.Max(1, resAmount + Utility.Random(2));
				}</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Server\Customs Framework\Central Core\Base Types\SaveData.cs

<pre>Type dataType = GetType();
			_TypeID = World._DataTypes.IndexOf(dataType);

			if (_TypeID == -1)
			{
				World._DataTypes.Add(dataType);
				_TypeID = World._DataTypes.Count - 1;
			}</pre>

Fragment 2 in file Server\Customs Framework\Central Core\Base Types\SaveData.cs

<pre>Type dataType = GetType();
			_TypeID = World._DataTypes.IndexOf(dataType);

			if (_TypeID == -1)
			{
				World._DataTypes.Add(dataType);
				_TypeID = World._DataTypes.Count - 1;
			}</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>Type ourType = GetType();
            m_TypeRef = World.m_ItemTypes.IndexOf(ourType);

            if (m_TypeRef == -1)
            {
                World.m_ItemTypes.Add(ourType);
                m_TypeRef = World.m_ItemTypes.Count - 1;
            }</pre>

Fragment 2 in file Server\Item.cs

<pre>Type ourType = GetType();
            m_TypeRef = World.m_ItemTypes.IndexOf(ourType);

            if (m_TypeRef == -1)
            {
                World.m_ItemTypes.Add(ourType);
                m_TypeRef = World.m_ItemTypes.Count - 1;
            }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Ultima\StringEntry.cs

<pre>for (int i = 0; i < args.Length && i < 10; i++)
			{
				m_Args[i + 1] = args[i];
			}
			return String.Format(m_FmtTxt, m_Args);</pre>

Fragment 2 in file Ultima\StringEntry.cs

<pre>for (int i = 0; i < args.Length && i < 10; i++)
			{
				m_Args[i + 1] = args[i];
			}
			return String.Format(m_FmtTxt, m_Args);</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\PlantClippings.cs

<pre>public void InvalidatePlantHue()
        {
            PlantHueInfo info = PlantHueInfo.GetInfo(m_PlantHue);

            if (info == null)
            {
                m_PlantHue = PlantHue.Plain;
                Hue = 0;
            }
            else
                Hue = info.Hue;

            InvalidateProperties();
        }</pre>

Fragment 2 in file Scripts\Services\BasketWeaving\MiscSAResources.cs

<pre>public void InvalidatePlantHue()
        {
            PlantHueInfo info = PlantHueInfo.GetInfo(m_PlantHue);

            if (info == null)
            {
                m_PlantHue = PlantHue.Plain;
                Hue = 0;
            }
            else
                Hue = info.Hue;

            InvalidateProperties();
        }</pre>

Fragment 3 in file Scripts\Services\BasketWeaving\MiscSAResources.cs

<pre>public void InvalidatePlantHue()
        {
            PlantHueInfo info = PlantHueInfo.GetInfo(m_PlantHue);

            if (info == null)
            {
                m_PlantHue = PlantHue.Plain;
                Hue = 0;
            }
            else
                Hue = info.Hue;

            InvalidateProperties();
        }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Reports\Rendering\BarGraphRenderer.cs

<pre>{
                if (lblFont != null)
                    lblFont.Dispose();
                if (brs != null)
                    brs.Dispose();
                if (lblFormat != null)
                    lblFormat.Dispose();
                if (pen != null)
                    pen.Dispose();
            }</pre>

Fragment 2 in file Scripts\Services\Reports\Rendering\BarGraphRenderer.cs

<pre>{
                if (lblFont != null)
                    lblFont.Dispose();
                if (brs != null)
                    brs.Dispose();
                if (lblFormat != null)
                    lblFormat.Dispose();
                if (pen != null)
                    pen.Dispose();
            }</pre>

Fragment 3 in file Scripts\Services\Reports\Rendering\BarGraphRenderer.cs

<pre>{
                if (lblFont != null)
                    lblFont.Dispose();
                if (brs != null)
                    brs.Dispose();
                if (lblFormat != null)
                    lblFormat.Dispose();
                if (pen != null)
                    pen.Dispose();
            }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCannon.cs

<pre>Weight = 50;

			// make them siegable by default
			// XmlSiege( hitsmax, resistfire, resistphysical, wood, iron, stone)
			XmlAttach.AttachTo(this, new XmlSiege(100, 10, 10, 20, 30, 0));

			// and draggable
			XmlAttach.AttachTo(this, new XmlDrag());

			// undo the temporary hue indicator that is set when the xmlsiege attachment is added
			Hue = 0;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCatapult.cs

<pre>Weight = 50;

			// make them siegable by default
			// XmlSiege( hitsmax, resistfire, resistphysical, wood, iron, stone)
			XmlAttach.AttachTo(this, new XmlSiege(100, 10, 10, 20, 30, 0));

			// and draggable
			XmlAttach.AttachTo(this, new XmlDrag());

			// undo the temporary hue indicator that is set when the xmlsiege attachment is added
			Hue = 0;</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>Weight = 50;

			// make them siegable by default
			// XmlSiege( hitsmax, resistfire, resistphysical, wood, iron, stone)
			XmlAttach.AttachTo(this, new XmlSiege(100, 10, 10, 20, 30, 0));

			// and draggable
			XmlAttach.AttachTo(this, new XmlDrag());

			// undo the temporary hue indicator that is set when the xmlsiege attachment is added
			Hue = 0;</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\OilCloth.cs

<pre>public bool Scissor(Mobile from, Scissors scissors)
        {
            if (this.Deleted || !from.CanSee(this))
                return false;

            base.ScissorHelper(from, new Bandage(), 1);

            return true;
        }</pre>

Fragment 2 in file Scripts\Items\Resource\AbyssalCloth.cs

<pre>public bool Scissor(Mobile from, Scissors scissors)
        {
            if (this.Deleted || !from.CanSee(this))
                return false;

            base.ScissorHelper(from, new Bandage(), 1);

            return true;
        }</pre>

Fragment 3 in file Scripts\Items\Resource\Cloth.cs

<pre>public bool Scissor(Mobile from, Scissors scissors)
        {
            if (this.Deleted || !from.CanSee(this))
                return false;

            base.ScissorHelper(from, new Bandage(), 1);

            return true;
        }</pre>

Fragment 4 in file Scripts\Items\Resource\UncutCloth.cs

<pre>public bool Scissor(Mobile from, Scissors scissors)
        {
            if (this.Deleted || !from.CanSee(this))
                return false;

            base.ScissorHelper(from, new Bandage(), 1);

            return true;
        }</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Questers\ChampHuthwait.cs

<pre>AddButton(115, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 3);

            AddButton(345, 440, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK

            AddPage(3);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Questers\CusteauPerron.cs

<pre>AddButton(115, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 3);//Suit

            AddButton(345, 440, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK

            AddPage(3);</pre>

Fragment 3 in file Scripts\Services\ExploringTheDeep\Questers\GipsyGemologist.cs

<pre>AddButton(115, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 3);

            AddButton(345, 440, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK

            AddPage(3);</pre>

Fragment 4 in file Scripts\Services\ExploringTheDeep\Questers\JosefSkimmons.cs

<pre>AddButton(115, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 3);

            AddButton(345, 440, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK

            AddPage(3);</pre>

## Duplicated Code. Size: 87

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Questers\ChampHuthwait.cs

<pre>AddButton(115, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 2);

            AddButton(345, 440, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK

            AddPage(2);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Questers\CusteauPerron.cs

<pre>AddButton(115, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 2);

            AddButton(345, 440, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK

            AddPage(2);</pre>

Fragment 3 in file Scripts\Services\ExploringTheDeep\Questers\GipsyGemologist.cs

<pre>AddButton(115, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 2);

            AddButton(345, 440, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK

            AddPage(2);</pre>

Fragment 4 in file Scripts\Services\ExploringTheDeep\Questers\HeplerPaulson.cs

<pre>AddButton(115, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 2);

            AddButton(345, 440, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK

            AddPage(2);</pre>

Fragment 5 in file Scripts\Services\ExploringTheDeep\Questers\JosefSkimmons.cs

<pre>AddButton(115, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 2);

            AddButton(345, 440, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK

            AddPage(2);</pre>

Fragment 6 in file Scripts\Services\ExploringTheDeep\Questers\MadelineHarte.cs

<pre>AddButton(115, 300, 0x26B0, 0x26B1, 0, GumpButtonType.Page, 2);

        AddButton(345, 440, 0xF7, 0xF8, 0, GumpButtonType.Reply, 0);//OK

        AddPage(2);</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddBackground(0, 0, 243, 310, 5054);
            //----------
            this.AddLabel(93, 2, 200, "ILSHENAR");
            //fundo branco
            //x, y, largura, altura, item
            this.AddImageTiled(10, 20, 220, 232, 3004);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddBackground(0, 0, 243, 310, 5054);
            //----------
            this.AddLabel(93, 2, 200, "ILSHENAR");
            //fundo branco
            //x, y, largura, altura, item
            this.AddImageTiled(10, 20, 220, 232, 3004);</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BaseAddonContainer.cs

<pre>BaseDoor door = doors[i] as BaseDoor;

                    if (door != null && door.Open)
                        return AddonFitResult.DoorsNotClosed;

                    Point3D doorLoc = door.GetWorldLocation();
                    int doorHeight = door.ItemData.CalcHeight;</pre>

Fragment 2 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>BaseDoor door = doors[i] as BaseDoor;

                    if (door != null && door.Open)
                        return AddonFitResult.DoorsNotClosed;

                    Point3D doorLoc = door.GetWorldLocation();
                    int doorHeight = door.ItemData.CalcHeight;</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\FukiyaDarts.cs

<pre>public int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            if (quality == 2)
                this.UsesRemaining *= 2;

            return quality;
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\Shuriken.cs

<pre>public int OnCraft(int quality, bool makersMark, Mobile from, CraftSystem craftSystem, Type typeRes, BaseTool tool, CraftItem craftItem, int resHue)
        {
            if (quality == 2)
                this.UsesRemaining *= 2;

            return quality;
        }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Quest\PrismaticAmber.cs

<pre>public override bool DropToMobile(Mobile from, Mobile target, Point3D p)
        {
            bool ret = base.DropToMobile(from, target, p);

            if (ret)
                this.DestroyItem(from);

            return ret;
        }</pre>

Fragment 2 in file Scripts\Items\Quest\PrismOfLightAdmissionTicket.cs

<pre>public override bool DropToMobile(Mobile from, Mobile target, Point3D p)
        {
            bool ret = base.DropToMobile(from, target, p);

            if (ret)
                this.DestroyItem(from);

            return ret;
        }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\CrashGuard.cs

<pre>private static string GetTimeStamp()
        {
            DateTime now = DateTime.UtcNow;

            return String.Format("{0}-{1}-{2}-{3}-{4}-{5}",
                now.Day,
                now.Month,
                now.Year,
                now.Hour,
                now.Minute,
                now.Second);
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>private static string GetTimeStamp()
			{
				DateTime now = DateTime.UtcNow;

				return String.Format("{0}-{1}-{2}-{3}-{4}-{5}",
					now.Day,
					now.Month,
					now.Year,
					now.Hour,
					now.Minute,
					now.Second
					);
			}</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>public bool CanDispel(Mobile m)
        {
            return (m is BaseCreature && ((BaseCreature)m).Summoned && this.m_Mobile.CanBeHarmful(m, false) && !((BaseCreature)m).IsAnimatedDead);
        }</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>public bool CanDispel(Mobile m)
        {
            return (m is BaseCreature && ((BaseCreature)m).Summoned && this.m_Mobile.CanBeHarmful(m, false) && !((BaseCreature)m).IsAnimatedDead);
        }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>if (this.m_Mobile.Poisoned)
                return new CureSpell(this.m_Mobile, null);

            // Summoned creatures never heal themselves.
            if (this.m_Mobile.Summoned)
                return null;

            if (this.m_Mobile.Controlled)
            {
                if (DateTime.UtcNow < this.m_NextHealTime)
                    return null;
            }</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>if (this.m_Mobile.Poisoned)
                return new CureSpell(this.m_Mobile, null);

            // Summoned creatures never heal themselves.
            if (this.m_Mobile.Summoned)
                return null;

            if (this.m_Mobile.Controlled)
            {
                if (DateTime.UtcNow < this.m_NextHealTime)
                    return null;
            }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Ilhenir.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(1, 3); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Named\Tangle.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(1, 3); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Putrefier.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 2); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\UnfrozenMummy.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 2); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\EnslavedGargoyle.cs

<pre>this.SetSkill(SkillName.MagicResist, 70.1, 85.0);
            this.SetSkill(SkillName.Tactics, 50.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 40.1, 80.0);

            this.Fame = 3500;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Gargoyle.cs

<pre>this.SetSkill(SkillName.MagicResist, 70.1, 85.0);
            this.SetSkill(SkillName.Tactics, 50.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 40.1, 80.0);

            this.Fame = 3500;</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GargoyleDestroyer.cs

<pre>public override void GenerateLoot()
        {
            this.AddLoot(LootPack.FilthyRich);
            this.AddLoot(LootPack.Rich);
            this.AddLoot(LootPack.MedScrolls);
            this.AddLoot(LootPack.Gems, 2);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GargoyleGuardian.cs

<pre>public override void GenerateLoot()
        {
            this.AddLoot(LootPack.FilthyRich);
            this.AddLoot(LootPack.Rich);
            this.AddLoot(LootPack.MedScrolls);
            this.AddLoot(LootPack.Gems, 2);
        }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ShadowIronElemental.cs

<pre>public override void AlterMeleeDamageFrom(Mobile from, ref int damage)
        {
            if (from is BaseCreature)
            {
                BaseCreature bc = (BaseCreature)from;

                if (bc.Controlled || bc.BardTarget == this)
                    damage = 0; // Immune to pets and provoked creatures
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ValoriteElemental.cs

<pre>public override void AlterMeleeDamageFrom(Mobile from, ref int damage)
        {
            if (from is BaseCreature)
            {
                BaseCreature bc = (BaseCreature)from;

                if (bc.Controlled || bc.BardTarget == this)
                    damage = 0; // Immune to pets and provoked creatures
            }
        }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\AttendantFortuneTeller.cs

<pre>this.SetStr(50, 60);
            this.SetDex(20, 30);
            this.SetInt(100, 110);

            this.Name = NameList.RandomName("female");
            this.Female = true;</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\AttendantLuckyDealer.cs

<pre>this.SetStr(50, 60);
            this.SetDex(20, 30);
            this.SetInt(100, 110);

            this.Name = NameList.RandomName("female");
            this.Female = true;</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Armor Refinement\Items.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public RefinementCraftType CraftType
        {
            get { return m_CraftType; }
            set
            {
                RefinementCraftType old = m_CraftType;

                m_CraftType = value;

                if (old != m_CraftType)
                    GetSubCraftType();

                GetItemID();
                GetHue();
                InvalidateProperties();
            }
        }</pre>

Fragment 2 in file Scripts\Services\Armor Refinement\Items.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public RefinementCraftType CraftType 
        {
            get { return m_CraftType; } 
            set 
            {
                RefinementCraftType old = m_CraftType;

                m_CraftType = value; 

                if(old != m_CraftType)
                    GetSubCraftType();

                GetItemID(); 
                GetHue(); 
                InvalidateProperties(); 
            } 
        }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Armor Refinement\Items.cs

<pre>private int GetModLabel()
        {
            switch ((int)m_ModType)
            {
                default:
                case 0: return 1153941;
                case 1: return 1153944;
                case 2: return 1153945;
                case 3: return 1153946;
                case 4: return 1153947;
            }
        }</pre>

Fragment 2 in file Scripts\Services\Armor Refinement\Items.cs

<pre>private int GetModLabel()
        {
            switch ((int)m_ModType)
            {
                default:
                case 0: return 1153941; // of Defense
                case 1: return 1153944; // of Protection
                case 2: return 1153945; // of Hardening
                case 3: return 1153946; // of Fortification
                case 4: return 1153947; // of Invulnerability
            }
        }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Generate.cs

<pre>sp.MoveToWorld(new Point3D(4552, 2299, -1), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Generate.cs

<pre>sp.MoveToWorld(new Point3D(4552, 2299, -1), Map.Trammel);
            sp.Respawn();
            WeakEntityCollection.Add(name, sp);

            sp = new XmlSpawner(toSpawn);</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\HuntmasterChallenge\HuntingSystem.cs

<pre>m_SeasonBegins = DateTime.Now;
            DateTime ends = DateTime.Now + TimeSpan.FromDays(30);
            m_SeasonEnds = new DateTime(ends.Year, ends.Month, ends.Day, 8, 0, 0);</pre>

Fragment 2 in file Scripts\Services\HuntmasterChallenge\HuntingSystem.cs

<pre>m_SeasonBegins = DateTime.Now;
            DateTime ends = DateTime.Now + TimeSpan.FromDays(30);
			m_SeasonEnds = new DateTime(ends.Year, ends.Month, ends.Day, 8, 0, 0);</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>int circle = Utility.RandomMinMax(minCircle, maxCircle);
										int min = (circle - 1) * 8;
										Item item = Loot.RandomScroll(min, min + 7, SpellbookType.Regular);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>int circle = Utility.RandomMinMax(minCircle, maxCircle);
									int min = (circle - 1) * 8;
									Item item = Loot.RandomScroll(min, min + 7, SpellbookType.Regular);</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\BaseSiegeWeapon.cs

<pre>private bool ContainsInterface(Type[] typearray, Type type)
		{
			if (typearray == null || type == null) return false;

			foreach (Type t in typearray)
			{
				if (t == type) return true;
			}

			return false;
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\BaseTransmutationContainer.cs

<pre>private bool ContainsInterface(Type [] typearray, Type type)
        {
            if(typearray == null || type == null) return false;

            foreach(Type t in typearray)
            {
                if(t == type) return true;
            }

            return false;
        }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\DeathRay.cs

<pre>double damage = (Caster.Skills[CastSkill].Base + Caster.Skills[DamageSkill].Base) * ((double)GetMasteryLevel() * .8);
                        damage /= Target is PlayerMobile ? 5.15 : 2.5;</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\DeathRay.cs

<pre>double damage = (Caster.Skills[CastSkill].Base + Caster.Skills[DamageSkill].Base) * ((double)GetMasteryLevel() * .8);
                damage /= Target is PlayerMobile ? 5.15 : 2.5;</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Ultima\FileIndex.cs

<pre>{
						Index[patch.index].lookup = patch.lookup;
						Index[patch.index].length = patch.length | (1 << 31);
						Index[patch.index].extra = patch.extra;
					}</pre>

Fragment 2 in file Ultima\FileIndex.cs

<pre>{
						Index[patch.index].lookup = patch.lookup;
						Index[patch.index].length = patch.length | (1 << 31);
						Index[patch.index].extra = patch.extra;
					}</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Ultima\Skills.cs

<pre>for (int i = 0; i < m_FileIndex.Index.Length; ++i)
					{
						SkillInfo info = GetSkill(i);
						if (info == null)
						{
							break;
						}
						m_SkillEntries.Add(info);
					}</pre>

Fragment 2 in file Ultima\Skills.cs

<pre>for (int i = 0; i < m_FileIndex.Index.Length; ++i)
			{
				SkillInfo info = GetSkill(i);
				if (info == null)
				{
					break;
				}
				m_SkillEntries.Add(info);
			}</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>if (item != null)
            {
                Container pack = from.Backpack;
                if (pack != null || !pack.TryDropItem(from, item, false))
                    item.MoveToWorld(from.Location, from.Map);
            }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>if (item != null)
                {
                    Container pack = from.Backpack;
                    if (pack != null || !pack.TryDropItem(from, item, false))
                        item.MoveToWorld(from.Location, from.Map);
                }</pre>

Fragment 3 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>if (item != null)
            {
                Container pack = from.Backpack;
                if (pack != null || !pack.TryDropItem(from, item, false))
                    item.MoveToWorld(from.Location, from.Map);
            }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Base\MagerySpell.cs

<pre>if (target.Skills[SkillName.MagicResist].Value < maxSkill)
                target.CheckSkill(SkillName.MagicResist, 0.0, target.Skills[SkillName.MagicResist].Cap);

            return (n >= Utility.RandomDouble());</pre>

Fragment 2 in file Scripts\Spells\Mysticism\MysticSpell.cs

<pre>if (target.Skills[SkillName.MagicResist].Value < maxSkill)
                target.CheckSkill(SkillName.MagicResist, 0.0, target.Skills[SkillName.MagicResist].Cap);

            return (n >= Utility.RandomDouble());</pre>

Fragment 3 in file Scripts\Spells\Skill Masteries\Core\SkillMasterySpell.cs

<pre>if (target.Skills[SkillName.MagicResist].Value < maxSkill)
                target.CheckSkill(SkillName.MagicResist, 0.0, target.Skills[SkillName.MagicResist].Cap);

            return (n >= Utility.RandomDouble());</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\Container.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && this.Weight == 25)
                this.Weight = -1;
        }</pre>

Fragment 2 in file Scripts\Items\Containers\Container.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && this.Weight == 25)
                this.Weight = -1;
        }</pre>

Fragment 3 in file Scripts\Items\Containers\FillableContainers.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && this.Weight == 25)
                this.Weight = -1;
        }</pre>

Fragment 4 in file Scripts\Items\Containers\FillableContainers.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && this.Weight == 25)
                this.Weight = -1;
        }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\Container.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && this.Weight == 15)
                this.Weight = -1;
        }</pre>

Fragment 2 in file Scripts\Items\Containers\Container.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && this.Weight == 15)
                this.Weight = -1;
        }</pre>

Fragment 3 in file Scripts\Items\Containers\Container.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && this.Weight == 15)
                this.Weight = -1;
        }</pre>

Fragment 4 in file Scripts\Items\Containers\Container.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && this.Weight == 15)
                this.Weight = -1;
        }</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>double min = 6.0 - (del * 0.75);
            double max = 6.0 - (del * 1.25);

            return TimeSpan.FromSeconds(min + ((max - min) * Utility.RandomDouble()));</pre>

Fragment 2 in file Scripts\Mobiles\AI\MageAI.cs

<pre>double min = 6.0 - (del * 0.75);
                double max = 6.0 - (del * 1.25);

                return TimeSpan.FromSeconds(min + ((max - min) * Utility.RandomDouble()));</pre>

Fragment 3 in file Scripts\Mobiles\AI\PaladinAI.cs

<pre>double min = 6.0 - (del * 0.75);
			double max = 6.0 - (del * 1.25);

			return TimeSpan.FromSeconds( min + ((max - min) * Utility.RandomDouble()) );</pre>

Fragment 4 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>double min = 6.0 - (del * 0.75);
            double max = 6.0 - (del * 1.25);

            return TimeSpan.FromSeconds(min + ((max - min) * Utility.RandomDouble()));</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>m_Plot = plot;

			AddHtmlLocalized(195, 5, 150, 18, 1150385, RedColor16, false, false);     // New Magincia Bazaar
			AddHtmlLocalized(217, 40, 150, 18, 1150386, RedColor16, false, false);    // Stall Leasing</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>m_Plot = plot;

            AddHtmlLocalized(195, 5, 150, 18, 1150385, RedColor16, false, false);     // New Magincia Bazaar
            AddHtmlLocalized(217, 40, 150, 18, 1150386, RedColor16, false, false);    // Stall Leasing</pre>

Fragment 3 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>m_Plot = plot;

			AddHtmlLocalized(195, 5, 150, 18, 1150385, RedColor16, false, false);     // New Magincia Bazaar
			AddHtmlLocalized(217, 40, 150, 18, 1150386, RedColor16, false, false);    // Stall Leasing</pre>

Fragment 4 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>m_Plot = plot;

            AddHtmlLocalized(195, 5, 150, 18, 1150385, RedColor16, false, false);     // New Magincia Bazaar
            AddHtmlLocalized(217, 40, 150, 18, 1150386, RedColor16, false, false);    // Stall Leasing</pre>

## Duplicated Code. Size: 86

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\LadyMelisande.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 2 in file Scripts\Mobiles\Named\Coil.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 3 in file Scripts\Mobiles\Named\Flurry.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 4 in file Scripts\Mobiles\Named\Lurg.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 5 in file Scripts\Mobiles\Named\MasterMikael.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 6 in file Scripts\Mobiles\Named\Mistral.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 7 in file Scripts\Mobiles\Named\MougGuur.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 8 in file Scripts\Mobiles\Named\RedDeath.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 9 in file Scripts\Mobiles\Named\Saliva.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 10 in file Scripts\Mobiles\Named\Szavetra.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 11 in file Scripts\Mobiles\Named\Thrasher.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 12 in file Scripts\Mobiles\Normal\Changeling.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 13 in file Scripts\Mobiles\Normal\CrystalDaemon.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 14 in file Scripts\Mobiles\Normal\CrystalHydra.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 15 in file Scripts\Mobiles\Normal\CrystalWisp.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 16 in file Scripts\Mobiles\Normal\Hydra.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 17 in file Scripts\Mobiles\Normal\MinotaurGeneral.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

Fragment 18 in file Scripts\Mobiles\Normal\Troglodyte.cs

<pre>for (int i = 0; i < Utility.RandomMinMax(0, 1); i++)
            {
                this.PackItem(Loot.RandomScroll(0, Loot.ArcanistScrollTypes.Length, SpellbookType.Arcanist));
            }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>{
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                range = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }</pre>

Fragment 2 in file Scripts\Commands\Decorate.cs

<pre>{
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                range = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>{
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                messageNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }</pre>

Fragment 2 in file Scripts\Commands\Decorate.cs

<pre>{
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                messageNumber = Utility.ToInt32(this.m_Params[i].Substring(++indexOf));
                        }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\New Guild System\DiplomacyGump.cs

<pre>{
                if (x == null && y == null)
                    return 0;
                else if (x == null)
                    return -1;
                else if (y == null)
                    return 1;

                return Insensitive.Compare(x.Name, y.Name);
            }</pre>

Fragment 2 in file Scripts\Gumps\Guilds\New Guild System\GuildRosterGump.cs

<pre>{
                if (x == null && y == null)
                    return 0;
                else if (x == null)
                    return -1;
                else if (y == null)
                    return 1;

                return Insensitive.Compare(x.Name, y.Name);
            }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetTimeSpanGump.cs

<pre>TimeSpan toSet;
            bool shouldSet, shouldSend;

            TextRelay h = info.GetTextEntry(0);
            TextRelay m = info.GetTextEntry(1);
            TextRelay s = info.GetTextEntry(2);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetTimeSpanGump.cs

<pre>TimeSpan toSet;
			bool shouldSet, shouldSend;

			TextRelay h = info.GetTextEntry( 0 );
			TextRelay m = info.GetTextEntry( 1 );
			TextRelay s = info.GetTextEntry( 2 );</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Aquarium\Aquarium.cs

<pre>public override bool CheckLift(Mobile from, Item item, ref LRReason reject)
        {
            if (item != this)
            {
                reject = LRReason.CannotLift;
                return false;
            }

            return base.CheckLift(from, item, ref reject);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\Aquarium\FishBowl.cs

<pre>public override bool CheckLift(Mobile from, Item item, ref LRReason reject)
        {
            if (item != this)
            {
                reject = LRReason.CannotLift;
                return false;
            }

            return base.CheckLift(from, item, ref reject);
        }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DungeonHitchingPost.cs

<pre>if (from.Alive)
            {
                list.Add(new StableEntry(this, from));

                if (from.Stabled.Count > 0)
                {
                    list.Add(new ClaimAllEntry(this, from));
                }
            }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\AnimalTrainer.cs

<pre>if (from.Alive)
			{
				list.Add(new StableEntry(this, from));

				if (from.Stabled.Count > 0)
				{
					list.Add(new ClaimAllEntry(this, from));
				}
			}</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\HolidayPottedPlant.cs

<pre>if (this.m_Deed == null || this.m_Deed.Deleted)
                    return;

                Mobile from = sender.Mobile;

                if (!this.m_Deed.IsChildOf(from.Backpack))
                {
                    from.SendLocalizedMessage(1042038); // You must have the object in your backpack to use it
                    return;
                }</pre>

Fragment 2 in file Scripts\Items\Decorative\SnowStatue.cs

<pre>if (this.m_Deed == null || this.m_Deed.Deleted)
                    return;

                Mobile from = sender.Mobile;

                if (!this.m_Deed.IsChildOf(from.Backpack))
                {
                    from.SendLocalizedMessage(1042038); // You must have the object in your backpack to use it
                    return;
                }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Consumables\DeliciouslyTastyTreat.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (!this.m_Used)
            {
                from.SendMessage("Which animal you want to Targhet ?");

                from.Target = new InternalTarget(this);
            }
            else
            {
                from.SendLocalizedMessage(1113051);
            }
        }</pre>

Fragment 2 in file Scripts\Quests\IrresistiblyTastyTreat.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (!this.m_Used)
            { 
                from.SendMessage("Which animal you want to Targhet ?"); 

                from.Target = new InternalTarget(this);
            }
            else
            {
                from.SendLocalizedMessage(1113051);                
            }
        }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\LeafGloves.cs

<pre>{
                        if (reader.ReadBool())
                        {
                            this.m_CurArcaneCharges = reader.ReadInt();
                            this.m_MaxArcaneCharges = reader.ReadInt();

                            if (this.Hue == 2118)
                                this.Hue = ArcaneGem.DefaultArcaneHue;
                        }

                        break;
                    }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\Cloaks.cs

<pre>{
                        if (reader.ReadBool())
                        {
                            this.m_CurArcaneCharges = reader.ReadInt();
                            this.m_MaxArcaneCharges = reader.ReadInt();

                            if (this.Hue == 2118)
                                this.Hue = ArcaneGem.DefaultArcaneHue;
                        }

                        break;
                    }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GiantIceWorm.cs

<pre>this.SetDamage(7, 17);

            this.SetDamageType(ResistanceType.Physical, 10);
            this.SetDamageType(ResistanceType.Cold, 90);

            this.SetResistance(ResistanceType.Physical, 30, 35);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\IceSerpent.cs

<pre>this.SetDamage(7, 17);

            this.SetDamageType(ResistanceType.Physical, 10);
            this.SetDamageType(ResistanceType.Cold, 90);

            this.SetResistance(ResistanceType.Physical, 30, 35);</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\TanglingRoots.cs

<pre>this.SetDamage(10, 23);

            this.SetDamageType(ResistanceType.Physical, 60);
            this.SetDamageType(ResistanceType.Poison, 40);

            this.SetResistance(ResistanceType.Physical, 35, 40);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\DiabolicalSeaweed.cs

<pre>this.SetDamage(10, 23);

            this.SetDamageType(ResistanceType.Physical, 60);
            this.SetDamageType(ResistanceType.Poison, 40);

            this.SetResistance(ResistanceType.Physical, 35, 40);</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Cillitha.cs

<pre>public override Type[] Quests
        { 
            get
            {
                return new Type[] 
                {
                    typeof(LethalDartsQuest),
                    typeof(SimpleBowQuest),
                    typeof(IngeniousArcheryPartOneQuest),
                    typeof(IngeniousArcheryPartTwoQuest),
                    typeof(IngeniousArcheryPartThreeQuest),
                    typeof(StopHarpingOnMeQuest)
                };
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Jusae.cs

<pre>public override Type[] Quests
        { 
            get
            {
                return new Type[] 
                {
                    typeof(LethalDartsQuest),
                    typeof(SimpleBowQuest),
                    typeof(IngeniousArcheryPartOneQuest),
                    typeof(IngeniousArcheryPartTwoQuest),
                    typeof(IngeniousArcheryPartThreeQuest),
                    typeof(StopHarpingOnMeQuest)
                };
            }
        }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Healer.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (Core.AOS && this.NameHue == 0x35)
                this.NameHue = -1;
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\TownCrier.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (Core.AOS && this.NameHue == 0x35)
                this.NameHue = -1;
        }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>writer.Write(this.m_Champion);
            writer.Write(this.m_RestartDelay);

            writer.Write(this.m_RestartTimer != null);

            if (this.m_RestartTimer != null)
                writer.WriteDeltaTime(this.m_RestartTime);</pre>

Fragment 2 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>writer.Write(this.m_Champion);
            writer.Write(this.m_RestartDelay);

            writer.Write(this.m_RestartTimer != null);

            if (this.m_RestartTimer != null)
                writer.WriteDeltaTime(this.m_RestartTime);</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CleanUpBritannia\Items\DragonHead.cs

<pre>this.m_ItemID = itemID;
                    this.m_Location = location;
                    this.m_House = house;

                    this.AddBackground(0, 0, 300, 150, 0xA28);

                    this.AddItem(90, 30, itemID);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\DecorativeShardShields.cs

<pre>this.m_ItemID = itemID;
                    this.m_Location = location;
                    this.m_House = house;

                    this.AddBackground(0, 0, 300, 150, 0xA28);

                    this.AddItem(90, 30, itemID);</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefCarpentry.cs

<pre>this.AddSkill(index, SkillName.Tailoring, 50.0, 55.0);
                this.AddRes(index, typeof(Cloth), 1044286, 60, 1044287);
                this.SetNeededExpansion(index, Expansion.SE);</pre>

Fragment 2 in file Scripts\Services\Craft\DefCarpentry.cs

<pre>this.AddSkill(index, SkillName.Tailoring, 50.0, 55.0);
                this.AddRes(index, typeof(Cloth), 1044286, 60, 1044287);
                this.SetNeededExpansion(index, Expansion.SE);</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Pathing\Movement.cs

<pre>Item item = sectorStart.Items[i];

                        if (ignoreMovableImpassables && item.Movable && (item.ItemData.Flags & ImpassableSurface) != 0)
                            continue;

                        if ((item.ItemData.Flags & reqFlags) == 0)
                            continue;</pre>

Fragment 2 in file Scripts\Services\Pathing\Movement.cs

<pre>Item item = sectorStart.Items[i];

                        if (ignoreMovableImpassables && item.Movable && (item.ItemData.Flags & ImpassableSurface) != 0)
                            continue;

                        if ((item.ItemData.Flags & reqFlags) == 0)
                            continue;</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\SmeltersTalisman.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int UsesRemaining 
        {
            get { return _UsesRemaining; }
            set 
            { 
                _UsesRemaining = value;

                if (_UsesRemaining <= 0 && this.RootParent is Mobile)
                    ((Mobile)RootParent).SendLocalizedMessage(1152621); // Your talisman's magic is exhausted.

                InvalidateProperties();
            } 
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\WoodsmanTalisman.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int UsesRemaining
        {
            get { return _UsesRemaining; }
            set
            {
                _UsesRemaining = value;

                if (_UsesRemaining <= 0 && this.RootParent is Mobile)
                    ((Mobile)RootParent).SendLocalizedMessage(1152621); // Your talisman's magic is exhausted.

                InvalidateProperties();
            }
        }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>!int.TryParse(keywordargs[6], out x) || !int.TryParse(keywordargs[7], out y) || !int.TryParse(keywordargs[8], out z)</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>!int.TryParse(keywordargs[6], out x) || !int.TryParse(keywordargs[7], out y) || !int.TryParse(keywordargs[8], out z)</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
									Effects.SendPacket(eloc1, emap, new HuedEffect(EffectType.Moving, -1, -1, effect, eloc1, eloc2, speed, duration, false, false, 0, 0));
								}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
										Effects.SendPacket(eloc1, emap, new HuedEffect(EffectType.Moving, -1, -1, effect, eloc1, eloc2, speed, duration, false, false, 0, 0));
									}</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
									Point3D loc = ((Mobile)o).Location;
									((Mobile)o).Location = new Point3D(loc.X + xoffset, loc.Y + yoffset, loc.Z + zoffset);
								}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
									Point3D loc = ((Item)o).Location;
									((Item)o).Location = new Point3D(loc.X + xoffset, loc.Y + yoffset, loc.Z + zoffset);
								}</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>!int.TryParse(keywordargs[3], out x) || !int.TryParse(keywordargs[4], out y) || !int.TryParse(keywordargs[5], out z)</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>!int.TryParse(keywordargs[3], out x) || !int.TryParse(keywordargs[4], out y) || !int.TryParse(keywordargs[5], out z)</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>new int[] { 0, 0, 0, 0, 0, -1, -1, 1, 0, -1, 0, 1, 1, -1, -1, 1 }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>new int[] { 0, 0, 0, 0, 0, 1, -1, 1, -1, 0, -1, 1, 0, 1, -1, -1 }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>if (CanSee(aggressor) && m_NetState != null)
				{
					m_NetState.Send(MobileIncoming.Create(m_NetState, this, aggressor));
				}

				if (Combatant == null)
				{
					setCombatant = true;
				}

				UpdateAggrExpire();</pre>

Fragment 2 in file Server\Mobile.cs

<pre>if (CanSee(aggressor) && m_NetState != null)
				{
					m_NetState.Send(MobileIncoming.Create(m_NetState, this, aggressor));
				}

				if (Combatant == null)
				{
					setCombatant = true;
				}

				UpdateAggrExpire();</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Server\Persistence\DynamicSaveStrategy.cs

<pre>private void SaveTypeDatabases()
        {
            this.SaveTypeDatabase(World.ItemTypesPath, World.m_ItemTypes);
            this.SaveTypeDatabase(World.MobileTypesPath, World.m_MobileTypes);
            this.SaveTypeDatabase(World.DataTypesPath, World._DataTypes);
        }</pre>

Fragment 2 in file Server\Persistence\ParallelSaveStrategy.cs

<pre>private void SaveTypeDatabases()
        {
            this.SaveTypeDatabase(World.ItemTypesPath, World.m_ItemTypes);
            this.SaveTypeDatabase(World.MobileTypesPath, World.m_MobileTypes);
            this.SaveTypeDatabase(World.DataTypesPath, World._DataTypes);
        }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\SAPropEffects.cs

<pre>public static void AddImmunity(Mobile m)
        {
            if (_Immunity == null)
                _Immunity = new Dictionary<Mobile, DateTime>();

            _Immunity[m] = DateTime.UtcNow + TimeSpan.FromSeconds(60);
        }</pre>

Fragment 2 in file Scripts\Abilities\SAPropEffects.cs

<pre>public static void AddImmunity(Mobile m)
        {
            if (_Immunity == null)
                _Immunity = new Dictionary<Mobile, DateTime>();

            _Immunity[m] = DateTime.UtcNow + TimeSpan.FromSeconds(60);
        }</pre>

Fragment 3 in file Scripts\Abilities\SAPropEffects.cs

<pre>public static void AddImmunity(Mobile m)
        {
            if (_Immunity == null)
                _Immunity = new Dictionary<Mobile, DateTime>();

            _Immunity[m] = DateTime.UtcNow + TimeSpan.FromSeconds(60);
        }</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Server\Map.cs

<pre>BaseMulti m = (BaseMulti)item;
				MultiComponentList mcl = m.Components;

				Sector start = GetMultiMinSector(item.Location, mcl);
				Sector end = GetMultiMaxSector(item.Location, mcl);</pre>

Fragment 2 in file Server\Map.cs

<pre>BaseMulti m = (BaseMulti)item;
				MultiComponentList mcl = m.Components;

				Sector start = GetMultiMinSector(item.Location, mcl);
				Sector end = GetMultiMaxSector(item.Location, mcl);</pre>

Fragment 3 in file Server\Map.cs

<pre>BaseMulti m = (BaseMulti)item;
				MultiComponentList mcl = m.Components;

				Sector start = GetMultiMinSector(item.Location, mcl);
				Sector end = GetMultiMaxSector(item.Location, mcl);</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\LockableContainer.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x376A, 9, 32, 5022);
                Effects.PlaySound(this.Location, this.Map, 0x1F5);</pre>

Fragment 2 in file Scripts\Items\Containers\TrapableContainer.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x376A, 9, 32, 5022);
            Effects.PlaySound(this.Location, this.Map, 0x1F5);</pre>

Fragment 3 in file Scripts\Items\Functional\BaseDoor.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x376A, 9, 32, 5022);
            Effects.PlaySound(this.Location, this.Map, 0x1F5);</pre>

Fragment 4 in file Scripts\Items\Tools\Dices.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(this.Location, this.Map, EffectItem.DefaultDuration), 0x376A, 9, 32, 5022);
            Effects.PlaySound(this.Location, this.Map, 0x1F5);</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Goat.cs

<pre>this.SetSkill(SkillName.MagicResist, 5.0);
            this.SetSkill(SkillName.Tactics, 5.0);
            this.SetSkill(SkillName.Wrestling, 5.0);

            this.Fame = 150;
            this.Karma = 0;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\JackRabbit.cs

<pre>this.SetSkill(SkillName.MagicResist, 5.0);
            this.SetSkill(SkillName.Tactics, 5.0);
            this.SetSkill(SkillName.Wrestling, 5.0);

            this.Fame = 150;
            this.Karma = 0;</pre>

Fragment 3 in file Scripts\Mobiles\Normal\Pig.cs

<pre>this.SetSkill(SkillName.MagicResist, 5.0);
            this.SetSkill(SkillName.Tactics, 5.0);
            this.SetSkill(SkillName.Wrestling, 5.0);

            this.Fame = 150;
            this.Karma = 0;</pre>

Fragment 4 in file Scripts\Mobiles\Normal\Rabbit.cs

<pre>this.SetSkill(SkillName.MagicResist, 5.0);
            this.SetSkill(SkillName.Tactics, 5.0);
            this.SetSkill(SkillName.Wrestling, 5.0);

            this.Fame = 150;
            this.Karma = 0;</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefMasonry.cs

<pre>this.AddSkill(index, SkillName.Tailoring, 70.0, 75.0);
                this.AddRes(index, typeof(Cloth), 1044286, 100, 1044287);
                this.SetNeededExpansion(index, Expansion.SA);</pre>

Fragment 2 in file Scripts\Services\Craft\DefMasonry.cs

<pre>this.AddSkill(index, SkillName.Tailoring, 70.0, 75.0);
                this.AddRes(index, typeof(Cloth), 1044286, 100, 1044287);
                this.SetNeededExpansion(index, Expansion.SA);</pre>

Fragment 3 in file Scripts\Services\Craft\DefMasonry.cs

<pre>this.AddSkill(index, SkillName.Tailoring, 70.0, 75.0);
                this.AddRes(index, typeof(Cloth), 1044286, 100, 1044287);
                this.SetNeededExpansion(index, Expansion.SA);</pre>

Fragment 4 in file Scripts\Services\Craft\DefMasonry.cs

<pre>this.AddSkill(index, SkillName.Tailoring, 70.0, 75.0);
                this.AddRes(index, typeof(Cloth), 1044286, 100, 1044287);
                this.SetNeededExpansion(index, Expansion.SA);</pre>

## Duplicated Code. Size: 85

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\SimpleSwitches.cs

<pre>writer.Write(this.m_SwitchSound);
			writer.Write(this.m_TargetItem0);
			writer.Write(this.m_TargetProperty0);
			writer.Write(this.m_TargetItem1);
			writer.Write(this.m_TargetProperty1);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\SimpleTileTrap.cs

<pre>writer.Write( this.m_SwitchSound );
			writer.Write( this.m_TargetItem0 );
			writer.Write( this.m_TargetProperty0 );
			writer.Write( this.m_TargetItem1 );
			writer.Write( this.m_TargetProperty1 );</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>writer.Write( this.m_SwitchSound );
			writer.Write( this.m_TargetItem0 );
			writer.Write( this.m_TargetProperty0 );
			writer.Write( this.m_TargetItem1 );
			writer.Write( this.m_TargetProperty1 );</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>writer.Write( this.m_SwitchSound );
			writer.Write( this.m_TargetItem0 );
			writer.Write( this.m_TargetProperty0 );
			writer.Write( this.m_TargetItem1 );
			writer.Write( this.m_TargetProperty1 );</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Accounting\Account.cs

<pre>if (m_HashBuffer == null)
			{
				m_HashBuffer = new byte[256];
			}

			var length = Encoding.ASCII.GetBytes(phrase, 0, phrase.Length > 256 ? 256 : phrase.Length, m_HashBuffer, 0);</pre>

Fragment 2 in file Scripts\Accounting\Account.cs

<pre>if (m_HashBuffer == null)
			{
				m_HashBuffer = new byte[256];
			}

			var length = Encoding.ASCII.GetBytes(phrase, 0, phrase.Length > 256 ? 256 : phrase.Length, m_HashBuffer, 0);</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\GMbody.cs

<pre>if (m_Mobile != null && m_Mobile.EquipItem(item))
                    return;

                Container pack = m_Mobile.Backpack;

                if (!mustEquip && pack != null)
                    pack.DropItem(item);
                else
                    item.Delete();</pre>

Fragment 2 in file Scripts\Misc\CharacterCreation.cs

<pre>if (m_Mobile != null && m_Mobile.EquipItem(item))
                return;

            Container pack = m_Mobile.Backpack;

            if (!mustEquip && pack != null)
                pack.DropItem(item);
            else
                item.Delete();</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AdminGump.cs

<pre>y += 20;

                            this.AddLabel(20, y, LabelHue, "Location:");
                            this.AddLabel(200, y, LabelHue, String.Format("{0} [{1}]", m.Location, m.Map));</pre>

Fragment 2 in file Scripts\Gumps\AdminGump.cs

<pre>y += 20;

                            this.AddLabel(20, y, LabelHue, "Location:");
                            this.AddLabel(200, y, LabelHue, String.Format("{0} [{1}]", m.Location, m.Map));</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>this.AddHtmlLocalized(195, 292, 160, 18, 1015327, 0x7FFF, false, false); // Male

                    this.AddHtmlLocalized(195, 312, 160, 18, 1015328, 0x421F, false, false); // Female</pre>

Fragment 2 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>this.AddHtmlLocalized(195, 292, 160, 18, 1015327, 0x7FFF, false, false); // Male

                    this.AddHtmlLocalized(195, 312, 160, 18, 1015328, 0x421F, false, false); // Female</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\FlourMillEastAddon.cs

<pre>public void UpdateStage()
        {
            if (this.IsWorking)
                this.UpdateStage(FlourMillStage.Working);
            else if (this.HasFlour)
                this.UpdateStage(FlourMillStage.Filled);
            else
                this.UpdateStage(FlourMillStage.Empty);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\FlourMillSouthAddon.cs

<pre>public void UpdateStage()
        {
            if (this.IsWorking)
                this.UpdateStage(FlourMillStage.Working);
            else if (this.HasFlour)
                this.UpdateStage(FlourMillStage.Filled);
            else
                this.UpdateStage(FlourMillStage.Empty);
        }</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Wreath.cs

<pre>IPoint3D p = targeted as IPoint3D;

            if (p == null)
                return;

            Point3D loc = new Point3D(p);

            BaseHouse house = BaseHouse.FindHouseAt(loc, from.Map, 16);</pre>

Fragment 2 in file Scripts\Items\Decorative\Mistletoe.cs

<pre>IPoint3D p = targeted as IPoint3D;

            if (p == null)
                return;

            Point3D loc = new Point3D(p);

            BaseHouse house = BaseHouse.FindHouseAt(loc, from.Map, 16);</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\GlovesOfFeudalGrip.cs

<pre>{
            Resource = CraftResource.None;

            this.Attributes.BonusStr = 8;
            this.Attributes.BonusStam = 8;
            this.Attributes.RegenHits = 3;
            this.Attributes.RegenMana = 3;
            this.Attributes.WeaponDamage = 30;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\GlovesOfFeudalGrip.cs

<pre>{
            Resource = CraftResource.None;

            this.Attributes.BonusStr = 8;
            this.Attributes.BonusStam = 8;
            this.Attributes.RegenHits = 3;
            this.Attributes.RegenMana = 3;
            this.Attributes.WeaponDamage = 30;
        }</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\TOTLesserArtifacts.cs

<pre>{
                        weapon.DamageLevel = (WeaponDamageLevel)Utility.Random(6);
                        weapon.AccuracyLevel = (WeaponAccuracyLevel)Utility.Random(6);
                        weapon.DurabilityLevel = (WeaponDurabilityLevel)Utility.Random(6);
                    }</pre>

Fragment 2 in file Scripts\Items\Containers\TreasureMapChest.cs

<pre>{
                            weapon.DamageLevel = (WeaponDamageLevel)Utility.Random(6);
                            weapon.AccuracyLevel = (WeaponAccuracyLevel)Utility.Random(6);
                            weapon.DurabilityLevel = (WeaponDurabilityLevel)Utility.Random(6);
                        }</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\MasterJonath.cs

<pre>if ( Utility.RandomDouble() < 0.15 )
            c.DropItem( new DisintegratingThesisNotes() );

            if ( Paragon.ChestChance > Utility.RandomDouble() )
            c.DropItem( new ParagonChest( Name, TreasureMapLevel ) );</pre>

Fragment 2 in file Scripts\Mobiles\Named\MasterTheophilus.cs

<pre>if ( Utility.RandomDouble() < 0.15 )
            c.DropItem( new DisintegratingThesisNotes() );

            if ( Paragon.ChestChance > Utility.RandomDouble() )
            c.DropItem( new ParagonChest( Name, TreasureMapLevel ) );</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ChaosDragoon.cs

<pre>this.SetDamageType(ResistanceType.Physical, 25);
            this.SetDamageType(ResistanceType.Fire, 25);
            this.SetDamageType(ResistanceType.Cold, 25);
            this.SetDamageType(ResistanceType.Energy, 25);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ValoriteElemental.cs

<pre>this.SetDamageType(ResistanceType.Physical, 25);
            this.SetDamageType(ResistanceType.Fire, 25);
            this.SetDamageType(ResistanceType.Cold, 25);
            this.SetDamageType(ResistanceType.Energy, 25);</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\FanDancer.cs

<pre>this.SetDamageType(ResistanceType.Physical, 70);
            this.SetDamageType(ResistanceType.Fire, 10);
            this.SetDamageType(ResistanceType.Cold, 10);
            this.SetDamageType(ResistanceType.Poison, 10);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\KazeKemono.cs

<pre>this.SetDamageType(ResistanceType.Physical, 70);
            this.SetDamageType(ResistanceType.Fire, 10);
            this.SetDamageType(ResistanceType.Cold, 10);
            this.SetDamageType(ResistanceType.Poison, 10);</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Kirin.cs

<pre>SetSkill(SkillName.Tactics, 20.1, 22.5);
            SetSkill(SkillName.Wrestling, 80.5, 92.5);

            Fame = 9000;
            Karma = 9000;

            Tamable = true;
            ControlSlots = 2;
            MinTameSkill = 95.1;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Unicorn.cs

<pre>SetSkill(SkillName.Tactics, 20.1, 22.5);
            SetSkill(SkillName.Wrestling, 80.5, 92.5);

            Fame = 9000;
            Karma = 9000;

            Tamable = true;
            ControlSlots = 2;
            MinTameSkill = 95.1;</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Minotaur.cs

<pre>this.SetSkill(SkillName.Meditation, 0);
            this.SetSkill(SkillName.EvalInt, 0);
            this.SetSkill(SkillName.Magery, 0);
            this.SetSkill(SkillName.Poisoning, 0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\MinotaurCaptain.cs

<pre>this.SetSkill(SkillName.Meditation, 0);
            this.SetSkill(SkillName.EvalInt, 0);
            this.SetSkill(SkillName.Magery, 0);
            this.SetSkill(SkillName.Poisoning, 0);</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\OphidianMage.cs

<pre>SetDamageType(ResistanceType.Physical, 100);

            SetResistance(ResistanceType.Physical, 25, 35);
            SetResistance(ResistanceType.Fire, 30, 40);
            SetResistance(ResistanceType.Cold, 35, 45);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Rotworm.cs

<pre>SetDamageType( ResistanceType.Physical, 100 );

			SetResistance( ResistanceType.Physical, 35, 45 );
			SetResistance( ResistanceType.Fire, 30, 40 );
			SetResistance( ResistanceType.Cold, 25, 35 );</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\HireFighter.cs

<pre>case 0:
                    this.AddItem(new Longsword());
                    break;
                case 1:
                    this.AddItem(new Broadsword());
                    break;
                case 2:
                    this.AddItem(new VikingSword());</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HireRanger.cs

<pre>case 0:
                    this.AddItem(new Longsword());
                    break;
                case 1:
                    this.AddItem(new VikingSword());
                    break;
                case 2:
                    this.AddItem(new Broadsword());</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Ethics\Evil\Powers\UnholyItem.cs

<pre>public override void BeginInvoke(Player from)
        {
            from.Mobile.BeginTarget(12, false, Targeting.TargetFlags.None, new TargetStateCallback(Power_OnTarget), from);
            from.Mobile.SendMessage("Which item do you wish to imbue?");
        }</pre>

Fragment 2 in file Scripts\Services\Ethics\Hero\Powers\HolyItem.cs

<pre>public override void BeginInvoke(Player from)
        {
            from.Mobile.BeginTarget(12, false, Targeting.TargetFlags.None, new TargetStateCallback(Power_OnTarget), from);
            from.Mobile.SendMessage("Which item do you wish to imbue?");
        }</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\GBBigglesby.cs

<pre>for (int j = 0; j < quest.Objectives.Count; j++)
                        {
                            if (quest.Objectives[j].Update(pm))
                                quest.Objectives[j].Complete();
                        }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\ProfessionalBountyQuest.cs

<pre>for(int j = 0; j < quest.Objectives.Count; j++)
                   {
                       if(quest.Objectives[j].Update(pm))
                           quest.Objectives[j].Complete();
                   }</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\MyRunUO\MyRunUO.cs

<pre>if (sb == null)
            {
                if (charIndex > 0)
                    sb = new StringBuilder(input, 0, charIndex, input.Length + 20);
                else
                    sb = new StringBuilder(input.Length + 20);
            }</pre>

Fragment 2 in file Scripts\Services\MyRunUO\MyRunUO.cs

<pre>if (sb == null)
            {
                if (charIndex > 0)
                    sb = new StringBuilder(input, 0, charIndex, input.Length + 20);
                else
                    sb = new StringBuilder(input.Length + 20);
            }</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>UpdateTotal((Container)target, TotalType.Weight, weight);
				UpdateTotal((Container)target, TotalType.Gold, gold);
				UpdateTotal((Container)target, TotalType.Items, nitems);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>UpdateTotal((Container)target, TotalType.Weight, weight);
                UpdateTotal((Container)target, TotalType.Gold, gold);
                UpdateTotal((Container)target, TotalType.Items, nitems);</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Peacemaking.cs

<pre>{
							from.SendLocalizedMessage(500612); // You play poorly, and there is no effect.
							m_Instrument.PlayInstrumentBadly(from);
							m_Instrument.ConsumeUse(from);

                            from.NextSkillTime = Core.TickCount + (10000 - ((masteryBonus / 5) * 1000));
						}</pre>

Fragment 2 in file Scripts\Skills\Provocation.cs

<pre>{
                                from.NextSkillTime = Core.TickCount + (10000 - ((masteryBonus / 5) * 1000));
                                from.SendLocalizedMessage(500612); // You play poorly, and there is no effect.
                                m_Instrument.PlayInstrumentBadly(from);
                                m_Instrument.ConsumeUse(from);
                            }</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Ninjitsu\ShadowJump.cs

<pre>IPoint3D orig = p;
            Map map = this.Caster.Map;

            SpellHelper.GetSurfaceTop(ref p);

            Point3D from = this.Caster.Location;
            Point3D to = new Point3D(p);</pre>

Fragment 2 in file Scripts\Spells\Third\Teleport.cs

<pre>IPoint3D orig = p;
            Map map = this.Caster.Map;

            SpellHelper.GetSurfaceTop(ref p);

            Point3D from = this.Caster.Location;
            Point3D to = new Point3D(p);</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Server\Effects.cs

<pre>IEntity from,
			IEntity to,
			int itemID,
			int speed,
			int duration,
			bool fixedDirection,
			bool explodes,
			int hue,
			int renderMode,
			int effect,
			int explodeEffect,
			int explodeSound,
			EffectLayer layer,
			int unknown</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>IEntity from,
			IEntity to,
			int itemID,
			int speed,
			int duration,
			bool fixedDirection,
			bool explodes,
			int hue,
			int renderMode,
			int effect,
			int explodeEffect,
			int explodeSound,
			EffectLayer layer,
			int unknown</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>if (m.X == x && m.Y == y && (m.Z + 15) > newZ && (newZ + 15) > m.Z && !m.OnMoveOver(this))
								{
									return false;
								}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>if (m.X == x && m.Y == y && (m.Z + 15) > newZ && (newZ + 15) > m.Z && !m.OnMoveOver(this))
								{
									return false;
								}</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Server\ScriptCompiler.cs

<pre>bool valid = true;

									for (int i = 0; i < bytes.Length; ++i)
									{
										if (bytes[i] != hashCode[i])
										{
											valid = false;
											break;
										}
									}</pre>

Fragment 2 in file Server\ScriptCompiler.cs

<pre>bool valid = true;

									for (int i = 0; i < bytes.Length; ++i)
									{
										if (bytes[i] != hashCode[i])
										{
											valid = false;
											break;
										}
									}</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\Pacify.cs

<pre>this.Attributes.SpellChanneling = 1;
            this.Attributes.AttackChance = 10;
            this.Attributes.WeaponSpeed = 20;
            this.Attributes.WeaponDamage = 50;

            this.WeaponAttributes.HitLeechMana = 100;
            this.WeaponAttributes.UseBestSkill = 1;</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\Quell.cs

<pre>this.Attributes.SpellChanneling = 1;
            this.Attributes.WeaponSpeed = 20;
            this.Attributes.WeaponDamage = 50;
            this.Attributes.AttackChance = 10;

            this.WeaponAttributes.HitLeechMana = 100;
            this.WeaponAttributes.UseBestSkill = 1;</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Weapons\Subdue.cs

<pre>this.Attributes.SpellChanneling = 1;
            this.Attributes.WeaponSpeed = 20;
            this.Attributes.WeaponDamage = 50;
            this.Attributes.AttackChance = 10;

            this.WeaponAttributes.HitLeechMana = 100;
            this.WeaponAttributes.UseBestSkill = 1;</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>int TotalCount = 0;
			int TrammelCount = 0;
			int FeluccaCount = 0;
			int IlshenarCount = 0;
			int MalasCount = 0;
			int TokunoCount = 0;
			int OtherCount = 0;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>int TotalCount = 0;
			int TrammelCount = 0;
			int FeluccaCount = 0;
			int IlshenarCount = 0;
            int MalasCount = 0;
            int TokunoCount = 0;
			int OtherCount = 0;</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>int TotalCount = 0;
			int TrammelCount = 0;
			int FeluccaCount = 0;
			int IlshenarCount = 0;
            int MalasCount = 0;
            int TokunoCount = 0;
			int OtherCount = 0;</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Rares.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version < 1 && this.Weight == 2.0)
                this.Weight = 5.0;
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\Rares.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version < 1 && this.Weight == 2.0)
                this.Weight = 5.0;
        }</pre>

Fragment 3 in file Scripts\Items\Decorative\Rares.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version < 1 && this.Weight == 2.0)
                this.Weight = 5.0;
        }</pre>

Fragment 4 in file Scripts\Items\Decorative\Rares.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version < 1 && this.Weight == 2.0)
                this.Weight = 5.0;
        }</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\BaseHouse.cs

<pre>List<BaseHouse> list = null;
                            m_Table.TryGetValue(this.m_Owner, out list);

                            if (list == null)
                                m_Table[this.m_Owner] = list = new List<BaseHouse>();</pre>

Fragment 2 in file Scripts\Multis\BaseHouse.cs

<pre>List<BaseHouse> list = null;
                    m_Table.TryGetValue(this.m_Owner, out list);

                    if (list == null)
                        m_Table[this.m_Owner] = list = new List<BaseHouse>();</pre>

Fragment 3 in file Scripts\Multis\BaseHouse.cs

<pre>List<BaseHouse> list = null;
                    m_Table.TryGetValue(this.m_Owner, out list);

                    if (list == null)
                        m_Table[this.m_Owner] = list = new List<BaseHouse>();</pre>

Fragment 4 in file Scripts\Multis\BaseHouse.cs

<pre>List<BaseHouse> list = null;
                m_Table.TryGetValue(this.m_Owner, out list);

                if (list == null)
                    m_Table[this.m_Owner] = list = new List<BaseHouse>();</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Actor.cs

<pre>Utility.AssignRandomHair(this);

            Container pack = new Backpack(); 

            pack.DropItem(new Gold(250, 300)); 

            pack.Movable = false; 

            this.AddItem(pack);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Artist.cs

<pre>Utility.AssignRandomHair(this);

            Container pack = new Backpack();

            pack.DropItem(new Gold(250, 300));

            pack.Movable = false;

            this.AddItem(pack);</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Gypsy.cs

<pre>Utility.AssignRandomHair(this);

            Container pack = new Backpack();

            pack.DropItem(new Gold(250, 300));

            pack.Movable = false;

            this.AddItem(pack);</pre>

Fragment 4 in file Scripts\Mobiles\NPCs\HarborMaster.cs

<pre>Utility.AssignRandomHair(this);

            Container pack = new Backpack();

            pack.DropItem(new Gold(250, 300));

            pack.Movable = false;

            this.AddItem(pack);</pre>

Fragment 5 in file Scripts\Mobiles\NPCs\Sculptor.cs

<pre>Utility.AssignRandomHair(this);

            Container pack = new Backpack();

            pack.DropItem(new Gold(250, 300));

            pack.Movable = false;

            this.AddItem(pack);</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Camps\BrigandCamp.cs

<pre>public override void AddItem(Item item, int xOffset, int yOffset, int zOffset)
        {
            if (item != null)
                item.Movable = false;

            base.AddItem(item, xOffset, yOffset, zOffset);
        }</pre>

Fragment 2 in file Scripts\Multis\Camps\HumanBrigandCamp.cs

<pre>public override void AddItem(Item item, int xOffset, int yOffset, int zOffset)
        {
            if (item != null)
                item.Movable = false;

            base.AddItem(item, xOffset, yOffset, zOffset);
        }</pre>

Fragment 3 in file Scripts\Multis\Camps\LizardmenCamp.cs

<pre>public override void AddItem(Item item, int xOffset, int yOffset, int zOffset)
        {
            if (item != null)
                item.Movable = false;

            base.AddItem(item, xOffset, yOffset, zOffset);
        }</pre>

Fragment 4 in file Scripts\Multis\Camps\OrcCamp.cs

<pre>public override void AddItem(Item item, int xOffset, int yOffset, int zOffset)
        {
            if (item != null)
                item.Movable = false;

            base.AddItem(item, xOffset, yOffset, zOffset);
        }</pre>

Fragment 5 in file Scripts\Multis\Camps\RatCamp.cs

<pre>public override void AddItem(Item item, int xOffset, int yOffset, int zOffset)
        {
            if (item != null)
                item.Movable = false;

            base.AddItem(item, xOffset, yOffset, zOffset);
        }</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Mobiles\Djinn.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            Timer SelfDeleteTimer = new InternalSelfDeleteTimer(this);
            SelfDeleteTimer.Start();
        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\MercutioTheUnsavory.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            Timer SelfDeleteTimer = new InternalSelfDeleteTimer(this);
            SelfDeleteTimer.Start();
        }</pre>

Fragment 3 in file Scripts\Services\ExploringTheDeep\Mobiles\ObsidianWyvern.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            Timer SelfDeleteTimer = new InternalSelfDeleteTimer(this);
            SelfDeleteTimer.Start();
        }</pre>

Fragment 4 in file Scripts\Services\ExploringTheDeep\Mobiles\OrcEngineer.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            Timer SelfDeleteTimer = new InternalSelfDeleteTimer(this);
            SelfDeleteTimer.Start();
        }</pre>

Fragment 5 in file Scripts\Services\ExploringTheDeep\Mobiles\TheMasterInstructor.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            Timer SelfDeleteTimer = new InternalSelfDeleteTimer(this);
            SelfDeleteTimer.Start();
        }</pre>

## Duplicated Code. Size: 84

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Fourth\ArchCure.cs

<pre>SpellHelper.Turn(this.Caster, p);

                SpellHelper.GetSurfaceTop(ref p);

                List<Mobile> targets = new List<Mobile>();

                Map map = this.Caster.Map;</pre>

Fragment 2 in file Scripts\Spells\Fourth\ArchProtection.cs

<pre>SpellHelper.Turn(this.Caster, p);

                SpellHelper.GetSurfaceTop(ref p);

                List<Mobile> targets = new List<Mobile>();

                Map map = this.Caster.Map;</pre>

Fragment 3 in file Scripts\Spells\Seventh\MassDispel.cs

<pre>SpellHelper.Turn(this.Caster, p);

                SpellHelper.GetSurfaceTop(ref p);

                List<Mobile> targets = new List<Mobile>();

                Map map = this.Caster.Map;</pre>

Fragment 4 in file Scripts\Spells\Sixth\MassCurse.cs

<pre>SpellHelper.Turn(this.Caster, p);

                SpellHelper.GetSurfaceTop(ref p);

                List<Mobile> targets = new List<Mobile>();

                Map map = this.Caster.Map;</pre>

Fragment 5 in file Scripts\Spells\Sixth\Reveal.cs

<pre>SpellHelper.Turn(this.Caster, p);

                SpellHelper.GetSurfaceTop(ref p);

                List<Mobile> targets = new List<Mobile>();

                Map map = this.Caster.Map;</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SignParser.cs

<pre>foreach (Item item in eable)
					{
						if (item is Sign && item.Z == sign.Location.Z && item.ItemID == sign.ItemID)
							m_ToDelete.Enqueue(item);
					}
					eable.Free();</pre>

Fragment 2 in file Scripts\Commands\SignParser.cs

<pre>foreach (Item item in eable)
					{
						if (item is Sign && item.Z == sign.Location.Z && item.ItemID == sign.ItemID)
							m_ToDelete.Enqueue(item);
					}
					eable.Free();</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AdminGump.cs

<pre>from.SendGump(new NoticeGump(1060637, 30720, "You have not yet marked any accounts. Place a check mark next to the accounts you wish to ban and then try again.", 0xFFC000, 420, 280, new NoticeGumpCallback(ResendGump_Callback), new object[] { list, rads, this.m_ListPage }));</pre>

Fragment 2 in file Scripts\Gumps\AdminGump.cs

<pre>from.SendGump(new NoticeGump(1060637, 30720, "You have not yet marked any accounts. Place a check mark next to the accounts you wish to ban and then try again.", 0xFFC000, 420, 280, new NoticeGumpCallback(ResendGump_Callback), new object[] { list, rads, this.m_ListPage }));</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\HeritageTokenGump.cs

<pre>this.AddButton(10, 374, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(45, 376, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 2 in file Scripts\Gumps\PolymorphGump.cs

<pre>this.AddButton(10, 374, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(45, 376, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\HouseGump.cs

<pre>bool isOwner = this.m_House.IsOwner(from);
            bool isCoOwner = isOwner || this.m_House.IsCoOwner(from);
            bool isFriend = isCoOwner || this.m_House.IsFriend(from);</pre>

Fragment 2 in file Scripts\Regions\HouseRegion.cs

<pre>bool isOwner = this.m_House.IsOwner(from);
            bool isCoOwner = isOwner || this.m_House.IsCoOwner(from);
            bool isFriend = isCoOwner || this.m_House.IsFriend(from);</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetColorGump.cs

<pre>AddPage(0);

			AddBackground(0, 0, BackWidth, BackHeight, BackGumpID);
			AddImageTiled(BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), TotalHeight, OffsetGumpID);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetObjectGump.cs

<pre>AddPage( 0 );

			AddBackground( 0, 0, BackWidth, BackHeight, BackGumpID );
			AddImageTiled( BorderSize, BorderSize, TotalWidth - (OldStyle ? SetWidth + OffsetSize : 0), TotalHeight, OffsetGumpID );</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DungeonHitchingPost.cs

<pre>pet.ControlTarget = null;
                pet.ControlOrder = OrderType.Stay;
                pet.Internalize();

                pet.SetControlMaster(null);
                pet.SummonMaster = null;

                pet.IsStabled = true;
                pet.StabledBy = from;</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\AnimalTrainer.cs

<pre>pet.ControlTarget = null;
				pet.ControlOrder = OrderType.Stay;
				pet.Internalize();

				pet.SetControlMaster(null);
				pet.SummonMaster = null;

				pet.IsStabled = true;
				pet.StabledBy = from;</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\MailboxEastAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();
            if (reader.ReadBool())
                this.m_Owner = reader.ReadMobile();
        }</pre>

Fragment 2 in file Scripts\Items\Addons\MailboxSouthAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();
            if (reader.ReadBool())
                this.m_Owner = reader.ReadMobile();
        }</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Talismans\BaseTalisman.cs

<pre>target.PlaySound(0x201);
                            Effects.SendLocationParticles(EffectItem.Create(target.Location, target.Map, EffectItem.DefaultDuration), 0x3728, 1, 13, 0x834, 0, 0x13B2, 0);</pre>

Fragment 2 in file Scripts\Items\Equipment\Talismans\BaseTalisman.cs

<pre>target.PlaySound(0x201);
                            Effects.SendLocationParticles(EffectItem.Create(target.Location, target.Map, EffectItem.DefaultDuration), 0x3728, 1, 13, 0x834, 0, 0x13B2, 0);</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\PlantClippings.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int v = reader.ReadInt();

            if(v > 0)
                m_PlantHue = (PlantHue)reader.ReadInt();
        }</pre>

Fragment 2 in file Scripts\Services\BasketWeaving\MiscSAResources.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int v = reader.ReadInt();

            if(v > 0)
                m_PlantHue = (PlantHue)reader.ReadInt();
        }</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\SkillCheck.cs

<pre>if (value < minSkill)
                return false; // Too difficult
            else if (value >= maxSkill)
                return true; // No challenge

            double chance = (value - minSkill) / (maxSkill - minSkill);

            CrystalBallOfKnowledge.TellSkillDifficulty(from, skillName, chance);</pre>

Fragment 2 in file Scripts\Misc\SkillCheck.cs

<pre>if (value < minSkill)
                return false; // Too difficult
            else if (value >= maxSkill)
                return true; // No challenge

            double chance = (value - minSkill) / (maxSkill - minSkill);

            CrystalBallOfKnowledge.TellSkillDifficulty(from, skillName, chance);</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\PaladinAI.cs

<pre>public bool CanDispel( Mobile m )
		{
			return ( m is BaseCreature && ((BaseCreature)m).Summoned && m_Mobile.CanBeHarmful( m, false ) && !((BaseCreature)m).IsAnimatedDead );
		}</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\GuardAI.cs

<pre>public bool CanDispel(Mobile m)
		{
			return (m is BaseCreature && ((BaseCreature)m).Summoned && m_Mobile.CanBeHarmful(m, false) &&
					!((BaseCreature)m).IsAnimatedDead);
		}</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>Mobile target = GetBardTarget();

            if (target == null || !target.InLOS(this) || CheckInstrument() == null)
                return false;

            if (this.Spell != null)
                this.Spell = null;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>Mobile target = GetBardTarget();
            if (target == null || !target.InLOS(this) || CheckInstrument() == null)
                return false;

            if (this.Spell != null)
                this.Spell = null;</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BlackSolenQueen.cs

<pre>sac.MoveToWorld(this.Location, this.Map);
                PlaySound(0x582);
                Say(1114445); // * * The solen queen summons her workers to her aid! * *
                m_Laid = true;
                EggSacTimer e = new EggSacTimer();
                e.Start();</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RedSolenQueen.cs

<pre>sac.MoveToWorld(this.Location, this.Map);
                PlaySound(0x582);
                Say(1114445); // * * The solen queen summons her workers to her aid! * *
                m_Laid = true;
                EggSacTimer e = new EggSacTimer();
                e.Start();</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GargishOutcast.cs

<pre>public override WeaponAbility GetWeaponAbility()
        {
            if (Weapon is BaseWeapon)
            {
                if (Utility.RandomBool())
                    return ((BaseWeapon)Weapon).PrimaryAbility;
                return ((BaseWeapon)Weapon).SecondaryAbility;
            }

            return WeaponAbility.WhirlwindAttack;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GargishRouser.cs

<pre>public override WeaponAbility GetWeaponAbility()
        {
			if(Weapon is BaseWeapon)
            {
				if (Utility.RandomBool())
					return ((BaseWeapon)Weapon).PrimaryAbility;
				return ((BaseWeapon)Weapon).SecondaryAbility;
			}

			return WeaponAbility.WhirlwindAttack;
        }</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Gargoyle.cs

<pre>public override void GenerateLoot()
        {
            this.AddLoot(LootPack.Average);
            this.AddLoot(LootPack.MedScrolls);
            this.AddLoot(LootPack.Gems, Utility.RandomMinMax(1, 4));
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\UndeadGargoyle.cs

<pre>public override void GenerateLoot()
        {
            this.AddLoot(LootPack.Average);
            this.AddLoot(LootPack.MedScrolls);
            this.AddLoot(LootPack.Gems, Utility.RandomMinMax(1, 4));
        }</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\IceFiend.cs

<pre>this.BaseSoundID = 357;

            this.SetStr(376, 405);
            this.SetDex(176, 195);
            this.SetInt(201, 225);

            this.SetHits(226, 243);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\PitFiend.cs

<pre>this.BaseSoundID = 357;

            this.SetStr(376, 405);
            this.SetDex(176, 195);
            this.SetInt(201, 225);

            this.SetHits(226, 243);</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\MysteriousWisp.cs

<pre>if (m_Viewers == null || m_Viewers.Count == 0)
                    return;

                List<Mobile> viewers = new List<Mobile>(m_Viewers);
                Type t = typeof(Server.Mobiles.MysteriousWisp.InternalGump);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\MysteriousWisp.cs

<pre>if (m_Viewers == null || m_Viewers.Count == 0)
                    return;

                List<Mobile> viewers = new List<Mobile>(m_Viewers);
                Type t = typeof(Server.Mobiles.MysteriousWisp.InternalGump);</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Ranger.cs

<pre>base.InitOutfit();

            this.AddItem(new Server.Items.Shirt(Utility.RandomNeutralHue()));
            this.AddItem(new Server.Items.LongPants(Utility.RandomNeutralHue()));</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Thief.cs

<pre>base.InitOutfit();

            this.AddItem(new Server.Items.Shirt(Utility.RandomNeutralHue()));
            this.AddItem(new Server.Items.LongPants(Utility.RandomNeutralHue()));</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Boats\BaseBoat.cs

<pre>{
                case Direction.North: ItemID = NorthID; break;
                case Direction.East: ItemID = EastID; break;
                case Direction.South: ItemID = SouthID; break;
                case Direction.West: ItemID = WestID; break;
            }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\BaseGalleon.cs

<pre>{
                case Direction.North: ItemID = NorthID; break;
                case Direction.South: ItemID = SouthID; break;
                case Direction.East: ItemID = EastID; break;
                case Direction.West: ItemID = WestID; break;
            }</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\HouseFoundation.cs

<pre>mcl.Resize(mcl.Width, mcl.Height + 1);

            int xCenter = mcl.Center.X;
            int yCenter = mcl.Center.Y;
            int y = mcl.Height - 1;</pre>

Fragment 2 in file Scripts\Multis\HouseFoundation.cs

<pre>mcl.Resize(mcl.Width, mcl.Height + 1);

            int xCenter = mcl.Center.X;
            int yCenter = mcl.Center.Y;
            int y = mcl.Height - 1;</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\LargeBODTarget.cs

<pre>protected override void OnTarget(Mobile from, object targeted)
        {
            if (this.m_Deed.Deleted || !this.m_Deed.IsChildOf(from.Backpack))
                return;

            this.m_Deed.EndCombine(from, targeted);
        }</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallBODTarget.cs

<pre>protected override void OnTarget(Mobile from, object targeted)
        {
            if (this.m_Deed.Deleted || !this.m_Deed.IsChildOf(from.Backpack))
                return;

            this.m_Deed.EndCombine(from, targeted);
        }</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Trading\TradeSystem.cs

<pre>if (map == null || map == Map.Internal)
                return false;

            if (x < 0 || y < 0 || x >= map.Width || y >= map.Height)
                return false;

            bool hasSurface = false;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>if (map == null || map == Map.Internal)
				return false;

			if (x < 0 || y < 0 || x >= map.Width || y >= map.Height)
				return false;

			bool hasSurface = false;</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GalleonContainer.cs

<pre>public bool IsSurface(IPoint3D pnt)
            {
                if (pnt is StaticTarget)
                {
                    StaticTarget st = (StaticTarget)pnt;

                    if ((st.Flags & TileFlag.Surface) > 0)
                        return true;
                }
                return false;
            }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GalleonPilot.cs

<pre>public bool IsSurface(IPoint3D pnt)
            {
                if (pnt is StaticTarget)
                {
                    StaticTarget st = (StaticTarget)pnt;

                    if ((st.Flags & TileFlag.Surface) > 0)
                        return true;
                }
                return false;
            }</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Regions\CorgulRegion.cs

<pre>int offsetX = ePnt.X - boat.X;
                int offsetY = ePnt.Y - boat.Y;
                int offsetZ = map.GetAverageZ(ePnt.X, ePnt.Y) - boat.Z;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Regions\WarpRegion.cs

<pre>int offsetX = ePnt.X - boat.X;
                int offsetY = ePnt.Y - boat.Y;
                int offsetZ = map.GetAverageZ(ePnt.X, ePnt.Y) - boat.Z;</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Core\Election.cs

<pre>TimeSpan period;

                switch ( this.m_State )
                {
                    default:
                    case ElectionState.Pending:
                        period = PendingPeriod;
                        break;
                    case ElectionState.Election:
                        period = VotingPeriod;
                        break;
                    case ElectionState.Campaign:
                        period = CampaignPeriod;
                        break;
                }</pre>

Fragment 2 in file Scripts\Services\Factions\Core\Election.cs

<pre>TimeSpan period;

                switch ( this.m_State )
                {
                    default:
                    case ElectionState.Pending:
                        period = PendingPeriod;
                        break;
                    case ElectionState.Election:
                        period = VotingPeriod;
                        break;
                    case ElectionState.Campaign:
                        period = CampaignPeriod;
                        break;
                }</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
											// Create an instance of StreamReader to read from a file.
											// The using statement also closes the StreamReader.
											using (StreamReader sr = new StreamReader(filename))
											{
												string line;
												// Read and display lines from the file until the end of
												// the file is reached.
												while ((line = sr.ReadLine()) != null)
												{
													filestring += line;
												}

												sr.Close();
											}
										}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>{
									// Create an instance of StreamReader to read from a file.
									// The using statement also closes the StreamReader.
									using (StreamReader sr = new StreamReader(filename))
									{
										string line;
										// Read and display lines from the file until the end of
										// the file is reached.
										while ((line = sr.ReadLine()) != null)
										{
											filestring += line;
										}
										sr.Close();
									}
								}</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlGetAttachGump.cs

<pre>bool sel=false;
				if(m_SelectionList != null && i < m_SelectionList.Length){
					sel = m_SelectionList[i];
				}
				if(sel) texthue = 33;

				if(i == Selected) texthue = 68;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlEdit.cs

<pre>bool sel=false;

				if(m_SelectionList != null && i < m_SelectionList.Length)
				{
					sel = m_SelectionList[i];
				}

				// entries with the selection box checked are highlighted in red
				if(sel) texthue = 33;

				// the selected entry is highlighted in green
				if(i == Selected) texthue = 68;</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetGump.cs

<pre>if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );

			AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 1, GumpButtonType.Reply, 0 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetObjectGump.cs

<pre>if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );

			AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 1, GumpButtonType.Reply, 0 );</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetGump.cs

<pre>if ( SetGumpID != 0 )
					AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );

				AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 2, GumpButtonType.Reply, 0 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetObjectGump.cs

<pre>if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );

			AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 2, GumpButtonType.Reply, 0 );</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetGump.cs

<pre>if ( SetGumpID != 0 )
					AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );

				AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 4, GumpButtonType.Reply, 0 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetObjectGump.cs

<pre>if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );

			AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 4, GumpButtonType.Reply, 0 );</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>AddButton( 20, height - 35, 0xFAB, 0xFAD, 1, GumpButtonType.Reply, 0 );
            AddLabel( 60, height - 35, 0, XmlPoints.GetText(from, 200532) );  // "Refresh"</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>AddButton( 20, height - 35, 0xFAB, 0xFAD, 1, GumpButtonType.Reply, 0 );
            AddLabel( 60, height - 35, 0, XmlPoints.GetText(from, 200532) );  // "Refresh"</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>new int[] { 0, 0, 0, 0, 0, -1, 1, 0, 1, -1, 0, 1, 0, 1, -1, -1 }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>new int[] { 0, 0, 0, 0, 0, 0, 1, -1, 1, 0, -1, -1, 1, 1, -1, 0 }</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Lumberjacking.cs

<pre>public override void OnHarvestStarted(Mobile from, Item tool, HarvestDefinition def, object toHarvest)
        {
            base.OnHarvestStarted(from, tool, def, toHarvest);

            if (Core.ML)
                from.RevealingAction();
        }</pre>

Fragment 2 in file Scripts\Skills\Mining.cs

<pre>public override void OnHarvestStarted(Mobile from, Item tool, HarvestDefinition def, object toHarvest)
        {
            base.OnHarvestStarted(from, tool, def, toHarvest);

            if (Core.ML)
                from.RevealingAction();
        }</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketHandlers.cs

<pre>state.Send(new MobileUpdate(m));
				state.Send(new MobileUpdate(m));

				m.CheckLightLevels(true);

				state.Send(new MobileUpdate(m));</pre>

Fragment 2 in file Server\Network\PacketHandlers.cs

<pre>state.Send(new MobileUpdate(m));
				state.Send(new MobileUpdate(m));

				m.CheckLightLevels(true);

				state.Send(new MobileUpdate(m));</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Server\World.cs

<pre>{
			var results = new List<SaveData>();

			foreach (SaveData data in _Data.Values)
			{
				if (data.GetType() == type)
				{
					results.Add(data);
				}
			}

			return results;
		}</pre>

Fragment 2 in file Server\World.cs

<pre>{
			var results = new List<SaveData>();

			foreach (SaveData data in _Data.Values)
			{
				if (data.GetType() == type)
				{
					results.Add(data);
				}
			}

			return results;
		}</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SoulStone.cs

<pre>this.AddButton(10, 410, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 412, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 2 in file Scripts\Items\Consumables\SoulStone.cs

<pre>this.AddButton(10, 410, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 412, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

Fragment 3 in file Scripts\Items\Consumables\SoulStone.cs

<pre>this.AddButton(10, 410, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                this.AddHtmlLocalized(45, 412, 450, 20, 1060051, 0x7FFF, false, false); // CANCEL</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDeathAction.cs

<pre>Mobile m = (Mobile)o;
							if (m is BaseCreature)
							{
								BaseCreature c = (BaseCreature)m;
								c.Home = loc; // Spawners location is the home point
							}

							m.Location = loc;
							m.Map = map;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>Mobile m = (Mobile)o;
                            if (m is BaseCreature)
                            {
                                BaseCreature c = (BaseCreature)m;
                                c.Home = loc; // Spawners location is the home point
                            }

                            m.Location = loc;
                            m.Map = map;</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlUse.cs

<pre>Mobile m = (Mobile)o;
                            if (m is BaseCreature)
                            {
                                BaseCreature c = (BaseCreature)m;
                                c.Home = loc; // Spawners location is the home point
                            }

                            m.Location = loc;
                            m.Map = map;</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestBook.cs

<pre>public override bool OnDroppedToWorld(Mobile from,Point3D point)
        {

            bool returnvalue = base.OnDroppedToWorld(from,point);

            from.SendGump( new XmlConfirmDeleteGump(from,this));

            //CheckOwnerFlag();

            //Invalidate();
            return false;
            //return returnvalue;
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>public override bool OnDroppedToWorld(Mobile from, Point3D point)
		{

			bool returnvalue = base.OnDroppedToWorld(from, point);

			from.SendGump(new XmlConfirmDeleteGump(from, this));

			return false;
		}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>public override bool OnDroppedToWorld(Mobile from, Point3D point)
        {

            bool returnvalue = base.OnDroppedToWorld(from, point);

            from.SendGump(new XmlConfirmDeleteGump(from, this));

            //m_wasMoved  = true;

            //CheckOwnerFlag();

            //Invalidate();
            return false;
            //return returnvalue;
        }</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>{
							so.SpawnedObjects.Remove(o);
							x--;
							removed = true;
							// if sequential spawning is active and the RestrictKillsToSubgroup flag is set, then check to see if
							// the object is in the current subgroup before adding to the total
							if (SequentialSpawn >= 0 && so.RestrictKillsToSubgroup)
							{
								if (so.SubGroup == SequentialSpawn)
									total_removed++;
							}
							else
							{
								// just add it
								total_removed++;
							}
						}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>{
							// Remove the delete mobile from the list
							so.SpawnedObjects.Remove(o);
							x--;
							removed = true;
							// if sequential spawning is active and the RestrictKillsToSubgroup flag is set, then check to see if
							// the object is in the current subgroup before adding to the total
							if (SequentialSpawn >= 0 && so.RestrictKillsToSubgroup)
							{
								if (so.SubGroup == SequentialSpawn)
									total_removed++;
							}
							else
							{
								// just add it
								total_removed++;
							}
						}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>{
								so.SpawnedObjects.Remove(o);
								x--;
								removed = true;
								// if sequential spawning is active and the RestrictKillsToSubgroup flag is set, then check to see if
								// the object is in the current subgroup before adding to the total
								if (SequentialSpawn >= 0 && so.RestrictKillsToSubgroup)
								{
									if (so.SubGroup == SequentialSpawn)
										total_removed++;
								}
								else
								{
									// just add it
									total_removed++;
								}
							}</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Chivalry\SacredJourney.cs

<pre>{
                    RunebookEntry e = ((Runebook)o).Default;

                    if (e != null)
                        this.m_Owner.Effect(e.Location, e.Map, true);
                    else
                        from.SendLocalizedMessage(502354); // Target is not marked.
                }</pre>

Fragment 2 in file Scripts\Spells\Fourth\Recall.cs

<pre>{
                    RunebookEntry e = ((Runebook)o).Default;

                    if (e != null)
                        this.m_Owner.Effect(e.Location, e.Map, true);
                    else
                        from.SendLocalizedMessage(502354); // Target is not marked.
                }</pre>

Fragment 3 in file Scripts\Spells\Seventh\GateTravel.cs

<pre>{
                    RunebookEntry e = ((Runebook)o).Default;

                    if (e != null)
                        this.m_Owner.Effect(e.Location, e.Map, true);
                    else
                        from.SendLocalizedMessage(502354); // Target is not marked.
                }</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Spellbooks\BookOfBushido.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && Core.ML)
                this.Layer = Layer.OneHanded;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Spellbooks\BookOfChivalry.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && Core.ML)
                this.Layer = Layer.OneHanded;
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Spellbooks\BookOfNinjitsu.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && Core.ML)
                this.Layer = Layer.OneHanded;
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Spellbooks\NecromancerSpellbook.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0 && Core.ML)
                this.Layer = Layer.OneHanded;
        }</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetGump.cs

<pre>if ( SetGumpID != 0 )
					AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );

				AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 3, GumpButtonType.Reply, 0 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetObjectGump.cs

<pre>if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );

			AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 3, GumpButtonType.Reply, 0 );</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetPoint2DGump.cs

<pre>if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );
			AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 3, GumpButtonType.Reply, 0 );</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetPoint3DGump.cs

<pre>if ( SetGumpID != 0 )
				AddImageTiled( x, y, SetWidth, EntryHeight, SetGumpID );
			AddButton( x + SetOffsetX, y + SetOffsetY, SetButtonID1, SetButtonID2, 3, GumpButtonType.Reply, 0 );</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlGetAttachGump.cs

<pre>if(info == null || state == null || state.Mobile == null) return;

			int radiostate = -1;
			if(info.Switches.Length > 0){
				radiostate = info.Switches[0];
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlGetAttachGump.cs

<pre>if(info == null || state == null || state.Mobile == null) return;

			int radiostate = -1;
			if(info.Switches.Length > 0){
				radiostate = info.Switches[0];
			}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>if (info == null || state == null || state.Mobile == null) return;

                int radiostate = -1;
                if (info.Switches.Length > 0)
                {
                    radiostate = info.Switches[0];
                }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestGumps.cs

<pre>if(info == null || state == null || state.Mobile == null) return;

			int radiostate = -1;
			if(info.Switches.Length > 0)
			{
				radiostate = info.Switches[0];
			}</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlAdd.cs

<pre>if(info == null || state == null || state.Mobile == null) return;

			int radiostate = -1;
			if(info.Switches.Length > 0)
			{
				radiostate = info.Switches[0];
			}</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlAdd.cs

<pre>if(info == null || state == null || state.Mobile == null) return;

				int radiostate = -1;
				if(info.Switches.Length > 0)
				{
					radiostate = info.Switches[0];
				}</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlEdit.cs

<pre>if(info == null || state == null || state.Mobile == null) return;

				int radiostate = -1;
				if(info.Switches.Length > 0)
				{
					radiostate = info.Switches[0];
				}</pre>

Fragment 8 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlEdit.cs

<pre>if(info == null || state == null || state.Mobile == null) return;

				int radiostate = -1;
				if(info.Switches.Length > 0)
				{
					radiostate = info.Switches[0];
				}</pre>

Fragment 9 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>if (info == null || state == null || state.Mobile == null) return;

				int radiostate = -1;
				if (info.Switches.Length > 0)
				{
					radiostate = info.Switches[0];
				}</pre>

Fragment 10 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>if(info == null || state == null || state.Mobile == null) return;

				int radiostate = -1;
				if(info.Switches.Length > 0)
				{
					radiostate = info.Switches[0];
				}</pre>

## Duplicated Code. Size: 83

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\BandanaBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            m_AosWeaponAttributes.HitLowerDefend = 30;
            Attributes.BonusStr = 10;
            Attributes.BonusDex = 5;
            StrRequirement = 45;
            Hue = 66;
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\BascinetBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            m_AosWeaponAttributes.HitLowerDefend = 30;
            Attributes.BonusStr = 10;
            Attributes.BonusDex = 5;
            StrRequirement = 45;
            Hue = 66;
        }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\CircletBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            m_AosWeaponAttributes.HitLowerDefend = 30;
            Attributes.BonusStr = 10;
            Attributes.BonusDex = 5;
            StrRequirement = 45;
            Hue = 66;
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\FeatheredHatBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            m_AosWeaponAttributes.HitLowerDefend = 30;
            Attributes.BonusStr = 10;
            Attributes.BonusDex = 5;
            StrRequirement = 45;
            Hue = 66;
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\GargishEarringsBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            m_AosWeaponAttributes.HitLowerDefend = 30;
            Attributes.BonusStr = 10;
            Attributes.BonusDex = 5;
            StrRequirement = 45;
            Hue = 66;
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\JesterHatBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            m_AosWeaponAttributes.HitLowerDefend = 30;
            Attributes.BonusStr = 10;
            Attributes.BonusDex = 5;
            StrRequirement = 45;
            Hue = 66;
        }</pre>

Fragment 7 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\NorseHelmBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            m_AosWeaponAttributes.HitLowerDefend = 30;
            Attributes.BonusStr = 10;
            Attributes.BonusDex = 5;
            StrRequirement = 45;
            Hue = 66;
        }</pre>

Fragment 8 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\PlateHelmBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            m_AosWeaponAttributes.HitLowerDefend = 30;
            Attributes.BonusStr = 10;
            Attributes.BonusDex = 5;
            StrRequirement = 45;
            Hue = 66;           
        }</pre>

Fragment 9 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\RoyalCircletBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            m_AosWeaponAttributes.HitLowerDefend = 30;
            Attributes.BonusStr = 10;
            Attributes.BonusDex = 5;
            StrRequirement = 45;
            Hue = 66;            
        }</pre>

Fragment 10 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\SkullcapBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            m_AosWeaponAttributes.HitLowerDefend = 30;
            Attributes.BonusStr = 10;
            Attributes.BonusDex = 5;
            StrRequirement = 45;
            Hue = 66;            
        }</pre>

Fragment 11 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\TricorneHatBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            m_AosWeaponAttributes.HitLowerDefend = 30;
            Attributes.BonusStr = 10;
            Attributes.BonusDex = 5;
            StrRequirement = 45;
            Hue = 66;
        }</pre>

Fragment 12 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Items\MaceAndShieldBase\WizardsHatBearingTheCrestOfBlackthorn.cs

<pre>{
            ReforgedSuffix = ReforgedSuffix.Blackthorn;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            m_AosWeaponAttributes.HitLowerDefend = 30;
            Attributes.BonusStr = 10;
            Attributes.BonusDex = 5;
            StrRequirement = 45;
            Hue = 66;            
        }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\MortalStrike.cs

<pre>Timer t = (Timer)m_Table[m];

            if (t != null)
                t.Stop();

            t = new InternalTimer(m, duration);
            m_Table[m] = t;</pre>

Fragment 2 in file Scripts\Abilities\ParalyzingBlow.cs

<pre>Timer t = (Timer)m_Table[m];

            if (t != null)
                t.Stop();

            t = new InternalTimer(m, duration);
            m_Table[m] = t;</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Commands\Commands.cs

<pre>CommandLogging.WriteLine(e.Mobile, "{0} {1} deleting {2}", e.Mobile.AccessLevel, CommandLogging.Format(e.Mobile), CommandLogging.Format(obj));
                ((Item)obj).Delete();</pre>

Fragment 2 in file Scripts\Commands\Generic\Commands\Commands.cs

<pre>CommandLogging.WriteLine(e.Mobile, "{0} {1} deleting {2}", e.Mobile.AccessLevel, CommandLogging.Format(e.Mobile), CommandLogging.Format(obj));
                ((Mobile)obj).Delete();</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddImageTiled(10, 20, 220, 232, 3004);

            //----------
            this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(172, 27, 200, "Unload");</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddImageTiled(10, 20, 220, 232, 3004);

            //----------
            this.AddLabel(30, 27, 200, "Map name");
            this.AddLabel(172, 27, 200, "Unload");</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddButton(55, 280, 247, 249, 1, GumpButtonType.Reply, 0);
            this.AddButton(125, 280, 241, 243, 0, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.AddButton(55, 280, 247, 249, 1, GumpButtonType.Reply, 0);
            this.AddButton(125, 280, 241, 243, 0, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetGump.cs

<pre>bool canNull = !prop.PropertyType.IsValueType;
            bool canDye = prop.IsDefined(typeof(HueAttribute), false);
            bool isBody = prop.IsDefined(typeof(BodyAttribute), false);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlSetGump.cs

<pre>bool canNull = !prop.PropertyType.IsValueType;
			bool canDye = prop.IsDefined( typeof( HueAttribute ), false );
			bool isBody = prop.IsDefined( typeof( BodyAttribute ), false );</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\ResurrectGump.cs

<pre>this.AddImage(65, 72, 5605);

            this.AddImageTiled(80, 90, 200, 1, 9107);
            this.AddImageTiled(95, 92, 200, 1, 9157);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Chyloth.cs

<pre>this.AddImage(65, 72, 5605);

            this.AddImageTiled(80, 90, 200, 1, 9107);
            this.AddImageTiled(95, 92, 200, 1, 9157);</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Wreath.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            Timer.DelayCall(TimeSpan.Zero, new TimerCallback(FixMovingCrate));
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\Mistletoe.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            Timer.DelayCall(TimeSpan.Zero, new TimerCallback(FixMovingCrate));
        }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Wreath.cs

<pre>this.AddButton(50, 35, 0x868, 0x869, 1, GumpButtonType.Reply, 0);
                this.AddButton(145, 35, 0x868, 0x869, 2, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Items\Decorative\Mistletoe.cs

<pre>this.AddButton(50, 35, 0x868, 0x869, 1, GumpButtonType.Reply, 0);
                this.AddButton(145, 35, 0x868, 0x869, 2, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\ArcaneShield.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Attributes.NightSight == 0)
                this.Attributes.NightSight = 1;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\TongueoftheBeast.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Attributes.NightSight == 0)
                this.Attributes.NightSight = 1;
        }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\DaemonBone\DaemonArms.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.ArmorAttributes.SelfRepair == 0)
                this.ArmorAttributes.SelfRepair = 1;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\DaemonBone\DaemonLegs.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.ArmorAttributes.SelfRepair == 0)
                this.ArmorAttributes.SelfRepair = 1;
        }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\CaptainQuacklebushsCutlass.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Attributes.AttackChance == 50)
                this.Attributes.AttackChance = 10;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\VampiricEssence.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Attributes.AttackChance == 50)
                this.Attributes.AttackChance = 10;
        }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\InvisibilityPotion.cs

<pre>public static void RemoveTimer(Mobile m)
        {
            Timer t = (Timer)m_Table[m];

            if (t != null)
            {
                t.Stop();
                m_Table.Remove(m);
            }
        }</pre>

Fragment 2 in file Scripts\Spells\Sixth\Invisibility.cs

<pre>public static void RemoveTimer(Mobile m)
        {
            Timer t = (Timer)m_Table[m];

            if (t != null)
            {
                t.Stop();
                m_Table.Remove(m);
            }
        }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SpecialFishingNet.cs

<pre>private static readonly int[] m_Hues = new int[]
        {
            0x09B,
            0x0CD,
            0x0D3,
            0x14D,
            0x1DD,
            0x1E9,
            0x1F4,
            0x373,
            0x451,
            0x47F,
            0x489,
            0x492,
            0x4B5,
            0x8AA
        };</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\SpecialSalvageHook.cs

<pre>private static readonly int[] m_Hues = new int[]
        {
            0x09B,
            0x0CD,
            0x0D3,
            0x14D,
            0x1DD,
            0x1E9,
            0x1F4,
            0x373,
            0x451,
            0x47F,
            0x489,
            0x492,
            0x4B5,
            0x8AA
        };</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\NinjaAI.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(m_Mobile.Location, m_Mobile.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 2023);

            m_Mobile.PlaySound(0x22F);
            m_Mobile.Hidden = true;</pre>

Fragment 2 in file Scripts\Mobiles\AI\OrcScoutAI.cs

<pre>Effects.SendLocationParticles(
					EffectItem.Create(m_Mobile.Location, m_Mobile.Map, EffectItem.DefaultDuration), 0x3728, 10, 10, 2023);

				m_Mobile.PlaySound(0x22F);
				m_Mobile.Hidden = true;</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Navery\Navrey.cs

<pre>for (int i = rights.Count - 1; i >= 0; --i)
            {
                DamageStore ds = rights[i];
                if (!ds.m_HasRight)
                    rights.RemoveAt(i);
            }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DemonKnight.cs

<pre>for (int i = rights.Count - 1; i >= 0; --i)
            {
                DamageStore ds = rights[i];

                if (!ds.m_HasRight)
                    rights.RemoveAt(i);
            }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DeepSeaSerpent.cs

<pre>this.CanSwim = true;
            this.CantWalk = true;

            if (Utility.RandomBool())
                this.PackItem(new SulfurousAsh(4));
            else
                this.PackItem(new BlackPearl(4));</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SeaSerpent.cs

<pre>this.CanSwim = true;
            this.CantWalk = true;

            if (Utility.RandomBool())
                this.PackItem(new SulfurousAsh(4));
            else
                this.PackItem(new BlackPearl(4));</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Harpy.cs

<pre>this.SetHits(58, 72);

            this.SetDamage(5, 7);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 25, 30);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Lizardman.cs

<pre>this.SetHits(58, 72);

            this.SetDamage(5, 7);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 25, 30);</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\HordeMinion.cs

<pre>this.SetSkill(SkillName.MagicResist, 10.0);
            this.SetSkill(SkillName.Tactics, 0.1, 15.0);
            this.SetSkill(SkillName.Wrestling, 25.1, 40.0);

            this.Fame = 500;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ShadowWisp.cs

<pre>this.SetSkill(SkillName.MagicResist, 10.0);
            this.SetSkill(SkillName.Tactics, 0.1, 15.0);
            this.SetSkill(SkillName.Wrestling, 25.1, 40.0);

            this.Fame = 500;</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\MyrmidexThreat\Mobiles\Questers.cs

<pre>public override void InitBody()
		{
			InitStats(100, 100, 25);

			Female = false;
            Body = 0x190;
            HairItemID = Race.RandomHair(false);
            Hue = Race.RandomSkinHue();
		}</pre>

Fragment 2 in file Scripts\Quests\Eodon\MyrmidexThreat\Mobiles\Questers.cs

<pre>public override void InitBody()
		{
			InitStats(100, 100, 25);

			Female = false;
            Body = 0x190;
            HairItemID = Race.RandomHair(false);
            Hue = Race.RandomSkinHue();
		}</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\MyrmidexThreat\Mobiles\Questers.cs

<pre>public override void InitBody()
		{
			InitStats(100, 100, 25);

			Female = true;
            Body = 0x191;
            HairItemID = Race.RandomHair(true);
            Hue = Race.RandomSkinHue();
		}</pre>

Fragment 2 in file Scripts\Quests\Eodon\MyrmidexThreat\Mobiles\Questers.cs

<pre>public override void InitBody()
		{
			InitStats(100, 100, 25);

			Female = true;
            Body = 0x191;
            HairItemID = Race.RandomHair(true);
            Hue = Race.RandomSkinHue();
		}</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\MyrmidexThreat\Mobiles\Questers.cs

<pre>public override void InitBody()
		{
			InitStats(100, 100, 25);

			Female = false;
            Body = 0x190;
            HairItemID = Race.RandomHair(true);
            Hue = Race.RandomSkinHue();
		}</pre>

Fragment 2 in file Scripts\Quests\Eodon\MyrmidexThreat\Mobiles\Questers.cs

<pre>public override void InitBody()
		{
			InitStats(100, 100, 25);

			Female = false;
            Body = 0x190;
            HairItemID = Race.RandomHair(true);
            Hue = Race.RandomSkinHue();
		}</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Creatures.cs

<pre>this.MovingParticles(m, 0x36D4, 7, 0, false, true, 9502, 4019, 0x160);
            this.PlaySound(0x15E);

            double range = m.GetDistanceToSqrt(this);</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Bosses.cs

<pre>this.MovingParticles( m, 0x36D4, 7, 0, false, true, 9502, 4019, 0x160 );
            this.PlaySound( 0x15E );

			double range = m.GetDistanceToSqrt(this);</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Ethics\Evil\Powers\SummonFamiliar.cs

<pre>if (Mobiles.BaseCreature.Summon(familiar, from.Mobile, from.Mobile.Location, 0x217, TimeSpan.FromHours(1.0)))
            {
                from.Familiar = familiar;

                this.FinishInvoke(from);
            }</pre>

Fragment 2 in file Scripts\Services\Ethics\Hero\Powers\SummonFamiliar.cs

<pre>if (Mobiles.BaseCreature.Summon(familiar, from.Mobile, from.Mobile.Location, 0x217, TimeSpan.FromHours(1.0)))
            {
                from.Familiar = familiar;

                this.FinishInvoke(from);
            }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Ethics\Evil\Powers\UnholySteed.cs

<pre>if (Mobiles.BaseCreature.Summon(steed, from.Mobile, from.Mobile.Location, 0x217, TimeSpan.FromHours(1.0)))
            {
                from.Steed = steed;

                this.FinishInvoke(from);
            }</pre>

Fragment 2 in file Scripts\Services\Ethics\Hero\Powers\HolySteed.cs

<pre>if (Mobiles.BaseCreature.Summon(steed, from.Mobile, from.Mobile.Location, 0x217, TimeSpan.FromHours(1.0)))
            {
                from.Steed = steed;

                this.FinishInvoke(from);
            }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Items\Fish\CrabsAndLobsters.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();
            m_CaughtBy = reader.ReadMobile();
            m_DateCaught = reader.ReadDateTime();
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\Fish\RareFish.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();
            m_CaughtBy = reader.ReadMobile();
            m_DateCaught = reader.ReadDateTime();
        }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\BaseGalleon.cs

<pre>if (from != null && from.Backpack != null)
            {
                List<ShipRune> list = from.Backpack.FindItemsByType<ShipRune>();

                foreach (ShipRune item in list)
                    item.InvalidateProperties();
            }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\BaseGalleon.cs

<pre>if (from != null && from.Backpack != null)
            {
                List<ShipRune> list = from.Backpack.FindItemsByType<ShipRune>();

                foreach (ShipRune item in list)
                    item.InvalidateProperties();
            }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>minmax = Imbuing.GetPropRange((AosArmorAttribute)attr);
                    value = CalculateValue(attr, minmax[0], minmax[1], perclow, perchigh, ref budget, luckchance, true);</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>minmax = Imbuing.GetPropRange((AosElementAttribute)attr);
                    value = CalculateValue(attr, minmax[0], minmax[1], perclow, perchigh, ref budget, luckchance, true);</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string result = SetPropertyValue(spawner, o, arglist[0], tmpstr);
										// see if it was successful
										if (result != "Property has been set.")
										{
											status_str = arglist[0] + " : " + result;
											no_error = false;
										}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string result = SetPropertyValue(spawner, o, arglist[0], tmpstr);
										// see if it was successful
										if (result != "Property has been set.")
										{
											status_str = arglist[0] + " : " + result;
											no_error = false;
										}</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (armor == null)
				return null;

			armor.ProtectionLevel = (ArmorProtectionLevel)BaseCreature.RandomMinMaxScaled(minLevel, maxLevel);
			armor.Durability = (ArmorDurabilityLevel)BaseCreature.RandomMinMaxScaled(minLevel, maxLevel);

			return armor;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (armor == null)
				return null;

			armor.ProtectionLevel = (ArmorProtectionLevel)BaseCreature.RandomMinMaxScaled(minLevel, maxLevel);
			armor.Durability = (ArmorDurabilityLevel)BaseCreature.RandomMinMaxScaled(minLevel, maxLevel);

			return armor;</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlMessage.cs

<pre>ActivationWord = reader.ReadString();
					Charges = reader.ReadInt();
					Refractory = reader.ReadTimeSpan();
					TimeSpan remaining = reader.ReadTimeSpan();
					m_EndTime = DateTime.UtcNow + remaining;
					break;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlSound.cs

<pre>ActivationWord = reader.ReadString();
					Charges = reader.ReadInt();
					Refractory = reader.ReadTimeSpan();
					TimeSpan remaining = reader.ReadTimeSpan();
					m_EndTime = DateTime.UtcNow + remaining;
					break;</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\QuestHolder.cs

<pre>public override void OnDoubleClick(Mobile from)
		{
			base.OnDoubleClick(from);
			from.CloseGump(typeof(XmlQuestStatusGump));

			from.SendGump(new XmlQuestStatusGump(this, this.TitleString));
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\QuestNote.cs

<pre>public override void OnDoubleClick( Mobile from )
		{
			base.OnDoubleClick(from);
			from.CloseGump( typeof( XmlQuestStatusGump ) );

			from.SendGump( new XmlQuestStatusGump(this, this.TitleString) );
		}</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGauntlet.cs

<pre>foreach(IChallengeEntry entry in winner.Members)
                    entry.Winner = true;
                GameBroadcast( 100414, winner.ID);  // "Team {0} is the winner!"
                AwardTeamWinnings(winner.ID, TotalPurse);

                Winner = winner.ID;

                EndGame();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGauntlet.cs

<pre>foreach(IChallengeEntry entry in winner.Members)
                    entry.Winner = true;
                GameBroadcast( 100414, winner.ID);  // "Team {0} is the winner!"
                AwardTeamWinnings(winner.ID, TotalPurse);

                Winner = winner.ID;

                EndGame();</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Begging.cs

<pre>if (m_From.Karma > -3000)
                                    {
                                        int toLose = m_From.Karma + 3000;

                                        if (toLose > 40)
                                        {
                                            toLose = 40;
                                        }

                                        Titles.AwardKarma(m_From, -toLose, true);
                                    }</pre>

Fragment 2 in file Scripts\Skills\Begging.cs

<pre>if (m_From.Karma > -3000)
                            {
                                int toLose = m_From.Karma + 3000;

                                if (toLose > 40)
                                {
                                    toLose = 40;
                                }

                                Titles.AwardKarma(m_From, -toLose, true);
                            }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Server\Persistence\ParallelSaveStrategy.cs

<pre>public override void ProcessDecay()
        {
            while (this._decayQueue.Count > 0)
            {
                Item item = this._decayQueue.Dequeue();

                if (item.OnDecay())
                {
                    item.Delete();
                }
            }
        }</pre>

Fragment 2 in file Server\Persistence\StandardSaveStrategy.cs

<pre>public override void ProcessDecay()
        {
            while (this._decayQueue.Count > 0)
            {
                Item item = this._decayQueue.Dequeue();

                if (item.OnDecay())
                {
                    item.Delete();
                }
            }
        }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Mistral.cs

<pre>public override void GenerateLoot()
        {
            this.AddLoot(LootPack.Average);
            this.AddLoot(LootPack.Meager);
            this.AddLoot(LootPack.LowScrolls);
            this.AddLoot(LootPack.MedScrolls);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Named\Tempest.cs

<pre>public override void GenerateLoot()
        {
            this.AddLoot(LootPack.Average);
            this.AddLoot(LootPack.Meager);
            this.AddLoot(LootPack.LowScrolls);
            this.AddLoot(LootPack.MedScrolls);
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\AirElemental.cs

<pre>public override void GenerateLoot()
        {
            this.AddLoot(LootPack.Average);
            this.AddLoot(LootPack.Meager);
            this.AddLoot(LootPack.LowScrolls);
            this.AddLoot(LootPack.MedScrolls);
        }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(m.Location, m.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
            Effects.PlaySound(m, m.Map, 0x201);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlMagicWord.cs

<pre>Effects.SendLocationParticles( EffectItem.Create( m.Location, m.Map, EffectItem.DefaultDuration ), 0x3728, 8, 20, 5042 );
			Effects.PlaySound( m, m.Map, 0x201 );</pre>

Fragment 3 in file Scripts\Spells\Chivalry\DispelEvil.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(m.Location, m.Map, EffectItem.DefaultDuration), 0x3728, 8, 20, 5042);
                                Effects.PlaySound(m, m.Map, 0x201);</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Uzeraan.cs

<pre>if (!player.PlaceInBackpack(cont))
                            {
                                cont.Delete();
                                player.SendLocalizedMessage(1046260); // You need to clear some space in your inventory to continue with the quest.  Come back here when you have more space in your inventory.
                                return false;
                            }
                            else
                            {
                                dropped.Delete();
                                obj.Complete();
                                return true;
                            }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Uzeraan.cs

<pre>if (!player.PlaceInBackpack(cont))
                            {
                                cont.Delete();
                                player.SendLocalizedMessage(1046260); // You need to clear some space in your inventory to continue with the quest.  Come back here when you have more space in your inventory.
                                return false;
                            }
                            else
                            {
                                dropped.Delete();
                                obj.Complete();
                                return true;
                            }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Uzeraan.cs

<pre>if (!player.PlaceInBackpack(cont))
                            {
                                cont.Delete();
                                player.SendLocalizedMessage(1046260); // You need to clear some space in your inventory to continue with the quest.  Come back here when you have more space in your inventory.
                                return false;
                            }
                            else
                            {
                                dropped.Delete();
                                obj.Complete();
                                return true;
                            }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string result = SetPropertyValue(spawner, o, arglist[0], randvalue);
									// see if it was successful
									if (result != "Property has been set.")
									{
										status_str = arglist[0] + " : " + result;
										no_error = false;
									}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string result = SetPropertyValue(spawner, o, arglist[0], randvalue);
								// see if it was successful
								if (result != "Property has been set.")
								{
									status_str = arglist[0] + " : " + result;
									no_error = false;
								}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string result = SetPropertyValue(spawner, o, arglist[0], randvalue);

									// see if it was successful
									if (result != "Property has been set.")
									{
										status_str = arglist[0] + " : " + result;
										no_error = false;
									}</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
		public override int State
		{
			get { return base.State; }
			set
			{
				// prevent infinite recursion 
				if (!already_being_activated)
				{
					already_being_activated = true;
					Activate(null, value, null);
					already_being_activated = false;
				}

				InvalidateProperties();
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>[CommandProperty( AccessLevel.GameMaster )]
		public override int State
		{
			get { return base.State; }
			set
			{
				// prevent infinite recursion 
				if (!already_being_activated)
				{
					already_being_activated = true;
					Activate(null, value, null);
					already_being_activated = false;
				}

				InvalidateProperties();
			}
		}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
		public override int State
		{
			get { return base.State; }
			set
			{
				// prevent infinite recursion 
				if (!already_being_activated)
				{
					already_being_activated = true;
					Activate(null, value, null);
					already_being_activated = false;
				}

				InvalidateProperties();
			}
		}</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGauntlet.cs

<pre>XmlPoints.SendText(winner, 100311, ChallengeName);  // "You have won {0}"
                Winner = winner;
                RefreshSymmetricNoto(winner);
                GameBroadcast( 100312, winner.Name); // "The winner is {0}"
                AwardWinnings(winner, TotalPurse);
                EndGame();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGauntlet.cs

<pre>XmlPoints.SendText(winner, 100311, ChallengeName);  // "You have won {0}"
                Winner = winner;
                RefreshSymmetricNoto(winner);
                GameBroadcast( 100312, winner.Name); // "The winner is {0}"
                AwardWinnings(winner, TotalPurse);

                EndGame();</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGauntlet.cs

<pre>XmlPoints.SendText(winner, 100311, ChallengeName);  // "You have won {0}"
                Winner = winner;
                RefreshSymmetricNoto(winner);
                GameBroadcast( 100312, winner.Name); // "The winner is {0}"
                AwardWinnings(winner, TotalPurse);

                EndGame();</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\CategorizedAddGump.cs

<pre>if (OldStyle)
                this.AddImageTiled(x, y, TotalWidth - (OffsetSize * 3) - SetWidth, EntryHeight, HeaderGumpID);
            else
                this.AddImageTiled(x, y, PrevWidth, EntryHeight, HeaderGumpID);</pre>

Fragment 2 in file Scripts\Gumps\Go\GoGump.cs

<pre>if (OldStyle)
                this.AddImageTiled(x, y, TotalWidth - (OffsetSize * 3) - SetWidth, EntryHeight, HeaderGumpID);
            else
                this.AddImageTiled(x, y, PrevWidth, EntryHeight, HeaderGumpID);</pre>

Fragment 3 in file Scripts\Gumps\SkillsGump.cs

<pre>if (OldStyle)
                this.AddImageTiled(x, y, TotalWidth - (OffsetSize * 3) - SetWidth, EntryHeight, HeaderGumpID);
            else
                this.AddImageTiled(x, y, PrevWidth, EntryHeight, HeaderGumpID);</pre>

Fragment 4 in file Scripts\Gumps\WhoGump.cs

<pre>if (OldStyle)
                this.AddImageTiled(x, y, TotalWidth - (OffsetSize * 3) - SetWidth, EntryHeight, HeaderGumpID);
            else
                this.AddImageTiled(x, y, PrevWidth, EntryHeight, HeaderGumpID);</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\PowderOfTemperament.cs

<pre>{
                        if (((BaseWeapon)item).Attributes.Brittle > 0 || ((BaseWeapon)item).NegativeAttributes.Brittle > 0)
                            noGo = true;
                        antique = ((BaseWeapon)item).NegativeAttributes.Antique;
                    }</pre>

Fragment 2 in file Scripts\Items\Consumables\PowderOfTemperament.cs

<pre>{
                        if (((BaseArmor)item).Attributes.Brittle > 0 || ((BaseArmor)item).NegativeAttributes.Brittle > 0)
                            noGo = true;
                        antique = ((BaseArmor)item).NegativeAttributes.Antique;
                    }</pre>

Fragment 3 in file Scripts\Items\Consumables\PowderOfTemperament.cs

<pre>{
                        if (((BaseClothing)item).Attributes.Brittle > 0 || ((BaseClothing)item).NegativeAttributes.Brittle > 0)
                            noGo = true;
                        antique = ((BaseClothing)item).NegativeAttributes.Antique;
                    }</pre>

Fragment 4 in file Scripts\Items\Consumables\PowderOfTemperament.cs

<pre>{
                        if (((BaseJewel)item).Attributes.Brittle > 0 || ((BaseJewel)item).NegativeAttributes.Brittle > 0)
                            noGo = true;
                        antique = ((BaseJewel)item).NegativeAttributes.Antique;
                    }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>{
                        if(entry != null)
                        {
                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed--;

                                if(entry.PageBeingViewed < 0) entry.PageBeingViewed=0;
                                page = entry.PageBeingViewed;
                                break;

                            }
                        }
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>{
                        if(entry != null)
                        {
                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed--;

                                if(entry.PageBeingViewed < 0) entry.PageBeingViewed=0;
                                page = entry.PageBeingViewed;
                                break;

                            }
                        }
                    }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>{
                        if(entry != null)
                        {
                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed--;

                                if(entry.PageBeingViewed < 0) entry.PageBeingViewed=0;
                                page = entry.PageBeingViewed;
                                break;

                            }
                        }
                    }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>{
                        if(entry != null)
                        {
                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed--;

                                if(entry.PageBeingViewed < 0) entry.PageBeingViewed=0;

                                page = entry.PageBeingViewed;
                                break;

                            }
                        }
                    }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Base\SpellHelper.cs

<pre>{ false,	false,		false,		false,		false,		false,			false,			false,		false,				false,				false,				false,		false,		false,			false,						false,			false,				false,		false,      false }</pre>

Fragment 2 in file Scripts\Spells\Base\SpellHelper.cs

<pre>{ false,	false,		false,		false,		false,		false,			false,			false,		false,				false,				false,				false,		false,		false,			false,						false,			false,				false,		false,      false }</pre>

Fragment 3 in file Scripts\Spells\Base\SpellHelper.cs

<pre>{ false,	false,		false,		false,		false,		false,			false,			false,		false,				false,				false,				false,		false,		false,			false,						false,			false,				false,		false,      false }</pre>

Fragment 4 in file Scripts\Spells\Base\SpellHelper.cs

<pre>{ false,	false,		false,		false,		false,		false,			false,			false,		false,				false,				false,				false,		false,		false,			false,						false,			false,				false,		false,      false }</pre>

## Duplicated Code. Size: 82

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Books\RunicAtlas.cs

<pre>public void Refresh()
        {
            Entries.Clear();
            Entries.TrimExcess();
            AddGumpLayout();

            User.CloseGump(this.GetType());
            User.SendGump(this, false);
        }</pre>

Fragment 2 in file Scripts\Quests\Eodon\Valley of One Quest\TigerCubEnclosure.cs

<pre>public void Refresh()
            {
                Entries.Clear();
                Entries.TrimExcess();
                AddGumpLayout();

                User.CloseGump(this.GetType());
                User.SendGump(this, false);
            }</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\AuctionSafe\Gumps.cs

<pre>public void Refresh()
        {
            Entries.Clear();
            Entries.TrimExcess();
            AddGumpLayout();

            User.CloseGump(this.GetType());
            User.SendGump(this, false);
        }</pre>

Fragment 4 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>public void Refresh()
        {
            Entries.Clear();
            Entries.TrimExcess();
            AddGumpLayout();
            User.CloseGump(this.GetType());
            User.SendGump(this, false);
        }</pre>

Fragment 5 in file Scripts\Services\FireCasino\CasinoGumps.cs

<pre>public void Refresh()
        {
            Entries.Clear();
            Entries.TrimExcess();
            AddGumpLayout();
            User.CloseGump(this.GetType());
            User.SendGump(this, false);
        }</pre>

Fragment 6 in file Scripts\Services\Vendor Searching\VendorSearchGump.cs

<pre>public void Refresh()
        {
            Entries.Clear();
            Entries.TrimExcess();
            AddGumpLayout();
            User.CloseGump(this.GetType());
            User.SendGump(this, false);
        }</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\CategorizedAddGump.cs

<pre>x - OffsetSize - 22 - ((i % 2) * 44) - (bounds.Width / 2) - bounds.X, y + EntryHeight - 1 - bounds.Height - bounds.Y, itemID</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlCategorizedAddGump.cs

<pre>x - OffsetSize - 22 - ((i % 2) * 44) - (bounds.Width / 2) - bounds.X, y + EntryHeight - 1 - bounds.Height - bounds.Y, itemID</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\GargishSignOfChaos.cs

<pre>{
			this.Name = "Sign of Chaos";
			this.Hue = 2075;

            this.ArmorAttributes.SoulCharge = 20;
            this.Attributes.AttackChance = 5;
            this.Attributes.DefendChance = 10;
            this.Attributes.CastSpeed = 1;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\HumanSignOfChaos.cs

<pre>{
            this.Name = "Sign of Chaos";
            this.Hue = 2075;

            this.ArmorAttributes.SoulCharge = 20;
            this.Attributes.AttackChance = 5;
            this.Attributes.DefendChance = 10;
            this.Attributes.CastSpeed = 1;
        }</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Books\RunicAtlas.cs

<pre>string coords = ToCoordinates(e.Location, e.Map);

                if(coords != "unknown")
                    User.SendMessage(ToCoordinates(e.Location, e.Map));

                Atlas.OnTravel();</pre>

Fragment 2 in file Scripts\Items\Books\RunicAtlas.cs

<pre>string coords = ToCoordinates(e.Location, e.Map);

                if(coords != "unknown")
                    User.SendMessage(ToCoordinates(e.Location, e.Map));

                Atlas.OnTravel();</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\BankCheck.cs

<pre>var plat = (int)Math.Truncate(total);
					var gold = (int)((total - plat) * Account.CurrencyThreshold);

					tradeInfo.Plat += plat;
					tradeInfo.Gold += gold;</pre>

Fragment 2 in file Scripts\Items\Consumables\Gold.cs

<pre>var plat = (int)Math.Truncate(total);
					var gold = (int)((total - plat) * Account.CurrencyThreshold);

					tradeInfo.Plat += plat;
					tradeInfo.Gold += gold;</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>Effects.PlaySound(GetWorldLocation(), Map, 0x3B3);
                from.SendLocalizedMessage(500461); // You destroy the item.

                Delete();

                house.Addons.Remove(this);
                var deed = new CraftableHouseDoorDeed();</pre>

Fragment 2 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>Effects.PlaySound(GetWorldLocation(), Map, 0x3B3);
                from.SendLocalizedMessage(500461); // You destroy the item.

                Delete();

                house.Addons.Remove(this);
                var deed = new CraftableHouseDoorDeed();</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\MondainsLegacy.cs

<pre>XmlDocument doc = new XmlDocument();
                doc.Load(Path.Combine(Core.BaseDirectory, "Data/Mondain's Legacy/Settings.xml"));

                XmlElement root = doc["Settings"];

                if (root == null)
                    return;</pre>

Fragment 2 in file Scripts\Misc\MondainsLegacy.cs

<pre>XmlDocument doc = new XmlDocument();
                doc.Load(Path.Combine(Core.BaseDirectory, "Data/Mondain's Legacy/Settings.xml"));

                XmlElement root = doc["Settings"];

                if (root == null)
                    return;</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\MonstrousInterredGrizzle.cs

<pre>if (this.m_Table[m] is Timer)
            {
                Timer timer = (Timer)this.m_Table[m];

                timer.Stop();

                this.m_Table[m] = null;
            }</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\MonstrousInterredGrizzle.cs

<pre>if (this.m_Table[m] is Timer)
            {
                Timer timer = (Timer)this.m_Table[m];				
                timer.Stop();			
                this.m_Table[m] = null;	
            }</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DespiseCreature.cs

<pre>SetStr(StrStart);
            SetDex(DexStart);
            SetInt(IntStart);

            SetHits(HitsStart);
            SetStam(StamStart);
            SetMana(ManaStart);

            SetDamage(MinDamStart, MaxDamStart);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Creatures\CovetousCreature.cs

<pre>SetStr(StrStart);
            SetDex(DexStart);
            SetInt(IntStart);

            SetHits(HitsStart);
            SetStam(StamStart);
            SetMana(ManaStart);

            SetDamage(MinDamStart, MaxDamStart);</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>if (c == null)
                return null;

            List<Item> list = new List<Item>(c.Items);
            List<Item> fishies = new List<Item>();</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>if (c == null)
                return null;

            List<Item> list = new List<Item>(c.Items);
            List<Item> fishies = new List<Item>();</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\DuelContext.cs

<pre>bool eastToWest;

            if (rx >= 0 && ry >= 0)
                eastToWest = false;
            else if (rx >= 0)
                eastToWest = true;
            else if (ry >= 0)
                eastToWest = true;
            else
                eastToWest = false;</pre>

Fragment 2 in file Scripts\Spells\Sixth\ParalyzeField.cs

<pre>bool eastToWest;

                if (rx >= 0 && ry >= 0)
                    eastToWest = false;
                else if (rx >= 0)
                    eastToWest = true;
                else if (ry >= 0)
                    eastToWest = true;
                else
                    eastToWest = false;</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Items\Fish\CrabsAndLobsters.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write((int)0);
            writer.Write(m_CaughtBy);
            writer.Write(m_DateCaught);
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\Fish\RareFish.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write((int)0);
            writer.Write(m_CaughtBy);
            writer.Write(m_DateCaught);
        }</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlMagicWord.cs

<pre>b.MoveToWorld(m.Location, m.Map);
					b.Owners.Add( m );
					b.SetControlMaster( m );
					if(b.Controlled)
						m.SendMessage("You master the beast!");
					break;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlMagicWord.cs

<pre>b.MoveToWorld(m.Location, m.Map);
					b.Owners.Add( m );
					b.SetControlMaster( m );
					if(b.Controlled)
						m.SendMessage("You master the beast!");
					break;</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomAttacks.cs

<pre>public void DoComboTimer(Mobile from, TimeSpan delay)
        {
            if ( m_ComboTimer != null )
                m_ComboTimer.Stop();

            m_ComboTimer = new ComboTimer(from, this, delay);

            m_ComboTimer.Start();
        }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomDefenses.cs

<pre>public void DoComboTimer(Mobile from, TimeSpan delay)
        {
            if ( m_ComboTimer != null )
                m_ComboTimer.Stop();

            m_ComboTimer = new ComboTimer(from, this, delay);

            m_ComboTimer.Start();
        }</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Base\SpellHelper.cs

<pre>this.m_Spell = s;

                if (this.m_Spell != null && this.m_Spell.DelayedDamage && !this.m_Spell.DelayedDamageStacking)
                    this.m_Spell.StartDelayedDamageContext(target, this);

                this.Priority = TimerPriority.TwentyFiveMS;</pre>

Fragment 2 in file Scripts\Spells\Base\SpellHelper.cs

<pre>this.m_Spell = s;
                if (this.m_Spell != null && this.m_Spell.DelayedDamage && !this.m_Spell.DelayedDamageStacking)
                    this.m_Spell.StartDelayedDamageContext(target, this);

                this.Priority = TimerPriority.TwentyFiveMS;</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Chivalry\RemoveCurse.cs

<pre>m.Paralyzed = false;

                    EvilOmenSpell.TryEndEffect(m);
                    StrangleSpell.RemoveCurse(m);
                    CorpseSkinSpell.RemoveCurse(m);
                    CurseSpell.RemoveEffect(m);
                    MortalStrike.EndWound(m);</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\Rejuvinate.cs

<pre>m.Paralyzed = false;

                        EvilOmenSpell.TryEndEffect(m);
                        StrangleSpell.RemoveCurse(m);
                        CorpseSkinSpell.RemoveCurse(m);
                        CurseSpell.RemoveEffect(m);
                        MortalStrike.EndWound(m);</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Server\Gumps\GumpButton.cs

<pre>public GumpButtonType Type
		{
			get
			{
				return m_Type;
			}
			set
			{
				if ( m_Type != value )
				{
					m_Type = value;

					Gump parent = Parent;

					if ( parent != null )
					{
						parent.Invalidate();
					}
				}
			}
		}</pre>

Fragment 2 in file Server\Gumps\GumpImageTileButton.cs

<pre>public GumpButtonType Type
		{
			get
			{
				return m_Type;
			}
			set
			{
				if( m_Type != value )
				{
					m_Type = value;

					Gump parent = Parent;

					if( parent != null )
					{
						parent.Invalidate();
					}
				}
			}
		}</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Server\Random.cs

<pre>public void NextBytes(byte[] b)
		{
			int c = b.Length;

			if (c >= LARGE_REQUEST)
			{
				SafeNativeMethods.rdrand_get_bytes(c, b);
				return;
			}
			_GetBytes(b);
		}</pre>

Fragment 2 in file Server\Random.cs

<pre>public void NextBytes(byte[] b)
		{
			int c = b.Length;

			if (c >= LARGE_REQUEST)
			{
				SafeNativeMethods.rdrand_get_bytes(c, b);
				return;
			}
			_GetBytes(b);
		}</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Ultima\Art.cs

<pre>{
					ushort* cur = line + xOffset;
					ushort* end = cur + xRun;

					while (cur < end)
					{
						*cur++ = (ushort)(*bdata++ | 0x8000);
					}
				}</pre>

Fragment 2 in file Ultima\Art.cs

<pre>{
					ushort* cur = line + xOffset;
					ushort* end = cur + xRun;

					while (cur < end)
					{
						*cur++ = (ushort)(*bdata++ | 0x8000);
					}
				}</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BaseAddonContainer.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (!CraftResources.IsStandard(this.m_Resource))
                list.Add(CraftResources.GetLocalizationNumber(this.m_Resource));
        }</pre>

Fragment 2 in file Scripts\Items\Addons\BaseAddonContainerDeed.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (!CraftResources.IsStandard(this.m_Resource))
                list.Add(CraftResources.GetLocalizationNumber(this.m_Resource));
        }</pre>

Fragment 3 in file Scripts\Items\Addons\BaseAddonDeed.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (!CraftResources.IsStandard(this.m_Resource))
                list.Add(CraftResources.GetLocalizationNumber(this.m_Resource));
        }</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\BaseConflagrationPotion.cs

<pre>public static void EndDelay(Mobile m)
        {
            Timer timer = m_Delay[m] as Timer;

            if (timer != null)
            {
                timer.Stop();
                m_Delay.Remove(m);
            }
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\BaseConfusionBlastPotion.cs

<pre>public static void EndDelay(Mobile m)
        {
            Timer timer = m_Delay[m] as Timer;

            if (timer != null)
            {
                timer.Stop();
                m_Delay.Remove(m);
            }
        }</pre>

Fragment 3 in file Scripts\Items\Consumables\BaseExplodingTarPotion.cs

<pre>public static void EndDelay( Mobile m )
		{
			Timer timer = m_Delay[ m ] as Timer;

			if ( timer != null )
			{
				timer.Stop();
				m_Delay.Remove( m );
			}
		}</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Fifth\PoisonField.cs

<pre>this.Visible && this.m_Caster != null && (!Core.AOS || m != this.m_Caster) && SpellHelper.ValidIndirectTarget(this.m_Caster, m) && this.m_Caster.CanBeHarmful(m, false)</pre>

Fragment 2 in file Scripts\Spells\Fourth\FireField.cs

<pre>this.Visible && this.m_Caster != null && (!Core.AOS || m != this.m_Caster) && SpellHelper.ValidIndirectTarget(this.m_Caster, m) && this.m_Caster.CanBeHarmful(m, false)</pre>

Fragment 3 in file Scripts\Spells\Sixth\ParalyzeField.cs

<pre>this.Visible && this.m_Caster != null && (!Core.AOS || m != this.m_Caster) && SpellHelper.ValidIndirectTarget(this.m_Caster, m) && this.m_Caster.CanBeHarmful(m, false)</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Ethereals.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0)
            {
                EtherealHue = 0;
                OriginalHue = 0;
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Ethereals.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0)
            {
                EtherealHue = 0;
                OriginalHue = 0;
            }
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\Ethereals.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0)
            {
                EtherealHue = 0;
                OriginalHue = 0;
            }
        }</pre>

Fragment 4 in file Scripts\Mobiles\Normal\Ethereals.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0)
            {
                EtherealHue = 0;
                OriginalHue = 0;
            }
        }</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\DuelContext.cs

<pre>if (!this.m_StartedBeginCountdown)
                return true;

            DuelPlayer pl = this.Find(from);

            if (pl == null || pl.Eliminated)
                return true;

            if (this.CantDoAnything(from))
                return false;</pre>

Fragment 2 in file Scripts\Services\ConPVP\DuelContext.cs

<pre>if (!this.m_StartedBeginCountdown)
                return true;

            DuelPlayer pl = this.Find(from);

            if (pl == null || pl.Eliminated)
                return true;

            if (this.CantDoAnything(from))
                return false;</pre>

Fragment 3 in file Scripts\Services\ConPVP\DuelContext.cs

<pre>if (!this.m_StartedBeginCountdown)
                return true;

            DuelPlayer pl = this.Find(from);

            if (pl == null || pl.Eliminated)
                return true;

            if (this.CantDoAnything(from))
                return false;</pre>

Fragment 4 in file Scripts\Services\ConPVP\DuelContext.cs

<pre>if (!this.m_StartedBeginCountdown)
                return true;

            DuelPlayer pl = this.Find(from);

            if (pl == null || pl.Eliminated)
                return true;

            if (this.CantDoAnything(from))
                return false;</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTF.cs

<pre>public class ChallengeEntry : BaseChallengeEntry
		{

            public ChallengeEntry(Mobile m, int team) : base( m)
            {
                Team = team;
            }

            public ChallengeEntry(Mobile m) : base (m)
            {
            }

            public ChallengeEntry() : base ()
            {
            }
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGauntlet.cs

<pre>public class ChallengeEntry : BaseChallengeEntry
		{
            public ChallengeEntry(Mobile m, int team) : base( m)
            {
                Team = team;
            }

            public ChallengeEntry(Mobile m) : base (m)
            {
            }

            public ChallengeEntry() : base ()
            {
            }
		}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGauntlet.cs

<pre>public class ChallengeEntry : BaseChallengeEntry
		{

            public ChallengeEntry(Mobile m, int team) : base( m)
            {
                Team = team;
            }

            public ChallengeEntry(Mobile m) : base (m)
            {
            }

            public ChallengeEntry() : base ()
            {
            }
		}</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGauntlet.cs

<pre>public class ChallengeEntry : BaseChallengeEntry
		{

            public ChallengeEntry(Mobile m, int team) : base( m)
            {
                Team = team;
            }

            public ChallengeEntry(Mobile m) : base (m)
            {
            }

            public ChallengeEntry() : base ()
            {
            }
		}</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGauntlet.cs

<pre>public class ChallengeEntry : BaseChallengeEntry
		{

            public ChallengeEntry(Mobile m, int team) : base( m)
            {
                Team = team;
            }

            public ChallengeEntry(Mobile m) : base (m)
            {
            }

            public ChallengeEntry() : base ()
            {
            }
		}</pre>

## Duplicated Code. Size: 81

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Quest\AbyssKey.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Lifespan = reader.ReadInt();

            this.StartTimer();
        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\QuestItems\WillemHartesHat.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();
            this.m_Lifespan = reader.ReadInt();

            this.StartTimer();
        }</pre>

Fragment 3 in file Scripts\Services\Peerless\PeerlessKey.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Lifespan = reader.ReadInt();

            this.StartTimer();
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\ExodusSacrificalDagger.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();
            this.m_Lifespan = reader.ReadInt();

            this.StartTimer();
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\ExodusSummoningRite.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();
            this.m_Lifespan = reader.ReadInt();

            this.StartTimer();
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\RobeofRite.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();
            this.m_Lifespan = reader.ReadInt();

            this.StartTimer();
        }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\Abilities.cs

<pre>{
            int xdiff = start.X - end.X;
            int ydiff = start.Y - end.Y;
            return Math.Sqrt((xdiff * xdiff) + (ydiff * ydiff));
        }</pre>

Fragment 2 in file Scripts\Abilities\AbilityTheSix.cs

<pre>{
                int xdiff = start.X - end.X;
                int ydiff = start.Y - end.Y;
                return Math.Sqrt((xdiff * xdiff) + (ydiff * ydiff));
            }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\Disarm.cs

<pre>Item toDisarm = defender.FindItemOnLayer(Layer.OneHanded);

            if (toDisarm == null || !toDisarm.Movable)
                toDisarm = defender.FindItemOnLayer(Layer.TwoHanded);

            Container pack = defender.Backpack;</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\Fists.cs

<pre>Item toDisarm = defender.FindItemOnLayer(Layer.OneHanded);

                                if (toDisarm == null || !toDisarm.Movable)
                                    toDisarm = defender.FindItemOnLayer(Layer.TwoHanded);

                                Container pack = defender.Backpack;</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Implementors\AreaCommandImplementor.cs

<pre>object[] states = (object[])state;
                BaseCommand command = (BaseCommand)states[0];
                string[] args = (string[])states[1];</pre>

Fragment 2 in file Scripts\Commands\Generic\Implementors\MultiCommandImplementor.cs

<pre>object[] states = (object[])state;
            BaseCommand command = (BaseCommand)states[0];
            string[] args = (string[])states[1];</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Logging.cs

<pre>public static void AppendPath(ref string path, string toAppend)
        {
            path = Path.Combine(path, toAppend);

            if (!Directory.Exists(path))
                Directory.CreateDirectory(path);
        }</pre>

Fragment 2 in file Scripts\Services\Chat\Logging.cs

<pre>public static void AppendPath(ref string path, string toAppend)
        {
            path = Path.Combine(path, toAppend);

            if (!Directory.Exists(path))
                Directory.CreateDirectory(path);
        }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AdminGump.cs

<pre>this.AddHtml(18, 243 + (i * 22), 114, 20, this.Color(this.m_List[index].ToString(), LabelColor32), false, false);</pre>

Fragment 2 in file Scripts\Gumps\AdminGump.cs

<pre>this.AddHtml(18, 243 + (i * 22), 114, 20, this.Color(this.m_List[index].ToString(), LabelColor32), false, false);</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetObjectGump.cs

<pre>{
                this.m_Property = prop;
                this.m_Mobile = mobile;
                this.m_Object = o;
                this.m_Stack = stack;
                this.m_Type = type;
                this.m_Page = page;
                this.m_List = list;
            }</pre>

Fragment 2 in file Scripts\Gumps\Properties\SetObjectTarget.cs

<pre>{
            this.m_Property = prop;
            this.m_Mobile = mobile;
            this.m_Object = o;
            this.m_Stack = stack;
            this.m_Type = type;
            this.m_Page = page;
            this.m_List = list;
        }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\FlourMillEastAddon.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int CurFlour
        {
            get
            {
                return this.m_Flour;
            }
            set
            {
                this.m_Flour = Math.Max(0, Math.Min(value, this.MaxFlour));
                this.UpdateStage();
            }
        }</pre>

Fragment 2 in file Scripts\Items\Addons\FlourMillSouthAddon.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int CurFlour
        {
            get
            {
                return this.m_Flour;
            }
            set
            {
                this.m_Flour = Math.Max(0, Math.Min(value, this.MaxFlour));
                this.UpdateStage();
            }
        }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\VendorMallAddon.cs

<pre>ac = new AddonComponent( 3203 );
			AddComponent( ac, 9, 7, 0 );
			ac = new AddonComponent( 3203 );
			AddComponent( ac, 8, 8, 0 );</pre>

Fragment 2 in file Scripts\Items\Addons\VendorMallAddon.cs

<pre>ac = new AddonComponent( 3203 );
			AddComponent( ac, 9, 8, 0 );
			ac = new AddonComponent( 3203 );
			AddComponent( ac, 7, 8, 0 );</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Decorative\ImprisonedDog.cs

<pre>for (int i = this.Items.Count - 1; i >= 0; i --)
                if (this.Items[i] is ClonedItem)
                    this.Items[i].Delete();</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\Travesty.cs

<pre>for (int i = this.Items.Count - 1; i >= 0; i --)
                if (this.Items[i] is ClonedItem)
                    this.Items[i].Delete();</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>m_HitPoints = ((this.m_HitPoints * 100) + (scale - 1)) / scale;
            m_MaxHitPoints = ((this.m_MaxHitPoints * 100) + (scale - 1)) / scale;

            InvalidateProperties();</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>m_HitPoints = ((this.m_HitPoints * 100) + (scale - 1)) / scale;
            m_MaxHitPoints = ((this.m_MaxHitPoints * 100) + (scale - 1)) / scale;

            InvalidateProperties();</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Quest\BlueKey1.cs

<pre>if (b != null)
                {
                    m.AddToBackpack(new TripartiteKey());
                    a.Delete();
                    b.Delete();
                    this.Delete();
                    m.SendLocalizedMessage(1111649);
                }</pre>

Fragment 2 in file Scripts\Items\Quest\RedKey1.cs

<pre>if (b != null)
                {
                    m.AddToBackpack(new TripartiteKey());
                    a.Delete();
                    b.Delete();
                    this.Delete();
                    m.SendLocalizedMessage(1111649);
                }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\MonstrousInterredGrizzle.cs

<pre>to.SendLocalizedMessage(1072069); // A cacophonic sound lambastes you, suppressing your ability to move.
                to.PlaySound(0x584);

                m_Table[to] = Timer.DelayCall(TimeSpan.FromSeconds(30), new TimerStateCallback(EndCacophonic_Callback), to);</pre>

Fragment 2 in file Scripts\Mobiles\Named\Ilhenir.cs

<pre>to.SendLocalizedMessage(1072069); // A cacophonic sound lambastes you, suppressing your ability to move.
                to.PlaySound(0x584);

                m_Table[to] = Timer.DelayCall(TimeSpan.FromSeconds(30), new TimerStateCallback(EndCacophonic_Callback), to);</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BlackSolenQueen.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            m_Timer = new SpawnTimer(this);
            m_Timer.Start();
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RedSolenQueen.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            m_Timer = new SpawnTimer(this);
            m_Timer.Start();
        }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DesertOstard.cs

<pre>this.SetSkill(SkillName.Wrestling, 29.3, 44.0);

            this.Fame = 450;
            this.Karma = 0;

            this.Tamable = true;
            this.ControlSlots = 1;
            this.MinTameSkill = 29.1;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ForestOstard.cs

<pre>this.SetSkill(SkillName.Wrestling, 29.3, 44.0);

            this.Fame = 450;
            this.Karma = 0;

            this.Tamable = true;
            this.ControlSlots = 1;
            this.MinTameSkill = 29.1;</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\ArcherGuard.cs

<pre>pack.DropItem(new Gold(10, 25));

			AddItem(pack);

			Skills[SkillName.Anatomy].Base = 120.0;
			Skills[SkillName.Tactics].Base = 120.0;</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\WarriorGuard.cs

<pre>pack.DropItem(new Gold(10, 25));

			AddItem(pack);

			Skills[SkillName.Anatomy].Base = 120.0;
			Skills[SkillName.Tactics].Base = 120.0;</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Beotham.cs

<pre>this.InitStats(100, 100, 25);

            this.Female = false;
            this.CantWalk = true;
            this.Race = Race.Elf;

            this.Hue = 0x876C;
            this.HairItemID = 0x2FC0;</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Tallinin.cs

<pre>this.InitStats(100, 100, 25);

            this.Female = false;
            this.CantWalk = true;
            this.Race = Race.Elf;

            this.Hue = 0x876C;
            this.HairItemID = 0x2FC0;</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Filbert.cs

<pre>this.InitStats(100, 100, 25);

            this.Female = false;	
            this.CantWalk = true;
            this.Race = Race.Human;		

            this.Hue = 0x83F3;
            this.HairItemID = 0x203C;</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Odell.cs

<pre>this.InitStats(100, 100, 25);

            this.Female = false;	
            this.CantWalk = true;
            this.Race = Race.Human;		

            this.Hue = 0x83F3;
            this.HairItemID = 0x203C;</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\KeeperOfChivalry.cs

<pre>this.AddItem(new PlateArms());
            this.AddItem(new PlateChest());
            this.AddItem(new PlateGloves());
            this.AddItem(new StuddedGorget());</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Talbart.cs

<pre>this.AddItem(new PlateGloves());
            this.AddItem(new StuddedGorget());
            this.AddItem(new PlateChest());
            this.AddItem(new PlateArms());</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Kia.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Backpack());
            this.AddItem(new Shoes(0x743));
            this.AddItem(new Robe(0x485));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Sutek.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Backpack());
            this.AddItem(new Shoes(0x743));
            this.AddItem(new Robe(0x485));
        }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Questers.cs

<pre>SetWearable(new LeatherDo(), 1175);
            SetWearable(new FancyShirt(), 1175);
            SetWearable(new TattsukeHakama());
            SetWearable(new Sandals(), 1175);</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Mobiles\EodonTribesman.cs

<pre>SetWearable(new LeatherDo(), 1175);
                    SetWearable(new FancyShirt(), 1175);
                    SetWearable(new TattsukeHakama());
                    SetWearable(new Sandals(), 1175);</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\DuelContext.cs

<pre>DuelPlayer pl = p.Players[j];

                    if (pl == null || pl.Eliminated)
                        continue;

                    pl.Mobile.SendSound(0x1E1);
                    pl.Mobile.SendMessage(0x22, "Warning! Warning! Warning!");</pre>

Fragment 2 in file Scripts\Services\ConPVP\DuelContext.cs

<pre>DuelPlayer pl = p.Players[j];

                    if (pl == null || pl.Eliminated)
                        continue;

                    pl.Mobile.SendSound(0x1E1);
                    pl.Mobile.SendMessage(0x22, "Warning! Warning! Warning!");</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Mobiles\Charybdis.cs

<pre>FishingPole pole = new FishingPole();
            BaseRunicTool.ApplyAttributesTo(pole, false, 0, Utility.RandomMinMax(2, 5), 50, 100);
            c.DropItem(pole);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Mobiles\OsiredonTheScalisEnforcer.cs

<pre>FishingPole pole = new FishingPole();
            BaseRunicTool.ApplyAttributesTo(pole, false, 0, Utility.RandomMinMax(2, 5), 50, 100);
            c.DropItem(pole);</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Artifacts.cs

<pre>{
			WeaponAttributes.HitCurse = 10;
			Slayer = SlayerName.ReptilianDeath;
			WeaponAttributes.HitLeechMana = 80;
			Attributes.AttackChance = 20;
			Attributes.WeaponSpeed = 30;
			Attributes.WeaponDamage = 60;

			AosElementDamages.Poison = 100;
		}</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Artifacts.cs

<pre>{
			WeaponAttributes.HitCurse = 10;
			Slayer = SlayerName.ReptilianDeath;
			WeaponAttributes.HitLeechMana = 80;
			Attributes.AttackChance = 20;
			Attributes.WeaponSpeed = 30;
			Attributes.WeaponDamage = 60;

			AosElementDamages.Poison = 100;
		}</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Definitions\GuardDefinition.cs

<pre>{
            this.m_Type = type;

            this.m_Price = price;
            this.m_Upkeep = upkeep;
            this.m_Maximum = maximum;
            this.m_ItemID = itemID;

            this.m_Header = header;
            this.m_Label = label;
        }</pre>

Fragment 2 in file Scripts\Services\Factions\Definitions\VendorDefinition.cs

<pre>{
            this.m_Type = type;

            this.m_Price = price;
            this.m_Upkeep = upkeep;
            this.m_Maximum = maximum;
            this.m_ItemID = itemID;

            this.m_Header = header;
            this.m_Label = label;
        }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\FireCasino\DiceGames.cs

<pre>{
                Dealer.PrivateOverheadMessage(MessageType.Regular, 0x35, 1153376, String.Format("{0}\t{1}", Player.Name, CurrentBet.ToString(CultureInfo.GetCultureInfo("en-US"))), Player.NetState); // *rakes in ~1_NAME~'s ~2_VAL~-chip bet*
            }</pre>

Fragment 2 in file Scripts\Services\FireCasino\DiceGames.cs

<pre>{
                    Dealer.PrivateOverheadMessage(MessageType.Regular, 0x35, 1153376, String.Format("{0}\t{1}", Player.Name, CurrentBet.ToString(CultureInfo.GetCultureInfo("en-US"))), Player.NetState); // *rakes in ~1_NAME~'s ~2_VAL~-chip bet*
                }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\MondainsLegacyQuests\HeritageQuester.cs

<pre>this.m_Quests = new List<HeritageQuestInfo>();
            this.m_Objectives = new List<object>();
            this.m_Story = new List<object>();

            this.Initialize();</pre>

Fragment 2 in file Scripts\Services\MondainsLegacyQuests\HeritageQuester.cs

<pre>this.m_Quests = new List<HeritageQuestInfo>();
            this.m_Objectives = new List<object>();
            this.m_Story = new List<object>();

            this.Initialize();</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>{
                AddHtmlLocalized(215, 350, 150, 18, 1150695, OrangeColor16, false, false); // CONFIRM
				AddButton(175, 350, 4005, 4007, 1, GumpButtonType.Reply, 0);
			}</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>{
				AddHtmlLocalized(215, 350, 150, 18, 1150695, OrangeColor16, false, false); // CONFIRM
				AddButton(175, 350, 4005, 4007, 1, GumpButtonType.Reply, 0);
			}</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>savedItem = Mobile.LiftItemDupe(itemTarget, itemTarget.Amount);
										if (savedItem != null)
										{
											savedItem.Internalize();
										}

										int totaltaken = 0;

										int remaining = itemTarget.Amount - quantity;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>savedItem = Mobile.LiftItemDupe(itemTarget, itemTarget.Amount);
										if (savedItem != null)
										{
											savedItem.Internalize();
										}

										int totaltaken = 0;

										int remaining = itemTarget.Amount - quantity;</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>public void AttachToCallback(object state)
		{
			object[] args = (object[])state;

			XmlAttach.AttachTo(args[0], (XmlAttachment)args[1]);
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>public void AttachToCallback(object state)
        {
            object[] args = (object[])state;

            XmlAttach.AttachTo(args[0], (XmlAttachment)args[1]);
        }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>if (i is XmlSpawner)
									{
										XmlSpawner CheckXmlSpawner = (XmlSpawner)i;

										// Check if the spawners GUID is the same as the one being loaded
										// and that the spawners map is the same as the one being loaded
										if ((CheckXmlSpawner.UniqueId == SpawnId.ToString())
											/* && ( CheckXmlSpawner.Map == SpawnMap || loadrelative)*/ )
										{
											OldSpawner = (XmlSpawner)i;
											found_spawner = true;
										}
									}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>if (i is XmlSpawner)
							{
								XmlSpawner CheckXmlSpawner = (XmlSpawner)i;

								// Check if the spawners GUID is the same as the one being loaded
								// and that the spawners map is the same as the one being loaded
								if ((CheckXmlSpawner.UniqueId == SpawnId.ToString())
									/* && ( CheckXmlSpawner.Map == SpawnMap || loadrelative) */)
								{
									OldSpawner = (XmlSpawner)i;
									found_spawner = true;
								}
							}</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>string kills = "???";
					try
					{
						kills = a.Kills.ToString();
					} 
					catch{}

					string deaths = "???";
					try
					{
						deaths = a.Deaths.ToString();
					} 
					catch{}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>string kills = "???";
						try
						{
							kills = a.Kills.ToString();
						} 
						catch{}

						string deaths = "???";
						try
						{
							deaths = a.Deaths.ToString();
						} 
						catch{}</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\BodyGuard.cs

<pre>private bool HasShield()
        {
            BaseShield shield = Caster.FindItemOnLayer(Layer.TwoHanded) as BaseShield;

            if (shield == null)
            {
                Caster.SendLocalizedMessage(1156096); // You must be wielding a shield to use this ability!
                return false;
            }

            return true;
        }</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\ShieldBash.cs

<pre>private bool HasShield()
        {
            BaseShield shield = Caster.FindItemOnLayer(Layer.TwoHanded) as BaseShield;

            if (shield == null)
            {
                Caster.SendLocalizedMessage(1156096); // You must be wielding a shield to use this ability!
                return false;
            }

            return true;
        }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>m != this && m.X == oldX && m.Y == oldY && (m.Z + 15) > oldZ && (oldZ + 15) > m.Z && !m.OnMoveOff(this)</pre>

Fragment 2 in file Server\Mobile.cs

<pre>m != this && m.X == oldX && m.Y == oldY && (m.Z + 15) > oldZ && (oldZ + 15) > m.Z && !m.OnMoveOff(this)</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write((byte)0x00);
            m_Stream.Write((byte)0x00);
            m_Stream.Write((byte)0x00);
            m_Stream.Write((byte)0x03);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write((byte)0x03);
            m_Stream.Write((byte)0x00);
            m_Stream.Write((byte)0x00);
            m_Stream.Write((byte)0x00);</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write((byte)0x00);
            m_Stream.Write((byte)0x00);
            m_Stream.Write((byte)0x00);
            m_Stream.Write((byte)0x10);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write((byte)0x00);
            m_Stream.Write((byte)0x00);
            m_Stream.Write((byte)0x00);
            m_Stream.Write((byte)0x10);</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Ultima\FileIndex.cs

<pre>GCHandle gc = GCHandle.Alloc(Index, GCHandleType.Pinned);
					var buffer = new byte[index.Length];
					index.Read(buffer, 0, (int)index.Length);</pre>

Fragment 2 in file Ultima\FileIndex.cs

<pre>GCHandle gc = GCHandle.Alloc(Index, GCHandleType.Pinned);
					var buffer = new byte[index.Length];
					index.Read(buffer, 0, (int)index.Length);</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Ultima\Gumps.cs

<pre>length = (int)fsmul.Position - length;
							binidx.Write(length);
							binidx.Write((bmp.Width << 16) + bmp.Height);
							bmp.UnlockBits(bd);</pre>

Fragment 2 in file Ultima\Light.cs

<pre>length = (int)fsmul.Position - length;
							binidx.Write(length);
							binidx.Write((bmp.Width << 16) + bmp.Height);
							bmp.UnlockBits(bd);</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Ultima\TileMatrix.cs

<pre>public Tile GetLandTile(int x, int y)
		{
			return GetLandBlock(x >> 3, y >> 3)[((y & 0x7) << 3) + (x & 0x7)];
		}</pre>

Fragment 2 in file Ultima\TileMatrixPatch.cs

<pre>public Tile GetLandTile(int x, int y)
		{
			return GetLandBlock(x >> 3, y >> 3)[((y & 0x7) << 3) + (x & 0x7)];
		}</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DecorateDelete.cs

<pre>public static bool FindItem(int x, int y, int z, Map map, Item test)
        {
            return FindItem(new Point3D(x, y, z), map, test);
        }</pre>

Fragment 2 in file Scripts\Misc\MondainsLegacy.cs

<pre>public static bool FindItem(int x, int y, int z, Map map, Item test)
        {
            return FindItem(new Point3D(x, y, z), map, test);
        }</pre>

Fragment 3 in file Scripts\Services\Expansions\TimeOfLegends.cs

<pre>public static bool FindItem(int x, int y, int z, Map map, Item test)
        {
            return FindItem(new Point3D(x, y, z), map, test);
        }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\BagOfSending.cs

<pre>base.Serialize(writer);

            writer.WriteEncodedInt((int)1); // version

            writer.WriteEncodedInt((int)this.m_Recharges);

            writer.WriteEncodedInt((int)this.m_Charges);</pre>

Fragment 2 in file Scripts\Items\Tools\BallOfSummoning.cs

<pre>base.Serialize(writer);

            writer.WriteEncodedInt((int)1); // version

            writer.WriteEncodedInt((int)this.m_Recharges);

            writer.WriteEncodedInt((int)this.m_Charges);</pre>

Fragment 3 in file Scripts\Items\Tools\BraceletOfBinding.cs

<pre>base.Serialize(writer);

            writer.WriteEncodedInt((int)1); // version

            writer.WriteEncodedInt((int)this.m_Recharges);

            writer.WriteEncodedInt((int)this.m_Charges);</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Cohenn.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Backpack());
            this.AddItem(new Sandals(0x74A));
            this.AddItem(new Robe(0x498));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\FarmerNash.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Backpack());
            this.AddItem(new Sandals(0x74A));
            this.AddItem(new Robe(0x498));
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Nythalia.cs

<pre>public override void InitOutfit()
        {
            this.AddItem(new Backpack());
            this.AddItem(new Sandals(0x74A));
            this.AddItem(new Robe(0x498));
        }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Quests.cs

<pre>int x = Utility.RandomMinMax(p.X - 1, p.X + 1);
                                        int y = Utility.RandomMinMax(p.Y - 1, p.Y + 1);</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Encounters.cs

<pre>int x = Utility.RandomMinMax(p.X - 1, p.X + 1);
                int y = Utility.RandomMinMax(p.Y - 1, p.Y + 1);</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Items.cs

<pre>int x = Utility.RandomMinMax(p.X - 1, p.X + 1);
                                            int y = Utility.RandomMinMax(p.Y - 1, p.Y + 1);</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlTitle.cs

<pre>if (this.AttachedTo is Mobile)
                {
                    ((Mobile)this.AttachedTo).InvalidateProperties();
                }
                if (this.AttachedTo is Item)
                {
                    ((Item)this.AttachedTo).InvalidateProperties();
                }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlTitle.cs

<pre>if (this.AttachedTo is Mobile)
            {
                ((Mobile)this.AttachedTo).InvalidateProperties();
            }
            if (this.AttachedTo is Item)
            {
                ((Item)this.AttachedTo).InvalidateProperties();
            }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlTitle.cs

<pre>if (this.AttachedTo is Mobile)
            {
                ((Mobile)this.AttachedTo).InvalidateProperties();
            }
            if (this.AttachedTo is Item)
            {
                ((Item)this.AttachedTo).InvalidateProperties();
            }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\Hides.cs

<pre>if (this.Deleted || !from.CanSee(this))
                return false;

            if (Core.AOS && !this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(502437); // Items you wish to cut must be in your backpack
                return false;
            }</pre>

Fragment 2 in file Scripts\Items\Resource\Hides.cs

<pre>if (this.Deleted || !from.CanSee(this))
                return false;

            if (Core.AOS && !this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(502437); // Items you wish to cut must be in your backpack
                return false;
            }</pre>

Fragment 3 in file Scripts\Items\Resource\Hides.cs

<pre>if (this.Deleted || !from.CanSee(this))
                return false;

            if (Core.AOS && !this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(502437); // Items you wish to cut must be in your backpack
                return false;
            }</pre>

Fragment 4 in file Scripts\Items\Resource\Hides.cs

<pre>if (this.Deleted || !from.CanSee(this))
                return false;

            if (Core.AOS && !this.IsChildOf(from.Backpack))
            {
                from.SendLocalizedMessage(502437); // Items you wish to cut must be in your backpack
                return false;
            }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Aurvidlem.cs

<pre>public override void InitBody()
        { 
            this.HairItemID = 0x2044;//
            this.HairHue = 1153;
            this.FacialHairItemID = 0x204B;
            this.FacialHairHue = 1153;
            this.Body = 666;            
            this.Blessed = true;
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Beninort.cs

<pre>public override void InitBody()
        { 
            this.HairItemID = 0x2044;//
            this.HairHue = 1153;
            this.FacialHairItemID = 0x204B;
            this.FacialHairHue = 1153;
            this.Body = 666;            
            this.Blessed = true;
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Thepem.cs

<pre>public override void InitBody()
        {
            this.HairItemID = 0x2044;//
            this.HairHue = 1153;
            this.FacialHairItemID = 0x204B;
            this.FacialHairHue = 1153;
            this.Body = 666;
            this.Blessed = true;
        }</pre>

Fragment 4 in file Scripts\Mobiles\NPCs\Zosilem.cs

<pre>public override void InitBody()
        { 
            this.HairItemID = 0x2044;//
            this.HairHue = 1153;
            this.FacialHairItemID = 0x204B;
            this.FacialHairHue = 1153;
            this.Body = 666;            
            this.Blessed = true;
        }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\ArcaneBookshelfEastAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();

            Timer.DelayCall(TimeSpan.FromSeconds(10), Replace);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\ArcaneBookshelfEastAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();

            Timer.DelayCall(TimeSpan.FromSeconds(10), Replace);
        }</pre>

Fragment 3 in file Scripts\Items\Addons\ArcaneBookshelfSouthAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();

            Timer.DelayCall(TimeSpan.FromSeconds(10), Replace);
        }</pre>

Fragment 4 in file Scripts\Items\Addons\ArcaneBookshelfSouthAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();

            Timer.DelayCall(TimeSpan.FromSeconds(10), Replace);
        }</pre>

Fragment 5 in file Scripts\Items\Addons\ElvenDresserEastAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();

            Timer.DelayCall(TimeSpan.FromSeconds(10), Replace);
        }</pre>

Fragment 6 in file Scripts\Items\Addons\ElvenDresserEastAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();

            Timer.DelayCall(TimeSpan.FromSeconds(10), Replace);
        }</pre>

Fragment 7 in file Scripts\Items\Addons\ElvenDresserSouthAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();

            Timer.DelayCall(TimeSpan.FromSeconds(10), Replace);
        }</pre>

Fragment 8 in file Scripts\Items\Addons\ElvenDresserSouthAddon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();

            Timer.DelayCall(TimeSpan.FromSeconds(10), Replace);
        }</pre>

## Duplicated Code. Size: 80

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Chivalry\CleanseByFire.cs

<pre>public override bool CheckCast()
        {
            if (Engines.ConPVP.DuelContext.CheckSuddenDeath(this.Caster))
            {
                this.Caster.SendMessage(0x22, "You cannot cast this spell when in sudden death.");
                return false;
            }

            return base.CheckCast();
        }</pre>

Fragment 2 in file Scripts\Spells\Chivalry\CloseWounds.cs

<pre>public override bool CheckCast()
        {
            if (Engines.ConPVP.DuelContext.CheckSuddenDeath(this.Caster))
            {
                this.Caster.SendMessage(0x22, "You cannot cast this spell when in sudden death.");
                return false;
            }

            return base.CheckCast();
        }</pre>

Fragment 3 in file Scripts\Spells\Chivalry\RemoveCurse.cs

<pre>public override bool CheckCast()
        {
            if (Engines.ConPVP.DuelContext.CheckSuddenDeath(this.Caster))
            {
                this.Caster.SendMessage(0x22, "You cannot cast this spell when in sudden death.");
                return false;
            }

            return base.CheckCast();
        }</pre>

Fragment 4 in file Scripts\Spells\Eighth\Resurrection.cs

<pre>public override bool CheckCast()
        {
            if (Engines.ConPVP.DuelContext.CheckSuddenDeath(this.Caster))
            {
                this.Caster.SendMessage(0x22, "You cannot cast this spell when in sudden death.");
                return false;
            }

            return base.CheckCast();
        }</pre>

Fragment 5 in file Scripts\Spells\First\Heal.cs

<pre>public override bool CheckCast()
        {
            if (Engines.ConPVP.DuelContext.CheckSuddenDeath(this.Caster))
            {
                this.Caster.SendMessage(0x22, "You cannot cast this spell when in sudden death.");
                return false;
            }

            return base.CheckCast();
        }</pre>

Fragment 6 in file Scripts\Spells\Fourth\GreaterHeal.cs

<pre>public override bool CheckCast()
        {
            if (Engines.ConPVP.DuelContext.CheckSuddenDeath(this.Caster))
            {
                this.Caster.SendMessage(0x22, "You cannot cast this spell when in sudden death.");
                return false;
            }

            return base.CheckCast();
        }</pre>

Fragment 7 in file Scripts\Spells\Second\Agility.cs

<pre>public override bool CheckCast()
        {
            if (Engines.ConPVP.DuelContext.CheckSuddenDeath(this.Caster))
            {
                this.Caster.SendMessage(0x22, "You cannot cast this spell when in sudden death.");
                return false;
            }

            return base.CheckCast();
        }</pre>

Fragment 8 in file Scripts\Spells\Second\Cunning.cs

<pre>public override bool CheckCast()
        {
            if (Engines.ConPVP.DuelContext.CheckSuddenDeath(this.Caster))
            {
                this.Caster.SendMessage(0x22, "You cannot cast this spell when in sudden death.");
                return false;
            }

            return base.CheckCast();
        }</pre>

Fragment 9 in file Scripts\Spells\Second\Cure.cs

<pre>public override bool CheckCast()
        {
            if (Engines.ConPVP.DuelContext.CheckSuddenDeath(this.Caster))
            {
                this.Caster.SendMessage(0x22, "You cannot cast this spell when in sudden death.");
                return false;
            }

            return base.CheckCast();
        }</pre>

Fragment 10 in file Scripts\Spells\Second\Strength.cs

<pre>public override bool CheckCast()
        {
            if (Engines.ConPVP.DuelContext.CheckSuddenDeath(this.Caster))
            {
                this.Caster.SendMessage(0x22, "You cannot cast this spell when in sudden death.");
                return false;
            }

            return base.CheckCast();
        }</pre>

Fragment 11 in file Scripts\Spells\Sixth\Invisibility.cs

<pre>public override bool CheckCast()
        {
            if (Engines.ConPVP.DuelContext.CheckSuddenDeath(this.Caster))
            {
                this.Caster.SendMessage(0x22, "You cannot cast this spell when in sudden death.");
                return false;
            }

            return base.CheckCast();
        }</pre>

Fragment 12 in file Scripts\Spells\Third\Bless.cs

<pre>public override bool CheckCast()
        {
            if (Engines.ConPVP.DuelContext.CheckSuddenDeath(this.Caster))
            {
                this.Caster.SendMessage(0x22, "You cannot cast this spell when in sudden death.");
                return false;
            }

            return base.CheckCast();
        }</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Commands\Interface.cs

<pre>if ((this.m_Page + 1) * EntriesPerPage < this.m_List.Count)
                this.AddEntryButton(20, ArrowRightID1, ArrowRightID2, 2, ArrowRightWidth, ArrowRightHeight);
            else
                this.AddEntryHeader(20);</pre>

Fragment 2 in file Scripts\Commands\HelpInfo.cs

<pre>if ((this.m_Page + 1) * EntriesPerPage < this.m_List.Count)
                    this.AddEntryButton(20, ArrowRightID1, ArrowRightID2, 2, ArrowRightWidth, ArrowRightHeight);
                else
                    this.AddEntryHeader(20);</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SHTelGenDelete.cs

<pre>this.AddSHTCouple(false, 5809, 1905, 0, false, 5876, 1891, 0);

                tele1 = this.AddSHT(Map.Trammel, false, 5814, 2015, 0);</pre>

Fragment 2 in file Scripts\Items\Addons\SHTeleporter.cs

<pre>this.AddSHTCouple(false, 5809, 1905, 0, false, 5876, 1891, 0);

                tele1 = this.AddSHT(Map.Trammel, false, 5814, 2015, 0);</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\GuildCharterPrompt.cs

<pre>if (GuildGump.BadLeader(this.m_Mobile, this.m_Guild))
                return;

            text = text.Trim();

            if (text.Length > 50)
                text = text.Substring(0, 50);</pre>

Fragment 2 in file Scripts\Gumps\Guilds\GuildWebsitePrompt.cs

<pre>if (GuildGump.BadLeader(this.m_Mobile, this.m_Guild))
                return;

            text = text.Trim();

            if (text.Length > 50)
                text = text.Substring(0, 50);</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\HouseGump.cs

<pre>this.AddHtmlLocalized(200, 340, 355, 30, 1011277, false, false); // Okay that is fine.
                this.AddButton(350, 340, 4005, 4007, 18, GumpButtonType.Reply, 0);</pre>

Fragment 2 in file Scripts\Gumps\HouseGump.cs

<pre>this.AddHtmlLocalized(200, 340, 355, 30, 1011277, false, false); // Okay that is fine.
                this.AddButton(350, 340, 4005, 4007, 18, GumpButtonType.Reply, 0);</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseRanged.cs

<pre>if (attacker is PlayerMobile)
				{
					PlayerMobile pm = (PlayerMobile)attacker;

					if (pm.DuelContext != null && !pm.DuelContext.CheckItemEquip(attacker, this))
					{
						canSwing = false;
					}
				}</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if (attacker is PlayerMobile)
			{
				PlayerMobile pm = (PlayerMobile)attacker;

				if (pm.DuelContext != null && !pm.DuelContext.CheckItemEquip(attacker, this))
				{
					canSwing = false;
				}
			}</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if (Evasion.IsEvading(defender))
				{
					chance *= Evasion.GetParryScalar(defender);
				}

				// Low dexterity lowers the chance.
				if (defender.Dex < 80)
				{
					chance = chance * (20 + defender.Dex) / 100;
				}</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if (Evasion.IsEvading(defender))
				{
					chance *= Evasion.GetParryScalar(defender);
				}

				// Low dexterity lowers the chance.
				if (defender.Dex < 80)
				{
					chance = chance * (20 + defender.Dex) / 100;
				}</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void OnAfterDelete()
        {
            base.OnAfterDelete();

            if (this.m_Item != null)
                this.m_Item.Delete();
            if (this.m_Item2 != null)
                this.m_Item2.Delete();
        }</pre>

Fragment 2 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void OnAfterDelete()
        {
            base.OnAfterDelete();

            if (this.m_Item != null)
                this.m_Item.Delete();
            if (this.m_Item2 != null)
                this.m_Item2.Delete();
        }</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\Titles.cs

<pre>if (mob.Female && skillTitle.EndsWith("man"))
                    skillTitle = skillTitle.Substring(0, skillTitle.Length - 3) + "woman";

                return String.Concat(skillLevel, " ", skillTitle);</pre>

Fragment 2 in file Scripts\Misc\Titles.cs

<pre>if (mob.Female && skillTitle.EndsWith("man"))
                skillTitle = skillTitle.Substring(0, skillTitle.Length - 3) + "woman";

            return String.Concat(skillLevel, " ", skillTitle);</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\BerserkAI.cs

<pre>{
                if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("I have detected {0}, attacking", this.m_Mobile.FocusMob.Name);

                this.m_Mobile.Combatant = this.m_Mobile.FocusMob;
                this.Action = ActionType.Combat;
            }</pre>

Fragment 2 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>{
                if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("I have detected {0}, attacking", this.m_Mobile.FocusMob.Name);

                this.m_Mobile.Combatant = this.m_Mobile.FocusMob;
                this.Action = ActionType.Combat;
            }</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Medusa.cs

<pre>{
                    perc = GetScaleEffectiveness(((BaseArmor)helm).GorgonLenseType);

                    if (perc > Utility.Random(100))
                    {
                        ((BaseArmor)helm).GorgonLenseCharges--;
                        deflect = true;
                    }
                }</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\Medusa.cs

<pre>{
                    perc = GetScaleEffectiveness(((BaseClothing)helm).GorgonLenseType);

                    if (perc > Utility.Random(100))
                    {
                        ((BaseClothing)helm).GorgonLenseCharges--;
                        deflect = true;
                    }
                }</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\PlayerMobile.cs

<pre>if (item is BaseArmor || item is BaseWeapon)
			{
				Hits = Hits;
				Stam = Stam;
				Mana = Mana;
			}

			if (NetState != null)
			{
				CheckLightLevels(false);
			}

			InvalidateMyRunUO();</pre>

Fragment 2 in file Scripts\Mobiles\PlayerMobile.cs

<pre>if (item is BaseArmor || item is BaseWeapon)
			{
				Hits = Hits;
				Stam = Stam;
				Mana = Mana;
			}

			if (NetState != null)
			{
				CheckLightLevels(false);
			}

			InvalidateMyRunUO();</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\ReadyUpGump.cs

<pre>BitArray opts = ruleset.Options;

                for (int i = 0; i < opts.Length; ++i)
                {
                    if (defs[i] != opts[i])
                        ++changes;
                }</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>BitArray opts = ruleset.Options;

                        for (int i = 0; i < opts.Length; ++i)
                        {
                            if (defs[i] != opts[i])
                                ++changes;
                        }</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Gumps\FactionStoneGump.cs

<pre>this.AddHtmlLocalized(55, 310, 100, 20, 1011447, false, false); // BACK
                this.AddButton(20, 310, 4005, 4007, 0, GumpButtonType.Page, 1);</pre>

Fragment 2 in file Scripts\Services\Factions\Gumps\FactionStoneGump.cs

<pre>this.AddHtmlLocalized(55, 310, 100, 20, 1011447, false, false); // BACK
                    this.AddButton(20, 310, 4005, 4007, 0, GumpButtonType.Page, 1);</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Gumps\FinanceGump.cs

<pre>this.AddHtmlLocalized(55, 360, 200, 25, 1011067, false, false); // Previous page
                this.AddButton(20, 360, 4005, 4007, 0, GumpButtonType.Page, 3);</pre>

Fragment 2 in file Scripts\Services\Factions\Gumps\SheriffGump.cs

<pre>this.AddHtmlLocalized(55, 360, 200, 25, 1011067, false, false); // Previous page
                this.AddButton(20, 360, 4005, 4007, 0, GumpButtonType.Page, 3);</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\FireCasino\DiceGames.cs

<pre>Dealer.PrivateOverheadMessage(MessageType.Regular, 0x35, 1153391, String.Format("{0}\t{1}\t{2}", Roll[0], Roll[1], Roll[2]), Player.NetState); // *rolls the dice; they land on ~1_FIRST~ ~2_SECOND~ ~3_THIRD~*</pre>

Fragment 2 in file Scripts\Services\FireCasino\DiceGames.cs

<pre>Dealer.PrivateOverheadMessage(MessageType.Regular, 0x35, 1153391, String.Format("{0}\t{1}\t{2}", Roll[0], Roll[1], Roll[2]), Player.NetState); // *rolls the dice; they land on ~1_FIRST~ ~2_SECOND~ ~3_THIRD~*</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlFire.cs

<pre>goto case 0;
				case 0:
					// version 0
					m_Damage = reader.ReadInt();
					Refractory = reader.ReadTimeSpan();
					TimeSpan remaining = reader.ReadTimeSpan();
					m_EndTime = DateTime.UtcNow + remaining;
					break;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlLightning.cs

<pre>goto case 0;
				case 0:
					// version 0
					m_Damage = reader.ReadInt();
					Refractory = reader.ReadTimeSpan();
					TimeSpan remaining = reader.ReadTimeSpan();
					m_EndTime = DateTime.UtcNow + remaining;
					break;</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>AddLabel( 220, 130, 0, String.Format(XmlPoints.GetText(from, 200508), viewpage+1, (int)(m_WorkingList.Count/PlayersPerPage)+1)); // "Page: {0}/{1}"</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>AddLabel( 220, 130, 0, String.Format(XmlPoints.GetText(from, 200508), viewpage+1, (int)(m_WorkingList.Count/PlayersPerPage)+1)); // "Page: {0}/{1}"</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>AddLabel( 220, 110, 0, String.Format(XmlPoints.GetText(from, 200508), viewpage+1, (int)(m_WorkingList.Count/PlayersPerPage)+1)); // "Page: {0}/{1}"</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>AddLabel( 220, 110, 0, String.Format(XmlPoints.GetText(from, 200508), viewpage+1, (int)(m_WorkingList.Count/PlayersPerPage)+1)); // "Page: {0}/{1}"</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCannon.cs

<pre>int z = ((AddonComponent)Components[1]).Location.Z;

				int[] itemid = null;
				int[] xoffset = null;
				int[] yoffset = null;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCatapult.cs

<pre>int z = ((AddonComponent)Components[1]).Location.Z;

				int[] itemid = null;
				int[] xoffset = null;
				int[] yoffset = null;</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Imbuing\Core\Imbuing.cs

<pre>ImbuingDefinition def = Imbuing.Table[mod];

            int Max = def.MaxIntensity;
            int Inc = def.IncAmount;

            if (item is BaseJewel && mod == 12)
                Max /= 2;</pre>

Fragment 2 in file Scripts\Skills\Imbuing\Core\Imbuing.cs

<pre>ImbuingDefinition def = Imbuing.Table[mod];

            int Max = def.MaxIntensity;
            int Inc = def.IncAmount;

            if (item is BaseJewel && mod == 12)
                Max /= 2;</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Base\SpellHelper.cs

<pre>if (target is BaseCreature && from != null && delay == TimeSpan.Zero)
            {
                BaseCreature c = (BaseCreature)target;

                c.OnHarmfulSpell(from);
                c.OnDamagedBySpell(from);
            }</pre>

Fragment 2 in file Scripts\Spells\Base\SpellHelper.cs

<pre>if (target is BaseCreature && from != null && delay == TimeSpan.Zero)
            {
                BaseCreature c = (BaseCreature)target;

                c.OnHarmfulSpell(from);
                c.OnDamagedBySpell(from);
            }</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Bushido\SamuraiSpell.cs

<pre>public static bool CheckExpansion(Mobile from)
        {
            if (!(from is PlayerMobile))
                return true;

            if (from.NetState == null)
                return false;

            return from.NetState.SupportsExpansion(Expansion.SE);
        }</pre>

Fragment 2 in file Scripts\Spells\Ninjitsu\NinjaSpell.cs

<pre>public static bool CheckExpansion(Mobile from)
        {
            if (!(from is PlayerMobile))
                return true;

            if (from.NetState == null)
                return false;

            return from.NetState.SupportsExpansion(Expansion.SE);
        }</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\GuildCandidatesGump.cs

<pre>this.AddButton(20, 400, 4005, 4007, 1, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(55, 400, 300, 35, 1011120, false, false); // Return to the main menu.</pre>

Fragment 2 in file Scripts\Gumps\Guilds\GuildRosterGump.cs

<pre>this.AddButton(20, 400, 4005, 4007, 1, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(55, 400, 300, 35, 1011120, false, false); // Return to the main menu.</pre>

Fragment 3 in file Scripts\Gumps\Guilds\GuildWarGump.cs

<pre>this.AddButton(20, 400, 4005, 4007, 1, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(55, 400, 300, 35, 1011120, false, false); // Return to the main menu.</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\ScrollBox.cs

<pre>private static void PlaceItemIn(Container parent, int x, int y, Item item) 
        { 
            parent.AddItem(item); 
            item.Location = new Point3D(x, y, 0); 
        }</pre>

Fragment 2 in file Scripts\Items\Containers\ScrollBox2.cs

<pre>private static void PlaceItemIn(Container parent, int x, int y, Item item) 
        { 
            parent.AddItem(item); 
            item.Location = new Point3D(x, y, 0); 
        }</pre>

Fragment 3 in file Scripts\Services\TestCenter.cs

<pre>private static void PlaceItemIn(Container parent, int x, int y, Item item)
        {
            parent.AddItem(item);
            item.Location = new Point3D(x, y, 0);
        }</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Medusa.cs

<pre>{
                    perc = GetScaleEffectiveness(((BaseArmor)neck).GorgonLenseType);

                    if (perc > Utility.Random(100))
                    {
                        ((BaseArmor)neck).GorgonLenseCharges--;
                        deflect = true;
                    }
                }</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\Medusa.cs

<pre>{
                    perc = GetScaleEffectiveness(((BaseJewel)neck).GorgonLenseType);

                    if (perc > Utility.Random(100))
                    {
                        ((BaseJewel)neck).GorgonLenseCharges--;
                        deflect = true;
                    }
                }</pre>

Fragment 3 in file Scripts\Mobiles\Bosses\Medusa.cs

<pre>{
                    perc = GetScaleEffectiveness(((BaseClothing)neck).GorgonLenseType);

                    if (perc > Utility.Random(100))
                    {
                        ((BaseClothing)neck).GorgonLenseCharges--;
                        deflect = true;
                    }
                }</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Gumps\FinanceGump.cs

<pre>this.AddHtmlLocalized(55, 360, 200, 25, 1011067, false, false); // Previous page
            this.AddButton(20, 360, 4005, 4007, 0, GumpButtonType.Page, 1);</pre>

Fragment 2 in file Scripts\Services\Factions\Gumps\FinanceGump.cs

<pre>this.AddHtmlLocalized(55, 360, 200, 25, 1011067, false, false);	//	Previous page
            this.AddButton(20, 360, 4005, 4007, 0, GumpButtonType.Page, 1);</pre>

Fragment 3 in file Scripts\Services\Factions\Gumps\SheriffGump.cs

<pre>this.AddHtmlLocalized(55, 360, 200, 25, 1011067, false, false); // Previous page
            this.AddButton(20, 360, 4005, 4007, 0, GumpButtonType.Page, 1);</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\HarvestMap.cs

<pre>ShowUsesRemaining = true;

            Expires = DateTime.UtcNow + TimeSpan.FromHours(DecayPeriod);
            m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), CheckDecay);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\SmeltersTalisman.cs

<pre>ShowUsesRemaining = true;

            Expires = DateTime.UtcNow + TimeSpan.FromHours(DecayPeriod);
            m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), CheckDecay);</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\WoodsmanTalisman.cs

<pre>ShowUsesRemaining = true;

            Expires = DateTime.UtcNow + TimeSpan.FromHours(DecayPeriod);
            m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), CheckDecay);</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\SimpleSwitches.cs

<pre>if (from == null || Disabled) return;

			if (!from.InRange(GetWorldLocation(), 2) || !from.InLOS(this))
			{
				from.SendLocalizedMessage(500446); // That is too far away.
				return;
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\SimpleSwitches.cs

<pre>if (from == null || Disabled) return;

			if (!from.InRange(GetWorldLocation(), 2) || !from.InLOS(this))
			{
				from.SendLocalizedMessage(500446); // That is too far away.
				return;
			}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\SingleUseSwitch.cs

<pre>if (from == null || Disabled) return;

			if (!from.InRange(GetWorldLocation(), 2) || !from.InLOS(this))
			{
				from.SendLocalizedMessage(500446); // That is too far away.
				return;
			}</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>if(from == null || Disabled) return;

			if ( !from.InRange( GetWorldLocation(), 2 ) || !from.InLOS(this))
			{
				from.SendLocalizedMessage( 500446 ); // That is too far away.
				return;
			}</pre>

## Duplicated Code. Size: 79

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\GrantGuildTitleGump.cs

<pre>this.AddButton(300, 400, 4005, 4007, 2, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(335, 400, 100, 35, 1011012, false, false); // CANCEL</pre>

Fragment 2 in file Scripts\Gumps\Guilds\GuildAcceptWarGump.cs

<pre>this.AddButton(300, 400, 4005, 4007, 2, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(335, 400, 100, 35, 1011012, false, false); // CANCEL</pre>

Fragment 3 in file Scripts\Gumps\Guilds\GuildDeclarePeaceGump.cs

<pre>this.AddButton(300, 400, 4005, 4007, 2, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(335, 400, 100, 35, 1011012, false, false); // CANCEL</pre>

Fragment 4 in file Scripts\Gumps\Guilds\GuildDeclareWarGump.cs

<pre>this.AddButton(300, 400, 4005, 4007, 2, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(335, 400, 100, 35, 1011012, false, false); // CANCEL</pre>

Fragment 5 in file Scripts\Gumps\Guilds\GuildDismissGump.cs

<pre>this.AddButton(300, 400, 4005, 4007, 2, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(335, 400, 100, 35, 1011012, false, false); // CANCEL</pre>

Fragment 6 in file Scripts\Gumps\Guilds\GuildRejectWarGump.cs

<pre>this.AddButton(300, 400, 4005, 4007, 2, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(335, 400, 100, 35, 1011012, false, false); // CANCEL</pre>

Fragment 7 in file Scripts\Gumps\Guilds\GuildRescindDeclarationGump.cs

<pre>this.AddButton(300, 400, 4005, 4007, 2, GumpButtonType.Reply, 0);
            this.AddHtmlLocalized(335, 400, 100, 35, 1011012, false, false); // CANCEL</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\MiniHouses.cs

<pre>base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_Type = (MiniHouseType)reader.ReadInt();
                        break;
                    }
            }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\Shadowlord.cs

<pre>base.Deserialize(reader);
            int version = reader.ReadInt();

            switch (version)
            {
                case 0:
                    {
                        this.m_Type = (ShadowlordType)reader.ReadInt();

                        break;
                    }
            }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\Food.cs

<pre>public override void AddNameProperty(ObjectPropertyList list)
		{
			base.AddNameProperty(list);

			if (!String.IsNullOrEmpty(this.EngravedText))
			{
				list.Add(1072305, this.EngravedText); // Engraved: ~1_INSCRIPTION~
			}
		}</pre>

Fragment 2 in file Scripts\Items\Containers\Container.cs

<pre>public override void AddNameProperty(ObjectPropertyList list)
		{
			base.AddNameProperty(list);

			if(!String.IsNullOrEmpty(this.EngravedText))
			{
				list.Add(1072305, this.EngravedText); // Engraved: ~1_INSCRIPTION~
			}
		}</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>m_ReforgedPrefix = (ReforgedPrefix)reader.ReadInt();
                        m_ReforgedSuffix = (ReforgedSuffix)reader.ReadInt();
                        m_ItemPower = (ItemPower)reader.ReadInt();
                        m_BlockRepair = reader.ReadBool();</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>m_ReforgedPrefix = (ReforgedPrefix)reader.ReadInt();
                        m_ReforgedSuffix = (ReforgedSuffix)reader.ReadInt();
                        m_ItemPower = (ItemPower)reader.ReadInt();
                        m_BlockRepair = reader.ReadBool();</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\FireworksWand.cs

<pre>Effects.SendMovingEffect(new Entity(Serial.Zero, startLoc, map), new Entity(Serial.Zero, endLoc, map),
                0x36E4, 5, 0, false, false);</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\Items\VvVAltar.cs

<pre>Effects.SendMovingEffect(new Entity(Serial.Zero, startLoc, map), new Entity(Serial.Zero, endLoc, map),
                0x36E4, 5, 0, false, false);</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DemonKnight.cs

<pre>Region r = m.Region;

            if (r.IsPartOf(typeof(Server.Regions.HouseRegion)) || Server.Multis.BaseBoat.FindBoatAt(m, m.Map) != null)
                return false;</pre>

Fragment 2 in file Scripts\Services\TreasuresOfTokuno\TreasuresOfTokuno.cs

<pre>Region r = m.Region;

            if (r.IsPartOf(typeof(Server.Regions.HouseRegion)) || Server.Multis.BaseBoat.FindBoatAt(m, m.Map) != null)
                return false;</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DemonKnight.cs

<pre>public override WeaponAbility GetWeaponAbility()
        {
            switch ( Utility.Random(3) )
            {
                default:
                case 0:
                    return WeaponAbility.DoubleStrike;
                case 1:
                    return WeaponAbility.WhirlwindAttack;
                case 2:
                    return WeaponAbility.CrushingBlow;
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Void Creatures\UsagralemBallem.cs

<pre>public override WeaponAbility GetWeaponAbility()
        {
            switch ( Utility.Random(3) )
            {
                default:
                case 0:
                    return WeaponAbility.DoubleStrike;
                case 1:
                    return WeaponAbility.WhirlwindAttack;
                case 2:
                    return WeaponAbility.CrushingBlow;
            }
        }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GreaterPoisonElemental.cs

<pre>this.Fame = 12500;
            this.Karma = -12500;

            this.VirtualArmor = 70;

            this.PackItem(new Nightshade(4));
            this.PackItem(new LesserPoisonPotion());</pre>

Fragment 2 in file Scripts\Mobiles\Normal\PoisonElemental.cs

<pre>this.Fame = 12500;
            this.Karma = -12500;

            this.VirtualArmor = 70;

            this.PackItem(new Nightshade(4));
            this.PackItem(new LesserPoisonPotion());</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\BaseHealer.cs

<pre>if (!this.IsInvulnerable)
            {
                this.AI = AIType.AI_Mage;
                this.ActiveSpeed = 0.2;
                this.PassiveSpeed = 0.8;
                this.RangePerception = BaseCreature.DefaultRangePerception;
                this.FightMode = FightMode.Aggressor;
            }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\BaseHealer.cs

<pre>if (!this.IsInvulnerable)
            {
                this.AI = AIType.AI_Mage;
                this.ActiveSpeed = 0.2;
                this.PassiveSpeed = 0.8;
                this.RangePerception = BaseCreature.DefaultRangePerception;
                this.FightMode = FightMode.Aggressor;
            }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\BaseVendor.cs

<pre>for (int i = 0; i < Items.Count; ++i)
			{
				Item item = Items[i];

				if (item is BaseClothing)
				{
					item.Delete();
				}
			}</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\BaseVendor.cs

<pre>for (int i = 0; i < Items.Count; ++i)
			{
				Item item = Items[i];

				if (item is BaseClothing)
				{
					item.Delete();
				}
			}</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\TownCrier.cs

<pre>if (this.m_Entries == null)
                this.m_Entries = new List<TownCrierEntry>();

            TownCrierEntry tce = new TownCrierEntry(lines, duration);

            this.m_Entries.Add(tce);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\TownCrier.cs

<pre>if (this.m_Entries == null)
                this.m_Entries = new List<TownCrierEntry>();

            TownCrierEntry tce = new TownCrierEntry(lines, duration);

            this.m_Entries.Add(tce);</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\TownCrier.cs

<pre>this.m_NewsTimer = Timer.DelayCall(TimeSpan.FromSeconds(1.0), TimeSpan.FromSeconds(3.0), new TimerStateCallback(ShoutNews_Callback), new object[] { tce, 0 });</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\TownCrier.cs

<pre>this.m_NewsTimer = Timer.DelayCall(TimeSpan.FromSeconds(1.0), TimeSpan.FromSeconds(3.0), new TimerStateCallback(ShoutNews_Callback), new object[] { tce, 0 });</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\BaseHouse.cs

<pre>if (m == null)
                return false;

            if (m.IsStaff() || this.IsFriend(m) || (this.m_Access != null && this.m_Access.Contains(m)))
                return true;</pre>

Fragment 2 in file Scripts\Multis\BaseHouse.cs

<pre>if (m == null)
                        return false;

                    if (m.IsStaff() || this.IsFriend(m) || (this.m_Access != null && this.m_Access.Contains(m)))
                        return true;</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\18th Anniversary\EnchantedTimepiece.cs

<pre>int hour, min;

            Clock.GetTime(this.Map, GetWorldLocation().X, GetWorldLocation().Y, out hour, out min);

            if (hour > 12)
                hour -= 12;</pre>

Fragment 2 in file Scripts\Services\18th Anniversary\EnchantedTimepiece.cs

<pre>int hour, min;

                Clock.GetTime(this.Map, GetWorldLocation().X, GetWorldLocation().Y, out hour, out min);

                if (hour > 12)
                    hour -= 12;</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\LargeBODGump.cs

<pre>this.AddHtmlLocalized(75, 48, 250, 20, 1045138, 0x7FFF, false, false); // Amount to make:
            this.AddLabel(275, 48, 1152, deed.AmountMax.ToString());</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallBODGump.cs

<pre>this.AddHtmlLocalized(75, 48, 250, 20, 1045138, 0x7FFF, false, false); // Amount to make:
            this.AddLabel(275, 48, 1152, deed.AmountMax.ToString());</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>AddHtmlLocalized(130, 40, 170, 20, 1153908, 0xFFFF, false, false); // Name
            AddHtmlLocalized(300, 40, 170, 20, 1153909, 0xFFFF, false, false); // Guild</pre>

Fragment 2 in file Scripts\Services\City Loyalty System\Gumps.cs

<pre>AddHtmlLocalized(130, 40, 170, 20, 1153908, 0xFFFF, false, false); // Name
            AddHtmlLocalized(300, 40, 170, 20, 1153909, 0xFFFF, false, false); // Guild</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Mobiles\CityHerald.cs

<pre>City = city;
            SpeechHue = 0x3B2;
            Female = Utility.RandomDouble() > 0.75;
            Blessed = true;

            Name = Female ? NameList.RandomName("female") : NameList.RandomName("male");</pre>

Fragment 2 in file Scripts\Services\City Loyalty System\Trading\Mobiles\TradeMinister.cs

<pre>City = city;
            SpeechHue = 0x3B2;
            Female = Utility.RandomDouble() > 0.75;
            Blessed = true;

            Name = Female ? NameList.RandomName("female") : NameList.RandomName("male");</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\BaseCollectionItem.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public long CurrentTier
        {
            get
            {
                if (this.m_Tier > 1)
                    return this.PreviousTier + (this.m_Tier + 1) * this.m_NextTier;

                return this.m_StartTier + this.m_StartTier * this.m_Tier;
            }
        }</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\BaseCollectionMobile.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public long CurrentTier
        {
            get
            {
                if (this.m_Tier > 1)
                    return this.PreviousTier + (this.m_Tier + 1) * this.m_NextTier;

                return this.m_StartTier + this.m_StartTier * this.m_Tier;
            }
        }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\MerchantCrew.cs

<pre>AddItem(new TricorneHat());
            AddItem(new FancyShirt());
            AddItem(new ShortPants());
            AddItem(new Boots(Utility.RandomNeutralHue()));</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Mobiles.cs

<pre>AddItem( new Boots( Utility.RandomNeutralHue() ) );
            AddItem( new ShortPants() );
			AddItem( new FancyShirt());
			AddItem( new TricorneHat());</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Items\Sigil.cs

<pre>private Mobile FindOwner(object parent)
        {
            if (parent is Item)
                return ((Item)parent).RootParent as Mobile;

            if (parent is Mobile)
                return (Mobile)parent;

            return null;
        }</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\Items\VvVSigil.cs

<pre>private Mobile FindOwner(object parent)
        {
            if (parent is Item)
                return ((Item)parent).RootParent as Mobile;

            if (parent is Mobile)
                return (Mobile)parent;

            return null;
        }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Loot\ClockworkLeggings.cs

<pre>{
            this.Hue = 0xA91;
            this.Attributes.RegenStam = 5;
            this.Attributes.DefendChance = 25;
            this.Attributes.BonusDex = 5;
            this.StrRequirement = 90;
            this.Weight = 7;
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Loot\GargishClockworkLeggings.cs

<pre>{
            this.Hue = 0xA91;
            this.Attributes.RegenStam = 5;
            this.Attributes.DefendChance = 25;
            this.Attributes.BonusDex = 5;
            this.StrRequirement = 90;
            this.Weight = 7;
        }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Vendor Searching\VendorSearchGump.cs

<pre>AddItem(90 - bounds.Width / 2 - bounds.X, (30 - bounds.Height / 2 - bounds.Y) + y, item.Item.ItemID, item.Item.Hue);</pre>

Fragment 2 in file Scripts\Services\Vendor Searching\VendorSearchGump.cs

<pre>AddItem(90 - bounds.Width / 2 - bounds.X, (30 - bounds.Height / 2 - bounds.Y) + y, item.Item.ItemID, item.Item.Hue);</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>string filePath = Path.Combine("Saves/Attachments", "Attachments.bin");        // the attachment serializations
			string imaPath = Path.Combine("Saves/Attachments", "Attachments.ima");         // the item/mob attachment tables
			string fpiPath = Path.Combine("Saves/Attachments", "Attachments.fpi");        // the file position indices</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>string filePath = Path.Combine("Saves/Attachments", "Attachments.bin");    // the attachment serializations
			string imaPath = Path.Combine("Saves/Attachments", "Attachments.ima");     // the item/mob attachment tables
			string fpiPath = Path.Combine("Saves/Attachments", "Attachments.fpi");     // the file position indices</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>attachments.Keys.CopyTo(keyarray, 0);
			for(int i=keyarray.Length - 1; i>=0; --i)
				Defrag(attachments, keyarray[i]);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>attachments.Keys.CopyTo(keyarray, 0);
			for(int i=keyarray.Length - 1; i>=0; --i)
				Defrag(attachments, keyarray[i]);</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>newentry.PrePause = reader.ReadInt();
                                newentry.LockConversation = reader.ReadBool();
                                newentry.AllowNPCTrigger = reader.ReadBool();
                                newentry.SpeechStyle = (MessageType)reader.ReadInt();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>newentry.PrePause = reader.ReadInt();
                                newentry.LockConversation = reader.ReadBool();
                                newentry.AllowNPCTrigger = reader.ReadBool();
                                newentry.SpeechStyle = (MessageType)reader.ReadInt();</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlItems\TimedSwitches.cs

<pre>int minSeconds = (int)m_MinDelay.TotalSeconds;
			int maxSeconds = (int)m_MaxDelay.TotalSeconds;

			TimeSpan delay = TimeSpan.FromSeconds( Utility.RandomMinMax( minSeconds, maxSeconds ) );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>int minSeconds = (int)m_MinDelay.TotalSeconds;
			int maxSeconds = (int)m_MaxDelay.TotalSeconds;

			TimeSpan delay = TimeSpan.FromSeconds(Utility.RandomMinMax(minSeconds, maxSeconds));</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>object parentOfTarget = ((Container)target).Parent;

				// if this is a QuestBook then allow additions if it is in a players pack or it is a player quest
				if ((parentOfTarget != null) && parentOfTarget is Container && target is XmlQuestBook)
				{
					parentOfTarget = ((Container)parentOfTarget).Parent;
				}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>object parentOfTarget = ((Container)target).Parent;

                // if this is a QuestBook then allow additions if it is in a players pack or it is a player quest
                if ((parentOfTarget != null) && parentOfTarget is Container && target is XmlQuestBook)
                {
                    parentOfTarget = ((Container)parentOfTarget).Parent;
                }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomAttacks.cs

<pre>{
                        if(s.IconType == IconTypes.ItemID)
                        {
                            AddItem( 5, y, s.Icon, 33 );
                        } else
                        {
                            AddImage( 5, y, s.Icon, 33 );
                        }
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomDefenses.cs

<pre>{
                        if(s.IconType == IconTypes.ItemID)
                        {
                            AddItem( 5, y, s.Icon, 33 );
                        } else
                        {
                            AddImage( 5, y, s.Icon, 33 );
                        }
                    }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Bushido\Confidence.cs

<pre>Timer t = (Timer)m_Table[m];

            if (t != null)
                t.Stop();

            t = new InternalTimer(m);

            m_Table[m] = t;</pre>

Fragment 2 in file Scripts\Spells\Bushido\CounterAttack.cs

<pre>Timer t = (Timer)m_Table[m];

            if (t != null)
                t.Stop();

            t = new InternalTimer(m);

            m_Table[m] = t;</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Ninjitsu\Backstab.cs

<pre>public override bool Validate(Mobile from)
        {
            if (!from.Hidden || from.AllowedStealthSteps <= 0)
            {
                from.SendLocalizedMessage(1063087); // You must be in stealth mode to use this ability.
                return false;
            }

            return base.Validate(from);
        }</pre>

Fragment 2 in file Scripts\Spells\Ninjitsu\SurpriseAttack.cs

<pre>public override bool Validate(Mobile from)
        {
            if (!from.Hidden || from.AllowedStealthSteps <= 0)
            {
                from.SendLocalizedMessage(1063087); // You must be in stealth mode to use this ability.
                return false;
            }

            return base.Validate(from);
        }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>{
            if (m_Parent is Item)
            {
                ((Item)m_Parent).OnSubItemAdded(item);
            }
            else if (m_Parent is Mobile)
            {
                ((Mobile)m_Parent).OnSubItemAdded(item);
            }
        }</pre>

Fragment 2 in file Server\Item.cs

<pre>{
            if (m_Parent is Item)
            {
                ((Item)m_Parent).OnSubItemAdded(item);
            }
            else if (m_Parent is Mobile)
            {
                ((Mobile)m_Parent).OnSubItemAdded(item);
            }
        }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>{
            if (m_Parent is Item)
            {
                ((Item)m_Parent).OnSubItemRemoved(item);
            }
            else if (m_Parent is Mobile)
            {
                ((Mobile)m_Parent).OnSubItemRemoved(item);
            }
        }</pre>

Fragment 2 in file Server\Item.cs

<pre>{
            if (m_Parent is Item)
            {
                ((Item)m_Parent).OnSubItemRemoved(item);
            }
            else if (m_Parent is Mobile)
            {
                ((Mobile)m_Parent).OnSubItemRemoved(item);
            }
        }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>{
            if (m_Parent is Item)
            {
                ((Item)m_Parent).OnSubItemBounceCleared(item);
            }
            else if (m_Parent is Mobile)
            {
                ((Mobile)m_Parent).OnSubItemBounceCleared(item);
            }
        }</pre>

Fragment 2 in file Server\Item.cs

<pre>{
            if (m_Parent is Item)
            {
                ((Item)m_Parent).OnSubItemBounceCleared(item);
            }
            else if (m_Parent is Mobile)
            {
                ((Mobile)m_Parent).OnSubItemBounceCleared(item);
            }
        }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>{
				if (CanRegenHits)
				{
					if (m_HitsTimer == null)
					{
						m_HitsTimer = new HitsTimer(this);
					}

					m_HitsTimer.Start();
				}
				else if (m_HitsTimer != null)
				{
					m_HitsTimer.Stop();
				}
			}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>{
					if (CanRegenHits)
					{
						if (m_HitsTimer == null)
						{
							m_HitsTimer = new HitsTimer(this);
						}

						m_HitsTimer.Start();
					}
					else if (m_HitsTimer != null)
					{
						m_HitsTimer.Stop();
					}
				}</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>{
				if (CanRegenStam)
				{
					if (m_StamTimer == null)
					{
						m_StamTimer = new StamTimer(this);
					}

					m_StamTimer.Start();
				}
				else if (m_StamTimer != null)
				{
					m_StamTimer.Stop();
				}
			}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>{
					if (CanRegenStam)
					{
						if (m_StamTimer == null)
						{
							m_StamTimer = new StamTimer(this);
						}

						m_StamTimer.Start();
					}
					else if (m_StamTimer != null)
					{
						m_StamTimer.Stop();
					}
				}</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>{
				if (CanRegenMana)
				{
					if (m_ManaTimer == null)
					{
						m_ManaTimer = new ManaTimer(this);
					}

					m_ManaTimer.Start();
				}
				else if (m_ManaTimer != null)
				{
					m_ManaTimer.Stop();
				}
			}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>{
					if (CanRegenMana)
					{
						if (m_ManaTimer == null)
						{
							m_ManaTimer = new ManaTimer(this);
						}

						m_ManaTimer.Start();
					}
					else if (m_ManaTimer != null)
					{
						m_ManaTimer.Stop();
					}
				}</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Server\TileMatrixPatch.cs

<pre>int blockID = indexReader.ReadInt32();
						int x = blockID / matrix.BlockHeight;
						int y = blockID % matrix.BlockHeight;

						fsData.Seek(4, SeekOrigin.Current);</pre>

Fragment 2 in file Ultima\TileMatrixPatch.cs

<pre>int blockID = indexReader.ReadInt32();
						int x = blockID / matrix.BlockHeight;
						int y = blockID % matrix.BlockHeight;

						fsData.Seek(4, SeekOrigin.Current);</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Ultima\Client.cs

<pre>pc.Seek(0x400000 + (i * chunkSize), SeekOrigin.Begin);
				int count = pc.Read(read, 0, readSize);

				if (count != readSize)
				{
					break;
				}</pre>

Fragment 2 in file Ultima\Client.cs

<pre>pc.Seek(0x400000 + (i * chunkSize), SeekOrigin.Begin);
				int count = pc.Read(read, 0, readSize);

				if (count != readSize)
				{
					break;
				}</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Consumables\DeliciouslyTastyTreat.cs

<pre>if ((creature.Controlled || creature.Summoned) && (from == creature.ControlMaster) && (creature.Asleep))
                    {
                        from.SendLocalizedMessage(502676);
                    }
                    else
                    {
                        from.SendLocalizedMessage(1113049);
                    }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Consumables\TastyTreat.cs

<pre>if ((creature.Controlled || creature.Summoned) && (from == creature.ControlMaster) && (creature.Asleep))
                    {
                        from.SendLocalizedMessage(502676);
                    }
                    else
                    {
                        from.SendLocalizedMessage(1113049);
                    }</pre>

Fragment 3 in file Scripts\Quests\IrresistiblyTastyTreat.cs

<pre>if ((creature.Controlled || creature.Summoned) && (from == creature.ControlMaster) && (creature.Asleep))
                        {
                            from.SendLocalizedMessage(502676);
                        }
                        else 
                        {
                            from.SendLocalizedMessage(1113049);
                        }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\BaseBoard.cs

<pre>for (int i = this.Items.Count - 1; i >= 0; --i)
            {
                if (i < this.Items.Count)
                    this.Items[i].Delete();
            }</pre>

Fragment 2 in file Scripts\Items\Containers\FillableContainers.cs

<pre>for (int i = this.Items.Count - 1; i >= 0; --i)
                {
                    if (i < this.Items.Count)
                        this.Items[i].Delete();
                }</pre>

Fragment 3 in file Scripts\Services\ExploringTheDeep\Items\QuestItems\StorageLocker.cs

<pre>for (int i = this.Items.Count - 1; i >= 0; --i)
            {
                if (i < this.Items.Count)
                    this.Items[i].Delete();
            }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BullFrog.cs

<pre>this.SetMana(0);

            this.SetDamage(1, 2);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 5, 10);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Rat.cs

<pre>this.SetMana(0);

            this.SetDamage(1, 2);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 5, 10);</pre>

Fragment 3 in file Scripts\Mobiles\Normal\Sheep.cs

<pre>this.SetMana(0);

            this.SetDamage(1, 2);

            this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 5, 10);</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\ArenaGump.cs

<pre>private void AddBorderedText(int x, int y, int width, string text, int color, int borderColor)
        {
            /*AddColoredText( x - 1, y, width, text, borderColor );
            AddColoredText( x + 1, y, width, text, borderColor );
            AddColoredText( x, y - 1, width, text, borderColor );
            AddColoredText( x, y + 1, width, text, borderColor );*/
            /*AddColoredText( x - 1, y - 1, width, text, borderColor );
            AddColoredText( x + 1, y + 1, width, text, borderColor );*/
            this.AddColoredText(x, y, width, text, color);
        }</pre>

Fragment 2 in file Scripts\Services\ConPVP\LadderGump.cs

<pre>private void AddBorderedText(int x, int y, int width, string text, int color, int borderColor)
        {
            /*AddColoredText( x - 1, y, width, text, borderColor );
            AddColoredText( x + 1, y, width, text, borderColor );
            AddColoredText( x, y - 1, width, text, borderColor );
            AddColoredText( x, y + 1, width, text, borderColor );*/
            /*AddColoredText( x - 1, y - 1, width, text, borderColor );
            AddColoredText( x + 1, y + 1, width, text, borderColor );*/
            this.AddColoredText(x, y, width, text, color);
        }</pre>

Fragment 3 in file Scripts\Services\ConPVP\Preferences.cs

<pre>private void AddBorderedText(int x, int y, int width, string text, int color, int borderColor)
        {
            /*AddColoredText( x - 1, y, width, text, borderColor );
            AddColoredText( x + 1, y, width, text, borderColor );
            AddColoredText( x, y - 1, width, text, borderColor );
            AddColoredText( x, y + 1, width, text, borderColor );*/
            /*AddColoredText( x - 1, y - 1, width, text, borderColor );
            AddColoredText( x + 1, y + 1, width, text, borderColor );*/
            this.AddColoredText(x, y, width, text, color);
        }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlMagicWord.cs

<pre>base.OnSpeech(e);

			if(e.Mobile == null || e.Mobile.AccessLevel > AccessLevel.Player) return;

			// dont respond to other players speech if this is attached to a mob
			if(AttachedTo is Mobile && (Mobile)AttachedTo != e.Mobile) return;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlMorph.cs

<pre>base.OnSpeech(e);

			if(e.Mobile == null || e.Mobile.AccessLevel > AccessLevel.Player) return;

			// dont respond to other players speech if this is attached to a mob
			if(AttachedTo is Mobile && (Mobile)AttachedTo != e.Mobile) return;</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlSkill.cs

<pre>base.OnSpeech(e);

			if(e.Mobile == null || e.Mobile.AccessLevel > AccessLevel.Player) return;

			// dont respond to other players speech if this is attached to a mob
			if(AttachedTo is Mobile && (Mobile)AttachedTo != e.Mobile) return;</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\Extensions.cs

<pre>int x = Utility.RandomMinMax(rec.X, rec.X + rec.Width);
            int y = Utility.RandomMinMax(rec.Y, rec.Y + rec.Height);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Regions\SeaMarket.cs

<pre>int x = Utility.RandomMinMax(rec.X, rec.X + rec.Width);
                int y = Utility.RandomMinMax(rec.Y, rec.Y + rec.Height);</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Encounters.cs

<pre>int x = Utility.RandomMinMax(rec.X, rec.X + rec.Width);
			int y = Utility.RandomMinMax(rec.Y, rec.Y + rec.Height);</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\DespiseRevamped\DespiseController.cs

<pre>int x = Utility.RandomMinMax(rec.X, rec.X + rec.Width);
                int y = Utility.RandomMinMax(rec.Y, rec.Y + rec.Height);</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Aliabeth.cs

<pre>{
            this.SetSkill(SkillName.Lockpicking, 60.0, 83.0);
            this.SetSkill(SkillName.RemoveTrap, 75.0, 98.0);
            this.SetSkill(SkillName.Tinkering, 64.0, 100.0);
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\GolemCrafter.cs

<pre>{
            this.SetSkill(SkillName.Lockpicking, 60.0, 83.0);
            this.SetSkill(SkillName.RemoveTrap, 75.0, 98.0);
            this.SetSkill(SkillName.Tinkering, 64.0, 100.0);
        }</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\Tinker.cs

<pre>{
            this.SetSkill(SkillName.Lockpicking, 60.0, 83.0);
            this.SetSkill(SkillName.RemoveTrap, 75.0, 98.0);
            this.SetSkill(SkillName.Tinkering, 64.0, 100.0);
        }</pre>

Fragment 4 in file Scripts\Services\BasketWeaving\SATinker.cs

<pre>{
            this.SetSkill(SkillName.Lockpicking, 60.0, 83.0);
            this.SetSkill(SkillName.RemoveTrap, 75.0, 98.0);
            this.SetSkill(SkillName.Tinkering, 64.0, 100.0);
        }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>AddHtmlLocalized(195, 5, 150, 18, 1150385, RedColor16, false, false);     // New Magincia Bazaar
			AddHtmlLocalized(217, 40, 150, 18, 1150386, RedColor16, false, false);    // Stall Leasing</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>AddHtmlLocalized(195, 5, 150, 18, 1150385, RedColor16, false, false);     // New Magincia Bazaar
            AddHtmlLocalized(217, 40, 150, 18, 1150386, RedColor16, false, false);    // Stall Leasing</pre>

Fragment 3 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>AddHtmlLocalized(195, 5, 150, 18, 1150385, RedColor16, false, false);     // New Magincia Bazaar
			AddHtmlLocalized(217, 40, 150, 18, 1150386, RedColor16, false, false);    // Stall Leasing</pre>

Fragment 4 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>AddHtmlLocalized(195, 5, 150, 18, 1150385, RedColor16, false, false);     // New Magincia Bazaar
            AddHtmlLocalized(217, 40, 150, 18, 1150386, RedColor16, false, false);    // Stall Leasing</pre>

Fragment 5 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>AddHtmlLocalized(195, 5, 150, 18, 1150385, RedColor16, false, false);     // New Magincia Bazaar
            AddHtmlLocalized(217, 40, 150, 18, 1150386, RedColor16, false, false);    // Stall Leasing</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\TitlesMenu.cs

<pre>AddHtmlLocalized(225, 275, 200, 16, 1115035, 0xFFFF, false, false); // Do you wish to apply this title?

                    AddHtmlLocalized(480, 275, 80, 16, 1011046, 0xFFFF, false, false); // APPLY</pre>

Fragment 2 in file Scripts\Gumps\TitlesMenu.cs

<pre>AddHtmlLocalized(225, 275, 200, 16, 1115035, 0xFFFF, false, false); // Do you wish to apply this title?

                    AddHtmlLocalized(480, 275, 80, 16, 1011046, 0xFFFF, false, false); // APPLY</pre>

Fragment 3 in file Scripts\Gumps\TitlesMenu.cs

<pre>AddHtmlLocalized(225, 275, 200, 16, 1115035, 0xFFFF, false, false); // Do you wish to apply this title?

                    AddHtmlLocalized(480, 275, 80, 16, 1011046, 0xFFFF, false, false); // APPLY</pre>

Fragment 4 in file Scripts\Gumps\TitlesMenu.cs

<pre>AddHtmlLocalized(225, 275, 200, 16, 1115035, 0xFFFF, false, false); // Do you wish to apply this title?

                    AddHtmlLocalized(480, 275, 80, 16, 1011046, 0xFFFF, false, false); // APPLY</pre>

Fragment 5 in file Scripts\Gumps\TitlesMenu.cs

<pre>AddHtmlLocalized(225, 275, 200, 16, 1115035, 0xFFFF, false, false); // Do you wish to apply this title?

                    AddHtmlLocalized(480, 275, 80, 16, 1011046, 0xFFFF, false, false); // APPLY</pre>

Fragment 6 in file Scripts\Gumps\TitlesMenu.cs

<pre>AddHtmlLocalized(225, 275, 200, 16, 1115035, 0xFFFF, false, false); // Do you wish to apply this title?

                    AddHtmlLocalized(480, 275, 80, 16, 1011046, 0xFFFF, false, false); // APPLY</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GiantSerpent.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.BaseSoundID == -1)
                this.BaseSoundID = 219;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GiantSerpent.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.BaseSoundID == -1)
                this.BaseSoundID = 219;
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\GiantSerpent.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.BaseSoundID == -1)
                this.BaseSoundID = 219;
        }</pre>

Fragment 4 in file Scripts\Mobiles\Normal\GiantSerpent.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.BaseSoundID == -1)
                this.BaseSoundID = 219;
        }</pre>

Fragment 5 in file Scripts\Mobiles\Normal\GiantSerpent.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.BaseSoundID == -1)
                this.BaseSoundID = 219;
        }</pre>

Fragment 6 in file Scripts\Mobiles\Normal\IceSerpent.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.BaseSoundID == -1)
                this.BaseSoundID = 219;
        }</pre>

Fragment 7 in file Scripts\Mobiles\Normal\SilverSerpent.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.BaseSoundID == -1)
                this.BaseSoundID = 219;
        }</pre>

## Duplicated Code. Size: 78

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Reports\Objects\Charts\ChartItemCollection.cs

<pre>get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }</pre>

Fragment 2 in file Scripts\Services\Reports\Objects\Reports\ItemValueCollection.cs

<pre>get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }</pre>

Fragment 3 in file Scripts\Services\Reports\Objects\Reports\ReportColumnCollection.cs

<pre>get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }</pre>

Fragment 4 in file Scripts\Services\Reports\Objects\Reports\ReportItemCollection.cs

<pre>get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }</pre>

Fragment 5 in file Scripts\Services\Reports\Objects\Snapshots\SnapshotCollection.cs

<pre>get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }</pre>

Fragment 6 in file Scripts\Services\Reports\Objects\Staffing\PageInfoCollection.cs

<pre>get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }</pre>

Fragment 7 in file Scripts\Services\Reports\Objects\Staffing\QueueStatusCollection.cs

<pre>get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }</pre>

Fragment 8 in file Scripts\Services\Reports\Objects\Staffing\ResponseInfoCollection.cs

<pre>get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }</pre>

Fragment 9 in file Scripts\Services\Reports\Persistence\PersistableObjectCollection.cs

<pre>get
                {
                    if (((this._index == -1) ||
                         (this._index >= this._collection.Count)))
                    {
                        throw new System.IndexOutOfRangeException("Enumerator not started.");
                    }
                    else
                    {
                        return this._currentElement;
                    }
                }</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DoorGenDelete.cs

<pre>private static readonly Rectangle2D[] m_IlshRegions = new Rectangle2D[]
        {
            new Rectangle2D(new Point2D(0, 0), new Point2D(288 * 8, 200 * 8))
        };</pre>

Fragment 2 in file Scripts\Commands\DoorGenerator.cs

<pre>private static readonly Rectangle2D[] m_IlshRegions = new Rectangle2D[]
        {
            new Rectangle2D(new Point2D(0, 0), new Point2D(288 * 8, 200 * 8))
        };</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\DoorGenDelete.cs

<pre>private static readonly Rectangle2D[] m_MalasRegions = new Rectangle2D[]
        {
            new Rectangle2D(new Point2D(0, 0), new Point2D(320 * 8, 256 * 8))
        };</pre>

Fragment 2 in file Scripts\Commands\DoorGenerator.cs

<pre>private static readonly Rectangle2D[] m_MalasRegions = new Rectangle2D[]
        {
            new Rectangle2D(new Point2D(0, 0), new Point2D(320 * 8, 256 * 8))
        };</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SignGenDelete.cs

<pre>public SignEntry(string text, Point3D pt, int itemID, int mapLoc)
            {
                this.m_Text = text;
                this.m_Location = pt;
                this.m_ItemID = itemID;
                this.m_Map = mapLoc;
            }</pre>

Fragment 2 in file Scripts\Commands\SignParser.cs

<pre>public SignEntry(string text, Point3D pt, int itemID, int mapLoc)
			{
				this.m_Text = text;
				this.m_Location = pt;
				this.m_ItemID = itemID;
				this.m_Map = mapLoc;
			}</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\UnloadMaps.cs

<pre>this.m_CommandEventArgs = e;
            this.Closable = true;
            this.Dragable = true;

            this.AddPage(1);

            //grey background
            this.AddBackground(0, 0, 240, 310, 5054);</pre>

Fragment 2 in file Scripts\Commands\UnloadMaps.cs

<pre>this.m_CommandEventArgs = e;
            this.Closable = true;
            this.Dragable = true;

            this.AddPage(1);

            //grey background
            this.AddBackground(0, 0, 240, 310, 5054);</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AdminGump.cs

<pre>TextRelay matchEntry = info.GetTextEntry(0);
                                    string match = (matchEntry == null ? null : matchEntry.Text.Trim().ToLower());
                                    string notice = null;</pre>

Fragment 2 in file Scripts\Gumps\AdminGump.cs

<pre>TextRelay matchEntry = info.GetTextEntry(0);
                                    string match = (matchEntry == null ? null : matchEntry.Text.Trim().ToLower());
                                    string notice = null;</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\MiningCart.cs

<pre>if (this.m_Timer != null)
                writer.Write((DateTime)this.m_Timer.Next);
            else
                writer.Write((DateTime)DateTime.UtcNow + TimeSpan.FromDays(1));</pre>

Fragment 2 in file Scripts\Items\Addons\TreeStump.cs

<pre>if (this.m_Timer != null)
                writer.Write((DateTime)this.m_Timer.Next);
            else
                writer.Write((DateTime)DateTime.UtcNow + TimeSpan.FromDays(1));</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Wreath.cs

<pre>this.m_From = from;
                this.m_Loc = loc;
                this.m_Deed = deed;

                this.AddBackground(0, 0, 300, 150, 0xA28);

                this.AddPage(0);</pre>

Fragment 2 in file Scripts\Items\Decorative\Mistletoe.cs

<pre>this.m_From = from;
                this.m_Loc = loc;
                this.m_Deed = deed;

                this.AddBackground(0, 0, 300, 150, 0xA28);

                this.AddPage(0);</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\WindOfCorruption.cs

<pre>{
            WeaponAttributes.HitLeechStam = 40;
            Attributes.WeaponSpeed = 30;
            Attributes.WeaponDamage = 50;
            WeaponAttributes.HitLowerDefend = 40;
            AosElementDamages.Chaos = 100;

            Slayer = SlayerName.Fey;
            Hue = 1171;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\WindOfCorruption.cs

<pre>{
            WeaponAttributes.HitLeechStam = 40;
            Attributes.WeaponSpeed = 30;
            Attributes.WeaponDamage = 50;
            WeaponAttributes.HitLowerDefend = 40;
            AosElementDamages.Chaos = 100;

            Slayer = SlayerName.Fey;
            Hue = 1171;
        }</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\TreasureChestMod.cs

<pre>LockLevel = this.RequiredSkill - Utility.Random( 1, 10 );
			MaxLockLevel = this.RequiredSkill;
			TrapType = TrapType.MagicTrap;
			TrapPower = 1 * Utility.Random( 1, 25 );</pre>

Fragment 2 in file Scripts\Items\Containers\TreasureChestMod.cs

<pre>LockLevel = this.RequiredSkill - Utility.Random( 1, 10 );
			MaxLockLevel = this.RequiredSkill;
			TrapType = TrapType.MagicTrap;
			TrapPower = 1 * Utility.Random( 1, 25 );</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>this.m_SAAbsorptionAttributes = new SAAbsorptionAttributes(this);
            m_NegativeAttributes = new NegativeAttributes(this);

            #region Mondain's Legacy Sets
            this.m_SetAttributes = new AosAttributes(this);
            this.m_SetSkillBonuses = new AosSkillBonuses(this);</pre>

Fragment 2 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>this.m_SetAttributes = new AosAttributes(this);
            this.m_SetSkillBonuses = new AosSkillBonuses(this);
            this.m_SAAbsorptionAttributes = new SAAbsorptionAttributes(this);
            m_NegativeAttributes = new NegativeAttributes(this);</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\WallSafe.cs

<pre>case Direction.North:
                                        case Direction.South: northWall = true; westWall = false; break;

                                        case Direction.East:
                                        case Direction.West: northWall = false; westWall = true; break;

                                        default:</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\Fish\Trophies.cs

<pre>case Direction.North:
                            case Direction.South: northWall = true; westWall = false; break;

                            case Direction.East:
                            case Direction.West: northWall = false; westWall = true; break;

                            default:</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\CharacterCreation.cs

<pre>{
                        if (elf)
                            EquipItem(new WildStaff());
                        else if (human)
                            EquipItem(new GnarledStaff());
                        else if (gargoyle)
                            EquipItem(new SerpentStoneStaff());

                        break;
                    }</pre>

Fragment 2 in file Scripts\Misc\CharacterCreation.cs

<pre>{
                        if (elf)
                            EquipItem(new WildStaff());
                        else if (human)
                            EquipItem(new GnarledStaff());
                        else if (gargoyle)
                            EquipItem(new SerpentStoneStaff());

                        break;
                    }</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\CharacterCreation.cs

<pre>{
                        if (elf)
                            EquipItem(new RuneBlade());
                        else if (human)
                            EquipItem(new Katana());
                        else if (gargoyle)
                            EquipItem(new GlassSword());

                        break;
                    }</pre>

Fragment 2 in file Scripts\Misc\CharacterCreation.cs

<pre>{
                        if (elf)
                            EquipItem(new RuneBlade());
                        else if (human)
                            EquipItem(new Katana());
                        else if (gargoyle)
                            EquipItem(new GlassSword());

                        break;
                    }</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\Timestamp.cs

<pre>if (m_Newline)
            {
                value = this.Timestamp + value;
            }

            byte[] data = this.Encoding.GetBytes(value);
            m_OldOutput.Write(data, 0, data.Length);</pre>

Fragment 2 in file Scripts\Misc\Timestamp.cs

<pre>if (m_Newline)
            {
                value = this.Timestamp + value;
            }

            byte[] data = this.Encoding.GetBytes(value);
            m_OldOutput.Write(data, 0, data.Length);</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\MasterJonath.cs

<pre>public override void GenerateLoot()
        {
            this.AddLoot(LootPack.UltraRich, 3);
            this.AddLoot(LootPack.MedScrolls, 2);
            this.AddLoot(LootPack.HighScrolls, 2);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Named\RedDeath.cs

<pre>public override void GenerateLoot()
        {
            this.AddLoot(LootPack.UltraRich, 3);
            this.AddLoot(LootPack.MedScrolls, 2);
            this.AddLoot(LootPack.HighScrolls, 2);
        }</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>if (m is BaseCreature && !((BaseCreature)m).Controlled)
            {
                return (!Alive || !m.Alive || IsDeadBondedPet || m.IsDeadBondedPet) || (Hidden && IsStaff());
            }</pre>

Fragment 2 in file Scripts\Mobiles\PlayerMobile.cs

<pre>if (m is BaseCreature && !((BaseCreature)m).Controlled)
			{
				return (!Alive || !m.Alive || IsDeadBondedPet || m.IsDeadBondedPet) || (Hidden && IsStaff());
			}</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\MysteriousWisp.cs

<pre>AddButton(10, 374, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
                AddHtmlLocalized(45, 376, 450, 20, 1011012, 0x7FFF, false, false); // CANCEL</pre>

Fragment 2 in file Scripts\Spells\Ninjitsu\AnimalForm.cs

<pre>AddButton(10, 374, 0xFB1, 0xFB2, 0, GumpButtonType.Reply, 0);
				AddHtmlLocalized(45, 376, 450, 20, 1011012, 0x7FFF, false, false); // CANCEL</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\BaseHouse.cs

<pre>{
                if (!item.Deleted)
                {
                    item.IsLockedDown = false;
                    item.IsSecure = false;
                    item.Movable = true;

                    if (item.Parent == null)
                        this.DropToMovingCrate(item);
                }
            }</pre>

Fragment 2 in file Scripts\Multis\BaseHouse.cs

<pre>{
                if (!item.Deleted)
                {
                    item.IsLockedDown = false;
                    item.IsSecure = false;
                    item.Movable = true;

                    if (item.Parent == null)
                        this.DropToMovingCrate(item);
                }
            }</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\SmallSmithBOD.cs

<pre>this.AmountMax = amountMax;
            this.AmountCur = amountCur;
            this.Type = type;
            this.Number = number;
            this.Graphic = graphic;
            this.RequireExceptional = reqExceptional;
            this.Material = mat;</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallTailorBOD.cs

<pre>this.AmountMax = amountMax;
            this.AmountCur = amountCur;
            this.Type = type;
            this.Number = number;
            this.Graphic = graphic;
            this.RequireExceptional = reqExceptional;
            this.Material = mat;</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>public Mobile Spawn(params Type[] types)
        {
            try
            {
                return Activator.CreateInstance(types[Utility.Random(types.Length)]) as Mobile;
            }
            catch
            {
                return null;
            }
        }</pre>

Fragment 2 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>public Mobile Spawn(params Type[] types)
        {
            try
            {
                return Activator.CreateInstance(types[Utility.Random(types.Length)]) as Mobile;
            }
            catch
            {
                return null;
            }
        }</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>AddButton(10, 490, 4014, 4016, 4, GumpButtonType.Reply, 0);
            AddHtmlLocalized(50, 490, 200, 18, 1149777, BlueColor16, false, false); // MAIN MENU</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>AddButton(10, 490, 4014, 4016, 4, GumpButtonType.Reply, 0);
            AddHtmlLocalized(50, 490, 200, 18, 1149777, BlueColor16, false, false); // MAIN MENU</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>AddButton(10, 490, 4014, 4016, 3, GumpButtonType.Reply, 0);
            AddHtmlLocalized(50, 490, 200, 18, 1149777, BlueColor16, false, false); // MAIN MENU</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>AddButton(10, 490, 4014, 4016, 3, GumpButtonType.Reply, 0);
            AddHtmlLocalized(50, 490, 200, 18, 1149777, BlueColor16, false, false); // MAIN MENU</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>AddButton(10, 490, 4014, 4016, 1, GumpButtonType.Reply, 0);
            AddHtmlLocalized(50, 490, 200, 18, 1149777, BlueColor16, false, false); // MAIN MENU</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\CommodityBrokerGump.cs

<pre>AddButton(10, 490, 4014, 4016, 1, GumpButtonType.Reply, 0);
            AddHtmlLocalized(50, 490, 200, 18, 1149777, BlueColor16, false, false); // MAIN MENU</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>if(hasbidspecific)				// Change from specific to next available
						{
							// You were previously bidding on Stall ~1_OLDSTALL~, and now you are bidding on the first available stall.
							cliloc2 = 1150580;
							args2 = oldPlot.PlotDef.ID;
						}
						else if(hasbidnextavailable)	// stays as next available
						{
							// You are still bidding on the next available stall.
							cliloc2 = 1150581;
							args2 = null;
						}
						else							// First time bid
						{
							// You are now bidding on the next available stall.
							cliloc2 = 1150584;
							args2 = null;
						}</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>if(hasbidspecific)				// Change from specific to next available
						{
							// You were previously bidding on Stall ~1_OLDSTALL~, and now you are bidding on the first available stall.
							cliloc2 = 1150580;
							args2 = oldPlot.PlotDef.ID;
						}
						else if(hasbidnextavailable)	// stays as next available
						{
							// You are still bidding on the next available stall.
							cliloc2 = 1150581;
							args2 = null;
						}
						else							// First time bid
						{
							// You are now bidding on the next available stall.
							cliloc2 = 1150584;
							args2 = null;
						}</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>AddButton(10, 490, 4014, 4016, 500, GumpButtonType.Reply, 0); 
			AddHtmlLocalized(50, 490, 100, 18, 1149777, BlueColor16, false, false); // MAIN MENU</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\PetBrokerGumps.cs

<pre>AddButton(10, 490, 4014, 4016, 500, GumpButtonType.Reply, 0);
            AddHtmlLocalized(50, 490, 100, 18, 1149777, BlueColor16, false, false); // MAIN MENU</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Pathing\Movement.cs

<pre>!this.Check(map, p, itemsLeft, mobsLeft, xLeft, yLeft, startTop, startZ, m != null && m.CanSwim, m != null && m.CantWalk, out hold)</pre>

Fragment 2 in file Scripts\Services\Pathing\Movement.cs

<pre>!this.Check(map, p, itemsLeft, mobsLeft, xLeft, yLeft, startTop, startZ, m != null && m.CanSwim, m != null && m.CantWalk, out hold)</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDamagedBySpell( Mobile from )
        {
            base.OnDamagedBySpell(from);

            if (!IsUnderEffects(from) && 0.50 > Utility.RandomDouble())
            {
                DoEffects(from);
            }
        }</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Shame Revamped\Mobiles\Creatures.cs

<pre>public override void OnDamagedBySpell(Mobile from)
        {
            base.OnDamagedBySpell(from);

            if (!IsUnderEffects(from) && 0.50 > Utility.RandomDouble())
            {
                DoEffects(from);
            }
        }</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string propname = arglist[2];
							string typestr = null;

							if (arglist.Length > 3)
							{
								typestr = arglist[2];
								propname = arglist[3];
							}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string propname = arglist[2];
							string typestr = null;

							if (arglist.Length > 3)
							{
								typestr = arglist[2];
								propname = arglist[3];
							}</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlAddFaction.cs

<pre>XmlMobFactions.GroupTypes g = XmlMobFactions.GroupTypes.End_Unused;
                try
                {
                    g = (XmlMobFactions.GroupTypes)Enum.Parse(typeof(XmlMobFactions.GroupTypes), this.FactionType, true);
                }
                catch
                {
                }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlAddFaction.cs

<pre>XmlMobFactions.GroupTypes g = XmlMobFactions.GroupTypes.End_Unused;
            try
            {
                g = (XmlMobFactions.GroupTypes)Enum.Parse(typeof(XmlMobFactions.GroupTypes), this.FactionType, true);
            }
            catch
            {
            }</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Base\Spell.cs

<pre>if (!firstCircle && !Core.AOS && this is MagerySpell && ((MagerySpell)this).Circle == SpellCircle.First)
				{
					return;
				}

				m_State = SpellState.None;
				m_Caster.Spell = null;</pre>

Fragment 2 in file Scripts\Spells\Base\Spell.cs

<pre>if (!firstCircle && !Core.AOS && this is MagerySpell && ((MagerySpell)this).Circle == SpellCircle.First)
				{
					return;
				}

				m_State = SpellState.None;
				m_Caster.Spell = null;</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Server\Effects.cs

<pre>p.Acquire();

				foreach (NetState state in eable)
				{
					state.Mobile.ProcessDelta();
					state.Send(p);
				}

				p.Release();

				eable.Free();</pre>

Fragment 2 in file Server\Effects.cs

<pre>p.Acquire();

				foreach (NetState state in eable)
				{
					state.Mobile.ProcessDelta();
					state.Send(p);
				}

				p.Release();

				eable.Free();</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>if (m_Blessed || m_YellowHealthbar)
			{
				flags |= 0x08;
			}

			if (m_Warmode)
			{
				flags |= 0x40;
			}

			if (m_Hidden)
			{
				flags |= 0x80;
			}

            if (m_IgnoreMobiles)
            {
                flags |= 0x10;
            }

			return flags;</pre>

Fragment 2 in file Server\Mobile.cs

<pre>if (m_Blessed || m_YellowHealthbar)
			{
				flags |= 0x08;
			}

			if (m_Warmode)
			{
				flags |= 0x40;
			}

			if (m_Hidden)
			{
				flags |= 0x80;
			}

            if (m_IgnoreMobiles)
            {
                flags |= 0x10;
            }

			return flags;</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\DaemonBone\DaemonArms.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\BoneArms.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write((int)0);

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Armor\BoneGloves.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write((int)0);

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string propname = value_keywordargs[2];
									string typestr = null;

									if (value_keywordargs.Length > 3)
									{
										propname = value_keywordargs[3];
										typestr = value_keywordargs[2];
									}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string propname = value_keywordargs[2];
									string typestr = null;
									if (value_keywordargs.Length > 3)
									{
										propname = value_keywordargs[3];
										typestr = value_keywordargs[2];
									}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>string propname = value_keywordargs[2];
										string typestr = null;
										if (value_keywordargs.Length > 3)
										{
											propname = value_keywordargs[3];
											typestr = value_keywordargs[2];
										}</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Ultima\Art.cs

<pre>var ms = new MemoryStream();
							bmp.Save(ms, ImageFormat.Bmp);
							byte[] checksum = sha.ComputeHash(ms.ToArray());
							CheckSums sum;</pre>

Fragment 2 in file Ultima\Art.cs

<pre>var ms = new MemoryStream();
							bmp.Save(ms, ImageFormat.Bmp);
							byte[] checksum = sha.ComputeHash(ms.ToArray());
							CheckSums sum;</pre>

Fragment 3 in file Ultima\Textures.cs

<pre>var ms = new MemoryStream();
							bmp.Save(ms, ImageFormat.Bmp);
							byte[] checksum = sha.ComputeHash(ms.ToArray());
							CheckSums sum;</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Implementors\AreaCommandImplementor.cs

<pre>Extensions ext = Extensions.Parse(from, ref args);

                bool items, mobiles;

                if (!this.CheckObjectTypes(from, command, ext, out items, out mobiles))
                    return;</pre>

Fragment 2 in file Scripts\Commands\Generic\Implementors\ContainedCommandImplementor.cs

<pre>Extensions ext = Extensions.Parse(from, ref args);

                    bool items, mobiles;

                    if (!this.CheckObjectTypes(from, command, ext, out items, out mobiles))
                        return;</pre>

Fragment 3 in file Scripts\Commands\Generic\Implementors\GlobalCommandImplementor.cs

<pre>Extensions ext = Extensions.Parse(from, ref args);

                bool items, mobiles;

                if (!this.CheckObjectTypes(from, command, ext, out items, out mobiles))
                    return;</pre>

Fragment 4 in file Scripts\Commands\Generic\Implementors\RegionCommandImplementor.cs

<pre>Extensions ext = Extensions.Parse(from, ref args);

                bool items, mobiles;

                if (!this.CheckObjectTypes(from, command, ext, out items, out mobiles))
                    return;</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialArms.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnAdded((Mobile)parent, this);
            }
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialEarrings.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnAdded((Mobile)parent, this);
            }
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialGloves.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnAdded((Mobile)parent, this);
            }
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialGorget.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnAdded((Mobile)parent, this);
            }
        }</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialHelm.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnAdded((Mobile)parent, this);
            }
        }</pre>

Fragment 6 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialKilt.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnAdded((Mobile)parent, this);
            }
        }</pre>

Fragment 7 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialLegs.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnAdded((Mobile)parent, this);
            }
        }</pre>

Fragment 8 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialNecklace.cs

<pre>public override void OnAdded(object parent)
        {
            base.OnAdded(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnAdded((Mobile)parent, this);
            }
        }</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialArms.cs

<pre>public override void OnRemoved(object parent)
        {
            base.OnRemoved(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnRemoved((Mobile)parent, this);
            }
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialEarrings.cs

<pre>public override void OnRemoved(object parent)
        {
            base.OnRemoved(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnRemoved((Mobile)parent, this);
            }
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialGloves.cs

<pre>public override void OnRemoved(object parent)
        {
            base.OnRemoved(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnRemoved((Mobile)parent, this);
            }
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialGorget.cs

<pre>public override void OnRemoved(object parent)
        {
            base.OnRemoved(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnRemoved((Mobile)parent, this);
            }
        }</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialHelm.cs

<pre>public override void OnRemoved(object parent)
        {
            base.OnRemoved(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnRemoved((Mobile)parent, this);
            }
        }</pre>

Fragment 6 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialKilt.cs

<pre>public override void OnRemoved(object parent)
        {
            base.OnRemoved(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnRemoved((Mobile)parent, this);
            }
        }</pre>

Fragment 7 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialLegs.cs

<pre>public override void OnRemoved(object parent)
        {
            base.OnRemoved(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnRemoved((Mobile)parent, this);
            }
        }</pre>

Fragment 8 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialNecklace.cs

<pre>public override void OnRemoved(object parent)
        {
            base.OnRemoved(parent);

            if (parent is Mobile && !Deleted)
            {
                BestialSetHelper.OnRemoved((Mobile)parent, this);
            }
        }</pre>

## Duplicated Code. Size: 77

### Duplicated Fragments:

Fragment 1 in file Ultima\AnimationEdit.cs

<pre>FileStream fsidx = new FileStream(idx, FileMode.Create, FileAccess.Write, FileShare.Write),
						   fsmul = new FileStream(mul, FileMode.Create, FileAccess.Write, FileShare.Write)</pre>

Fragment 2 in file Ultima\Art.cs

<pre>FileStream fsidx = new FileStream(idx, FileMode.Create, FileAccess.Write, FileShare.Write),
						   fsmul = new FileStream(mul, FileMode.Create, FileAccess.Write, FileShare.Write)</pre>

Fragment 3 in file Ultima\Gumps.cs

<pre>FileStream fsidx = new FileStream(idx, FileMode.Create, FileAccess.Write, FileShare.Write),
						   fsmul = new FileStream(mul, FileMode.Create, FileAccess.Write, FileShare.Write)</pre>

Fragment 4 in file Ultima\Light.cs

<pre>FileStream fsidx = new FileStream(idx, FileMode.Create, FileAccess.Write, FileShare.Write),
						   fsmul = new FileStream(mul, FileMode.Create, FileAccess.Write, FileShare.Write)</pre>

Fragment 5 in file Ultima\Map.cs

<pre>FileStream fsidx = new FileStream(idx, FileMode.Create, FileAccess.Write, FileShare.Write),
						   fsmul = new FileStream(mul, FileMode.Create, FileAccess.Write, FileShare.Write)</pre>

Fragment 6 in file Ultima\Multis.cs

<pre>FileStream fsidx = new FileStream(idx, FileMode.Create, FileAccess.Write, FileShare.Write),
						   fsmul = new FileStream(mul, FileMode.Create, FileAccess.Write, FileShare.Write)</pre>

Fragment 7 in file Ultima\Skills.cs

<pre>FileStream fsidx = new FileStream(idx, FileMode.Create, FileAccess.Write, FileShare.Write),
						   fsmul = new FileStream(mul, FileMode.Create, FileAccess.Write, FileShare.Write)</pre>

Fragment 8 in file Ultima\Sound.cs

<pre>FileStream fsidx = new FileStream(idx, FileMode.Create, FileAccess.Write, FileShare.Write),
						   fsmul = new FileStream(mul, FileMode.Create, FileAccess.Write, FileShare.Write)</pre>

Fragment 9 in file Ultima\Textures.cs

<pre>FileStream fsidx = new FileStream(idx, FileMode.Create, FileAccess.Write, FileShare.Write),
						   fsmul = new FileStream(mul, FileMode.Create, FileAccess.Write, FileShare.Write)</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Profiling.cs

<pre>object o = (object)table[type];

                    if (o == null)
                        table[type] = 1;
                    else
                        table[type] = 1 + (int)o;</pre>

Fragment 2 in file Scripts\Commands\Profiling.cs

<pre>object o = (object)table[type];

                    if (o == null)
                        table[type] = 1;
                    else
                        table[type] = 1 + (int)o;</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SHTelGenDelete.cs

<pre>SHTeleporter tele1 = this.AddSHT(map, ext1, x1, y1, z1);
                SHTeleporter tele2 = this.AddSHT(map, ext2, x2, y2, z2);</pre>

Fragment 2 in file Scripts\Items\Addons\SHTeleporter.cs

<pre>SHTeleporter tele1 = this.AddSHT(map, ext1, x1, y1, z1);
                SHTeleporter tele2 = this.AddSHT(map, ext2, x2, y2, z2);</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetPoint2DGump.cs

<pre>protected override void OnTargetFinish(Mobile from)
            {
                this.m_Mobile.SendGump(new PropertiesGump(this.m_Mobile, this.m_Object, this.m_Stack, this.m_List, this.m_Page));
            }</pre>

Fragment 2 in file Scripts\Gumps\Properties\SetPoint3DGump.cs

<pre>protected override void OnTargetFinish(Mobile from)
            {
                this.m_Mobile.SendGump(new PropertiesGump(this.m_Mobile, this.m_Object, this.m_Stack, this.m_List, this.m_Page));
            }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\AddonComponent.cs

<pre>[Hue, CommandProperty(AccessLevel.GameMaster)]
        public override int Hue
        {
            get
            {
                return base.Hue;
            }
            set
            {
                base.Hue = value;

                if (this.m_Addon != null && this.m_Addon.ShareHue)
                    this.m_Addon.Hue = value;
            }
        }</pre>

Fragment 2 in file Scripts\Items\Addons\AddonContainerComponent.cs

<pre>[Hue, CommandProperty(AccessLevel.GameMaster)]
        public override int Hue
        {
            get
            {
                return base.Hue;
            }
            set
            {
                base.Hue = value;

                if (this.m_Addon != null && this.m_Addon.ShareHue)
                    this.m_Addon.Hue = value;
            }
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\FlourMillEastAddon.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((int)this.m_Flour);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\FlourMillSouthAddon.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((int)this.m_Flour);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\FountainOfFortune.cs

<pre>AddComponent(new AddonComponent(itemID++), +0, -2, 0);
            AddComponent(new AddonComponent(itemID++), +0, -1, 0);</pre>

Fragment 2 in file Scripts\Items\Addons\FountainOfFortune.cs

<pre>AddComponent(new AddonComponent(itemID++), -1, +0, 0);
            AddComponent(new AddonComponent(itemID++), -2, +0, 0);</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Guildstone.cs

<pre>base.Serialize(writer);

            if (this.m_Guild != null && !this.m_Guild.Disbanded)
            {
                this.m_GuildName = this.m_Guild.Name;
                this.m_GuildAbbrev = this.m_Guild.Abbreviation;
            }</pre>

Fragment 2 in file Scripts\Items\Addons\Guildstone.cs

<pre>base.Serialize(writer);

            if (this.m_Guild != null && !this.m_Guild.Disbanded)
            {
                this.m_GuildName = this.m_Guild.Name;
                this.m_GuildAbbrev = this.m_Guild.Abbreviation;
            }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\LoomEastAddon.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((int)this.m_Phase);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\LoomSouthAddon.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((int)this.m_Phase);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Decorative\DeBoorShield.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 5.0)
                this.Weight = 7.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\MetalKiteShield.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 5.0)
                this.Weight = 7.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\GlovesOfFeudalGrip.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();

            if (version == 0)
            {
                Resource = CraftResource.None;
            }
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\GlovesOfFeudalGrip.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadEncodedInt();

            if (version == 0)
            {
                Resource = CraftResource.None;
            }
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\GlovesOfMining.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_Bonus);
        }</pre>

Fragment 2 in file Scripts\Items\Tools\AncientSmithyHammer.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_Bonus);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Ranger\RangerChest.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 8.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\StuddedChest.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 8.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Jewelry\OrnamentOfTheMagician.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Hue == 0x12B)
                this.Hue = 0x554;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Jewelry\TokenofHolyFavor.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Hue == 0x12B)
                this.Hue = 0x554;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\FNPitchfork.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 10.0)
                this.Weight = 11.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\Pitchfork.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 10.0)
                this.Weight = 11.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\TOTGreaterArtifacts.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1);

            writer.WriteEncodedInt((int)this.m_Type);
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\TOTLesserArtifacts.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1);

            writer.WriteEncodedInt((int)this.m_Type);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\Container.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 15.0)
                this.Weight = 2.0;
        }</pre>

Fragment 2 in file Scripts\Items\Containers\GargoyleWoodenChest.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 15.0)
                this.Weight = 2.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\BaseStatuette.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((bool)this.m_TurnedOn);
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\WindChimes.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((bool)this.m_TurnedOn);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X - 2, this.Y , this.Z);
        }</pre>

Fragment 2 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X - 2, this.Y, this.Z);
            }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X , this.Y - 2 , this.Z);
        }</pre>

Fragment 2 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X, this.Y - 2, this.Z);
            }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\FemaleStuddedChest.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 6.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\LeatherChest.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 6.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 3.0)
                this.Weight = 2.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Instruments\BambooFlute.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 3.0)
                this.Weight = 2.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
                Layer = Layer.OuterTorso;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (Layer != Layer.OuterTorso)
                Layer = Layer.OuterTorso;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\Bow.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 7.0)
                this.Weight = 6.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\Yumi.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 7.0)
                this.Weight = 6.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\GargishMaul.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 14.0)
                this.Weight = 10.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\Maul.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 14.0)
                this.Weight = 10.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\GargishScythe.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 15.0)
                this.Weight = 5.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\Scythe.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 15.0)
                this.Weight = 5.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\ShepherdsCrook.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 2.0)
                this.Weight = 4.0;
        }</pre>

Fragment 2 in file Scripts\Items\Tools\Blowpipe.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 2.0)
                this.Weight = 4.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\MedusaLairAltar.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_ID);
        }</pre>

Fragment 2 in file Scripts\Items\Functional\StygianDragonAltar.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_ID);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Quest\ModifiedClockworkAssembly.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1);

            writer.Write((int)this.m_Type);
        }</pre>

Fragment 2 in file Scripts\Services\ChampionSystem\ChampionSkull.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((int)this.m_Type);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Quest\PrismaticAmber.cs

<pre>public override bool DropToWorld(Mobile from, Point3D p)
        {
            bool ret = base.DropToWorld(from, p);

            if (ret)
                this.DestroyItem(from);

            return ret;
        }</pre>

Fragment 2 in file Scripts\Items\Quest\PrismOfLightAdmissionTicket.cs

<pre>public override bool DropToWorld(Mobile from, Point3D p)
        {
            bool ret = base.DropToWorld(from, p);

            if (ret)
                this.DestroyItem(from);

            return ret;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\Scales.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_Resource);
        }</pre>

Fragment 2 in file Scripts\Items\Tools\BaseRunicTool.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version
            writer.Write((int)this.m_Resource);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\Dyes.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 0.0)
                this.Weight = 3.0;
        }</pre>

Fragment 2 in file Scripts\Multis\HousePlacementTool.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 0.0)
                this.Weight = 3.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Neira.cs

<pre>public override void Serialize(GenericWriter writer)
            {
                base.Serialize(writer);

                writer.Write((int)0); // version

                writer.Write((Mobile)this.m_Rider);
            }</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\BaseFactionGuard.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((Mobile)this.m_Rider);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\DevourerRenowned.cs

<pre>this.Body = 303;
            this.BaseSoundID = 357;

            this.SetStr(801, 950);
            this.SetDex(126, 175);
            this.SetInt(201, 250);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Devourer.cs

<pre>this.Body = 303;
            this.BaseSoundID = 357;

            this.SetStr(801, 950);
            this.SetDex(126, 175);
            this.SetInt(201, 250);</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\FireElementalRenowned.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.BaseSoundID == 274)
                this.BaseSoundID = 838;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\FireElemental.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.BaseSoundID == 274)
                this.BaseSoundID = 838;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\AbysmalHorror.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.BaseSoundID == 357)
                this.BaseSoundID = 0x451;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\AbyssalAbomination.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.BaseSoundID == 357)
                this.BaseSoundID = 0x451;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Bogle.cs

<pre>Body = 153;
            BaseSoundID = 0x482;

            SetStr(76, 100);
            SetDex(76, 95);
            SetInt(36, 60);

            SetHits(46, 60);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Ghoul.cs

<pre>Body = 153;
            BaseSoundID = 0x482;

            SetStr(76, 100);
            SetDex(76, 95);
            SetInt(36, 60);

            SetHits(46, 60);</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DreadSpider.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.BaseSoundID == 263)
                this.BaseSoundID = 1170;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Void Creatures\Anlorzen.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.BaseSoundID == 263)
                this.BaseSoundID = 1170;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GreenGoblinScout.cs

<pre>private Mobile FindTarget()
		{
			foreach (Mobile m in GetMobilesInRange(10))
			{
				if (m.Player && m.Hidden && m.IsPlayer())
				{
					return m;
				}
			}

			return null;
		}</pre>

Fragment 2 in file Scripts\Mobiles\Normal\OrcScout.cs

<pre>private Mobile FindTarget()
		{
			foreach (Mobile m in GetMobilesInRange(10))
			{
				if (m.Player && m.Hidden && m.IsPlayer())
				{
					return m;
				}
			}

			return null;
		}</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\ArcherGuard.cs

<pre>if (Female = Utility.RandomBool())
			{
				Body = 0x191;
				Name = NameList.RandomName("female");
			}
			else
			{
				Body = 0x190;
				Name = NameList.RandomName("male");
			}</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Mobiles\BaseBizaarBroker.cs

<pre>if ( Female = Utility.RandomBool() )
			{
				Body = 0x191;
				Name = NameList.RandomName( "female" );
			}
			else
			{
				Body = 0x190;
				Name = NameList.RandomName( "male" );
			}</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);

            writer.Write((Item)this.m_Tournament);
        }</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);

            writer.Write((Item)this.m_Tournament);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>case TournamentStage.Inactive:
                            {
                                if (this.m_Registrar != null)
                                    this.m_Registrar.PrivateOverheadMessage(MessageType.Regular,
                                        0x35, false, "The tournament is closed.", from.NetState);

                                break;
                            }
                        case TournamentStage.Signup:</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>case TournamentStage.Inactive:
                        {
                            if (this.m_Registrar != null)
                                this.m_Registrar.PrivateOverheadMessage(MessageType.Regular,
                                    0x35, false, "The tournament is closed.", from.NetState);

                            break;
                        }
                    case TournamentStage.Signup:</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Regions\CorgulRegion.cs

<pre>m_Markers = new List<Item>();

            int w = rec.X + rec.Width;
            int h = rec.Y + rec.Height;
            int t = 0;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Regions\WarpRegion.cs

<pre>m_Markers = new List<Item>();

            int w = rec.X + rec.Width;
            int h = rec.Y + rec.Height;
            int t = 0;</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Myrmidex Invasion\BattleSpawner.cs

<pre>if (!Players.ContainsKey((PlayerMobile)ds.m_Mobile))
                        Players[(PlayerMobile)ds.m_Mobile] = points;
                    else
                        Players[(PlayerMobile)ds.m_Mobile] += points;</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Myrmidex Invasion\BattleSpawner.cs

<pre>if (!Players.ContainsKey((PlayerMobile)ds.m_Mobile))
                        Players[(PlayerMobile)ds.m_Mobile] = points;
                    else
                        Players[(PlayerMobile)ds.m_Mobile] += points;</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Items\BaseMonolith.cs

<pre>base.Serialize(writer);

            writer.Write((int)0); // version

            Town.WriteReference(writer, this.m_Town);
            Faction.WriteReference(writer, this.m_Faction);</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\BaseFactionGuard.cs

<pre>base.Serialize(writer);

            writer.Write((int)0); // version

            Faction.WriteReference(writer, this.m_Faction);
            Town.WriteReference(writer, this.m_Town);</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\HuntmasterChallenge\HuntingSystem.cs

<pre>{
                writer.Write((int)kvp.Key);
                writer.Write(kvp.Value.Count);

                foreach (HuntingKillEntry entry in kvp.Value)
                    entry.Serialize(writer);
            }</pre>

Fragment 2 in file Scripts\Services\HuntmasterChallenge\HuntingSystem.cs

<pre>{
				writer.Write((int)kvp.Key);
				writer.Write(kvp.Value.Count);

				foreach(HuntingKillEntry entry in kvp.Value)
					entry.Serialize(writer);
			}</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Loot\BracersofAlchemicalDevastation.cs

<pre>this.Attributes.RegenMana = 4;
            this.Attributes.CastRecovery = 3;
            this.ArmorAttributes.MageArmor = 1;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            this.m_AosWeaponAttributes.HitFireball = 15;</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Loot\GargishBracersofAlchemicalDevastation.cs

<pre>this.Attributes.RegenMana = 4;
            this.Attributes.CastRecovery = 3;
            this.ArmorAttributes.MageArmor = 1;
            this.m_AosWeaponAttributes = new AosWeaponAttributes(this);
            this.m_AosWeaponAttributes.HitFireball = 15;</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>MaxCount = maxamount;
				SubGroup = 0;
				SequentialResetTime = 0;
				SequentialResetTo = 0;
				KillsNeeded = 0;
				RestrictKillsToSubgroup = false;
				ClearOnAdvance = true;
				SpawnedObjects = new List<object>();</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>MaxCount = maxamount;
				SubGroup = 0;
				SequentialResetTime = 0;
				SequentialResetTo = 0;
				KillsNeeded = 0;
				RestrictKillsToSubgroup = false;
				ClearOnAdvance = true;
				SpawnedObjects = new List<object>();</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlCategorizedAddGump.cs

<pre>if ( OldStyle )
				AddImageTiled( x, y, TotalWidth - (OffsetSize * 3) - SetWidth, EntryHeight, HeaderGumpID );
			else
				AddImageTiled( x, y, PrevWidth, EntryHeight, HeaderGumpID );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlCategorizedAddGump.cs

<pre>if ( OldStyle )
				AddImageTiled( x, y, TotalWidth - (OffsetSize * 3) - SetWidth, EntryHeight, HeaderGumpID );
			else
				AddImageTiled( x, y, PrevWidth, EntryHeight, HeaderGumpID );</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGauntlet.cs

<pre>{
                    if(entry.Participant == killed && entry.Status != ChallengeStatus.Forfeit)
                    {
                        entry.Status = ChallengeStatus.Dead;
                        // clear up their noto
                        RefreshSymmetricNoto(killed);

                        GameBroadcast(100314, killed.Name); // "{0} has been killed"
                    }
                }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGauntlet.cs

<pre>{
                    if(entry.Participant == killed && entry.Status != ChallengeStatus.Forfeit)
                    {
                        entry.Status = ChallengeStatus.Dead;
                        // clear up their noto
                        RefreshSymmetricNoto(killed);

                        GameBroadcast(100314, killed.Name); // "{0} has been killed"
                    }
                }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Chivalry\SacredJourney.cs

<pre>{
                    RecallRune rune = (RecallRune)o;

                    if (rune.Marked)
                        this.m_Owner.Effect(rune.Target, rune.TargetMap, true);
                    else
                        from.SendLocalizedMessage(501805); // That rune is not yet marked.
                }</pre>

Fragment 2 in file Scripts\Spells\Fourth\Recall.cs

<pre>{
                    RecallRune rune = (RecallRune)o;

                    if (rune.Marked)
                        this.m_Owner.Effect(rune.Target, rune.TargetMap, true);
                    else
                        from.SendLocalizedMessage(501805); // That rune is not yet marked.
                }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\InjectedStrike.cs

<pre>{
                    if (Caster.CheckTargetSkill(CastSkill, potion, potion.MinPoisoningSkill, potion.MaxPoisoningSkill))
                    {
                        ApplyPoison(weapon, potion);
                        return;
                    }
                    else
                    {
                        Caster.SendLocalizedMessage(1010518); // You fail to apply a sufficient dose of poison
                    }
                }</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\InjectedStrike.cs

<pre>{
                        if (Caster.CheckTargetSkill(CastSkill, potion, potion.MinPoisoningSkill, potion.MaxPoisoningSkill))
                        {
                            ApplyPoison(weapon, potion);
                            return;
                        }
                        else
                        {
                            Caster.SendLocalizedMessage(1010518); // You fail to apply a sufficient dose of poison
                        }
                    }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Server\Network\Packets.cs

<pre>m_Stream.Write(fixedDirection);
			m_Stream.Write(explode);
			m_Stream.Write(hue);
			m_Stream.Write(renderMode);
			m_Stream.Write((short)effect);</pre>

Fragment 2 in file Server\Network\Packets.cs

<pre>m_Stream.Write(fixedDirection);
			m_Stream.Write(explode);
			m_Stream.Write(hue);
			m_Stream.Write(renderMode);
			m_Stream.Write((short)effect);</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Ranger\RangerArms.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 4.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\FemalePlateChest.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 4.0;
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Armor\StuddedArms.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 4.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Ranger\RangerLegs.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 3.0)
                this.Weight = 5.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\StuddedLegs.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 3.0)
                this.Weight = 5.0;
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Instruments\Lute.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 3.0)
                this.Weight = 5.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Jewelry\AmuletOfRighteousness.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_UsesRemaining);
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\EngravingTools.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_UsesRemaining);
        }</pre>

Fragment 3 in file Scripts\Items\Consumables\PowderOfTemperament.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);
            writer.Write((int)this.m_UsesRemaining);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Jewelry\BurningAmber.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Hue == 0x4F4)
                this.Hue = 0x4F7;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Jewelry\DemonBridleRing.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Hue == 0x4F4)
                this.Hue = 0x4F7;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Jewelry\RingOfTheVile.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Hue == 0x4F4)
                this.Hue = 0x4F7;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\MusicStand.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 6.0)
                this.Weight = 10.0;
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\Stools.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 6.0)
                this.Weight = 10.0;
        }</pre>

Fragment 3 in file Scripts\Items\Decorative\Stools.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 6.0)
                this.Weight = 10.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\SnowGlobes.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version
            writer.WriteEncodedInt((int)this.m_Type);
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\SnowGlobes.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version
            writer.WriteEncodedInt((int)this.m_Type);
        }</pre>

Fragment 3 in file Scripts\Items\Decorative\SnowGlobes.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version
            writer.WriteEncodedInt((int)this.m_Type);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\MiniHouses.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_Type);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\MiniHouses.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_Type);
        }</pre>

Fragment 3 in file Scripts\Items\Consumables\Moonstone.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_Type);
        }</pre>

Fragment 4 in file Scripts\Services\ExploringTheDeep\Mobiles\Shadowlord.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write((int)0); // version

            writer.Write((int)this.m_Type);

        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Consumables\DeliciouslyTastyTreat.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((bool)this.m_Used);
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Consumables\TastyTreat.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((bool)this.m_Used);
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Consumables\VialofArmorEssence.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((bool)this.m_Used); 
        }</pre>

Fragment 4 in file Scripts\Quests\IrresistiblyTastyTreat.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((bool)this.m_Used); 
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Chairs.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 6.0)
                this.Weight = 20.0;
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\Chairs.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 6.0)
                this.Weight = 20.0;
        }</pre>

Fragment 3 in file Scripts\Items\Decorative\Chairs.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 6.0)
                this.Weight = 20.0;
        }</pre>

Fragment 4 in file Scripts\Items\Decorative\Chairs.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 6.0)
                this.Weight = 20.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\Tables.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 4.0)
                this.Weight = 1.0;
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\Tables.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 4.0)
                this.Weight = 1.0;
        }</pre>

Fragment 3 in file Scripts\Items\Decorative\Tables.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 4.0)
                this.Weight = 1.0;
        }</pre>

Fragment 4 in file Scripts\Items\Decorative\WritingTable.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 4.0)
                this.Weight = 1.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\DragonArms.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 15.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\DragonChest.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 15.0;
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Armor\RingmailArms.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 15.0;
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Armor\RingmailChest.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 15.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\Granite.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((int)this.m_Resource);
        }</pre>

Fragment 2 in file Scripts\Items\Resource\Hides.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((int)this.m_Resource);
        }</pre>

Fragment 3 in file Scripts\Items\Resource\Ingots.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((int)this.m_Resource);
        }</pre>

Fragment 4 in file Scripts\Items\Resource\Leathers.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((int)this.m_Resource);
        }</pre>

Fragment 5 in file Scripts\Items\Resource\Ore.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((int)this.m_Resource);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Flurry.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.BaseSoundID == 263)
                this.BaseSoundID = 655;
        }</pre>

Fragment 2 in file Scripts\Mobiles\Named\Mistral.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.BaseSoundID == 263)
                this.BaseSoundID = 655;
        }</pre>

Fragment 3 in file Scripts\Mobiles\Named\Tempest.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.BaseSoundID == 263)
                this.BaseSoundID = 655;
        }</pre>

Fragment 4 in file Scripts\Mobiles\Normal\AirElemental.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.BaseSoundID == 263)
                this.BaseSoundID = 655;
        }</pre>

Fragment 5 in file Scripts\Mobiles\Summons\SummonedAirElemental.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.BaseSoundID == 263)
                this.BaseSoundID = 655;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>if (entry != null)
							{

								if (entry.Participant == state.Mobile)
								{
									entry.PageBeingViewed--;

									if (entry.PageBeingViewed < 0) entry.PageBeingViewed = 0;

									page = entry.PageBeingViewed;
									//break;

								}
							}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>if(entry != null)
                        {

                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed--;

                                if(entry.PageBeingViewed < 0) entry.PageBeingViewed=0;

                                page = entry.PageBeingViewed;
                                //break;

                            }
                        }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>if(entry != null)
                        {

                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed--;

                                if(entry.PageBeingViewed < 0) entry.PageBeingViewed=0;

                                page = entry.PageBeingViewed;
                                //break;

                            }
                        }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>if(entry != null)
                        {

                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed--;

                                if(entry.PageBeingViewed < 0) entry.PageBeingViewed=0;

                                page = entry.PageBeingViewed;
                                //break;

                            }
                        }</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>if(entry != null)
                        {

                            if(entry.Participant == state.Mobile)
                            {
                                entry.PageBeingViewed--;

                                if(entry.PageBeingViewed < 0) entry.PageBeingViewed=0;

                                page = entry.PageBeingViewed;
                                //break;

                            }
                        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Quest\AbyssKey.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_Lifespan);
        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\QuestItems\WillemHartesHat.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version
            writer.Write((int)this.m_Lifespan);
        }</pre>

Fragment 3 in file Scripts\Services\Peerless\PeerlessKey.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            writer.Write((int)this.m_Lifespan);
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\ExodusSacrificalDagger.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version
            writer.Write((int)this.m_Lifespan);
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\ExodusSummoningRite.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version
            writer.Write((int)this.m_Lifespan);
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Items\RobeofRite.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version
            writer.Write((int)this.m_Lifespan);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\SoulStone.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((bool)this.m_IsRewardItem);
        }</pre>

Fragment 2 in file Scripts\Items\Tools\FurnitureDyeTub.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((bool)this.m_IsRewardItem);
        }</pre>

Fragment 3 in file Scripts\Items\Tools\LeatherDyeTub.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((bool)this.m_IsRewardItem);
        }</pre>

Fragment 4 in file Scripts\Items\Tools\RewardBlackDyeTub.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((bool)this.m_IsRewardItem);
        }</pre>

Fragment 5 in file Scripts\Items\Tools\RunebookDyeTub.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((bool)this.m_IsRewardItem);
        }</pre>

Fragment 6 in file Scripts\Items\Tools\SpecialDyeTub.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((bool)this.m_IsRewardItem);
        }</pre>

Fragment 7 in file Scripts\Items\Tools\StatuetteDyeTub.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)1); // version

            writer.Write((bool)this.m_IsRewardItem);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\DecorativeWeapon.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X , this.Y + 1, this.Z);
            }</pre>

Fragment 2 in file Scripts\Items\Decorative\DecorativeWeapon.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X , this.Y + 1, this.Z);
            }</pre>

Fragment 3 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X , this.Y + 1 , this.Z);
            }</pre>

Fragment 4 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X , this.Y + 1, this.Z);
            }</pre>

Fragment 5 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X , this.Y + 1, this.Z);
            }</pre>

Fragment 6 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X , this.Y + 1, this.Z);
            }</pre>

Fragment 7 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X, this.Y + 1, this.Z);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\Bascinet.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 5.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\CloseHelm.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 5.0;
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Armor\DragonHelm.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 5.0;
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Armor\Helmet.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 5.0;
        }</pre>

Fragment 5 in file Scripts\Items\Equipment\Armor\NorseHelm.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 5.0;
        }</pre>

Fragment 6 in file Scripts\Items\Equipment\Armor\PlateArms.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 5.0;
        }</pre>

Fragment 7 in file Scripts\Items\Equipment\Armor\PlateHelm.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 5.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialArms.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if(this.Hue != 2010)
                this.Hue = 2010;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialEarrings.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Hue != 2010)
                this.Hue = 2010;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialGloves.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Hue != 2010)
                this.Hue = 2010;
        }</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialGorget.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Hue != 2010)
                this.Hue = 2010;
        }</pre>

Fragment 5 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialHelm.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Hue != 2010)
                this.Hue = 2010;
        }</pre>

Fragment 6 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialKilt.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Hue != 2010)
                this.Hue = 2010;
        }</pre>

Fragment 7 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialLegs.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Hue != 2010)
                this.Hue = 2010;
        }</pre>

Fragment 8 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Bestial\BestialNecklace.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Hue != 2010)
                this.Hue = 2010;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\DecorativeWeapon.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X + 1, this.Y, this.Z);
            }</pre>

Fragment 2 in file Scripts\Items\Decorative\DecorativeWeapon.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X + 1, this.Y, this.Z);
            }</pre>

Fragment 3 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X + 1, this.Y , this.Z);
        }</pre>

Fragment 4 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X + 1, this.Y , this.Z);
        }</pre>

Fragment 5 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X + 1, this.Y , this.Z);
            }</pre>

Fragment 6 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X + 1, this.Y , this.Z);
            }</pre>

Fragment 7 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X + 1, this.Y , this.Z);
            }</pre>

Fragment 8 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X + 1, this.Y, this.Z);
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\DecorativeWeapon.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X , this.Y - 1 , this.Z);
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\DecorativeWeapon.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X , this.Y - 1 , this.Z);
        }</pre>

Fragment 3 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X , this.Y - 1 , this.Z);
        }</pre>

Fragment 4 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X , this.Y - 1, this.Z);
        }</pre>

Fragment 5 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X , this.Y - 1, this.Z);
        }</pre>

Fragment 6 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X , this.Y - 1, this.Z);
        }</pre>

Fragment 7 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X, this.Y - 1, this.Z);
            }</pre>

Fragment 8 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X, this.Y - 1, this.Z);
            }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\DecorativeWeapon.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X - 1, this.Y, this.Z);
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\DecorativeWeapon.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X - 1, this.Y, this.Z);
        }</pre>

Fragment 3 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X - 1, this.Y , this.Z);
            }</pre>

Fragment 4 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X - 1, this.Y , this.Z);
            }</pre>

Fragment 5 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X - 1, this.Y , this.Z);
        }</pre>

Fragment 6 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X - 1, this.Y , this.Z);
        }</pre>

Fragment 7 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
        {
            if (this.m_Item != null)
                this.m_Item.Location = new Point3D(this.X - 1, this.Y , this.Z);
        }</pre>

Fragment 8 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X - 1, this.Y, this.Z);
            }</pre>

Fragment 9 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void OnLocationChange(Point3D oldLocation)
            {
                if (this.m_Item != null)
                    this.m_Item.Location = new Point3D(this.X - 1, this.Y, this.Z);
            }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\HideGorget.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 2.0)
                this.Weight = 1.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\StuddedGloves.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 2.0)
                this.Weight = 1.0;
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Armor\StuddedGorget.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 2.0)
                this.Weight = 1.0;
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Clothing\Shirts.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 2.0)
                this.Weight = 1.0;
        }</pre>

Fragment 5 in file Scripts\Items\Equipment\Instruments\Tambourine.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 2.0)
                this.Weight = 1.0;
        }</pre>

Fragment 6 in file Scripts\Items\Equipment\Instruments\TambourineTassel.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 2.0)
                this.Weight = 1.0;
        }</pre>

Fragment 7 in file Scripts\Items\Equipment\Light\Torch.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 2.0)
                this.Weight = 1.0;
        }</pre>

Fragment 8 in file Scripts\Items\Tools\MapmakersPen.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 2.0)
                this.Weight = 1.0;
        }</pre>

Fragment 9 in file Scripts\Items\Tools\ScribesPen.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 2.0)
                this.Weight = 1.0;
        }</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTFGump.cs

<pre>XmlPoints.SendText(from, 100549, pm.Name);   // "You have added {0} to the challenge."

					XmlPoints.SendText(pm, 100550, m_gauntlet.Name); // "You have been invited to participate in {0}."

					// clear all acceptances
					m_gauntlet.ResetAcceptance();

					// refresh all gumps
					RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGump.cs

<pre>XmlPoints.SendText(from, 100549, pm.Name);   // "You have added {0} to the challenge."

                    XmlPoints.SendText(pm, 100550, m_gauntlet.Name); // "You have been invited to participate in {0}."

                    // clear all acceptances
                    m_gauntlet.ResetAcceptance();

                    // refresh all gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGump.cs

<pre>XmlPoints.SendText(from, 100549, pm.Name);   // "You have added {0} to the challenge."

                    XmlPoints.SendText(pm, 100550, m_gauntlet.Name); // "You have been invited to participate in {0}."

                    // clear all acceptances
                    m_gauntlet.ResetAcceptance();

                    // refresh all gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGump.cs

<pre>XmlPoints.SendText(from, 100549, pm.Name);   // "You have added {0} to the challenge."

                    XmlPoints.SendText(pm, 100550, m_gauntlet.Name); // "You have been invited to participate in {0}."

                    // clear all acceptances
                    m_gauntlet.ResetAcceptance();

                    // refresh all gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGump.cs

<pre>XmlPoints.SendText(from, 100549, pm.Name);   // "You have added {0} to the challenge."

                    XmlPoints.SendText(pm, 100550, m_gauntlet.Name); // "You have been invited to participate in {0}."

                    // clear all acceptances
                    m_gauntlet.ResetAcceptance();

                    // refresh all gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGump.cs

<pre>XmlPoints.SendText(from, 100549, pm.Name);   // "You have added {0} to the challenge."

                    XmlPoints.SendText(pm, 100550, m_gauntlet.Name); // "You have been invited to participate in {0}."

                    // clear all acceptances
                    m_gauntlet.ResetAcceptance();

                    // refresh all gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGump.cs

<pre>XmlPoints.SendText(from, 100549, pm.Name);   // "You have added {0} to the challenge."

                    XmlPoints.SendText(pm, 100550, m_gauntlet.Name); // "You have been invited to participate in {0}."

                    // clear all acceptances
                    m_gauntlet.ResetAcceptance();

                    // refresh all gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 8 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGump.cs

<pre>XmlPoints.SendText(from, 100549, pm.Name);   // "You have added {0} to the challenge."

                    XmlPoints.SendText(pm, 100550, m_gauntlet.Name); // "You have been invited to participate in {0}."

                    // clear all acceptances
                    m_gauntlet.ResetAcceptance();

                    // refresh all gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

Fragment 9 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGump.cs

<pre>XmlPoints.SendText(from, 100549, pm.Name);   // "You have added {0} to the challenge."

                    XmlPoints.SendText(pm, 100550, m_gauntlet.Name); // "You have been invited to participate in {0}."

                    // clear all acceptances
                    m_gauntlet.ResetAcceptance();

                    // refresh all gumps
                    RefreshAllGumps(m_gauntlet, true);</pre>

## Duplicated Code. Size: 76

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\DragonGloves.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\LeatherArms.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Armor\LeatherCap.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Armor\PlateGloves.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

Fragment 5 in file Scripts\Items\Equipment\Armor\RingmailGloves.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

Fragment 6 in file Scripts\Items\Equipment\Weapons\Cleaver.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

Fragment 7 in file Scripts\Items\Equipment\Weapons\GargishCleaver.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

Fragment 8 in file Scripts\Items\Equipment\Weapons\GargishKryss.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

Fragment 9 in file Scripts\Items\Equipment\Weapons\Kryss.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

Fragment 10 in file Scripts\Items\Tools\DovetailSaw.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

Fragment 11 in file Scripts\Items\Tools\FletcherTools.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

Fragment 12 in file Scripts\Items\Tools\JointingPlane.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (this.Weight == 1.0)
                this.Weight = 2.0;
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>{
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                messageString = this.m_Params[i].Substring(++indexOf);
                        }</pre>

Fragment 2 in file Scripts\Commands\Decorate.cs

<pre>{
                            int indexOf = this.m_Params[i].IndexOf('=');

                            if (indexOf >= 0)
                                messageString = this.m_Params[i].Substring(++indexOf);
                        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Extensions\Compilers\ConditionalCompiler.cs

<pre>case ComparisonOperator.Equal:
                        emitter.Compare(OpCodes.Ceq);
                        break;
                    case ComparisonOperator.NotEqual:
                        emitter.Compare(OpCodes.Ceq);
                        inverse = true;
                        break;
                    case ComparisonOperator.Greater:</pre>

Fragment 2 in file Scripts\Commands\Generic\Extensions\Compilers\ConditionalCompiler.cs

<pre>case ComparisonOperator.Equal:
                        emitter.Compare(OpCodes.Ceq);
                        break;
                    case ComparisonOperator.NotEqual:
                        emitter.Compare(OpCodes.Ceq);
                        inverse = true;
                        break;
                    case ComparisonOperator.Greater:</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\Food.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
		public string EngravedText
		{
			get { return this.m_EngravedText; }
			set
			{
				if (value != null)
					this.m_EngravedText = value;
				else
					this.m_EngravedText = string.Empty;
				this.InvalidateProperties();
			}
		}</pre>

Fragment 2 in file Scripts\Items\Containers\Container.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
		public string EngravedText
		{
			get { return this.m_EngravedText; }
			set
			{
				if (value != null)
					this.m_EngravedText = value;
				else
					this.m_EngravedText = string.Empty;
				this.InvalidateProperties();
			}
		}</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\CleanupTrashBarrel.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Cleanup = new List<CleanupArray>();
        }</pre>

Fragment 2 in file Scripts\Items\Containers\TrashChest.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Cleanup = new List<CleanupArray>();
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void Deserialize(GenericReader reader)
            {
                base.Deserialize(reader);

                int version = reader.ReadInt();

                this.m_Item = reader.ReadItem() as LargeForgeWest;
            }</pre>

Fragment 2 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void Deserialize(GenericReader reader)
            {
                base.Deserialize(reader);

                int version = reader.ReadInt();

                this.m_Item = reader.ReadItem() as LargeForgeWest;
            }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void Deserialize(GenericReader reader)
            {
                base.Deserialize(reader);

                int version = reader.ReadInt();

                this.m_Item = reader.ReadItem() as LargeForgeEast;
            }</pre>

Fragment 2 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void Deserialize(GenericReader reader)
            {
                base.Deserialize(reader);

                int version = reader.ReadInt();

                this.m_Item = reader.ReadItem() as LargeForgeEast;
            }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Internal\MorphItem.cs

<pre>bool found = false;

            foreach (Mobile mob in this.GetMobilesInRange(this.CurrentRange))
            {
                if (mob.Hidden && mob.IsStaff())
                    continue;

                found = true;
                break;
            }</pre>

Fragment 2 in file Scripts\Services\Khaldun\RaiseSwitch.cs

<pre>bool found = false;
            foreach (Mobile mob in this.GetMobilesInRange(this.CurrentRange))
            {
                if (mob.Hidden && mob.IsStaff())
                    continue;

                found = true;
                break;
            }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\BaseRunicTool.cs

<pre>int fire, phys, cold, nrgy, pois, chaos, direct;

            weapon.GetDamageTypes(null, out phys, out fire, out cold, out pois, out nrgy, out chaos, out direct);</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Bosses.cs

<pre>int phys, fire, cold, pois, nrgy, chaos, direct;
			weapon.GetDamageTypes(null, out phys, out fire, out cold, out pois, out nrgy, out chaos, out direct);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\CharacterCreation.cs

<pre>bool elf = (m.Race == Race.Elf);
            bool human = (m.Race == Race.Human);
            bool gargoyle = (m.Race == Race.Gargoyle);</pre>

Fragment 2 in file Scripts\Misc\CharacterCreation.cs

<pre>bool elf = (m.Race == Race.Elf);
            bool human = (m.Race == Race.Human);
            bool gargoyle = (m.Race == Race.Gargoyle);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>{
					string args = String.Format("{0}\t{1}\t ", to.Name, from.Name);

					from.SendLocalizedMessage(1043250, args);
					// The pet refuses to be transferred because it will not obey you sufficiently.~3_BLANK~
					to.SendLocalizedMessage(1043251, args);
					// The pet will not accept you as a master because it does not trust ~2_NAME~.~3_BLANK~
				}</pre>

Fragment 2 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>{
					string args = String.Format("{0}\t{1}\t ", to.Name, from.Name);

					from.SendLocalizedMessage(1043250, args);
					// The pet refuses to be transferred because it will not obey you sufficiently.~3_BLANK~
					to.SendLocalizedMessage(1043251, args);
					// The pet will not accept you as a master because it does not trust ~2_NAME~.~3_BLANK~
				}</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\MageAI.cs

<pre>double delay;

            if (this.m_Mobile.Int >= 500)
                delay = Utility.RandomMinMax(7, 10);
            else
                delay = Math.Sqrt(600 - this.m_Mobile.Int);</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>double delay;

            if (this.m_Mobile.Int >= 500)
                delay = Utility.RandomMinMax(7, 10);
            else
                delay = Math.Sqrt(600 - this.m_Mobile.Int);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\AncientLichRenowned.cs

<pre>this.SetSkill(SkillName.MagicResist, 175.2, 200.0);
            this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 75.1, 100.0);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\TheMasterInstructor.cs

<pre>this.SetSkill(SkillName.MagicResist, 175.2, 200.0);
            this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 75.1, 100.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Guile.cs

<pre>this.SetStam(243, 367);
            this.SetMana(369, 586);

            this.SetDamage(14, 20);

            this.SetDamageType(ResistanceType.Physical, 100);</pre>

Fragment 2 in file Scripts\Mobiles\Named\Spite.cs

<pre>this.SetStam(243, 367);
            this.SetMana(369, 586);

            this.SetDamage(14, 20);

            this.SetDamageType(ResistanceType.Physical, 100);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Guile.cs

<pre>this.SetSkill(SkillName.Wrestling, 12.8, 16.7);
            this.SetSkill(SkillName.Tactics, 102.6, 131.0);
            this.SetSkill(SkillName.MagicResist, 141.2, 161.6);</pre>

Fragment 2 in file Scripts\Mobiles\Named\Spite.cs

<pre>this.SetSkill(SkillName.Wrestling, 12.8, 16.7);
            this.SetSkill(SkillName.Tactics, 102.6, 131.0);
            this.SetSkill(SkillName.MagicResist, 141.2, 161.6);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\MasterTheophilus.cs

<pre>this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 50, 60);
            this.SetResistance(ResistanceType.Energy, 50, 60);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\VeriteElemental.cs

<pre>this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 50, 60);
            this.SetResistance(ResistanceType.Energy, 50, 60);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\SkeletalDragonRenowned.cs

<pre>this.SetInt(488, 620);

            this.SetHits(558, 599);

            this.SetDamage(29, 35);

            this.SetDamageType(ResistanceType.Physical, 75);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ShadowWyrm.cs

<pre>this.SetInt(488, 620);

            this.SetHits(558, 599);

            this.SetDamage(29, 35);

            this.SetDamageType(ResistanceType.Physical, 75);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Twaulo.cs

<pre>this.SetResistance(ResistanceType.Physical, 65, 75);
            this.SetResistance(ResistanceType.Fire, 45, 55);
            this.SetResistance(ResistanceType.Cold, 50, 60);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ShadowWyrm.cs

<pre>this.SetResistance(ResistanceType.Physical, 65, 75);
            this.SetResistance(ResistanceType.Fire, 50, 60);
            this.SetResistance(ResistanceType.Cold, 45, 55);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\AgapiteElemental.cs

<pre>this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 10, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Reaper.cs

<pre>this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\AirElemental.cs

<pre>this.SetResistance(ResistanceType.Fire, 15, 25);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 10, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\EarthElemental.cs

<pre>this.SetResistance(ResistanceType.Fire, 10, 20);
            this.SetResistance(ResistanceType.Cold, 10, 20);
            this.SetResistance(ResistanceType.Poison, 15, 25);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\AncientWyrm.cs

<pre>this.SetSkill(SkillName.EvalInt, 80.1, 100.0);
            this.SetSkill(SkillName.Magery, 80.1, 100.0);
            this.SetSkill(SkillName.Meditation, 52.5, 75.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ShadowWyrm.cs

<pre>this.SetSkill(SkillName.EvalInt, 80.1, 100.0);
            this.SetSkill(SkillName.Magery, 80.1, 100.0);
            this.SetSkill(SkillName.Meditation, 52.5, 75.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ArcaneDaemon.cs

<pre>this.SetSkill(SkillName.MagicResist, 85.1, 95.0);
            this.SetSkill(SkillName.Tactics, 70.1, 80.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 80.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DragonsFlameMage.cs

<pre>this.SetSkill(SkillName.MagicResist, 85.1, 95.0);
            this.SetSkill(SkillName.Tactics, 70.1, 80.0);
            this.SetSkill(SkillName.Wrestling, 60.1, 80.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BakeKitsune.cs

<pre>case 0:
                    this.AddItem(new Shoes(Utility.RandomNeutralHue()));
                    break;
                case 1:
                    this.AddItem(new Boots(Utility.RandomNeutralHue()));</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HireFighter.cs

<pre>case 0:
                    this.AddItem(new Shoes(Utility.RandomNeutralHue()));
                    break;
                case 1:
                    this.AddItem(new Boots(Utility.RandomNeutralHue()));</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BogThing.cs

<pre>this.SetResistance(ResistanceType.Cold, 10, 15);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 20, 25);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Scorpion.cs

<pre>this.SetResistance(ResistanceType.Cold, 20, 25);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 10, 15);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BronzeElemental.cs

<pre>this.SetResistance(ResistanceType.Physical, 30, 40);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 10, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DullCopperElemental.cs

<pre>this.SetResistance(ResistanceType.Physical, 30, 40);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 10, 20);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\CrystalLatticeSeeker.cs

<pre>this.SetSkill(SkillName.MagicResist, 90.0, 100.0);
            this.SetSkill(SkillName.Tactics, 90.0, 100.0);
            this.SetSkill(SkillName.Wrestling, 90.0, 100.0);</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionMercenary.cs

<pre>this.SetSkill(SkillName.Wrestling, 90.0, 100.0);
            this.SetSkill(SkillName.Tactics, 90.0, 100.0);
            this.SetSkill(SkillName.MagicResist, 90.0, 100.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DarkWisp.cs

<pre>this.SetResistance(ResistanceType.Fire, 20, 40);
            this.SetResistance(ResistanceType.Cold, 10, 30);
            this.SetResistance(ResistanceType.Poison, 5, 10);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SnowLeopard.cs

<pre>this.SetResistance(ResistanceType.Fire, 5, 10);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 10, 20);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\DireWolf.cs

<pre>this.SetResistance(ResistanceType.Fire, 10, 20);
            this.SetResistance(ResistanceType.Cold, 5, 10);
            this.SetResistance(ResistanceType.Poison, 5, 10);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Lizardman.cs

<pre>this.SetResistance(ResistanceType.Fire, 5, 10);
            this.SetResistance(ResistanceType.Cold, 5, 10);
            this.SetResistance(ResistanceType.Poison, 10, 20);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Drake.cs

<pre>this.SetSkill(SkillName.MagicResist, 65.1, 80.0);
            this.SetSkill(SkillName.Tactics, 65.1, 90.0);
            this.SetSkill(SkillName.Wrestling, 65.1, 80.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Wyvern.cs

<pre>this.SetSkill(SkillName.MagicResist, 65.1, 80.0);
            this.SetSkill(SkillName.Tactics, 65.1, 90.0);
            this.SetSkill(SkillName.Wrestling, 65.1, 80.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ElderGazer.cs

<pre>this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\MinotaurCaptain.cs

<pre>this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 40, 50);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\EvilMage.cs

<pre>this.SetSkill(SkillName.MagicResist, 75.0, 97.5);
            this.SetSkill(SkillName.Tactics, 65.0, 87.5);
            this.SetSkill(SkillName.Wrestling, 20.2, 60.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\StoneMonster.cs

<pre>this.SetSkill(SkillName.MagicResist, 75.0, 97.5);
                this.SetSkill(SkillName.Tactics, 65.0, 87.5);
                this.SetSkill(SkillName.Wrestling, 20.2, 60.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\EvilMageLord.cs

<pre>this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GoldenElemental.cs

<pre>this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ExodusMinion.cs

<pre>this.SetSkill(SkillName.MagicResist, 90.1, 100.0);
            this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 90.1, 100.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\KhaldunSummoner.cs

<pre>this.SetSkill(SkillName.Wrestling, 90.1, 100.0);
            this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.MagicResist, 90.1, 100.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\FeralTreefellow.cs

<pre>this.SetSkill(SkillName.MagicResist, 40.1, 55.0);// Unknown
            this.SetSkill(SkillName.Tactics, 65.1, 90.0);// Unknown
            this.SetSkill(SkillName.Wrestling, 65.1, 85.0);// Unknown</pre>

Fragment 2 in file Scripts\Mobiles\Normal\TreefellowGuardian.cs

<pre>this.SetSkill(SkillName.MagicResist, 40.1, 55.0);
            this.SetSkill(SkillName.Tactics, 65.1, 90.0);
            this.SetSkill(SkillName.Wrestling, 65.1, 85.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\FireSteed.cs

<pre>this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\Djinn.cs

<pre>this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 30, 40);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ForgottenServant.cs

<pre>this.SetSkill(SkillName.MagicResist, 70.1, 85.0);
            this.SetSkill(SkillName.Swords, 60.1, 85.0);
            this.SetSkill(SkillName.Tactics, 75.1, 90.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\StoneMonster.cs

<pre>this.SetSkill(SkillName.MagicResist, 70.1, 85.0);
                this.SetSkill(SkillName.Swords, 60.1, 85.0);
                this.SetSkill(SkillName.Tactics, 75.1, 90.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\FrostSpider.cs

<pre>this.SetSkill(SkillName.MagicResist, 25.1, 40.0);
            this.SetSkill(SkillName.Tactics, 35.1, 50.0);
            this.SetSkill(SkillName.Wrestling, 50.1, 65.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GiantSpider.cs

<pre>this.SetSkill(SkillName.MagicResist, 25.1, 40.0);
            this.SetSkill(SkillName.Tactics, 35.1, 50.0);
            this.SetSkill(SkillName.Wrestling, 50.1, 65.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Gazer.cs

<pre>this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 10, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ToxicElemental.cs

<pre>this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 10, 20);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GiantIceWorm.cs

<pre>this.SetResistance(ResistanceType.Cold, 80, 90);
            this.SetResistance(ResistanceType.Poison, 15, 25);
            this.SetResistance(ResistanceType.Energy, 10, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\IceSerpent.cs

<pre>this.SetResistance(ResistanceType.Cold, 80, 90);
            this.SetResistance(ResistanceType.Poison, 15, 25);
            this.SetResistance(ResistanceType.Energy, 10, 20);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\IceElemental.cs

<pre>this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 20, 30);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\PestilentBandage.cs

<pre>this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 20, 30);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Imp.cs

<pre>this.SetSkill(SkillName.MagicResist, 30.1, 50.0);
            this.SetSkill(SkillName.Tactics, 42.1, 50.0);
            this.SetSkill(SkillName.Wrestling, 40.1, 44.0);</pre>

Fragment 2 in file Scripts\Spells\Spellweaving\Mobiles\ArcaneFiend.cs

<pre>this.SetSkill(SkillName.MagicResist, 30.1, 50.0);
            this.SetSkill(SkillName.Tactics, 42.1, 50.0);
            this.SetSkill(SkillName.Wrestling, 40.1, 44.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\IronBeetle.cs

<pre>this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 30, 40);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SpectralArmour.cs

<pre>this.SetResistance(ResistanceType.Fire, 20, 30);
            this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 20, 30);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\JukaMage.cs

<pre>this.SetResistance(ResistanceType.Physical, 20, 30);
            this.SetResistance(ResistanceType.Fire, 35, 45);
            this.SetResistance(ResistanceType.Cold, 30, 40);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Wyvern.cs

<pre>this.SetResistance(ResistanceType.Physical, 35, 45);
            this.SetResistance(ResistanceType.Fire, 30, 40);
            this.SetResistance(ResistanceType.Cold, 20, 30);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\MeerWarrior.cs

<pre>this.SetResistance(ResistanceType.Cold, 30, 40);
            this.SetResistance(ResistanceType.Poison, 25, 35);
            this.SetResistance(ResistanceType.Energy, 25, 35);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\StoneMonster.cs

<pre>this.SetResistance(ResistanceType.Cold, 25, 35);
                this.SetResistance(ResistanceType.Poison, 30, 40);
                this.SetResistance(ResistanceType.Energy, 25, 35);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\PatchworkSkeleton.cs

<pre>this.SetResistance(ResistanceType.Energy, 40, 50);

            this.SetSkill(SkillName.MagicResist, 70.1, 95.0);
            this.SetSkill(SkillName.Tactics, 55.1, 80.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\VampireBat.cs

<pre>this.SetResistance(ResistanceType.Energy, 40, 50);

            this.SetSkill(SkillName.MagicResist, 70.1, 95.0);
            this.SetSkill(SkillName.Tactics, 55.1, 80.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\PlagueBeast.cs

<pre>this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 25, 35);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\PlagueBeastLord.cs

<pre>this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 40, 50);
            this.SetResistance(ResistanceType.Cold, 25, 35);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\RatmanArcher.cs

<pre>this.SetSkill(SkillName.MagicResist, 65.1, 90.0);
            this.SetSkill(SkillName.Tactics, 50.1, 75.0);
            this.SetSkill(SkillName.Wrestling, 50.1, 75.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\RatmanMage.cs

<pre>this.SetSkill(SkillName.MagicResist, 65.1, 90.0);
            this.SetSkill(SkillName.Tactics, 50.1, 75.0);
            this.SetSkill(SkillName.Wrestling, 50.1, 75.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\SerpentineDragon.cs

<pre>this.SetResistance(ResistanceType.Cold, 25, 35);
            this.SetResistance(ResistanceType.Poison, 25, 35);
            this.SetResistance(ResistanceType.Energy, 25, 35);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusSentinel.cs

<pre>this.SetResistance(ResistanceType.Cold, 25, 35);
            this.SetResistance(ResistanceType.Poison, 25, 35);
            this.SetResistance(ResistanceType.Energy, 25, 35);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ValoriteElemental.cs

<pre>this.SetResistance(ResistanceType.Fire, 50, 60);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 50, 60);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\WrongDungeon\Mobile\BrigandCannibalMage.cs

<pre>this.SetResistance(ResistanceType.Fire, 50, 60);
            this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 50, 60);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Ahie.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(Kilt), "kilts", 10, 0x1537));

            this.AddReward(new BaseReward(typeof(TailorsCraftsmanSatchel), 1074282));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Tallinin.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(Kilt), "kilts", 10, 0x1537));

            this.AddReward(new BaseReward(typeof(TailorsCraftsmanSatchel), 1074282));
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Ahie.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(FlowerGarland), "flower garlands", 10, 0x2306));

            this.AddReward(new BaseReward(typeof(TailorsCraftsmanSatchel), 1074282));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Tallinin.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(FlowerGarland), "flower garlands", 10, 0x2306));

            this.AddReward(new BaseReward(typeof(TailorsCraftsmanSatchel), 1074282));
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Aniel.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(FootStool), "foot stools", 10, 0xB5E));

            this.AddReward(new BaseReward(typeof(CarpentersCraftsmanSatchel), 1074282));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Danoel.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(FootStool), "foot stools", 10, 0xB5E));

            this.AddReward(new BaseReward(typeof(CarpentersCraftsmanSatchel), 1074282));
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\AttendantGuide.cs

<pre>{
                        temp = this.m_List[parent];
                        this.m_List[parent] = this.m_List[lchild];
                        this.m_List[lchild] = temp;

                        parent = lchild;
                    }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\AttendantGuide.cs

<pre>{
                        temp = this.m_List[parent];
                        this.m_List[parent] = this.m_List[lchild];
                        this.m_List[lchild] = temp;

                        parent = lchild;
                    }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\AttendantGuide.cs

<pre>{
                        temp = this.m_List[parent];
                        this.m_List[parent] = this.m_List[rchild];
                        this.m_List[rchild] = temp;

                        parent = rchild;
                    }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\AttendantGuide.cs

<pre>{
                        temp = this.m_List[parent];
                        this.m_List[parent] = this.m_List[rchild];
                        this.m_List[rchild] = temp;

                        parent = rchild;
                    }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\BaseEscortable.cs

<pre>{
                        if (gainedPath)
                            pm.SendLocalizedMessage(1053005); // You have achieved a path in compassion!
                        else
                            pm.SendLocalizedMessage(1053002); // You have gained in compassion.

                        pm.NextCompassionDay = DateTime.UtcNow + TimeSpan.FromDays(1.0); // in one day CompassionGains gets reset to 0
                        ++pm.CompassionGains;
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseEscortable.cs

<pre>{
						if ( gainedPath )
							pm.SendLocalizedMessage( 1053005 ); // You have achieved a path in compassion!
						else
							pm.SendLocalizedMessage( 1053002 ); // You have gained in compassion.

						pm.NextCompassionDay = DateTime.UtcNow + TimeSpan.FromDays( 1.0 ); // in one day CompassionGains gets reset to 0
						++pm.CompassionGains;
					}</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Beotham.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(Bow), "bows", 10, 0x13B2));

            this.AddReward(new BaseReward(typeof(FletcherCraftsmanSatchel), 1074282));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Cillitha.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(Bow), "bows", 10, 0x13B2));

            this.AddReward(new BaseReward(typeof(FletcherCraftsmanSatchel), 1074282));
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Beotham.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(Crossbow), "crossbows", 10, 0xF50));

            this.AddReward(new BaseReward(typeof(FletcherCraftsmanSatchel), 1074282));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Cillitha.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(Crossbow), "crossbows", 10, 0xF50));

            this.AddReward(new BaseReward(typeof(FletcherCraftsmanSatchel), 1074282));
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Dallid.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(FancyWindChimes), "fancy wind chimes", 10, 0x2833));

            this.AddReward(new BaseReward(typeof(TinkersCraftsmanSatchel), 1074282));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Tholef.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(FancyWindChimes), "fancy wind chimes", 10, 0x2833));

            this.AddReward(new BaseReward(typeof(TinkersCraftsmanSatchel), 1074282));
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Danoel.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(Broadsword), "broadswords", 12, 0xF5E));

            this.AddReward(new BaseReward(typeof(SmithsCraftsmanSatchel), 1074282));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Lohn.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(Broadsword), "broadswords", 12, 0xF5E));

            this.AddReward(new BaseReward(typeof(SmithsCraftsmanSatchel), 1074282));
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Danoel.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(HeaterShield), "heater shields", 10, 0x1B76));

            this.AddReward(new BaseReward(typeof(SmithsCraftsmanSatchel), 1074282));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Lohn.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(HeaterShield), "heater shields", 10, 0x1B76));

            this.AddReward(new BaseReward(typeof(SmithsCraftsmanSatchel), 1074282));
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Danoel.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(TinkerTools), "tinker's tools", 10, 0x1EB8));

            this.AddReward(new BaseReward(typeof(TinkersCraftsmanSatchel), 1074282));
        }</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Sleen.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(TinkerTools), "tinker's tools", 10, 0x1EB8));

            this.AddReward(new BaseReward(typeof(TinkersCraftsmanSatchel), 1074282));
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\EvilHealer.cs

<pre>this.SetSkill(SkillName.Forensics, 80.0, 100.0);
            this.SetSkill(SkillName.SpiritSpeak, 80.0, 100.0);
            this.SetSkill(SkillName.Swords, 80.0, 100.0);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Healer.cs

<pre>this.SetSkill(SkillName.Forensics, 80.0, 100.0);
            this.SetSkill(SkillName.SpiritSpeak, 80.0, 100.0);
            this.SetSkill(SkillName.Swords, 80.0, 100.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Void Creatures\UsagralemBallem.cs

<pre>this.SetSkill(SkillName.MagicResist, 80.0, 90.0);
            this.SetSkill(SkillName.Tactics, 80.0, 90.0);
            this.SetSkill(SkillName.Wrestling, 80.0, 90.0);</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionHenchman.cs

<pre>this.SetSkill(SkillName.Wrestling, 80.0, 90.0);
            this.SetSkill(SkillName.Tactics, 80.0, 90.0);
            this.SetSkill(SkillName.MagicResist, 80.0, 90.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\HouseFoundation.cs

<pre>int itemID = pvSrc.ReadInt32();
                int x = pvSrc.ReadInt32();
                int y = pvSrc.ReadInt32();

                // Validate stair multi ID
                DesignState design = context.Foundation.DesignState;</pre>

Fragment 2 in file Scripts\Multis\HouseFoundation.cs

<pre>int itemID = pvSrc.ReadInt32();
                int x = pvSrc.ReadInt32();
                int y = pvSrc.ReadInt32();

                // Add component
                DesignState design = context.Foundation.DesignState;</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\Books\BOBGump.cs

<pre>(pack == null) || ((pack != null) && (!pack.CheckHold(this.m_From, item, true, true, 0, item.PileWeight + item.TotalWeight)))</pre>

Fragment 2 in file Scripts\Services\BulkOrders\Books\BODBuyGump.cs

<pre>(pack == null) || ((pack != null) && (!pack.CheckHold(this.m_From, item, true, true, 0, item.PileWeight + item.TotalWeight)))</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\BulkOrders\SmallSmithBOD.cs

<pre>this.AmountMax = amountMax;
            this.Type = entry.Type;
            this.Number = entry.Number;
            this.Graphic = entry.Graphic;
            this.RequireExceptional = reqExceptional;
            this.Material = material;</pre>

Fragment 2 in file Scripts\Services\BulkOrders\SmallTailorBOD.cs

<pre>this.AmountMax = amountMax;
            this.Type = entry.Type;
            this.Number = entry.Number;
            this.Graphic = entry.Graphic;
            this.RequireExceptional = reqExceptional;
            this.Material = material;</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefMasonry.cs

<pre>SetNeededExpansion(index, Expansion.TOL);

                index = AddCraft(typeof(CraftableHouseAddonDeed), 1155877, 1155821, 60.0, 110.0, typeof(Granite), 1044514, 5, 1044513);</pre>

Fragment 2 in file Scripts\Services\Craft\DefMasonry.cs

<pre>SetNeededExpansion(index, Expansion.TOL);

                index = AddCraft(typeof(CraftableHouseAddonDeed), 1155877, 1155821, 60.0, 110.0, typeof(Granite), 1044514, 5, 1044513);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(HeatingStand), 1011224, 4, 1044253);
            AddRes(index, typeof(CopperWire), 1026265, 1, 1044253);
            ForceNonExceptional(index);</pre>

Fragment 2 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(HeatingStand), 1011224, 4, 1044253);
            AddRes(index, typeof(CopperWire), 1026265, 1, 1044253);
            ForceNonExceptional(index);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Doom\LeverPuzzleItems.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();
            this.m_Controller = reader.ReadItem() as LeverPuzzleController;
        }</pre>

Fragment 2 in file Scripts\Services\Doom\LeverPuzzleItems.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();
            this.m_Controller = reader.ReadItem() as LeverPuzzleController;
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Items\CorgulAltar.cs

<pre>m_DeadLine = reader.ReadDateTime();
                        m_Boss = reader.ReadMobile();
                        m_Activated = reader.ReadBool();
                        m_Active = reader.ReadBool();
                        m_WarpPoint = reader.ReadPoint3D();</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\CorgulAltar.cs

<pre>m_DeadLine = reader.ReadDateTime();
                        m_Boss = reader.ReadMobile();
                        m_Activated = reader.ReadBool();
                        m_Active = reader.ReadBool();
                        m_WarpPoint = reader.ReadPoint3D();</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\MerchantCrew.cs

<pre>SetStr(100, 125);
            SetDex(125, 150);
            SetInt(250, 400);
            SetHits(250, 400);
            SetDamage(15, 25);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Quests\ProfessionalBountyQuest\Mobiles\PirateCrew.cs

<pre>SetStr(100, 125);
            SetDex(125, 150);
            SetInt(250, 400);
            SetHits(250, 400);
            SetDamage(15, 25);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\CommodityBrokerGump.cs

<pre>int perPage = 10;

			if(index > -1)
				m_Page = index <= 0 ? 0 : index / perPage;

			int start = page * perPage;
            int count = 1;</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\CommodityBrokerGump.cs

<pre>int perPage = 10;

			if(index > -1)
				m_Page = index <= 0 ? 0 : index / perPage;

			int start = page * perPage;
			int count = 1;</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Peerless\BasePeerless.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Altar = reader.ReadItem() as PeerlessAltar;
        }</pre>

Fragment 2 in file Scripts\Services\Peerless\PeerlessTeleporter.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Altar = reader.ReadItem() as PeerlessAltar;
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusJuggernaut.cs

<pre>this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusMinionLord.cs

<pre>this.SetResistance(ResistanceType.Cold, 20, 30);
            this.SetResistance(ResistanceType.Poison, 30, 40);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\StaffRunebook\Rune.cs

<pre>if (rune.IsRunebook)
            {
                this.Runes.Insert(this.RunebookCount, rune);
                this.RunebookCount++;
            }
            else
            {
                this.Runes.Add(rune);
                this.RuneCount++;
            }</pre>

Fragment 2 in file Scripts\Services\StaffRunebook\RuneAccount.cs

<pre>if (rune.IsRunebook)
            {
                this.Runes.Insert(this.RunebookCount, rune);
                this.RunebookCount++;
            }
            else
            {
                this.Runes.Add(rune);
                this.RuneCount++;
            }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (result != "Property has been set.")
								{
									status_str = arglist[0] + " : " + result;
									no_error = false;
								}
								if (arglist.Length < 3) break;
								remainder = arglist[2];</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (result != "Property has been set.")
								{
									status_str = arglist[0] + " : " + result;
									no_error = false;
								}
								if (arglist.Length < 3) break;
								remainder = arglist[2];</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlAddFaction.cs

<pre>if (list != null && list.Count > 0)
                    {
                        foreach (XmlMobFactions x in list)
                        {
                            x.SetFactionLevel(g, x.GetFactionLevel(g) + this.Value);
                        }
                    }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlAddFaction.cs

<pre>if (list != null && list.Count > 0)
                {
                    foreach (XmlMobFactions x in list)
                    {
                        x.SetFactionLevel(g, x.GetFactionLevel(g) + this.Value);
                    }
                }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
		public TimeSpan ExpiresIn
		{
			get
			{
				if (m_ExpirationDuration > 0)
				{
					// if this is a player created quest, then refresh the expiration time until it is in someone elses possession
					/*
					 if(PlayerMade && ((Owner == Creator) || (Owner == null)))
					 {
						 m_TimeCreated = DateTime.UtcNow;
					 }
					 */
					return (m_TimeCreated + TimeSpan.FromHours(m_ExpirationDuration) - DateTime.UtcNow);
				}
				else
				{
					return TimeSpan.FromHours(0);
				}
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public TimeSpan ExpiresIn
        {
            get
            {
                if (m_ExpirationDuration > 0)
                {
                    // if this is a player created quest, then refresh the expiration time until it is in someone elses possession
                    /*
                     if(PlayerMade && ((Owner == Creator) || (Owner == null)))
                     {
                         m_TimeCreated = DateTime.UtcNow;
                     }
                     */
                    return (m_TimeCreated + TimeSpan.FromHours(m_ExpirationDuration) - DateTime.UtcNow);
                }
                else
                {
                    return TimeSpan.FromHours(0);
                }
            }
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolderGumps.cs

<pre>int collected = 0;
                            try
                            {
                                collected = int.Parse(statestr);
                            }
                            catch { }

                            int remaining = targetcount - collected;

                            if (remaining < 0) remaining = 0;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolderGumps.cs

<pre>int collected = 0;

                                try
                                {
                                    collected = int.Parse(statestr);
                                }
                                catch { }

                                int remaining = targetcount - collected;

                                if (remaining < 0) remaining = 0;</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlAdd.cs

<pre>Account acct = from.Account as Account;
				if(acct != null)
					defs = XmlSpawnerDefaults.GetDefaults(acct.ToString(), from.Name);

			if(defs == null) return;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlAdd.cs

<pre>Account acct = from.Account as Account;
			if (acct != null)
				defs = XmlSpawnerDefaults.GetDefaults(acct.ToString(), from.Name);

			if (defs == null) return;</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlMobFactions\MobFactionRegionStone.cs

<pre>Rectangle2D[] area = new Rectangle2D[count];
								for (int i = 0; i < count; i++)
								{
									area[i] = reader.ReadRect2D();
								}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeRegionStone.cs

<pre>Rectangle2D[] area = new Rectangle2D[count];
								for (int i = 0; i < count; i++)
								{
									area[i] = reader.ReadRect2D();
								}</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGauntlet.cs

<pre>writer.Write(entry.Participant);
                    writer.Write(entry.Status.ToString());
                    writer.Write(entry.Accepted);
                    writer.Write(entry.PageBeingViewed);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGauntlet.cs

<pre>writer.Write(entry.Participant);
                    writer.Write(entry.Status.ToString());
                    writer.Write(entry.Accepted);
                    writer.Write(entry.PageBeingViewed);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\EnglishText.cs

<pre>Add(200600, "Team KotH Challenge");
            Add(200601, "KotH Team Status");
            Add(200610, "Team LMS Challenge");
            Add(200611, "LMS Team Status");
            Add(200620, "Capture the Flag Challenge");</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\SpanishText.cs

<pre>Add(200600, "Team KotH Challenge");
            Add(200601, "KotH Team Status");
            Add(200610, "Team LMS Challenge");
            Add(200611, "LMS Team Status");
            Add(200620, "Capture the Flag Challenge");</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Mining.cs

<pre>if (from.Mounted)
            {
                from.SendLocalizedMessage(501864); // You can't mine while riding.
                return false;
            }
            else if (from.IsBodyMod && !from.Body.IsHuman)
            {
                from.SendLocalizedMessage(501865); // You can't mine while polymorphed.
                return false;
            }</pre>

Fragment 2 in file Scripts\Skills\Mining.cs

<pre>if (from.Mounted)
            {
                from.SendLocalizedMessage(501864); // You can't mine while riding.
                return false;
            }
            else if (from.IsBodyMod && !from.Body.IsHuman)
            {
                from.SendLocalizedMessage(501865); // You can't mine while polymorphed.
                return false;
            }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Server\Item.cs

<pre>if (Parent is Mobile)
            {
                ((Mobile)Parent).RemoveItem(this);
            }
            else if (Parent is Item)
            {
                ((Item)Parent).RemoveItem(this);
            }</pre>

Fragment 2 in file Server\Item.cs

<pre>if (Parent is Mobile)
            {
                ((Mobile)Parent).RemoveItem(this);
            }
            else if (Parent is Item)
            {
                ((Item)Parent).RemoveItem(this);
            }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketReader.cs

<pre>int bound = m_Index + fixedLength;
			int end = bound;

			if (bound > m_Size)
			{
				bound = m_Size;
			}

			StringBuilder sb = new StringBuilder();

			int c;</pre>

Fragment 2 in file Server\Network\PacketReader.cs

<pre>int bound = m_Index + fixedLength;
			int end = bound;

			if (bound > m_Size)
			{
				bound = m_Size;
			}

			StringBuilder sb = new StringBuilder();

			int c;</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Ultima\FileIndex.cs

<pre>Stream = new FileStream(MulPath, FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite);
					var count = (int)(index.Length / 12);
					IdxLength = index.Length;</pre>

Fragment 2 in file Ultima\FileIndex.cs

<pre>Stream = new FileStream(MulPath, FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite);
					var count = (int)(index.Length / 12);
					IdxLength = index.Length;</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Ultima\Multis.cs

<pre>index = binbin.ReadInt32();
											x = binbin.ReadInt32();
											y = binbin.ReadInt32();
											z = binbin.ReadInt32();
											level = binbin.ReadInt32();</pre>

Fragment 2 in file Ultima\Multis.cs

<pre>index = binbin.ReadInt32();
											x = binbin.ReadInt32();
											y = binbin.ReadInt32();
											z = binbin.ReadInt32();
											level = binbin.ReadInt32();</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Ultima\Multis.cs

<pre>for (int j = newtiles.Count - 1; j >= 0; --j) // remove all invis items
					{
						if (newtiles[j].m_ItemID == 0x1)
						{
							newtiles.RemoveAt(j);
						}
					}</pre>

Fragment 2 in file Ultima\Multis.cs

<pre>for (int j = newtiles.Count - 1; j >= 0; --j) // nothing found so remove all invis
			{
				if (newtiles[j].m_ItemID == 0x1)
				{
					newtiles.RemoveAt(j);
				}
			}</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Ultima\TileMatrix.cs

<pre>{
			if (m_Map != null)
			{
				m_Map.Close();
			}

			if (m_UOPReader != null)
			{
				m_UOPReader.Close();
			}

			if (m_Statics != null)
			{
				m_Statics.Close();
			}
		}</pre>

Fragment 2 in file Ultima\TileMatrix.cs

<pre>{
			if (m_Map != null)
			{
				m_Map.Close();
			}

			if (m_UOPReader != null)
			{
				m_UOPReader.Close();
			}

			if (m_Statics != null)
			{
				m_Statics.Close();
			}
		}</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>int strBonus = this.ComputeStatBonus(StatType.Str);
            int dexBonus = this.ComputeStatBonus(StatType.Dex);
            int intBonus = this.ComputeStatBonus(StatType.Int);</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\BaseArmor.cs

<pre>int strBonus = this.ComputeStatBonus(StatType.Str);
            int dexBonus = this.ComputeStatBonus(StatType.Dex);
            int intBonus = this.ComputeStatBonus(StatType.Int);</pre>

Fragment 3 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>int strBonus = this.ComputeStatBonus(StatType.Str);
            int dexBonus = this.ComputeStatBonus(StatType.Dex);
            int intBonus = this.ComputeStatBonus(StatType.Int);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\AcidElementalRenowned.cs

<pre>this.SetResistance(ResistanceType.Cold, 20, 40);
            this.SetResistance(ResistanceType.Poison, 10, 30);
            this.SetResistance(ResistanceType.Energy, 20, 50);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\FrostOoze.cs

<pre>this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 10, 20);</pre>

Fragment 3 in file Scripts\Mobiles\Normal\FrostSpider.cs

<pre>this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 20, 30);
            this.SetResistance(ResistanceType.Energy, 10, 20);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Alligator.cs

<pre>this.SetSkill(SkillName.MagicResist, 25.1, 40.0);
            this.SetSkill(SkillName.Tactics, 40.1, 60.0);
            this.SetSkill(SkillName.Wrestling, 40.1, 60.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\BullFrog.cs

<pre>this.SetSkill(SkillName.MagicResist, 25.1, 40.0);
            this.SetSkill(SkillName.Tactics, 40.1, 60.0);
            this.SetSkill(SkillName.Wrestling, 40.1, 60.0);</pre>

Fragment 3 in file Scripts\Mobiles\Normal\GiantToad.cs

<pre>this.SetSkill(SkillName.MagicResist, 25.1, 40.0);
            this.SetSkill(SkillName.Tactics, 40.1, 60.0);
            this.SetSkill(SkillName.Wrestling, 40.1, 60.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Corpser.cs

<pre>this.SetSkill(SkillName.MagicResist, 15.1, 20.0);
            this.SetSkill(SkillName.Tactics, 45.1, 60.0);
            this.SetSkill(SkillName.Wrestling, 45.1, 60.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Kraken.cs

<pre>this.SetSkill(SkillName.MagicResist, 15.1, 20.0);
            this.SetSkill(SkillName.Tactics, 45.1, 60.0);
            this.SetSkill(SkillName.Wrestling, 45.1, 60.0);</pre>

Fragment 3 in file Scripts\Mobiles\Normal\TanglingRoots.cs

<pre>this.SetSkill(SkillName.MagicResist, 15.1, 20.0);
            this.SetSkill(SkillName.Tactics, 45.1, 60.0);
            this.SetSkill(SkillName.Wrestling, 45.1, 60.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Underworld\Maze of Death\UnderworldPuzzle.cs

<pre>switch (movingIntoCol)
                    {
                        case PuzzleColor.Red:
                            return PuzzlePiece.RedSingle + combined;
                        case PuzzleColor.Blue:
                            return PuzzlePiece.GreenSingle + combined;
                        case PuzzleColor.Green:
                            return PuzzlePiece.BlueSingle + combined;
                    }
                    break;</pre>

Fragment 2 in file Scripts\Services\Underworld\Maze of Death\UnderworldPuzzle.cs

<pre>switch (movingIntoCol)
                    {
                        case PuzzleColor.Red:
                            return PuzzlePiece.GreenSingle + combined;
                        case PuzzleColor.Blue:
                            return PuzzlePiece.BlueSingle + combined;
                        case PuzzleColor.Green:
                            return PuzzlePiece.RedSingle + combined;
                    }
                    break;</pre>

Fragment 3 in file Scripts\Services\Underworld\Maze of Death\UnderworldPuzzle.cs

<pre>switch (movingIntoCol)
                    {
                        case PuzzleColor.Red:
                            return PuzzlePiece.BlueSingle + combined;
                        case PuzzleColor.Blue:
                            return PuzzlePiece.RedSingle + combined;
                        case PuzzleColor.Green:
                            return PuzzlePiece.GreenSingle + combined;
                    }
                    break;</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (item != null)
									{
										pack.DropItem(item);
										// could call applyobjectstringproperties on a nested propertylist here to set item attributes
										if (itemargstring != null)
										{
											ApplyObjectStringProperties(spawner, itemargstring, item, trigmob, refobject, out status_str);
										}
									}
									break;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (item != null)
									{
										pack.DropItem(item);
										// could call applyobjectstringproperties on a nested propertylist here to set item attributes
										if (itemargstring != null)
										{
											ApplyObjectStringProperties(spawner, itemargstring, item, trigmob, refobject, out status_str);
										}
									}
									break;</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (item != null)
									{
										pack.DropItem(item);
										// could call applyobjectstringproperties on a nested propertylist here to set item attributes
										if (itemargstring != null)
										{
											ApplyObjectStringProperties(spawner, itemargstring, item, trigmob, refobject, out status_str);
										}
									}
									break;</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\First\Clumsy.cs

<pre>int percentage = (int)(SpellHelper.GetOffsetScalar(this.Caster, m, true) * 100);
				TimeSpan length = SpellHelper.GetDuration(this.Caster, m);</pre>

Fragment 2 in file Scripts\Spells\First\Feeblemind.cs

<pre>int percentage = (int)(SpellHelper.GetOffsetScalar(this.Caster, m, true) * 100);
				TimeSpan length = SpellHelper.GetDuration(this.Caster, m);</pre>

Fragment 3 in file Scripts\Spells\First\Weaken.cs

<pre>int percentage = (int)(SpellHelper.GetOffsetScalar(this.Caster, m, true) * 100);
				TimeSpan length = SpellHelper.GetDuration(this.Caster, m);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GargoyleDestroyer.cs

<pre>this.SetSkill(SkillName.Magery, 90.1, 100.0);
            this.SetSkill(SkillName.EvalInt, 90.1, 100.0);
            this.SetSkill(SkillName.Meditation, 90.1, 100.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\MeerEternal.cs

<pre>this.SetSkill(SkillName.EvalInt, 90.1, 100.0);
            this.SetSkill(SkillName.Magery, 90.1, 100.0);
            this.SetSkill(SkillName.Meditation, 90.1, 100.0);</pre>

Fragment 3 in file Scripts\Mobiles\Normal\SAPixie.cs

<pre>this.SetSkill(SkillName.EvalInt, 90.1, 100.0);
            this.SetSkill(SkillName.Magery, 90.1, 100.0);
            this.SetSkill(SkillName.Meditation, 90.1, 100.0);</pre>

Fragment 4 in file Scripts\Mobiles\Summons\SummonedDaemon.cs

<pre>this.SetSkill(SkillName.EvalInt, 90.1, 100.0);
            this.SetSkill(SkillName.Meditation, 90.1, 100.0);
            this.SetSkill(SkillName.Magery, 90.1, 100.0);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>new int[] { 6, 6, 6, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>new int[] { 6, 6, 6, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>new int[] { 6, 6, 6, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeRam.cs

<pre>new int[] { 6, 6, 6, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Second\Agility.cs

<pre>int percentage = (int)(SpellHelper.GetOffsetScalar(this.Caster, m, false) * 100);
				TimeSpan length = SpellHelper.GetDuration(this.Caster, m);</pre>

Fragment 2 in file Scripts\Spells\Second\Cunning.cs

<pre>int percentage = (int)(SpellHelper.GetOffsetScalar(this.Caster, m, false) * 100);
				TimeSpan length = SpellHelper.GetDuration(this.Caster, m);</pre>

Fragment 3 in file Scripts\Spells\Second\Strength.cs

<pre>int percentage = (int)(SpellHelper.GetOffsetScalar(this.Caster, m, false) * 100);
				TimeSpan length = SpellHelper.GetDuration(this.Caster, m);</pre>

Fragment 4 in file Scripts\Spells\Third\Bless.cs

<pre>int percentage = (int)(SpellHelper.GetOffsetScalar(this.Caster, m, false) * 100);
				TimeSpan length = SpellHelper.GetDuration(this.Caster, m);</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\FurnitureDyeTub.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.m_IsRewardItem && !Engines.VeteranRewards.RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            base.OnDoubleClick(from);
        }</pre>

Fragment 2 in file Scripts\Items\Tools\LeatherDyeTub.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.m_IsRewardItem && !Engines.VeteranRewards.RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            base.OnDoubleClick(from);
        }</pre>

Fragment 3 in file Scripts\Items\Tools\RewardBlackDyeTub.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.m_IsRewardItem && !Engines.VeteranRewards.RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            base.OnDoubleClick(from);
        }</pre>

Fragment 4 in file Scripts\Items\Tools\RunebookDyeTub.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.m_IsRewardItem && !Engines.VeteranRewards.RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            base.OnDoubleClick(from);
        }</pre>

Fragment 5 in file Scripts\Items\Tools\SpecialDyeTub.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.m_IsRewardItem && !Engines.VeteranRewards.RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            base.OnDoubleClick(from);
        }</pre>

Fragment 6 in file Scripts\Items\Tools\StatuetteDyeTub.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.m_IsRewardItem && !Engines.VeteranRewards.RewardSystem.CheckIsUsableBy(from, this, null))
                return;

            base.OnDoubleClick(from);
        }</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\CTF.cs

<pre>m_Challenger = challenger;

            m_Organizers.Add(challenger);

            // check for points attachments
            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(challenger, typeof(XmlPoints));

            Movable = false;

            Hue = 33;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathBallGauntlet.cs

<pre>m_Challenger = challenger;

            m_Organizers.Add(challenger);

            // check for points attachments
            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(challenger, typeof(XmlPoints));

            Movable = false;

            Hue = 33;</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\DeathmatchGauntlet.cs

<pre>m_Challenger = challenger;

            m_Organizers.Add(challenger);

            // check for points attachments
            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(challenger, typeof(XmlPoints));

            Movable = false;

            Hue = 33;</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\KingOfTheHillGauntlet.cs

<pre>m_Challenger = challenger;

            m_Organizers.Add(challenger);

            // check for points attachments
            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(challenger, typeof(XmlPoints));

            Movable = false;

            Hue = 33;</pre>

Fragment 5 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGauntlet.cs

<pre>m_Challenger = challenger;

            m_Organizers.Add(challenger);

            // check for points attachments
            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(challenger, typeof(XmlPoints));

            Movable = false;

            Hue = 33;</pre>

Fragment 6 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathballGauntlet.cs

<pre>m_Challenger = challenger;

            m_Organizers.Add(challenger);

            // check for points attachments
            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(challenger, typeof(XmlPoints));

            Movable = false;

            Hue = 33;</pre>

Fragment 7 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamDeathmatchGauntlet.cs

<pre>m_Challenger = challenger;

            m_Organizers.Add(challenger);

            // check for points attachments
            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(challenger, typeof(XmlPoints));

            Movable = false;

            Hue = 33;</pre>

Fragment 8 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamKotHGauntlet.cs

<pre>m_Challenger = challenger;

            m_Organizers.Add(challenger);

            // check for points attachments
            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(challenger, typeof(XmlPoints));

            Movable = false;

            Hue = 33;</pre>

Fragment 9 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGauntlet.cs

<pre>m_Challenger = challenger;

            m_Organizers.Add(challenger);

            // check for points attachments
            XmlPoints afrom = (XmlPoints)XmlAttach.FindAttachment(challenger, typeof(XmlPoints));

            Movable = false;

            Hue = 33;</pre>

## Duplicated Code. Size: 75

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\DecorativeWeapon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\DecorativeWeapon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 3 in file Scripts\Items\Decorative\DecorativeWeapon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 4 in file Scripts\Items\Decorative\DecorativeWeapon.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 5 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 6 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 7 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 8 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 9 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 10 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 11 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 12 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 13 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 14 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 15 in file Scripts\Items\Decorative\Tapestry.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 16 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

Fragment 17 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            this.m_Item = reader.ReadItem() as InternalItem;
        }</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Docs.cs

<pre>html.WriteLine("      <table style=\"width: 850px;\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">");
			html.WriteLine("      <tr><td class=\"tbl-border\">");
			html.WriteLine("      <table border=\"0\" style=\"width: 850px;\" cellpadding=\"0\" cellspacing=\"1\">");
			html.WriteLine("         <tr>");
			html.WriteLine(
				"            <td style=\"width: 250px;\" rowspan=\"2\" class=\"entry\"><center>{0}</center></td>",
				title);</pre>

Fragment 2 in file Scripts\Commands\Docs.cs

<pre>html.WriteLine("      <table style=\"width: 850px;\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">");
			html.WriteLine("      <tr><td class=\"tbl-border\">");
			html.WriteLine("      <table border=\"0\" style=\"width: 850px;\" cellpadding=\"0\" cellspacing=\"1\">");
			html.WriteLine("         <tr>");
			html.WriteLine(
				"            <td style=\"width: 250px;\" rowspan=\"2\" class=\"entry\"><center>{0}</center></td>",
				title);</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Commands\Commands.cs

<pre>object[] states = (object[])state;
            CommandEventArgs e = (CommandEventArgs)states[0];
            ArrayList list = (ArrayList)states[1];</pre>

Fragment 2 in file Scripts\Commands\Generic\Commands\DesignInsert.cs

<pre>object[] states = (object[])state;
            CommandEventArgs e = (CommandEventArgs)states[0];
            ArrayList list = (ArrayList)states[1];</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\SHTelGenDelete.cs

<pre>tele1 = this.AddSHT(Map.Felucca, false, 5654, 1791, 0);
                tele2 = this.AddSHT(Map.Felucca, true, 730, 1451, 0);</pre>

Fragment 2 in file Scripts\Items\Addons\SHTeleporter.cs

<pre>tele1 = this.AddSHT(Map.Felucca, false, 5654, 1791, 0);
                tele2 = this.AddSHT(Map.Felucca, true, 730, 1451, 0);</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Statics.cs

<pre>idxWriter.Seek(idxPos, SeekOrigin.Begin);
                            idxWriter.Write(mulPos);
                            idxWriter.Write(length);
                            idxWriter.Write(extra);

                            idxWriter.Flush();</pre>

Fragment 2 in file Scripts\Commands\Statics.cs

<pre>idxWriter.Seek(idxPos, SeekOrigin.Begin);
                            idxWriter.Write(mulPos);
                            idxWriter.Write(length);
                            idxWriter.Write(extra);

                            idxWriter.Flush();</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AdminGump.cs

<pre>public static string FormatTimeSpan(TimeSpan ts)
        {
            return String.Format("{0:D2}:{1:D2}:{2:D2}:{3:D2}", ts.Days, ts.Hours % 24, ts.Minutes % 60, ts.Seconds % 60);
        }</pre>

Fragment 2 in file Scripts\Services\Factions\Gumps\ElectionManagementGump.cs

<pre>public static string FormatTimeSpan(TimeSpan ts)
        {
            return String.Format("{0:D2}:{1:D2}:{2:D2}:{3:D2}", ts.Days, ts.Hours % 24, ts.Minutes % 60, ts.Seconds % 60);
        }</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>this.AddPage(0);
            this.AddBackground(0, 0, 585, 393, 5054);
            this.AddBackground(195, 36, 387, 275, 3000);</pre>

Fragment 2 in file Scripts\Gumps\PolymorphGump.cs

<pre>this.AddPage(0);
            this.AddBackground(0, 0, 585, 393, 5054);
            this.AddBackground(195, 36, 387, 275, 3000);</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\PlayerVendorDeed.cs

<pre>v.Direction = from.Direction & Direction.Mask;
                v.MoveToWorld(from.Location, from.Map);

                v.SayTo(from, 503246); // Ah! it feels good to be working again.

                this.Delete();</pre>

Fragment 2 in file Scripts\Items\Consumables\PlayerVendorDeed.cs

<pre>v.Direction = from.Direction & Direction.Mask;
                        v.MoveToWorld(from.Location, from.Map);

                        v.SayTo(from, 503246); // Ah! it feels good to be working again.

                        this.Delete();</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\BaseTreasureChest.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public override bool Locked
        {
            get
            {
                return base.Locked;
            }
            set
            {
                if (base.Locked != value)
                {
                    base.Locked = value;

                    if (!value)
                        this.StartResetTimer();
                }
            }
        }</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\SorcerersRewardChest.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public override bool Locked
        {
            get { return base.Locked; }
            set
            {
                if (base.Locked != value)
                {
                    base.Locked = value;

                    if (!value)
                        this.StartResetTimer();
                }
            }
        }</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\GargishLeatherWingArmor.cs

<pre>Quality = (ArmorQuality)quality;

            if (makersMark)
                Crafter = from;

            Type resourceType = typeRes;

            if (resourceType == null)
                resourceType = craftItem.Resources.GetAt(0).ItemType;</pre>

Fragment 2 in file Scripts\Items\Tools\FishingPole.cs

<pre>Quality = (WeaponQuality)quality;

            if (makersMark) // Add to CraftItem.cs mark table
                Crafter = from;

            Type resourceType = typeRes;

            if (resourceType == null)
                resourceType = craftItem.Resources.GetAt(0).ItemType;</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>writer.Write((int)m_ReforgedPrefix);
            writer.Write((int)m_ReforgedSuffix);
            writer.Write((int)m_ItemPower);
            writer.Write(m_BlockRepair);</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>writer.Write((int)m_ReforgedPrefix);
            writer.Write((int)m_ReforgedSuffix);
            writer.Write((int)m_ItemPower);
            writer.Write(m_BlockRepair);</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void OnMapChange()
        {
            if (this.m_Item != null)
                this.m_Item.Map = this.Map;
            if (this.m_Item2 != null)
                this.m_Item2.Map = this.Map;
        }</pre>

Fragment 2 in file Scripts\Items\Functional\LargeForge.cs

<pre>public override void OnMapChange()
        {
            if (this.m_Item != null)
                this.m_Item.Map = this.Map;
            if (this.m_Item2 != null)
                this.m_Item2.Map = this.Map;
        }</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Quest\AbyssKey.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.Lifespan > 0)
                list.Add(1072517, this.m_Lifespan.ToString()); // Lifespan: ~1_val~ seconds
        }</pre>

Fragment 2 in file Scripts\Services\Peerless\PeerlessKey.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.Lifespan > 0)
                list.Add(1072517, this.m_Lifespan.ToString()); // Lifespan: ~1_val~ seconds
        }</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\RaceDefinitions.cs

<pre>public override bool ValidateFace(bool female, int itemID)
            {
                if (itemID.Equals(0))
                    return false;

                if (itemID >= 0x3B44 && itemID <= 0x3B4D)
                    return true;

                return false;
            }</pre>

Fragment 2 in file Scripts\Misc\RaceDefinitions.cs

<pre>public override bool ValidateFace(bool female, int itemID)
            {
                if (itemID.Equals(0))
                    return false;

                if (itemID >= 0x3B44 && itemID <= 0x3B4D)
                    return true;

                return false;
            }</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\MonstrousInterredGrizzle.cs

<pre>if (Utility.RandomDouble() < 0.05)				
                c.DropItem(new GrizzledMareStatuette());

            if (Utility.RandomDouble() < 0.025)
                c.DropItem(new CrimsonCincture());</pre>

Fragment 2 in file Scripts\Mobiles\Named\Ilhenir.cs

<pre>if (Utility.RandomDouble() < 0.05)
                    c.DropItem(new GrizzledMareStatuette());

                if (Utility.RandomDouble() < 0.025)
                    c.DropItem(new CrimsonCincture());</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\AcidElemental.cs

<pre>this.SetSkill(SkillName.Tactics, 80.1, 90.0);
            this.SetSkill(SkillName.Wrestling, 70.1, 90.0);

            this.Fame = 10000;
            this.Karma = -10000;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ToxicElemental.cs

<pre>this.SetSkill(SkillName.Tactics, 80.1, 90.0);
            this.SetSkill(SkillName.Wrestling, 70.1, 90.0);

            this.Fame = 10000;
            this.Karma = -10000;</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Beetle.cs

<pre>this.SetStr(300);
            this.SetDex(100);
            this.SetInt(500);

            this.SetHits(200);

            this.SetDamage(7, 20);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\FireBeetle.cs

<pre>this.SetStr(300);
            this.SetDex(100);
            this.SetInt(500);

            this.SetHits(200);

            this.SetDamage(7, 20);</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BloodElemental.cs

<pre>this.SetSkill(SkillName.Tactics, 80.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 80.1, 100.0);

            this.Fame = 12500;
            this.Karma = -12500;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ElderGazer.cs

<pre>this.SetSkill(SkillName.Tactics, 80.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 80.1, 100.0);

            this.Fame = 12500;
            this.Karma = -12500;</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BogThing.cs

<pre>this.SetMana(0);

            this.SetDamage(10, 23);

            this.SetDamageType(ResistanceType.Physical, 60);
            this.SetDamageType(ResistanceType.Poison, 40);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Corpser.cs

<pre>this.SetMana(0);

            this.SetDamage(10, 23);

            this.SetDamageType(ResistanceType.Physical, 60);
            this.SetDamageType(ResistanceType.Poison, 40);</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Gazer.cs

<pre>this.SetSkill(SkillName.Tactics, 50.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 50.1, 70.0);

            this.Fame = 3500;
            this.Karma = -3500;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Troll.cs

<pre>this.SetSkill(SkillName.Tactics, 50.1, 70.0);
            this.SetSkill(SkillName.Wrestling, 50.1, 70.0);

            this.Fame = 3500;
            this.Karma = -3500;</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\BaseEscortable.cs

<pre>private static readonly string[] m_TownNames = new string[]
        {
            "Cove", "Britain", "Jhelom",
            "Minoc", "Ocllo", "Trinsic",
            "Vesper", "Yew", "Skara Brae", //Original List, will need to add it back for Pre-ML shards
            "Nujel'm", "Moonglow", "Magincia"
        };</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlMobiles\TalkingBaseEscortable.cs

<pre>private static string[] m_TownNames = new string[]
			{
				"Cove", "Britain", "Jhelom",
				"Minoc", "Ocllo", "Trinsic",
				"Vesper", "Yew", "Skara Brae",
				"Nujel'm", "Moonglow", "Magincia"
			};</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\BaseEscortable.cs

<pre>this.AddItem(new ShortPants(Utility.RandomNeutralHue()));
            this.AddItem(new Boots(Utility.RandomNeutralHue()));

            Utility.AssignRandomHair(this);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\MercutioTheUnsavory.cs

<pre>this.AddItem(new ShortPants(Utility.RandomNeutralHue()));
            this.AddItem(new Boots(Utility.RandomNeutralHue()));

            Utility.AssignRandomHair(this);</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Mobiles\Raider.cs

<pre>Hue = Utility.RandomSkinHue();
            Utility.AssignRandomHair(this);

            SetStr(150, 200);
            SetDex(125, 150);
            SetInt(95, 110);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Mobiles\Corgul\SoulboundPirateRaider.cs

<pre>Hue = Utility.RandomSkinHue();
            Utility.AssignRandomHair(this);

            SetStr(150, 200);
            SetDex(125, 150);
            SetInt(95, 110);</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\RoyalZooDonationBox.cs

<pre>c.MoveToWorld(new Point3D(4497, 1366, 23), this.Map);
                    c.Blessed = true;	
                    c.Tamable = false;
                    list.Add(c);</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\RoyalZooDonationBox.cs

<pre>c.MoveToWorld(new Point3D(4497, 1366, 23), this.Map);
                    c.Blessed = true;	
                    c.Tamable = false;
                    list.Add(c);</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>if (x < this.X && y > this.Y)
                        return ShipPosition.BowPort;
                    else if (x > this.X && y < this.Y)
                        return ShipPosition.AftStarboard;
                    else
                        return ShipPosition.AftPort;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>if (x > this.X && y < this.Y)
                        return ShipPosition.BowPort;
                    else if (x < this.X && y > this.Y)
                        return ShipPosition.AftStarboard;
                    else
                        return ShipPosition.AftPort;</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Underworld\Maze of Death\UnderworldPuzzle.cs

<pre>PuzzlePiece movingPiece = m_CurrentSolution.Rows[m_Row];
                        PuzzlePiece movingToPiece = m_CurrentSolution.Rows[nextRow];

                        //Can't move empty spaces
                        if (movingPiece == PuzzlePiece.None || m_Item.Attempts >= m_Solution.MaxAttempts)
                            break;</pre>

Fragment 2 in file Scripts\Services\Underworld\Maze of Death\UnderworldPuzzle.cs

<pre>PuzzlePiece movingPiece = m_CurrentSolution.Rows[m_Row];
                        PuzzlePiece movingToPiece = m_CurrentSolution.Rows[nextRow];

                        //Can't Move Empty Spaces
                        if (movingPiece == PuzzlePiece.None || m_Item.Attempts >= m_Solution.MaxAttempts)
                            break;</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ViceVsVirtue\Mobiles\SilverTrader.cs

<pre>public override void InitBody()
        {
            base.InitBody();

            Name = NameList.RandomName("male");

            SpeechHue = 0x3B2;
            Hue = Utility.RandomSkinHue();
            Body = 0x190;
        }</pre>

Fragment 2 in file Scripts\Services\ViceVsVirtue\Mobiles\VvVPriest.cs

<pre>public override void InitBody()
        {
            base.InitBody();

            Name = NameList.RandomName("male");

            SpeechHue = 0x3B2;
            Hue = Utility.RandomSkinHue();
            Body = 0x190;
        }</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>if (attachments != null)
			{
				foreach (XmlAttachment a in attachments)
				{
					if (a != null && !a.Deleted)
					   a.OnWeaponHit(attacker, defender, weapon, damage);
				}
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>if (attachments != null)
			{
				foreach (XmlAttachment a in attachments)
				{
					if (a != null && !a.Deleted)
						a.OnWeaponHit(attacker, defender, weapon, damage);
				}
			}</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>{
						// check the old owner
						CheckOwnerFlag();

						Owner = parentOfTarget as PlayerMobile;

						// first owner will become creator by default
						if (Creator == null)
							Creator = Owner;

						LootType = LootType.Blessed;

						// flag the new owner as carrying a questtoken
						Owner.SetFlag(XmlQuest.CarriedXmlQuestFlag, true);

					}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>{
                        // check the old owner
                        CheckOwnerFlag();

                        Owner = parentOfTarget as PlayerMobile;

                        // first owner will become creator by default
                        if (Creator == null)
                            Creator = Owner;

                        LootType = LootType.Blessed;

                        // flag the new owner as carrying a questtoken
                        Owner.SetFlag(XmlQuest.CarriedXmlQuestFlag, true);

                    }</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomAttacks.cs

<pre>if(m_attachment != null && m_attachment.HasActiveCombos)
                {
                    // green button
                    //AddImage( 20, 10, 0x2a4e );
                    AddImage( 15, 25, 0x0a53 );
                } else
                {
                    // red button
                    //AddImage( 20, 10, 0x2a62 );
                    AddImage( 15, 25, 0x0a52 );
                }
                // go through the list of enabled moves and add buttons for them
                int y = 70;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomDefenses.cs

<pre>if(m_attachment != null && m_attachment.HasActiveCombos)
                {
                    // green button
                    //AddImage( 20, 10, 0x2a4e );
                    AddImage( 15, 25, 0x0a53 );
                } else
                {
                    // red button
                    //AddImage( 20, 10, 0x2a62 );
                    AddImage( 15, 25, 0x0a52 );
                }
                // go through the list of enabled moves and add buttons for them
                int y = 70;</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>XmlPoints a = (XmlPoints)XmlAttach.FindAttachment(from, typeof(XmlPoints));

				XmlPoints atarg = (XmlPoints)XmlAttach.FindAttachment(target, typeof(XmlPoints));</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\Attachments\XmlPoints.cs

<pre>XmlPoints a = (XmlPoints)XmlAttach.FindAttachment(from, typeof(XmlPoints));

				XmlPoints atarg = (XmlPoints)XmlAttach.FindAttachment(target, typeof(XmlPoints));</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\BaseSiegeWeapon.cs

<pre>object[] args = (object[])state;

			Mobile from = (Mobile)args[0];
			BaseSiegeWeapon weapon = (BaseSiegeWeapon)args[1];</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\BaseSiegeWeapon.cs

<pre>object[] args = (object[])state;

			Mobile from = (Mobile)args[0];
			BaseSiegeWeapon weapon = (BaseSiegeWeapon)args[1];</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Server\Map.cs

<pre>var checkTop = checkZ + id.CalcHeight;

					if (checkTop == checkZ && !id.Surface)
					{
						++checkTop;
					}

					if (checkTop > z && checkTop <= currentZ)
					{
						z = checkTop;
					}</pre>

Fragment 2 in file Server\Map.cs

<pre>var checkTop = checkZ + id.CalcHeight;

					if (checkTop == checkZ && !id.Surface)
					{
						++checkTop;
					}

					if (checkTop > z && checkTop <= currentZ)
					{
						z = checkTop;
					}</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Server\Network\Compression.cs

<pre>while (bitCount >= 8)
							{
								bitCount -= 8;

								if (pOutput < pOutputEnd)
								{
									*pOutput++ = (byte)(bitValue >> bitCount);
								}
								else
								{
									length = 0;
									return;
								}
							}</pre>

Fragment 2 in file Server\Network\Compression.cs

<pre>while (bitCount >= 8)
						{
							bitCount -= 8;

							if (pOutput < pOutputEnd)
							{
								*pOutput++ = (byte)(bitValue >> bitCount);
							}
							else
							{
								length = 0;
								return;
							}
						}</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketWriter.cs

<pre>{
			m_Buffer[0] = (byte)(value >> 8);
			m_Buffer[1] = (byte)value;

			m_Stream.Write(m_Buffer, 0, 2);
		}</pre>

Fragment 2 in file Server\Network\PacketWriter.cs

<pre>{
			m_Buffer[0] = (byte)(value >> 8);
			m_Buffer[1] = (byte)value;

			m_Stream.Write(m_Buffer, 0, 2);
		}</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Server\TileData.cs

<pre>bin.Read(m_StringBuffer, 0, 20);

			int count;

			for (count = 0; count < 20 && m_StringBuffer[count] != 0; ++count)
			{
				;
			}</pre>

Fragment 2 in file Ultima\TileData.cs

<pre>bin.Read(m_StringBuffer, 0, 20);

			int count;

			for (count = 0; count < 20 && m_StringBuffer[count] != 0; ++count)
			{
				;
			}</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Server\TileMatrix.cs

<pre>for (int j = 0; j < 8; ++j)
							{
								tiles[i][j] = lists[i][j].ToArray();
							}</pre>

Fragment 2 in file Ultima\TileMatrix.cs

<pre>for (int j = 0; j < 8; ++j)
							{
								tiles[i][j] = lists[i][j].ToArray();
							}</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Server\TileMatrixPatch.cs

<pre>for (int y = 0; y < 8; ++y)
									{
										tiles[x][y] = lists[x][y].ToArray();
									}</pre>

Fragment 2 in file Ultima\TileMatrixPatch.cs

<pre>for (int y = 0; y < 8; ++y)
								{
									tiles[x][y] = lists[x][y].ToArray();
								}</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Properties.cs

<pre>{
			typeof(Byte), typeof(SByte), typeof(Int16), typeof(UInt16), typeof(Int32), typeof(UInt32), typeof(Int64),
			typeof(UInt64)
		}</pre>

Fragment 2 in file Scripts\Gumps\Properties\PropsGump.cs

<pre>{
			typeof(Byte), typeof(Int16), typeof(Int32), typeof(Int64),
			typeof(SByte), typeof(UInt16), typeof(UInt32), typeof(UInt64)
		}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlPropsGumps\XmlPropsGump.cs

<pre>{
				typeof( Byte ),
				typeof( Int16 ),
				typeof( Int32 ),
				typeof( Int64 ),
				typeof( SByte ),
				typeof( UInt16 ),
				typeof( UInt32 ),
				typeof( UInt64 )
			}</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\GorgonLens.cs

<pre>{
                    ((BaseArmor)m_Item).GorgonLenseCharges = m_Lense.Amount;
                    ((BaseArmor)m_Item).GorgonLenseType = m_Lense.LenseType;
                    from.SendLocalizedMessage(1112595); //You enhance the item with Gorgon Lenses!
                    m_Lense.Delete();
                }</pre>

Fragment 2 in file Scripts\Items\Consumables\GorgonLens.cs

<pre>{
                    ((BaseJewel)m_Item).GorgonLenseCharges = m_Lense.Amount;
                    ((BaseJewel)m_Item).GorgonLenseType = m_Lense.LenseType;
                    from.SendLocalizedMessage(1112595); //You enhance the item with Gorgon Lenses!
                    m_Lense.Delete();
                }</pre>

Fragment 3 in file Scripts\Items\Consumables\GorgonLens.cs

<pre>{
                    ((BaseClothing)m_Item).GorgonLenseCharges = m_Lense.Amount;
                    ((BaseClothing)m_Item).GorgonLenseType = m_Lense.LenseType;
                    from.SendLocalizedMessage(1112595); //You enhance the item with Gorgon Lenses!
                    m_Lense.Delete();
                }</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>m_Mobile.ControlMaster.RevealingAction();
					m_Mobile.CurrentSpeed = m_Mobile.ActiveSpeed;
					m_Mobile.PlaySound(m_Mobile.GetIdleSound());
					m_Mobile.Warmode = false;
					m_Mobile.Combatant = null;
					break;</pre>

Fragment 2 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>m_Mobile.ControlMaster.RevealingAction();
					m_Mobile.CurrentSpeed = m_Mobile.ActiveSpeed;
					m_Mobile.PlaySound(m_Mobile.GetIdleSound());
					m_Mobile.Warmode = false;
					m_Mobile.Combatant = null;
					break;</pre>

Fragment 3 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>m_Mobile.ControlMaster.RevealingAction();
					m_Mobile.CurrentSpeed = m_Mobile.ActiveSpeed;
					m_Mobile.PlaySound(m_Mobile.GetIdleSound());

					m_Mobile.Warmode = false;
					m_Mobile.Combatant = null;
					break;</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>m_Mobile.ControlMaster.RevealingAction();
					m_Mobile.CurrentSpeed = m_Mobile.PassiveSpeed;
					m_Mobile.PlaySound(m_Mobile.GetIdleSound());
					m_Mobile.Warmode = false;
					m_Mobile.Combatant = null;
					break;</pre>

Fragment 2 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>m_Mobile.ControlMaster.RevealingAction();
					m_Mobile.CurrentSpeed = m_Mobile.PassiveSpeed;
					m_Mobile.PlaySound(m_Mobile.GetIdleSound());
					m_Mobile.Warmode = false;
					m_Mobile.Combatant = null;
					break;</pre>

Fragment 3 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>m_Mobile.ControlMaster.RevealingAction();
					m_Mobile.CurrentSpeed = m_Mobile.PassiveSpeed;
					m_Mobile.PlaySound(m_Mobile.GetIdleSound());

					m_Mobile.Warmode = false;
					m_Mobile.Combatant = null;
					break;</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\ChiefParoxysmus.cs

<pre>if (Utility.RandomDouble() < 0.10)
                c.DropItem(new HumanFeyLeggings());

            if (Utility.RandomDouble() < 0.6)				
                c.DropItem(new ParrotItem());</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\MonstrousInterredGrizzle.cs

<pre>if (Utility.RandomDouble() < 0.10)
                c.DropItem(new HumanFeyLeggings());

            if (Utility.RandomDouble() < 0.6)				
                c.DropItem(new ParrotItem());</pre>

Fragment 3 in file Scripts\Mobiles\Bosses\Travesty.cs

<pre>if (Utility.RandomDouble() < 0.10)
                c.DropItem(new HumanFeyLeggings());

            if (Utility.RandomDouble() < 0.6)
                c.DropItem(new ParrotItem());</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Harrower\HarrowerTentacles.cs

<pre>this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 90.1, 100.0);

            this.Fame = 15000;
            this.Karma = -15000;</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ArcticOgreLord.cs

<pre>this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 90.1, 100.0);

            this.Fame = 15000;
            this.Karma = -15000;</pre>

Fragment 3 in file Scripts\Mobiles\Normal\Betrayer.cs

<pre>this.SetSkill(SkillName.Tactics, 90.1, 100.0);
            this.SetSkill(SkillName.Wrestling, 90.1, 100.0);

            this.Fame = 15000;
            this.Karma = -15000;</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\Mephitis.cs

<pre>this.SetSkill(SkillName.Tactics, 97.6, 100.0);
            this.SetSkill(SkillName.Wrestling, 97.6, 100.0);

            this.Fame = 22500;
            this.Karma = -22500;</pre>

Fragment 2 in file Scripts\Mobiles\Bosses\Neira.cs

<pre>this.SetSkill(SkillName.Tactics, 97.6, 100.0);
            this.SetSkill(SkillName.Wrestling, 97.6, 100.0);

            this.Fame = 22500;
            this.Karma = -22500;</pre>

Fragment 3 in file Scripts\Mobiles\Normal\AncientWyrm.cs

<pre>this.SetSkill(SkillName.Tactics, 97.6, 100.0);
            this.SetSkill(SkillName.Wrestling, 97.6, 100.0);

            this.Fame = 22500;
            this.Karma = -22500;</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>if (amount * m_Selected.Points < 1)
                    {
                        from.SendLocalizedMessage(1073167); // You do not have enough of that item to make a donation!
                        from.SendGump(new ComunityCollectionGump((PlayerMobile)from, m_Collection, m_Location));
                        return;
                    }</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>if (amount * m_Selected.Points < 1)
                    {
                        from.SendLocalizedMessage(1073167); // You do not have enough of that item to make a donation!
                        from.SendGump(new ComunityCollectionGump((PlayerMobile)from, m_Collection, m_Location));
                        return;
                    }</pre>

Fragment 3 in file Scripts\Services\CommunityCollections\ComunityCollectionGump.cs

<pre>if (amount * m_Selected.Points < 1)
                        {
                            from.SendLocalizedMessage(1073167); // You do not have enough of that item to make a donation!
                            from.SendGump(new ComunityCollectionGump((PlayerMobile)from, m_Collection, m_Location));
                            return;
                        }</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Necromancy\BloodOathSpell.cs

<pre>protected override void OnTarget(Mobile from, object o)
            {
                if (o is Mobile)
                    this.m_Owner.Target((Mobile)o);
                else
                    from.SendLocalizedMessage(1060508); // You can't curse that.
            }</pre>

Fragment 2 in file Scripts\Spells\Necromancy\EvilOmen.cs

<pre>protected override void OnTarget(Mobile from, object o)
            {
                if (o is Mobile)
                    this.m_Owner.Target((Mobile)o);
                else
                    from.SendLocalizedMessage(1060508); // You can't curse that.
            }</pre>

Fragment 3 in file Scripts\Spells\Necromancy\MindRot.cs

<pre>protected override void OnTarget(Mobile from, object o)
            {
                if (o is Mobile)
                    this.m_Owner.Target((Mobile)o);
                else
                    from.SendLocalizedMessage(1060508); // You can't curse that.
            }</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Items\FactionStone.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            Faction.WriteReference(writer, this.m_Faction);
        }</pre>

Fragment 2 in file Scripts\Services\Factions\Items\JoinStone.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            Faction.WriteReference(writer, this.m_Faction);
        }</pre>

Fragment 3 in file Scripts\Services\Factions\Items\Traps\BaseFactionTrapDeed.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            Faction.WriteReference(writer, this.m_Faction);
        }</pre>

Fragment 4 in file Scripts\Services\Factions\Mobiles\FactionWarHorse.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version

            Faction.WriteReference(writer, this.m_Faction);
        }</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Ultima\Gumps.cs

<pre>int length, extra;
			bool patched;
			Stream stream = m_FileIndex.Seek(index, out length, out extra, out patched);
			if (stream == null)
			{
				return null;
			}</pre>

Fragment 2 in file Ultima\Light.cs

<pre>int length, extra;
			bool patched;

			Stream stream = m_FileIndex.Seek(index, out length, out extra, out patched);

			if (stream == null)
			{
				return null;
			}</pre>

Fragment 3 in file Ultima\Light.cs

<pre>int length, extra;
			bool patched;

			Stream stream = m_FileIndex.Seek(index, out length, out extra, out patched);

			if (stream == null)
			{
				return null;
			}</pre>

Fragment 4 in file Ultima\Skills.cs

<pre>int length, extra;
			bool patched;

			Stream stream = m_FileIndex.Seek(index, out length, out extra, out patched);
			if (stream == null)
			{
				return null;
			}</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Armor\LeafGloves.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.IsArcane)
                list.Add(1061837, "{0}\t{1}", this.m_CurArcaneCharges, this.m_MaxArcaneCharges); // arcane charges: ~1_val~ / ~2_val~
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Armor\LeatherGloves.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.IsArcane)
                list.Add(1061837, "{0}\t{1}", this.m_CurArcaneCharges, this.m_MaxArcaneCharges); // arcane charges: ~1_val~ / ~2_val~
        }</pre>

Fragment 3 in file Scripts\Items\Equipment\Clothing\Cloaks.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.IsArcane)
                list.Add(1061837, "{0}\t{1}", this.m_CurArcaneCharges, this.m_MaxArcaneCharges); // arcane charges: ~1_val~ / ~2_val~
        }</pre>

Fragment 4 in file Scripts\Items\Equipment\Clothing\OuterTorso.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.IsArcane)
                list.Add(1061837, "{0}\t{1}", this.m_CurArcaneCharges, this.m_MaxArcaneCharges); // arcane charges: ~1_val~ / ~2_val~
        }</pre>

Fragment 5 in file Scripts\Items\Equipment\Clothing\Shoes.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.IsArcane)
                list.Add(1061837, "{0}\t{1}", this.m_CurArcaneCharges, this.m_MaxArcaneCharges); // arcane charges: ~1_val~ / ~2_val~
        }</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefCooking.cs

<pre>this.AddRes(index, typeof(BaseBeverage), 1046458, 1, 1044253);
                this.SetNeededExpansion(index, Expansion.SE);
                this.SetNeedOven(index, true);</pre>

Fragment 2 in file Scripts\Services\Craft\DefCooking.cs

<pre>this.AddRes(index, typeof(BaseBeverage), 1046458, 1, 1044253);
                this.SetNeededExpansion(index, Expansion.SE);
                this.SetNeedOven(index, true);</pre>

Fragment 3 in file Scripts\Services\Craft\DefCooking.cs

<pre>this.AddRes(index, typeof(BaseBeverage), 1046458, 1, 1044253);
                this.SetNeededExpansion(index, Expansion.SE);
                this.SetNeedOven(index, true);</pre>

Fragment 4 in file Scripts\Services\Craft\DefCooking.cs

<pre>this.AddRes(index, typeof(BaseBeverage), 1046458, 1, 1044253);
                this.SetNeededExpansion(index, Expansion.SE);
                this.SetNeedOven(index, true);</pre>

Fragment 5 in file Scripts\Services\Craft\DefCooking.cs

<pre>this.AddRes(index, typeof(BaseBeverage), 1046458, 1, 1044253);
                this.SetNeededExpansion(index, Expansion.SE);
                this.SetNeedOven(index, true);</pre>

## Duplicated Code. Size: 74

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Mobiles\Djinn.cs

<pre>if (m.Backpack == null || !m.Backpack.TryDropItem(m, item, false))
                        {
                            m.BankBox.DropItem(item);
                        }

                        m.SendLocalizedMessage(1154489); // You received a Quest Item!</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Mobiles\IceWyrm.cs

<pre>if (m.Backpack == null || !m.Backpack.TryDropItem(m, item, false))
                        {
                            m.BankBox.DropItem(item);
                        }

                        m.SendLocalizedMessage(1154489); // You received a Quest Item!</pre>

Fragment 3 in file Scripts\Services\ExploringTheDeep\Mobiles\MercutioTheUnsavory.cs

<pre>if (m.Backpack == null || !m.Backpack.TryDropItem(m, item, false))
                        {
                            m.BankBox.DropItem(item);
                        }

                        m.SendLocalizedMessage(1154489); // You received a Quest Item!</pre>

Fragment 4 in file Scripts\Services\ExploringTheDeep\Mobiles\ObsidianWyvern.cs

<pre>if (m.Backpack == null || !m.Backpack.TryDropItem(m, item, false))
                        {
                            m.BankBox.DropItem(item);
                        }

                        m.SendLocalizedMessage(1154489); // You received a Quest Item!</pre>

Fragment 5 in file Scripts\Services\ExploringTheDeep\Mobiles\OrcEngineer.cs

<pre>if (m.Backpack == null || !m.Backpack.TryDropItem(m, item, false))
                        {
                            m.BankBox.DropItem(item);
                        }

                        m.SendLocalizedMessage(1154489); // You received a Quest Item!</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Decorate.cs

<pre>m_List = list;
                #endregion

                for (int j = 0; j < list.Count; ++j)
                    m_Count += ((DecorationList)list[j]).Generate(maps);</pre>

Fragment 2 in file Scripts\Commands\DecorateDelete.cs

<pre>m_List = list;
                #endregion

                for (int j = 0; j < list.Count; ++j)
                    m_Count += ((DecorationListDelete)list[j]).Generate(maps);</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Commands\Generic\Commands\Interface.cs

<pre>this.AddNewPage();

            if (this.m_Page > 0)
                this.AddEntryButton(20, ArrowLeftID1, ArrowLeftID2, 1, ArrowLeftWidth, ArrowLeftHeight);
            else
                this.AddEntryHeader(20);</pre>

Fragment 2 in file Scripts\Commands\HelpInfo.cs

<pre>this.AddNewPage();

                if (this.m_Page > 0)
                    this.AddEntryButton(20, ArrowLeftID1, ArrowLeftID2, 1, ArrowLeftWidth, ArrowLeftHeight);
                else
                    this.AddEntryHeader(20);</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\AddGump.cs

<pre>(typeofMobile.IsAssignableFrom(t) || typeofItem.IsAssignableFrom(t)) && t.Name.ToLower().IndexOf(match) >= 0 && !results.Contains(t)</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlPartialCategorizedAddGump.cs

<pre>(typeofMobile.IsAssignableFrom( t ) || typeofItem.IsAssignableFrom( t )) && t.Name.ToLower().IndexOf( match ) >= 0 && !results.Contains( t )</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\GuildAdminCandidatesGump.cs

<pre>if (guildFaction == null)
                                            this.m_Mobile.SendLocalizedMessage(1013027); // That player cannot join a non-faction guild.
                                        else if (targetFaction == null)
                                            this.m_Mobile.SendLocalizedMessage(1013026); // That player must be in a faction before joining this guild.
                                        else
                                            this.m_Mobile.SendLocalizedMessage(1013028); // That person has a different faction affiliation.</pre>

Fragment 2 in file Scripts\Gumps\Guilds\RecruitTarget.cs

<pre>if (guildFaction == null)
                        this.m_Mobile.SendLocalizedMessage(1013027); // That player cannot join a non-faction guild.
                    else if (targetFaction == null)
                        this.m_Mobile.SendLocalizedMessage(1013026); // That player must be in a faction before joining this guild.
                    else
                        this.m_Mobile.SendLocalizedMessage(1013028); // That person has a different faction affiliation.</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BaseAddonDeed.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
                from.Target = new InternalTarget(this);
            else
                from.SendLocalizedMessage(1042001); // That must be in your pack for you to use it.
        }</pre>

Fragment 2 in file Scripts\Items\Consumables\PowderOfTemperament.cs

<pre>public override void OnDoubleClick(Mobile from)
        {
            if (this.IsChildOf(from.Backpack))
                from.Target = new InternalTarget(this);
            else
                from.SendLocalizedMessage(1042001); // That must be in your pack for you to use it.
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\ChurchillsWarMace.cs

<pre>{
            this.LootType = LootType.Blessed;

            this.Attributes.AttackChance = 5;
            this.Attributes.WeaponSpeed = 10;
            this.Attributes.WeaponDamage = 25;
            this.WeaponAttributes.LowerStatReq = 70;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\Heartseeker.cs

<pre>{
            this.LootType = LootType.Blessed;

            this.Attributes.AttackChance = 5;
            this.Attributes.WeaponSpeed = 10;
            this.Attributes.WeaponDamage = 25;
            this.WeaponAttributes.LowerStatReq = 70;
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Weapons\StaffOfShatteredDreams.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

			if (version < 1)
				WeaponAttributes.SplinteringWeapon = 20;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Weapons\SwordOfShatteredHopes.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

			if (version < 1)
				WeaponAttributes.SplinteringWeapon = 20;
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Consumables\BaseConflagrationPotion.cs

<pre>if (this.m_Potion.Deleted || this.m_Potion.Map == Map.Internal)
                    return;

                IPoint3D p = targeted as IPoint3D;

                if (p == null || from.Map == null)
                    return;</pre>

Fragment 2 in file Scripts\Items\Consumables\BaseConfusionBlastPotion.cs

<pre>if (this.m_Potion.Deleted || this.m_Potion.Map == Map.Internal)
                    return;

                IPoint3D p = targeted as IPoint3D;

                if (p == null || from.Map == null)
                    return;</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\Container.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0)
                this.Weight = 13.0;
        }</pre>

Fragment 2 in file Scripts\Items\Containers\Container.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version == 0)
                this.Weight = 13.0;
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Containers\Mahjong\Packets.cs

<pre>this.m_Stream.Write((short)0);
                    this.m_Stream.Write((byte)0);

                    this.m_Stream.Write(players.IsPublic(i));</pre>

Fragment 2 in file Scripts\Items\Containers\Mahjong\Packets.cs

<pre>this.m_Stream.Write((short)0);
                    this.m_Stream.Write((byte)0);

                    this.m_Stream.Write(players.IsPublic(i));</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Clothing\BaseClothing.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public CraftResource Resource
        {
            get
            {
                return this.m_Resource;
            }
            set
            {
                this.m_Resource = value;
                this.Hue = CraftResources.GetHue(this.m_Resource);
                this.InvalidateProperties();
            }
        }</pre>

Fragment 2 in file Scripts\Items\Tools\BaseRunicTool.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public CraftResource Resource
        {
            get
            {
                return this.m_Resource;
            }
            set
            {
                this.m_Resource = value;
                this.Hue = CraftResources.GetHue(this.m_Resource);
                this.InvalidateProperties();
            }
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int MaxHitPoints
        {
            get
            {
                return this.m_MaxHitPoints;
            }
            set
            {
                this.m_MaxHitPoints = value;

                if (this.m_MaxHitPoints > 255)
                    this.m_MaxHitPoints = 255;

                this.InvalidateProperties();
            }
        }</pre>

Fragment 2 in file Scripts\Items\Equipment\Talismans\BaseTalisman.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public int MaxHitPoints
        {
            get
            {
                return this.m_MaxHitPoints;
            }
            set
            {
                this.m_MaxHitPoints = value;

                if (this.m_MaxHitPoints > 255)
                    this.m_MaxHitPoints = 255;

                this.InvalidateProperties();
            }
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0); // version
            writer.Write((int)_Type);
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Items\CardOfSemidar.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);

            writer.Write((int)0);
            writer.Write((int)_Type);
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();
            _Type = (CraftableAddonType)reader.ReadInt();
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Items\CardOfSemidar.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();
            _Type = (CardType)reader.ReadInt();
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\PlantClippings.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write((int)1);

            writer.Write((int)m_PlantHue);
        }</pre>

Fragment 2 in file Scripts\Services\BasketWeaving\MiscSAResources.cs

<pre>public override void Serialize(GenericWriter writer)
        {
            base.Serialize(writer);
            writer.Write((int)1);

            writer.Write((int)m_PlantHue);
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\BaseRunicTool.cs

<pre>(item.ItemID >= 0x4263 && item.ItemID <= 0x4272) || (item.ItemID >= 0x4277 && item.ItemID <= 0x4286) || (item.ItemID >= 17607 && item.ItemID <= 17610)</pre>

Fragment 2 in file Scripts\Skills\Imbuing\Core\Imbuing.cs

<pre>(item.ItemID >= 0x4277 && item.ItemID <= 0x4286) ||
						(item.ItemID >= 0x4263 && item.ItemID <= 0x4272) ||
						(item.ItemID >= 17607 && item.ItemID <= 17610)</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\VendorAI.cs

<pre>if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("{0} is attacking me", this.m_Mobile.Combatant.Name);

                this.m_Mobile.Say(Utility.RandomList(1005305, 501603));</pre>

Fragment 2 in file Scripts\Mobiles\AI\VendorAI.cs

<pre>if (this.m_Mobile.Debug)
                    this.m_Mobile.DebugSay("{0} is attacking me", this.m_Mobile.Combatant.Name);

                this.m_Mobile.Say(Utility.RandomList(1005305, 501603));</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ArchDaemon.cs

<pre>public override void GenerateLoot()
        {
            this.AddLoot(LootPack.Rich);
            this.AddLoot(LootPack.Average, 2);
            this.AddLoot(LootPack.MedScrolls, 2);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\PitFiend.cs

<pre>public override void GenerateLoot()
        {
            this.AddLoot(LootPack.Rich);
            this.AddLoot(LootPack.Average, 2);
            this.AddLoot(LootPack.MedScrolls, 2);
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\GargishOutcast.cs

<pre>public override void GenerateLoot()
        {
            this.AddLoot(LootPack.UltraRich);
            this.AddLoot(LootPack.MedScrolls, 2);
            this.AddLoot(LootPack.HighScrolls, 2);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GargishRouser.cs

<pre>public override void GenerateLoot()
        {
            this.AddLoot(LootPack.UltraRich);
            this.AddLoot(LootPack.MedScrolls, 2);
            this.AddLoot(LootPack.HighScrolls, 2);
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\BaseVendor.cs

<pre>if (Female = GetGender())
			{
				Body = 0x191;
				Name = NameList.RandomName("female");
			}
			else
			{
				Body = 0x190;
				Name = NameList.RandomName("male");
			}</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\GalleonPilot.cs

<pre>if (Female = GetGender())
            {
                Body = 0x191;
                Name = NameList.RandomName("female");
            }
            else
            {
                Body = 0x190;
                Name = NameList.RandomName("male");
            }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\CustomHairstylist.cs

<pre>m_FacialHair = facialHair;
			m_Entries = entries;

			from.CloseGump(typeof(HairstylistBuyGump));
			from.CloseGump(typeof(ChangeHairHueGump));
			from.CloseGump(typeof(ChangeHairstyleGump));</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\CustomHairstylist.cs

<pre>m_FacialHair = facialHair;
			m_Entries = entries;

			from.CloseGump(typeof(HairstylistBuyGump));
			from.CloseGump(typeof(ChangeHairHueGump));
			from.CloseGump(typeof(ChangeHairstyleGump));</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\PlayerMobile.cs

<pre>p =
							Packet.Acquire(
								new UnicodeMessage(
									from.Serial, from.Body, MessageType.Regular, from.SpeechHue, 3, from.Language, from.Name, text));</pre>

Fragment 2 in file Scripts\Services\Party\Party.cs

<pre>p = Packet.Acquire(new UnicodeMessage(from.Serial, from.Body, MessageType.Regular, from.SpeechHue, 3, from.Language, from.Name, text));</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Void Creatures\Ballem.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (Utility.RandomDouble() < 0.10)
            {
                c.DropItem(new AncientPotteryFragments());
            }
        }</pre>

Fragment 2 in file Scripts\Mobiles\Void Creatures\Betballem.cs

<pre>public override void OnDeath(Container c)
        {
            base.OnDeath(c);

            if (Utility.RandomDouble() < 0.10)
            {
                c.DropItem(new AncientPotteryFragments());
            }
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Items.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);
			int v = reader.ReadInt();

			RugType = (RugHue)reader.ReadInt();
		}</pre>

Fragment 2 in file Scripts\Quests\Eodon\Valley of One Quest\Items.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);
			int v = reader.ReadInt();

			RugType = (RugHue)reader.ReadInt();
		}</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ConPVP\Tournament.cs

<pre>PyramidLevel top = this.m_Pyramid.Levels[this.m_Pyramid.Levels.Count - 1] as PyramidLevel;

                        if (top.FreeAdvance != null || top.Matches.Count != 1)
                            break;</pre>

Fragment 2 in file Scripts\Services\ConPVP\Tournament.cs

<pre>PyramidLevel top = this.m_Pyramid.Levels[this.m_Pyramid.Levels.Count - 1] as PyramidLevel;

                        if (top.FreeAdvance != null || top.Matches.Count != 1)
                            break;</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Items.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(p, map, EffectItem.DefaultDuration), 0x3709, 10, 30, 5052);
                                        Effects.PlaySound(p, map, 0x243);</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Items.cs

<pre>Effects.SendLocationParticles(EffectItem.Create(p, map, EffectItem.DefaultDuration), 0x3709, 10, 30, 5052);
                                            Effects.PlaySound(p, map, 0x243); //TODO: Get sound</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionDeathKnight.cs

<pre>Item shroud = new Item(0x204E);
            shroud.Layer = Layer.OuterTorso;

            this.AddItem(this.Immovable(this.Rehued(shroud, 1109)));</pre>

Fragment 2 in file Scripts\Services\Factions\Mobiles\Guards\Types\FactionNecromancer.cs

<pre>Item shroud = new Item(0x204E);
            shroud.Layer = Layer.OuterTorso;

            this.AddItem(this.Immovable(this.Rehued(shroud, 1109)));</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Reports\Rendering\HtmlRenderer.cs

<pre>bmp.Save(Path.Combine(this.m_OutputDirectory, fileName), ImageFormat.Png);

            html.Write("<!-- ");

            html.AddAttribute(HtmlAttr.Href, "#");</pre>

Fragment 2 in file Scripts\Services\Reports\Rendering\HtmlRenderer.cs

<pre>bmp.Save(Path.Combine(this.m_OutputDirectory, fileName), ImageFormat.Png);

            html.Write("<!-- ");

            html.AddAttribute(HtmlAttr.Href, "#");</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\ExodusArchZealot.cs

<pre>AddImage(97, 49, 9005);
            AddImageTiled(58, 39, 29, 390, 10460);
            AddImageTiled(412, 37, 31, 389, 10460);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolderGumps.cs

<pre>AddImage(97, 49, 9005); // quest ribbon

            AddImageTiled(58, 39, 29, 390, 10460); // left hand border
            AddImageTiled(412, 37, 31, 389, 10460); // right hand border</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Underworld\ExperimentalRoom\ExperimentalRoomDoor.cs

<pre>public override void Serialize(GenericWriter writer) {
			base.Serialize(writer);
			writer.Write((int)0); // ver
			writer.Write((int)m_Room);
		}</pre>

Fragment 2 in file Scripts\Services\Underworld\ExperimentalRoom\ExperimentalRoomDoor.cs

<pre>public override void Serialize(GenericWriter writer) {
			base.Serialize(writer);
			writer.Write((int)0); // ver
			writer.Write((int)m_Room);
		}</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Underworld\ExperimentalRoom\ExperimentalRoomDoor.cs

<pre>public override void Deserialize(GenericReader reader) {
			base.Deserialize(reader);
			int version = reader.ReadInt();
			m_Room = (Room)reader.ReadInt();
		}</pre>

Fragment 2 in file Scripts\Services\Underworld\ExperimentalRoom\ExperimentalRoomDoor.cs

<pre>public override void Deserialize(GenericReader reader) {
			base.Deserialize(reader);
			int version = reader.ReadInt();
			m_Room = (Room)reader.ReadInt();
		}</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>Point3D eloc1 = new Point3D(0, 0, 0);
								Point3D eloc2 = new Point3D(0, 0, 0);
								Map emap = Map.Internal;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>Point3D eloc1 = new Point3D(0, 0, 0);
									Point3D eloc2 = new Point3D(0, 0, 0);
									Map emap = Map.Internal;</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlData.cs

<pre>public override void Serialize( GenericWriter writer )
		{
			base.Serialize(writer);

			writer.Write( (int) 0 );
			// version 0
			writer.Write((string)m_DataValue);

		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlLocalVariable.cs

<pre>public override void Serialize( GenericWriter writer )
		{
			base.Serialize(writer);

			writer.Write( (int) 0 );
			// version 0
			writer.Write((string)m_DataValue);

		}</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>if (AttachedTo is Item && ((Item)AttachedTo).Parent == null)
                {
                    Item i = AttachedTo as Item;
                    loc = i.Location;
                    map = i.Map;
                }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>if (AttachedTo is Item && ((Item)AttachedTo).Parent == null)
                {
                    Item i = AttachedTo as Item;
                    loc = i.Location;
                    map = i.Map;
                }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlSkill.cs

<pre>try
			{
				m_Skill = (SkillName)Enum.Parse( typeof( SkillName ), skill, true );
			} 
			catch {}
			m_Value = value;
			m_Duration = TimeSpan.FromMinutes(duration);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlSkill.cs

<pre>try
			{
				m_Skill = (SkillName)Enum.Parse( typeof( SkillName ), skill, true );
			} 
			catch {}
			m_Value = value;
			m_Duration = TimeSpan.FromMinutes(duration);</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolderGumps.cs

<pre>if (arglist.Length > 1)
                            {
                                //name = arglist[1];
                                type = arglist[1];
                            }

                            XmlQuest.CheckArgList(arglist, 2, null, out typestr, out targetcount, out checkprop, out status_str);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolderGumps.cs

<pre>if (arglist.Length > 1)
                            {
                                //name = arglist[1];
                                type = arglist[1];
                            }

                            XmlQuest.CheckArgList(arglist, 2, null, out typestr, out targetcount, out checkprop, out status_str);</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>switch (todmode)
			{
				case (int)TODModeType.Realtime:
					XmlSpawner.defTODMode = TODModeType.Realtime;
					break;
				case (int)TODModeType.Gametime:
					XmlSpawner.defTODMode = TODModeType.Gametime;
					break;
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>switch (todmode)
																							{
																								case (int)TODModeType.Gametime:
																									XmlSpawner.defTODMode = TODModeType.Gametime;
																									break;
																								case (int)TODModeType.Realtime:
																									XmlSpawner.defTODMode = TODModeType.Realtime;
																									break;
																							}</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>if (positionrange > 0)
									{
										x += Utility.Random(positionrange * 2 + 1) - positionrange;
										y += Utility.Random(positionrange * 2 + 1) - positionrange;
									}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>if (positionrange > 0)
										{
											x += Utility.Random(positionrange * 2 + 1) - positionrange;
											y += Utility.Random(positionrange * 2 + 1) - positionrange;
										}</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawnerGumps.cs

<pre>{
							m_Spawner.SpawnObjects[i].MinDelay = -1;
							m_Spawner.SpawnObjects[i].MaxDelay = -1;
							m_Spawner.RefreshNextSpawnTime(m_Spawner.SpawnObjects[i]);
						}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawnerGumps.cs

<pre>{
							m_Spawner.SpawnObjects[i].MinDelay = -1;
							m_Spawner.SpawnObjects[i].MaxDelay = -1;
							m_Spawner.RefreshNextSpawnTime(m_Spawner.SpawnObjects[i]);
						}</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>if (mob == null || mob.Deleted || mob.Map == null || mob.Map == Map.Internal) return;
						m_From.Location = mob.Location;
						m_From.Map = mob.Map;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>if (mob == null || mob.Deleted || mob.Map == null || mob.Map == Map.Internal) return;
								m_From.Location = mob.Location;
								m_From.Map = mob.Map;</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\MysticWeapon.cs

<pre>public override SkillName DamageSkill
        {
            get
            {
                if (Caster.Skills[SkillName.Focus].Value > Caster.Skills[SkillName.Imbuing].Value)
                    return SkillName.Focus;

                return SkillName.Imbuing;
            }
        }</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\NetherBlast.cs

<pre>public override SkillName DamageSkill
        {
            get
            {
                if (Caster.Skills[SkillName.Focus].Value > Caster.Skills[SkillName.Imbuing].Value)
                    return SkillName.Focus;

                return SkillName.Imbuing;
            }
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Server\Persistence\FileQueue.cs

<pre>this.active[slot] = new Chunk(this, slot, page.buffer, 0, page.length);

                        this.callback(this.active[slot]);</pre>

Fragment 2 in file Server\Persistence\FileQueue.cs

<pre>this.active[slot] = new Chunk(this, slot, page.buffer, 0, page.length);

                    this.callback(this.active[slot]);</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void Write(Map value)
		{
			if (value != null)
			{
				Write((byte)value.MapIndex);
			}
			else
			{
				Write((byte)0xFF);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void Write(Map value)
		{
			if (value != null)
			{
				Write((byte)value.MapIndex);
			}
			else
			{
				Write((byte)0xFF);
			}
		}</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void Write(Race value)
		{
			if (value != null)
			{
				Write((byte)value.RaceIndex);
			}
			else
			{
				Write((byte)0xFF);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void Write(Race value)
		{
			if (value != null)
			{
				Write((byte)value.RaceIndex);
			}
			else
			{
				Write((byte)0xFF);
			}
		}</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Ultima\TileMatrix.cs

<pre>public HuedTile[] GetStaticTiles(int x, int y)
		{
			return GetStaticBlock(x >> 3, y >> 3)[x & 0x7][y & 0x7];
		}</pre>

Fragment 2 in file Ultima\TileMatrixPatch.cs

<pre>public HuedTile[] GetStaticTiles(int x, int y)
		{
			return GetStaticBlock(x >> 3, y >> 3)[x & 0x7][y & 0x7];
		}</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Aegis.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version < 1)
                this.PhysicalBonus = 0;
        }</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\HolyKnightsBreastplate.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version < 1)
                this.PhysicalBonus = 0;
        }</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\MidnightBracers.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);

            int version = reader.ReadInt();

            if (version < 1)
                this.PhysicalBonus = 0;
        }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>AddButton(338, 437, 4014, 4016, 0, GumpButtonType.Page, 1);
			AddHtml(290, 440, 35, 40, "Back", false, false);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>AddButton(338, 437, 4014, 4016, 0, GumpButtonType.Page, 1);
			AddHtml(290, 440, 35, 40, "Back", false, false);</pre>

Fragment 3 in file Scripts\Mobiles\NPCs\PlayerBarkeeper.cs

<pre>AddButton(338, 437, 4014, 4016, 0, GumpButtonType.Page, 1);
				AddHtml(290, 440, 35, 40, "Back", false, false);</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\City Loyalty System\Items\Banners.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            City = (City)reader.ReadInt();
        }</pre>

Fragment 2 in file Scripts\Services\City Loyalty System\Items\Banners.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            City = (City)reader.ReadInt();
        }</pre>

Fragment 3 in file Scripts\Services\City Loyalty System\Items\CityMessageBoard.cs

<pre>public override void Deserialize(GenericReader reader)
		{
			base.Deserialize(reader);
			int version = reader.ReadInt();

            City = (City)reader.ReadInt();
		}</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Initiation\InitiationArms.cs

<pre>this.Hue = 0x9C4;
			this.LootType = LootType.Blessed;
			//this.Attributes.Brittle = 1; //If you have imbuing add this part in!!!!

			SetHue = 0x30;	
			SetPhysicalBonus = 2;
			SetFireBonus = 5;
			SetColdBonus = 5;
			SetPoisonBonus = 3;
			SetEnergyBonus = 5;</pre>

Fragment 2 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Initiation\InitiationCap.cs

<pre>this.Hue = 0x9C4;
			//this.Attributes.Brittle = 1; //If you have imbuing add this part in!!!!
			this.LootType = LootType.Blessed;

			SetHue = 0x30;	
			SetPhysicalBonus = 2;
			SetFireBonus = 5;
			SetColdBonus = 5;
			SetPoisonBonus = 3;
			SetEnergyBonus = 5;</pre>

Fragment 3 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Initiation\InitiationChest.cs

<pre>this.Hue = 0x9C4;
			//this.Attributes.Brittle = 1; //If you have imbuing add this part in!!!!
			this.LootType = LootType.Blessed;

			SetHue = 0x30;
			SetPhysicalBonus = 2;
			SetFireBonus = 5;
			SetColdBonus = 5;
			SetPoisonBonus = 3;
			SetEnergyBonus = 5;</pre>

Fragment 4 in file Scripts\Items\Artifacts\Equipment\Armor\Sets\Initiation\InitiationLegs.cs

<pre>this.Hue = 0x9C4;
			//this.Attributes.Brittle = 1; //If you have imbuing add this part in!!!!
			this.LootType = LootType.Blessed;

			SetHue = 0x30;
			SetPhysicalBonus = 2;
			SetFireBonus = 5;
			SetColdBonus = 5;
			SetPoisonBonus = 3;
			SetEnergyBonus = 5;</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\AuctionSafe\Auction.cs

<pre>String.Format("{0}\t{1}\t{2}", 
															name, 
															CurrentPlatBid.ToString("N0", CultureInfo.GetCultureInfo("en-US")), 
															CurrentGoldBid.ToString("N0", CultureInfo.GetCultureInfo("en-US")))</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\AuctionSafe\Auction.cs

<pre>String.Format("{0}\t{1}\t{2}",
                                                        name,
                                                        CurrentPlatBid.ToString("N0", CultureInfo.GetCultureInfo("en-US")),
                                                        CurrentGoldBid.ToString("N0", CultureInfo.GetCultureInfo("en-US")))</pre>

Fragment 3 in file Scripts\Services\Expansions\Time Of Legends\AuctionSafe\Auction.cs

<pre>String.Format("{0}\t{1}\t{2}",
                                                        name,
                                                        CurrentPlatBid.ToString("N0", CultureInfo.GetCultureInfo("en-US")),
                                                        CurrentGoldBid.ToString("N0", CultureInfo.GetCultureInfo("en-US")))</pre>

Fragment 4 in file Scripts\Services\Expansions\Time Of Legends\AuctionSafe\Auction.cs

<pre>String.Format("{0}\t{1}\t{2}",
                                                                CurrentPlatBid.ToString("N0", CultureInfo.GetCultureInfo("en-US")),
                                                                CurrentGoldBid.ToString("N0", CultureInfo.GetCultureInfo("en-US")),
                                                                name)</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Necromancy\BloodOathSpell.cs

<pre>if (this.CheckHSequence(m))
            {
                SpellHelper.Turn(this.Caster, m);

                ApplyEffects(m);
                ConduitSpell.CheckAffected(Caster, m, ApplyEffects);
            }</pre>

Fragment 2 in file Scripts\Spells\Necromancy\CorpseSkin.cs

<pre>if (this.CheckHSequence(m))
            {
                SpellHelper.Turn(this.Caster, m);

                ApplyEffects(m);
                ConduitSpell.CheckAffected(Caster, m, ApplyEffects);
            }</pre>

Fragment 3 in file Scripts\Spells\Necromancy\EvilOmen.cs

<pre>if (this.CheckHSequence(m))
            {
                SpellHelper.Turn(this.Caster, m);

                ApplyEffects(m);
                ConduitSpell.CheckAffected(Caster, m, ApplyEffects);
            }</pre>

Fragment 4 in file Scripts\Spells\Necromancy\MindRot.cs

<pre>if (this.CheckHSequence(m))
            {
                SpellHelper.Turn(this.Caster, m);

                ApplyEffects(m);
                ConduitSpell.CheckAffected(Caster, m, ApplyEffects);
            }</pre>

## Duplicated Code. Size: 73

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Items\QuestItems\SorcerersRegs.cs

<pre>if (!from.InRange(this, 2))
                from.SendLocalizedMessage(500446); // That is too far away.

            if (!(from is PlayerMobile))
                return;

            PlayerMobile pm = (PlayerMobile)from;</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\QuestItems\SorcerersRegs.cs

<pre>if (!from.InRange(this, 2))
                from.SendLocalizedMessage(500446); // That is too far away.

            if (!(from is PlayerMobile))
                return;

            PlayerMobile pm = (PlayerMobile)from;</pre>

Fragment 3 in file Scripts\Services\ExploringTheDeep\Items\QuestItems\SorcerersRegs.cs

<pre>if (!from.InRange(this, 2))
                from.SendLocalizedMessage(500446); // That is too far away.

            if (!(from is PlayerMobile))
                return;

            PlayerMobile pm = (PlayerMobile)from;</pre>

Fragment 4 in file Scripts\Services\ExploringTheDeep\Items\QuestItems\SorcerersRegs.cs

<pre>if (!from.InRange(this, 2))
                from.SendLocalizedMessage(500446); // That is too far away.

            if (!(from is PlayerMobile))
                return;

            PlayerMobile pm = (PlayerMobile)from;</pre>

Fragment 5 in file Scripts\Services\ExploringTheDeep\Items\QuestItems\SorcerersRegs.cs

<pre>if (!from.InRange(this, 2))
                from.SendLocalizedMessage(500446); // That is too far away.

            if (!(from is PlayerMobile))
                return;

            PlayerMobile pm = (PlayerMobile)from;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Abilities\SAPropEffects.cs

<pre>{
            if (m.NetState != null && !TransformationSpellHelper.UnderTransformation(m, typeof(AnimalForm))
                && m.AccessLevel < AccessLevel.GameMaster)
                m.Send(SpeedControl.WalkSpeed);
        }</pre>

Fragment 2 in file Scripts\Regions\TwistedWealdDesert.cs

<pre>{
            if (m.NetState != null &&
                !TransformationSpellHelper.UnderTransformation(m, typeof(AnimalForm)) &&
                m.AccessLevel < AccessLevel.GameMaster)
                m.Send(SpeedControl.WalkSpeed);
        }</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\New Guild System\OtherGuildInfo.cs

<pre>{
                                pm.SendLocalizedMessage(1063239, String.Format("{0}\t{1}", this.m_Other.Name, otherAlliance.Name)); // ~1_val~ is not the leader of the ~2_val~ alliance.
                                pm.SendLocalizedMessage(1070707, otherAlliance.Leader.Name); // You need to negotiate via ~1_val~ instead.
                            }</pre>

Fragment 2 in file Scripts\Gumps\Guilds\New Guild System\War Declaration gump.cs

<pre>{
                            pm.SendLocalizedMessage(1063239, String.Format("{0}\t{1}", this.m_Other.Name, otherAlliance.Name)); // ~1_val~ is not the leader of the ~2_val~ alliance.
                            pm.SendLocalizedMessage(1070707, otherAlliance.Leader.Name); // You need to negotiate via ~1_val~ instead.
                        }</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\HouseGump.cs

<pre>Item sign = this.m_House.Sign;

            if (sign == null || from.Map != sign.Map || !from.InRange(sign.GetWorldLocation(), 18))
                return;</pre>

Fragment 2 in file Scripts\Gumps\HouseGumpAOS.cs

<pre>Item sign = this.m_House.Sign;

            if (sign == null || from.Map != sign.Map || !from.InRange(sign.GetWorldLocation(), 18))
                return;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>this.m_Vendor.Animate(32, 5, 1, true, false, 0);//bow
                    this.m_Vendor.SayTo(from, 1043310 + Utility.Random(12)); // a little random speech</pre>

Fragment 2 in file Scripts\Gumps\PlayerVendorGumps.cs

<pre>this.m_Vendor.Animate(32, 5, 1, true, false, 0); // bow
                        this.m_Vendor.SayTo(from, 1043310 + Utility.Random(12)); // a little random speech</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BedOfNails.cs

<pre>this.AddComponent(new BedOfNailsComponent(0x2A81), 0, 0, 0);
            this.AddComponent(new BedOfNailsComponent(0x2A82), 0, -1, 0);</pre>

Fragment 2 in file Scripts\Items\Addons\BedOfNails.cs

<pre>this.AddComponent(new BedOfNailsComponent(0x2A81), 0, 0, 0);
                    this.AddComponent(new BedOfNailsComponent(0x2A82), 0, -1, 0);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\BoneCouch.cs

<pre>this.AddComponent(new BoneCouchComponent(0x2A5A), 0, 0, 0);
            this.AddComponent(new BoneCouchComponent(0x2A5B), -1, 0, 0);</pre>

Fragment 2 in file Scripts\Items\Addons\BoneCouch.cs

<pre>this.AddComponent(new BoneCouchComponent(0x2A5A), 0, 0, 0);
                    this.AddComponent(new BoneCouchComponent(0x2A5B), -1, 0, 0);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\GlovesOfMining.cs

<pre>base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_Bonus = reader.ReadInt();
                        break;
                    }
            }</pre>

Fragment 2 in file Scripts\Items\Tools\AncientSmithyHammer.cs

<pre>base.Deserialize(reader);

            int version = reader.ReadInt();

            switch ( version )
            {
                case 0:
                    {
                        this.m_Bonus = reader.ReadInt();
                        break;
                    }
            }</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Jewelry\BlueDiamondRing.cs

<pre>break;
                case 1:
                    this.Attributes.CastSpeed += 1;
                    break;
                case 2:
                    this.Attributes.CastRecovery += 2;
                    break;
                case 3:
                    this.Attributes.SpellDamage += 5;
                    break;</pre>

Fragment 2 in file Scripts\Items\Equipment\Jewelry\BrilliantAmberBracelet.cs

<pre>break;
                case 1:
                    this.Attributes.CastSpeed += 1;
                    break;
                case 2:
                    this.Attributes.CastRecovery += 2;
                    break;
                case 3:
                    this.Attributes.SpellDamage += 5;
                    break;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>int phys, fire, cold, pois, nrgy, chaos, direct;
			GetDamageTypes(null, out phys, out fire, out cold, out pois, out nrgy, out chaos, out direct);</pre>

Fragment 2 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>int phys, fire, cold, pois, nrgy, chaos, direct;

			GetDamageTypes(null, out phys, out fire, out cold, out pois, out nrgy, out chaos, out direct);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Resource\PotionKeg.cs

<pre>from.PlaySound(0x240);

                        from.SendLocalizedMessage(502237); // You place the empty bottle in your backpack.

                        item.Consume(toHold);

                        if (!item.Deleted)
                            item.Bounce(from);

                        return true;</pre>

Fragment 2 in file Scripts\Items\Resource\PotionKeg.cs

<pre>from.PlaySound(0x240);

                        from.SendLocalizedMessage(502237); // You place the empty bottle in your backpack.

                        item.Consume(toHold);

                        if (!item.Deleted)
                            item.Bounce(from);

                        return true;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>object[] args = arg as object[];
            Mobile m = args[0] as Mobile;
            int hue = (int)args[1];</pre>

Fragment 2 in file Scripts\Items\Tools\GMHidingStone.cs

<pre>object[] args = arg as object[];
            Mobile m = args[0] as Mobile;
            int hue = (int)args[1];</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\Notoriety.cs

<pre>pmFrom.DuelContext != null && pmFrom.DuelContext == pmTarg.DuelContext && pmFrom.DuelContext.m_Tournament != null && pmFrom.DuelContext.m_Tournament.IsNotoRestricted && pmFrom.DuelPlayer != null && pmTarg.DuelPlayer != null</pre>

Fragment 2 in file Scripts\Misc\Notoriety.cs

<pre>pmFrom.DuelContext != null && pmFrom.DuelContext == pmTarg.DuelContext && pmFrom.DuelContext.m_Tournament != null && pmFrom.DuelContext.m_Tournament.IsNotoRestricted && pmFrom.DuelPlayer != null && pmTarg.DuelPlayer != null</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>m_Mobile.Combatant != null && !m_Mobile.Combatant.Deleted &&
                m_Mobile.Combatant.Alive && (!(m_Mobile.Combatant is Mobile) || !((Mobile)m_Mobile.Combatant).IsDeadBondedPet)</pre>

Fragment 2 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>m_Mobile.Combatant != null && !m_Mobile.Combatant.Deleted &&
                            m_Mobile.Combatant.Alive && (!(m_Mobile.Combatant is Mobile) || !((Mobile)m_Mobile.Combatant).IsDeadBondedPet)</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\Omni AI\OmniAI Core.cs

<pre>(targ.Range == -1 || this.m_Mobile.InRange(toTarget, targ.Range)) && this.m_Mobile.CanSee(toTarget) && this.m_Mobile.InLOS(toTarget)</pre>

Fragment 2 in file Scripts\Mobiles\AI\SpellbinderAI.cs

<pre>(targ.Range == -1 || this.m_Mobile.InRange(toTarget, targ.Range)) && this.m_Mobile.CanSee(toTarget) && this.m_Mobile.InLOS(toTarget)</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\Omni AI\OmniAI Necromancy.cs

<pre>BaseWeapon weapon = this.m_Mobile.FindItemOnLayer(Layer.OneHanded) as BaseWeapon;

                if (weapon == null)
                    weapon = this.m_Mobile.FindItemOnLayer(Layer.TwoHanded) as BaseWeapon;</pre>

Fragment 2 in file Scripts\Mobiles\AI\Omni AI\OmniAI Shared.cs

<pre>BaseWeapon weapon = this.m_Mobile.FindItemOnLayer(Layer.OneHanded) as BaseWeapon;

            if (weapon == null)
                weapon = this.m_Mobile.FindItemOnLayer(Layer.TwoHanded) as BaseWeapon;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\DreadHorn.cs

<pre>from.MoveToWorld(GetSpawnPosition(1), Map);
                    from.FixedParticles(0x376A, 9, 32, 0x13AF, EffectLayer.Waist);
                    from.PlaySound(0x1FE);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DemonKnight.cs

<pre>from.MoveToWorld(GetSpawnPosition(1), Map);
                    from.FixedParticles(0x376A, 9, 32, 0x13AF, EffectLayer.Waist);
                    from.PlaySound(0x1FE);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Bosses\PrimevalLich.cs

<pre>Mobile target = null;

                if (attacker is BaseCreature)
                {
                    Mobile m = ((BaseCreature)attacker).GetMaster();

                    if (m != null)
                        target = m;
                }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\Yamandon.cs

<pre>Mobile target = null;

                if (attacker is BaseCreature)
                {
                    Mobile m = ((BaseCreature)attacker).GetMaster();

                    if (m != null)
                        target = m;
                }</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\AirElemental.cs

<pre>this.SetStr(126, 155);
            this.SetDex(166, 185);
            this.SetInt(101, 125);

            this.SetHits(76, 93);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\FireElemental.cs

<pre>this.SetStr(126, 155);
            this.SetDex(166, 185);
            this.SetInt(101, 125);

            this.SetHits(76, 93);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Alligator.cs

<pre>this.SetStr(76, 100);
            this.SetDex(6, 25);
            this.SetInt(11, 20);

            this.SetHits(46, 60);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\GiantToad.cs

<pre>this.SetStr(76, 100);
            this.SetDex(6, 25);
            this.SetInt(11, 20);

            this.SetHits(46, 60);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Betrayer.cs

<pre>this.SetStr(401, 500);
            this.SetDex(81, 100);
            this.SetInt(151, 200);

            this.SetHits(241, 300);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\JukaLord.cs

<pre>this.SetStr(401, 500);
            this.SetDex(81, 100);
            this.SetInt(151, 200);

            this.SetHits(241, 300);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Brigand.cs

<pre>this.SetStr(86, 100);
            this.SetDex(81, 95);
            this.SetInt(61, 75);

            this.SetDamage(10, 23);</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\HirePaladin.cs

<pre>this.SetStr(86, 100);
            this.SetDex(81, 95);
            this.SetInt(61, 75);

            this.SetDamage(10, 23);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\BaseEscortable.cs

<pre>this.SetStr(90, 100);
            this.SetDex(90, 100);
            this.SetInt(15, 25);

            this.Hue = Utility.RandomSkinHue();</pre>

Fragment 2 in file Scripts\Services\MondainsLegacyQuests\BaseEscort.cs

<pre>this.SetStr(90, 100);
            this.SetDex(90, 100);
            this.SetInt(15, 25);

            this.Hue = Utility.RandomSkinHue();</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\Taellia.cs

<pre>range >= 0 && this.InRange(m, range) && !this.InRange(oldLocation, range) && DateTime.UtcNow >= this.m_Spoken + TimeSpan.FromMinutes(1)</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\Yellienir.cs

<pre>range >= 0 && this.InRange(m, range) && !this.InRange(oldLocation, range) && DateTime.UtcNow >= this.m_Spoken + TimeSpan.FromMinutes(1)</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ChampionSystem\ChampionSpawn.cs

<pre>case 3:
                    {
                        this.m_SpawnArea = reader.ReadRect2D();

                        goto case 2;
                    }
                case 2:
                    {
                        this.m_RandomizeType = reader.ReadBool();

                        goto case 1;
                    }
                case 1:</pre>

Fragment 2 in file Scripts\Services\MiniChampionSystem\MiniChampionSpawn.cs

<pre>case 3:
                    {
                        this.m_SpawnArea = reader.ReadRect2D();

                        goto case 2;
                    }
                case 2:
                    {
                        this.m_RandomizeType = reader.ReadBool();

                        goto case 1;
                    }
                case 1:</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefAlchemy.cs

<pre>AddRes(index, typeof(ScouringToxin), 1112292, 2, 1112326);
                SetRequireResTarget(index);
                SetRequiresBasketWeaving(index);
                SetNeededExpansion(index, Expansion.SA);</pre>

Fragment 2 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(ScouringToxin), 1112292, 2, 1112326);
                SetRequiresBasketWeaving(index);
                SetRequireResTarget(index);
                SetNeededExpansion(index, Expansion.SA);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(Shaft), 1027125, 4, 1044351);
                SetRequireResTarget(index);
                SetRequiresBasketWeaving(index);
                SetNeededExpansion(index, Expansion.SA);</pre>

Fragment 2 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(Shaft), 1027125, 4, 1044351);
                SetRequireResTarget(index);
                SetRequiresBasketWeaving(index);
                SetNeededExpansion(index, Expansion.SA);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>object[] obj = (object[])state;
            Mobile from = obj[0] as Mobile;
            Type type = obj[1] as Type;</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Items\Cannons and Ammo\Cannon.cs

<pre>object[] obj = (object[])state;
            Mobile from = obj[0] as Mobile;
            Type type = obj[1] as Type;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\GalleonContainer.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();

            m_Galleon = reader.ReadItem() as BaseGalleon;
        }</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\ShipWheel.cs

<pre>public override void Deserialize(GenericReader reader)
        {
            base.Deserialize(reader);
            int version = reader.ReadInt();
            m_Galleon = reader.ReadItem() as BaseGalleon;
        }</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>hold3.Location = new Point3D(X - 1, Y + 10, Z);
                    hold4.Location = new Point3D(X - 1, Y + 9,  Z);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\OrcishGalleon.cs

<pre>hold3.Location = new Point3D(X + 1, Y - 10, Z);
                    hold4.Location = new Point3D(X + 1, Y - 9, Z);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>hold1.Location = new Point3D(X - 1, Y + 5, Z);
                    hold2.Location = new Point3D(X - 1, Y + 4, Z);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>hold1.Location = new Point3D(X + 1, Y - 5, Z);
                    hold2.Location = new Point3D(X + 1, Y - 4, Z);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>hold4.Location = new Point3D(X - 4, Y + 1, Z);
                    hold5.Location = new Point3D(X - 5, Y + 1, Z);</pre>

Fragment 2 in file Scripts\Services\Expansions\High Seas\Multis\TokunoGalleon.cs

<pre>hold4.Location = new Point3D(X + 4, Y - 1, Z);
                    hold5.Location = new Point3D(X + 5, Y - 1, Z);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Controller.cs

<pre>Encounters = new List<ShadowguardEncounter>();
            Addons = new List<BaseAddon>();
            Queue = new Dictionary<Mobile, EncounterType>();

            InitializeInstances();</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Shadowguard\Controller.cs

<pre>InitializeInstances();

            Encounters = new List<ShadowguardEncounter>();
            Addons = new List<BaseAddon>();
            Queue = new Dictionary<Mobile, EncounterType>();</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Plants\Raised Garden Beds\RaisedGarden.cs

<pre>if (m_Plant != null)
                {
                    if (m_Plant.X != this.X || m_Plant.Y != this.Y || m_Plant.Map != this.Map || m_Plant.Deleted)
                        m_Plant = null;
                }</pre>

Fragment 2 in file Scripts\Services\Plants\Raised Garden Beds\RaisedGarden.cs

<pre>if (m_Plant != null)
                {
                    if (m_Plant.X != this.X || m_Plant.Y != this.Y || m_Plant.Map != this.Map || m_Plant.Deleted)
                        m_Plant = null;
                }</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Plants\Raised Garden Beds\RaisedGardenPlantItem.cs

<pre>if (m_Component != null)
                {
                    if (m_Component.X != this.X || m_Component.Y != this.Y || m_Component.Map != this.Map || m_Component.Deleted)
                        m_Component = null;
                }</pre>

Fragment 2 in file Scripts\Services\Plants\Raised Garden Beds\RaisedGardenPlantItem.cs

<pre>if (m_Component != null)
                {
                    if (m_Component.X != this.X || m_Component.Y != this.Y || m_Component.Map != this.Map || m_Component.Deleted)
                        m_Component = null;
                }</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\DupresKnight.cs

<pre>SetWearable(mks);

            Item bs = new BodySash(0x794); // dark purple
            bs.LootType = LootType.Blessed;
            SetWearable(bs);

            PackGold( 400, 600 );</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\TheExodusEncounter\Mobiles\DupresSquire.cs

<pre>SetWearable(mks);

            Item bs = new BodySash(0x794); // dark purple
            bs.LootType = LootType.Blessed;
            SetWearable(bs);

            PackGold( 400, 600 );</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new NamedInfoCol[] // armor
                    {
                        new NamedInfoCol(AosArmorAttribute.SelfRepair, SelfRepairTable),
                        new NamedInfoCol(AosArmorAttribute.DurabilityBonus, DurabilityTable),
                        new NamedInfoCol(AosArmorAttribute.LowerStatReq, LowerStatReqTable),
                    }</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>new NamedInfoCol[] // shield
                    {
                        new NamedInfoCol(AosArmorAttribute.SelfRepair, SelfRepairTable),
                        new NamedInfoCol(AosArmorAttribute.DurabilityBonus, DurabilityTable),
                        new NamedInfoCol(AosArmorAttribute.LowerStatReq, LowerStatReqTable),
                    }</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>int value = CalculateValue(attr, min, max, perclow, perchigh, ref budget, luckchance, usesqrt);
            weapon.WeaponAttributes[(AosWeaponAttribute)attr] = value;</pre>

Fragment 2 in file Scripts\Services\RunicReforging\RunicReforging.cs

<pre>int value = CalculateValue(attr, min, max, perclow, perchigh, ref budget, luckchance, usesqrt);
            weapon.WeaponAttributes[(AosWeaponAttribute)attr] = value;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\VeteranRewards\CrystalPortals\CorruptedCrystalPortal.cs

<pre>if (e.Handled || e.Blocked || !e.Mobile.InRange(Location, 2))
			{
				return;
			}

			Point3D loc = Point3D.Zero;
			Map map = null;</pre>

Fragment 2 in file Scripts\Services\VeteranRewards\CrystalPortals\CrystalPortal.cs

<pre>if (e.Handled || e.Blocked || !e.Mobile.InRange(Location, 2))
			{
				return;
			}

			Point3D loc = Point3D.Zero;
			Map map = null;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>if (alist != null)
			{
				foreach (XmlAttachment a in alist)
				{
					if (a != null && !a.Deleted && a.HandlesOnSpeech)
					{
						a.OnSpeech(args);
					}
				}
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>if (alist != null)
					{
						foreach (XmlAttachment a in alist)
						{
							if (a != null && !a.Deleted && a.HandlesOnSpeech)
							{
								a.OnSpeech(args);
							}
						}
					}</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestHolder.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
		public new string Name
		{
			get
			{
				if (PlayerMade)
				{
					return "PQ: " + base.Name;
				}
				else
				{
					return base.Name;
				}
			}
			set
			{
				base.Name = value;
				InvalidateProperties();
			}
		}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\XmlQuestToken.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public new string Name
        {
            get
            {
                if (PlayerMade)
                {
                    return "PQ: " + base.Name;
                }
                else
                {
                    return base.Name;
                }
            }
            set
            {
                base.Name = value;
                InvalidateProperties();
            }
        }</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>valid_entry = true;
							try { strEntry = (string)dr["Name"]; }
							catch { valid_entry = false; }
							if (valid_entry) { Name = strEntry; }

							valid_entry = true;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>valid_entry = true;
							try { strEntry = (string)dr["Name"]; }
							catch { valid_entry = false; }
							if (valid_entry) { Name = strEntry; }

							valid_entry = true;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlAdd.cs

<pre>int y = 0;
			XmlSpawnerDefaults.DefaultEntry defs = null;
			if(acct != null)
				defs = XmlSpawnerDefaults.GetDefaults(acct.ToString(), e.Mobile.Name);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>int y = 0;
			XmlSpawnerDefaults.DefaultEntry defs = null;
			if (acct != null)
				defs = XmlSpawnerDefaults.GetDefaults(acct.ToString(), e.Mobile.Name);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomAttacks.cs

<pre>m_attachment = a;

                int specialcount = a.Specials.Count;

                // prepare the page
                AddPage( 0 );

                AddBackground( 0, 0, 70, 75 + specialcount*vertspacing, 5054 );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomDefenses.cs

<pre>m_attachment = a;

                int specialcount = a.Specials.Count;

                // prepare the page
                AddPage( 0 );

                AddBackground( 0, 0, 70, 75 + specialcount*vertspacing, 5054 );</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\LastManStandingGauntlet.cs

<pre>if (killed == null) return;

			/*
			// move the killed player and their corpse to a location
			// you have to replace x,y,z with some valid coordinates
			int x = this.Location.X + 30;
			int y = this.Location.Y + 30;
			int z = this.Location.Z;
			Point3D killedloc = new Point3D(x, y, z);

			ArrayList petlist = new ArrayList();

			foreach (Mobile m in killed.GetMobilesInRange(16))
			{
				if (m is BaseCreature && ((BaseCreature)m).ControlMaster == killed)
				{
					petlist.Add(m);
				}
			}

			// port the pets
			foreach (Mobile m in petlist)
			{
				m.MoveToWorld(killedloc, killed.Map);
			}

			// do the actual moving
			killed.MoveToWorld(killedloc, killed.Map);
			if (killed.Corpse != null)
				killed.Corpse.MoveToWorld(killedloc, killed.Map);
			*/

			if (AutoRes)
            {
                // prepare the autores callback
                    Timer.DelayCall( RespawnTime, new TimerStateCallback( XmlPoints.AutoRes_Callback ),
                    new object[]{ killed, false } );
            }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\ChallengeGames\TeamLMSGauntlet.cs

<pre>if(killed == null) return;

            if(AutoRes)
            {
                // prepare the autores callback
                    Timer.DelayCall( RespawnTime, new TimerStateCallback( XmlPoints.AutoRes_Callback ),
                    new object[]{ killed, false } );
            }</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\BaseTransmutationContainer.cs

<pre>if(from != null && diddrop)
            {
                from.CloseGump( typeof(TransmuteGump) );
                from.SendGump( new TransmuteGump( from, this, null) );
            }

            return diddrop;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSockets\BaseTransmutationContainer.cs

<pre>if(from != null && diddrop)
            {
                from.CloseGump( typeof(TransmuteGump) );
                from.SendGump( new TransmuteGump( from, this, null) );
            }

            return diddrop;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Skills\Tracking.cs

<pre>int hiding = m.Skills[SkillName.Hiding].Fixed;
            int stealth = m.Skills[SkillName.Stealth].Fixed;
            int divisor = hiding + stealth;</pre>

Fragment 2 in file Scripts\Spells\Sixth\Reveal.cs

<pre>int hiding = m.Skills[SkillName.Hiding].Fixed;
            int stealth = m.Skills[SkillName.Stealth].Fixed;
            int divisor = hiding + stealth;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Spells\Skill Masteries\Rejuvinate.cs

<pre>TimeSpan d;

                    if(Caster.AccessLevel == AccessLevel.Player)
                        d = TimeSpan.FromMinutes(duration);
                    else
                        d =  TimeSpan.FromSeconds(10);

                    AddToCooldown(d);</pre>

Fragment 2 in file Scripts\Spells\Skill Masteries\Warcry.cs

<pre>TimeSpan d;

                if (Caster.AccessLevel == AccessLevel.Player)
                    d = TimeSpan.FromMinutes(duration);
                else
                    d = TimeSpan.FromSeconds(10);

                AddToCooldown(d);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Server\Gumps\Gump.cs

<pre>int x,
			int y,
			int normalID,
			int pressedID,
			int buttonID,
			GumpButtonType type,
			int param,
			int itemID,
			int hue,
			int width,
			int height,
			int localizedTooltip</pre>

Fragment 2 in file Server\Gumps\GumpImageTileButton.cs

<pre>int x, int y, int normalID, int pressedID, int buttonID, GumpButtonType type, int param, int itemID, int hue, int width, int height, int localizedTooltip</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Ultima\Art.cs

<pre>if (m_StreamBuffer == null || m_StreamBuffer.Length < length)
			{
				m_StreamBuffer = new byte[length];
			}
			stream.Read(m_StreamBuffer, 0, length);
			stream.Close();</pre>

Fragment 2 in file Ultima\Art.cs

<pre>if (m_StreamBuffer == null || m_StreamBuffer.Length < length)
			{
				m_StreamBuffer = new byte[length];
			}
			stream.Read(m_StreamBuffer, 0, length);
			stream.Close();</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>bool youngFrom = from is PlayerMobile ? ((PlayerMobile)from).Young : false;
				bool youngTo = to is PlayerMobile ? ((PlayerMobile)to).Young : false;</pre>

Fragment 2 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>bool youngFrom = from is PlayerMobile ? ((PlayerMobile)from).Young : false;
				bool youngTo = to is PlayerMobile ? ((PlayerMobile)to).Young : false;</pre>

Fragment 3 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>bool youngFrom = from is PlayerMobile ? ((PlayerMobile)from).Young : false;
				bool youngTo = to is PlayerMobile ? ((PlayerMobile)to).Young : false;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\PlayerMobile.cs

<pre>pet.ControlTarget = null;
					pet.ControlOrder = OrderType.Stay;
					pet.Internalize();

					pet.SetControlMaster(null);
					pet.SummonMaster = null;

					pet.IsStabled = true;</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Mobiles\PetBroker.cs

<pre>pet.ControlTarget = null;
                pet.ControlOrder = OrderType.Stay;
                pet.Internalize();
                pet.SetControlMaster(null);
                pet.SummonMaster = null;
                pet.IsStabled = true;</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\Region.cs

<pre>pet.ControlTarget = null;
                pet.ControlOrder = OrderType.Stay;
                pet.Internalize();

                pet.SetControlMaster(null);
                pet.SummonMaster = null;

                pet.IsStabled = true;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>this.Skills[SkillName.Anatomy].Base = 120;
            this.Skills[SkillName.Healing].Base = 120;
            this.Skills[SkillName.Tactics].Base = 120;</pre>

Fragment 2 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>this.Skills[SkillName.Anatomy].Base = 120;
            this.Skills[SkillName.Healing].Base = 120;
            this.Skills[SkillName.Tactics].Base = 120;</pre>

Fragment 3 in file Scripts\Mobiles\Summons\DummySpecific.cs

<pre>this.Skills[SkillName.Anatomy].Base = 120;
            this.Skills[SkillName.Healing].Base = 120;
            this.Skills[SkillName.Tactics].Base = 120;</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Expansions\Time Of Legends\Myrmidex Invasion\BattleSpawner.cs

<pre>{
                writer.Write(kvp.Key);
                writer.Write(kvp.Value.Count);
                kvp.Value.ForEach(bc => writer.Write(bc));
            }</pre>

Fragment 2 in file Scripts\Services\Expansions\Time Of Legends\Myrmidex Invasion\BattleSpawner.cs

<pre>{
                writer.Write(kvp.Key);
                writer.Write(kvp.Value.Count);
                kvp.Value.ForEach(bc => writer.Write(bc));
            }</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\BlackthornDungeon\InvasionSpawner\InvasionController.cs

<pre>{
				writer.Write(kvp.Key);
				writer.Write(kvp.Value.Count);
				kvp.Value.ForEach(bc => writer.Write(bc));
			}</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>public override bool ValidateArgs(BaseCommandImplementor impl, CommandEventArgs e)
			{
				if (e.Arguments.Length >= 1)
					return true;

				e.Mobile.SendMessage("Usage: " + Usage);
				return false;
			}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>public override bool ValidateArgs(BaseCommandImplementor impl, CommandEventArgs e)
			{
				if (e.Arguments.Length >= 1)
					return true;

				e.Mobile.SendMessage("Usage: " + Usage);
				return false;
			}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XMLSpawner Support\SpawnerExporter.cs

<pre>public override bool ValidateArgs( BaseCommandImplementor impl, CommandEventArgs e )
			{
				if ( e.Arguments.Length >= 1 )
					return true;

				e.Mobile.SendMessage( "Usage: " + Usage );
				return false;
			}</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDeathAction.cs

<pre>string[] arglist = BaseXmlSpawner.ParseString(substitutedtypeName, 3, "/");
					object o = Server.Mobiles.XmlSpawner.CreateObject(type, arglist[0]);</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlDialog.cs

<pre>string[] arglist = BaseXmlSpawner.ParseString(substitutedtypeName, 3, "/");
                    object o = Server.Mobiles.XmlSpawner.CreateObject(type, arglist[0]);</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttachments\XmlUse.cs

<pre>string[] arglist = BaseXmlSpawner.ParseString(substitutedtypeName, 3, "/");
                    object o = Server.Mobiles.XmlSpawner.CreateObject(type, arglist[0]);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(Shaft), 1027125, 2, 1044351);
                SetRequireResTarget(index);
                SetRequiresBasketWeaving(index);
                SetNeededExpansion(index, Expansion.SA);</pre>

Fragment 2 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(Shaft), 1027125, 2, 1044351);
                SetRequireResTarget(index);
                SetRequiresBasketWeaving(index);
                SetNeededExpansion(index, Expansion.SA);</pre>

Fragment 3 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(Shaft), 1027125, 2, 1044351);
                SetRequireResTarget(index);
                SetRequiresBasketWeaving(index);
                SetNeededExpansion(index, Expansion.SA);</pre>

Fragment 4 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(Shaft), 1027125, 2, 1044351);
                SetRequireResTarget(index);
                SetRequiresBasketWeaving(index);
                SetNeededExpansion(index, Expansion.SA);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (item != null)
										{
											pack.DropItem(item);
											// could call applyobjectstringproperties on a nested propertylist here to set item attributes
											if (itemargstring != null)
											{
												ApplyObjectStringProperties(spawner, itemargstring, item, trigmob, refobject, out status_str);
											}
										}</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (item != null)
										{
											pack.DropItem(item);
											// could call applyobjectstringproperties on a nested propertylist here to set item attributes
											if (itemargstring != null)
											{
												ApplyObjectStringProperties(spawner, itemargstring, item, trigmob, refobject, out status_str);
											}
										}</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (item != null)
										{
											pack.DropItem(item);
											// could call applyobjectstringproperties on a nested propertylist here to set item attributes
											if (itemargstring != null)
											{
												ApplyObjectStringProperties(spawner, itemargstring, item, trigmob, refobject, out status_str);
											}
										}</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XmlSpawner Core\BaseXmlSpawner.cs

<pre>if (item != null)
											{
												pack.DropItem(item);
												// could call applyobjectstringproperties on a nested propertylist here to set item attributes
												if (itemargstring != null)
												{
													ApplyObjectStringProperties(spawner, itemargstring, item, trigmob, refobject, out status_str);
												}
											}</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(Shaft), 1027125, 3, 1044351);
                SetRequireResTarget(index);
                SetRequiresBasketWeaving(index);
                SetNeededExpansion(index, Expansion.SA);</pre>

Fragment 2 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(Shaft), 1027125, 3, 1044351);
                SetRequireResTarget(index);
                SetRequiresBasketWeaving(index);
                SetNeededExpansion(index, Expansion.SA);</pre>

Fragment 3 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(Shaft), 1027125, 3, 1044351);
                SetRequireResTarget(index);
                SetRequiresBasketWeaving(index);
                SetNeededExpansion(index, Expansion.SA);</pre>

Fragment 4 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(Shaft), 1027125, 3, 1044351);
                SetRequireResTarget(index);
                SetRequiresBasketWeaving(index);
                SetNeededExpansion(index, Expansion.SA);</pre>

Fragment 5 in file Scripts\Services\Craft\DefTinkering.cs

<pre>AddRes(index, typeof(Shaft), 1027125, 3, 1044351);
                SetRequireResTarget(index);
                SetRequiresBasketWeaving(index);
                SetNeededExpansion(index, Expansion.SA);</pre>

## Duplicated Code. Size: 72

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\New Guild System\OtherGuildInfo.cs

<pre>{
                                pm.SendLocalizedMessage(1063239, String.Format("{0}\t{1}", this.guild.Name, alliance.Name)); // ~1_val~ is not the leader of the ~2_val~ alliance.
                                pm.SendLocalizedMessage(1070707, alliance.Leader.Name); // You need to negotiate via ~1_val~ instead.
                            }</pre>

Fragment 2 in file Scripts\Gumps\Guilds\New Guild System\OtherGuildInfo.cs

<pre>{
                                pm.SendLocalizedMessage(1063239, String.Format("{0}\t{1}", this.guild.Name, alliance.Name)); // ~1_val~ is not the leader of the ~2_val~ alliance.
                                pm.SendLocalizedMessage(1070707, alliance.Leader.Name); // You need to negotiate via ~1_val~ instead.
                            }</pre>

Fragment 3 in file Scripts\Gumps\Guilds\New Guild System\OtherGuildInfo.cs

<pre>{
                                pm.SendLocalizedMessage(1063239, String.Format("{0}\t{1}", this.guild.Name, alliance.Name)); // ~1_val~ is not the leader of the ~2_val~ alliance.
                                pm.SendLocalizedMessage(1070707, alliance.Leader.Name); // You need to negotiate via ~1_val~ instead.
                            }</pre>

Fragment 4 in file Scripts\Gumps\Guilds\New Guild System\OtherGuildInfo.cs

<pre>{
                            pm.SendLocalizedMessage(1063239, String.Format("{0}\t{1}", this.guild.Name, alliance.Name)); // ~1_val~ is not the leader of the ~2_val~ alliance.
                            pm.SendLocalizedMessage(1070707, alliance.Leader.Name); // You need to negotiate via ~1_val~ instead.
                        }</pre>

Fragment 5 in file Scripts\Gumps\Guilds\New Guild System\OtherGuildInfo.cs

<pre>{
                                pm.SendLocalizedMessage(1063239, String.Format("{0}\t{1}", this.guild.Name, alliance.Name)); // ~1_val~ is not the leader of the ~2_val~ alliance.
                                pm.SendLocalizedMessage(1070707, alliance.Leader.Name); // You need to negotiate via ~1_val~ instead.
                            }</pre>

Fragment 6 in file Scripts\Gumps\Guilds\New Guild System\War Declaration gump.cs

<pre>{
                            pm.SendLocalizedMessage(1063239, String.Format("{0}\t{1}", this.guild.Name, alliance.Name)); // ~1_val~ is not the leader of the ~2_val~ alliance.
                            pm.SendLocalizedMessage(1070707, alliance.Leader.Name); // You need to negotiate via ~1_val~ instead.
                        }</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\ViewHousesGump.cs

<pre>if (valid)
                    location = String.Format("{0}° {1}'{2}, {3}° {4}'{5}", yLat, yMins, ySouth ? "S" : "N", xLong, xMins, xEast ? "E" : "W");
                else
                    location = "unknown";</pre>

Fragment 2 in file Scripts\Multis\BaseHouse.cs

<pre>if (valid)
                    location = String.Format("{0}° {1}'{2}, {3}° {4}'{5}", yLat, yMins, ySouth ? "S" : "N", xLong, xMins, xEast ? "E" : "W");
                else
                    location = "unknown";</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\Guillotine.cs

<pre>if (this.ItemID == 4678 || this.ItemID == 4679)
                this.ItemID = 4656;
            else if (this.ItemID == 4712 || this.ItemID == 4713)
                this.ItemID = 4702;</pre>

Fragment 2 in file Scripts\Items\Addons\Guillotine.cs

<pre>if (this.ItemID == 4678 || this.ItemID == 4679)
                this.ItemID = 4656;
            else if (this.ItemID == 4712 || this.ItemID == 4713)
                this.ItemID = 4702;</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\MailboxEastAddon.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);
            list.Add(1072304, this.Owner == null ? "nobody" : this.Owner.Name);
        }</pre>

Fragment 2 in file Scripts\Items\Addons\MailboxSouthAddon.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);
            list.Add(1072304, this.Owner == null ? "nobody" : this.Owner.Name);
        }</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Artifacts\Equipment\Armor\GlovesOfMining.cs

<pre>public override void OnRemoved(object parent)
        {
            base.OnRemoved(parent);

            if (this.m_SkillMod != null)
                this.m_SkillMod.Remove();

            this.m_SkillMod = null;
        }</pre>

Fragment 2 in file Scripts\Items\Tools\AncientSmithyHammer.cs

<pre>public override void OnRemoved(object parent)
        {
            base.OnRemoved(parent);

            if (this.m_SkillMod != null)
                this.m_SkillMod.Remove();

            this.m_SkillMod = null;
        }</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Decorative\BaseStatuette.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.m_TurnedOn)
                list.Add(502695); // turned on
            else
                list.Add(502696); // turned off
        }</pre>

Fragment 2 in file Scripts\Items\Decorative\WindChimes.cs

<pre>public override void GetProperties(ObjectPropertyList list)
        {
            base.GetProperties(list);

            if (this.m_TurnedOn)
                list.Add(502695); // turned on
            else
                list.Add(502696); // turned off
        }</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Tools\BaseHarvestTool.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public ToolQuality Quality
        {
            get
            {
                return this.m_Quality;
            }
            set
            {
                this.UnscaleUses();
                this.m_Quality = value;
                this.InvalidateProperties();
                this.ScaleUses();
            }
        }</pre>

Fragment 2 in file Scripts\Items\Tools\BaseTool.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public ToolQuality Quality
        {
            get
            {
                return this.m_Quality;
            }
            set
            {
                this.UnscaleUses();
                this.m_Quality = value;
                this.InvalidateProperties();
                this.ScaleUses();
            }
        }</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\CrashGuard.cs

<pre>message.Attachments.Add(new Attachment(filePath));

            if (Email.Send(message))
                Console.WriteLine("done");
            else
                Console.WriteLine("failed");</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlAttach\XmlAttach.cs

<pre>message.Attachments.Add(new Attachment(filePath));

				if (Email.Send(message))
					Console.WriteLine("done");
				else
					Console.WriteLine("failed");</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\MondainsLegacy.cs

<pre>tele = new PeerlessTeleporter(altar);
				WeakEntityCollection.Add("ml", tele);
				tele.PointDest = altar.ExitDest;
                tele.Visible = true;
                tele.ItemID = 0xDDA;</pre>

Fragment 2 in file Scripts\Misc\MondainsLegacy.cs

<pre>tele = new PeerlessTeleporter(altar);
				WeakEntityCollection.Add("ml", tele);
				tele.PointDest = altar.ExitDest;
                tele.Visible = true;
                tele.ItemID = 0xDDA;</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>m_Mobile.ControlMaster.RevealingAction();
					m_Mobile.CurrentSpeed = m_Mobile.ActiveSpeed;
					m_Mobile.PlaySound(m_Mobile.GetIdleSound());
					m_Mobile.Warmode = true;
					m_Mobile.Combatant = null;</pre>

Fragment 2 in file Scripts\Mobiles\AI\BaseAI.cs

<pre>m_Mobile.ControlMaster.RevealingAction();
					m_Mobile.CurrentSpeed = m_Mobile.ActiveSpeed;
					m_Mobile.PlaySound(m_Mobile.GetIdleSound());

					m_Mobile.Warmode = true;
					m_Mobile.Combatant = null;</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\Putrefier.cs

<pre>this.SetResistance(ResistanceType.Cold, 50, 60);
            this.SetResistance(ResistanceType.Poison, 100);
            this.SetResistance(ResistanceType.Energy, 40, 50);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\MantraEffervescence.cs

<pre>this.SetResistance(ResistanceType.Cold, 40, 50);
            this.SetResistance(ResistanceType.Poison, 50, 60);
            this.SetResistance(ResistanceType.Energy, 100);</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Named\RakktaviRenowned.cs

<pre>this.SetResistance(ResistanceType.Energy, 10, 20);

            this.SetSkill(SkillName.Anatomy, 0);
            this.SetSkill(SkillName.Archery, 80.1, 90.0);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\ClanCA.cs

<pre>this.SetResistance(ResistanceType.Energy, 10, 20);

            this.SetSkill(SkillName.Anatomy, 0);
            this.SetSkill(SkillName.Archery, 80.1, 90.0);</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\AgapiteElemental.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 30, 40);
            this.SetResistance(ResistanceType.Fire, 40, 50);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\JukaWarrior.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 40, 50);
            this.SetResistance(ResistanceType.Fire, 30, 40);</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\BaseCreature.cs

<pre>((c.Owner != null) && (c.Owner is BaseCreature) &&
                     (((BaseCreature)c.Owner).Summoned || ((BaseCreature)c.Owner).IsBonded))</pre>

Fragment 2 in file Scripts\Spells\Necromancy\AnimateDeadSpell.cs

<pre>((c.Owner != null) && (c.Owner is BaseCreature) && (((BaseCreature)c.Owner).Summoned || ((BaseCreature)c.Owner).IsBonded))</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\ChickenLizard.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 20);
            this.SetResistance(ResistanceType.Fire, 5, 15);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\DesertOstard.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 20);
            this.SetResistance(ResistanceType.Fire, 5, 15);</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\EvilMage.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 20);
            this.SetResistance(ResistanceType.Fire, 5, 10);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\TimberWolf.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 15, 20);
            this.SetResistance(ResistanceType.Fire, 5, 10);</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\FleshGolem.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 50, 60);
            this.SetResistance(ResistanceType.Fire, 25, 35);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\SeaSerpent.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 25, 35);
            this.SetResistance(ResistanceType.Fire, 50, 60);</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\MeerEternal.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 15, 25);</pre>

Fragment 2 in file Scripts\Mobiles\Normal\MeerMage.cs

<pre>this.SetDamageType(ResistanceType.Physical, 100);

            this.SetResistance(ResistanceType.Physical, 45, 55);
            this.SetResistance(ResistanceType.Fire, 15, 25);</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\NPCs\TownCrier.cs

<pre>if (this.m_AutoShoutTimer == null)
                this.m_AutoShoutTimer = Timer.DelayCall(TimeSpan.FromSeconds(5.0), TimeSpan.FromMinutes(1.0), new TimerCallback(AutoShout_Callback));</pre>

Fragment 2 in file Scripts\Mobiles\NPCs\TownCrier.cs

<pre>if (this.m_AutoShoutTimer == null)
                this.m_AutoShoutTimer = Timer.DelayCall(TimeSpan.FromSeconds(5.0), TimeSpan.FromMinutes(1.0), new TimerCallback(AutoShout_Callback));</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\PlayerMobile.cs

<pre>int min = GetMinResistance((ResistanceType)i);
                int max = GetMaxResistance((ResistanceType)i);

                if (max < min)
                {
                    max = min;
                }</pre>

Fragment 2 in file Server\Mobile.cs

<pre>int min = GetMinResistance((ResistanceType)i);
				int max = GetMaxResistance((ResistanceType)i);

				if (max < min)
				{
					max = min;
				}</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\PlayerMobile.cs

<pre>ChampionTitleInfo t = pm.m_ChampionTitles;
				if (t == null)
				{
					return;
				}

				if (t.m_Values == null)
				{
					t.m_Values = new TitleInfo[ChampionSpawnInfo.Table.Length];
				}</pre>

Fragment 2 in file Scripts\Mobiles\PlayerMobile.cs

<pre>ChampionTitleInfo t = pm.m_ChampionTitles;
				if (t == null)
				{
					return;
				}

				if (t.m_Values == null)
				{
					t.m_Values = new TitleInfo[ChampionSpawnInfo.Table.Length];
				}</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Multis\Boats\BaseBoatDeed.cs

<pre>var addon = LighthouseAddon.GetLighthouse(from);

                    if (addon != null)
                    {
                        if (boat.CanLinkToLighthouse)
                            from.SendLocalizedMessage(1154592); // You have linked your boat lighthouse.
                        else
                            from.SendLocalizedMessage(1154597); // Failed to link to lighthouse.
                    }</pre>

Fragment 2 in file Scripts\Multis\Boats\BaseDockedBoat.cs

<pre>var addon = LighthouseAddon.GetLighthouse(from);

                    if (addon != null)
                    {
                        if (boat.CanLinkToLighthouse)
                            from.SendLocalizedMessage(1154592); // You have linked your boat lighthouse.
                        else
                            from.SendLocalizedMessage(1154597); // Failed to link to lighthouse.
                    }</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Eodon\Valley of One Quest\Creatures.cs

<pre>object[] objs = o as object[];
            IPoint3D p = objs[0] as IPoint3D;
            Map map = objs[1] as Map;</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Creatures\Cora.cs

<pre>object[] objs = o as object[];
            IPoint3D p = objs[0] as IPoint3D;
            Map map = objs[1] as Map;</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Quests\Gemkeepers.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(MinotaurArtifact), "minotaur artifacts", 3));		

            this.AddReward(new BaseReward(typeof(RewardBox), 1072584)); // A strongbox.
        }</pre>

Fragment 2 in file Scripts\Quests\TheAncientWorld.cs

<pre>{ 
            this.AddObjective(new ObtainObjective(typeof(MinotaurArtifact), "minotaur artifacts", 3));		

            this.AddReward(new BaseReward(typeof(RewardBox), 1072584)); // A strongbox.
        }</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\CommunityCollections\MuseumDonationBox.cs

<pre>list.Add(c);

                    c = new Static(0x25B6);
                    c.MoveToWorld(new Point3D(2913, 982, -13), this.Map);</pre>

Fragment 2 in file Scripts\Services\CommunityCollections\MuseumDonationBox.cs

<pre>list.Add(c);

                    c = new Static(0x25B6);
                    c.MoveToWorld(new Point3D(2913, 982, -13), this.Map);</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>cliloc1 = 1150578;
						args1 = String.Format("{0}\t{1}\t{2}\t{3}\t{4}", "", FormatAmt(newBid), "", FormatAmt(bankBal), FormatAmt(bankBal - dif));</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>cliloc1 = 1150578;
						args1 = String.Format("{0}\t{1}\t{2}\t{3}\t{4}", "", FormatAmt(newBid), "", FormatAmt(bankBal), FormatAmt(bankBal - dif));</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>cliloc1 = 1150578;
						args1 = String.Format("{0}\t{1}\t{2}\t{3}\t{4}", "", FormatAmt(newBid), "", FormatAmt(bankBal), FormatAmt(bankBal - newBid));</pre>

Fragment 2 in file Scripts\Services\New Magincia\Magincia Bazaar\Gumps\BizaarSignGump.cs

<pre>cliloc1 = 1150578;
						args1 = String.Format("{0}\t{1}\t{2}\t{3}\t{4}", "", FormatAmt(newBid), "", FormatAmt(bankBal), FormatAmt(bankBal - newBid));</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlQuest\QuestRewardGump.cs

<pre>viewpage = page;

			int height = maxItemsPerPage*y_inc + 120;
            int width = x_pointsoffset+110;

			/*
			if(Rewards != null && Rewards.Count > 0)
			{
				height = Rewards.Count*y_inc + 120;
			}
			*/

			AddBackground( 0, 0, width, height, 0xDAC );</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlPoints\PointsRewardGump.cs

<pre>viewpage = page;

            int height = maxItemsPerPage*y_inc + 120;
            int width = x_pointsoffset+110;

            /*
            if(Rewards != null && Rewards.Count > 0)
            {
                height = Rewards.Count*y_inc + 120;
            }
            */

			AddBackground( 0, 0, width, height, 0xDAC );</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>typestr != null && (BaseXmlSpawner.IsTypeOrItemKeyword(typestr) || typestr.IndexOf("{") != -1 || typestr.StartsWith("*") || typestr.StartsWith("#"))</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawnerGumps.cs

<pre>typestr != null && (BaseXmlSpawner.IsTypeOrItemKeyword(typestr) || typestr.IndexOf("{") != -1 || typestr.StartsWith("*") || typestr.StartsWith("#"))</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlEdit.cs

<pre>try
			{
				DisplayFrom = int.Parse(tr.Text);
			} 
			catch{}

			tr = info.GetTextEntry( 300 );        // savefilename info
			if(tr != null)
				SaveFilename = tr.Text;</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlUtils\XmlFind.cs

<pre>try
			{
				DisplayFrom = int.Parse(tr.Text);
			}
			catch { }

			tr = info.GetTextEntry(300);        // savefilename info
			if (tr != null)
				SaveFilename = tr.Text;</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomAttacks.cs

<pre>name, description, id, icon, IconTypes.GumpID, duration,
            mana, stam, hits, karma, minstr, mindex, minint,
            skills, minlevel, reagents, quantity</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlCustomAttacks\Attachments\XmlCustomDefenses.cs

<pre>name, description, id, icon, IconTypes.GumpID, duration,
            mana, stam, hits, karma, minstr, mindex, minint,
            skills, minlevel, reagents, quantity</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCatapult.cs

<pre>new int[] { 1, -1, -1, 1, 0, 0, -2, -2, -1, 1, 1, -2 }</pre>

Fragment 2 in file Scripts\Services\XmlSpawner\XMLSpawner Extras\XmlSiege\SiegeCatapult.cs

<pre>new int[] { 1, -1, -1, -1, 0, -2, -2, 0, 1, -2, 1, 1 }</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Server\Mobile.cs

<pre>BankBox box = FindBankNoCreate();

			if (box != null && box.Opened)
			{
				box.Close();
			}

			if (m_NetState != null)
			{
				m_NetState.CancelAllTrades();
			}</pre>

Fragment 2 in file Server\Mobile.cs

<pre>if (m_NetState != null)
					{
						m_NetState.CancelAllTrades();
					}

					BankBox box = FindBankNoCreate();

					if (box != null && box.Opened)
					{
						box.Close();
					}</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketReader.cs

<pre>(m_Data[m_Index++] << 24) | (m_Data[m_Index++] << 16) | (m_Data[m_Index++] << 8) | m_Data[m_Index++]</pre>

Fragment 2 in file Server\Network\PacketReader.cs

<pre>(m_Data[m_Index++] << 24) | (m_Data[m_Index++] << 16) | (m_Data[m_Index++] << 8) | m_Data[m_Index++]</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Server\Network\PacketReader.cs

<pre>{
			if ((m_Index + 2) > m_Size)
			{
				return 0;
			}

			return (short)((m_Data[m_Index++] << 8) | m_Data[m_Index++]);
		}</pre>

Fragment 2 in file Server\Network\PacketReader.cs

<pre>{
			if ((m_Index + 2) > m_Size)
			{
				return 0;
			}

			return (ushort)((m_Data[m_Index++] << 8) | m_Data[m_Index++]);
		}</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void Write(Item value)
		{
			if (value == null || value.Deleted)
			{
				Write(Serial.MinusOne);
			}
			else
			{
				Write(value.Serial);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void Write(Item value)
		{
			if (value == null || value.Deleted)
			{
				Write(Serial.MinusOne);
			}
			else
			{
				Write(value.Serial);
			}
		}</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void Write(Mobile value)
		{
			if (value == null || value.Deleted)
			{
				Write(Serial.MinusOne);
			}
			else
			{
				Write(value.Serial);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void Write(Mobile value)
		{
			if (value == null || value.Deleted)
			{
				Write(Serial.MinusOne);
			}
			else
			{
				Write(value.Serial);
			}
		}</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Server\Serialization.cs

<pre>public override void Write(SaveData value)
		{
			if (value == null || value.Deleted)
			{
				Write(CustomSerial.MinusOne);
			}
			else
			{
				Write(value.Serial);
			}
		}</pre>

Fragment 2 in file Server\Serialization.cs

<pre>public override void Write(SaveData value)
		{
			if (value == null || value.Deleted)
			{
				Write(CustomSerial.MinusOne);
			}
			else
			{
				Write(value.Serial);
			}
		}</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Ultima\AnimationEdit.cs

<pre>AnimIdx[] cache = GetCache(filetype);
			FileIndex fileIndex;
			int index;
			GetFileIndex(body, filetype, 0, 0, out fileIndex, out index);</pre>

Fragment 2 in file Ultima\AnimationEdit.cs

<pre>AnimIdx[] cache = GetCache(filetype);
			FileIndex fileIndex;
			int index;
			GetFileIndex(body, filetype, 0, 0, out fileIndex, out index);</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Ultima\Art.cs

<pre>m_Cache[index] = bmp;
			m_Removed[index] = false;
			if (m_patched.Contains(index))
			{
				m_patched.Remove(index);
			}
			Modified = true;</pre>

Fragment 2 in file Ultima\Art.cs

<pre>m_Cache[index] = bmp;
			m_Removed[index] = false;
			if (m_patched.Contains(index))
			{
				m_patched.Remove(index);
			}
			Modified = true;</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\New Guild System\OtherGuildInfo.cs

<pre>{
                                if (otherAlliance.IsPendingMember(this.m_Other))
                                    pm.SendLocalizedMessage(1063416, this.m_Other.Name); // ~1_val~ is currently considering another alliance proposal.
                                else
                                    pm.SendLocalizedMessage(1063426, this.m_Other.Name); // ~1_val~ already belongs to an alliance.
                            }</pre>

Fragment 2 in file Scripts\Gumps\Guilds\New Guild System\OtherGuildInfo.cs

<pre>{
                                if (otherAlliance.IsPendingMember(this.m_Other))
                                    pm.SendLocalizedMessage(1063416, this.m_Other.Name); // ~1_val~ is currently considering another alliance proposal.
                                else
                                    pm.SendLocalizedMessage(1063426, this.m_Other.Name); // ~1_val~ already belongs to an alliance.
                            }</pre>

Fragment 3 in file Scripts\Gumps\Guilds\New Guild System\OtherGuildInfo.cs

<pre>{
                if (otherAlliance.IsPendingMember(this.m_Other))
                    pm.SendLocalizedMessage(1063416, this.m_Other.Name); // ~1_val~ is currently considering another alliance proposal.
                else
                    pm.SendLocalizedMessage(1063426, this.m_Other.Name); // ~1_val~ already belongs to an alliance.
            }</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Properties\SetObjectGump.cs

<pre>this.m_Mobile.SendGump(new SetObjectGump(this.m_Property, this.m_Mobile, this.m_Object, this.m_Stack, this.m_Type, this.m_Page, this.m_List));</pre>

Fragment 2 in file Scripts\Gumps\Properties\SetObjectGump.cs

<pre>this.m_Mobile.SendGump(new SetObjectGump(this.m_Property, this.m_Mobile, this.m_Object, this.m_Stack, this.m_Type, this.m_Page, this.m_List));</pre>

Fragment 3 in file Scripts\Gumps\Properties\SetObjectGump.cs

<pre>this.m_Mobile.SendGump(new SetObjectGump(this.m_Property, this.m_Mobile, this.m_Object, this.m_Stack, this.m_Type, this.m_Page, this.m_List));</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Equipment\Jewelry\BaseJewel.cs

<pre>if (SetID == SetItem.Bestial)
                    list.Add(1151541, BestialSetHelper.GetTotalBerserk(this).ToString()); // Berserk ~1_VAL~

                if (this.BardMasteryBonus)
                    list.Add(1151553); // Activate: Bard Mastery Bonus x2<br>(Effect: 1 min. Cooldown: 30 min.)</pre>

Fragment 2 in file Scripts\Items\Equipment\Quivers\BaseQuiver.cs

<pre>if (SetID == SetItem.Bestial)
                    list.Add(1151541, BestialSetHelper.GetTotalBerserk(this).ToString()); // Berserk ~1_VAL~

                if (this.BardMasteryBonus)
                    list.Add(1151553); // Activate: Bard Mastery Bonus x2<br>(Effect: 1 min. Cooldown: 30 min.)</pre>

Fragment 3 in file Scripts\Items\Equipment\Weapons\BaseWeapon.cs

<pre>if (SetID == SetItem.Bestial)
                    list.Add(1151541, BestialSetHelper.GetTotalBerserk(this).ToString()); // Berserk ~1_VAL~

                if (this.BardMasteryBonus)
                    list.Add(1151553); // Activate: Bard Mastery Bonus x2<br>(Effect: 1 min. Cooldown: 30 min.)</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\CauldronOfTransmutation.cs

<pre>Expires = DateTime.UtcNow + TimeSpan.FromHours(DecayPeriod);
            m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), CheckDecay);</pre>

Fragment 2 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\MagicFishFinder.cs

<pre>Expires = DateTime.UtcNow + TimeSpan.FromHours(DecayPeriod);
            m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), CheckDecay);</pre>

Fragment 3 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\TemporaryForge.cs

<pre>Expires = DateTime.UtcNow + TimeSpan.FromHours(DecayPeriod);
            m_Timer = Timer.DelayCall(TimeSpan.FromSeconds(10), TimeSpan.FromSeconds(10), CheckDecay);</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Accounting\Accounts.cs

<pre>XmlTextWriter xml = new XmlTextWriter(op);

                xml.Formatting = Formatting.Indented;
                xml.IndentChar = '\t';
                xml.Indentation = 1;

                xml.WriteStartDocument(true);</pre>

Fragment 2 in file Scripts\Services\StaffRunebook\Save.cs

<pre>XmlTextWriter xml = new XmlTextWriter(op);

                xml.Formatting = Formatting.Indented;
                xml.IndentChar = '\t';
                xml.Indentation = 1;

                xml.WriteStartDocument(true);</pre>

Fragment 3 in file Scripts\Services\XmlSpawner\XmlSpawner Core\XmlSpawner2.cs

<pre>XmlTextWriter xml = new XmlTextWriter(op);

				xml.Formatting = Formatting.Indented;
				xml.IndentChar = '\t';
				xml.Indentation = 1;

				xml.WriteStartDocument(true);</pre>

Fragment 4 in file Scripts\Services\XmlSpawner\XMLSpawner Support\SpawnerExporter.cs

<pre>XmlTextWriter xml = new XmlTextWriter( op );

					xml.Formatting = Formatting.Indented;
					xml.IndentChar = '\t';
					xml.Indentation = 1;

					xml.WriteStartDocument( true );</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Gumps\Guilds\New Guild System\AdvancedSearch.cs

<pre>base.OnResponse(sender, info);

            PlayerMobile pm = sender.Mobile as PlayerMobile;

            if (pm == null || !IsMember(pm, this.guild))
                return;</pre>

Fragment 2 in file Scripts\Gumps\Guilds\New Guild System\BaseGuildListGump.cs

<pre>base.OnResponse(sender, info);

            PlayerMobile pm = sender.Mobile as PlayerMobile;

            if (pm == null || !IsMember(pm, this.guild))
                return;</pre>

Fragment 3 in file Scripts\Gumps\Guilds\New Guild System\DiplomacyGump.cs

<pre>base.OnResponse(sender, info);

            PlayerMobile pm = sender.Mobile as PlayerMobile;

            if (pm == null || !IsMember(pm, this.guild))
                return;</pre>

Fragment 4 in file Scripts\Gumps\Guilds\New Guild System\GuildRosterGump.cs

<pre>base.OnResponse(sender, info);

            PlayerMobile pm = sender.Mobile as PlayerMobile;

            if (pm == null || !IsMember(pm, this.guild))
                return;</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Misc\AOS.cs

<pre>if (!Core.AOS)
                return 0;

            List<Item> items = m.Items;
            int value = 0;

            #region Enhancement
            value += Enhancement.GetValue(m, attribute);</pre>

Fragment 2 in file Scripts\Misc\AOS.cs

<pre>if (!Core.AOS)
                return 0;

            List<Item> items = m.Items;
            int value = 0;

            #region Enhancement
            value += Enhancement.GetValue(m, attribute);</pre>

Fragment 3 in file Scripts\Misc\AOS.cs

<pre>if (!Core.AOS)
                return 0;

            List<Item> items = m.Items;
            int value = 0;

            #region Enhancement
            value += Enhancement.GetValue(m, attribute);</pre>

Fragment 4 in file Scripts\Misc\AOS.cs

<pre>if (!Core.AOS)
                return 0;

            List<Item> items = m.Items;
            int value = 0;

            #region Enhancement
            value += Enhancement.GetValue(m, attribute);</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Mobiles\Normal\Beetle.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            PackAnimal.GetContextMenuEntries(this, from, list);
        }</pre>

Fragment 2 in file Scripts\Mobiles\Normal\PackHorse.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            PackAnimal.GetContextMenuEntries(this, from, list);
        }</pre>

Fragment 3 in file Scripts\Mobiles\Normal\PackLlama.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            PackAnimal.GetContextMenuEntries(this, from, list);
        }</pre>

Fragment 4 in file Scripts\Mobiles\Summons\HordeMinion.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
		{
			base.GetContextMenuEntries(from, list);

			PackAnimal.GetContextMenuEntries(this, from, list);
		}</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            Ankhs.GetContextMenuEntries(from, this, list);
        }</pre>

Fragment 2 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
            {
                base.GetContextMenuEntries(from, list);
                Ankhs.GetContextMenuEntries(from, this, list);
            }</pre>

Fragment 3 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            Ankhs.GetContextMenuEntries(from, this, list);
        }</pre>

Fragment 4 in file Scripts\Items\Functional\Ankhs.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
            {
                base.GetContextMenuEntries(from, list);
                Ankhs.GetContextMenuEntries(from, this, list);
            }</pre>

Fragment 5 in file Scripts\Services\BasketWeaving\SilverSapling.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            Ankhs.GetContextMenuEntries(from, this, list);
        }</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public CraftResource Resource
        {
            get { return _Resource; }
            set
            {
                if (_Resource != value)
                {
                    _Resource = value;
                    Hue = CraftResources.GetHue(_Resource);

                    InvalidateProperties();
                }
            }
        }</pre>

Fragment 2 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public CraftResource Resource
        {
            get { return _Resource; }
            set
            {
                if (_Resource != value)
                {
                    _Resource = value;
                    Hue = CraftResources.GetHue(_Resource);

                    InvalidateProperties();
                }
            }
        }</pre>

Fragment 3 in file Scripts\Items\Functional\HouseCraftables.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public CraftResource Resource
        {
            get { return _Resource; }
            set
            {
                if (_Resource != value)
                {
                    _Resource = value;
                    Hue = CraftResources.GetHue(_Resource);

                    InvalidateProperties();
                }
            }
        }</pre>

Fragment 4 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\HarvestMap.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public CraftResource Resource
        {
            get { return _Resource; }
            set
            {
                if (_Resource != value)
                {
                    _Resource = value;
                    Hue = CraftResources.GetHue(_Resource);
                    InvalidateProperties();
                }
            }
        }</pre>

Fragment 5 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\SmeltersTalisman.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public CraftResource Resource
        {
            get { return _Resource; }
            set
            {
                if (_Resource != value)
                {
                    _Resource = value;
                    Hue = CraftResources.GetHue(_Resource);
                    InvalidateProperties();
                }
            }
        }</pre>

Fragment 6 in file Scripts\Services\Revamped Dungeons\Covetous Void Spawn\Items\WoodsmanTalisman.cs

<pre>[CommandProperty(AccessLevel.GameMaster)]
        public CraftResource Resource
        {
            get { return _Resource; }
            set
            {
                if (_Resource != value)
                {
                    _Resource = value;
                    Hue = CraftResources.GetHue(_Resource);
                    InvalidateProperties();
                }
            }
        }</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Services\ExploringTheDeep\Items\Scroll\CalculationsScroll.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;

            AddPage(0);
            AddBackground(6, 11, 390, 324, 9380);</pre>

Fragment 2 in file Scripts\Services\ExploringTheDeep\Items\Scroll\CaptainsLogScroll.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;

            AddPage(0);
            AddBackground(6, 11, 390, 324, 9380);</pre>

Fragment 3 in file Scripts\Services\ExploringTheDeep\Items\Scroll\CusteauPerronNote.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;

            AddPage(0);
            AddBackground(6, 11, 390, 324, 9380);</pre>

Fragment 4 in file Scripts\Services\ExploringTheDeep\Items\Scroll\JournalScroll.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;

            AddPage(0);
            AddBackground(6, 11, 390, 324, 9380);</pre>

Fragment 5 in file Scripts\Services\ExploringTheDeep\Items\Scroll\LedgerScroll.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;

            AddPage(0);
            AddBackground(6, 11, 390, 324, 9380);</pre>

Fragment 6 in file Scripts\Services\ExploringTheDeep\Items\Scroll\LiamDeFoeScroll.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;

            AddPage(0);
            AddBackground(6, 11, 390, 324, 9380);</pre>

Fragment 7 in file Scripts\Services\ExploringTheDeep\Items\Scroll\MadelineHarteScroll.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;

            AddPage(0);
            AddBackground(6, 11, 390, 324, 9380);</pre>

Fragment 8 in file Scripts\Services\ExploringTheDeep\Items\Scroll\MasterThinkerSchematics.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;

            AddPage(0);
            AddBackground(6, 11, 390, 324, 9380);</pre>

Fragment 9 in file Scripts\Services\ExploringTheDeep\Items\Scroll\SealedLettersScroll.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;

            AddPage(0);
            AddBackground(6, 11, 390, 324, 9380);</pre>

Fragment 10 in file Scripts\Services\ExploringTheDeep\Items\Scroll\SorcerersScroll.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;

            AddPage(0);
            AddBackground(6, 11, 390, 324, 9380);</pre>

Fragment 11 in file Scripts\Services\ExploringTheDeep\Items\Scroll\SuspicionsScroll.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;

            AddPage(0);
            AddBackground(6, 11, 390, 324, 9380);</pre>

Fragment 12 in file Scripts\Services\ExploringTheDeep\Items\Scroll\WillemHarteScroll.cs

<pre>this.Closable = true;
            this.Disposable = true;
            this.Dragable = true;

            AddPage(0);
            AddBackground(6, 11, 390, 324, 9380);</pre>

## Duplicated Code. Size: 71

### Duplicated Fragments:

Fragment 1 in file Scripts\Items\Addons\DawnsMusicBox\DawnsMusicBox.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            SetSecureLevelEntry.AddTo(from, this, list); // Set secure level
        }</pre>

Fragment 2 in file Scripts\Items\Addons\DawnsMusicBox\RewardVersion\DawnsMusicBox.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            SetSecureLevelEntry.AddTo(from, this, list); // Set secure level
        }</pre>

Fragment 3 in file Scripts\Items\Addons\HitchingPost.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            SetSecureLevelEntry.AddTo(from, this, list);
        }</pre>

Fragment 4 in file Scripts\Items\Addons\PlayerBulletinBoards.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            SetSecureLevelEntry.AddTo(from, this, list);
        }</pre>

Fragment 5 in file Scripts\Items\Addons\TapestryOfSosaria.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            SetSecureLevelEntry.AddTo(from, this, list);
        }</pre>

Fragment 6 in file Scripts\Items\Artifacts\Decorative\MapOfTheKnownWorld.cs

<pre>public override void GetContextMenuEntries( Mobile from, List<ContextMenuEntry> list )
		{
			base.GetContextMenuEntries( from, list );

			SetSecureLevelEntry.AddTo( from, this, list );
		}</pre>

Fragment 7 in file Scripts\Items\Artifacts\Equipment\Spellbooks\Runebook.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            SetSecureLevelEntry.AddTo(from, this, list);
        }</pre>

Fragment 8 in file Scripts\Items\Books\BaseBook.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            SetSecureLevelEntry.AddTo(from, this, list);
        }</pre>

Fragment 9 in file Scripts\Items\Books\GargishDocuments.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            SetSecureLevelEntry.AddTo(from, this, list);
        }</pre>

Fragment 10 in file Scripts\Items\Containers\Container.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            SetSecureLevelEntry.AddTo(from, this, list);
        }</pre>

Fragment 11 in file Scripts\Items\Functional\HouseDoors.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            SetSecureLevelEntry.AddTo(from, this, list);
        }</pre>

Fragment 12 in file Scripts\Items\Functional\SeedBox\SeedBox.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            SetSecureLevelEntry.AddTo(from, this, list);
        }</pre>

Fragment 13 in file Scripts\Items\Functional\WallSafe.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            SetSecureLevelEntry.AddTo(from, this, list);
        }</pre>

Fragment 14 in file Scripts\Items\Tools\DyeTub.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            SetSecureLevelEntry.AddTo(from, this, list);
        }</pre>

Fragment 15 in file Scripts\Items\Tools\RoseOfTrinsic.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);

            SetSecureLevelEntry.AddTo(from, this, list);
        }</pre>

Fragment 16 in file Scripts\Multis\HouseTeleporter.cs

<pre>public override void GetContextMenuEntries(Mobile from, List<ContextMenuEntry> list)
        {
            base.GetContextMenuEntries(from, list);
            SetSecureLevelEntry.AddTo(from, this, list);
        }</pre>

Fragment 17 in file Scripts\Services\CleanUpBritannia\Items\Beehive.cs

<pre>public override void GetContextMenuEntries( Mobile from, List<ContextMenuEntry> list )
		{
			base.GetContextMenuEntries( from, list );

			SetSecureLevelEntry.AddTo( from, this, list );
		}</pre>

Fragment 18 in file Scripts\Services\Plants\PlantItem.cs

<pre>public override void GetContextMenuEntries( Mobile from, List<ContextMenuEntry> list )
		{
			base.GetContextMenuEntries( from, list );
			SetSecureLevelEntry.AddTo( from, this, list );
		}</pre>